[{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\App.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import './App.css'\nimport Pages from \"@/pages/index.jsx\"\nimport { Toaster } from \"@/components/ui/toaster\"\n\nfunction App() {\n  return (\n    <>\n      <Pages />\n      <Toaster />\n    </>\n  )\n}\n\nexport default App ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\__tests__\\e2e.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\__tests__\\smoke.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\__tests__\\stateMachine.test.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token :","line":14,"column":14}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Unit Tests for Job State Machine\n// Tests state transitions, validation, and business logic\n\nimport {\n  canTransition,\n  calculateWorkedMinutes,\n  calculateBillableMinutes,\n  isLocationNearJob,\n  JobRecord,\n  JobState\n} from '../types/cleanerJobTypes';\n\n// Mock job data for testing\nconst mockJob: JobRecord = {\n  id: 'test-job-123',\n  client_id: 'client-456',\n  client_email: 'client@test.com',\n  assigned_cleaner_id: 'cleaner-789',\n  assigned_cleaner_email: 'cleaner@test.com',\n  state: 'ASSIGNED' as JobState,\n  sub_state: 'NONE',\n  created_at: '2026-01-03T10:00:00Z',\n  assigned_at: '2026-01-03T10:05:00Z',\n  en_route_at: null,\n  check_in_at: null,\n  start_at: null,\n  end_at: null,\n  approved_at: null,\n  disputed_at: null,\n  dispute_resolved_at: null,\n  cancelled_at: null,\n  en_route_location_lat: null,\n  en_route_location_lng: null,\n  check_in_location_lat: null,\n  check_in_location_lng: null,\n  start_location_lat: null,\n  start_location_lng: null,\n  end_location_lat: null,\n  end_location_lng: null,\n  max_billable_minutes: null,\n  max_billable_credits: null,\n  actual_minutes_worked: null,\n  final_credits_charged: null,\n  escrow_ledger_entry_id: null,\n  has_pending_extra_time_request: false,\n  has_pending_reschedule_request: false,\n  requires_before_photos: true,\n  requires_after_photos: true,\n  before_photos_count: 0,\n  after_photos_count: 0,\n  date: '2026-01-04',\n  time: '14:00',\n  duration_hours: 3,\n  address: '123 Test St, Test City, TC 12345',\n  latitude: 34.0522,\n  longitude: -118.2437,\n  cleaning_type: 'basic',\n  bedrooms: 2,\n  bathrooms: 2,\n  square_feet: 1000,\n  pricing_snapshot: {},\n  client_notes: null,\n  cleaner_notes: null,\n  admin_notes: null\n};\n\n// TEST SUITE 1: State Transitions\nconsole.log('üß™ TEST SUITE 1: State Transitions\\n');\n\n// Test 1.1: Valid transitions\nconsole.log('Test 1.1: Valid ASSIGNED ‚Üí EN_ROUTE transition');\nconst test1_1 = canTransition('ASSIGNED', 'EN_ROUTE', mockJob);\nconsole.log(`Result: ${test1_1.allowed ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Reasons: ${test1_1.reasons.join(', ') || 'None'}\\n`);\n\n// Test 1.2: Invalid direct jump\nconsole.log('Test 1.2: Invalid ASSIGNED ‚Üí COMPLETED_APPROVED transition');\nconst test1_2 = canTransition('ASSIGNED', 'COMPLETED_APPROVED', mockJob);\nconsole.log(`Result: ${!test1_2.allowed ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Reasons: ${test1_2.reasons.join(', ')}\\n`);\n\n// Test 1.3: Complete without photos\nconsole.log('Test 1.3: Cannot complete IN_PROGRESS ‚Üí AWAITING_CLIENT_REVIEW without photos');\nconst jobInProgress = { ...mockJob, state: 'IN_PROGRESS' as JobState, start_at: '2026-01-04T14:00:00Z', end_at: '2026-01-04T17:00:00Z' };\nconst test1_3 = canTransition('IN_PROGRESS', 'AWAITING_CLIENT_REVIEW', jobInProgress);\nconsole.log(`Result: ${!test1_3.allowed ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Reasons: ${test1_3.reasons.join(', ')}\\n`);\n\n// Test 1.4: Complete with photos\nconsole.log('Test 1.4: Can complete IN_PROGRESS ‚Üí AWAITING_CLIENT_REVIEW with photos');\nconst jobWithPhotos = { \n  ...jobInProgress, \n  before_photos_count: 3, \n  after_photos_count: 3 \n};\nconst test1_4 = canTransition('IN_PROGRESS', 'AWAITING_CLIENT_REVIEW', jobWithPhotos);\nconsole.log(`Result: ${test1_4.allowed ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Reasons: ${test1_4.reasons.join(', ') || 'None'}\\n`);\n\n// TEST SUITE 2: Time Calculations\nconsole.log('üß™ TEST SUITE 2: Time Calculations\\n');\n\n// Test 2.1: Calculate worked minutes\nconsole.log('Test 2.1: Calculate worked minutes (3 hours)');\nconst jobWithTime = {\n  ...mockJob,\n  start_at: '2026-01-04T14:00:00Z',\n  end_at: '2026-01-04T17:00:00Z'\n};\nconst workedMinutes = calculateWorkedMinutes(jobWithTime);\nconsole.log(`Result: ${workedMinutes === 180 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Expected: 180 minutes, Got: ${workedMinutes} minutes\\n`);\n\n// Test 2.2: Calculate billable minutes (capped)\nconsole.log('Test 2.2: Calculate billable minutes (4 hrs worked, 3 hrs max)');\nconst jobWithCap = {\n  ...jobWithTime,\n  end_at: '2026-01-04T18:00:00Z', // 4 hours worked\n  max_billable_minutes: 180 // 3 hours max\n};\nconst billableMinutes = calculateBillableMinutes(jobWithCap);\nconsole.log(`Result: ${billableMinutes === 180 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Expected: 180 minutes (capped), Got: ${billableMinutes} minutes\\n`);\n\n// Test 2.3: Billable minutes without cap\nconsole.log('Test 2.3: Calculate billable minutes (no cap)');\nconst jobNoCap = {\n  ...jobWithTime,\n  max_billable_minutes: 240 // 4 hours max, but only worked 3\n};\nconst billableNoCap = calculateBillableMinutes(jobNoCap);\nconsole.log(`Result: ${billableNoCap === 180 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Expected: 180 minutes, Got: ${billableNoCap} minutes\\n`);\n\n// TEST SUITE 3: GPS Validation\nconsole.log('üß™ TEST SUITE 3: GPS Validation\\n');\n\n// Test 3.1: Within 250m\nconsole.log('Test 3.1: Location within 250m (should pass)');\nconst nearLocation = { lat: 34.0542, lng: -118.2437 }; // ~2.2km ‚âà 220m\nconst test3_1 = isLocationNearJob(nearLocation.lat, nearLocation.lng, mockJob, 250);\nconsole.log(`Result: ${test3_1 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Location is ${test3_1 ? 'within' : 'outside'} 250m radius\\n`);\n\n// Test 3.2: Outside 250m\nconsole.log('Test 3.2: Location outside 250m (should fail)');\nconst farLocation = { lat: 34.1522, lng: -118.2437 }; // ~11km away\nconst test3_2 = isLocationNearJob(farLocation.lat, farLocation.lng, mockJob, 250);\nconsole.log(`Result: ${!test3_2 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Location is ${test3_2 ? 'within' : 'outside'} 250m radius\\n`);\n\n// Test 3.3: Exactly at location\nconsole.log('Test 3.3: Exact location (should pass)');\nconst exactLocation = { lat: mockJob.latitude, lng: mockJob.longitude };\nconst test3_3 = isLocationNearJob(exactLocation.lat, exactLocation.lng, mockJob, 250);\nconsole.log(`Result: ${test3_3 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Location is ${test3_3 ? 'within' : 'outside'} 250m radius\\n`);\n\n// TEST SUITE 4: Edge Cases\nconsole.log('üß™ TEST SUITE 4: Edge Cases\\n');\n\n// Test 4.1: Null timestamps\nconsole.log('Test 4.1: Handle null timestamps gracefully');\nconst jobNoTimes = { ...mockJob, start_at: null, end_at: null };\nconst test4_1 = calculateWorkedMinutes(jobNoTimes);\nconsole.log(`Result: ${test4_1 === null ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Expected: null, Got: ${test4_1}\\n`);\n\n// Test 4.2: End time before start time\nconsole.log('Test 4.2: Handle invalid time range');\nconst jobInvalidTime = {\n  ...mockJob,\n  start_at: '2026-01-04T17:00:00Z',\n  end_at: '2026-01-04T14:00:00Z' // Earlier than start\n};\nconst test4_2 = calculateWorkedMinutes(jobInvalidTime);\nconsole.log(`Result: ${test4_2 === null || test4_2 <= 0 ? '‚úÖ PASS' : '‚ùå FAIL'}`);\nconsole.log(`Expected: null or <=0, Got: ${test4_2}\\n`);\n\n// SUMMARY\nconsole.log('=' .repeat(50));\nconsole.log('üìä TEST SUMMARY\\n');\n\nconst tests = [\n  { name: 'Valid state transitions', passed: test1_1.allowed },\n  { name: 'Block invalid transitions', passed: !test1_2.allowed },\n  { name: 'Photo requirement validation', passed: !test1_3.allowed },\n  { name: 'Allow completion with photos', passed: test1_4.allowed },\n  { name: 'Time calculation', passed: workedMinutes === 180 },\n  { name: 'Billable cap enforcement', passed: billableMinutes === 180 },\n  { name: 'Billable without cap', passed: billableNoCap === 180 },\n  { name: 'GPS within radius', passed: test3_1 },\n  { name: 'GPS outside radius', passed: !test3_2 },\n  { name: 'GPS exact location', passed: test3_3 },\n  { name: 'Null timestamp handling', passed: test4_1 === null },\n  { name: 'Invalid time range', passed: test4_2 === null || test4_2 <= 0 }\n];\n\nconst passedTests = tests.filter(t => t.passed).length;\nconst totalTests = tests.length;\nconst passRate = ((passedTests / totalTests) * 100).toFixed(1);\n\nconsole.log(`Total Tests: ${totalTests}`);\nconsole.log(`Passed: ${passedTests} ‚úÖ`);\nconsole.log(`Failed: ${totalTests - passedTests} ‚ùå`);\nconsole.log(`Pass Rate: ${passRate}%\\n`);\n\nif (passRate === '100.0') {\n  console.log('üéâ ALL TESTS PASSED! State machine is working correctly.');\n} else {\n  console.log('‚ö†Ô∏è Some tests failed. Review failed tests above.');\n}\n\n// Export test results\nexport const stateMachineTestResults = {\n  tests,\n  passedTests,\n  totalTests,\n  passRate: parseFloat(passRate)\n};\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\api\\base44Client.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\api\\entities.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\api\\functions.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token /","line":68,"column":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from './base44Client';\n\n\nexport const bookingAutomations = base44.functions.bookingAutomations;\n\nexport const draftBookingAutomations = base44.functions.draftBookingAutomations;\n\nexport const disputeAutomations = base44.functions.disputeAutomations;\n\nexport const cronAutomations = base44.functions.cronAutomations;\n\nexport const paymentAutomations = base44.functions.paymentAutomations;\n\nexport const payoutAutomations = base44.functions.payoutAutomations;\n\nexport const cronPayouts = base44.functions.cronPayouts;\n\nexport const stripeWebhook = base44.functions.stripeWebhook;\n\nexport const pricingAutomations = base44.functions.pricingAutomations;\n\nexport const smartMatchAutomations = base44.functions.smartMatchAutomations;\n\nexport const cronFallbackCheck = base44.functions.cronFallbackCheck;\n\nexport const cronReliabilityUpdate = base44.functions.cronReliabilityUpdate;\n\nexport const reliabilityAutomations = base44.functions.reliabilityAutomations;\n\nexport const disputeAutomationsV2 = base44.functions.disputeAutomationsV2;\n\nexport const notificationAutomations = base44.functions.notificationAutomations;\n\nexport const recurringBookingAutomations = base44.functions.recurringBookingAutomations;\n\nexport const subscriptionAutomations = base44.functions.subscriptionAutomations;\n\nexport const analyticsAutomations = base44.functions.analyticsAutomations;\n\nexport const cronAnalytics = base44.functions.cronAnalytics;\n\nexport const riskAutomations = base44.functions.riskAutomations;\n\nexport const cronRisk = base44.functions.cronRisk;\n\nexport const adminWorkflows = base44.functions.adminWorkflows;\n\nexport const cronRequestExpiry = base44.functions.cronRequestExpiry;\n\nexport const cronAutoApprove = base44.functions.cronAutoApprove;\n\nexport const backfillUserIDs = base44.functions.backfillUserIDs;\n\nexport const seedSettings = base44.functions.seedSettings;\n\nexport const scheduledChangeProcessor = base44.functions.scheduledChangeProcessor;\n\nexport const messaging = base44.functions.messaging;\n\nexport const sendSMS = base44.functions.sendSMS;\n\nexport const suggestBookingSlots = base44.functions.suggestBookingSlots;\n\nexport const processClientBookingResponse = base44.functions.processClientBookingResponse;\n\nexport const cleanerBookingApproval = base44.functions.cleanerBookingApproval;\n\nexport const automations/sendBookingConfirmation = base44.functions.automations/sendBookingConfirmation;\n\nexport const automations/sendOnMyWay = base44.functions.automations/sendOnMyWay;\n\nexport const automations/sendPostCleaningSummary = base44.functions.automations/sendPostCleaningSummary;\n\nexport const cronReengagement = base44.functions.cronReengagement;\n\nexport const cronPreCleaningReminders = base44.functions.cronPreCleaningReminders;\n\nexport const cronReviewRequests = base44.functions.cronReviewRequests;\n\nexport const processTip = base44.functions.processTip;\n\nexport const cronTipRequests = base44.functions.cronTipRequests;\n\nexport const aiJobReminders = base44.functions.aiJobReminders;\n\nexport const loyaltyAutomations = base44.functions.loyaltyAutomations;\n\nexport const bookingModifications = base44.functions.bookingModifications;\n\nexport const cleanerAssistantDaily = base44.functions.cleanerAssistantDaily;\n\nexport const agentAssistant = base44.functions.agentAssistant;\n\nexport const aiPolicyMonitor = base44.functions.aiPolicyMonitor;\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\api\\integrations.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\UserNotRegisteredError.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\address\\AddressAutocomplete.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"fix":{"range":[99,148],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[99,147],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Navigation' is defined but never used.","line":4,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,197],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Navigation"},"fix":{"range":[185,197],"text":""},"desc":"Remove unused variable 'Navigation'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'validateAddress' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":25,"fix":{"range":[361,378],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"validateAddress"},"fix":{"range":[362,378],"text":""},"desc":"Remove unused variable 'validateAddress'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'sanitizeString' is defined but never used.","line":8,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":41,"fix":{"range":[377,393],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"sanitizeString"},"fix":{"range":[377,393],"text":""},"desc":"Remove unused variable 'sanitizeString'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'US_STATES' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":18,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"US_STATES"},"fix":{"range":[836,2679],"text":""},"desc":"Remove unused variable 'US_STATES'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { MapPin, Loader2, AlertCircle, Navigation } from 'lucide-react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport { validateAddress, sanitizeString } from '../utils/validation';\n\n// Fix for default marker icon in react-leaflet\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\nconst US_STATES = [\n  { code: 'AL', name: 'Alabama' },\n  { code: 'AK', name: 'Alaska' },\n  { code: 'AZ', name: 'Arizona' },\n  { code: 'AR', name: 'Arkansas' },\n  { code: 'CA', name: 'California' },\n  { code: 'CO', name: 'Colorado' },\n  { code: 'CT', name: 'Connecticut' },\n  { code: 'DE', name: 'Delaware' },\n  { code: 'FL', name: 'Florida' },\n  { code: 'GA', name: 'Georgia' },\n  { code: 'HI', name: 'Hawaii' },\n  { code: 'ID', name: 'Idaho' },\n  { code: 'IL', name: 'Illinois' },\n  { code: 'IN', name: 'Indiana' },\n  { code: 'IA', name: 'Iowa' },\n  { code: 'KS', name: 'Kansas' },\n  { code: 'KY', name: 'Kentucky' },\n  { code: 'LA', name: 'Louisiana' },\n  { code: 'ME', name: 'Maine' },\n  { code: 'MD', name: 'Maryland' },\n  { code: 'MA', name: 'Massachusetts' },\n  { code: 'MI', name: 'Michigan' },\n  { code: 'MN', name: 'Minnesota' },\n  { code: 'MS', name: 'Mississippi' },\n  { code: 'MO', name: 'Missouri' },\n  { code: 'MT', name: 'Montana' },\n  { code: 'NE', name: 'Nebraska' },\n  { code: 'NV', name: 'Nevada' },\n  { code: 'NH', name: 'New Hampshire' },\n  { code: 'NJ', name: 'New Jersey' },\n  { code: 'NM', name: 'New Mexico' },\n  { code: 'NY', name: 'New York' },\n  { code: 'NC', name: 'North Carolina' },\n  { code: 'ND', name: 'North Dakota' },\n  { code: 'OH', name: 'Ohio' },\n  { code: 'OK', name: 'Oklahoma' },\n  { code: 'OR', name: 'Oregon' },\n  { code: 'PA', name: 'Pennsylvania' },\n  { code: 'RI', name: 'Rhode Island' },\n  { code: 'SC', name: 'South Carolina' },\n  { code: 'SD', name: 'South Dakota' },\n  { code: 'TN', name: 'Tennessee' },\n  { code: 'TX', name: 'Texas' },\n  { code: 'UT', name: 'Utah' },\n  { code: 'VT', name: 'Vermont' },\n  { code: 'VA', name: 'Virginia' },\n  { code: 'WA', name: 'Washington' },\n  { code: 'WV', name: 'West Virginia' },\n  { code: 'WI', name: 'Wisconsin' },\n  { code: 'WY', name: 'Wyoming' }\n];\n\nexport default function AddressAutocomplete({ \n  value, \n  onChange, \n  onLocationSelect,\n  label = \"Address\",\n  placeholder = \"Start typing your address...\",\n  required = false \n}) {\n  const [searchQuery, setSearchQuery] = useState(value || '');\n  const [city, setCity] = useState('');\n  const [zipCode, setZipCode] = useState('');\n  const [suggestions, setSuggestions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedLocation, setSelectedLocation] = useState(null);\n  const [error, setError] = useState('');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n\n  useEffect(() => {\n    if (value !== searchQuery) {\n      setSearchQuery(value || '');\n    }\n  }, [value]);\n\n  useEffect(() => {\n    const searchAddress = async () => {\n      if (searchQuery.length < 3) {\n        setSuggestions([]);\n        setShowSuggestions(false);\n        return;\n      }\n\n      setLoading(true);\n      setError('');\n\n      try {\n        const response = await fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchQuery)}&countrycodes=us&limit=5&addressdetails=1`,\n          {\n            headers: {\n              'Accept': 'application/json',\n            }\n          }\n        );\n\n        if (!response.ok) {\n          throw new Error('Failed to search addresses');\n        }\n\n        const data = await response.json();\n        setSuggestions(data);\n        setShowSuggestions(data.length > 0);\n      } catch (err) {\n        console.error('Error searching addresses:', err);\n        setError('Failed to search addresses. Please try again.');\n      }\n      \n      setLoading(false);\n    };\n\n    const debounceTimer = setTimeout(searchAddress, 300);\n    return () => clearTimeout(debounceTimer);\n  }, [searchQuery]);\n\n  const handleInputChange = (e) => {\n    const newValue = e.target.value;\n    setSearchQuery(newValue);\n    if (onChange) onChange(newValue);\n    setSelectedLocation(null);\n  };\n\n  const handleSelectSuggestion = (suggestion) => {\n    const address = suggestion.display_name;\n    const addressDetails = suggestion.address || {};\n    \n    setSearchQuery(address);\n    setShowSuggestions(false);\n    setSuggestions([]);\n    \n    // Auto-fill city and zip from suggestion\n    if (addressDetails.city || addressDetails.town || addressDetails.village) {\n      setCity(addressDetails.city || addressDetails.town || addressDetails.village);\n    }\n    if (addressDetails.postcode) {\n      setZipCode(addressDetails.postcode);\n    }\n    \n    const location = {\n      address,\n      latitude: parseFloat(suggestion.lat),\n      longitude: parseFloat(suggestion.lon),\n      place_id: suggestion.place_id\n    };\n    \n    setSelectedLocation(location);\n    setError('');\n    \n    if (onLocationSelect) {\n      onLocationSelect(location);\n    }\n    \n    if (onChange) {\n      onChange(address);\n    }\n  };\n\n  return (\n    <div className=\"space-y-2 relative\">\n      {label && (\n        <label className=\"text-base font-fredoka font-semibold block mb-2\" style={{ color: '#1D2533' }}>\n          {label} {required && <span className=\"text-red-500\">*</span>}\n        </label>\n      )}\n\n      {/* Single Address Input with Autocomplete */}\n      <div className=\"relative\">\n        <Input\n          type=\"text\"\n          value={searchQuery}\n          onChange={handleInputChange}\n          onFocus={() => suggestions.length > 0 && setShowSuggestions(true)}\n          placeholder={placeholder}\n          required={required}\n          className=\"font-verdana pr-10\"\n        />\n        {loading && (\n          <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\n            <Loader2 className=\"w-5 h-5 animate-spin text-puretask-blue\" />\n          </div>\n        )}\n        {selectedLocation && (\n          <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\n            <MapPin className=\"w-5 h-5 text-green-600\" />\n          </div>\n        )}\n      </div>\n\n      {/* Autocomplete Suggestions Dropdown */}\n      {showSuggestions && suggestions.length > 0 && (\n        <div className=\"absolute z-50 w-full mt-1 bg-white border-2 border-puretask-blue rounded-xl shadow-xl max-h-60 overflow-y-auto\">\n          {suggestions.map((suggestion) => (\n            <button\n              key={suggestion.place_id}\n              type=\"button\"\n              onClick={() => handleSelectSuggestion(suggestion)}\n              className=\"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors border-b border-gray-100 last:border-b-0\"\n            >\n              <div className=\"flex items-start gap-2\">\n                <MapPin className=\"w-4 h-4 text-puretask-blue mt-1 flex-shrink-0\" />\n                <div>\n                  <p className=\"text-sm font-verdana text-graphite\">\n                    {suggestion.display_name}\n                  </p>\n                </div>\n              </div>\n            </button>\n          ))}\n        </div>\n      )}\n\n      {error && (\n        <div className=\"flex items-center gap-2 p-3 rounded-xl text-sm bg-red-50 border border-red-200 text-red-800\">\n          <AlertCircle className=\"w-4 h-4 flex-shrink-0\" />\n          <span className=\"font-verdana\">{error}</span>\n        </div>\n      )}\n\n      {selectedLocation && (\n        <div className=\"flex items-center gap-2 text-sm text-green-600 font-verdana\">\n          <MapPin className=\"w-4 h-4\" />\n          Address verified ‚úì\n        </div>\n      )}\n\n      {/* City and Zip Code Fields */}\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div>\n          <label htmlFor=\"city\" className=\"text-sm font-verdana block mb-1\" style={{ color: '#1D2533' }}>City</label>\n          <Input\n            id=\"city\"\n            type=\"text\"\n            value={city}\n            onChange={(e) => setCity(e.target.value)}\n            placeholder=\"City\"\n            required={required}\n            className=\"font-verdana\"\n          />\n        </div>\n        <div>\n          <label htmlFor=\"zip-code\" className=\"text-sm font-verdana block mb-1\" style={{ color: '#1D2533' }}>Zip Code</label>\n          <Input\n            id=\"zip-code\"\n            type=\"text\"\n            value={zipCode}\n            onChange={(e) => setZipCode(e.target.value)}\n            placeholder=\"12345\"\n            required={required}\n            maxLength={5}\n            pattern=\"[0-9]{5}\"\n            className=\"font-verdana\"\n          />\n        </div>\n      </div>\n\n      {/* Map Display */}\n      {selectedLocation && (\n        <div className=\"rounded-2xl overflow-hidden\" style={{ border: '2px solid #86EFAC' }}>\n          <div className=\"px-4 py-2\" style={{ backgroundColor: '#DCFCE7', borderBottom: '1px solid #86EFAC' }}>\n            <p className=\"text-sm font-fredoka font-semibold flex items-center gap-2\" style={{ color: '#15803D' }}>\n              <MapPin className=\"w-4 h-4\" />\n              Verified Location\n            </p>\n          </div>\n          <div style={{ height: '300px', width: '100%' }}>\n            <MapContainer\n              center={[selectedLocation.latitude, selectedLocation.longitude]}\n              zoom={16}\n              style={{ height: '100%', width: '100%' }}\n              whenReady={(map) => { map.target.invalidateSize(); }}\n            >\n              <TileLayer\n                attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n              />\n              <Marker position={[selectedLocation.latitude, selectedLocation.longitude]}>\n                <Popup>\n                  <div className=\"text-sm\">\n                    <p className=\"font-fredoka font-semibold mb-1\" style={{ color: '#1D2533' }}>Your Location</p>\n                    <p className=\"font-verdana text-gray-600\">{selectedLocation.address}</p>\n                  </div>\n                </Popup>\n              </Marker>\n            </MapContainer>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\address\\AddressSavePrompt.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Checkbox' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":18,"fix":{"range":[193,246],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Checkbox"},"fix":{"range":[193,245],"text":""},"desc":"Remove unused variable 'Checkbox'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Label' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"fix":{"range":[246,293],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Label"},"fix":{"range":[246,292],"text":""},"desc":"Remove unused variable 'Label'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { MapPin, Save } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function AddressSavePrompt({ address, latitude, longitude, userEmail, onAddressSaved }) {\n  const [saving, setSaving] = useState(false);\n  const [savedAddress, setSavedAddress] = useState(null);\n  const [dismissed, setDismissed] = useState(false);\n\n  const handleSaveAddress = async () => {\n    if (!address || !latitude || !longitude || !userEmail) return;\n\n    setSaving(true);\n    try {\n      // Check if user already has a default address\n      const profiles = await base44.entities.ClientProfile.filter({\n        user_email: userEmail\n      });\n\n      if (profiles.length > 0) {\n        const profile = profiles[0];\n        \n        // Only show if they don't have a default address yet\n        if (!profile.default_address) {\n          await base44.entities.ClientProfile.update(profile.id, {\n            default_address: address,\n            latitude: latitude,\n            longitude: longitude\n          });\n\n          setSavedAddress(address);\n          \n          if (onAddressSaved) {\n            onAddressSaved(address);\n          }\n        } else {\n          // They already have an address, dismiss\n          setDismissed(true);\n        }\n      }\n    } catch (error) {\n      console.error('Error saving address:', error);\n    }\n    setSaving(false);\n  };\n\n  if (dismissed || savedAddress) return null;\n\n  return (\n    <AnimatePresence>\n      {address && latitude && longitude && !savedAddress && (\n        <motion.div\n          initial={{ opacity: 0, y: -10 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: -10 }}\n          transition={{ duration: 0.3 }}\n        >\n          <Card className=\"border-2 border-blue-200 bg-gradient-to-r from-blue-50 to-cyan-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center flex-shrink-0\">\n                  <MapPin className=\"w-5 h-5 text-white\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h4 className=\"font-semibold text-slate-900 mb-1\">Save this address for future bookings?</h4>\n                  <p className=\"text-sm text-slate-600 mb-3\">\n                    We'll auto-fill this address next time to make booking faster\n                  </p>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSaveAddress}\n                      disabled={saving}\n                      className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n                    >\n                      {saving ? (\n                        <>Saving...</>\n                      ) : (\n                        <>\n                          <Save className=\"w-4 h-4 mr-1\" />\n                          Save Address\n                        </>\n                      )}\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => setDismissed(true)}\n                      className=\"text-slate-600\"\n                    >\n                      Not now\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n\n      {savedAddress && (\n        <motion.div\n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ duration: 0.3 }}\n        >\n          <Card className=\"border-2 border-emerald-200 bg-emerald-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-2 text-emerald-800\">\n                <Save className=\"w-5 h-5\" />\n                <p className=\"font-semibold\">Address saved! We'll remember this for next time.</p>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\address\\LocationRecommender.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"fix":{"range":[52,101],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[52,100],"text":""},"desc":"Remove unused variable 'Button'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { MapPin, Loader2 } from 'lucide-react';\n\nexport default function LocationRecommender({ currentAddress, onLocationsSelected }) {\n  const [recommendations, setRecommendations] = useState([]);\n  const [selectedLocations, setSelectedLocations] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (currentAddress) {\n      generateRecommendations();\n    }\n  }, [currentAddress]);\n\n  const generateRecommendations = async () => {\n    setLoading(true);\n    try {\n      // Parse the address to extract city/area\n      const addressParts = currentAddress.split(',').map(part => part.trim());\n      const city = addressParts[addressParts.length - 3] || ''; // Usually city is 3rd from end\n      const state = addressParts[addressParts.length - 2] || '';\n\n      // Generate nearby location recommendations\n      // In a real app, you'd use a geocoding API or database\n      const nearby = [\n        city,\n        `${city} Metro Area`,\n        `Greater ${city}`,\n        state\n      ].filter(loc => loc);\n\n      setRecommendations([...new Set(nearby)]); // Remove duplicates\n    } catch (error) {\n      console.error('Error generating recommendations:', error);\n      setRecommendations([]);\n    }\n    setLoading(false);\n  };\n\n  const toggleLocation = (location) => {\n    const newSelected = selectedLocations.includes(location)\n      ? selectedLocations.filter(loc => loc !== location)\n      : [...selectedLocations, location];\n    \n    setSelectedLocations(newSelected);\n    if (onLocationsSelected) {\n      onLocationsSelected(newSelected);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-4\">\n        <Loader2 className=\"w-6 h-6 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  if (recommendations.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n        <MapPin className=\"w-4 h-4 text-emerald-500\" />\n        <span className=\"font-medium\">Recommended Service Areas:</span>\n      </div>\n      <div className=\"flex flex-wrap gap-2\">\n        {recommendations.map((location, idx) => (\n          <Badge\n            key={idx}\n            variant={selectedLocations.includes(location) ? 'default' : 'outline'}\n            className={`cursor-pointer transition-all ${\n              selectedLocations.includes(location)\n                ? 'bg-emerald-500 hover:bg-emerald-600'\n                : 'hover:bg-emerald-50'\n            }`}\n            onClick={() => toggleLocation(location)}\n          >\n            {location}\n          </Badge>\n        ))}\n      </div>\n      {selectedLocations.length > 0 && (\n        <p className=\"text-xs text-slate-500\">\n          Selected {selectedLocations.length} location{selectedLocations.length !== 1 ? 's' : ''}\n        </p>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\AdminAuditLogger.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\AdminPageInfo.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\AdminPermissions.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":52,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":101,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\n\n/**\n * Admin Permissions Service\n * Role-based access control for admin portal\n */\n\nconst ROLE_CAPABILITIES = {\n  super_admin: [\n    'can_view_bookings', 'can_edit_bookings', 'can_issue_refunds',\n    'can_modify_pricing', 'can_block_users', 'can_view_financials',\n    'can_view_risk_center', 'can_modify_risk_tier', 'can_modify_config',\n    'can_approve_onboarding', 'can_manage_payouts', 'can_view_analytics'\n  ],\n  ops: [\n    'can_view_bookings', 'can_edit_bookings', 'can_issue_refunds',\n    'can_block_users', 'can_approve_onboarding', 'can_view_analytics'\n  ],\n  support: [\n    'can_view_bookings', 'can_issue_refunds', 'can_view_analytics'\n  ],\n  finance: [\n    'can_view_bookings', 'can_view_financials', 'can_manage_payouts',\n    'can_issue_refunds', 'can_view_analytics'\n  ],\n  trust_safety: [\n    'can_view_bookings', 'can_view_risk_center', 'can_modify_risk_tier',\n    'can_block_users', 'can_view_analytics'\n  ],\n  growth: [\n    'can_view_analytics', 'can_modify_config'\n  ]\n};\n\nexport const AdminPermissions = {\n  /**\n   * Check if current user is admin\n   */\n  async isAdmin(user) {\n    if (!user) return false;\n    \n    // Check if user.role is 'admin' (built-in Base44 admin)\n    if (user.role === 'admin') return true;\n    \n    // Check AdminUser table (may not exist yet)\n    try {\n      const adminUsers = await base44.entities.AdminUser.filter({ \n        email: user.email,\n        is_active: true\n      });\n      return adminUsers.length > 0;\n    } catch (error) {\n      // If AdminUser entity doesn't exist yet or query fails, fallback to role check\n      return user.role === 'admin';\n    }\n  },\n\n  /**\n   * Get admin user profile with roles\n   */\n  async getAdminUser(email) {\n    try {\n      const adminUsers = await base44.entities.AdminUser.filter({ email });\n      if (adminUsers.length > 0) {\n        return adminUsers[0];\n      }\n    } catch (error) {\n      console.error('Error getting admin user from table:', error);\n    }\n    \n    // Fallback: if they're built-in admin, treat as super_admin\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser && currentUser.role === 'admin') {\n        return {\n          email: currentUser.email,\n          full_name: currentUser.full_name,\n          roles: ['super_admin'],\n          is_active: true\n        };\n      }\n    } catch (error) {\n      console.error('Error getting current user:', error);\n    }\n    \n    return null;\n  },\n\n  /**\n   * Check if admin has specific capability\n   */\n  async hasCapability(email, capability) {\n    const adminUser = await this.getAdminUser(email);\n    if (!adminUser) {\n      // Fallback: check if they're built-in admin\n      try {\n        const currentUser = await base44.auth.me();\n        if (currentUser && currentUser.role === 'admin') {\n          return true; // Super admins have all capabilities\n        }\n      } catch (error) {\n        return false;\n      }\n      return false;\n    }\n    \n    // Check all roles for this capability\n    for (const role of adminUser.roles) {\n      const capabilities = ROLE_CAPABILITIES[role] || [];\n      if (capabilities.includes(capability)) {\n        return true;\n      }\n    }\n    \n    return false;\n  },\n\n  /**\n   * Get all capabilities for an admin\n   */\n  async getCapabilities(email) {\n    const adminUser = await this.getAdminUser(email);\n    if (!adminUser) return [];\n    \n    const allCapabilities = new Set();\n    for (const role of adminUser.roles) {\n      const capabilities = ROLE_CAPABILITIES[role] || [];\n      capabilities.forEach(cap => allCapabilities.add(cap));\n    }\n    \n    return Array.from(allCapabilities);\n  }\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\AdminPermissionsV2.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":24,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\n\n/**\n * Lean Admin Permissions Service (v1)\n * Just two roles: admin (full access) and support (limited)\n */\nexport const AdminPermissions = {\n  /**\n   * Check if current user is admin or support\n   */\n  async isAdmin(user) {\n    if (!user) return false;\n    \n    // Check if user.role is 'admin' (built-in Base44 admin)\n    if (user.role === 'admin') return true;\n    \n    // Check AdminUser table\n    try {\n      const adminUsers = await base44.entities.AdminUser.filter({ \n        email: user.email,\n        is_active: true\n      });\n      return adminUsers.length > 0;\n    } catch (error) {\n      return user.role === 'admin'; // Fallback to built-in role\n    }\n  },\n\n  /**\n   * Get admin user with role\n   */\n  async getAdminUser(email) {\n    try {\n      const adminUsers = await base44.entities.AdminUser.filter({ email });\n      if (adminUsers.length > 0) {\n        return adminUsers[0];\n      }\n    } catch (error) {\n      console.error('Error getting admin user:', error);\n    }\n    \n    // Fallback: if they're built-in admin, treat as admin role\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser && currentUser.role === 'admin') {\n        return {\n          email: currentUser.email,\n          full_name: currentUser.full_name,\n          role: 'admin',\n          is_active: true\n        };\n      }\n    } catch (error) {\n      console.error('Error getting current user:', error);\n    }\n    \n    return null;\n  },\n\n  /**\n   * Check if admin has full access (not just support)\n   */\n  async isFullAdmin(email) {\n    const adminUser = await this.getAdminUser(email);\n    if (!adminUser) return false;\n    return adminUser.role === 'admin';\n  },\n\n  /**\n   * Check if admin is support role\n   */\n  async isSupport(email) {\n    const adminUser = await this.getAdminUser(email);\n    if (!adminUser) return false;\n    return adminUser.role === 'support';\n  },\n\n  /**\n   * Log admin action to audit trail\n   */\n  async logAction(admin_email, action_type, target_type, target_id, metadata = {}) {\n    try {\n      await base44.entities.AdminAuditLog.create({\n        admin_email,\n        action_type,\n        target_type,\n        target_id,\n        metadata\n      });\n    } catch (error) {\n      console.error('Failed to log admin action:', error);\n    }\n  }\n};\n\nexport default AdminPermissions;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\AdvancedClientFilters.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\BookingDetailsModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CleanerProfile' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":24,"fix":{"range":[92,141],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CleanerProfile"},"fix":{"range":[92,140],"text":""},"desc":"Remove unused variable 'CleanerProfile'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":12,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":34,"fix":{"range":[651,657],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[650,656],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":13,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":41,"fix":{"range":[716,725],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[715,724],"text":""},"desc":"Remove unused variable 'XCircle'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { User } from '@/api/entities';\nimport { CleanerProfile } from '@/api/entities'; // This import seems unused based on the provided code, but kept as per instructions\nimport { Booking } from '@/api/entities';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport {\n  MapPin, Clock, DollarSign, Home, Calendar as CalendarIcon,\n  User as UserIcon, CheckCircle, XCircle, AlertCircle\n} from 'lucide-react';\nimport { format, parseISO, isValid } from 'date-fns';\n\n// Utility function to convert 24-hour time string to 12-hour format with AM/PM\nconst convertTo12Hour = (time24h) => {\n  if (!time24h) return 'Not set';\n  try {\n    const [hours, minutes] = time24h.split(':').map(Number);\n    if (isNaN(hours) || isNaN(minutes)) {\n      return time24h; // Return original if parsing fails\n    }\n    const period = hours >= 12 ? 'PM' : 'AM';\n    const hours12 = hours % 12 || 12; // Converts 0 (midnight) to 12 AM and 12 (noon) to 12 PM\n    const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;\n    return `${hours12}:${formattedMinutes} ${period}`;\n  } catch (error) {\n    console.error('Error converting time to 12-hour format:', error);\n    return time24h; // Fallback to original\n  }\n};\n\nexport default function BookingDetailsModal({ booking, onClose, onUpdate }) {\n  const [status, setStatus] = useState(booking?.status || 'available');\n  const [clientInfo, setClientInfo] = useState(null);\n  const [cleanerInfo, setCleanerInfo] = useState(null);\n\n  useEffect(() => {\n    loadUserInfo();\n  }, [booking]);\n\n  const loadUserInfo = async () => {\n    if (!booking) return;\n\n    try {\n      if (booking.client_email) {\n        const users = await User.filter({ email: booking.client_email });\n        if (users.length > 0) setClientInfo(users[0]);\n      }\n\n      if (booking.cleaner_email) {\n        const users = await User.filter({ email: booking.cleaner_email });\n        if (users.length > 0) setCleanerInfo(users[0]);\n      }\n    } catch (error) {\n      console.error('Error loading user info:', error);\n    }\n  };\n\n  const handleStatusChange = async (newStatus) => {\n    try {\n      await Booking.update(booking.id, { status: newStatus });\n      setStatus(newStatus);\n      if (onUpdate) onUpdate();\n    } catch (error) {\n      console.error('Error updating booking status:', error);\n    }\n  };\n\n  if (!booking) return null;\n\n  // Safely parse and format the date\n  const getFormattedDate = () => {\n    if (!booking.date) return 'Date not set';\n\n    try {\n      const parsedDate = typeof booking.date === 'string' ? parseISO(booking.date) : new Date(booking.date);\n      if (isValid(parsedDate)) {\n        return format(parsedDate, 'EEEE, MMMM d, yyyy');\n      }\n    } catch (error) {\n      console.error('Error formatting date:', error);\n    }\n    return booking.date; // Fallback to raw date string\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'completed': return 'bg-green-500 text-white';\n      case 'confirmed': return 'bg-blue-500 text-white';\n      case 'pending_confirmation': return 'bg-amber-500 text-white';\n      case 'in_progress': return 'bg-purple-500 text-white';\n      case 'cancelled': return 'bg-red-500 text-white';\n      case 'disputed': return 'bg-orange-500 text-white';\n      case 'available': return 'bg-slate-500 text-white';\n      default: return 'bg-slate-500 text-white';\n    }\n  };\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl\">Booking Details</DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Status Management */}\n          <div className=\"p-4 bg-slate-50 rounded-lg\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h3 className=\"font-semibold text-lg\">Status Management</h3>\n              <Badge className={getStatusColor(status)}>\n                {status.replace('_', ' ')}\n              </Badge>\n            </div>\n            <Select value={status} onValueChange={handleStatusChange}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"available\">Available</SelectItem>\n                <SelectItem value=\"pending_confirmation\">Pending Confirmation</SelectItem>\n                <SelectItem value=\"confirmed\">Confirmed</SelectItem>\n                <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                <SelectItem value=\"completed\">Completed</SelectItem>\n                <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                <SelectItem value=\"disputed\">Disputed</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <Separator />\n\n          {/* Date & Time */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div className=\"p-4 bg-emerald-50 rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CalendarIcon className=\"w-5 h-5 text-emerald-600\" />\n                <span className=\"text-sm font-medium text-slate-700\">Date</span>\n              </div>\n              <p className=\"text-lg font-bold text-slate-900\">\n                {getFormattedDate()}\n              </p>\n            </div>\n\n            <div className=\"p-4 bg-blue-50 rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Clock className=\"w-5 h-5 text-blue-600\" />\n                <span className=\"text-sm font-medium text-slate-700\">Time</span>\n              </div>\n              <p className=\"text-lg font-bold text-slate-900\">\n                {convertTo12Hour(booking.start_time)} ‚Ä¢ {booking.hours || 0} hours\n              </p>\n            </div>\n          </div>\n\n          {/* Financial Info */}\n          <div className=\"p-4 bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border border-emerald-200\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600 mb-1\">Total Price</p>\n                <p className=\"text-3xl font-bold text-slate-900\">${booking.total_price?.toFixed(2) || '0.00'}</p>\n              </div>\n              <DollarSign className=\"w-12 h-12 text-emerald-500\" />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-emerald-200\">\n              <div>\n                <p className=\"text-xs text-slate-500\">Platform Fee (15%)</p>\n                <p className=\"font-semibold text-slate-700\">${((booking.total_price || 0) * 0.15).toFixed(2)}</p>\n              </div>\n              <div>\n                <p className=\"text-xs text-slate-500\">Cleaner Payout (85%)</p>\n                <p className=\"font-semibold text-slate-700\">${((booking.total_price || 0) * 0.85).toFixed(2)}</p>\n              </div>\n            </div>\n          </div>\n\n          <Separator />\n\n          {/* Client Info */}\n          <div className=\"p-4 bg-blue-50 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-3\">\n              <UserIcon className=\"w-5 h-5 text-blue-600\" />\n              <h3 className=\"font-semibold text-lg\">Client Information</h3>\n            </div>\n            {clientInfo ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-sm\"><strong>Name:</strong> {clientInfo.full_name}</p>\n                <p className=\"text-sm\"><strong>Email:</strong> {clientInfo.email}</p>\n                <p className=\"text-sm\"><strong>Phone:</strong> {clientInfo.phone || 'Not provided'}</p>\n                <div className=\"flex items-center gap-2 mt-2\">\n                  {booking.client_confirmed ? (\n                    <Badge className=\"bg-green-500\">\n                      <CheckCircle className=\"w-3 h-3 mr-1\" />\n                      Confirmed\n                    </Badge>\n                  ) : (\n                    <Badge className=\"bg-amber-500\">\n                      <AlertCircle className=\"w-3 h-3 mr-1\" />\n                      Pending\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            ) : (\n              <p className=\"text-sm text-slate-500\">No client assigned</p>\n            )}\n          </div>\n\n          {/* Cleaner Info */}\n          <div className=\"p-4 bg-purple-50 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-3\">\n              <UserIcon className=\"w-5 h-5 text-purple-600\" />\n              <h3 className=\"font-semibold text-lg\">Cleaner Information</h3>\n            </div>\n            {cleanerInfo ? (\n              <div className=\"space-y-2\">\n                <p className=\"text-sm\"><strong>Name:</strong> {cleanerInfo.full_name}</p>\n                <p className=\"text-sm\"><strong>Email:</strong> {cleanerInfo.email}</p>\n                <p className=\"text-sm\"><strong>Phone:</strong> {cleanerInfo.phone || 'Not provided'}</p>\n                <div className=\"flex items-center gap-2 mt-2\">\n                  {booking.cleaner_confirmed ? (\n                    <Badge className=\"bg-green-500\">\n                      <CheckCircle className=\"w-3 h-3 mr-1\" />\n                      Confirmed\n                    </Badge>\n                  ) : (\n                    <Badge className=\"bg-amber-500\">\n                      <AlertCircle className=\"w-3 h-3 mr-1\" />\n                      Pending\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            ) : (\n              <p className=\"text-sm text-slate-500\">No cleaner assigned</p>\n            )}\n          </div>\n\n          <Separator />\n\n          {/* Location */}\n          <div>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <MapPin className=\"w-5 h-5 text-slate-600\" />\n              <h3 className=\"font-semibold text-lg\">Location</h3>\n            </div>\n            <p className=\"text-slate-700 bg-slate-50 p-3 rounded-lg\">\n              {booking.address || 'Address not provided'}\n            </p>\n          </div>\n\n          {/* Tasks */}\n          {booking.tasks && booking.tasks.length > 0 && (\n            <div>\n              <h3 className=\"font-semibold text-lg mb-3\">Tasks</h3>\n              <div className=\"flex flex-wrap gap-2\">\n                {booking.tasks.map((task, idx) => (\n                  <Badge key={idx} variant=\"outline\" className=\"bg-blue-50\">\n                    {task.replace('_', ' ')}\n                  </Badge>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Additional Notes */}\n          {booking.notes && (\n            <div>\n              <h3 className=\"font-semibold text-lg mb-2\">Client Notes</h3>\n              <p className=\"text-slate-700 bg-slate-50 p-3 rounded-lg text-sm\">\n                {booking.notes}\n              </p>\n            </div>\n          )}\n\n          {/* Photos */}\n          {(booking.before_photos?.length > 0 || booking.after_photos?.length > 0) && (\n            <div>\n              <h3 className=\"font-semibold text-lg mb-3\">Photos</h3>\n              <div className=\"grid grid-cols-2 gap-4\">\n                {booking.before_photos?.length > 0 && (\n                  <div>\n                    <p className=\"text-sm font-medium text-slate-600 mb-2\">Before</p>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      {booking.before_photos.map((photo, idx) => (\n                        <img\n                          key={idx}\n                          src={photo}\n                          alt=\"Before\"\n                          className=\"w-full h-24 object-cover rounded-lg\"\n                        />\n                      ))}\n                    </div>\n                  </div>\n                )}\n                {booking.after_photos?.length > 0 && (\n                  <div>\n                    <p className=\"text-sm font-medium text-slate-600 mb-2\">After</p>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      {booking.after_photos.map((photo, idx) => (\n                        <img\n                          key={idx}\n                          src={photo}\n                          alt=\"After\"\n                          className=\"w-full h-24 object-cover rounded-lg\"\n                        />\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Check-in/out Info */}\n          {(booking.check_in_time || booking.check_out_time) && (\n            <div className=\"p-4 bg-slate-50 rounded-lg\">\n              <h3 className=\"font-semibold text-lg mb-3\">Timeline</h3>\n              <div className=\"space-y-2 text-sm\">\n                {booking.check_in_time && (\n                  <p><strong>Checked In:</strong> {new Date(booking.check_in_time).toLocaleString()}</p>\n                )}\n                {booking.check_out_time && (\n                  <p><strong>Checked Out:</strong> {new Date(booking.check_out_time).toLocaleString()}</p>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Close Button */}\n          <div className=\"flex justify-end pt-4\">\n            <Button onClick={onClose} variant=\"outline\">\n              Close\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\BookingManagementTable.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":14,"fix":{"range":[94,133],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[94,132],"text":""},"desc":"Remove unused variable 'User'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Booking } from '@/api/entities';\nimport { User } from '@/api/entities';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Search, Eye, Calendar } from 'lucide-react';\nimport { format } from 'date-fns';\nimport BookingDetailsModal from './BookingDetailsModal';\n\nexport default function BookingManagementTable() {\n  const [bookings, setBookings] = useState([]);\n  const [filteredBookings, setFilteredBookings] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedBooking, setSelectedBooking] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadBookings();\n  }, []);\n\n  useEffect(() => {\n    filterBookings();\n  }, [searchTerm, bookings]);\n\n  const loadBookings = async () => {\n    try {\n      const allBookings = await Booking.list('-created_date');\n      setBookings(allBookings);\n      setFilteredBookings(allBookings);\n    } catch (error) {\n      console.error('Error loading bookings:', error);\n    }\n    setLoading(false);\n  };\n\n  const filterBookings = () => {\n    if (!searchTerm) {\n      setFilteredBookings(bookings);\n      return;\n    }\n\n    const filtered = bookings.filter(booking => \n      booking.client_email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.cleaner_email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.address.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.id.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n    setFilteredBookings(filtered);\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      'pending_confirmation': 'bg-amber-100 text-amber-800',\n      'confirmed': 'bg-blue-100 text-blue-800',\n      'in_progress': 'bg-purple-100 text-purple-800',\n      'completed': 'bg-emerald-100 text-emerald-800',\n      'cancelled': 'bg-red-100 text-red-800',\n      'disputed': 'bg-orange-100 text-orange-800'\n    };\n    return colors[status] || 'bg-slate-100 text-slate-800';\n  };\n\n  if (loading) {\n    return <div className=\"p-6\">Loading bookings...</div>;\n  }\n\n  return (\n    <>\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"w-6 h-6 text-blue-500\" />\n            All Bookings\n          </CardTitle>\n          <div className=\"mt-4 relative\">\n            <Search className=\"absolute left-3 top-3 w-5 h-5 text-slate-400\" />\n            <Input\n              placeholder=\"Search by email, address, or booking ID...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Date</TableHead>\n                  <TableHead>Client</TableHead>\n                  <TableHead>Cleaner</TableHead>\n                  <TableHead>Address</TableHead>\n                  <TableHead>Price</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead>Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredBookings.map(booking => (\n                  <TableRow key={booking.id}>\n                    <TableCell>\n                      <div className=\"font-medium\">\n                        {format(new Date(booking.date), 'MMM d, yyyy')}\n                      </div>\n                      <div className=\"text-sm text-slate-500\">{booking.start_time}</div>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"text-sm\">{booking.client_email}</div>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"text-sm\">{booking.cleaner_email}</div>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"text-sm max-w-xs truncate\">{booking.address}</div>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"font-medium\">${booking.total_price.toFixed(2)}</div>\n                    </TableCell>\n                    <TableCell>\n                      <Badge className={getStatusColor(booking.status)}>\n                        {booking.status.replace('_', ' ')}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => setSelectedBooking(booking)}\n                      >\n                        <Eye className=\"w-4 h-4\" />\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n          \n          {filteredBookings.length === 0 && (\n            <div className=\"text-center py-12\">\n              <p className=\"text-slate-500\">No bookings found</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {selectedBooking && (\n        <BookingDetailsModal\n          booking={selectedBooking}\n          onClose={() => setSelectedBooking(null)}\n          onUpdate={loadBookings}\n        />\n      )}\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\BookingStatusChart.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Legend' is defined but never used.","line":4,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":58,"fix":{"range":[228,236],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Legend"},"fix":{"range":[227,235],"text":""},"desc":"Remove unused variable 'Legend'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Legend, Tooltip } from 'recharts';\nimport { Briefcase } from 'lucide-react';\n\nconst COLORS = {\n  scheduled: '#3b82f6',\n  in_progress: '#8b5cf6',\n  completed: '#10b981',\n  approved: '#059669',\n  cancelled: '#ef4444',\n  disputed: '#f59e0b',\n  awaiting_cleaner_response: '#f97316',\n  payment_hold: '#eab308'\n};\n\nexport default function BookingStatusChart() {\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const bookings = await base44.entities.Booking.list();\n\n      const statusCounts = {};\n      bookings.forEach(booking => {\n        const status = booking.status || 'unknown';\n        statusCounts[status] = (statusCounts[status] || 0) + 1;\n      });\n\n      const chartData = Object.entries(statusCounts).map(([status, count]) => ({\n        name: status.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()),\n        value: count,\n        color: COLORS[status] || '#94a3b8'\n      }));\n\n      setData(chartData.sort((a, b) => b.value - a.value));\n    } catch (error) {\n      console.error('Error loading booking status data:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardContent className=\"p-12 text-center\">\n          <p className=\"text-slate-600 font-verdana\">Loading booking data...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <Briefcase className=\"w-6 h-6 text-blue-600\" />\n          <span className=\"font-fredoka\">Booking Status Distribution</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <PieChart>\n            <Pie\n              data={data}\n              cx=\"50%\"\n              cy=\"50%\"\n              labelLine={false}\n              label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\n              outerRadius={100}\n              fill=\"#8884d8\"\n              dataKey=\"value\"\n            >\n              {data.map((entry, index) => (\n                <Cell key={`cell-${index}`} fill={entry.color} />\n              ))}\n            </Pie>\n            <Tooltip formatter={(value) => `${value} bookings`} />\n          </PieChart>\n        </ResponsiveContainer>\n\n        <div className=\"grid grid-cols-2 sm:grid-cols-3 gap-3 mt-6\">\n          {data.map((item, index) => (\n            <div\n              key={index}\n              className=\"flex items-center gap-2 p-3 bg-soft-cloud rounded-lg\"\n            >\n              <div\n                className=\"w-3 h-3 rounded-full\"\n                style={{ backgroundColor: item.color }}\n              ></div>\n              <div>\n                <p className=\"text-xs text-gray-600 font-verdana\">{item.name}</p>\n                <p className=\"text-sm font-bold text-graphite font-fredoka\">{item.value}</p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CleanerCardGrid.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ReliabilityMeter' is defined but never used.","line":12,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":24,"fix":{"range":[646,710],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ReliabilityMeter"},"fix":{"range":[653,675],"text":""},"desc":"Remove unused variable 'ReliabilityMeter'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Search, Shield, Award, Star, MapPin, Clock, Eye, Ban, Play } from 'lucide-react'; // Removed CheckCircle, XCircle\nimport { motion } from 'framer-motion';\nimport CleanerDetailsModal from './CleanerDetailsModal';\nimport ReliabilityMeter from '../reliability/ReliabilityMeter'; // This component is not used in the current version of the file, but keep the import.\nimport { calculateReliabilityScore } from '../reliability/ReliabilityScoreCalculator';\n\nexport default function CleanerCardGrid({ onCleanerSelect }) {\n  const [cleaners, setCleaners] = useState([]);\n  const [filteredCleaners, setFilteredCleaners] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [tierFilter, setTierFilter] = useState('all');\n  const [selectedCleaner, setSelectedCleaner] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadCleaners();\n  }, []);\n\n  useEffect(() => {\n    filterCleaners();\n  }, [searchTerm, statusFilter, tierFilter, cleaners]);\n\n  const loadCleaners = async () => {\n    try {\n      // Profiles now have full_name, no need to match with User entity\n      const allProfiles = await base44.entities.CleanerProfile.list('-reliability_score');\n      setCleaners(allProfiles);\n    } catch (error) {\n      console.error('Error loading cleaners:', error);\n    }\n    setLoading(false);\n  };\n\n  const filterCleaners = () => {\n    let filtered = cleaners;\n\n    if (searchTerm) {\n      filtered = filtered.filter(profile =>\n        profile.full_name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        profile.user_email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        profile.service_locations?.some(loc => loc.toLowerCase().includes(searchTerm.toLowerCase()))\n      );\n    }\n\n    if (statusFilter !== 'all') {\n      if (statusFilter === 'active') {\n        filtered = filtered.filter(profile => profile.is_active);\n      } else if (statusFilter === 'suspended') {\n        filtered = filtered.filter(profile => !profile.is_active);\n      }\n      // The 'pending' status filter logic has been removed as it relied on User entity properties.\n    }\n\n    if (tierFilter !== 'all') {\n      filtered = filtered.filter(profile => profile.tier === tierFilter);\n    }\n\n    setFilteredCleaners(filtered);\n  };\n\n  const handleSuspend = async (profile) => {\n    try {\n      await base44.entities.CleanerProfile.update(profile.id, { is_active: false });\n      await loadCleaners();\n      if (onCleanerSelect) onCleanerSelect();\n    } catch (error) {\n      console.error('Error suspending cleaner:', error);\n    }\n  };\n\n  const handleActivate = async (profile) => {\n    try {\n      await base44.entities.CleanerProfile.update(profile.id, { is_active: true });\n      \n      const newScore = await calculateReliabilityScore(profile.user_email);\n      let tier = 'Basic';\n      if (newScore >= 85) tier = 'Elite';\n      else if (newScore >= 70) tier = 'Pro';\n      \n      await base44.entities.CleanerProfile.update(profile.id, {\n        reliability_score: newScore,\n        tier: tier\n      });\n      \n      await loadCleaners();\n      if (onCleanerSelect) onCleanerSelect();\n    } catch (error) {\n      console.error('Error activating cleaner:', error);\n    }\n  };\n\n  const tierColors = {\n    Elite: 'from-amber-400 to-yellow-500',\n    Pro: 'from-blue-500 to-cyan-500',\n    Basic: 'from-slate-400 to-gray-500'\n  };\n\n  // getVerificationStatus function removed as KYC/background check status are no longer combined from User entity.\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl\">\n        <CardContent className=\"p-12 text-center\">\n          <p className=\"text-slate-600\">Loading cleaners...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <>\n      <Card className=\"border-0 shadow-xl\">\n        <CardHeader className=\"bg-gradient-to-r from-slate-50 to-slate-100\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <Shield className=\"w-6 h-6 text-slate-700\" />\n            All Cleaner Profiles\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          {/* Filters */}\n          <div className=\"grid md:grid-cols-3 gap-4 mb-6\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-3 w-4 h-4 text-slate-400\" />\n              <Input\n                placeholder=\"Search by name, email, or location...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"Filter by status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"active\">Active Only</SelectItem>\n                <SelectItem value=\"suspended\">Suspended Only</SelectItem>\n                {/* 'Pending Verification' filter removed */}\n              </SelectContent>\n            </Select>\n\n            <Select value={tierFilter} onValueChange={setTierFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"Filter by tier\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Tiers</SelectItem>\n                <SelectItem value=\"Elite\">Elite</SelectItem>\n                <SelectItem value=\"Pro\">Pro</SelectItem>\n                <SelectItem value=\"Basic\">Basic</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Results count */}\n          <div className=\"mb-4\">\n            <Badge variant=\"outline\" className=\"text-slate-600\">\n              {filteredCleaners.length} cleaner{filteredCleaners.length !== 1 ? 's' : ''} found\n            </Badge>\n          </div>\n\n          {/* Cleaner Cards Grid */}\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredCleaners.map((profile) => {\n              return (\n                <motion.div\n                  key={profile.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <Card className=\"overflow-hidden hover:shadow-xl transition-shadow duration-300 border-0 bg-white h-full\">\n                    <div className={`h-2 bg-gradient-to-r ${tierColors[profile.tier]}`} />\n                    <CardContent className=\"p-6\">\n                      {/* Header with Avatar and Status */}\n                      <div className=\"flex items-start justify-between mb-4\">\n                        <div className=\"flex items-start gap-3\">\n                          <div className=\"w-14 h-14 rounded-full bg-gradient-to-br from-emerald-400 to-cyan-500 flex items-center justify-center text-white text-xl font-bold shadow-lg\">\n                            {profile.full_name ? profile.full_name[0].toUpperCase() : '?'}\n                          </div>\n                          <div>\n                            <h3 className=\"text-lg font-bold text-slate-900\">{profile.full_name || 'Cleaner'}</h3>\n                            <p className=\"text-xs text-slate-500\">{profile.user_email}</p>\n                          </div>\n                        </div>\n                        {/* Replaced verification badge with active/suspended badge */}\n                        <Badge className={profile.is_active ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}>\n                          {profile.is_active ? 'Active' : 'Suspended'}\n                        </Badge>\n                      </div>\n\n                      {/* Tier and Reliability */}\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <Badge className={`bg-gradient-to-r ${tierColors[profile.tier]} text-white`}>\n                          <Award className=\"w-3 h-3 mr-1\" />\n                          {profile.tier}\n                        </Badge>\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"relative w-12 h-12\">\n                            <svg className=\"w-full h-full transform -rotate-90\">\n                              <circle\n                                cx=\"50%\"\n                                cy=\"50%\"\n                                r=\"45%\"\n                                fill=\"none\"\n                                stroke=\"#e5e7eb\"\n                                strokeWidth=\"4\"\n                              />\n                              <circle\n                                cx=\"50%\"\n                                cy=\"50%\"\n                                r=\"45%\"\n                                fill=\"none\"\n                                stroke={profile.reliability_score >= 85 ? '#10b981' : profile.reliability_score >= 70 ? '#3b82f6' : '#f59e0b'}\n                                strokeWidth=\"4\"\n                                strokeLinecap=\"round\"\n                                strokeDasharray={`${2 * Math.PI * 45 * (profile.reliability_score / 100)} ${2 * Math.PI * 45}`}\n                              />\n                            </svg>\n                            <div className=\"absolute inset-0 flex items-center justify-center\">\n                              <span className=\"text-xs font-bold\">{profile.reliability_score}</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      {/* Stats */}\n                      <div className=\"grid grid-cols-2 gap-3 mb-4\">\n                        <div className=\"bg-emerald-50 p-3 rounded-lg\">\n                          <div className=\"flex items-center gap-1 text-emerald-600 mb-1\">\n                            <Star className=\"w-3 h-3 fill-emerald-500\" />\n                            <span className=\"text-xs font-medium\">Rating</span>\n                          </div>\n                          <p className=\"text-lg font-bold text-slate-900\">{profile.average_rating.toFixed(1)}</p>\n                          <p className=\"text-xs text-slate-500\">{profile.total_reviews} reviews</p>\n                        </div>\n                        <div className=\"bg-blue-50 p-3 rounded-lg\">\n                          <div className=\"flex items-center gap-1 text-blue-600 mb-1\">\n                            <Clock className=\"w-3 h-3\" />\n                            <span className=\"text-xs font-medium\">Jobs</span>\n                          </div>\n                          <p className=\"text-lg font-bold text-slate-900\">{profile.total_jobs}</p>\n                          <p className=\"text-xs text-slate-500\">{profile.on_time_rate}% on-time</p>\n                        </div>\n                      </div>\n\n                      {/* Location */}\n                      {profile.service_locations && profile.service_locations.length > 0 && (\n                        <div className=\"flex items-center gap-2 text-sm text-slate-600 mb-4\">\n                          <MapPin className=\"w-4 h-4 text-emerald-500\" />\n                          <span className=\"truncate\">{profile.service_locations.slice(0, 2).join(', ')}</span>\n                          {profile.service_locations.length > 2 && (\n                            <Badge variant=\"outline\" className=\"text-xs\">+{profile.service_locations.length - 2}</Badge>\n                          )}\n                        </div>\n                      )}\n\n                      {/* Hourly Rate */}\n                      <div className=\"mb-4 pt-4 border-t border-slate-100\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <span className=\"text-2xl font-bold text-slate-900\">${profile.hourly_rate}</span>\n                            <span className=\"text-slate-500 ml-1\">/hour</span>\n                          </div>\n                          {/* Active/Suspended badge was here, moved to header */}\n                        </div>\n                      </div>\n\n                      {/* Action Buttons */}\n                      <div className=\"flex gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => setSelectedCleaner(profile)} // Pass the profile object directly\n                          className=\"flex-1 hover:bg-blue-50\"\n                        >\n                          <Eye className=\"w-4 h-4 mr-2\" />\n                          View Details\n                        </Button>\n                        {profile.is_active ? (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleSuspend(profile)} // Pass the profile object directly\n                            className=\"text-red-600 border-red-300 hover:bg-red-50\"\n                          >\n                            <Ban className=\"w-4 h-4\" />\n                          </Button>\n                        ) : (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleActivate(profile)} // Pass the profile object directly\n                            className=\"text-emerald-600 border-emerald-300 hover:bg-emerald-50\"\n                          >\n                            <Play className=\"w-4 h-4\" />\n                          </Button>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              );\n            })}\n          </div>\n\n          {filteredCleaners.length === 0 && (\n            <div className=\"text-center py-16\">\n              <Shield className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n              <p className=\"text-lg font-medium text-slate-700 mb-2\">No cleaners found</p>\n              <p className=\"text-sm text-slate-500\">\n                {searchTerm || statusFilter !== 'all' || tierFilter !== 'all'\n                  ? 'Try adjusting your filters'\n                  : 'Cleaners will appear here after they complete onboarding'}\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {selectedCleaner && (\n        <CleanerDetailsModal\n          cleaner={selectedCleaner} // selectedCleaner is now the full profile object\n          profile={selectedCleaner} // Pass the same profile object to both props\n          onClose={() => setSelectedCleaner(null)}\n          onUpdate={() => {\n            loadCleaners();\n            if (onCleanerSelect) onCleanerSelect();\n          }}\n        />\n      )}\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CleanerDetailsModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":10,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":30,"fix":{"range":[466,472],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[465,471],"text":""},"desc":"Remove unused variable 'Star'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":10,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":37,"fix":{"range":[472,479],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[471,478],"text":""},"desc":"Remove unused variable 'Award'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { User } from '@/api/entities';\nimport { CleanerProfile } from '@/api/entities';\nimport { Shield, MapPin, Star, Award, CheckCircle, FileText } from 'lucide-react';\nimport ReliabilityMeter from '../reliability/ReliabilityMeter';\n\nexport default function CleanerDetailsModal({ cleaner, profile, onClose, onUpdate }) {\n  if (!cleaner) return null;\n\n  const handleApproveKYC = async () => {\n    await User.update(cleaner.id, { kyc_status: 'approved' });\n    onUpdate();\n  };\n\n  const handleRejectKYC = async () => {\n    await User.update(cleaner.id, { kyc_status: 'rejected' });\n    onUpdate();\n  };\n\n  const handleApproveBGC = async () => {\n    await User.update(cleaner.id, { background_check_status: 'approved' });\n    onUpdate();\n  };\n\n  const handleRejectBGC = async () => {\n    await User.update(cleaner.id, { background_check_status: 'rejected' });\n    onUpdate();\n  };\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"text-2xl flex items-center gap-3\">\n            <div className=\"w-12 h-12 bg-gradient-to-br from-emerald-400 to-cyan-500 rounded-full flex items-center justify-center text-white text-xl font-bold\">\n              {cleaner.full_name?.[0]}\n            </div>\n            {cleaner.full_name}\n          </DialogTitle>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"verification\" className=\"w-full\">\n          <TabsList className=\"w-full grid grid-cols-3\">\n            <TabsTrigger value=\"verification\">Verification</TabsTrigger>\n            <TabsTrigger value=\"profile\">Profile</TabsTrigger>\n            <TabsTrigger value=\"performance\">Performance</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"verification\" className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {/* Left Column: Existing KYC and BGC Cards */}\n              <div className=\"space-y-6\">\n                {/* KYC Section */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                      <div className=\"flex items-center gap-2\">\n                        <Shield className=\"w-5 h-5 text-blue-500\" />\n                        <h3 className=\"font-semibold text-lg\">KYC Verification</h3>\n                      </div>\n                      <Badge className={\n                        cleaner.kyc_status === 'approved' ? 'bg-emerald-500' :\n                        cleaner.kyc_status === 'rejected' ? 'bg-red-500' :\n                        'bg-amber-500'\n                      }>\n                        {cleaner.kyc_status}\n                      </Badge>\n                    </div>\n\n                    <div className=\"grid md:grid-cols-3 gap-4 mb-4\">\n                      {cleaner.id_front_url && (\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-600 mb-2\">ID Front</p>\n                          <img\n                            src={cleaner.id_front_url}\n                            alt=\"ID Front\"\n                            className=\"w-full h-40 object-cover rounded-lg border-2 border-slate-200\"\n                          />\n                        </div>\n                      )}\n                      {cleaner.id_back_url && (\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-600 mb-2\">ID Back</p>\n                          <img\n                            src={cleaner.id_back_url}\n                            alt=\"ID Back\"\n                            className=\"w-full h-40 object-cover rounded-lg border-2 border-slate-200\"\n                          />\n                        </div>\n                      )}\n                      {cleaner.selfie_url && (\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-600 mb-2\">Selfie</p>\n                          <img\n                            src={cleaner.selfie_url}\n                            alt=\"Selfie\"\n                            className=\"w-full h-40 object-cover rounded-lg border-2 border-slate-200\"\n                          />\n                        </div>\n                      )}\n                    </div>\n\n                    {cleaner.kyc_status === 'pending' && (\n                      <div className=\"flex gap-3\">\n                        <Button\n                          onClick={handleApproveKYC}\n                          className=\"flex-1 bg-emerald-500 hover:bg-emerald-600\"\n                        >\n                          Approve KYC\n                        </Button>\n                        <Button\n                          onClick={handleRejectKYC}\n                          variant=\"outline\"\n                          className=\"flex-1 text-red-600 border-red-300\"\n                        >\n                          Reject KYC\n                        </Button>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Background Check Section */}\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between mb-4\">\n                      <div className=\"flex items-center gap-2\">\n                        <Shield className=\"w-5 h-5 text-purple-500\" />\n                        <h3 className=\"font-semibold text-lg\">Background Check</h3>\n                      </div>\n                      <Badge className={\n                        cleaner.background_check_status === 'approved' ? 'bg-emerald-500' :\n                        cleaner.background_check_status === 'rejected' ? 'bg-red-500' :\n                        'bg-amber-500'\n                      }>\n                        {cleaner.background_check_status}\n                      </Badge>\n                    </div>\n\n                    <div className=\"bg-slate-50 p-4 rounded-lg mb-4\">\n                      <p className=\"text-sm text-slate-600\">\n                        Background check should verify criminal records, employment history, and identity confirmation.\n                      </p>\n                    </div>\n\n                    {cleaner.background_check_status === 'pending' && (\n                      <div className=\"flex gap-3\">\n                        <Button\n                          onClick={handleApproveBGC}\n                          className=\"flex-1 bg-emerald-500 hover:bg-emerald-600\"\n                        >\n                          Approve BGC\n                        </Button>\n                        <Button\n                          onClick={handleRejectBGC}\n                          variant=\"outline\"\n                          className=\"flex-1 text-red-600 border-red-300\"\n                        >\n                          Reject BGC\n                        </Button>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Right Column - Product Verification and Insurance */}\n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"font-semibold text-slate-900 mb-2\">Product Information</h3>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                      <span className=\"text-sm text-slate-600\">Product Preference:</span>\n                      <Badge variant=\"outline\" className=\"capitalize\">\n                        {profile?.product_preference?.replace('-', ' ') || 'Not specified'}\n                      </Badge>\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                      <span className=\"text-sm text-slate-600\">Product Photos Verified:</span>\n                      <Badge className={profile?.product_photos_verified ? 'bg-green-500' : 'bg-amber-500'}>\n                        {profile?.product_photos_verified ? 'Verified' : 'Not Verified'}\n                      </Badge>\n                    </div>\n                  </div>\n                </div>\n\n                {profile?.product_verification_photos && profile.product_verification_photos.length > 0 && (\n                  <div>\n                    <h3 className=\"font-semibold text-slate-900 mb-2\">Product Photos</h3>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      {profile.product_verification_photos.map((url, index) => (\n                        <img\n                          key={index}\n                          src={url}\n                          alt={`Product ${index + 1}`}\n                          className=\"w-full h-32 object-cover rounded-lg border-2 border-slate-200\"\n                        />\n                      ))}\n                    </div>\n                    {!profile.product_photos_verified && (\n                      <Button\n                        onClick={async () => {\n                          try {\n                            await CleanerProfile.update(profile.id, {\n                              product_photos_verified: true\n                            });\n                            onUpdate();\n                            onClose();\n                          } catch (error) {\n                            console.error('Error verifying product photos:', error);\n                          }\n                        }}\n                        className=\"w-full mt-2 bg-green-500 hover:bg-green-600\"\n                      >\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        Verify Product Photos\n                      </Button>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <h3 className=\"font-semibold text-slate-900 mb-2\">Insurance Certificate</h3>\n                  {cleaner.insurance_certificate_url ? (\n                    <div className=\"space-y-2\">\n                      <a\n                        href={cleaner.insurance_certificate_url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"block p-3 bg-blue-50 border-2 border-blue-200 rounded-lg hover:bg-blue-100 transition-colors\"\n                      >\n                        <div className=\"flex items-center gap-2\">\n                          <FileText className=\"w-5 h-5 text-blue-600\" />\n                          <span className=\"text-sm font-medium text-blue-900\">View Certificate</span>\n                        </div>\n                      </a>\n                      <div className=\"flex items-center justify-between p-3 bg-slate-50 rounded-lg\">\n                        <span className=\"text-sm text-slate-600\">Insurance Verified:</span>\n                        <Badge className={cleaner.insurance_verified ? 'bg-green-500' : 'bg-amber-500'}>\n                          {cleaner.insurance_verified ? 'Verified' : 'Not Verified'}\n                        </Badge>\n                      </div>\n                      {!cleaner.insurance_verified && (\n                        <Button\n                          onClick={async () => {\n                            try {\n                              await User.update(cleaner.id, {\n                                insurance_verified: true\n                              });\n                              onUpdate();\n                              onClose();\n                            } catch (error) {\n                              console.error('Error verifying insurance:', error);\n                            }\n                          }}\n                          className=\"w-full bg-green-500 hover:bg-green-600\"\n                        >\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\n                          Verify Insurance\n                        </Button>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-slate-500 p-3 bg-slate-50 rounded-lg\">\n                      No insurance certificate uploaded\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"profile\" className=\"space-y-4\">\n            {profile ? (\n              <>\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"grid md:grid-cols-2 gap-6\">\n                      <div>\n                        <p className=\"text-sm text-slate-600 mb-1\">Email</p>\n                        <p className=\"font-medium text-slate-900\">{cleaner.email}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-slate-600 mb-1\">Phone</p>\n                        <p className=\"font-medium text-slate-900\">{cleaner.phone || 'N/A'}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-slate-600 mb-1\">Hourly Rate</p>\n                        <p className=\"font-medium text-slate-900\">${profile.hourly_rate}/hour</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-slate-600 mb-1\">Tier</p>\n                        <Badge>{profile.tier}</Badge>\n                      </div>\n                    </div>\n\n                    {profile.bio && (\n                      <div className=\"mt-4\">\n                        <p className=\"text-sm text-slate-600 mb-2\">Bio</p>\n                        <p className=\"text-slate-700\">{profile.bio}</p>\n                      </div>\n                    )}\n\n                    {profile.service_tags && profile.service_tags.length > 0 && (\n                      <div className=\"mt-4\">\n                        <p className=\"text-sm text-slate-600 mb-2\">Services</p>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {profile.service_tags.map((tag, idx) => (\n                            <Badge key={idx} variant=\"outline\">{tag}</Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n\n                    {profile.service_locations && profile.service_locations.length > 0 && (\n                      <div className=\"mt-4\">\n                        <p className=\"text-sm text-slate-600 mb-2\">Service Locations</p>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {profile.service_locations.map((loc, idx) => (\n                            <Badge key={idx} variant=\"outline\" className=\"flex items-center gap-1\">\n                              <MapPin className=\"w-3 h-3\" />\n                              {loc}\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </>\n            ) : (\n              <Card>\n                <CardContent className=\"p-6 text-center\">\n                  <p className=\"text-slate-500\">No profile created yet</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"performance\" className=\"space-y-4\">\n            {profile ? (\n              <>\n                <Card>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex justify-center mb-6\">\n                      <ReliabilityMeter score={profile.reliability_score} size=\"large\" />\n                    </div>\n\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      <div className=\"bg-emerald-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-emerald-600 mb-1\">On-Time Rate</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.on_time_rate}%</p>\n                      </div>\n                      <div className=\"bg-blue-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-blue-600 mb-1\">Photo Compliance</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.photo_compliance_rate}%</p>\n                      </div>\n                      <div className=\"bg-purple-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-purple-600 mb-1\">Average Rating</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.average_rating.toFixed(1)}</p>\n                      </div>\n                      <div className=\"bg-amber-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-amber-600 mb-1\">Total Jobs</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.total_jobs}</p>\n                      </div>\n                      <div className=\"bg-red-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-red-600 mb-1\">Dispute Rate</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.dispute_rate}%</p>\n                      </div>\n                      <div className=\"bg-slate-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-slate-600 mb-1\">No-Show Rate</p>\n                        <p className=\"text-2xl font-bold text-slate-900\">{profile.no_show_rate}%</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </>\n            ) : (\n              <Card>\n                <CardContent className=\"p-6 text-center\">\n                  <p className=\"text-slate-500\">No performance data available</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CleanerManagementTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CleanerTierDistribution.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\ClientCreditHistory.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"fix":{"range":[178,227],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[178,226],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":14,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":29,"fix":{"range":[407,419],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[406,418],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingDown' is defined but never used.","line":14,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":43,"fix":{"range":[419,433],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[418,432],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { History, TrendingUp, TrendingDown, Loader2, ArrowUpCircle, ArrowDownCircle } from 'lucide-react';\nimport { format } from 'date-fns';\n\nexport default function ClientCreditHistory({ clientEmail }) {\n  const [transactions, setTransactions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [currentBalance, setCurrentBalance] = useState(0);\n\n  useEffect(() => {\n    if (clientEmail) {\n      loadHistory();\n    }\n  }, [clientEmail]);\n\n  const loadHistory = async () => {\n    setLoading(true);\n    try {\n      const [txns, profiles] = await Promise.all([\n        base44.entities.CreditTransaction.filter({ client_email: clientEmail }),\n        base44.entities.ClientProfile.filter({ user_email: clientEmail })\n      ]);\n\n      const sorted = txns.sort((a, b) => \n        new Date(b.created_date) - new Date(a.created_date)\n      );\n\n      setTransactions(sorted);\n      setCurrentBalance(profiles[0]?.credits_balance || 0);\n    } catch (error) {\n      console.error('Error loading credit history:', error);\n    }\n    setLoading(false);\n  };\n\n  const getTransactionColor = (type) => {\n    const colors = {\n      purchase: 'bg-green-100 text-green-800',\n      promo: 'bg-purple-100 text-purple-800',\n      charge: 'bg-red-100 text-red-800',\n      refund: 'bg-blue-100 text-blue-800',\n      adjustment: 'bg-amber-100 text-amber-800',\n      late_cancel_charge: 'bg-orange-100 text-orange-800'\n    };\n    return colors[type] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getTransactionIcon = (amount) => {\n    return amount >= 0 ? (\n      <ArrowUpCircle className=\"w-4 h-4 text-green-600\" />\n    ) : (\n      <ArrowDownCircle className=\"w-4 h-4 text-red-600\" />\n    );\n  };\n\n  if (!clientEmail) {\n    return (\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <History className=\"w-6 h-6 text-purple-600\" />\n            Credit Transaction History\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-8 text-center\">\n          <p className=\"text-gray-500 font-verdana\">Select a client to view their credit history</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <History className=\"w-6 h-6 text-purple-600\" />\n            Credit Transaction History\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-8 flex justify-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <History className=\"w-6 h-6 text-purple-600\" />\n            Credit Transaction History\n          </CardTitle>\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600 font-verdana\">Current Balance</p>\n            <p className=\"text-2xl font-fredoka font-bold text-graphite\">{currentBalance.toLocaleString()} credits</p>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <p className=\"text-sm text-gray-600 font-verdana mb-4\">\n          Client: <span className=\"font-medium text-graphite\">{clientEmail}</span>\n        </p>\n\n        {transactions.length === 0 ? (\n          <div className=\"text-center py-8\">\n            <p className=\"text-gray-500 font-verdana\">No transactions found for this client</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto rounded-2xl border border-gray-200\">\n            <Table>\n              <TableHeader>\n                <TableRow className=\"bg-gray-50\">\n                  <TableHead className=\"font-fredoka\">Date</TableHead>\n                  <TableHead className=\"font-fredoka\">Type</TableHead>\n                  <TableHead className=\"font-fredoka text-right\">Amount</TableHead>\n                  <TableHead className=\"font-fredoka text-right\">Balance After</TableHead>\n                  <TableHead className=\"font-fredoka\">Note</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {transactions.map((txn) => (\n                  <TableRow key={txn.id} className=\"hover:bg-gray-50\">\n                    <TableCell className=\"font-verdana text-sm\">\n                      {format(new Date(txn.created_date), 'MMM dd, yyyy HH:mm')}\n                    </TableCell>\n                    <TableCell>\n                      <Badge className={getTransactionColor(txn.transaction_type)}>\n                        {txn.transaction_type.replace(/_/g, ' ')}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex items-center justify-end gap-2\">\n                        {getTransactionIcon(txn.amount_credits)}\n                        <span className={`font-fredoka font-semibold ${txn.amount_credits >= 0 ? 'text-green-600' : 'text-red-600'}`}>\n                          {txn.amount_credits >= 0 ? '+' : ''}{txn.amount_credits.toLocaleString()}\n                        </span>\n                      </div>\n                    </TableCell>\n                    <TableCell className=\"text-right font-verdana text-sm\">\n                      {txn.balance_after?.toLocaleString() || '-'}\n                    </TableCell>\n                    <TableCell className=\"font-verdana text-sm text-gray-600 max-w-xs truncate\">\n                      {txn.note || '-'}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\ClientJobDetailsModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":17,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":30,"fix":{"range":[606,619],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[605,618],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":17,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":39,"fix":{"range":[619,628],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[618,627],"text":""},"desc":"Remove unused variable 'XCircle'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onUpdate' is defined but never used. Allowed unused args must match /^_/u.","line":23,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":75,"suggestions":[{"messageId":"removeVar","data":{"varName":"onUpdate"},"fix":{"range":[871,881],"text":""},"desc":"Remove unused variable 'onUpdate'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":30,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[1204,1211],"text":""},"desc":"Remove unused variable 'loading'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport {\n  Calendar, Clock, MapPin, User, DollarSign, Home, Package,\n  Star, Camera, MessageSquare, AlertTriangle, FileText, Shield,\n  Sparkles, Info, CheckCircle, XCircle, TrendingUp\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport { ServiceBadge } from '../utils/serviceIcons';\n\nexport default function ClientJobDetailsModal({ booking, onClose, onUpdate }) {\n  const [clientProfile, setClientProfile] = useState(null);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [reviews, setReviews] = useState([]);\n  const [photos, setPhotos] = useState([]);\n  const [disputes, setDisputes] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadAdditionalData();\n  }, [booking]);\n\n  const loadAdditionalData = async () => {\n    setLoading(true);\n    try {\n      // Load client profile\n      const clientProfiles = await base44.entities.ClientProfile.filter({ user_email: booking.client_email });\n      if (clientProfiles.length > 0) setClientProfile(clientProfiles[0]);\n\n      // Load cleaner profile if assigned\n      if (booking.cleaner_email) {\n        const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: booking.cleaner_email });\n        if (cleanerProfiles.length > 0) setCleanerProfile(cleanerProfiles[0]);\n      }\n\n      // Load reviews\n      const bookingReviews = await base44.entities.Review.filter({ booking_id: booking.id });\n      setReviews(bookingReviews);\n\n      // Load photos\n      const bookingPhotos = await base44.entities.PhotoPair.filter({ booking_id: booking.id });\n      setPhotos(bookingPhotos);\n\n      // Load disputes\n      const bookingDisputes = await base44.entities.Dispute.filter({ booking_id: booking.id });\n      setDisputes(bookingDisputes);\n\n      // Load messages related to this booking\n      if (booking.cleaner_email) {\n        const allMessages = await base44.entities.Message.filter({ booking_id: booking.id });\n        setMessages(allMessages);\n      }\n    } catch (error) {\n      console.error('Error loading additional data:', error);\n    }\n    setLoading(false);\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      'available': 'bg-slate-100 text-slate-800',\n      'payment_hold': 'bg-amber-100 text-amber-800',\n      'awaiting_cleaner': 'bg-yellow-100 text-yellow-800',\n      'scheduled': 'bg-blue-100 text-blue-800',\n      'cleaning_now': 'bg-indigo-100 text-indigo-800',\n      'completed': 'bg-emerald-100 text-emerald-800',\n      'cancelled': 'bg-red-100 text-red-800',\n      'disputed': 'bg-orange-100 text-orange-800'\n    };\n    return colors[status] || 'bg-slate-100 text-slate-800';\n  };\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-3\">\n            <Calendar className=\"w-6 h-6 text-blue-500\" />\n            Complete Job Details\n            <Badge className={getStatusColor(booking.status)}>\n              {booking.status.replace(/_/g, ' ').toUpperCase()}\n            </Badge>\n          </DialogTitle>\n        </DialogHeader>\n\n        <Tabs defaultValue=\"overview\" className=\"w-full\">\n          <TabsList className=\"grid grid-cols-5 w-full\">\n            <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n            <TabsTrigger value=\"client\">Client Info</TabsTrigger>\n            <TabsTrigger value=\"cleaner\">Cleaner Info</TabsTrigger>\n            <TabsTrigger value=\"photos\">Photos</TabsTrigger>\n            <TabsTrigger value=\"communication\">Communication</TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            {/* Basic Booking Info */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-5 h-5 text-blue-500\" />\n                  Booking Information\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg\">\n                    <Calendar className=\"w-5 h-5 text-blue-500\" />\n                    <div>\n                      <p className=\"text-xs text-slate-500\">Date</p>\n                      <p className=\"font-medium\">{format(new Date(booking.date), 'MMMM d, yyyy')}</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg\">\n                    <Clock className=\"w-5 h-5 text-purple-500\" />\n                    <div>\n                      <p className=\"text-xs text-slate-500\">Time & Duration</p>\n                      <p className=\"font-medium\">{convertTo12Hour(booking.start_time)} ({booking.hours}h / ~{booking.estimated_hours || booking.hours}h estimated)</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg md:col-span-2\">\n                    <MapPin className=\"w-5 h-5 text-red-500\" />\n                    <div className=\"flex-1\">\n                      <p className=\"text-xs text-slate-500\">Address</p>\n                      <p className=\"font-medium\">{booking.address}</p>\n                      {booking.latitude && booking.longitude && (\n                        <p className=\"text-xs text-slate-400 mt-1\">\n                          GPS: {booking.latitude.toFixed(4)}, {booking.longitude.toFixed(4)}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-green-50 rounded-lg border border-green-200\">\n                    <DollarSign className=\"w-5 h-5 text-green-600\" />\n                    <div>\n                      <p className=\"text-xs text-slate-500\">Total Price</p>\n                      <p className=\"font-bold text-2xl text-green-600\">${booking.total_price.toFixed(2)}</p>\n                      <div className=\"mt-2 space-y-1\">\n                        <p className=\"text-xs text-slate-600\">\n                          Base Rate: {booking.snapshot_base_rate_cph || 'N/A'} credits/hr\n                        </p>\n                        <p className=\"text-xs text-slate-600\">\n                          Add-on: +{booking.snapshot_selected_addon_cph || 0} credits/hr ({booking.cleaning_type || 'basic'})\n                        </p>\n                        <p className=\"text-xs text-slate-600\">\n                          Total Rate: {booking.snapshot_total_rate_cph || 'N/A'} credits/hr\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-blue-50 rounded-lg border border-blue-200\">\n                    <Shield className=\"w-5 h-5 text-blue-600\" />\n                    <div>\n                      <p className=\"text-xs text-slate-500\">Escrow & Charges</p>\n                      <p className=\"text-sm font-semibold text-blue-900\">Reserved: {booking.escrow_credits_reserved || 0} credits</p>\n                      <p className=\"text-xs text-slate-600 mt-1\">\n                        Final Charge: {booking.final_charge_credits || 'Pending'} credits\n                      </p>\n                      {booking.refund_credits > 0 && (\n                        <p className=\"text-xs text-green-600\">\n                          Refunded: {booking.refund_credits} credits\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg\">\n                    <FileText className=\"w-5 h-5 text-slate-500\" />\n                    <div className=\"flex-1\">\n                      <p className=\"text-xs text-slate-500\">Booking ID</p>\n                      <p className=\"font-mono text-xs text-slate-700 break-all\">{booking.id}</p>\n                      <p className=\"text-xs text-slate-400 mt-1\">\n                        Created: {format(new Date(booking.created_date), 'MMM d, yyyy h:mm a')}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3 p-3 bg-purple-50 rounded-lg border border-purple-200\">\n                    <Sparkles className=\"w-5 h-5 text-purple-600\" />\n                    <div className=\"flex-1\">\n                      <p className=\"text-xs text-slate-500\">Cleaning Type</p>\n                      <Badge className=\"bg-purple-500 text-white capitalize mt-1\">\n                        {booking.cleaning_type || 'basic'}\n                      </Badge>\n                      {booking.matched_via_smart_algorithm && (\n                        <p className=\"text-xs text-purple-600 mt-1 flex items-center gap-1\">\n                          <Sparkles className=\"w-3 h-3\" />\n                          Smart Match\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n\n                {booking.price_multipliers && booking.price_multipliers.length > 0 && (\n                  <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                    <p className=\"font-semibold text-sm mb-2 flex items-center gap-2\">\n                      <TrendingUp className=\"w-4 h-4 text-blue-600\" />\n                      Price Breakdown\n                    </p>\n                    <div className=\"space-y-1\">\n                      {booking.price_multipliers.map((mult, idx) => (\n                        <div key={idx} className=\"text-sm flex justify-between\">\n                          <span className=\"text-slate-600\">{mult.reason}:</span>\n                          <span className=\"font-medium\">${mult.amount.toFixed(2)}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Home Details */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Home className=\"w-5 h-5 text-purple-500\" />\n                  Home Details\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid md:grid-cols-5 gap-4\">\n                  <div className=\"p-3 bg-slate-50 rounded-lg text-center\">\n                    <p className=\"text-2xl font-bold text-slate-900\">{booking.bedrooms}</p>\n                    <p className=\"text-xs text-slate-500\">Bedrooms</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg text-center\">\n                    <p className=\"text-2xl font-bold text-slate-900\">{booking.bathrooms}</p>\n                    <p className=\"text-xs text-slate-500\">Bathrooms</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg text-center\">\n                    <p className=\"text-2xl font-bold text-slate-900\">{booking.square_feet}</p>\n                    <p className=\"text-xs text-slate-500\">Square Feet</p>\n                  </div>\n                  <div className=\"p-3 bg-slate-50 rounded-lg text-center\">\n                    <p className=\"text-sm font-bold text-slate-900 capitalize\">{booking.home_type}</p>\n                    <p className=\"text-xs text-slate-500\">Type</p>\n                  </div>\n                  <div className=\"p-3 bg-amber-50 rounded-lg text-center border border-amber-200\">\n                    <p className=\"text-lg\">{booking.has_pets ? 'üêæ' : '‚ùå'}</p>\n                    <p className=\"text-xs text-slate-500\">Pets</p>\n                  </div>\n                </div>\n\n                {/* The following block was moved into the grid above as part of changes. */}\n                {/* {booking.has_pets && (\n                  <div className=\"mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200\">\n                    <p className=\"text-sm font-medium text-amber-800\">üêæ Home has pets</p>\n                  </div>\n                )} */}\n              </CardContent>\n            </Card>\n\n            {/* Tasks Requested */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Package className=\"w-5 h-5 text-emerald-500\" />\n                  Tasks Requested\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex flex-wrap gap-2\">\n                  {booking.tasks?.map((task, idx) => (\n                    <ServiceBadge key={idx} serviceName={task} />\n                  ))}\n                </div>\n\n                {booking.task_quantities && Object.keys(booking.task_quantities).length > 0 && (\n                  <div className=\"mt-4 p-4 bg-slate-50 rounded-lg\">\n                    <p className=\"font-semibold text-sm mb-2\">Quantities:</p>\n                    <div className=\"space-y-1\">\n                      {Object.entries(booking.task_quantities).map(([task, qty]) => (\n                        <div key={task} className=\"text-sm flex justify-between\">\n                          <span className=\"capitalize\">{task.replace(/_/g, ' ')}:</span>\n                          <span className=\"font-medium\">{qty}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Special Requests */}\n            {(booking.product_allergies || booking.product_preferences || booking.parking_instructions || booking.entry_instructions || booking.notes) && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Info className=\"w-5 h-5 text-blue-500\" />\n                    Special Requests & Instructions\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {booking.product_allergies && (\n                    <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n                      <p className=\"font-semibold text-sm text-red-800 mb-1 flex items-center gap-2\">\n                        <AlertTriangle className=\"w-4 h-4\" />\n                        Product Allergies\n                      </p>\n                      <p className=\"text-sm text-red-700\">{booking.product_allergies}</p>\n                    </div>\n                  )}\n\n                  {booking.product_preferences && (\n                    <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                      <p className=\"font-semibold text-sm text-blue-800 mb-1 flex items-center gap-2\">\n                        <Sparkles className=\"w-4 h-4\" />\n                        Product Preferences\n                      </p>\n                      <p className=\"text-sm text-blue-700\">{booking.product_preferences}</p>\n                    </div>\n                  )}\n\n                  {booking.parking_instructions && (\n                    <div className=\"p-4 bg-slate-50 rounded-lg\">\n                      <p className=\"font-semibold text-sm text-slate-700 mb-1\">üÖøÔ∏è Parking Instructions</p>\n                      <p className=\"text-sm text-slate-600\">{booking.parking_instructions}</p>\n                    </div>\n                  )}\n\n                  {booking.entry_instructions && (\n                    <div className=\"p-4 bg-slate-50 rounded-lg\">\n                      <p className=\"font-semibold text-sm text-slate-700 mb-1\">üö™ Entry Instructions</p>\n                      <p className=\"text-sm text-slate-600\">{booking.entry_instructions}</p>\n                    </div>\n                  )}\n\n                  {booking.notes && (\n                    <div className=\"p-4 bg-slate-50 rounded-lg\">\n                      <p className=\"font-semibold text-sm text-slate-700 mb-1\">üìù Additional Notes</p>\n                      <p className=\"text-sm text-slate-600\">{booking.notes}</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Check-in/Check-out */}\n            {(booking.check_in_time || booking.check_out_time) && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Clock className=\"w-5 h-5 text-green-500\" />\n                    Check-in / Check-out\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    {booking.check_in_time && (\n                      <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                        <p className=\"font-semibold text-sm text-green-800 mb-1\">‚úÖ Check-in</p>\n                        <p className=\"text-sm text-green-700\">\n                          {format(new Date(booking.check_in_time), 'MMM d, yyyy h:mm a')}\n                        </p>\n                        {booking.check_in_location && (\n                          <p className=\"text-xs text-green-600 mt-1\">{booking.check_in_location}</p>\n                        )}\n                      </div>\n                    )}\n\n                    {booking.check_out_time && (\n                      <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                        <p className=\"font-semibold text-sm text-blue-800 mb-1\">üèÅ Check-out</p>\n                        <p className=\"text-sm text-blue-700\">\n                          {format(new Date(booking.check_out_time), 'MMM d, yyyy h:mm a')}\n                        </p>\n                        {booking.check_out_location && (\n                          <p className=\"text-xs text-blue-600 mt-1\">{booking.check_out_location}</p>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Reviews */}\n            {reviews.length > 0 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Star className=\"w-5 h-5 text-amber-500\" />\n                    Client Review\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {reviews.map((review) => (\n                    <div key={review.id} className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        {[...Array(5)].map((_, i) => (\n                          <Star\n                            key={i}\n                            className={`w-5 h-5 ${i < review.rating ? 'fill-amber-500 text-amber-500' : 'text-slate-300'}`}\n                          />\n                        ))}\n                      </div>\n                      {review.comment && (\n                        <p className=\"text-sm text-slate-700 mb-3\">{review.comment}</p>\n                      )}\n                      <div className=\"flex flex-wrap gap-2\">\n                        {review.on_time && (\n                          <Badge className=\"bg-green-100 text-green-800\">On Time</Badge>\n                        )}\n                        {review.photo_quality && (\n                          <Badge className=\"bg-blue-100 text-blue-800\">Good Photos</Badge>\n                        )}\n                        {review.would_recommend && (\n                          <Badge className=\"bg-purple-100 text-purple-800\">Would Recommend</Badge>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Disputes */}\n            {disputes.length > 0 && (\n              <Card className=\"border-orange-200\">\n                <CardHeader className=\"bg-orange-50\">\n                  <CardTitle className=\"flex items-center gap-2 text-orange-800\">\n                    <AlertTriangle className=\"w-5 h-5\" />\n                    Disputes\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"pt-4\">\n                  {disputes.map((dispute) => (\n                    <div key={dispute.id} className=\"p-4 bg-orange-50 rounded-lg border border-orange-200 mb-3 last:mb-0\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <Badge className=\"bg-orange-500 text-white\">{dispute.category.replace(/_/g, ' ')}</Badge>\n                        <Badge variant=\"outline\">{dispute.status}</Badge>\n                      </div>\n                      <p className=\"text-sm text-slate-700 mb-2\">{dispute.description}</p>\n                      <p className=\"text-xs text-slate-500\">\n                        Filed by: {dispute.filed_by} ‚Ä¢ {format(new Date(dispute.created_date), 'MMM d, yyyy')}\n                      </p>\n                      {dispute.resolution && (\n                        <div className=\"mt-3 p-3 bg-white rounded border border-orange-200\">\n                          <p className=\"text-xs font-semibold text-slate-700 mb-1\">Resolution:</p>\n                          <p className=\"text-sm text-slate-600\">{dispute.resolution}</p>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          {/* Client Info Tab */}\n          <TabsContent value=\"client\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <User className=\"w-5 h-5 text-blue-500\" />\n                  Client Information\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"p-4 bg-blue-50 rounded-lg\">\n                  <p className=\"text-sm text-slate-600 mb-1\">Name</p>\n                  <p className=\"font-medium text-slate-900\">{booking.client_email}</p>\n                </div>\n\n                {clientProfile && (\n                  <>\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      <div className=\"p-4 bg-slate-50 rounded-lg\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Default Address</p>\n                        <p className=\"font-medium text-slate-900\">{clientProfile.default_address || 'Not set'}</p>\n                      </div>\n\n                      <div className=\"p-4 bg-slate-50 rounded-lg\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Home Size</p>\n                        <p className=\"font-medium text-slate-900 capitalize\">{clientProfile.home_size}</p>\n                      </div>\n\n                      <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Credits Balance</p>\n                        <p className=\"font-bold text-3xl text-green-600\">{clientProfile.credits_balance?.toFixed(0) || '0'}</p>\n                        <p className=\"text-xs text-slate-500 mt-1\">‚âà ${(clientProfile.credits_balance / 10).toFixed(2)} USD</p>\n                      </div>\n\n                      <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Membership Tier</p>\n                        <Badge className=\"bg-purple-500 text-white\">{clientProfile.membership_tier}</Badge>\n                        {clientProfile.membership_active && (\n                          <p className=\"text-xs text-green-600 mt-2\">‚úì Active Member</p>\n                        )}\n                      </div>\n\n                      <div className=\"p-4 bg-slate-50 rounded-lg\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Total Bookings</p>\n                        <p className=\"font-bold text-2xl text-slate-900\">{clientProfile.total_bookings}</p>\n                        {clientProfile.completed_first_booking && (\n                          <p className=\"text-xs text-green-600 mt-1\">‚úì Completed first booking</p>\n                        )}\n                      </div>\n\n                      <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                        <p className=\"text-sm text-slate-600 mb-1\">Grace Cancellations Left</p>\n                        <p className=\"font-bold text-2xl text-amber-600\">{clientProfile.grace_cancellations_left || 0}/2</p>\n                      </div>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Cleaner Info Tab */}\n          <TabsContent value=\"cleaner\" className=\"space-y-6\">\n            {booking.cleaner_email ? (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <User className=\"w-5 h-5 text-emerald-500\" />\n                    Cleaner Information\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"p-4 bg-emerald-50 rounded-lg\">\n                    <p className=\"text-sm text-slate-600 mb-1\">Email</p>\n                    <p className=\"font-medium text-slate-900\">{booking.cleaner_email}</p>\n                  </div>\n\n                  {cleanerProfile && (\n                    <>\n                      <div className=\"grid md:grid-cols-2 gap-4\">\n                        <div className=\"p-4 bg-slate-50 rounded-lg\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Full Name</p>\n                          <p className=\"font-medium text-slate-900\">{cleanerProfile.full_name}</p>\n                        </div>\n\n                        <div className=\"p-4 bg-slate-50 rounded-lg\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Hourly Rate</p>\n                          <p className=\"font-bold text-2xl text-emerald-600\">${cleanerProfile.hourly_rate}/hr</p>\n                        </div>\n\n                        <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Tier</p>\n                          <Badge className=\"bg-purple-500 text-white\">{cleanerProfile.tier}</Badge>\n                        </div>\n\n                        <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Reliability Score</p>\n                          <p className=\"font-bold text-2xl text-blue-600\">{cleanerProfile.reliability_score || 75}/100</p>\n                        </div>\n\n                        <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Average Rating</p>\n                          <div className=\"flex items-center gap-2\">\n                            <Star className=\"w-6 h-6 fill-amber-500 text-amber-500\" />\n                            <p className=\"font-bold text-2xl text-amber-600\">{cleanerProfile.average_rating.toFixed(1)}</p>\n                          </div>\n                          <p className=\"text-xs text-slate-500 mt-1\">({cleanerProfile.total_reviews} reviews)</p>\n                        </div>\n\n                        <div className=\"p-4 bg-slate-50 rounded-lg\">\n                          <p className=\"text-sm text-slate-600 mb-1\">Total Jobs</p>\n                          <p className=\"font-bold text-2xl text-slate-900\">{cleanerProfile.total_jobs}</p>\n                        </div>\n                      </div>\n\n                      <div className=\"p-4 bg-slate-50 rounded-lg\">\n                        <p className=\"text-sm font-semibold text-slate-700 mb-2\">Bio</p>\n                        <p className=\"text-sm text-slate-600\">{cleanerProfile.bio || 'No bio available'}</p>\n                      </div>\n\n                      {cleanerProfile.product_preference && (\n                        <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                          <p className=\"text-sm font-semibold text-slate-700 mb-1 flex items-center gap-2\">\n                            <Sparkles className=\"w-4 h-4 text-green-600\" />\n                            Product Preference\n                          </p>\n                          <Badge className=\"bg-green-500 text-white capitalize\">\n                            {cleanerProfile.product_preference.replace(/-/g, ' ')}\n                          </Badge>\n                        </div>\n                      )}\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            ) : (\n              <Card>\n                <CardContent className=\"p-12 text-center\">\n                  <User className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n                  <p className=\"text-slate-500\">No cleaner assigned to this booking yet</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          {/* Photos Tab */}\n          <TabsContent value=\"photos\" className=\"space-y-6\">\n            {photos.length > 0 ? (\n              <div className=\"grid md:grid-cols-2 gap-6\">\n                {photos.map((photo) => (\n                  <Card key={photo.id}>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2 capitalize\">\n                        <Camera className=\"w-5 h-5 text-blue-500\" />\n                        {photo.area}\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <div>\n                        <p className=\"text-sm font-semibold text-slate-700 mb-2\">Before</p>\n                        <img\n                          src={photo.before_photo_url}\n                          alt=\"Before\"\n                          className=\"w-full h-48 object-cover rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-semibold text-slate-700 mb-2\">After</p>\n                        <img\n                          src={photo.after_photo_url}\n                          alt=\"After\"\n                          className=\"w-full h-48 object-cover rounded-lg\"\n                        />\n                      </div>\n                      <p className=\"text-xs text-slate-500\">\n                        Uploaded: {format(new Date(photo.upload_timestamp), 'MMM d, yyyy h:mm a')}\n                      </p>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <Card>\n                <CardContent className=\"p-12 text-center\">\n                  <Camera className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n                  <p className=\"text-slate-500\">No photos uploaded for this job yet</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          {/* Communication Tab */}\n          <TabsContent value=\"communication\" className=\"space-y-6\">\n            {messages.length > 0 ? (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <MessageSquare className=\"w-5 h-5 text-blue-500\" />\n                    Messages ({messages.length})\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n                    {messages.map((message) => (\n                      <div\n                        key={message.id}\n                        className={`p-3 rounded-lg ${\n                          message.sender_email === booking.client_email\n                            ? 'bg-blue-50 border border-blue-200'\n                            : 'bg-emerald-50 border border-emerald-200'\n                        }`}\n                      >\n                        <div className=\"flex items-center justify-between mb-1\">\n                          <p className=\"text-xs font-semibold text-slate-700\">\n                            {message.sender_email === booking.client_email ? 'Client' : 'Cleaner'}\n                          </p>\n                          <p className=\"text-xs text-slate-500\">\n                            {format(new Date(message.created_date), 'MMM d, h:mm a')}\n                          </p>\n                        </div>\n                        <p className=\"text-sm text-slate-700\">{message.content}</p>\n                        {message.attachment_url && (\n                          <a\n                            href={message.attachment_url}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-xs text-blue-600 hover:underline mt-2 inline-block\"\n                          >\n                            View Attachment\n                          </a>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            ) : (\n              <Card>\n                <CardContent className=\"p-12 text-center\">\n                  <MessageSquare className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n                  <p className=\"text-slate-500\">No messages exchanged for this booking</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n        </Tabs>\n\n        <div className=\"flex justify-end pt-4 border-t\">\n          <Button onClick={onClose} variant=\"outline\">\n            Close\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\ClientSearchSelector.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":22,"fix":{"range":[314,320],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[313,319],"text":""},"desc":"Remove unused variable 'User'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Search, User, Mail, Loader2, X } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\n\nexport default function ClientSearchSelector({ onSelectClient, selectedEmail }) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [searching, setSearching] = useState(false);\n  const [showResults, setShowResults] = useState(false);\n\n  useEffect(() => {\n    const delaySearch = setTimeout(() => {\n      if (searchTerm.length >= 2) {\n        performSearch();\n      } else {\n        setSearchResults([]);\n        setShowResults(false);\n      }\n    }, 300);\n\n    return () => clearTimeout(delaySearch);\n  }, [searchTerm]);\n\n  const performSearch = async () => {\n    setSearching(true);\n    try {\n      const profiles = await base44.entities.ClientProfile.list();\n      const users = await base44.entities.User.list();\n      \n      const userMap = {};\n      users.forEach(u => {\n        userMap[u.email] = u;\n      });\n\n      const filtered = profiles.filter(profile => {\n        const user = userMap[profile.user_email];\n        const searchLower = searchTerm.toLowerCase();\n        return (\n          profile.user_email?.toLowerCase().includes(searchLower) ||\n          user?.full_name?.toLowerCase().includes(searchLower) ||\n          profile.client_id?.toLowerCase().includes(searchLower)\n        );\n      }).slice(0, 10);\n\n      const enriched = filtered.map(profile => ({\n        ...profile,\n        full_name: userMap[profile.user_email]?.full_name || 'Unknown'\n      }));\n\n      setSearchResults(enriched);\n      setShowResults(true);\n    } catch (error) {\n      console.error('Search error:', error);\n    }\n    setSearching(false);\n  };\n\n  const handleSelect = (client) => {\n    onSelectClient(client);\n    setSearchTerm('');\n    setShowResults(false);\n  };\n\n  const clearSelection = () => {\n    onSelectClient(null);\n  };\n\n  if (selectedEmail) {\n    return (\n      <div className=\"space-y-2\">\n        <Label className=\"font-fredoka font-medium text-graphite\">Selected Client</Label>\n        <div className=\"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-full\">\n          <Mail className=\"w-4 h-4 text-puretask-blue\" />\n          <span className=\"font-verdana text-sm flex-1\">{selectedEmail}</span>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={clearSelection}\n            className=\"h-6 w-6 p-0 rounded-full hover:bg-blue-100\"\n          >\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative space-y-2\">\n      <Label className=\"font-fredoka font-medium text-graphite\">Search Client</Label>\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n        <Input\n          type=\"text\"\n          placeholder=\"Search by name, email, or client ID...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n          onFocus={() => searchResults.length > 0 && setShowResults(true)}\n          className=\"pl-10 pr-10 rounded-full font-verdana\"\n        />\n        {searching && (\n          <Loader2 className=\"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 animate-spin text-puretask-blue\" />\n        )}\n      </div>\n\n      {showResults && searchResults.length > 0 && (\n        <Card className=\"absolute z-50 w-full mt-1 shadow-xl border-2 border-blue-200 rounded-2xl max-h-80 overflow-y-auto\">\n          <CardContent className=\"p-2\">\n            {searchResults.map((client) => (\n              <button\n                key={client.id}\n                onClick={() => handleSelect(client)}\n                className=\"w-full text-left p-3 rounded-xl hover:bg-blue-50 transition-colors\"\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-cyan-400 flex items-center justify-center text-white font-fredoka font-bold\">\n                    {client.full_name[0] || 'C'}\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-fredoka font-medium text-graphite truncate\">{client.full_name}</p>\n                    <p className=\"text-sm text-gray-600 font-verdana truncate\">{client.user_email}</p>\n                    <div className=\"flex items-center gap-2 mt-1\">\n                      {client.client_id && (\n                        <Badge variant=\"outline\" className=\"text-xs\">ID: {client.client_id}</Badge>\n                      )}\n                      <Badge variant=\"outline\" className=\"text-xs\">{client.credits_balance || 0} credits</Badge>\n                    </div>\n                  </div>\n                </div>\n              </button>\n            ))}\n          </CardContent>\n        </Card>\n      )}\n\n      {showResults && searchResults.length === 0 && searchTerm.length >= 2 && !searching && (\n        <Card className=\"absolute z-50 w-full mt-1 shadow-xl border-2 border-gray-200 rounded-2xl\">\n          <CardContent className=\"p-4 text-center\">\n            <p className=\"text-sm text-gray-500 font-verdana\">No clients found matching \"{searchTerm}\"</p>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CreditCampaignManager.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Textarea' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":18,"fix":{"range":[218,271],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Textarea"},"fix":{"range":[218,270],"text":""},"desc":"Remove unused variable 'Textarea'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":15,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":26,"fix":{"range":[517,524],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[516,523],"text":""},"desc":"Remove unused variable 'Users'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Megaphone, Users, DollarSign, Calendar, Loader2, AlertCircle, CheckCircle } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\nimport { Badge } from '@/components/ui/badge';\n\nexport default function CreditCampaignManager() {\n  const [campaignName, setCampaignName] = useState('');\n  const [targetAudience, setTargetAudience] = useState('all_clients');\n  const [creditAmount, setCreditAmount] = useState('');\n  const [validityDays, setValidityDays] = useState('30');\n  const [promoCode, setPromoCode] = useState('');\n  const [processing, setProcessing] = useState(false);\n  const [result, setResult] = useState(null);\n\n  const audienceOptions = [\n    { value: 'all_clients', label: 'All Clients', description: 'Every client in the system' },\n    { value: 'new_signups', label: 'New Sign-ups (Last 30 Days)', description: 'Recently registered clients' },\n    { value: 'inactive_clients', label: 'Inactive Clients (3+ Months)', description: 'No bookings in 90 days' },\n    { value: 'zero_balance', label: 'Zero Credit Balance', description: 'Clients with 0 credits' },\n    { value: 'first_booking_incomplete', label: 'First Booking Not Completed', description: 'Signed up but no bookings' }\n  ];\n\n  const getTargetedClients = async () => {\n    const now = new Date();\n    const thirtyDaysAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\n    const ninetyDaysAgo = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);\n\n    const allProfiles = await base44.entities.ClientProfile.list();\n\n    switch (targetAudience) {\n      case 'all_clients':\n        return allProfiles;\n      \n      case 'new_signups':\n        return allProfiles.filter(p => new Date(p.created_date) >= thirtyDaysAgo);\n      \n      case 'inactive_clients':\n        const bookings = await base44.entities.Booking.list();\n        const recentBookings = new Set(\n          bookings\n            .filter(b => new Date(b.created_date) >= ninetyDaysAgo)\n            .map(b => b.client_email)\n        );\n        return allProfiles.filter(p => !recentBookings.has(p.user_email));\n      \n      case 'zero_balance':\n        return allProfiles.filter(p => (p.credits_balance || 0) === 0);\n      \n      case 'first_booking_incomplete':\n        return allProfiles.filter(p => !p.completed_first_booking);\n      \n      default:\n        return allProfiles;\n    }\n  };\n\n  const handleRunCampaign = async () => {\n    if (!campaignName || !creditAmount || !promoCode) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n\n    const credits = parseFloat(creditAmount);\n    if (isNaN(credits) || credits <= 0) {\n      toast.error('Please enter a valid credit amount');\n      return;\n    }\n\n    setProcessing(true);\n    setResult(null);\n\n    try {\n      const user = await base44.auth.me();\n      const targetedClients = await getTargetedClients();\n\n      if (targetedClients.length === 0) {\n        toast.error('No clients match the selected audience criteria');\n        setProcessing(false);\n        return;\n      }\n\n      // Confirm with admin\n      const confirmed = window.confirm(\n        `This will grant ${credits} credits to ${targetedClients.length} client(s). Continue?`\n      );\n\n      if (!confirmed) {\n        setProcessing(false);\n        return;\n      }\n\n      let successCount = 0;\n      let errorCount = 0;\n\n      for (const client of targetedClients) {\n        try {\n          const currentBalance = client.credits_balance || 0;\n          const newBalance = currentBalance + credits;\n\n          // Update balance\n          await base44.entities.ClientProfile.update(client.id, {\n            credits_balance: newBalance\n          });\n\n          // Create transaction\n          await base44.entities.CreditTransaction.create({\n            client_email: client.user_email,\n            transaction_type: 'promo',\n            amount_credits: credits,\n            note: `Campaign: ${campaignName} (${promoCode})`,\n            balance_after: newBalance\n          });\n\n          successCount++;\n        } catch (error) {\n          console.error(`Error granting to ${client.user_email}:`, error);\n          errorCount++;\n        }\n      }\n\n      // Log campaign\n      await base44.entities.Event.create({\n        event_type: 'admin_action',\n        user_email: user.email,\n        details: `Ran credit campaign \"${campaignName}\": ${credits} credits to ${successCount} clients. Audience: ${targetAudience}`,\n        timestamp: new Date().toISOString()\n      });\n\n      setResult({\n        success: true,\n        successCount,\n        errorCount,\n        totalTargeted: targetedClients.length\n      });\n\n      toast.success(`Campaign completed! ${successCount} credits granted successfully.`);\n\n      // Reset form\n      setCampaignName('');\n      setCreditAmount('');\n      setPromoCode('');\n    } catch (error) {\n      console.error('Campaign error:', error);\n      toast.error('Failed to run campaign');\n      setResult({\n        success: false,\n        message: error.message\n      });\n    }\n\n    setProcessing(false);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-pink-50 to-rose-50 rounded-t-2xl\">\n        <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n          <Megaphone className=\"w-6 h-6 text-pink-600\" />\n          Credit Promotion Campaign\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <Alert className=\"border-pink-200 bg-pink-50 rounded-2xl\">\n          <AlertCircle className=\"w-4 h-4 text-pink-600\" />\n          <AlertDescription className=\"text-pink-900 font-verdana\">\n            Create automated credit campaigns to grant credits to specific client segments for marketing and retention purposes.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          <div className=\"space-y-4\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Campaign Name *</Label>\n              <Input\n                type=\"text\"\n                placeholder=\"e.g., Spring Welcome Bonus\"\n                value={campaignName}\n                onChange={(e) => setCampaignName(e.target.value)}\n                className=\"rounded-full font-verdana\"\n              />\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Target Audience *</Label>\n              <Select value={targetAudience} onValueChange={setTargetAudience}>\n                <SelectTrigger className=\"rounded-full font-verdana\">\n                  <SelectValue placeholder=\"Select audience\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {audienceOptions.map(opt => (\n                    <SelectItem key={opt.value} value={opt.value}>\n                      <div>\n                        <p className=\"font-medium\">{opt.label}</p>\n                        <p className=\"text-xs text-gray-500\">{opt.description}</p>\n                      </div>\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Credits per Client *</Label>\n              <div className=\"relative\">\n                <DollarSign className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <Input\n                  type=\"number\"\n                  placeholder=\"50\"\n                  value={creditAmount}\n                  onChange={(e) => setCreditAmount(e.target.value)}\n                  min=\"1\"\n                  className=\"pl-10 rounded-full font-verdana\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Validity Period (Days)</Label>\n              <div className=\"relative\">\n                <Calendar className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <Input\n                  type=\"number\"\n                  placeholder=\"30\"\n                  value={validityDays}\n                  onChange={(e) => setValidityDays(e.target.value)}\n                  min=\"1\"\n                  className=\"pl-10 rounded-full font-verdana\"\n                />\n              </div>\n              <p className=\"text-xs text-gray-500 font-verdana mt-1\">Optional expiration period</p>\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Promo Code / Reference *</Label>\n              <Input\n                type=\"text\"\n                placeholder=\"SPRING2024\"\n                value={promoCode}\n                onChange={(e) => setPromoCode(e.target.value)}\n                className=\"rounded-full font-verdana uppercase\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex flex-col justify-center\">\n            <div className=\"p-8 bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl border-2 border-pink-300 text-center\">\n              <Megaphone className=\"w-16 h-16 text-pink-600 mx-auto mb-4\" />\n              <p className=\"text-sm text-gray-600 font-verdana mb-2\">Campaign Preview</p>\n              <p className=\"text-4xl font-fredoka font-bold text-pink-600 mb-1\">\n                {creditAmount || '0'}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana mb-4\">credits per client</p>\n              <Badge className=\"bg-pink-600 text-white font-fredoka text-sm px-4 py-1 mb-6\">\n                {audienceOptions.find(o => o.value === targetAudience)?.label || 'Select audience'}\n              </Badge>\n              <Button\n                onClick={handleRunCampaign}\n                disabled={processing || !campaignName || !creditAmount || !promoCode}\n                className=\"w-full bg-pink-600 hover:bg-pink-700 text-white rounded-full font-fredoka font-semibold\"\n                size=\"lg\"\n              >\n                {processing ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Running Campaign...\n                  </>\n                ) : (\n                  <>\n                    <Megaphone className=\"w-5 h-5 mr-2\" />\n                    Run Campaign\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {result && (\n          <Alert className={`rounded-2xl ${result.success ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}`}>\n            {result.success ? (\n              <CheckCircle className=\"w-4 h-4 text-green-600\" />\n            ) : (\n              <AlertCircle className=\"w-4 h-4 text-red-600\" />\n            )}\n            <AlertDescription className={`font-verdana ${result.success ? 'text-green-900' : 'text-red-900'}`}>\n              {result.success ? (\n                <>\n                  <p className=\"font-medium mb-2\">Campaign Completed Successfully!</p>\n                  <p className=\"text-sm\">‚úì {result.successCount} client(s) received credits</p>\n                  {result.errorCount > 0 && (\n                    <p className=\"text-sm text-amber-700\">‚ö† {result.errorCount} failed</p>\n                  )}\n                  <p className=\"text-sm\">Total targeted: {result.totalTargeted}</p>\n                </>\n              ) : (\n                <p>Error: {result.message}</p>\n              )}\n            </AlertDescription>\n          </Alert>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CreditDebitTool.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":8,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":49,"fix":{"range":[419,432],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[418,431],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { AlertTriangle, MinusCircle, AlertCircle, Loader2 } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\n\nexport default function CreditDebitTool({ clientEmail, onSuccess }) {\n  const [amount, setAmount] = useState('');\n  const [reason, setReason] = useState('');\n  const [processing, setProcessing] = useState(false);\n\n  const handleDebit = async () => {\n    if (!clientEmail || !amount || !reason.trim()) {\n      toast.error('Please fill in all fields');\n      return;\n    }\n\n    const credits = parseFloat(amount);\n    if (isNaN(credits) || credits <= 0) {\n      toast.error('Please enter a valid credit amount');\n      return;\n    }\n\n    setProcessing(true);\n\n    try {\n      const user = await base44.auth.me();\n      \n      // Find client profile\n      const profiles = await base44.entities.ClientProfile.filter({ user_email: clientEmail });\n      if (profiles.length === 0) {\n        toast.error('Client profile not found');\n        setProcessing(false);\n        return;\n      }\n\n      const clientProfile = profiles[0];\n      const currentBalance = clientProfile.credits_balance || 0;\n\n      // Check if client has enough credits\n      if (currentBalance < credits) {\n        toast.error(`Insufficient balance. Client only has ${currentBalance} credits.`);\n        setProcessing(false);\n        return;\n      }\n\n      // Update client wallet balance (deduct)\n      const newBalance = currentBalance - credits;\n      await base44.entities.ClientProfile.update(clientProfile.id, {\n        credits_balance: newBalance\n      });\n\n      // Create ledger entry with negative amount\n      await base44.entities.CreditTransaction.create({\n        client_email: clientEmail,\n        transaction_type: 'refund',\n        amount_credits: -credits, // Negative for debit\n        note: `Admin debit: ${reason}`,\n        balance_after: newBalance\n      });\n\n      // Log admin action\n      await base44.entities.Event.create({\n        event_type: 'admin_action',\n        user_email: user.email,\n        details: `Debited ${credits} credits from ${clientEmail}. Reason: ${reason}`,\n        timestamp: new Date().toISOString()\n      });\n\n      toast.success(`Successfully debited ${credits} credits from ${clientEmail}`);\n      \n      if (onSuccess) onSuccess();\n\n      // Reset form\n      setAmount('');\n      setReason('');\n    } catch (error) {\n      console.error('Error debiting credits:', error);\n      toast.error('Failed to debit credits');\n    }\n\n    setProcessing(false);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl border-2 border-red-200\">\n      <CardHeader className=\"bg-gradient-to-r from-red-50 to-orange-50 rounded-t-2xl\">\n        <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n          <MinusCircle className=\"w-6 h-6 text-red-600\" />\n          Debit/Refund Credits\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <Alert className=\"border-red-300 bg-red-50 rounded-2xl\">\n          <AlertTriangle className=\"w-4 h-4 text-red-600\" />\n          <AlertDescription className=\"text-red-900 font-verdana\">\n            <strong>Use with caution:</strong> This will remove credits from the client's account. \n            Use for refunds, corrections, or penalties. All actions are logged.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"space-y-4\">\n          <div>\n            <Label htmlFor=\"debit_client_email\" className=\"font-fredoka text-graphite\">Client Email</Label>\n            <Input\n              id=\"debit_client_email\"\n              type=\"email\"\n              value={clientEmail || ''}\n              disabled\n              className=\"rounded-full font-verdana bg-gray-50\"\n            />\n          </div>\n\n          <div>\n            <Label htmlFor=\"debit_amount\" className=\"font-fredoka text-graphite\">Credits to Debit</Label>\n            <div className=\"relative\">\n              <MinusCircle className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-red-500\" />\n              <Input\n                id=\"debit_amount\"\n                type=\"number\"\n                value={amount}\n                onChange={(e) => setAmount(e.target.value)}\n                placeholder=\"50\"\n                min=\"1\"\n                step=\"10\"\n                className=\"pl-10 rounded-full font-verdana border-red-200 focus:border-red-300\"\n              />\n            </div>\n            <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n              Amount will be deducted from client's balance\n            </p>\n          </div>\n\n          <div>\n            <Label htmlFor=\"debit_reason\" className=\"font-fredoka text-graphite\">Reason for Debit *</Label>\n            <Textarea\n              id=\"debit_reason\"\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Refund for cancelled booking, penalty for violation, correction of error...\"\n              rows={3}\n              className=\"rounded-2xl font-verdana border-red-200 focus:border-red-300\"\n            />\n          </div>\n\n          <Button\n            onClick={handleDebit}\n            disabled={processing || !clientEmail || !amount || !reason.trim()}\n            className=\"w-full bg-red-600 hover:bg-red-700 text-white rounded-full font-fredoka font-semibold\"\n            size=\"lg\"\n          >\n            {processing ? (\n              <>\n                <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                Processing...\n              </>\n            ) : (\n              <>\n                <MinusCircle className=\"w-5 h-5 mr-2\" />\n                Debit {amount || '0'} Credits\n              </>\n            )}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CreditGrantTool.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\CreditManagementGuide.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\DisputeManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[429,436],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[430,436],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":9,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[435,453],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[435,453],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":10,"fix":{"range":[528,540],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[527,539],"text":""},"desc":"Remove unused variable 'XCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ExternalLink' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15,"fix":{"range":[540,557],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ExternalLink"},"fix":{"range":[539,556],"text":""},"desc":"Remove unused variable 'ExternalLink'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  AlertTriangle, \n  CheckCircle, \n  XCircle, \n  ExternalLink,\n  Loader2,\n  Eye\n} from 'lucide-react';\nimport { formatBookingDate } from '../utils/dateHelpers';\n\nexport default function DisputeManagement() {\n  const [disputes, setDisputes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedDispute, setSelectedDispute] = useState(null);\n  const [resolution, setResolution] = useState('');\n  const [refundAmount, setRefundAmount] = useState('');\n  const [creditAmount, setCreditAmount] = useState('');\n  const [resolving, setResolving] = useState(false);\n\n  useEffect(() => {\n    loadDisputes();\n  }, []);\n\n  const loadDisputes = async () => {\n    try {\n      const allDisputes = await base44.entities.Dispute.list('-created_date');\n      setDisputes(allDisputes);\n    } catch (error) {\n      console.error('Error loading disputes:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleResolve = async (status) => {\n    if (!resolution.trim()) {\n      alert('Please provide resolution notes');\n      return;\n    }\n\n    setResolving(true);\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Update dispute\n      await base44.entities.Dispute.update(selectedDispute.id, {\n        status: status,\n        resolution: resolution.trim(),\n        refund_amount: parseFloat(refundAmount) || 0,\n        credit_issued: parseFloat(creditAmount) || 0,\n        resolved_by: currentUser.email,\n        resolved_at: new Date().toISOString()\n      });\n\n      // Issue refund if specified\n      if (parseFloat(refundAmount) > 0) {\n        const booking = await base44.entities.Booking.get(selectedDispute.booking_id);\n        await base44.entities.Payment.create({\n          booking_id: booking.id,\n          client_email: booking.client_email,\n          cleaner_email: booking.cleaner_email,\n          amount: -parseFloat(refundAmount),\n          platform_fee: 0,\n          cleaner_payout: 0,\n          status: 'completed',\n          payment_method: 'refund'\n        });\n      }\n\n      // Issue credit if specified\n      if (parseFloat(creditAmount) > 0) {\n        const booking = await base44.entities.Booking.get(selectedDispute.booking_id);\n        await base44.entities.Credit.create({\n          client_email: booking.client_email,\n          amount: parseFloat(creditAmount),\n          reason: 'dispute_resolution',\n          booking_id: booking.id,\n          used: false\n        });\n      }\n\n      // Update booking status\n      const booking = await base44.entities.Booking.get(selectedDispute.booking_id);\n      await base44.entities.Booking.update(booking.id, {\n        status: status === 'resolved' ? 'completed' : 'disputed'\n      });\n\n      setSelectedDispute(null);\n      loadDisputes();\n    } catch (error) {\n      console.error('Error resolving dispute:', error);\n      alert('Failed to resolve dispute. Please try again.');\n    }\n    setResolving(false);\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'open': return 'bg-red-500';\n      case 'investigating': return 'bg-amber-500';\n      case 'resolved': return 'bg-green-500';\n      case 'closed': return 'bg-slate-500';\n      default: return 'bg-slate-500';\n    }\n  };\n\n  const getCategoryLabel = (category) => {\n    const labels = {\n      quality_issue: 'Quality Issue',\n      no_show: 'No Show',\n      late_arrival: 'Late Arrival',\n      damage: 'Property Damage',\n      safety_concern: 'Safety Concern',\n      payment_issue: 'Payment Issue',\n      other: 'Other'\n    };\n    return labels[category] || category;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-12\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-slate-400\" />\n      </div>\n    );\n  }\n\n  const openDisputes = disputes.filter(d => d.status === 'open' || d.status === 'investigating');\n  const resolvedDisputes = disputes.filter(d => d.status === 'resolved' || d.status === 'closed');\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Stats */}\n      <div className=\"grid md:grid-cols-3 gap-4\">\n        <Card className=\"border-0 shadow-md\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Open Disputes</p>\n                <p className=\"text-3xl font-bold text-red-600\">{openDisputes.length}</p>\n              </div>\n              <AlertTriangle className=\"w-10 h-10 text-red-500\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-md\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Resolved This Month</p>\n                <p className=\"text-3xl font-bold text-green-600\">{resolvedDisputes.length}</p>\n              </div>\n              <CheckCircle className=\"w-10 h-10 text-green-500\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-md\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Total Disputes</p>\n                <p className=\"text-3xl font-bold text-slate-900\">{disputes.length}</p>\n              </div>\n              <AlertTriangle className=\"w-10 h-10 text-slate-400\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Open Disputes */}\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <AlertTriangle className=\"w-5 h-5 text-red-500\" />\n            Open Disputes Requiring Action\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {openDisputes.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <CheckCircle className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n              <p className=\"text-lg text-slate-600\">No open disputes - great job!</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {openDisputes.map(dispute => (\n                <Card key={dispute.id} className=\"border-2 border-red-200\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div>\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <Badge className={getStatusColor(dispute.status)}>\n                            {dispute.status}\n                          </Badge>\n                          <Badge variant=\"outline\">{getCategoryLabel(dispute.category)}</Badge>\n                          <span className=\"text-sm text-slate-500\">\n                            Filed by: {dispute.filed_by}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-slate-600 mb-1\">\n                          Booking ID: {dispute.booking_id.slice(0, 8)}\n                        </p>\n                        <p className=\"text-sm text-slate-600\">\n                          Filed: {formatBookingDate(dispute.created_date)}\n                        </p>\n                      </div>\n                      <Button\n                        onClick={() => {\n                          setSelectedDispute(dispute);\n                          setResolution('');\n                          setRefundAmount('');\n                          setCreditAmount('');\n                        }}\n                        size=\"sm\"\n                      >\n                        <Eye className=\"w-4 h-4 mr-2\" />\n                        Review\n                      </Button>\n                    </div>\n\n                    <div className=\"bg-slate-50 p-4 rounded-lg\">\n                      <p className=\"text-sm text-slate-700\">{dispute.description}</p>\n                    </div>\n\n                    {dispute.evidence_photos && dispute.evidence_photos.length > 0 && (\n                      <div className=\"mt-3\">\n                        <p className=\"text-xs text-slate-600 mb-2\">Evidence Photos:</p>\n                        <div className=\"flex gap-2\">\n                          {dispute.evidence_photos.map((url, idx) => (\n                            <img\n                              key={idx}\n                              src={url}\n                              alt={`Evidence ${idx + 1}`}\n                              className=\"w-20 h-20 object-cover rounded border cursor-pointer\"\n                              onClick={() => window.open(url, '_blank')}\n                            />\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Dispute Resolution Modal */}\n      {selectedDispute && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6\">\n          <Card className=\"max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <CardHeader>\n              <CardTitle>Resolve Dispute</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              {/* Dispute Details */}\n              <div className=\"bg-slate-50 p-4 rounded-lg\">\n                <h4 className=\"font-semibold mb-2\">Dispute Details</h4>\n                <p className=\"text-sm text-slate-700 mb-2\">\n                  <strong>Category:</strong> {getCategoryLabel(selectedDispute.category)}\n                </p>\n                <p className=\"text-sm text-slate-700 mb-2\">\n                  <strong>Filed by:</strong> {selectedDispute.filed_by} ({selectedDispute.user_email})\n                </p>\n                <p className=\"text-sm text-slate-700\">\n                  <strong>Description:</strong> {selectedDispute.description}\n                </p>\n              </div>\n\n              {/* Evidence Photos */}\n              {selectedDispute.evidence_photos && selectedDispute.evidence_photos.length > 0 && (\n                <div>\n                  <Label>Evidence Photos</Label>\n                  <div className=\"flex flex-wrap gap-2 mt-2\">\n                    {selectedDispute.evidence_photos.map((url, idx) => (\n                      <img\n                        key={idx}\n                        src={url}\n                        alt={`Evidence ${idx + 1}`}\n                        className=\"w-32 h-32 object-cover rounded border cursor-pointer\"\n                        onClick={() => window.open(url, '_blank')}\n                      />\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Resolution Notes */}\n              <div>\n                <Label>Resolution Notes *</Label>\n                <Textarea\n                  value={resolution}\n                  onChange={(e) => setResolution(e.target.value)}\n                  placeholder=\"Explain how this dispute was resolved and any actions taken...\"\n                  rows={4}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              {/* Refund Amount */}\n              <div>\n                <Label>Refund Amount ($)</Label>\n                <Input\n                  type=\"number\"\n                  value={refundAmount}\n                  onChange={(e) => setRefundAmount(e.target.value)}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                  className=\"mt-2\"\n                />\n              </div>\n\n              {/* Credit Amount */}\n              <div>\n                <Label>Credit to Issue ($)</Label>\n                <Input\n                  type=\"number\"\n                  value={creditAmount}\n                  onChange={(e) => setCreditAmount(e.target.value)}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                  className=\"mt-2\"\n                />\n                <p className=\"text-xs text-slate-500 mt-1\">\n                  Credits can be used towards future bookings\n                </p>\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setSelectedDispute(null)}\n                  className=\"flex-1\"\n                  disabled={resolving}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={() => handleResolve('resolved')}\n                  disabled={resolving || !resolution.trim()}\n                  className=\"flex-1 bg-green-600 hover:bg-green-700\"\n                >\n                  {resolving ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Resolving...\n                    </>\n                  ) : (\n                    <>\n                      <CheckCircle className=\"w-4 h-4 mr-2\" />\n                      Mark as Resolved\n                    </>\n                  )}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\DisputeWizard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":8,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"fix":{"range":[379,391],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[378,390],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":10,"fix":{"range":[404,416],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[403,415],"text":""},"desc":"Remove unused variable 'XCircle'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  AlertTriangle, User, Briefcase, DollarSign, CheckCircle, \n  XCircle, Scale, Loader2, ArrowRight \n} from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\n\nexport default function DisputeWizard({ dispute, booking, onResolved }) {\n  const [step, setStep] = useState(1); // 1: Review, 2: Decide, 3: Confirm\n  const [resolution, setResolution] = useState(null); // 'client_favor', 'cleaner_favor', 'partial'\n  const [resolutionNotes, setResolutionNotes] = useState('');\n  const [creditSplit, setCreditSplit] = useState({ client: 0, cleaner: 0 });\n  const [processing, setProcessing] = useState(false);\n\n  const totalCredits = booking?.final_charge_credits || booking?.total_price || 0;\n\n  const handleSelectResolution = (type) => {\n    setResolution(type);\n    \n    if (type === 'client_favor') {\n      setCreditSplit({ client: totalCredits, cleaner: 0 });\n    } else if (type === 'cleaner_favor') {\n      setCreditSplit({ client: 0, cleaner: totalCredits });\n    } else if (type === 'partial') {\n      const half = totalCredits / 2;\n      setCreditSplit({ client: half, cleaner: half });\n    }\n    \n    setStep(2);\n  };\n\n  const handleConfirm = async () => {\n    if (!resolutionNotes.trim()) {\n      toast.error('Please provide resolution notes');\n      return;\n    }\n\n    setProcessing(true);\n\n    try {\n      const user = await base44.auth.me();\n\n      // Update dispute\n      await base44.entities.Dispute.update(dispute.id, {\n        status: 'resolved',\n        resolution: resolutionNotes,\n        resolved_by: user.email,\n        resolved_at: new Date().toISOString()\n      });\n\n      // Update booking\n      await base44.entities.Booking.update(booking.id, {\n        status: 'completed',\n        dispute_status: resolution\n      });\n\n      // Handle credit refund if client favor or partial\n      if (creditSplit.client > 0) {\n        const clientProfiles = await base44.entities.ClientProfile.filter({ \n          user_email: booking.client_email \n        });\n        \n        if (clientProfiles.length > 0) {\n          const profile = clientProfiles[0];\n          const newBalance = (profile.credits_balance || 0) + creditSplit.client;\n          \n          await base44.entities.ClientProfile.update(profile.id, {\n            credits_balance: newBalance\n          });\n\n          await base44.entities.CreditTransaction.create({\n            client_email: booking.client_email,\n            transaction_type: 'refund',\n            amount_credits: creditSplit.client,\n            booking_id: booking.id,\n            note: `Dispute resolved: ${resolution} - ${resolutionNotes}`,\n            balance_after: newBalance\n          });\n        }\n      }\n\n      // Handle cleaner earnings if cleaner favor or partial\n      if (creditSplit.cleaner > 0) {\n        await base44.entities.CleanerEarning.create({\n          cleaner_email: booking.cleaner_email,\n          booking_id: booking.id,\n          credits_earned: creditSplit.cleaner,\n          payout_percentage: booking.payout_percentage_at_accept || 0.80,\n          usd_due: (creditSplit.cleaner / 10) * (booking.payout_percentage_at_accept || 0.80),\n          status: 'pending'\n        });\n      }\n\n      // Log admin action\n      await base44.entities.Event.create({\n        event_type: 'admin_action',\n        user_email: user.email,\n        details: `Resolved dispute ${dispute.id} - ${resolution}: Client gets ${creditSplit.client} credits, Cleaner gets ${creditSplit.cleaner} credits`,\n        timestamp: new Date().toISOString()\n      });\n\n      toast.success('Dispute resolved successfully');\n      \n      if (onResolved) onResolved();\n    } catch (error) {\n      console.error('Error resolving dispute:', error);\n      toast.error('Failed to resolve dispute');\n    }\n\n    setProcessing(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Progress Indicator */}\n      <div className=\"flex items-center justify-center gap-4 mb-8\">\n        <div className={`flex items-center gap-2 ${step >= 1 ? 'text-puretask-blue' : 'text-gray-400'}`}>\n          <div className={`w-8 h-8 rounded-full flex items-center justify-center font-fredoka font-bold ${\n            step >= 1 ? 'brand-gradient text-white' : 'bg-gray-200'\n          }`}>1</div>\n          <span className=\"font-fredoka font-medium\">Review</span>\n        </div>\n        <ArrowRight className=\"w-5 h-5 text-gray-400\" />\n        <div className={`flex items-center gap-2 ${step >= 2 ? 'text-puretask-blue' : 'text-gray-400'}`}>\n          <div className={`w-8 h-8 rounded-full flex items-center justify-center font-fredoka font-bold ${\n            step >= 2 ? 'brand-gradient text-white' : 'bg-gray-200'\n          }`}>2</div>\n          <span className=\"font-fredoka font-medium\">Decide</span>\n        </div>\n        <ArrowRight className=\"w-5 h-5 text-gray-400\" />\n        <div className={`flex items-center gap-2 ${step >= 3 ? 'text-puretask-blue' : 'text-gray-400'}`}>\n          <div className={`w-8 h-8 rounded-full flex items-center justify-center font-fredoka font-bold ${\n            step >= 3 ? 'brand-gradient text-white' : 'bg-gray-200'\n          }`}>3</div>\n          <span className=\"font-fredoka font-medium\">Confirm</span>\n        </div>\n      </div>\n\n      {/* Step 1: Review */}\n      {step === 1 && (\n        <Card className=\"border-0 shadow-xl rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-t-2xl\">\n            <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n              <AlertTriangle className=\"w-6 h-6 text-amber-600\" />\n              Dispute Details\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div className=\"p-4 bg-blue-50 rounded-2xl\">\n                <p className=\"text-sm text-gray-600 font-verdana mb-1\">Filed By</p>\n                <p className=\"font-fredoka font-semibold text-graphite\">{dispute.filed_by}</p>\n                <p className=\"text-sm text-gray-500 font-verdana\">{dispute.user_email}</p>\n              </div>\n              <div className=\"p-4 bg-purple-50 rounded-2xl\">\n                <p className=\"text-sm text-gray-600 font-verdana mb-1\">Category</p>\n                <Badge className=\"bg-purple-600 text-white rounded-full font-fredoka\">{dispute.category}</Badge>\n              </div>\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite mb-2 block\">Dispute Reason</Label>\n              <div className=\"p-4 bg-gray-50 rounded-2xl\">\n                <p className=\"font-verdana text-gray-700\">{dispute.description}</p>\n              </div>\n            </div>\n\n            <div>\n              <Label className=\"font-fredoka text-graphite mb-2 block\">Booking Amount</Label>\n              <div className=\"p-4 bg-green-50 rounded-2xl border border-green-200\">\n                <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                  {Math.round(totalCredits * 10)} credits\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">‚âà ${totalCredits.toFixed(2)}</p>\n              </div>\n            </div>\n\n            <div className=\"grid md:grid-cols-3 gap-4 pt-4\">\n              <Button\n                onClick={() => handleSelectResolution('client_favor')}\n                className=\"flex-col h-auto p-6 bg-blue-500 hover:bg-blue-600 text-white rounded-2xl\"\n              >\n                <User className=\"w-8 h-8 mb-2\" />\n                <span className=\"font-fredoka font-semibold\">Client Favor</span>\n                <span className=\"text-xs mt-1\">Full refund</span>\n              </Button>\n\n              <Button\n                onClick={() => handleSelectResolution('cleaner_favor')}\n                className=\"flex-col h-auto p-6 bg-green-500 hover:bg-green-600 text-white rounded-2xl\"\n              >\n                <Briefcase className=\"w-8 h-8 mb-2\" />\n                <span className=\"font-fredoka font-semibold\">Cleaner Favor</span>\n                <span className=\"text-xs mt-1\">Full payout</span>\n              </Button>\n\n              <Button\n                onClick={() => handleSelectResolution('partial')}\n                className=\"flex-col h-auto p-6 bg-purple-500 hover:bg-purple-600 text-white rounded-2xl\"\n              >\n                <Scale className=\"w-8 h-8 mb-2\" />\n                <span className=\"font-fredoka font-semibold\">Split Resolution</span>\n                <span className=\"text-xs mt-1\">Partial both</span>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Step 2: Decide & Configure */}\n      {step === 2 && (\n        <Card className=\"border-0 shadow-xl rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n            <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n              <Scale className=\"w-6 h-6 text-purple-600\" />\n              Configure Resolution\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-6\">\n            <Alert className=\"border-purple-200 bg-purple-50 rounded-2xl\">\n              <AlertDescription className=\"text-purple-900 font-verdana\">\n                <strong>Selected:</strong> {\n                  resolution === 'client_favor' ? 'Client Favor (Full Refund)' :\n                  resolution === 'cleaner_favor' ? 'Cleaner Favor (Full Payout)' :\n                  'Split Resolution (Partial)'\n                }\n              </AlertDescription>\n            </Alert>\n\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div className=\"p-6 bg-blue-50 rounded-2xl border-2 border-blue-200\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <User className=\"w-5 h-5 text-puretask-blue\" />\n                  <span className=\"font-fredoka font-semibold text-graphite\">Client Refund</span>\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-puretask-blue\">\n                  {Math.round(creditSplit.client * 10)} credits\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">‚âà ${creditSplit.client.toFixed(2)}</p>\n              </div>\n\n              <div className=\"p-6 bg-green-50 rounded-2xl border-2 border-green-200\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <Briefcase className=\"w-5 h-5 text-fresh-mint\" />\n                  <span className=\"font-fredoka font-semibold text-graphite\">Cleaner Payout</span>\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                  {Math.round(creditSplit.cleaner * 10)} credits\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">‚âà ${creditSplit.cleaner.toFixed(2)}</p>\n              </div>\n            </div>\n\n            {resolution === 'partial' && (\n              <div>\n                <Label className=\"font-fredoka text-graphite mb-2 block\">Adjust Split (Optional)</Label>\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div>\n                    <Input\n                      type=\"number\"\n                      value={creditSplit.client}\n                      onChange={(e) => {\n                        const clientAmount = parseFloat(e.target.value) || 0;\n                        setCreditSplit({ \n                          client: clientAmount, \n                          cleaner: totalCredits - clientAmount \n                        });\n                      }}\n                      min=\"0\"\n                      max={totalCredits}\n                      step=\"0.5\"\n                      className=\"rounded-full font-verdana\"\n                      placeholder=\"Client refund\"\n                    />\n                  </div>\n                  <div>\n                    <Input\n                      type=\"number\"\n                      value={creditSplit.cleaner}\n                      onChange={(e) => {\n                        const cleanerAmount = parseFloat(e.target.value) || 0;\n                        setCreditSplit({ \n                          cleaner: cleanerAmount, \n                          client: totalCredits - cleanerAmount \n                        });\n                      }}\n                      min=\"0\"\n                      max={totalCredits}\n                      step=\"0.5\"\n                      className=\"rounded-full font-verdana\"\n                      placeholder=\"Cleaner payout\"\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div>\n              <Label htmlFor=\"resolution_notes\" className=\"font-fredoka text-graphite\">Resolution Notes *</Label>\n              <Textarea\n                id=\"resolution_notes\"\n                value={resolutionNotes}\n                onChange={(e) => setResolutionNotes(e.target.value)}\n                placeholder=\"Explain the decision and any actions taken...\"\n                rows={4}\n                className=\"rounded-2xl font-verdana\"\n              />\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button\n                onClick={() => setStep(1)}\n                variant=\"outline\"\n                className=\"flex-1 rounded-full font-fredoka\"\n              >\n                Back\n              </Button>\n              <Button\n                onClick={() => setStep(3)}\n                disabled={!resolutionNotes.trim()}\n                className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-semibold\"\n              >\n                Review Resolution\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Step 3: Confirm */}\n      {step === 3 && (\n        <Card className=\"border-0 shadow-xl rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n            <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n              <CheckCircle className=\"w-6 h-6 text-fresh-mint\" />\n              Confirm Resolution\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-6\">\n            <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n              <AlertDescription className=\"text-blue-900 font-verdana\">\n                <strong>Review carefully:</strong> This action will process credits, update earnings, and notify both parties. This cannot be undone.\n              </AlertDescription>\n            </Alert>\n\n            <div className=\"space-y-4\">\n              <div className=\"p-4 bg-soft-cloud rounded-2xl\">\n                <p className=\"font-fredoka font-semibold text-graphite mb-2\">Resolution Type</p>\n                <Badge className=\"bg-purple-600 text-white rounded-full font-fredoka\">\n                  {resolution === 'client_favor' ? 'Client Favor' :\n                   resolution === 'cleaner_favor' ? 'Cleaner Favor' :\n                   'Split Resolution'}\n                </Badge>\n              </div>\n\n              <div className=\"p-4 bg-soft-cloud rounded-2xl\">\n                <p className=\"font-fredoka font-semibold text-graphite mb-2\">Credit Distribution</p>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana\">Client Refund</p>\n                    <p className=\"text-xl font-fredoka font-bold text-puretask-blue\">\n                      {Math.round(creditSplit.client * 10)} credits\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana\">Cleaner Payout</p>\n                    <p className=\"text-xl font-fredoka font-bold text-fresh-mint\">\n                      {Math.round(creditSplit.cleaner * 10)} credits\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"p-4 bg-soft-cloud rounded-2xl\">\n                <p className=\"font-fredoka font-semibold text-graphite mb-2\">Resolution Notes</p>\n                <p className=\"text-gray-700 font-verdana\">{resolutionNotes}</p>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button\n                onClick={() => setStep(2)}\n                variant=\"outline\"\n                className=\"flex-1 rounded-full font-fredoka\"\n                disabled={processing}\n              >\n                Back to Edit\n              </Button>\n              <Button\n                onClick={handleConfirm}\n                disabled={processing}\n                className=\"flex-1 bg-fresh-mint hover:bg-green-600 text-white rounded-full font-fredoka font-semibold\"\n              >\n                {processing ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle className=\"w-5 h-5 mr-2\" />\n                    Confirm & Apply\n                  </>\n                )}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\FeatureFlagsManager.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":18,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":72,"fix":{"range":[780,785],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[779,784],"text":""},"desc":"Remove unused variable 'Zap'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Flag, Plus, Edit, Trash2, AlertCircle, CheckCircle, Users, Zap, Loader2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { motion } from 'framer-motion';\n\nconst CATEGORIES = [\n  'trust_safety',\n  'payments',\n  'booking',\n  'messaging',\n  'analytics',\n  'ui',\n  'experimental'\n];\n\nconst TARGET_USERS = [\n  'all',\n  'clients',\n  'cleaners',\n  'admins',\n  'beta_users'\n];\n\nconst CATEGORY_COLORS = {\n  trust_safety: 'emerald',\n  payments: 'blue',\n  booking: 'purple',\n  messaging: 'pink',\n  analytics: 'amber',\n  ui: 'cyan',\n  experimental: 'orange'\n};\n\nexport default function FeatureFlagsManager() {\n  const [flags, setFlags] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingFlag, setEditingFlag] = useState(null);\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\n  const [formData, setFormData] = useState({\n    flag_key: '',\n    flag_name: '',\n    description: '',\n    is_enabled: false,\n    category: 'experimental',\n    target_users: 'all',\n    rollout_percentage: 100,\n    notes: ''\n  });\n\n  useEffect(() => {\n    loadFlags();\n  }, []);\n\n  const loadFlags = async () => {\n    setLoading(true);\n    try {\n      const allFlags = await base44.entities.FeatureFlag.list('-created_date');\n      setFlags(allFlags);\n    } catch (error) {\n      console.error('Error loading flags:', error);\n      toast.error('Failed to load feature flags');\n    }\n    setLoading(false);\n  };\n\n  const handleToggleFlag = async (flag) => {\n    try {\n      const newEnabledState = !flag.is_enabled;\n      const updateData = {\n        is_enabled: newEnabledState,\n        [newEnabledState ? 'enabled_date' : 'disabled_date']: new Date().toISOString()\n      };\n\n      await base44.entities.FeatureFlag.update(flag.id, updateData);\n      \n      toast.success(`Feature ${newEnabledState ? 'enabled' : 'disabled'}: ${flag.flag_name}`);\n      loadFlags();\n    } catch (error) {\n      console.error('Error toggling flag:', error);\n      toast.error('Failed to toggle feature flag');\n    }\n  };\n\n  const handleCreateFlag = async () => {\n    if (!formData.flag_key || !formData.flag_name) {\n      toast.error('Flag key and name are required');\n      return;\n    }\n\n    try {\n      await base44.entities.FeatureFlag.create({\n        ...formData,\n        flag_key: formData.flag_key.toLowerCase().replace(/\\s+/g, '_')\n      });\n\n      toast.success('Feature flag created successfully!');\n      setShowCreateDialog(false);\n      setFormData({\n        flag_key: '',\n        flag_name: '',\n        description: '',\n        is_enabled: false,\n        category: 'experimental',\n        target_users: 'all',\n        rollout_percentage: 100,\n        notes: ''\n      });\n      loadFlags();\n    } catch (error) {\n      console.error('Error creating flag:', error);\n      toast.error('Failed to create feature flag');\n    }\n  };\n\n  const handleUpdateFlag = async () => {\n    if (!editingFlag) return;\n\n    try {\n      await base44.entities.FeatureFlag.update(editingFlag.id, formData);\n      \n      toast.success('Feature flag updated successfully!');\n      setEditingFlag(null);\n      loadFlags();\n    } catch (error) {\n      console.error('Error updating flag:', error);\n      toast.error('Failed to update feature flag');\n    }\n  };\n\n  const handleDeleteFlag = async (flag) => {\n    if (!confirm(`Are you sure you want to delete \"${flag.flag_name}\"?`)) return;\n\n    try {\n      await base44.entities.FeatureFlag.delete(flag.id);\n      toast.success('Feature flag deleted');\n      loadFlags();\n    } catch (error) {\n      console.error('Error deleting flag:', error);\n      toast.error('Failed to delete feature flag');\n    }\n  };\n\n  const startEdit = (flag) => {\n    setFormData({\n      flag_key: flag.flag_key,\n      flag_name: flag.flag_name,\n      description: flag.description || '',\n      is_enabled: flag.is_enabled,\n      category: flag.category,\n      target_users: flag.target_users,\n      rollout_percentage: flag.rollout_percentage,\n      notes: flag.notes || ''\n    });\n    setEditingFlag(flag);\n  };\n\n  const groupedFlags = flags.reduce((acc, flag) => {\n    if (!acc[flag.category]) {\n      acc[flag.category] = [];\n    }\n    acc[flag.category].push(flag);\n    return acc;\n  }, {});\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-12\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900 flex items-center gap-2\">\n            <Flag className=\"w-6 h-6 text-purple-600\" />\n            Feature Flags\n          </h2>\n          <p className=\"text-slate-600\">Control feature rollout and experiments</p>\n        </div>\n        <Button onClick={() => setShowCreateDialog(true)}>\n          <Plus className=\"w-4 h-4 mr-2\" />\n          New Flag\n        </Button>\n      </div>\n\n      {/* Stats */}\n      <div className=\"grid md:grid-cols-3 gap-4\">\n        <Card className=\"border-emerald-200 bg-emerald-50\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-emerald-700\">Enabled</p>\n                <p className=\"text-2xl font-bold text-emerald-900\">\n                  {flags.filter(f => f.is_enabled).length}\n                </p>\n              </div>\n              <CheckCircle className=\"w-8 h-8 text-emerald-500\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-slate-200 bg-slate-50\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-700\">Disabled</p>\n                <p className=\"text-2xl font-bold text-slate-900\">\n                  {flags.filter(f => !f.is_enabled).length}\n                </p>\n              </div>\n              <AlertCircle className=\"w-8 h-8 text-slate-400\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-purple-200 bg-purple-50\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-purple-700\">Total Flags</p>\n                <p className=\"text-2xl font-bold text-purple-900\">{flags.length}</p>\n              </div>\n              <Flag className=\"w-8 h-8 text-purple-500\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Flags by Category */}\n      {CATEGORIES.map(category => {\n        const categoryFlags = groupedFlags[category] || [];\n        if (categoryFlags.length === 0) return null;\n\n        const color = CATEGORY_COLORS[category];\n\n        return (\n          <Card key={category} className=\"border-0 shadow-lg\">\n            <CardHeader className={`bg-gradient-to-r from-${color}-50 to-${color}-100`}>\n              <CardTitle className=\"capitalize\">\n                {category.replace(/_/g, ' ')} ({categoryFlags.length})\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-3\">\n                {categoryFlags.map((flag, idx) => (\n                  <motion.div\n                    key={flag.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: idx * 0.05 }}\n                  >\n                    <Card className={`border-2 ${flag.is_enabled ? `border-${color}-200` : 'border-slate-200'}`}>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between gap-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              <h3 className=\"font-semibold text-slate-900\">{flag.flag_name}</h3>\n                              <Badge\n                                className={flag.is_enabled ? `bg-${color}-500` : 'bg-slate-400'}\n                              >\n                                {flag.is_enabled ? 'Enabled' : 'Disabled'}\n                              </Badge>\n                              {flag.rollout_percentage < 100 && (\n                                <Badge variant=\"outline\" className=\"text-blue-600 border-blue-300\">\n                                  {flag.rollout_percentage}% rollout\n                                </Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm text-slate-600 mb-2\">{flag.description}</p>\n                            <div className=\"flex items-center gap-3 text-xs text-slate-500\">\n                              <span className=\"flex items-center gap-1\">\n                                <Users className=\"w-3 h-3\" />\n                                {flag.target_users}\n                              </span>\n                              <span className=\"font-mono bg-slate-100 px-2 py-0.5 rounded\">\n                                {flag.flag_key}\n                              </span>\n                            </div>\n                          </div>\n\n                          <div className=\"flex items-center gap-2\">\n                            <Switch\n                              checked={flag.is_enabled}\n                              onCheckedChange={() => handleToggleFlag(flag)}\n                            />\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              onClick={() => startEdit(flag)}\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </Button>\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              onClick={() => handleDeleteFlag(flag)}\n                            >\n                              <Trash2 className=\"w-4 h-4 text-red-500\" />\n                            </Button>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        );\n      })}\n\n      {flags.length === 0 && (\n        <Alert>\n          <AlertCircle className=\"w-4 h-4\" />\n          <AlertDescription>\n            No feature flags configured yet. Click \"New Flag\" to create one.\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Create/Edit Dialog */}\n      <Dialog \n        open={showCreateDialog || !!editingFlag} \n        onOpenChange={(open) => {\n          if (!open) {\n            setShowCreateDialog(false);\n            setEditingFlag(null);\n          }\n        }}\n      >\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingFlag ? 'Edit Feature Flag' : 'Create Feature Flag'}\n            </DialogTitle>\n            <DialogDescription>\n              {editingFlag ? 'Update feature flag settings' : 'Add a new feature flag to control functionality'}\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Flag Key *</label>\n              <Input\n                value={formData.flag_key}\n                onChange={(e) => setFormData({ ...formData, flag_key: e.target.value })}\n                placeholder=\"e.g., gps_validation_enabled\"\n                disabled={!!editingFlag}\n              />\n              <p className=\"text-xs text-slate-500 mt-1\">\n                Unique identifier (lowercase, underscores only)\n              </p>\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Flag Name *</label>\n              <Input\n                value={formData.flag_name}\n                onChange={(e) => setFormData({ ...formData, flag_name: e.target.value })}\n                placeholder=\"e.g., GPS Validation\"\n              />\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Description</label>\n              <Textarea\n                value={formData.description}\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                placeholder=\"What does this flag control?\"\n                rows={3}\n              />\n            </div>\n\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Category</label>\n                <Select \n                  value={formData.category} \n                  onValueChange={(value) => setFormData({ ...formData, category: value })}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {CATEGORIES.map(cat => (\n                      <SelectItem key={cat} value={cat}>\n                        {cat.replace(/_/g, ' ')}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Target Users</label>\n                <Select \n                  value={formData.target_users} \n                  onValueChange={(value) => setFormData({ ...formData, target_users: value })}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {TARGET_USERS.map(target => (\n                      <SelectItem key={target} value={target}>\n                        {target}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">\n                Rollout Percentage: {formData.rollout_percentage}%\n              </label>\n              <input\n                type=\"range\"\n                min=\"0\"\n                max=\"100\"\n                step=\"5\"\n                value={formData.rollout_percentage}\n                onChange={(e) => setFormData({ ...formData, rollout_percentage: parseInt(e.target.value) })}\n                className=\"w-full\"\n              />\n            </div>\n\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Internal Notes</label>\n              <Textarea\n                value={formData.notes}\n                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                placeholder=\"Internal notes about this flag...\"\n                rows={2}\n              />\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button\n                onClick={editingFlag ? handleUpdateFlag : handleCreateFlag}\n                className=\"flex-1\"\n              >\n                {editingFlag ? 'Update Flag' : 'Create Flag'}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowCreateDialog(false);\n                  setEditingFlag(null);\n                }}\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\MessageReports.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[383,390],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[384,390],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":9,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[389,407],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[389,407],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Flag, CheckCircle, XCircle, Eye, Loader2, Trash2 } from 'lucide-react';\nimport { formatBookingDate } from '../utils/dateHelpers';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\n\nexport default function MessageReports() {\n  const [reports, setReports] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedReport, setSelectedReport] = useState(null);\n  const [selectedMessage, setSelectedMessage] = useState(null); // New state for viewing message\n  const [resolution, setResolution] = useState('');\n  const [resolving, setResolving] = useState(false);\n\n  useEffect(() => {\n    loadReports();\n  }, []);\n\n  const loadReports = async () => {\n    try {\n      const allReports = await base44.entities.ReportedMessage.list('-created_date');\n      \n      // Load message details for each report\n      const reportsWithMessages = await Promise.all(\n        allReports.map(async (report) => {\n          try {\n            const message = await base44.entities.Message.get(report.message_id);\n            return { ...report, message };\n          } catch (error) {\n            // If message is not found (e.g., already deleted), or any other error\n            console.warn(`Message ${report.message_id} not found for report ${report.id}.`, error);\n            return { ...report, message: null };\n          }\n        })\n      );\n      \n      setReports(reportsWithMessages);\n    } catch (error) {\n      console.error('Error loading reports:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleViewMessage = (report) => {\n    setSelectedMessage(report.message);\n  };\n\n  const handleDeleteMessage = async (messageId) => {\n    if (!confirm('Are you sure you want to delete this message permanently? This will remove it for all participants and cannot be undone.')) {\n      return;\n    }\n\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Fetch the message and its thread to get all participants\n      const message = await base44.entities.Message.get(messageId);\n      if (!message) {\n        alert('Message not found.');\n        return;\n      }\n      \n      const thread = await base44.entities.ConversationThread.get(message.thread_id);\n      if (!thread) {\n        alert('Conversation thread not found for this message.');\n        return;\n      }\n\n      // Update the message to mark it as deleted for all participants\n      await base44.entities.Message.update(messageId, {\n        deleted_for: thread.participants // Assuming participants is an array of user IDs/emails\n      });\n\n      // Log the admin action\n      await base44.entities.Event.create({\n        event_type: 'admin_action',\n        user_email: currentUser.email,\n        details: `Admin deleted reported message ${messageId} from thread ${message.thread_id}`\n      });\n\n      alert('Message successfully deleted for all participants.');\n      setSelectedMessage(null); // Close message view dialog\n      loadReports(); // Refresh the list of reports\n    } catch (error) {\n      console.error('Error deleting message:', error);\n      alert('Failed to delete message. Please check console for details.');\n    }\n  };\n\n  const handleResolve = async (status) => {\n    if (!resolution.trim()) {\n      alert('Please provide resolution notes');\n      return;\n    }\n\n    setResolving(true);\n    try {\n      const currentUser = await base44.auth.me();\n      \n      await base44.entities.ReportedMessage.update(selectedReport.id, {\n        status: status,\n        resolution: resolution.trim(),\n        reviewed_by: currentUser.email\n      });\n\n      setSelectedReport(null);\n      setResolution('');\n      loadReports();\n    } catch (error) {\n      console.error('Error resolving report:', error);\n      alert('Failed to resolve report');\n    }\n    setResolving(false);\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'pending': return 'bg-red-500';\n      case 'reviewing': return 'bg-amber-500';\n      case 'resolved': return 'bg-green-500';\n      case 'dismissed': return 'bg-slate-500';\n      default: return 'bg-slate-500';\n    }\n  };\n\n  const getReasonLabel = (reason) => {\n    const labels = {\n      spam: 'Spam',\n      harassment: 'Harassment',\n      inappropriate_content: 'Inappropriate Content',\n      scam: 'Scam',\n      other: 'Other'\n    };\n    return labels[reason] || reason;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-12\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-slate-400\" />\n      </div>\n    );\n  }\n\n  const pendingReports = reports.filter(r => r.status === 'pending' || r.status === 'reviewing');\n  const resolvedReports = reports.filter(r => r.status === 'resolved' || r.status === 'dismissed');\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Stats */}\n      <div className=\"grid md:grid-cols-2 gap-4\">\n        <Card className=\"border-0 shadow-md\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Pending Reports</p>\n                <p className=\"text-3xl font-bold text-red-600\">{pendingReports.length}</p>\n              </div>\n              <Flag className=\"w-10 h-10 text-red-500\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-md\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Resolved This Month</p>\n                <p className=\"text-3xl font-bold text-green-600\">{resolvedReports.length}</p>\n              </div>\n              <CheckCircle className=\"w-10 h-10 text-green-500\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Pending Reports */}\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Flag className=\"w-5 h-5 text-red-500\" />\n            Pending Reports\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {pendingReports.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <CheckCircle className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n              <p className=\"text-lg text-slate-600\">No pending reports!</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {pendingReports.map(report => (\n                <Card key={report.id} className=\"border-2 border-red-200\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div>\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <Badge className={getStatusColor(report.status)}>\n                            {report.status}\n                          </Badge>\n                          <Badge variant=\"outline\">{getReasonLabel(report.reason)}</Badge>\n                        </div>\n                        <p className=\"text-sm text-slate-600 mb-1\">\n                          Reported by: {report.reporter_email}\n                        </p>\n                        <p className=\"text-sm text-slate-600 mb-1\">\n                          Reported user: {report.reported_user_email}\n                        </p>\n                        <p className=\"text-sm text-slate-600\">\n                          Date: {formatBookingDate(report.created_date)}\n                        </p>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        {report.message && ( // Only show if message data is available\n                          <Button\n                            onClick={() => handleViewMessage(report)}\n                            size=\"sm\"\n                            variant=\"outline\"\n                          >\n                            <Eye className=\"w-4 h-4 mr-2\" />\n                            View Message\n                          </Button>\n                        )}\n                        <Button\n                          onClick={() => {\n                            setSelectedReport(report);\n                            setResolution('');\n                          }}\n                          size=\"sm\"\n                        >\n                          <Eye className=\"w-4 h-4 mr-2\" />\n                          Review\n                        </Button>\n                      </div>\n                    </div>\n\n                    {report.description && (\n                      <div className=\"bg-slate-50 p-4 rounded-lg\">\n                        <p className=\"text-sm text-slate-700\">{report.description}</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Message View Dialog */}\n      {selectedMessage && (\n        <Dialog open={!!selectedMessage} onOpenChange={() => setSelectedMessage(null)}>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>Reported Message</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div className=\"bg-slate-50 p-4 rounded-lg\">\n                <p className=\"text-sm text-slate-600 mb-2\">\n                  <strong>From:</strong> {selectedMessage.sender_email}\n                </p>\n                <p className=\"text-sm text-slate-600 mb-2\">\n                  <strong>To:</strong> {selectedMessage.receiver_email}\n                </p>\n                <p className=\"text-sm text-slate-600 mb-4\">\n                  <strong>Sent:</strong> {formatBookingDate(selectedMessage.created_date)}\n                </p>\n                <div className=\"bg-white p-4 rounded border border-slate-200\">\n                  <p className=\"text-slate-900 whitespace-pre-wrap\">{selectedMessage.content}</p>\n                </div>\n                {selectedMessage.attachment_url && (\n                  <div className=\"mt-3\">\n                    <a\n                      href={selectedMessage.attachment_url}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"text-blue-600 hover:underline text-sm\"\n                    >\n                      View Attachment\n                    </a>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setSelectedMessage(null)}\n                  className=\"flex-1\"\n                >\n                  Close\n                </Button>\n                <Button\n                  onClick={() => handleDeleteMessage(selectedMessage.id)}\n                  className=\"flex-1 bg-red-600 hover:bg-red-700\"\n                >\n                  <Trash2 className=\"w-4 h-4 mr-2\" />\n                  Delete Message\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Review Dialog */}\n      {selectedReport && (\n        <Dialog open={!!selectedReport} onOpenChange={() => setSelectedReport(null)}>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>Review Report</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-6\">\n              {/* Report Details */}\n              <div className=\"bg-slate-50 p-4 rounded-lg\">\n                <h4 className=\"font-semibold mb-2\">Report Details</h4>\n                <p className=\"text-sm text-slate-700 mb-2\">\n                  <strong>Reason:</strong> {getReasonLabel(selectedReport.reason)}\n                </p>\n                <p className=\"text-sm text-slate-700 mb-2\">\n                  <strong>Reporter:</strong> {selectedReport.reporter_email}\n                </p>\n                <p className=\"text-sm text-slate-700 mb-2\">\n                  <strong>Reported User:</strong> {selectedReport.reported_user_email}\n                </p>\n                {selectedReport.description && (\n                  <p className=\"text-sm text-slate-700\">\n                    <strong>Description:</strong> {selectedReport.description}\n                  </p>\n                )}\n              </div>\n\n              {/* Resolution Notes */}\n              <div>\n                <Label>Resolution Notes *</Label>\n                <Textarea\n                  value={resolution}\n                  onChange={(e) => setResolution(e.target.value)}\n                  placeholder=\"Explain how this report was handled and any actions taken...\"\n                  rows={4}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setSelectedReport(null)}\n                  className=\"flex-1\"\n                  disabled={resolving}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={() => handleResolve('dismissed')}\n                  disabled={resolving || !resolution.trim()}\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                >\n                  {resolving ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Processing...\n                    </>\n                  ) : (\n                    <>\n                      <XCircle className=\"w-4 h-4 mr-2\" />\n                      Dismiss\n                    </>\n                  )}\n                </Button>\n                <Button\n                  onClick={() => handleResolve('resolved')}\n                  disabled={resolving || !resolution.trim()}\n                  className=\"flex-1 bg-green-600 hover:bg-green-700\"\n                >\n                  {resolving ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Processing...\n                    </>\n                  ) : (\n                    <>\n                      <CheckCircle className=\"w-4 h-4 mr-2\" />\n                      Resolve\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\OfferConditionsBuilder.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\PayoutBatchProcessor.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":15,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":27,"fix":{"range":[475,482],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[474,481],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":15,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":72,"fix":{"range":[516,526],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[516,526],"text":""},"desc":"Remove unused variable 'Calendar'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { DollarSign, Users, CheckCircle, AlertCircle, Loader2, Calendar } from 'lucide-react';\n\nexport default function PayoutBatchProcessor() {\n  const [pendingEarnings, setPendingEarnings] = useState([]);\n  const [cleanerSummaries, setCleanerSummaries] = useState([]);\n  const [processing, setProcessing] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    loadPendingEarnings();\n  }, []);\n\n  const loadPendingEarnings = async () => {\n    setLoading(true);\n    try {\n      const earnings = await base44.entities.CleanerEarning.filter({ status: 'pending' });\n      setPendingEarnings(earnings);\n      \n      // Group by cleaner\n      const grouped = {};\n      earnings.forEach(earning => {\n        if (!grouped[earning.cleaner_email]) {\n          grouped[earning.cleaner_email] = {\n            email: earning.cleaner_email,\n            total_credits: 0,\n            total_usd: 0,\n            job_count: 0,\n            earnings: []\n          };\n        }\n        grouped[earning.cleaner_email].total_credits += earning.credits_earned;\n        grouped[earning.cleaner_email].total_usd += earning.usd_due;\n        grouped[earning.cleaner_email].job_count += 1;\n        grouped[earning.cleaner_email].earnings.push(earning);\n      });\n      \n      setCleanerSummaries(Object.values(grouped));\n    } catch (error) {\n      console.error('Error loading earnings:', error);\n    }\n    setLoading(false);\n  };\n\n  const processPayouts = async () => {\n    setProcessing(true);\n    setMessage('');\n    \n    try {\n      const periodStart = new Date();\n      periodStart.setDate(periodStart.getDate() - 7);\n      const periodEnd = new Date();\n      \n      let successCount = 0;\n      let failCount = 0;\n      \n      for (const summary of cleanerSummaries) {\n        try {\n          // Create payout record\n          const payout = await base44.entities.Payout.create({\n            cleaner_email: summary.email,\n            period_start: periodStart.toISOString().split('T')[0],\n            period_end: periodEnd.toISOString().split('T')[0],\n            total_credits: summary.total_credits,\n            total_usd: summary.total_usd,\n            status: 'processing'\n          });\n          \n          // In production, you would:\n          // 1. Get cleaner's stripe_connect_id\n          // 2. Create Stripe transfer\n          // 3. Update payout with stripe_transfer_id\n          \n          // For now, simulate success\n          await base44.entities.Payout.update(payout.id, {\n            status: 'paid',\n            stripe_transfer_id: `transfer_${Date.now()}`\n          });\n          \n          // Mark earnings as paid\n          for (const earning of summary.earnings) {\n            await base44.entities.CleanerEarning.update(earning.id, {\n              status: 'paid',\n              payout_id: payout.id\n            });\n          }\n          \n          successCount++;\n        } catch (error) {\n          console.error(`Payout failed for ${summary.email}:`, error);\n          failCount++;\n        }\n      }\n      \n      setMessage(`‚úÖ Processed ${successCount} payouts successfully. ${failCount > 0 ? `${failCount} failed.` : ''}`);\n      loadPendingEarnings();\n      \n    } catch (error) {\n      console.error('Batch processing error:', error);\n      setMessage('‚ùå Error processing payouts');\n    }\n    \n    setProcessing(false);\n  };\n\n  if (loading) {\n    return (\n      <Card>\n        <CardContent className=\"p-12 text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500 mx-auto mb-4\" />\n          <p className=\"text-slate-600\">Loading pending payouts...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const totalUSD = cleanerSummaries.reduce((sum, c) => sum + c.total_usd, 0);\n  const totalCredits = cleanerSummaries.reduce((sum, c) => sum + c.total_credits, 0);\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50\">\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <DollarSign className=\"w-6 h-6 text-green-600\" />\n            Weekly Payout Batch\n          </div>\n          <Badge className=\"bg-green-500 text-white\">\n            {cleanerSummaries.length} Cleaners\n          </Badge>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        {message && (\n          <Alert>\n            <AlertDescription>{message}</AlertDescription>\n          </Alert>\n        )}\n\n        {/* Summary Stats */}\n        <div className=\"grid md:grid-cols-3 gap-4\">\n          <div className=\"p-4 bg-slate-50 rounded-lg text-center\">\n            <p className=\"text-sm text-slate-600 mb-1\">Total Pending USD</p>\n            <p className=\"text-3xl font-bold text-green-600\">${totalUSD.toFixed(2)}</p>\n          </div>\n          <div className=\"p-4 bg-slate-50 rounded-lg text-center\">\n            <p className=\"text-sm text-slate-600 mb-1\">Total Credits Earned</p>\n            <p className=\"text-3xl font-bold text-blue-600\">{totalCredits.toLocaleString()}</p>\n          </div>\n          <div className=\"p-4 bg-slate-50 rounded-lg text-center\">\n            <p className=\"text-sm text-slate-600 mb-1\">Pending Jobs</p>\n            <p className=\"text-3xl font-bold text-purple-600\">{pendingEarnings.length}</p>\n          </div>\n        </div>\n\n        {cleanerSummaries.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <CheckCircle className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n            <p className=\"text-lg font-semibold text-slate-900 mb-2\">No Pending Payouts</p>\n            <p className=\"text-slate-600\">All earnings have been paid out</p>\n          </div>\n        ) : (\n          <>\n            {/* Cleaner List */}\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Cleaner</TableHead>\n                    <TableHead className=\"text-right\">Jobs</TableHead>\n                    <TableHead className=\"text-right\">Credits Earned</TableHead>\n                    <TableHead className=\"text-right\">USD Due</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {cleanerSummaries.map((summary, idx) => (\n                    <TableRow key={idx}>\n                      <TableCell className=\"font-medium\">{summary.email}</TableCell>\n                      <TableCell className=\"text-right\">{summary.job_count}</TableCell>\n                      <TableCell className=\"text-right font-mono\">\n                        {summary.total_credits.toLocaleString()}\n                      </TableCell>\n                      <TableCell className=\"text-right font-bold text-green-600\">\n                        ${summary.total_usd.toFixed(2)}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n\n            {/* Process Button */}\n            <Button\n              onClick={processPayouts}\n              disabled={processing}\n              className=\"w-full bg-gradient-to-r from-green-500 to-emerald-600\"\n              size=\"lg\"\n            >\n              {processing ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Processing Payouts...\n                </>\n              ) : (\n                <>\n                  <CheckCircle className=\"w-5 h-5 mr-2\" />\n                  Process ${totalUSD.toFixed(2)} in Payouts\n                </>\n              )}\n            </Button>\n\n            <Alert className=\"border-amber-200 bg-amber-50\">\n              <AlertCircle className=\"w-4 h-4 text-amber-600\" />\n              <AlertDescription className=\"text-amber-900 text-sm\">\n                <strong>Note:</strong> In production, this will create Stripe Connect transfers to each cleaner's account. \n                Ensure all cleaners have valid stripe_connect_id before processing.\n              </AlertDescription>\n            </Alert>\n          </>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\PayoutManagement.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\PendingPayoutsDetails.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":14,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":53,"fix":{"range":[432,442],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[432,442],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingId' is defined but never used. Allowed unused args must match /^_/u.","line":59,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingId"},"fix":{"range":[1846,1855],"text":""},"desc":"Remove unused variable 'bookingId'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { DollarSign, Loader2, ExternalLink, Calendar } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { createPageUrl } from '@/utils';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function PendingPayoutsDetails() {\n  const navigate = useNavigate();\n  const [earnings, setEarnings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [totalUSD, setTotalUSD] = useState(0);\n\n  useEffect(() => {\n    loadPendingEarnings();\n  }, []);\n\n  const loadPendingEarnings = async () => {\n    setLoading(true);\n    try {\n      const pendingEarnings = await base44.entities.CleanerEarning.filter({ status: 'pending' });\n      \n      const sorted = pendingEarnings.sort((a, b) => \n        new Date(b.created_date) - new Date(a.created_date)\n      );\n\n      setEarnings(sorted);\n      \n      const total = sorted.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n      setTotalUSD(total);\n    } catch (error) {\n      console.error('Error loading pending earnings:', error);\n    }\n    setLoading(false);\n  };\n\n  const getEarningTypeColor = (type) => {\n    const colors = {\n      job_completed: 'bg-green-100 text-green-800',\n      client_no_show_comp: 'bg-blue-100 text-blue-800',\n      cancellation_comp: 'bg-purple-100 text-purple-800',\n      bonus: 'bg-amber-100 text-amber-800',\n      adjustment: 'bg-gray-100 text-gray-800'\n    };\n    return colors[type] || 'bg-gray-100 text-gray-800';\n  };\n\n  const viewBooking = (bookingId) => {\n    navigate(createPageUrl('AdminBookingsConsoleV2'));\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <DollarSign className=\"w-6 h-6 text-amber-600\" />\n            Pending Payouts Details\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-8 flex justify-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-t-2xl\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <DollarSign className=\"w-6 h-6 text-amber-600\" />\n            Pending Payouts Details\n          </CardTitle>\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600 font-verdana\">Total Pending</p>\n            <p className=\"text-3xl font-fredoka font-bold text-amber-600\">${totalUSD.toFixed(2)}</p>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <p className=\"text-sm text-gray-600 font-verdana\">\n            Showing <span className=\"font-medium text-graphite\">{earnings.length}</span> pending earning{earnings.length !== 1 ? 's' : ''}\n          </p>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={loadPendingEarnings}\n            className=\"rounded-full font-fredoka\"\n          >\n            Refresh\n          </Button>\n        </div>\n\n        {earnings.length === 0 ? (\n          <div className=\"text-center py-12 bg-gray-50 rounded-2xl\">\n            <DollarSign className=\"w-16 h-16 text-gray-300 mx-auto mb-3\" />\n            <p className=\"text-gray-500 font-verdana text-lg\">No pending payouts</p>\n            <p className=\"text-sm text-gray-400 font-verdana mt-1\">All earnings have been processed</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto rounded-2xl border border-gray-200\">\n            <Table>\n              <TableHeader>\n                <TableRow className=\"bg-gray-50\">\n                  <TableHead className=\"font-fredoka\">Cleaner</TableHead>\n                  <TableHead className=\"font-fredoka\">Type</TableHead>\n                  <TableHead className=\"font-fredoka\">Booking ID</TableHead>\n                  <TableHead className=\"font-fredoka text-right\">Credits</TableHead>\n                  <TableHead className=\"font-fredoka text-right\">Payout %</TableHead>\n                  <TableHead className=\"font-fredoka text-right\">USD Due</TableHead>\n                  <TableHead className=\"font-fredoka\">Date</TableHead>\n                  <TableHead className=\"font-fredoka\">Action</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {earnings.map((earning) => (\n                  <TableRow key={earning.id} className=\"hover:bg-gray-50\">\n                    <TableCell className=\"font-verdana text-sm font-medium\">\n                      {earning.cleaner_email}\n                    </TableCell>\n                    <TableCell>\n                      <Badge className={getEarningTypeColor(earning.earning_type)}>\n                        {earning.earning_type.replace(/_/g, ' ')}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"font-verdana text-sm text-gray-600\">\n                      {earning.booking_id ? (\n                        <span className=\"font-mono text-xs\">{earning.booking_id.slice(0, 8)}...</span>\n                      ) : (\n                        <span className=\"text-gray-400\">-</span>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-right font-fredoka font-semibold text-puretask-blue\">\n                      {earning.credits_earned?.toLocaleString() || 0}\n                    </TableCell>\n                    <TableCell className=\"text-right font-verdana text-sm\">\n                      {((earning.payout_percentage || 0) * 100).toFixed(0)}%\n                    </TableCell>\n                    <TableCell className=\"text-right font-fredoka font-bold text-green-600\">\n                      ${(earning.usd_due || 0).toFixed(2)}\n                    </TableCell>\n                    <TableCell className=\"font-verdana text-sm text-gray-600\">\n                      {format(new Date(earning.created_date), 'MMM dd, yyyy')}\n                    </TableCell>\n                    <TableCell>\n                      {earning.booking_id && (\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => viewBooking(earning.booking_id)}\n                          className=\"h-8 px-2\"\n                        >\n                          <ExternalLink className=\"w-4 h-4\" />\n                        </Button>\n                      )}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\PlatformMetrics.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Percent' is defined but never used.","line":7,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":84,"fix":{"range":[387,396],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Percent"},"fix":{"range":[387,396],"text":""},"desc":"Remove unused variable 'Percent'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Booking } from '@/api/entities';\nimport { CleanerProfile } from '@/api/entities';\nimport { ClientProfile } from '@/api/entities';\nimport { Review } from '@/api/entities';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { TrendingUp, Users, Star, Calendar, CheckCircle, DollarSign, Award, Percent } from 'lucide-react';\n\nexport default function PlatformMetrics() {\n  const [metrics, setMetrics] = useState({\n    totalBookings: 0,\n    completedBookings: 0,\n    completionRate: 0,\n    averageRating: 0,\n    activeCleaners: 0,\n    activeClients: 0,\n    totalRevenue: 0,\n    averageReliability: 0\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadMetrics();\n  }, []);\n\n  const loadMetrics = async () => {\n    try {\n      const bookings = await Booking.list();\n      const cleaners = await CleanerProfile.list();\n      const clients = await ClientProfile.list();\n      const reviews = await Review.list();\n\n      const completedBookings = bookings.filter(b => b.status === 'completed');\n      const totalRevenue = completedBookings.reduce((sum, b) => sum + (b.total_price * 0.15), 0);\n      \n      const averageRating = reviews.length > 0\n        ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length\n        : 0;\n\n      const averageReliability = cleaners.length > 0\n        ? cleaners.reduce((sum, c) => sum + c.reliability_score, 0) / cleaners.length\n        : 0;\n\n      setMetrics({\n        totalBookings: bookings.length,\n        completedBookings: completedBookings.length,\n        completionRate: bookings.length > 0 ? (completedBookings.length / bookings.length) * 100 : 0,\n        averageRating: averageRating,\n        activeCleaners: cleaners.filter(c => c.is_active).length,\n        activeClients: clients.length,\n        totalRevenue: totalRevenue,\n        averageReliability: averageReliability\n      });\n    } catch (error) {\n      console.error('Error loading metrics:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl\">\n        <CardContent className=\"p-12 text-center\">\n          <p className=\"text-slate-600\">Loading platform metrics...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"border-0 shadow-xl\">\n        <CardHeader className=\"bg-gradient-to-r from-slate-50 to-slate-100\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <TrendingUp className=\"w-6 h-6 text-emerald-500\" />\n            Platform Performance Overview\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            <div className=\"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <Calendar className=\"w-8 h-8 text-blue-600\" />\n                <TrendingUp className=\"w-5 h-5 text-blue-500\" />\n              </div>\n              <p className=\"text-3xl font-bold text-blue-900 mb-1\">{metrics.totalBookings}</p>\n              <p className=\"text-sm text-blue-700 font-medium\">Total Bookings</p>\n              <div className=\"mt-3 pt-3 border-t border-blue-200\">\n                <p className=\"text-xs text-blue-600\">\n                  {metrics.completedBookings} completed ({metrics.completionRate.toFixed(1)}%)\n                </p>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-br from-amber-50 to-amber-100 p-6 rounded-xl border border-amber-200\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <Star className=\"w-8 h-8 text-amber-600\" />\n              </div>\n              <p className=\"text-3xl font-bold text-amber-900 mb-1\">{metrics.averageRating.toFixed(1)}</p>\n              <p className=\"text-sm text-amber-700 font-medium\">Average Rating</p>\n              <div className=\"flex mt-3 pt-3 border-t border-amber-200\">\n                {Array.from({ length: 5 }).map((_, i) => (\n                  <Star\n                    key={i}\n                    className={`w-4 h-4 ${\n                      i < Math.floor(metrics.averageRating)\n                        ? 'fill-amber-500 text-amber-500'\n                        : 'text-amber-300'\n                    }`}\n                  />\n                ))}\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-br from-emerald-50 to-emerald-100 p-6 rounded-xl border border-emerald-200\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <Users className=\"w-8 h-8 text-emerald-600\" />\n              </div>\n              <p className=\"text-3xl font-bold text-emerald-900 mb-1\">{metrics.activeCleaners}</p>\n              <p className=\"text-sm text-emerald-700 font-medium\">Active Cleaners</p>\n              <div className=\"mt-3 pt-3 border-t border-emerald-200\">\n                <p className=\"text-xs text-emerald-600\">\n                  Avg reliability: {metrics.averageReliability.toFixed(0)}/100\n                </p>\n              </div>\n            </div>\n\n            <div className=\"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <CheckCircle className=\"w-8 h-8 text-purple-600\" />\n              </div>\n              <p className=\"text-3xl font-bold text-purple-900 mb-1\">{metrics.activeClients}</p>\n              <p className=\"text-sm text-purple-700 font-medium\">Active Clients</p>\n              <div className=\"mt-3 pt-3 border-t border-purple-200\">\n                <p className=\"text-xs text-purple-600\">\n                  Registered users\n                </p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"grid md:grid-cols-2 gap-6\">\n        <Card className=\"border-0 shadow-xl\">\n          <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <DollarSign className=\"w-6 h-6 text-emerald-600\" />\n              Revenue Metrics\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between p-4 bg-emerald-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-emerald-600 font-medium\">Total Platform Revenue</p>\n                  <p className=\"text-xs text-emerald-500 mt-1\">15% platform fee from completed bookings</p>\n                </div>\n                <p className=\"text-2xl font-bold text-emerald-900\">${metrics.totalRevenue.toFixed(2)}</p>\n              </div>\n              <div className=\"flex items-center justify-between p-4 bg-blue-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-blue-600 font-medium\">Completed Bookings</p>\n                  <p className=\"text-xs text-blue-500 mt-1\">Successfully finished jobs</p>\n                </div>\n                <p className=\"text-2xl font-bold text-blue-900\">{metrics.completedBookings}</p>\n              </div>\n              <div className=\"flex items-center justify-between p-4 bg-purple-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-purple-600 font-medium\">Completion Rate</p>\n                  <p className=\"text-xs text-purple-500 mt-1\">Jobs completed vs total bookings</p>\n                </div>\n                <p className=\"text-2xl font-bold text-purple-900\">{metrics.completionRate.toFixed(1)}%</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Award className=\"w-6 h-6 text-blue-600\" />\n              Quality Metrics\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between p-4 bg-amber-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-amber-600 font-medium\">Average Customer Rating</p>\n                  <p className=\"text-xs text-amber-500 mt-1\">Based on all reviews</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-2xl font-bold text-amber-900\">{metrics.averageRating.toFixed(2)}</p>\n                  <p className=\"text-xs text-amber-600\">out of 5.0</p>\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between p-4 bg-emerald-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-emerald-600 font-medium\">Average Reliability Score</p>\n                  <p className=\"text-xs text-emerald-500 mt-1\">Platform-wide cleaner reliability</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-2xl font-bold text-emerald-900\">{metrics.averageReliability.toFixed(0)}</p>\n                  <p className=\"text-xs text-emerald-600\">out of 100</p>\n                </div>\n              </div>\n              <div className=\"flex items-center justify-between p-4 bg-blue-50 rounded-lg\">\n                <div>\n                  <p className=\"text-sm text-blue-600 font-medium\">Active Cleaners Ratio</p>\n                  <p className=\"text-xs text-blue-500 mt-1\">Currently accepting bookings</p>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-2xl font-bold text-blue-900\">\n                    {metrics.activeCleaners > 0 ? '100' : '0'}%\n                  </p>\n                  <p className=\"text-xs text-blue-600\">{metrics.activeCleaners} active</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\QuickStats.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Minus' is defined but never used.","line":4,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":41,"fix":{"range":[165,172],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Minus"},"fix":{"range":[165,172],"text":""},"desc":"Remove unused variable 'Minus'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function QuickStats({ stats, loading }) {\n  const statCards = [\n    {\n      title: 'Active Cleaners',\n      value: stats.activeCleaners,\n      subtitle: `${stats.totalCleaners} total`,\n      icon: 'üë®‚Äçüîß',\n      color: 'from-emerald-500 to-green-600',\n      headerBg: '#10B981',\n      trend: '+5.2%',\n      trendUp: true\n    },\n    {\n      title: 'Pending Verifications',\n      value: stats.pendingVerifications,\n      subtitle: 'Awaiting review',\n      icon: 'üîç',\n      color: stats.pendingVerifications > 0 ? 'from-amber-500 to-orange-600' : 'from-blue-500 to-cyan-600',\n      headerBg: stats.pendingVerifications > 0 ? '#F59E0B' : '#3B82F6',\n      alert: stats.pendingVerifications > 0\n    },\n    {\n      title: \"Today's Bookings\",\n      value: stats.todayBookings,\n      subtitle: `${stats.activeBookings} active now`,\n      icon: 'üìÖ',\n      color: 'from-purple-500 to-pink-600',\n      headerBg: '#A855F7',\n      trend: '+12.3%',\n      trendUp: true\n    },\n    {\n      title: 'Open Issues',\n      value: stats.openDisputes + stats.openTickets,\n      subtitle: `${stats.openDisputes} disputes ‚Ä¢ ${stats.openTickets} tickets`,\n      icon: '‚ö†Ô∏è',\n      color: (stats.openDisputes + stats.openTickets) > 0 ? 'from-red-500 to-rose-600' : 'from-slate-500 to-gray-600',\n      headerBg: (stats.openDisputes + stats.openTickets) > 0 ? '#EF4444' : '#64748B',\n      alert: (stats.openDisputes + stats.openTickets) > 0\n    },\n    {\n      title: 'Monthly Revenue',\n      value: `$${stats.monthlyRevenue.toFixed(0)}`,\n      subtitle: `Total: $${stats.totalRevenue.toFixed(0)}`,\n      icon: 'üí∞',\n      color: 'from-green-500 to-emerald-600',\n      headerBg: '#22C55E',\n      trend: '+18.7%',\n      trendUp: true\n    },\n    {\n      title: 'Avg Reliability',\n      value: `${stats.avgReliabilityScore.toFixed(0)}/100`,\n      subtitle: `${stats.avgRating.toFixed(1)}/5.0 rating`,\n      icon: '‚≠ê',\n      color: 'from-indigo-500 to-purple-600',\n      headerBg: '#6366F1'\n    }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4\">\n        {[...Array(6)].map((_, i) => (\n          <Card key={i} className=\"border-0 shadow-lg rounded-2xl animate-pulse\">\n            <CardContent className=\"p-6\">\n              <div className=\"h-20 bg-gray-200 rounded\"></div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4\">\n      {statCards.map((stat, index) => (\n        <motion.div\n          key={index}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: index * 0.1 }}\n        >\n          <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all rounded-2xl overflow-hidden\">\n            {/* Bright colored header section */}\n            <div \n              className=\"h-3 w-full\"\n              style={{ backgroundColor: stat.headerBg }}\n            ></div>\n            \n            {/* Card content with gradient background */}\n            <div className={`bg-gradient-to-br ${stat.color} text-white relative`}>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start justify-between mb-3\">\n                  <span className=\"text-3xl\">{stat.icon}</span>\n                  {stat.alert && (\n                    <Badge className=\"bg-white/20 text-white animate-pulse rounded-full font-fredoka\">\n                      {stat.value}\n                    </Badge>\n                  )}\n                  {stat.trend && (\n                    <div className={`flex items-center gap-1 text-xs font-semibold ${stat.trendUp ? 'text-white' : 'text-white/80'}`}>\n                      {stat.trendUp ? <TrendingUp className=\"w-3 h-3\" /> : <TrendingDown className=\"w-3 h-3\" />}\n                      {stat.trend}\n                    </div>\n                  )}\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold mb-1\">{stat.value}</p>\n                <p className=\"text-sm opacity-90 font-verdana mb-1\">{stat.title}</p>\n                <p className=\"text-xs opacity-75 font-verdana\">{stat.subtitle}</p>\n              </CardContent>\n              <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16\"></div>\n            </div>\n          </Card>\n        </motion.div>\n      ))}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\RecentActivityFeed.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\RevenueChart.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":18,"fix":{"range":[186,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart"},"fix":{"range":[187,196],"text":""},"desc":"Remove unused variable 'BarChart'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bar' is defined but never used.","line":4,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23,"fix":{"range":[196,201],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bar"},"fix":{"range":[195,200],"text":""},"desc":"Remove unused variable 'Bar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":5,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":32,"fix":{"range":[323,335],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[323,335],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, LineChart, Line, Legend } from 'recharts';\nimport { DollarSign, TrendingUp } from 'lucide-react';\n\nexport default function RevenueChart() {\n  const [data, setData] = useState([]);\n  const [totalRevenue, setTotalRevenue] = useState(0);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const bookings = await base44.entities.Booking.list();\n      const completedBookings = bookings.filter(b => b.status === 'completed' || b.status === 'approved');\n\n      // Group by month\n      const monthlyData = {};\n      let total = 0;\n\n      completedBookings.forEach(booking => {\n        const date = new Date(booking.created_date);\n        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n        const monthName = date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });\n        \n        const revenue = booking.total_price || 0;\n        const platformFee = revenue * 0.15; // 15% platform fee\n        const cleanerPayout = revenue * 0.85; // 85% to cleaner\n        \n        total += platformFee;\n\n        if (!monthlyData[monthKey]) {\n          monthlyData[monthKey] = {\n            month: monthName,\n            revenue: 0,\n            platformFee: 0,\n            cleanerPayout: 0,\n            bookings: 0\n          };\n        }\n\n        monthlyData[monthKey].revenue += revenue;\n        monthlyData[monthKey].platformFee += platformFee;\n        monthlyData[monthKey].cleanerPayout += cleanerPayout;\n        monthlyData[monthKey].bookings += 1;\n      });\n\n      const chartData = Object.values(monthlyData)\n        .sort((a, b) => a.month.localeCompare(b.month))\n        .slice(-6); // Last 6 months\n\n      setData(chartData);\n      setTotalRevenue(total);\n    } catch (error) {\n      console.error('Error loading revenue data:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardContent className=\"p-12 text-center\">\n          <p className=\"text-slate-600 font-verdana\">Loading revenue data...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <DollarSign className=\"w-6 h-6 text-emerald-600\" />\n            <span className=\"font-fredoka\">Revenue Overview</span>\n          </div>\n          <div className=\"text-right\">\n            <p className=\"text-sm text-gray-600 font-verdana\">Total Platform Revenue</p>\n            <p className=\"text-2xl font-bold text-emerald-600 font-fredoka\">${totalRevenue.toFixed(2)}</p>\n          </div>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <ResponsiveContainer width=\"100%\" height={300}>\n          <LineChart data={data}>\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n            <XAxis dataKey=\"month\" tick={{ fill: '#6b7280', fontSize: 12 }} />\n            <YAxis tick={{ fill: '#6b7280', fontSize: 12 }} />\n            <Tooltip\n              contentStyle={{ borderRadius: '12px', border: '1px solid #e5e7eb', fontSize: '12px' }}\n              formatter={(value) => `$${value.toFixed(2)}`}\n            />\n            <Legend wrapperStyle={{ fontSize: '12px' }} />\n            <Line\n              type=\"monotone\"\n              dataKey=\"platformFee\"\n              stroke=\"#10b981\"\n              strokeWidth={3}\n              name=\"Platform Fee (15%)\"\n              dot={{ r: 4 }}\n            />\n            <Line\n              type=\"monotone\"\n              dataKey=\"cleanerPayout\"\n              stroke=\"#3b82f6\"\n              strokeWidth={2}\n              name=\"Cleaner Payout (85%)\"\n              dot={{ r: 3 }}\n              strokeDasharray=\"5 5\"\n            />\n          </LineChart>\n        </ResponsiveContainer>\n\n        <div className=\"grid grid-cols-3 gap-4 mt-6\">\n          <div className=\"p-4 bg-emerald-50 rounded-2xl text-center border border-emerald-200\">\n            <p className=\"text-xs text-emerald-600 mb-1 font-verdana\">Avg Monthly Revenue</p>\n            <p className=\"text-xl font-bold text-emerald-900 font-fredoka\">\n              ${data.length > 0 ? (data.reduce((sum, d) => sum + d.platformFee, 0) / data.length).toFixed(2) : '0.00'}\n            </p>\n          </div>\n          <div className=\"p-4 bg-blue-50 rounded-2xl text-center border border-blue-200\">\n            <p className=\"text-xs text-blue-600 mb-1 font-verdana\">Total Bookings</p>\n            <p className=\"text-xl font-bold text-blue-900 font-fredoka\">\n              {data.reduce((sum, d) => sum + d.bookings, 0)}\n            </p>\n          </div>\n          <div className=\"p-4 bg-purple-50 rounded-2xl text-center border border-purple-200\">\n            <p className=\"text-xs text-purple-600 mb-1 font-verdana\">Avg Per Booking</p>\n            <p className=\"text-xl font-bold text-purple-900 font-fredoka\">\n              ${data.length > 0 ? ((data.reduce((sum, d) => sum + d.revenue, 0) / data.reduce((sum, d) => sum + d.bookings, 0))).toFixed(2) : '0.00'}\n            </p>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\SystemHealthCheck.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\ToggleVerifiedBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\TopCleanersTable.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\TransactionHistoryAdvanced.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Filter' is defined but never used.","line":30,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":36,"fix":{"range":[807,815],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[806,814],"text":""},"desc":"Remove unused variable 'Filter'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Transaction History Advanced - Section 5\n * Comprehensive view of all credit transactions with filtering and export\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { \n  History, Search, Download, Filter, Loader2, \n  ArrowUpCircle, ArrowDownCircle, Lock, Unlock, RefreshCw,\n  ChevronLeft, ChevronRight, Calendar, ExternalLink\n} from 'lucide-react';\nimport { creditsToUSD } from '../credits/CreditCalculator';\n\nexport default function TransactionHistoryAdvanced() {\n  const navigate = useNavigate();\n  const [transactions, setTransactions] = useState([]);\n  const [filteredTxns, setFilteredTxns] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [typeFilter, setTypeFilter] = useState('all');\n  const [clientFilter, setClientFilter] = useState('all');\n  const [dateRangeFilter, setDateRangeFilter] = useState('all');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [sortOrder, setSortOrder] = useState('desc');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [pageSize, setPageSize] = useState(50);\n  const [clients, setClients] = useState([]);\n\n  useEffect(() => {\n    loadTransactions();\n    loadClients();\n  }, []);\n\n  useEffect(() => {\n    applyFilters();\n  }, [transactions, searchQuery, typeFilter, clientFilter, dateRangeFilter, statusFilter, sortOrder]);\n\n  useEffect(() => {\n    setCurrentPage(1); // Reset to first page when filters change\n  }, [searchQuery, typeFilter, clientFilter, dateRangeFilter, statusFilter]);\n\n  const loadTransactions = async () => {\n    setLoading(true);\n    try {\n      const txns = await base44.entities.CreditTransaction.list('-created_date', 1000);\n      setTransactions(txns);\n    } catch (error) {\n      console.error('Error loading transactions:', error);\n    }\n    setLoading(false);\n  };\n\n  const loadClients = async () => {\n    try {\n      const clientProfiles = await base44.entities.ClientProfile.list('', 1000);\n      const uniqueClients = [...new Set(clientProfiles.map(c => c.user_email))].sort();\n      setClients(uniqueClients);\n    } catch (error) {\n      console.error('Error loading clients:', error);\n    }\n  };\n\n  const applyFilters = () => {\n    let filtered = [...transactions];\n\n    // Search filter\n    if (searchQuery.trim()) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(txn =>\n        txn.client_email?.toLowerCase().includes(query) ||\n        txn.note?.toLowerCase().includes(query) ||\n        txn.booking_id?.includes(query)\n      );\n    }\n\n    // Type filter\n    if (typeFilter !== 'all') {\n      filtered = filtered.filter(txn => txn.transaction_type === typeFilter);\n    }\n\n    // Client filter\n    if (clientFilter !== 'all') {\n      filtered = filtered.filter(txn => txn.client_email === clientFilter);\n    }\n\n    // Date range filter\n    if (dateRangeFilter !== 'all') {\n      const now = new Date();\n      const filterDate = new Date();\n      \n      switch (dateRangeFilter) {\n        case '7days':\n          filterDate.setDate(now.getDate() - 7);\n          break;\n        case '30days':\n          filterDate.setDate(now.getDate() - 30);\n          break;\n        case '90days':\n          filterDate.setDate(now.getDate() - 90);\n          break;\n      }\n      \n      if (dateRangeFilter !== 'all') {\n        filtered = filtered.filter(txn => new Date(txn.created_date) >= filterDate);\n      }\n    }\n\n    // Status filter (prepared for future use)\n    if (statusFilter !== 'all' && filtered.some(txn => txn.status)) {\n      filtered = filtered.filter(txn => txn.status === statusFilter);\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      const dateA = new Date(a.created_date);\n      const dateB = new Date(b.created_date);\n      return sortOrder === 'desc' ? dateB - dateA : dateA - dateB;\n    });\n\n    setFilteredTxns(filtered);\n  };\n\n  const getTransactionIcon = (type) => {\n    const icons = {\n      purchase: <ArrowDownCircle className=\"w-5 h-5 text-emerald-600\" />,\n      hold: <Lock className=\"w-5 h-5 text-amber-600\" />,\n      release: <Unlock className=\"w-5 h-5 text-blue-600\" />,\n      charge: <ArrowUpCircle className=\"w-5 h-5 text-purple-600\" />,\n      refund: <RefreshCw className=\"w-5 h-5 text-green-600\" />,\n      reversal: <ArrowDownCircle className=\"w-5 h-5 text-red-600\" />\n    };\n    return icons[type] || <History className=\"w-5 h-5 text-slate-400\" />;\n  };\n\n  const getTypeBadge = (type) => {\n    const styles = {\n      purchase: 'bg-emerald-100 text-emerald-700',\n      hold: 'bg-amber-100 text-amber-700',\n      release: 'bg-blue-100 text-blue-700',\n      charge: 'bg-purple-100 text-purple-700',\n      refund: 'bg-green-100 text-green-700',\n      reversal: 'bg-red-100 text-red-700'\n    };\n    return (\n      <Badge className={`${styles[type] || 'bg-slate-100 text-slate-700'} capitalize`}>\n        {type?.replace('_', ' ')}\n      </Badge>\n    );\n  };\n\n  const exportToCSV = () => {\n    const headers = ['Date', 'Client', 'Type', 'Credits', 'USD Value', 'Note', 'Balance After', 'Booking ID'];\n    const rows = filteredTxns.map(txn => [\n      new Date(txn.created_date).toISOString(),\n      txn.client_email,\n      txn.transaction_type,\n      txn.amount_credits,\n      creditsToUSD(Math.abs(txn.amount_credits)).toFixed(2),\n      txn.note,\n      txn.balance_after || '',\n      txn.booking_id || ''\n    ]);\n\n    const csvContent = [\n      headers.join(','),\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `credit_transactions_${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n  };\n\n  // Calculate stats\n  const totalPurchases = filteredTxns\n    .filter(txn => txn.transaction_type === 'purchase' && txn.amount_credits > 0)\n    .reduce((sum, txn) => sum + txn.amount_credits, 0);\n\n  const totalCharges = filteredTxns\n    .filter(txn => txn.transaction_type === 'charge')\n    .reduce((sum, txn) => sum + Math.abs(txn.amount_credits), 0);\n\n  const totalRefunds = filteredTxns\n    .filter(txn => txn.transaction_type === 'refund')\n    .reduce((sum, txn) => sum + txn.amount_credits, 0);\n\n  // Pagination\n  const totalPages = Math.ceil(filteredTxns.length / pageSize);\n  const startIndex = (currentPage - 1) * pageSize;\n  const endIndex = startIndex + pageSize;\n  const paginatedTxns = filteredTxns.slice(startIndex, endIndex);\n\n  const handlePageChange = (newPage) => {\n    if (newPage >= 1 && newPage <= totalPages) {\n      setCurrentPage(newPage);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Card>\n        <CardContent className=\"p-12 text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500 mx-auto mb-4\" />\n          <p className=\"text-slate-600\">Loading transaction history...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className=\"bg-gradient-to-r from-slate-50 to-slate-100\">\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <History className=\"w-6 h-6 text-slate-600\" />\n            Transaction History\n          </div>\n          <Button\n            onClick={exportToCSV}\n            variant=\"outline\"\n            size=\"sm\"\n            disabled={filteredTxns.length === 0}\n          >\n            <Download className=\"w-4 h-4 mr-2\" />\n            Export CSV\n          </Button>\n        </CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"p-6 space-y-6\">\n        {/* Summary Stats */}\n        <div className=\"grid md:grid-cols-3 gap-4\">\n          <div className=\"p-4 bg-emerald-50 rounded-lg border border-emerald-200\">\n            <p className=\"text-sm text-emerald-700 mb-1\">Total Purchases</p>\n            <p className=\"text-2xl font-bold text-emerald-600\">\n              {totalPurchases.toLocaleString()}\n            </p>\n            <p className=\"text-xs text-emerald-600\">\n              ‚âà ${creditsToUSD(totalPurchases).toFixed(2)}\n            </p>\n          </div>\n\n          <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n            <p className=\"text-sm text-purple-700 mb-1\">Total Charges</p>\n            <p className=\"text-2xl font-bold text-purple-600\">\n              {totalCharges.toLocaleString()}\n            </p>\n            <p className=\"text-xs text-purple-600\">\n              ‚âà ${creditsToUSD(totalCharges).toFixed(2)}\n            </p>\n          </div>\n\n          <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n            <p className=\"text-sm text-blue-700 mb-1\">Total Refunds</p>\n            <p className=\"text-2xl font-bold text-blue-600\">\n              {totalRefunds.toLocaleString()}\n            </p>\n            <p className=\"text-xs text-blue-600\">\n              ‚âà ${creditsToUSD(totalRefunds).toFixed(2)}\n            </p>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <div className=\"space-y-4\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400\" />\n              <Input\n                placeholder=\"Search by email, note, or booking ID...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n\n            <Select value={typeFilter} onValueChange={setTypeFilter}>\n              <SelectTrigger className=\"w-full md:w-48\">\n                <SelectValue placeholder=\"All Types\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Types</SelectItem>\n                <SelectItem value=\"purchase\">Purchase</SelectItem>\n                <SelectItem value=\"promo\">Promo</SelectItem>\n                <SelectItem value=\"adjustment\">Adjustment</SelectItem>\n                <SelectItem value=\"charge\">Charge</SelectItem>\n                <SelectItem value=\"refund\">Refund</SelectItem>\n                <SelectItem value=\"reversal\">Reversal</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <Select value={clientFilter} onValueChange={setClientFilter}>\n              <SelectTrigger className=\"w-full md:w-64\">\n                <SelectValue placeholder=\"All Clients\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Clients</SelectItem>\n                {clients.map(email => (\n                  <SelectItem key={email} value={email}>{email}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n\n            <Select value={dateRangeFilter} onValueChange={setDateRangeFilter}>\n              <SelectTrigger className=\"w-full md:w-48\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <SelectValue placeholder=\"All Time\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Time</SelectItem>\n                <SelectItem value=\"7days\">Last 7 Days</SelectItem>\n                <SelectItem value=\"30days\">Last 30 Days</SelectItem>\n                <SelectItem value=\"90days\">Last 90 Days</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full md:w-48\">\n                <SelectValue placeholder=\"All Status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Status</SelectItem>\n                <SelectItem value=\"completed\">Completed</SelectItem>\n                <SelectItem value=\"pending\">Pending</SelectItem>\n                <SelectItem value=\"failed\">Failed</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={sortOrder} onValueChange={setSortOrder}>\n              <SelectTrigger className=\"w-full md:w-48\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"desc\">Newest First</SelectItem>\n                <SelectItem value=\"asc\">Oldest First</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n\n        {/* Results Count & Pagination Controls */}\n        <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4\">\n          <div className=\"flex items-center gap-4\">\n            <p className=\"text-sm text-slate-600\">\n              Showing {startIndex + 1}-{Math.min(endIndex, filteredTxns.length)} of {filteredTxns.length} transactions\n            </p>\n            <Select value={pageSize.toString()} onValueChange={(val) => { setPageSize(Number(val)); setCurrentPage(1); }}>\n              <SelectTrigger className=\"w-32\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"25\">25 per page</SelectItem>\n                <SelectItem value=\"50\">50 per page</SelectItem>\n                <SelectItem value=\"100\">100 per page</SelectItem>\n                <SelectItem value=\"200\">200 per page</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={loadTransactions}\n            >\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n            <div className=\"flex items-center gap-2 border rounded-lg p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handlePageChange(currentPage - 1)}\n                disabled={currentPage === 1}\n              >\n                <ChevronLeft className=\"w-4 h-4\" />\n              </Button>\n              <span className=\"text-sm text-slate-600 px-2\">\n                Page {currentPage} of {totalPages || 1}\n              </span>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handlePageChange(currentPage + 1)}\n                disabled={currentPage === totalPages || totalPages === 0}\n              >\n                <ChevronRight className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Transaction Table */}\n        <div className=\"overflow-x-auto rounded-lg border border-slate-200\">\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-slate-50\">\n                <TableHead className=\"w-12\"></TableHead>\n                <TableHead>Date & Time</TableHead>\n                <TableHead>Client</TableHead>\n                <TableHead>Type</TableHead>\n                <TableHead className=\"text-right\">Credits</TableHead>\n                <TableHead className=\"text-right\">USD Value</TableHead>\n                <TableHead>Note</TableHead>\n                <TableHead className=\"text-right\">Balance After</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {paginatedTxns.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={8} className=\"text-center py-12\">\n                    <History className=\"w-12 h-12 text-slate-300 mx-auto mb-3\" />\n                    <p className=\"text-slate-500\">No transactions found</p>\n                  </TableCell>\n                </TableRow>\n              ) : (\n                paginatedTxns.map((txn) => (\n                  <TableRow key={txn.id} className=\"hover:bg-slate-50\">\n                    <TableCell>\n                      {getTransactionIcon(txn.transaction_type)}\n                    </TableCell>\n                    <TableCell className=\"font-mono text-sm\">\n                      {new Date(txn.created_date).toLocaleString('en-US', {\n                        year: 'numeric',\n                        month: 'short',\n                        day: 'numeric',\n                        hour: '2-digit',\n                        minute: '2-digit'\n                      })}\n                    </TableCell>\n                    <TableCell className=\"font-medium\">\n                      <button\n                        onClick={() => navigate(createPageUrl('AdminClientManagement') + '?search=' + txn.client_email)}\n                        className=\"text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1\"\n                      >\n                        {txn.client_email}\n                        <ExternalLink className=\"w-3 h-3\" />\n                      </button>\n                    </TableCell>\n                    <TableCell>\n                      {getTypeBadge(txn.transaction_type)}\n                    </TableCell>\n                    <TableCell className={`text-right font-bold ${\n                      txn.amount_credits > 0 ? 'text-emerald-600' : 'text-slate-900'\n                    }`}>\n                      {txn.amount_credits > 0 ? '+' : ''}\n                      {txn.amount_credits.toLocaleString()}\n                    </TableCell>\n                    <TableCell className=\"text-right text-sm text-slate-600\">\n                      ${creditsToUSD(Math.abs(txn.amount_credits)).toFixed(2)}\n                    </TableCell>\n                    <TableCell className=\"max-w-xs truncate text-sm text-slate-600\">\n                      {txn.note}\n                      {txn.booking_id && (\n                        <button\n                          onClick={() => navigate(createPageUrl('AdminBookingsConsoleV2') + '?bookingId=' + txn.booking_id)}\n                          className=\"block text-xs text-blue-600 hover:text-blue-800 hover:underline mt-1 flex items-center gap-1\"\n                        >\n                          Booking: {txn.booking_id.slice(0, 8)}...\n                          <ExternalLink className=\"w-3 h-3\" />\n                        </button>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-right font-mono text-sm\">\n                      {txn.balance_after !== null && txn.balance_after !== undefined\n                        ? txn.balance_after.toLocaleString()\n                        : 'N/A'}\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\admin\\pageDescriptions.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\agent\\AgentApprovalCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\agent\\AgentChatInterface.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\agent\\AgentDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setAgentActive' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"setAgentActive"},"fix":{"range":[651,667],"text":""},"desc":"Remove unused variable 'setAgentActive'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Bot, Calendar, TrendingUp, Clock, CheckCircle, Loader2 } from 'lucide-react';\nimport AgentApprovalCard from './AgentApprovalCard';\nimport AgentChatInterface from './AgentChatInterface';\nimport { toast } from 'sonner';\n\nexport default function AgentDashboard({ cleanerEmail }) {\n  const [pendingActions, setPendingActions] = useState([]);\n  const [agentActive, setAgentActive] = useState(true);\n  const [loading, setLoading] = useState(true);\n  const [chatOpen, setChatOpen] = useState(false);\n  const [dailySummary, setDailySummary] = useState(null);\n\n  useEffect(() => {\n    loadPendingActions();\n    loadDailySummary();\n  }, [cleanerEmail]);\n\n  const loadPendingActions = async () => {\n    try {\n      const response = await base44.functions.invoke('agentAssistant', {\n        action: 'getPendingActions',\n        cleaner_email: cleanerEmail\n      });\n\n      if (response.data.success) {\n        setPendingActions(response.data.actions);\n      }\n    } catch (error) {\n      console.error('Error loading pending actions:', error);\n    }\n    setLoading(false);\n  };\n\n  const loadDailySummary = async () => {\n    try {\n      const response = await base44.functions.invoke('agentAssistant', {\n        action: 'getLatestSummary',\n        cleaner_email: cleanerEmail\n      });\n\n      if (response.data.success && response.data.summary) {\n        setDailySummary(response.data.summary);\n      }\n    } catch (error) {\n      console.error('Error loading summary:', error);\n    }\n  };\n\n  const handleApproval = async (actionId, approved) => {\n    try {\n      const response = await base44.functions.invoke('agentAssistant', {\n        action: 'respondToAction',\n        action_id: actionId,\n        approved: approved\n      });\n\n      if (response.data.success) {\n        toast.success(approved ? 'Action approved! Agent is processing...' : 'Action declined');\n        loadPendingActions();\n      }\n    } catch (error) {\n      console.error('Error responding to action:', error);\n      toast.error('Failed to respond');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Agent Status */}\n      <Card className=\"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50\">\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg\">\n                <Bot className=\"w-6 h-6 text-white\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl font-fredoka\">Your AI Assistant</CardTitle>\n                <p className=\"text-sm text-gray-600 font-verdana\">Managing your schedule 24/7</p>\n              </div>\n            </div>\n            <Badge className={agentActive ? 'bg-green-600' : 'bg-gray-400'}>\n              {agentActive ? 'Active' : 'Paused'}\n            </Badge>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid md:grid-cols-3 gap-4\">\n            <div className=\"p-3 bg-white rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-1\">\n                <Calendar className=\"w-4 h-4 text-blue-600\" />\n                <span className=\"text-xs font-verdana text-gray-600\">Pending Approvals</span>\n              </div>\n              <p className=\"text-2xl font-fredoka font-bold text-blue-600\">{pendingActions.length}</p>\n            </div>\n            <div className=\"p-3 bg-white rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-1\">\n                <CheckCircle className=\"w-4 h-4 text-green-600\" />\n                <span className=\"text-xs font-verdana text-gray-600\">Auto-Actions Today</span>\n              </div>\n              <p className=\"text-2xl font-fredoka font-bold text-green-600\">{dailySummary?.auto_actions_count || 0}</p>\n            </div>\n            <div className=\"p-3 bg-white rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-1\">\n                <TrendingUp className=\"w-4 h-4 text-purple-600\" />\n                <span className=\"text-xs font-verdana text-gray-600\">Schedule Optimization</span>\n              </div>\n              <p className=\"text-2xl font-fredoka font-bold text-purple-600\">98%</p>\n            </div>\n          </div>\n\n          <Button \n            onClick={() => setChatOpen(true)}\n            className=\"w-full mt-4 brand-gradient text-white\"\n          >\n            <Sparkles className=\"w-4 h-4 mr-2\" />\n            Chat with AI Assistant\n          </Button>\n        </CardContent>\n      </Card>\n\n      {/* Daily Summary */}\n      {dailySummary && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka flex items-center gap-2\">\n              <Clock className=\"w-5 h-5 text-puretask-blue\" />\n              Latest Daily Summary\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"text-sm font-verdana\">\n              <p className=\"text-gray-600 mb-2\">\n                Generated: {new Date(dailySummary.created_date).toLocaleString()}\n              </p>\n              \n              <div className=\"prose prose-sm max-w-none\">\n                <div dangerouslySetInnerHTML={{ __html: dailySummary.summary_html }} />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Pending Actions */}\n      {pendingActions.length > 0 && (\n        <div className=\"space-y-4\">\n          <h3 className=\"text-lg font-fredoka font-semibold\">Actions Awaiting Your Approval</h3>\n          {pendingActions.map(action => (\n            <AgentApprovalCard \n              key={action.id} \n              action={action}\n              onApprove={() => handleApproval(action.id, true)}\n              onDecline={() => handleApproval(action.id, false)}\n            />\n          ))}\n        </div>\n      )}\n\n      {pendingActions.length === 0 && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <CheckCircle className=\"w-12 h-12 text-green-600 mx-auto mb-3\" />\n            <p className=\"font-fredoka text-lg\">All caught up!</p>\n            <p className=\"text-sm text-gray-600 font-verdana\">No pending actions right now</p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Chat Interface */}\n      {chatOpen && (\n        <AgentChatInterface \n          cleanerEmail={cleanerEmail}\n          onClose={() => setChatOpen(false)}\n        />\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIAssistantGuide.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIAssistantOnboardingWizard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Card' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14,"fix":{"range":[49,55],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Card"},"fix":{"range":[50,55],"text":""},"desc":"Remove unused variable 'Card'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardContent' is defined but never used.","line":2,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":27,"fix":{"range":[55,68],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardContent"},"fix":{"range":[54,67],"text":""},"desc":"Remove unused variable 'CardContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardDescription' is defined but never used.","line":2,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":44,"fix":{"range":[68,85],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardDescription"},"fix":{"range":[67,84],"text":""},"desc":"Remove unused variable 'CardDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":2,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":56,"fix":{"range":[85,97],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[84,96],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":2,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":67,"fix":{"range":[96,107],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[96,107],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AIFeatureShowcase' is defined but never used.","line":13,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":25,"fix":{"range":[664,718],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"AIFeatureShowcase"},"fix":{"range":[671,694],"text":""},"desc":"Remove unused variable 'AIFeatureShowcase'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Sparkles, CheckCircle2, ArrowRight, ArrowLeft, X } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\nimport { analytics } from '../analytics/AnalyticsService';\nimport AIFeatureShowcase from './AIFeatureShowcase';\n\nconst SPECIALTY_OPTIONS = ['Pet-Friendly', 'Eco-Warrior', 'Deep Clean Expert', 'Move-Out Specialist'];\nconst SERVICE_OPTIONS = [\n  { value: 'windows', label: 'Windows' },\n  { value: 'oven', label: 'Oven' },\n  { value: 'refrigerator', label: 'Refrigerator' },\n  { value: 'inside_cabinets', label: 'Inside Cabinets' },\n  { value: 'laundry', label: 'Laundry' }\n];\n\nexport default function AIAssistantOnboardingWizard({ cleanerProfile, onComplete, onSkip }) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [startTime] = useState(Date.now());\n  const [settings, setSettings] = useState({\n    // Communication\n    booking_confirmation_enabled: true,\n    pre_cleaning_reminder_enabled: true,\n    channels: ['email', 'in_app'],\n    \n    // Scheduling\n    ai_scheduling_enabled: false,\n    prioritize_gap_filling: true,\n    \n    // Matching\n    specialty_tags: [],\n    offers_additional_services: []\n  });\n\n  const totalSteps = 5;\n  const progress = (currentStep / totalSteps) * 100;\n\n  const handleNext = () => {\n    if (currentStep < totalSteps) {\n      setCurrentStep(currentStep + 1);\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const handleSpecialtyToggle = (specialty) => {\n    setSettings(prev => ({\n      ...prev,\n      specialty_tags: prev.specialty_tags.includes(specialty)\n        ? prev.specialty_tags.filter(s => s !== specialty)\n        : [...prev.specialty_tags, specialty]\n    }));\n  };\n\n  const handleServiceToggle = (service) => {\n    setSettings(prev => ({\n      ...prev,\n      offers_additional_services: prev.offers_additional_services.includes(service)\n        ? prev.offers_additional_services.filter(s => s !== service)\n        : [...prev.offers_additional_services, service]\n    }));\n  };\n\n  const handleComplete = async () => {\n    try {\n      // Save settings to CleanerProfile\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        communication_settings: {\n          booking_confirmation: {\n            enabled: settings.booking_confirmation_enabled,\n            channels: settings.channels,\n            custom_template: \"Hi {client_name}! Your cleaning is confirmed for {date} at {time}. Looking forward to making your space sparkle! - {cleaner_name}\"\n          },\n          pre_cleaning_reminder: {\n            enabled: settings.pre_cleaning_reminder_enabled,\n            days_before: 1,\n            channels: settings.channels,\n            custom_template: \"Hi {client_name}! Just a reminder that I'll be cleaning your place tomorrow at {time}. Please ensure access is available. Thanks! - {cleaner_name}\"\n          },\n          ai_scheduling_enabled: settings.ai_scheduling_enabled,\n          prioritize_gap_filling: settings.prioritize_gap_filling,\n          suggest_days_in_advance: 14\n        },\n        specialty_tags: settings.specialty_tags,\n        offers_additional_services: settings.offers_additional_services,\n        ai_onboarding_completed: true\n      });\n\n      // Track completion\n      analytics.track('ai_onboarding_completed', {\n        steps_completed: 5,\n        time_taken_seconds: Math.floor((Date.now() - startTime) / 1000),\n        ai_scheduling_enabled: settings.ai_scheduling_enabled,\n        specialties_selected: settings.specialty_tags.length,\n        services_selected: settings.offers_additional_services.length\n      });\n      \n      // Mark as seen\n      localStorage.setItem(`ai_onboarding_seen_${cleanerProfile.user_email}`, 'true');\n      \n      toast.success('AI Assistant is now active!');\n      onComplete();\n    } catch (error) {\n      console.error('Failed to save onboarding settings:', error);\n      toast.error('Failed to complete setup. Please try again.');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <motion.div\n        initial={{ opacity: 0, scale: 0.95 }}\n        animate={{ opacity: 1, scale: 1 }}\n        className=\"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden\"\n      >\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 p-6 text-white relative\">\n          <button\n            onClick={onSkip}\n            className=\"absolute top-4 right-4 p-2 hover:bg-white/20 rounded-full transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center\">\n              <Sparkles className=\"w-7 h-7\" />\n            </div>\n            <div>\n              <h2 className=\"text-2xl font-fredoka font-bold\">AI Assistant Setup</h2>\n              <p className=\"text-blue-100 text-sm font-verdana\">Step {currentStep} of {totalSteps}</p>\n            </div>\n          </div>\n          <Progress value={progress} className=\"h-2 bg-white/20\" />\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 overflow-y-auto\" style={{ maxHeight: 'calc(90vh - 200px)' }}>\n          <AnimatePresence mode=\"wait\">\n            {/* Step 1: Welcome */}\n            {currentStep === 1 && (\n              <motion.div\n                key=\"step1\"\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"text-center\">\n                  <div className=\"w-20 h-20 brand-gradient rounded-full mx-auto mb-4 flex items-center justify-center\">\n                    <Sparkles className=\"w-10 h-10 text-white\" />\n                  </div>\n                  <h3 className=\"text-2xl font-fredoka font-bold mb-2\">Welcome to Your AI Assistant!</h3>\n                  <p className=\"text-gray-600 font-verdana\">\n                    Your AI Assistant helps you maximize bookings, communicate professionally, and earn more. Let's set it up!\n                  </p>\n                </div>\n\n                <div className=\"bg-blue-50 rounded-lg p-6 space-y-3\">\n                  <p className=\"font-fredoka font-semibold text-gray-800\">What your AI can do:</p>\n                  <ul className=\"space-y-2\">\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-sm font-verdana\">Automate client communication at every stage</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-sm font-verdana\">Fill schedule gaps intelligently</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-sm font-verdana\">Match you with ideal clients</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <span className=\"text-sm font-verdana\">Track your performance metrics</span>\n                    </li>\n                  </ul>\n                </div>\n              </motion.div>\n            )}\n\n            {/* Step 2: Communication */}\n            {currentStep === 2 && (\n              <motion.div\n                key=\"step2\"\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                className=\"space-y-6\"\n              >\n                <div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-2\">How should your AI communicate?</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm\">\n                    Your AI will send these messages automatically. You can customize them later.\n                  </p>\n                </div>\n\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-start justify-between p-4 bg-gray-50 rounded-lg\">\n                    <div className=\"flex-1\">\n                      <Label htmlFor=\"booking-conf\" className=\"font-fredoka cursor-pointer\">\n                        Booking Confirmations\n                      </Label>\n                      <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                        Automatically confirm bookings with clients\n                      </p>\n                    </div>\n                    <Switch\n                      id=\"booking-conf\"\n                      checked={settings.booking_confirmation_enabled}\n                      onCheckedChange={(checked) => setSettings(prev => ({ ...prev, booking_confirmation_enabled: checked }))}\n                    />\n                  </div>\n\n                  <div className=\"flex items-start justify-between p-4 bg-gray-50 rounded-lg\">\n                    <div className=\"flex-1\">\n                      <Label htmlFor=\"pre-clean\" className=\"font-fredoka cursor-pointer\">\n                        Pre-Cleaning Reminders\n                      </Label>\n                      <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                        Remind clients 1 day before their cleaning\n                      </p>\n                    </div>\n                    <Switch\n                      id=\"pre-clean\"\n                      checked={settings.pre_cleaning_reminder_enabled}\n                      onCheckedChange={(checked) => setSettings(prev => ({ ...prev, pre_cleaning_reminder_enabled: checked }))}\n                    />\n                  </div>\n\n                  <div className=\"p-4 bg-gray-50 rounded-lg\">\n                    <p className=\"font-fredoka mb-3\">Send messages via:</p>\n                    <div className=\"flex gap-4\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id=\"email\"\n                          checked={settings.channels.includes('email')}\n                          onCheckedChange={(checked) => {\n                            setSettings(prev => ({\n                              ...prev,\n                              channels: checked \n                                ? [...prev.channels, 'email']\n                                : prev.channels.filter(c => c !== 'email')\n                            }));\n                          }}\n                        />\n                        <Label htmlFor=\"email\" className=\"font-verdana cursor-pointer\">Email</Label>\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id=\"in_app\"\n                          checked={settings.channels.includes('in_app')}\n                          onCheckedChange={(checked) => {\n                            setSettings(prev => ({\n                              ...prev,\n                              channels: checked \n                                ? [...prev.channels, 'in_app']\n                                : prev.channels.filter(c => c !== 'in_app')\n                            }));\n                          }}\n                        />\n                        <Label htmlFor=\"in_app\" className=\"font-verdana cursor-pointer\">In-App</Label>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n\n            {/* Step 3: Scheduling */}\n            {currentStep === 3 && (\n              <motion.div\n                key=\"step3\"\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                className=\"space-y-6\"\n              >\n                <div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-2\">Let's optimize your schedule</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm\">\n                    AI suggests booking times that maximize your daily earnings and minimize travel.\n                  </p>\n                </div>\n\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-start justify-between p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                    <div className=\"flex-1\">\n                      <Label htmlFor=\"ai-sched\" className=\"font-fredoka cursor-pointer\">\n                        Enable AI Scheduling\n                      </Label>\n                      <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                        Let AI suggest optimal booking times to clients\n                      </p>\n                    </div>\n                    <Switch\n                      id=\"ai-sched\"\n                      checked={settings.ai_scheduling_enabled}\n                      onCheckedChange={(checked) => setSettings(prev => ({ ...prev, ai_scheduling_enabled: checked }))}\n                    />\n                  </div>\n\n                  {settings.ai_scheduling_enabled && (\n                    <div className=\"flex items-start justify-between p-4 bg-gray-50 rounded-lg ml-4\">\n                      <div className=\"flex-1\">\n                        <Label htmlFor=\"gap-fill\" className=\"font-fredoka cursor-pointer\">\n                          Prioritize Gap Filling\n                        </Label>\n                        <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                          Fill empty slots between bookings first\n                        </p>\n                      </div>\n                      <Switch\n                        id=\"gap-fill\"\n                        checked={settings.prioritize_gap_filling}\n                        onCheckedChange={(checked) => setSettings(prev => ({ ...prev, prioritize_gap_filling: checked }))}\n                      />\n                    </div>\n                  )}\n                </div>\n              </motion.div>\n            )}\n\n            {/* Step 4: Specialties */}\n            {currentStep === 4 && (\n              <motion.div\n                key=\"step4\"\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                className=\"space-y-6\"\n              >\n                <div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-2\">What are you great at?</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm\">\n                    This helps AI match you with clients who need your expertise.\n                  </p>\n                </div>\n\n                <div className=\"space-y-4\">\n                  <div>\n                    <p className=\"font-fredoka mb-3\">My specialties:</p>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {SPECIALTY_OPTIONS.map((specialty) => (\n                        <button\n                          key={specialty}\n                          onClick={() => handleSpecialtyToggle(specialty)}\n                          className={`px-4 py-2 rounded-full font-fredoka text-sm transition-all ${\n                            settings.specialty_tags.includes(specialty)\n                              ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white'\n                              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                          }`}\n                        >\n                          {specialty}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div>\n                    <p className=\"font-fredoka mb-3\">Additional services I offer:</p>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      {SERVICE_OPTIONS.map((service) => (\n                        <div key={service.value} className=\"flex items-center space-x-2\">\n                          <Checkbox\n                            id={service.value}\n                            checked={settings.offers_additional_services.includes(service.value)}\n                            onCheckedChange={() => handleServiceToggle(service.value)}\n                          />\n                          <Label htmlFor={service.value} className=\"font-verdana cursor-pointer\">\n                            {service.label}\n                          </Label>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n\n            {/* Step 5: Completion */}\n            {currentStep === 6 && (\n              <motion.div\n                key=\"step5\"\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"text-center\">\n                  <motion.div\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    transition={{ type: 'spring', stiffness: 200 }}\n                    className=\"w-20 h-20 bg-green-100 rounded-full mx-auto mb-4 flex items-center justify-center\"\n                  >\n                    <CheckCircle2 className=\"w-10 h-10 text-green-600\" />\n                  </motion.div>\n                  <h3 className=\"text-2xl font-fredoka font-bold mb-2\">You're all set!</h3>\n                  <p className=\"text-gray-600 font-verdana\">\n                    Your AI Assistant is now active. You can adjust settings anytime from your profile.\n                  </p>\n                </div>\n\n                <div className=\"bg-blue-50 rounded-lg p-6 space-y-2\">\n                  <p className=\"font-fredoka font-semibold text-gray-800\">Quick Summary:</p>\n                  <ul className=\"space-y-1 text-sm font-verdana text-gray-700\">\n                    <li>‚úì {settings.booking_confirmation_enabled || settings.pre_cleaning_reminder_enabled ? \n                      `${(settings.booking_confirmation_enabled ? 1 : 0) + (settings.pre_cleaning_reminder_enabled ? 1 : 0)} automated messages enabled` : \n                      'No automated messages enabled'}</li>\n                    <li>‚úì AI Scheduling: {settings.ai_scheduling_enabled ? 'Enabled' : 'Disabled'}</li>\n                    <li>‚úì {settings.specialty_tags.length} specialties selected</li>\n                    <li>‚úì {settings.offers_additional_services.length} additional services selected</li>\n                  </ul>\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-6 border-t bg-gray-50 flex items-center justify-between\">\n          <Button\n            variant=\"ghost\"\n            onClick={handleBack}\n            disabled={currentStep === 1}\n            className={currentStep === 1 ? 'invisible' : ''}\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back\n          </Button>\n\n          {currentStep < totalSteps ? (\n            <Button onClick={handleNext} className=\"brand-gradient text-white\">\n              Next\n              <ArrowRight className=\"w-4 h-4 ml-2\" />\n            </Button>\n          ) : (\n            <Button onClick={handleComplete} className=\"brand-gradient text-white\">\n              Complete Setup\n              <CheckCircle2 className=\"w-4 h-4 ml-2\" />\n            </Button>\n          )}\n        </div>\n      </motion.div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIFeatureExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIFeatureShowcase.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Target' is defined but never used.","line":7,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":56,"fix":{"range":[357,365],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Target"},"fix":{"range":[356,364],"text":""},"desc":"Remove unused variable 'Target'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  Sparkles, MessageSquare, Calendar, TrendingUp, Target, \n  CheckCircle, Star, Clock, DollarSign, Users \n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AIFeatureShowcase({ onContinue }) {\n  const [activeTab, setActiveTab] = useState('communication');\n\n  const exampleScenarios = {\n    communication: {\n      icon: MessageSquare,\n      title: 'Automated Client Messages',\n      demo: {\n        before: 'You manually send: \"Hi! Confirmed for tomorrow at 2pm\"',\n        after: 'AI sends: \"Hi Sarah! Your cleaning is confirmed for January 15th at 2:00 PM. I\\'ll bring eco-friendly products as requested. Looking forward to making your home sparkle! - Maria\"',\n        impact: 'Professional, personalized, sent instantly'\n      },\n      features: [\n        '7 message types: confirmations, reminders, summaries, reviews',\n        'Custom templates with your personal touch',\n        'Multi-channel: SMS, Email, In-App',\n        'Timing controls: when to send each message'\n      ]\n    },\n    scheduling: {\n      icon: Calendar,\n      title: 'Smart Schedule Optimization',\n      demo: {\n        before: 'You have: 9am-11am job, then 4pm-6pm job (5-hour gap)',\n        after: 'AI suggests: \"Perfect 1pm-3pm booking available - fills your gap, same neighborhood, +$120\"',\n        impact: '+30% more efficient schedule'\n      },\n      features: [\n        'Detects schedule gaps automatically',\n        'Suggests bookings that maximize earnings',\n        'Analyzes travel time between jobs',\n        'Learns your preferred days/times'\n      ]\n    },\n    matching: {\n      icon: Users,\n      title: 'Intelligent Job Matching',\n      demo: {\n        before: 'Generic bookings: any client, any location',\n        after: 'AI prioritizes: \"Pet-friendly client nearby, eco products preferred, matches your specialties, 95% compatibility\"',\n        impact: 'Better client fit = better reviews'\n      },\n      features: [\n        'Matches based on your specialties',\n        'Considers location & travel time',\n        'Learns from your past acceptances',\n        'Flags high-risk clients automatically'\n      ]\n    },\n    insights: {\n      icon: TrendingUp,\n      title: 'Performance Insights',\n      demo: {\n        before: 'You wonder: \"How can I reach Pro tier?\"',\n        after: 'AI shows: \"You\\'re 3.2 points away. Upload photos for next 2 jobs (+2 pts) and arrive on-time (+1.5 pts)\"',\n        impact: 'Clear path to higher earnings'\n      },\n      features: [\n        'Real-time reliability score tracking',\n        'Personalized improvement recommendations',\n        'Earnings forecasts and goal tracking',\n        'To-do list based on your priorities'\n      ]\n    }\n  };\n\n  const current = exampleScenarios[activeTab];\n  const Icon = current.icon;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Tabs */}\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList className=\"grid grid-cols-4 w-full\">\n          <TabsTrigger value=\"communication\" className=\"font-fredoka\">\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\n            Messages\n          </TabsTrigger>\n          <TabsTrigger value=\"scheduling\" className=\"font-fredoka\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Scheduling\n          </TabsTrigger>\n          <TabsTrigger value=\"matching\" className=\"font-fredoka\">\n            <Users className=\"w-4 h-4 mr-2\" />\n            Matching\n          </TabsTrigger>\n          <TabsTrigger value=\"insights\" className=\"font-fredoka\">\n            <TrendingUp className=\"w-4 h-4 mr-2\" />\n            Insights\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value={activeTab} className=\"mt-6\">\n          <motion.div\n            key={activeTab}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"border-2 border-blue-200\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-500 to-blue-600 text-white\">\n                <CardTitle className=\"font-fredoka flex items-center gap-2\">\n                  <Icon className=\"w-6 h-6\" />\n                  {current.title}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-6 space-y-6\">\n                {/* Before/After Demo */}\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div className=\"bg-red-50 border-2 border-red-200 rounded-xl p-4\">\n                    <Badge className=\"mb-3 bg-red-500 text-white\">Without AI</Badge>\n                    <p className=\"text-sm font-verdana text-gray-700\">{current.demo.before}</p>\n                  </div>\n                  <div className=\"bg-green-50 border-2 border-green-200 rounded-xl p-4\">\n                    <Badge className=\"mb-3 bg-green-500 text-white\">With AI</Badge>\n                    <p className=\"text-sm font-verdana text-gray-700\">{current.demo.after}</p>\n                  </div>\n                </div>\n\n                {/* Impact */}\n                <div className=\"bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4\">\n                  <div className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5 text-blue-600\" />\n                    <p className=\"font-fredoka font-bold text-blue-900\">{current.demo.impact}</p>\n                  </div>\n                </div>\n\n                {/* Features */}\n                <div>\n                  <p className=\"font-fredoka font-semibold text-graphite mb-3\">Key Features:</p>\n                  <ul className=\"space-y-2\">\n                    {current.features.map((feature, idx) => (\n                      <li key={idx} className=\"flex items-start gap-2\">\n                        <CheckCircle className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span className=\"text-sm text-gray-700 font-verdana\">{feature}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </TabsContent>\n      </Tabs>\n\n      {/* Stats Banner */}\n      <div className=\"grid grid-cols-3 gap-4\">\n        <div className=\"bg-white border-2 border-purple-200 rounded-xl p-4 text-center\">\n          <DollarSign className=\"w-8 h-8 text-purple-600 mx-auto mb-2\" />\n          <p className=\"text-2xl font-fredoka font-bold text-graphite\">+30%</p>\n          <p className=\"text-xs text-gray-600 font-verdana\">Avg. Earnings Increase</p>\n        </div>\n        <div className=\"bg-white border-2 border-blue-200 rounded-xl p-4 text-center\">\n          <Clock className=\"w-8 h-8 text-blue-600 mx-auto mb-2\" />\n          <p className=\"text-2xl font-fredoka font-bold text-graphite\">5 hrs/wk</p>\n          <p className=\"text-xs text-gray-600 font-verdana\">Time Saved</p>\n        </div>\n        <div className=\"bg-white border-2 border-green-200 rounded-xl p-4 text-center\">\n          <Star className=\"w-8 h-8 text-green-600 mx-auto mb-2\" />\n          <p className=\"text-2xl font-fredoka font-bold text-graphite\">4.8‚òÖ</p>\n          <p className=\"text-xs text-gray-600 font-verdana\">Avg. User Rating</p>\n        </div>\n      </div>\n\n      <Button onClick={onContinue} className=\"w-full brand-gradient text-white font-fredoka font-bold\" size=\"lg\">\n        Continue to Setup ‚Üí\n      </Button>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIImpactExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Card' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14,"fix":{"range":[35,41],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Card"},"fix":{"range":[36,41],"text":""},"desc":"Remove unused variable 'Card'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardContent' is defined but never used.","line":2,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":27,"fix":{"range":[40,53],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardContent"},"fix":{"range":[40,53],"text":""},"desc":"Remove unused variable 'CardContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":4,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":47,"fix":{"range":[172,178],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[172,178],"text":""},"desc":"Remove unused variable 'Info'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Minus, Info } from 'lucide-react';\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\n\nexport default function AIImpactExplainer({ \n  settingName, \n  impact = 'neutral', // 'positive', 'negative', 'neutral'\n  impactAreas = [], // ['reliability_score', 'earnings', 'bookings']\n  description = ''\n}) {\n  const impactConfig = {\n    positive: {\n      icon: TrendingUp,\n      color: 'text-green-600',\n      bg: 'bg-green-50',\n      border: 'border-green-200',\n      label: 'Positive Impact'\n    },\n    negative: {\n      icon: TrendingDown,\n      color: 'text-red-600',\n      bg: 'bg-red-50',\n      border: 'border-red-200',\n      label: 'Caution'\n    },\n    neutral: {\n      icon: Minus,\n      color: 'text-gray-600',\n      bg: 'bg-gray-50',\n      border: 'border-gray-200',\n      label: 'Informational'\n    }\n  };\n\n  const config = impactConfig[impact];\n  const Icon = config.icon;\n\n  const areaLabels = {\n    reliability_score: 'Reliability Score',\n    earnings: 'Earnings Potential',\n    bookings: 'Booking Rate',\n    client_satisfaction: 'Client Satisfaction',\n    time_saved: 'Time Saved'\n  };\n\n  return (\n    <TooltipProvider>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <div className={`inline-flex items-center gap-1.5 px-2 py-1 rounded-full ${config.bg} ${config.border} border cursor-help`}>\n            <Icon className={`w-3 h-3 ${config.color}`} />\n            <span className={`text-xs font-fredoka ${config.color}`}>\n              {config.label}\n            </span>\n          </div>\n        </TooltipTrigger>\n        <TooltipContent className=\"max-w-xs\">\n          <div className=\"space-y-2\">\n            <p className=\"font-fredoka font-semibold text-sm\">{settingName}</p>\n            <p className=\"text-xs text-gray-600 font-verdana\">{description}</p>\n            {impactAreas.length > 0 && (\n              <div className=\"pt-2 border-t\">\n                <p className=\"text-xs font-fredoka mb-1\">Affects:</p>\n                <div className=\"flex flex-wrap gap-1\">\n                  {impactAreas.map(area => (\n                    <Badge key={area} variant=\"outline\" className=\"text-xs\">\n                      {areaLabels[area] || area}\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        </TooltipContent>\n      </Tooltip>\n    </TooltipProvider>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIInsightsWidget.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":5,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":55,"fix":{"range":[269,284],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[268,283],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Calendar, TrendingUp, MessageSquare, ChevronRight, Loader2 } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function AIInsightsWidget({ cleanerProfile }) {\n  const navigate = useNavigate();\n  const [insights, setInsights] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [activityExpanded, setActivityExpanded] = useState(false);\n\n  useEffect(() => {\n    if (cleanerProfile?.user_email) {\n      loadInsights();\n    }\n  }, [cleanerProfile?.user_email]);\n\n  const loadInsights = async () => {\n    try {\n      setLoading(true);\n      // Call backend function to get AI insights\n      const response = await base44.functions.invoke('agentAssistant', {\n        action: 'get_dashboard_insights',\n        cleaner_email: cleanerProfile.user_email\n      });\n      setInsights(response.data);\n    } catch (error) {\n      console.error('Failed to load AI insights:', error);\n      setInsights({\n        next_best_action: null,\n        schedule_alerts: [],\n        recent_activity: [],\n        performance_snapshot: {\n          score: cleanerProfile?.reliability_score || 75,\n          tier: cleanerProfile?.tier || 'Semi Pro'\n        }\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-2 border-blue-200\">\n        <CardContent className=\"flex items-center justify-center py-12\">\n          <Loader2 className=\"w-6 h-6 animate-spin text-puretask-blue\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.3 }}\n    >\n      <Card className=\"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-white\">\n        <CardHeader className=\"bg-gradient-to-r from-blue-500 to-blue-600 text-white\">\n          <div className=\"flex items-center gap-2\">\n            <motion.div\n              animate={{ rotate: [0, 10, -10, 0] }}\n              transition={{ repeat: Infinity, duration: 3, ease: \"easeInOut\" }}\n            >\n              <Sparkles className=\"w-6 h-6\" />\n            </motion.div>\n            <CardTitle className=\"font-fredoka text-xl\">AI Assistant Insights</CardTitle>\n          </div>\n          <p className=\"text-sm text-blue-100 font-verdana\">Smart recommendations for your business</p>\n        </CardHeader>\n\n        <CardContent className=\"pt-6 space-y-4\">\n          {/* Next Best Action */}\n          {insights?.next_best_action ? (\n            <div className=\"bg-white rounded-lg border-l-4 border-blue-500 p-4 shadow-sm\">\n              <p className=\"text-xs text-gray-500 font-verdana mb-1\">Next Best Action:</p>\n              <p className=\"text-sm font-fredoka font-semibold text-gray-800 mb-3\">\n                {insights.next_best_action.description}\n              </p>\n              {insights.next_best_action.action_button && (\n                <Button\n                  size=\"sm\"\n                  className=\"brand-gradient text-white\"\n                  onClick={() => navigate(insights.next_best_action.action_link)}\n                >\n                  {insights.next_best_action.action_button}\n                  <ChevronRight className=\"w-4 h-4 ml-1\" />\n                </Button>\n              )}\n            </div>\n          ) : (\n            <div className=\"bg-green-50 rounded-lg border-l-4 border-green-500 p-4\">\n              <p className=\"text-sm font-fredoka text-green-800\">\n                ‚úì You're all caught up! Your schedule looks great.\n              </p>\n            </div>\n          )}\n\n          {/* Schedule Optimization Alert */}\n          {insights?.schedule_alerts?.length > 0 && (\n            <div className=\"bg-yellow-50 rounded-lg border-l-4 border-yellow-500 p-4\">\n              <div className=\"flex items-start gap-2\">\n                <Calendar className=\"w-4 h-4 text-yellow-600 mt-0.5\" />\n                <div className=\"flex-1\">\n                  <p className=\"text-sm font-fredoka font-semibold text-gray-800 mb-1\">\n                    Schedule Optimization\n                  </p>\n                  <p className=\"text-xs text-gray-600 font-verdana\">\n                    {insights.schedule_alerts[0].message}\n                  </p>\n                </div>\n              </div>\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                className=\"mt-3\"\n                onClick={() => navigate(createPageUrl('CleanerSchedule'))}\n              >\n                Optimize Schedule\n              </Button>\n            </div>\n          )}\n\n          {/* Performance Snapshot */}\n          <div className=\"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-xs text-gray-600 font-verdana mb-1\">Reliability Score</p>\n                <p className=\"text-2xl font-fredoka font-bold text-gray-800\">\n                  {insights?.performance_snapshot?.score || 75}/100\n                </p>\n                <Badge className=\"mt-1 bg-blue-600 text-white\">\n                  {insights?.performance_snapshot?.tier || 'Semi Pro'}\n                </Badge>\n              </div>\n              <TrendingUp className=\"w-12 h-12 text-blue-500 opacity-50\" />\n            </div>\n          </div>\n\n          {/* AI Activity Summary */}\n          <div className=\"border-t pt-4\">\n            <button\n              onClick={() => setActivityExpanded(!activityExpanded)}\n              className=\"flex items-center justify-between w-full text-left\"\n            >\n              <p className=\"text-sm font-fredoka font-semibold text-gray-700\">Recent AI Activity</p>\n              <ChevronRight className={`w-4 h-4 transition-transform ${activityExpanded ? 'rotate-90' : ''}`} />\n            </button>\n            \n            {activityExpanded && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                className=\"mt-3 space-y-2\"\n              >\n                {insights?.recent_activity?.length > 0 ? (\n                  insights.recent_activity.map((activity, idx) => (\n                    <div key={idx} className=\"flex items-center gap-2 text-xs text-gray-600 font-verdana\">\n                      <div className=\"w-1.5 h-1.5 rounded-full bg-blue-500\" />\n                      <span>{activity}</span>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-xs text-gray-500 font-verdana\">No recent activity</p>\n                )}\n              </motion.div>\n            )}\n          </div>\n\n          {/* Quick Actions */}\n          <div className=\"flex flex-wrap gap-2 pt-4 border-t\">\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => navigate(createPageUrl('AIAssistantSettings'))}\n              className=\"flex-1\"\n            >\n              Manage AI Settings\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => navigate(createPageUrl('AIActivityDashboard'))}\n              className=\"flex-1\"\n            >\n              View Full Activity\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIResponseGenerator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AIResponseSuggestions.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"fix":{"range":[347,365],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[351,365],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":8,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"fix":{"range":[387,394],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[386,393],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":279,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":279,"endColumn":44,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[9189,9196],"text":""},"desc":"Remove unused variable 'index'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  MessageSquare, Send, Copy, Sparkles, Clock, \n  CheckCircle, Loader2, RefreshCw, Lightbulb\n} from 'lucide-react';\nimport { format } from 'date-fns';\n\nexport default function AIResponseSuggestions({ threadId, clientMessage }) {\n  const [suggestions, setSuggestions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [sendingIndex, setSendingIndex] = useState(null);\n  const [copied, setCopied] = useState(false);\n\n  useEffect(() => {\n    if (clientMessage) {\n      generateSuggestions(clientMessage);\n    }\n  }, [clientMessage]);\n\n  const generateSuggestions = async (message) => {\n    setLoading(true);\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Get cleaner profile for context\n      const profiles = await base44.entities.CleanerProfile.filter({\n        user_email: currentUser.email\n      });\n\n      const profile = profiles[0];\n\n      // Get booking context if available\n      const threads = await base44.entities.ConversationThread.filter({ id: threadId });\n      const thread = threads[0];\n      \n      let bookingContext = '';\n      if (thread?.booking_id) {\n        const bookings = await base44.entities.Booking.filter({ id: thread.booking_id });\n        if (bookings.length > 0) {\n          const booking = bookings[0];\n          bookingContext = `Booking: ${format(new Date(booking.date), 'MMM d')} at ${booking.start_time}, ${booking.hours}h, ${booking.address}`;\n        }\n      }\n\n      // Use AI to generate contextual responses\n      const prompt = `You are a professional cleaning service provider. Generate 3 helpful response options for this client inquiry:\n\nClient Message: \"${message}\"\n\nContext:\n- Cleaner: ${profile.full_name}\n- Rating: ${profile.average_rating}/5\n- ${bookingContext}\n\nGenerate 3 response options:\n1. Professional and detailed\n2. Friendly and warm\n3. Quick and concise\n\nMake them natural, helpful, and appropriate for the context.`;\n\n      const aiResponse = await base44.integrations.Core.InvokeLLM({\n        prompt,\n        response_json_schema: {\n          type: 'object',\n          properties: {\n            responses: {\n              type: 'array',\n              items: {\n                type: 'object',\n                properties: {\n                  text: { type: 'string' },\n                  style: { type: 'string' },\n                  tone: { type: 'string' }\n                }\n              }\n            }\n          }\n        }\n      });\n\n      const generated = aiResponse.responses || [];\n      setSuggestions(generated.map((r, i) => ({\n        id: i,\n        text: r.text,\n        style: r.style || 'Professional',\n        tone: r.tone || 'Helpful'\n      })));\n\n    } catch (error) {\n      console.error('Error generating suggestions:', error);\n      \n      // Fallback suggestions based on common patterns\n      const fallbackSuggestions = generateFallbackSuggestions(message);\n      setSuggestions(fallbackSuggestions);\n    }\n    setLoading(false);\n  };\n\n  const generateFallbackSuggestions = (message) => {\n    const lowerMessage = message.toLowerCase();\n\n    if (lowerMessage.includes('available') || lowerMessage.includes('schedule')) {\n      return [\n        {\n          id: 1,\n          text: \"Yes, I'm available! What date and time works best for you? I typically have openings throughout the week.\",\n          style: 'Professional',\n          tone: 'Eager'\n        },\n        {\n          id: 2,\n          text: \"I'd be happy to help! Let me know which day you prefer and I'll check my schedule for available time slots.\",\n          style: 'Warm',\n          tone: 'Friendly'\n        },\n        {\n          id: 3,\n          text: \"Available! What day/time? üòä\",\n          style: 'Casual',\n          tone: 'Quick'\n        }\n      ];\n    }\n\n    if (lowerMessage.includes('price') || lowerMessage.includes('cost') || lowerMessage.includes('rate')) {\n      return [\n        {\n          id: 1,\n          text: \"My rates depend on the size of your space and type of cleaning. For a detailed quote, could you share your home size (sq ft or bedrooms/bathrooms) and whether you need a basic, deep, or move-out clean?\",\n          style: 'Professional',\n          tone: 'Informative'\n        },\n        {\n          id: 2,\n          text: \"I'd love to give you an accurate quote! Can you tell me a bit about your space - how many bedrooms and bathrooms, and what type of cleaning you're looking for?\",\n          style: 'Warm',\n          tone: 'Helpful'\n        },\n        {\n          id: 3,\n          text: \"Rates vary by home size and cleaning type. What are your space details?\",\n          style: 'Concise',\n          tone: 'Direct'\n        }\n      ];\n    }\n\n    if (lowerMessage.includes('supplies') || lowerMessage.includes('products') || lowerMessage.includes('bring')) {\n      return [\n        {\n          id: 1,\n          text: \"I bring all my own professional cleaning supplies and equipment! If you have specific product preferences or allergies, just let me know and I'm happy to accommodate.\",\n          style: 'Professional',\n          tone: 'Reassuring'\n        },\n        {\n          id: 2,\n          text: \"Don't worry - I come fully equipped with all supplies! I use high-quality, effective products. If you prefer eco-friendly or have any sensitivities, I can definitely work with that.\",\n          style: 'Warm',\n          tone: 'Accommodating'\n        },\n        {\n          id: 3,\n          text: \"Yes, I bring everything! Can customize products if needed.\",\n          style: 'Quick',\n          tone: 'Efficient'\n        }\n      ];\n    }\n\n    // Generic helpful responses\n    return [\n      {\n        id: 1,\n        text: \"Thank you for your message! I'd be happy to help with that. Could you provide a few more details so I can give you the best answer?\",\n        style: 'Professional',\n        tone: 'Polite'\n      },\n      {\n        id: 2,\n        text: \"Hi! Thanks for reaching out. I'd love to assist you with this. What additional information would be helpful?\",\n        style: 'Friendly',\n        tone: 'Warm'\n      },\n      {\n        id: 3,\n        text: \"Happy to help! Can you share more details?\",\n        style: 'Casual',\n        tone: 'Brief'\n      }\n    ];\n  };\n\n  const handleSendSuggestion = async (suggestion) => {\n    setSendingIndex(suggestion.id);\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Send the suggested response\n      await base44.entities.Message.create({\n        thread_id: threadId,\n        sender_email: currentUser.email,\n        content: suggestion.text,\n        type: 'user_message',\n        timestamp: new Date().toISOString(),\n        metadata: {\n          ai_suggested: true,\n          suggestion_style: suggestion.style\n        }\n      });\n\n      // Update thread\n      const threads = await base44.entities.ConversationThread.filter({ id: threadId });\n      if (threads.length > 0) {\n        await base44.entities.ConversationThread.update(threadId, {\n          last_message_at: new Date().toISOString(),\n          last_message_content: suggestion.text.substring(0, 100),\n          unread_count_client: (threads[0].unread_count_client || 0) + 1\n        });\n      }\n\n      // Clear suggestions after sending\n      setSuggestions([]);\n      \n    } catch (error) {\n      console.error('Error sending suggestion:', error);\n    }\n    setSendingIndex(null);\n  };\n\n  const handleCopySuggestion = (text) => {\n    navigator.clipboard.writeText(text);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-2 border-dashed border-blue-200\">\n        <CardContent className=\"p-6 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue mx-auto mb-2\" />\n          <p className=\"text-sm text-slate-600 font-verdana\">AI is generating response suggestions...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (suggestions.length === 0 || !clientMessage) {\n    return null;\n  }\n\n  return (\n    <Card className=\"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n            AI-Generated Response Suggestions\n          </CardTitle>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => generateSuggestions(clientMessage)}\n          >\n            <RefreshCw className=\"w-4 h-4\" />\n          </Button>\n        </div>\n        <p className=\"text-xs text-slate-600 font-verdana\">\n          Select a response to send or customize it further\n        </p>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {suggestions.map((suggestion, index) => (\n          <div\n            key={suggestion.id}\n            className=\"bg-white border-2 border-slate-200 rounded-lg p-4 hover:border-puretask-blue transition-colors\"\n          >\n            <div className=\"flex items-start justify-between mb-2\">\n              <div className=\"flex gap-2\">\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  {suggestion.style}\n                </Badge>\n                <Badge variant=\"outline\" className=\"text-xs text-purple-700 border-purple-300\">\n                  {suggestion.tone}\n                </Badge>\n              </div>\n            </div>\n            \n            <p className=\"text-sm text-slate-700 font-verdana mb-3 leading-relaxed\">\n              {suggestion.text}\n            </p>\n\n            <div className=\"flex gap-2\">\n              <Button\n                size=\"sm\"\n                onClick={() => handleSendSuggestion(suggestion)}\n                disabled={sendingIndex === suggestion.id}\n                className=\"flex-1 brand-gradient text-white\"\n              >\n                {sendingIndex === suggestion.id ? (\n                  <>\n                    <Loader2 className=\"w-3 h-3 mr-1 animate-spin\" />\n                    Sending...\n                  </>\n                ) : (\n                  <>\n                    <Send className=\"w-3 h-3 mr-1\" />\n                    Send This\n                  </>\n                )}\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => handleCopySuggestion(suggestion.text)}\n              >\n                {copied ? (\n                  <CheckCircle className=\"w-3 h-3 text-green-600\" />\n                ) : (\n                  <Copy className=\"w-3 h-3\" />\n                )}\n              </Button>\n            </div>\n          </div>\n        ))}\n\n        <Alert className=\"bg-blue-50 border-blue-200\">\n          <Lightbulb className=\"w-4 h-4 text-blue-600\" />\n          <AlertDescription className=\"text-xs font-verdana\">\n            These AI-generated responses are suggestions. Feel free to customize them to match your personal style!\n          </AlertDescription>\n        </Alert>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AISchedulingSettings.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleanerProfile' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":82,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanerProfile"},"fix":{"range":[630,646],"text":""},"desc":"Remove unused variable 'cleanerProfile'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, TrendingUp, Clock } from 'lucide-react';\nimport { createPageUrl } from '@/utils';\nimport { useNavigate } from 'react-router-dom';\nimport AISettingTooltip from './AISettingTooltip';\n\nexport default function AISchedulingSettings({ settings, onChange, cleanerProfile }) {\n  const navigate = useNavigate();\n\n  const handleChange = (key, value) => {\n    onChange({ ...settings, [key]: value });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* AI Scheduling Master Card */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n            <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n            AI-Powered Schedule Optimization\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">\n            Let AI analyze your patterns and suggest optimal booking times\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {/* Master Toggle */}\n          <div className=\"flex items-start justify-between p-4 bg-blue-50 rounded-lg\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-2\">\n                <Label htmlFor=\"ai-scheduling\" className=\"font-fredoka font-semibold text-lg cursor-pointer\">\n                  Enable AI Scheduling\n                </Label>\n                <AISettingTooltip\n                  title=\"AI Scheduling\"\n                  description=\"AI analyzes your booking patterns and suggests optimal time slots to clients\"\n                  benefits={[\n                    'Fills gaps in your schedule automatically',\n                    'Maximizes daily earnings',\n                    'Reduces travel time between jobs',\n                    'Learns your preferences over time'\n                  ]}\n                  considerations={[\n                    'Requires accurate availability settings',\n                    'May suggest bookings during less preferred times initially'\n                  ]}\n                />\n              </div>\n              <p className=\"text-sm text-gray-600 font-verdana mt-1\">\n                When enabled, AI proactively suggests booking times that fill gaps, minimize travel, and match your preferences\n              </p>\n            </div>\n            <Switch\n              id=\"ai-scheduling\"\n              checked={settings?.ai_scheduling_enabled || false}\n              onCheckedChange={(checked) => handleChange('ai_scheduling_enabled', checked)}\n            />\n          </div>\n\n          {/* Conditional Settings - Only show if AI Scheduling is enabled */}\n          {settings?.ai_scheduling_enabled && (\n            <div className=\"space-y-4 pl-4 border-l-2 border-blue-200\">\n              {/* Prioritize Gap Filling */}\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <Label htmlFor=\"gap-filling\" className=\"font-fredoka cursor-pointer\">\n                      Prioritize Filling Schedule Gaps\n                    </Label>\n                    <AISettingTooltip\n                      title=\"Gap Filling Priority\"\n                      description=\"AI suggests bookings that fill empty slots between existing jobs\"\n                      benefits={[\n                        'Maximizes earnings per day',\n                        'Reduces downtime',\n                        'More efficient use of your time'\n                      ]}\n                      considerations={[\n                        'May book jobs during short breaks',\n                        'Could increase fatigue on busy days'\n                      ]}\n                    />\n                  </div>\n                  <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                    AI focuses on filling empty time between bookings\n                  </p>\n                </div>\n                <Switch\n                  id=\"gap-filling\"\n                  checked={settings?.prioritize_gap_filling !== false}\n                  onCheckedChange={(checked) => handleChange('prioritize_gap_filling', checked)}\n                />\n              </div>\n\n              {/* Suggestion Window */}\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2\">\n                  <Label className=\"font-fredoka\">Suggestion Window</Label>\n                  <AISettingTooltip\n                    title=\"Booking Suggestion Window\"\n                    description=\"How far ahead AI can suggest booking slots\"\n                    benefits={[\n                      'Longer windows = more booking opportunities',\n                      'Better advance planning'\n                    ]}\n                    considerations={[\n                      'Very long windows may suggest bookings too far out',\n                      'Clients may prefer shorter-term bookings'\n                    ]}\n                  />\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"60\"\n                    value={settings?.suggest_days_in_advance || 14}\n                    onChange={(e) => handleChange('suggest_days_in_advance', parseInt(e.target.value) || 14)}\n                    className=\"w-24\"\n                  />\n                  <span className=\"text-sm font-verdana text-gray-600\">days in advance</span>\n                </div>\n                <p className=\"text-xs text-gray-500 font-verdana\">\n                  AI can suggest bookings up to {settings?.suggest_days_in_advance || 14} days ahead\n                </p>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Availability Optimization Insights */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-lg flex items-center gap-2\">\n            <TrendingUp className=\"w-5 h-5 text-green-600\" />\n            Availability Optimization Insights\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">\n            AI learns from your acceptance patterns to suggest improvements\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {/* Stats Display */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"bg-green-50 rounded-lg p-4\">\n              <p className=\"text-xs text-gray-600 font-verdana mb-1\">Most Accepted Time</p>\n              <p className=\"text-lg font-fredoka font-semibold text-gray-800\">Weekday Mornings</p>\n              <Badge className=\"mt-2 bg-green-600 text-white\">85% acceptance rate</Badge>\n            </div>\n            <div className=\"bg-yellow-50 rounded-lg p-4\">\n              <p className=\"text-xs text-gray-600 font-verdana mb-1\">Least Accepted Time</p>\n              <p className=\"text-lg font-fredoka font-semibold text-gray-800\">Weekend Evenings</p>\n              <Badge className=\"mt-2 bg-yellow-600 text-white\">40% acceptance rate</Badge>\n            </div>\n          </div>\n\n          {/* AI Insight */}\n          <div className=\"bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg\">\n            <p className=\"text-sm font-fredoka font-semibold text-gray-800 mb-1\">\n              AI Recommendation:\n            </p>\n            <p className=\"text-sm font-verdana text-gray-700\">\n              Consider adding Tuesday 2-5pm slots. Based on your history, you accept 75% of bookings in this time range.\n            </p>\n          </div>\n\n          {/* Link to Detailed Schedule */}\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={() => navigate(createPageUrl('CleanerSchedule'))}\n          >\n            <Clock className=\"w-4 h-4 mr-2\" />\n            Manage Detailed Schedule\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AISchedulingSuggestions.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'format' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"fix":{"range":[385,393],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"format"},"fix":{"range":[386,393],"text":""},"desc":"Remove unused variable 'format'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":25,"fix":{"range":[393,402],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[392,401],"text":""},"desc":"Remove unused variable 'addDays'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'parseISO' is defined but never used.","line":7,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":35,"fix":{"range":[401,411],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"parseISO"},"fix":{"range":[401,411],"text":""},"desc":"Remove unused variable 'parseISO'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'allClients' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":30,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"allClients"},"fix":{"range":[1149,1211],"text":""},"desc":"Remove unused variable 'allClients'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, Clock, MapPin, User, TrendingUp, Sparkles, Check, X, Loader2 } from 'lucide-react';\nimport { format, addDays, parseISO } from 'date-fns';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function AISchedulingSuggestions({ cleanerEmail }) {\n  const [suggestions, setSuggestions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [processing, setProcessing] = useState(null);\n\n  useEffect(() => {\n    loadSuggestions();\n  }, [cleanerEmail]);\n\n  const loadSuggestions = async () => {\n    try {\n      setLoading(true);\n      \n      // Get cleaner profile\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n      if (profiles.length === 0) return;\n      \n      const profile = profiles[0];\n      \n      // Get client preferences that match cleaner's specialties\n      const allClients = await base44.entities.ClientProfile.list();\n      \n      // Get cleaner's bookings to analyze gaps\n      const bookings = await base44.entities.Booking.filter({ cleaner_email: cleanerEmail });\n      \n      // Generate AI suggestions using LLM\n      const prompt = `You are an AI scheduling assistant for a cleaning professional.\n      \nCleaner Profile:\n- Specialties: ${profile.specialty_tags?.join(', ') || 'General cleaning'}\n- Tier: ${profile.tier}\n- Service Locations: ${profile.service_locations?.join(', ') || 'Not specified'}\n- Instant Book: ${profile.instant_book_enabled ? 'Yes' : 'No'}\n- Current Bookings: ${bookings.length}\n\nAnalyze the cleaner's schedule for the next 14 days and suggest optimal booking slots that:\n1. Fill gaps in their schedule\n2. Match clients with similar preferences\n3. Maximize earnings by grouping nearby locations\n4. Consider the cleaner's typical acceptance patterns\n\nReturn a JSON array of 3-5 suggestions with this structure:\n[\n  {\n    \"client_name\": \"Potential Client Name\",\n    \"date\": \"2025-01-15\",\n    \"time\": \"10:00 AM\",\n    \"duration\": 3,\n    \"location\": \"Area name\",\n    \"reason\": \"Why this is a good match\",\n    \"estimated_earnings\": 120,\n    \"match_score\": 85,\n    \"client_preferences\": [\"pet-friendly\", \"eco-products\"]\n  }\n]`;\n\n      const response = await base44.integrations.Core.InvokeLLM({\n        prompt: prompt,\n        response_json_schema: {\n          type: \"object\",\n          properties: {\n            suggestions: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  client_name: { type: \"string\" },\n                  date: { type: \"string\" },\n                  time: { type: \"string\" },\n                  duration: { type: \"number\" },\n                  location: { type: \"string\" },\n                  reason: { type: \"string\" },\n                  estimated_earnings: { type: \"number\" },\n                  match_score: { type: \"number\" },\n                  client_preferences: { type: \"array\", items: { type: \"string\" } }\n                }\n              }\n            }\n          }\n        }\n      });\n\n      setSuggestions(response.suggestions || []);\n    } catch (error) {\n      console.error('Error loading suggestions:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleAccept = async (suggestion) => {\n    setProcessing(suggestion);\n    // In a real implementation, this would reach out to the client\n    await new Promise(resolve => setTimeout(resolve, 1500));\n    setSuggestions(prev => prev.filter(s => s !== suggestion));\n    setProcessing(null);\n  };\n\n  const handleDecline = (suggestion) => {\n    setSuggestions(prev => prev.filter(s => s !== suggestion));\n  };\n\n  if (loading) {\n    return (\n      <Card>\n        <CardContent className=\"p-6 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue mx-auto mb-2\" />\n          <p className=\"text-sm text-gray-600\">Analyzing optimal time slots...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (suggestions.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"p-6 text-center\">\n          <Sparkles className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\n          <p className=\"text-gray-600 font-verdana\">No scheduling suggestions at the moment.</p>\n          <Button onClick={loadSuggestions} variant=\"outline\" className=\"mt-3\">\n            Refresh Suggestions\n          </Button>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <AnimatePresence>\n        {suggestions.map((suggestion, idx) => (\n          <motion.div\n            key={idx}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, x: -100 }}\n            transition={{ delay: idx * 0.1 }}\n          >\n            <Card className=\"border-2 border-blue-200 bg-gradient-to-r from-blue-50 to-cyan-50\">\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n                    <CardTitle className=\"text-lg font-fredoka\">AI Suggested Booking</CardTitle>\n                  </div>\n                  <Badge className=\"bg-puretask-blue text-white font-fredoka\">\n                    {suggestion.match_score}% Match\n                  </Badge>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid md:grid-cols-2 gap-4 mb-4\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <User className=\"w-4 h-4 text-gray-600\" />\n                      <span className=\"font-verdana\">{suggestion.client_name}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <Calendar className=\"w-4 h-4 text-gray-600\" />\n                      <span className=\"font-verdana\">{suggestion.date} at {suggestion.time}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <Clock className=\"w-4 h-4 text-gray-600\" />\n                      <span className=\"font-verdana\">{suggestion.duration} hours</span>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <MapPin className=\"w-4 h-4 text-gray-600\" />\n                      <span className=\"font-verdana\">{suggestion.location}</span>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <TrendingUp className=\"w-4 h-4 text-fresh-mint\" />\n                      <span className=\"font-verdana font-bold text-fresh-mint\">\n                        ${suggestion.estimated_earnings} estimated\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {suggestion.client_preferences?.map((pref, i) => (\n                        <Badge key={i} variant=\"outline\" className=\"text-xs\">\n                          {pref}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"bg-white rounded-lg p-3 mb-4\">\n                  <p className=\"text-sm text-gray-700 font-verdana\">\n                    <span className=\"font-semibold\">Why this is a good match:</span> {suggestion.reason}\n                  </p>\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={() => handleAccept(suggestion)}\n                    disabled={processing === suggestion}\n                    className=\"flex-1 brand-gradient text-white font-fredoka\"\n                  >\n                    {processing === suggestion ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Reaching Out...\n                      </>\n                    ) : (\n                      <>\n                        <Check className=\"w-4 h-4 mr-2\" />\n                        Express Interest\n                      </>\n                    )}\n                  </Button>\n                  <Button\n                    onClick={() => handleDecline(suggestion)}\n                    disabled={processing === suggestion}\n                    variant=\"outline\"\n                    className=\"flex-1 font-fredoka\"\n                  >\n                    <X className=\"w-4 h-4 mr-2\" />\n                    Not Interested\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        ))}\n      </AnimatePresence>\n\n      <Button onClick={loadSuggestions} variant=\"outline\" className=\"w-full font-fredoka\">\n        <Sparkles className=\"w-4 h-4 mr-2\" />\n        Refresh Suggestions\n      </Button>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AISettingTooltip.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AITodoList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AITooltip.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'children' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"children"},"fix":{"range":[221,231],"text":""},"desc":"Remove unused variable 'children'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip';\nimport AIBadge from './AIBadge';\n\nexport default function AITooltip({ variant, reason, children }) {\n  if (!reason) {\n    return <AIBadge variant={variant} />;\n  }\n\n  return (\n    <TooltipProvider>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <span className=\"cursor-help\">\n            <AIBadge variant={variant} />\n          </span>\n        </TooltipTrigger>\n        <TooltipContent className=\"max-w-[250px]\">\n          <p className=\"text-xs font-verdana\">{reason}</p>\n        </TooltipContent>\n      </Tooltip>\n    </TooltipProvider>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AI_IMPLEMENTATION_PLAN.md.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected character ' '","line":1,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"# PureTask AI Communication & Scheduling System - Implementation Plan\n\n## Executive Summary\nThis document outlines the complete design, build, and implementation process for PureTask's AI-driven communication and scheduling system. The system enables automated client communication, intelligent booking slot suggestions, and gives cleaners granular control over all automated interactions.\n\n---\n\n## Phase 1: Foundation ‚úÖ COMPLETED\n**Status:** Done\n- ‚úÖ SMS Integration (`functions/sendSMS.js`)\n- ‚úÖ Extended `CleanerProfile` entity with `communication_settings`\n- ‚úÖ Secrets configured (Twilio credentials)\n\n---\n\n## Phase 2: AI-Driven Scheduling Core Logic\n\n### 2.1 AI Booking Slot Suggestion Function\n**File:** `functions/suggestBookingSlots.js`\n\n**Input Parameters:**\n- `client_email` - To retrieve client preferences\n- `cleaner_email` - Target cleaner\n- `cleaning_type` - basic/deep/moveout\n- `estimated_hours` - Duration estimate\n- `preferred_dates` - Array of client's preferred dates\n- `address` - Cleaning location\n- `entry_instructions` - Access details\n- `client_preferences` - Any special requirements\n\n**Processing Logic:**\n1. Fetch `CleanerProfile` for availability data:\n   - `custom_availability_slots`\n   - `communication_settings.ai_scheduling_enabled`\n   - `communication_settings.suggest_days_in_advance`\n   - `communication_settings.prioritize_gap_filling`\n2. Fetch cleaner's existing `Booking` entities to identify occupied slots\n3. Calculate available time slots within the next X days (per cleaner settings)\n4. Construct AI prompt with:\n   - Client needs (type, hours, dates, location)\n   - Cleaner availability (all open slots)\n   - Current bookings context\n   - Gap-filling priority flag\n5. Call `base44.integrations.Core.InvokeLLM` with structured JSON response schema\n6. Return array of suggested slots with reasoning\n\n**Output JSON Schema:**\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"suggested_slots\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"date\": { \"type\": \"string\", \"format\": \"date\" },\n          \"start_time\": { \"type\": \"string\" },\n          \"end_time\": { \"type\": \"string\" },\n          \"reasoning\": { \"type\": \"string\" },\n          \"fills_gap\": { \"type\": \"boolean\" }\n        }\n      }\n    },\n    \"alternative_message\": { \"type\": \"string\" }\n  }\n}\n```\n\n### 2.2 Process Client Booking Response Function\n**File:** `functions/processClientBookingResponse.js`\n\n**Input Parameters:**\n- `booking_request_id` - Reference to initial request\n- `client_response` - \"selected_slot\" | \"suggest_other\" | \"not_interested\"\n- `selected_slot` - Object with date/time if client selected\n- `client_email`\n- `cleaner_email`\n\n**Processing Logic:**\n\n**If `client_response === \"selected_slot\"`:**\n1. Create provisional `Booking` entity:\n   - Status: `\"awaiting_cleaner_approval\"`\n   - All booking details from request\n   - `provisional_slot_expires_at` (48 hours from now)\n2. Create `Notification` for cleaner:\n   - Type: `\"booking_requires_approval\"`\n   - Link to approval interface\n3. Create in-app `Message` in `ConversationThread`:\n   - Subject: \"New Booking Request Awaiting Your Approval\"\n   - Include all details: client name, address, entry instructions, date/time, duration\n4. If cleaner has SMS enabled for booking notifications, call `sendSMS` function\n5. Return success with booking ID\n\n**If `client_response === \"not_interested\"`:**\n1. Update booking request status to \"client_declined\"\n2. If cleaner's `communication_settings.notify_client_not_interested` is true:\n   - Create `Notification` for cleaner\n   - Send via configured channels\n3. Log the interaction for analytics\n4. Return acknowledgment\n\n**If `client_response === \"suggest_other\"`:**\n1. Re-trigger `suggestBookingSlots` with note to exclude previously suggested times\n2. Return new suggestions\n\n### 2.3 Cleaner Booking Approval/Decline Function\n**File:** `functions/cleanerBookingApproval.js`\n\n**Input Parameters:**\n- `booking_id`\n- `cleaner_email`\n- `decision` - \"approve\" | \"decline\" | \"not_interested\"\n- `decline_reason` - Optional text if declined\n\n**Processing Logic:**\n\n**If `decision === \"approve\"`:**\n1. Update `Booking` entity:\n   - Status: `\"scheduled\"`\n   - Clear `provisional_slot_expires_at`\n2. Update cleaner's `custom_availability_slots`:\n   - Mark the approved time slot as unavailable\n3. Create `Notification` for client:\n   - Type: `\"booking_confirmed\"`\n   - Include confirmation details\n4. Send confirmation via cleaner's configured channels:\n   - Check `communication_settings.booking_confirmation.enabled`\n   - Get channels from `communication_settings.booking_confirmation.channels`\n   - Use `custom_template` with variable replacements\n5. Call notification automation functions as configured\n6. Return success\n\n**If `decision === \"decline\"`:**\n1. Update `Booking` entity:\n   - Status: `\"cleaner_declined\"`\n   - Add `decline_reason`\n2. Create `Notification` for client:\n   - Type: `\"booking_declined\"`\n   - Suggest browsing other cleaners or selecting different time\n3. Optionally trigger fallback cleaner search (if client had this preference)\n4. Return acknowledgment\n\n**If `decision === \"not_interested\"`:**\n1. Same as decline but with additional analytics logging\n2. Can inform AI for future matching improvements\n\n---\n\n## Phase 3: Cleaner Configuration UI\n\n### 3.1 AI Communication Settings Component\n**File:** `components/cleaner/AICommunicationSettings.jsx`\n\n**Component Structure:**\n\n```\nAICommunicationSettings\n‚îú‚îÄ‚îÄ Header Section\n‚îÇ   ‚îú‚îÄ‚îÄ Title: \"AI Communication Automation\"\n‚îÇ   ‚îú‚îÄ‚îÄ Description: \"Configure how and when AI communicates with your clients\"\n‚îÇ   ‚îî‚îÄ‚îÄ Status Indicator: \"X automations active\"\n‚îÇ\n‚îú‚îÄ‚îÄ AI Scheduling Settings Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable AI-driven scheduling suggestions\"\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Suggest bookings up to [X] days in advance\"\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Prioritize gap-filling in my schedule\"\n‚îÇ   ‚îî‚îÄ‚îÄ Toggle: \"Notify me when clients decline suggestions\"\n‚îÇ\n‚îú‚îÄ‚îÄ Booking Confirmation Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable booking confirmation messages\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels (SMS, Email, In-App)\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom message template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview: Live preview with sample data\n‚îÇ\n‚îú‚îÄ‚îÄ Pre-Cleaning Reminder Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable pre-cleaning reminders\"\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Send [X] days before booking\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview\n‚îÇ\n‚îú‚îÄ‚îÄ \"On My Way\" Notification Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable 'On My Way' automation\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels (SMS, In-App only)\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Include GPS-based ETA\"\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview\n‚îÇ\n‚îú‚îÄ‚îÄ Post-Cleaning Summary Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable post-cleaning messages\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview\n‚îÇ\n‚îú‚îÄ‚îÄ Review Request Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable review requests\"\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Send [X] hours after completion\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview\n‚îÇ\n‚îú‚îÄ‚îÄ Re-engagement Campaign Card\n‚îÇ   ‚îú‚îÄ‚îÄ Toggle: \"Enable re-engagement for inactive clients\"\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Consider inactive after [X] weeks\"\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Target clients with ‚â§ [X] bookings\"\n‚îÇ   ‚îú‚îÄ‚îÄ Multi-select: Channels\n‚îÇ   ‚îú‚îÄ‚îÄ Input: \"Offer [X]% discount\"\n‚îÇ   ‚îú‚îÄ‚îÄ Textarea: Custom template\n‚îÇ   ‚îî‚îÄ‚îÄ Preview\n‚îÇ\n‚îî‚îÄ‚îÄ Footer Actions\n    ‚îú‚îÄ‚îÄ Button: \"Save All Settings\"\n    ‚îú‚îÄ‚îÄ Button: \"Reset to Defaults\"\n    ‚îî‚îÄ‚îÄ Status: \"Last saved: [timestamp]\"\n```\n\n**Template Variables Available:**\n- `{client_name}` - Client's full name\n- `{cleaner_name}` - Cleaner's full name\n- `{date}` - Booking date (formatted)\n- `{time}` - Booking time\n- `{address}` - Cleaning location\n- `{eta}` - Estimated arrival time (for \"On My Way\")\n- `{hours}` - Cleaning duration\n- `{discount_text}` - Auto-generated discount message\n- `{review_link}` - Direct link to review page\n\n**State Management:**\n- Local state for form inputs\n- Debounced auto-save (save drafts every 5 seconds)\n- Validation for required fields\n- Real-time character count for SMS (160 char limit warning)\n\n**API Integration:**\n- Load: `base44.entities.CleanerProfile.filter({ user_email })`\n- Save: `base44.entities.CleanerProfile.update(profileId, { communication_settings })`\n\n### 3.2 Integration into CleanerDashboard\n**File:** `pages/CleanerDashboard.jsx`\n\n**Changes Required:**\n1. Add new navigation link: \"AI Communication Settings\"\n2. Add quick stats card showing:\n   - Number of active automations\n   - Messages sent this week\n   - Automation effectiveness (open rates, response rates)\n3. Add \"Quick Setup\" prompt for cleaners who haven't configured settings\n\n---\n\n## Phase 4: Automated Client Communication Implementation\n\n### 4.1 Booking Confirmation Automation\n**File:** `functions/automations/sendBookingConfirmation.js`\n\n**Trigger:** After booking status changes to \"scheduled\"\n\n**Logic:**\n1. Fetch cleaner's `communication_settings.booking_confirmation`\n2. If enabled, prepare message using template\n3. Replace template variables with booking data\n4. Send via configured channels:\n   - SMS: Call `sendSMS` function\n   - Email: Call `base44.integrations.Core.SendEmail`\n   - In-App: Create `Message` entity in booking's `ConversationThread`\n5. Log delivery status in `MessageDeliveryLog` entity\n\n### 4.2 Pre-Cleaning Reminder Automation\n**File:** `functions/cronAutomations.js` (extend existing)\n\n**Cron Schedule:** Run daily at 8 AM\n\n**Logic:**\n1. Query all bookings with status \"scheduled\" and date within cleaner's configured reminder window\n2. For each booking:\n   - Fetch cleaner's `communication_settings.pre_cleaning_reminder`\n   - If enabled and not already sent:\n     - Prepare message using template\n     - Send via configured channels\n     - Mark reminder as sent in booking metadata\n\n### 4.3 \"On My Way\" Trigger\n**File:** `components/jobs/OnMyWayButton.jsx` (new component)\n\n**Placement:** In cleaner's job detail view / daily schedule\n\n**UI:**\n- Prominent button: \"I'm On My Way\"\n- Shows if enabled in settings\n- Displays ETA if GPS tracking enabled\n\n**Logic:**\n1. When clicked, call `functions/sendOnMyWay.js`\n2. Function fetches cleaner location (if permission granted)\n3. Calculate ETA using Google Maps API or simple distance calculation\n4. Fetch `communication_settings.on_my_way`\n5. Send message via configured channels\n6. Update booking status to \"on_the_way\"\n\n### 4.4 Post-Cleaning Summary Automation\n**File:** `functions/automations/sendPostCleaningSummary.js`\n\n**Trigger:** After booking status changes to \"completed\" (cleaner checks out)\n\n**Logic:**\n1. Fetch cleaner's `communication_settings.post_cleaning_summary`\n2. If enabled, prepare message\n3. Optionally include:\n   - Photos uploaded\n   - Time spent\n   - Areas cleaned\n4. Send via configured channels\n\n### 4.5 Review Request Automation\n**File:** `functions/cronAutomations.js` (extend)\n\n**Cron Schedule:** Run every hour\n\n**Logic:**\n1. Query completed bookings within review request window\n2. Filter where review not yet submitted\n3. Check if enough time has passed (per cleaner's hours_after_completion setting)\n4. Send review request via configured channels\n5. Include direct link to review form\n6. Mark as sent to avoid duplicates\n\n### 4.6 Re-engagement Campaign Automation\n**File:** `functions/cronReengagement.js` (new cron)\n\n**Cron Schedule:** Run weekly (e.g., Monday 9 AM)\n\n**Logic:**\n1. For each cleaner with `communication_settings.reengagement.enabled`:\n   - Query their past clients\n   - Identify inactive clients (no booking in X weeks)\n   - Filter clients with ‚â§ X total bookings\n2. For each identified client:\n   - Check if already sent re-engagement in last 30 days (avoid spam)\n   - Generate personalized message using AI if desired:\n     - Use `base44.integrations.Core.InvokeLLM`\n     - Prompt: \"Write a friendly re-engagement message for {client_name} who last booked {weeks_ago} weeks ago. Cleaner's specialty is {specialty}. {discount_text}\"\n   - Or use cleaner's custom template\n   - Send via configured channels\n3. Log campaign in `EmailCampaign` entity for tracking\n\n### 4.7 Communication Service Layer\n**File:** `components/ai/CommunicationService.js` (helper)\n\n**Purpose:** Centralized service for all automated messaging\n\n**Functions:**\n```javascript\nclass CommunicationService {\n  static async sendMessage({\n    cleaner_email,\n    client_email,\n    message_type, // \"booking_confirmation\", \"reminder\", etc.\n    booking_id,\n    custom_data // Variables for template replacement\n  }) {\n    // 1. Fetch cleaner's communication settings\n    // 2. Check if message type is enabled\n    // 3. Get channels and template\n    // 4. Replace template variables\n    // 5. Send via all enabled channels\n    // 6. Log delivery\n    // 7. Return delivery status\n  }\n\n  static replaceVariables(template, data) {\n    // Replace all {variable} placeholders\n  }\n\n  static async sendViaSMS(to, message) {\n    // Call sendSMS function\n  }\n\n  static async sendViaEmail(to, subject, body) {\n    // Call Core.SendEmail\n  }\n\n  static async sendViaInApp(thread_id, message) {\n    // Create Message entity\n  }\n\n  static async logDelivery(message_type, channels, status) {\n    // Create MessageDeliveryLog\n  }\n}\n```\n\n---\n\n## Phase 5: Client-Facing UI\n\n### 5.1 Booking Flow with AI Suggestions\n**File:** `pages/SmartBooking.jsx` (new page)\n\n**Flow:**\n1. Client enters booking preferences:\n   - Address (with autocomplete)\n   - Entry instructions\n   - Cleaning type (basic/deep/moveout)\n   - Preferred dates (select 3-5 dates)\n   - Estimated home size\n2. Client selects a cleaner or uses smart matching\n3. System calls `suggestBookingSlots` function\n4. Display AI-suggested slots:\n   - Show 3-5 optimal time slots\n   - Each with reasoning (\"Fills gap in schedule\", \"Matches your preferred time\", etc.)\n   - Visual calendar preview\n5. Client interaction buttons:\n   - \"Select This Time\" for each slot\n   - \"Show More Times\" (triggers new AI suggestion)\n   - \"I'm Not Interested Right Now\" (exits flow gracefully)\n6. Upon selection:\n   - Confirm booking details\n   - Show \"Waiting for cleaner approval\" message\n   - Estimated response time: 24 hours\n\n### 5.2 Interactive Message Responses in ChatThread\n**File:** `pages/ChatThread.jsx` (enhance existing)\n\n**Enhancement:**\n- Detect AI-generated messages with action buttons\n- Render interactive elements:\n  - \"Select Slot A\" button\n  - \"Select Slot B\" button\n  - \"Suggest Other Times\" button\n  - \"Not Interested\" button\n- When clicked, call `processClientBookingResponse` with appropriate parameters\n- Show loading state while processing\n- Update UI with confirmation or next steps\n\n### 5.3 Cleaner Approval Interface\n**File:** `pages/BookingApprovalPage.jsx` (new page)\n\n**UI Components:**\n1. Booking Details Card:\n   - Client name and photo\n   - Address with map preview\n   - Entry instructions (prominently displayed)\n   - Date and time\n   - Estimated duration\n   - Cleaning type and special requests\n2. Cleaner's Schedule Context:\n   - Show bookings before and after\n   - Highlight if this fills a gap\n   - Calculate travel time from previous booking\n3. Decision Buttons:\n   - \"Approve Booking\" (green, primary)\n   - \"Decline\" (with reason dropdown)\n   - \"Not Interested in This Type\" (with feedback form)\n4. Quick Actions:\n   - \"View Client Profile\"\n   - \"Message Client\"\n   - \"Suggest Different Time\" (opens counter-proposal)\n\n---\n\n## Phase 6: Testing & Quality Assurance\n\n### 6.1 Unit Testing\n**Test Cases:**\n1. SMS sending function with various inputs\n2. Template variable replacement accuracy\n3. AI slot suggestion logic (mock LLM responses)\n4. Booking approval/decline workflows\n5. Cron job logic (date/time calculations)\n\n### 6.2 Integration Testing\n**Test Scenarios:**\n1. End-to-end booking flow:\n   - Client requests ‚Üí AI suggests ‚Üí Client selects ‚Üí Cleaner approves ‚Üí Confirmations sent\n2. Communication automation triggers:\n   - Booking confirmed ‚Üí Confirmation sent via all channels\n   - 24 hours before ‚Üí Reminder sent\n   - Cleaner clicks \"On My Way\" ‚Üí Client receives notification\n   - Job completed ‚Üí Thank you + Review request sent\n3. Re-engagement campaign:\n   - Mark test client as inactive ‚Üí Run cron ‚Üí Verify message sent\n\n### 6.3 User Acceptance Testing\n**Cleaner Testing:**\n1. Configure communication settings\n2. Receive and approve/decline booking requests\n3. Trigger \"On My Way\" notification\n4. Review message delivery logs\n\n**Client Testing:**\n1. Initiate smart booking\n2. Interact with AI suggestions\n3. Receive automated messages via SMS, email, in-app\n4. Respond to review requests\n\n### 6.4 Load Testing\n- Test SMS sending rate limits\n- Test AI LLM response times under load\n- Test cron jobs with large booking volumes\n\n---\n\n## Phase 7: Deployment & Monitoring\n\n### 7.1 Deployment Checklist\n- [ ] All backend functions deployed\n- [ ] Twilio credentials verified in production\n- [ ] Cron jobs scheduled and active\n- [ ] Entity schema updates applied\n- [ ] UI components deployed\n- [ ] Analytics tracking implemented\n\n### 7.2 Monitoring\n**Metrics to Track:**\n1. **Communication Delivery Rates:**\n   - SMS delivery success rate\n   - Email open rates\n   - In-app message read rates\n2. **AI Performance:**\n   - Slot suggestion acceptance rate\n   - Cleaner approval rate for AI-suggested bookings\n   - Time to booking confirmation\n3. **Automation Effectiveness:**\n   - Re-engagement campaign conversion rate\n   - Review request response rate\n   - \"On My Way\" notification usage\n4. **System Health:**\n   - Function execution times\n   - Error rates per function\n   - Cron job success rates\n\n### 7.3 Alerts & Notifications\n**Set Up Alerts For:**\n- SMS sending failures (Twilio errors)\n- AI LLM response errors or timeouts\n- Cron job failures\n- Unusual spike in \"not interested\" responses\n- Low cleaner approval rates (may indicate AI suggesting poor times)\n\n---\n\n## Phase 8: Iteration & Optimization\n\n### 8.1 Data Collection\n- Track which message templates get best responses\n- Analyze optimal timing for reminders and re-engagement\n- Measure AI suggestion accuracy over time\n\n### 8.2 AI Prompt Refinement\n- Improve slot suggestion prompts based on feedback\n- Add learning from cleaner approval patterns\n- Incorporate seasonal and regional booking trends\n\n### 8.3 Feature Enhancements\n**Future Additions:**\n- Multi-language support for templates\n- A/B testing for message templates\n- Predictive analytics for best booking times\n- Voice message option (via Twilio)\n- WhatsApp integration\n- Client preference learning (AI remembers what times clients prefer)\n\n---\n\n## Implementation Timeline\n\n**Week 1-2: Phase 2 (AI Core Logic)**\n- Build 3 backend functions\n- Test with mock data\n- Integrate with existing booking system\n\n**Week 3: Phase 3 (Cleaner UI)**\n- Build AICommunicationSettings component\n- Integrate into CleanerDashboard\n- Internal testing with cleaner accounts\n\n**Week 4-5: Phase 4 (Automation Implementation)**\n- Build all automation functions\n- Set up cron jobs\n- Implement CommunicationService helper\n- End-to-end testing\n\n**Week 6: Phase 5 (Client UI)**\n- Build SmartBooking page\n- Enhance ChatThread with interactive buttons\n- Build BookingApprovalPage\n- Client-side testing\n\n**Week 7: Phase 6 (QA)**\n- Comprehensive testing\n- Bug fixes\n- Performance optimization\n\n**Week 8: Phase 7-8 (Deploy & Monitor)**\n- Production deployment\n- Monitoring setup\n- Initial feedback collection\n- Quick iterations\n\n---\n\n## Success Criteria\n\n**For Cleaners:**\n- ‚úÖ 80%+ of cleaners configure at least 3 automations\n- ‚úÖ 50% reduction in manual client communication time\n- ‚úÖ Approval rate for AI-suggested bookings > 70%\n\n**For Clients:**\n- ‚úÖ 90%+ satisfaction with communication timeliness\n- ‚úÖ 60%+ response rate to review requests\n- ‚úÖ 40%+ booking rate for AI-suggested slots\n\n**For Platform:**\n- ‚úÖ 99.5%+ message delivery success rate\n- ‚úÖ < 2 second response time for AI slot suggestions\n- ‚úÖ Zero critical bugs in production after week 2\n\n---\n\n## Risk Mitigation\n\n**Risk 1: SMS Costs Spiral**\n- **Mitigation:** Set per-cleaner monthly SMS limits\n- **Mitigation:** Provide SMS cost estimates in settings\n- **Mitigation:** Encourage email/in-app as primary channels\n\n**Risk 2: AI Suggests Poor Time Slots**\n- **Mitigation:** Allow cleaners to provide feedback on suggestions\n- **Mitigation:** Implement approval rate monitoring per cleaner\n- **Mitigation:** Fallback to manual slot selection if AI performs poorly\n\n**Risk 3: Client Spam Complaints**\n- **Mitigation:** Respect quiet hours (no messages 9 PM - 8 AM)\n- **Mitigation:** Include \"opt-out\" link in all automated messages\n- **Mitigation:** Limit re-engagement frequency (max once per month)\n\n**Risk 4: Template Customization Leads to Unprofessional Messages**\n- **Mitigation:** Provide \"professional tone\" checker using AI\n- **Mitigation:** Show examples and best practices\n- **Mitigation:** Admin review of extreme outliers\n\n---\n\n## Appendix: Technical Dependencies\n\n**External Services:**\n- Twilio (SMS)\n- Base44 Core.SendEmail (Email)\n- Base44 Core.InvokeLLM (AI suggestions and personalization)\n\n**Entities Required:**\n- CleanerProfile (with communication_settings)\n- ClientProfile\n- Booking\n- Message\n- ConversationThread\n- Notification\n- MessageDeliveryLog (new - for tracking)\n- EmailCampaign (existing, for re-engagement tracking)\n\n**Backend Functions:**\n- sendSMS.js ‚úÖ\n- suggestBookingSlots.js\n- processClientBookingResponse.js\n- cleanerBookingApproval.js\n- sendBookingConfirmation.js\n- sendOnMyWay.js\n- sendPostCleaningSummary.js\n- cronReengagement.js\n- + Updates to existing cronAutomations.js\n\n**Frontend Components:**\n- AICommunicationSettings.jsx\n- OnMyWayButton.jsx\n- SmartBooking.jsx (new page)\n- BookingApprovalPage.jsx (new page)\n- + Updates to CleanerDashboard.jsx, ChatThread.jsx\n\n---\n\n**Document Version:** 1.0  \n**Last Updated:** 2025-12-30  \n**Next Review:** After Phase 2 completion","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\AutomatedJobReminders.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":8,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"fix":{"range":[356,363],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[355,362],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'FileText' is defined but never used.","line":8,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":48,"fix":{"range":[387,397],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[386,396],"text":""},"desc":"Remove unused variable 'FileText'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addHours' is defined but never used.","line":11,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":36,"fix":{"range":[490,500],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addHours"},"fix":{"range":[489,499],"text":""},"desc":"Remove unused variable 'addHours'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isBefore' is defined but never used.","line":11,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":46,"fix":{"range":[500,510],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isBefore"},"fix":{"range":[499,509],"text":""},"desc":"Remove unused variable 'isBefore'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  Bell, Clock, Calendar, MapPin, User, FileText, \n  CheckCircle, Send, Loader2, AlertCircle\n} from 'lucide-react';\nimport { format, parseISO, addHours, isBefore, isToday, isTomorrow } from 'date-fns';\n\nexport default function AutomatedJobReminders() {\n  const [upcomingJobs, setUpcomingJobs] = useState([]);\n  const [reminders, setReminders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [sendingId, setSendingId] = useState(null);\n\n  useEffect(() => {\n    loadUpcomingJobs();\n    const interval = setInterval(checkAndSendReminders, 60000); // Check every minute\n    return () => clearInterval(interval);\n  }, []);\n\n  const loadUpcomingJobs = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Get bookings for next 48 hours\n      const twoDaysFromNow = new Date(Date.now() + 48 * 60 * 60 * 1000);\n      const tomorrow = format(twoDaysFromNow, 'yyyy-MM-dd');\n\n      const bookings = await base44.entities.Booking.filter({\n        cleaner_email: currentUser.email,\n        status: { $in: ['accepted', 'scheduled'] },\n        date: { $lte: tomorrow }\n      });\n\n      // Sort by date/time\n      const sorted = bookings.sort((a, b) => {\n        const dateA = new Date(`${a.date}T${a.start_time}`);\n        const dateB = new Date(`${b.date}T${b.start_time}`);\n        return dateA - dateB;\n      });\n\n      setUpcomingJobs(sorted);\n\n      // Load existing reminders sent\n      const sentReminders = await base44.entities.Message.filter({\n        sender_email: currentUser.email,\n        type: 'ai_message',\n        content: { $regex: 'reminder' }\n      });\n\n      setReminders(sentReminders);\n\n    } catch (error) {\n      console.error('Error loading upcoming jobs:', error);\n    }\n    setLoading(false);\n  };\n\n  const checkAndSendReminders = async () => {\n    for (const job of upcomingJobs) {\n      const jobDateTime = new Date(`${job.date}T${job.start_time || '09:00'}`);\n      const timeUntilJob = jobDateTime - new Date();\n      const hoursUntil = timeUntilJob / (1000 * 60 * 60);\n\n      // Send reminder 24 hours before if not already sent\n      if (hoursUntil <= 24 && hoursUntil > 23 && !hasReminderBeenSent(job.id, '24h')) {\n        await sendAutomatedReminder(job, '24h');\n      }\n\n      // Send reminder 2 hours before if not already sent\n      if (hoursUntil <= 2 && hoursUntil > 1.5 && !hasReminderBeenSent(job.id, '2h')) {\n        await sendAutomatedReminder(job, '2h');\n      }\n    }\n  };\n\n  const hasReminderBeenSent = (bookingId, reminderType) => {\n    return reminders.some(r => \n      r.content.includes(bookingId) && r.content.includes(reminderType)\n    );\n  };\n\n  const sendAutomatedReminder = async (job, reminderType) => {\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Get client profile for special notes\n      const clientProfiles = await base44.entities.ClientProfile.filter({\n        user_email: job.client_email\n      });\n\n      const clientNotes = clientProfiles[0]?.special_requests || '';\n      const parkingInfo = job.parking_instructions || clientProfiles[0]?.default_parking_instructions || '';\n      const entryInfo = job.entry_instructions || clientProfiles[0]?.default_entry_instructions || '';\n      const petInfo = job.has_pets ? (job.pet_details || 'Client has pets') : '';\n\n      // Create reminder message\n      let message = '';\n      if (reminderType === '24h') {\n        message = `üîî Reminder: You have a cleaning job tomorrow!\\n\\n`;\n      } else {\n        message = `‚è∞ Heads up: Your cleaning job starts in 2 hours!\\n\\n`;\n      }\n\n      message += `üìÖ ${format(parseISO(job.date), 'EEEE, MMMM d, yyyy')}\\n`;\n      message += `üïê ${job.start_time} (${job.hours} hours)\\n`;\n      message += `üìç ${job.address}\\n\\n`;\n\n      if (parkingInfo) {\n        message += `üöó Parking: ${parkingInfo}\\n`;\n      }\n      if (entryInfo) {\n        message += `üîë Entry: ${entryInfo}\\n`;\n      }\n      if (petInfo) {\n        message += `üêæ Pets: ${petInfo}\\n`;\n      }\n      if (clientNotes) {\n        message += `üìù Notes: ${clientNotes}\\n`;\n      }\n\n      message += `\\n‚ú® Remember to take before/after photos and check in when you arrive!`;\n\n      // Save as AI message\n      const reminderMsg = await base44.entities.Message.create({\n        sender_email: currentUser.email,\n        content: message,\n        type: 'ai_message',\n        timestamp: new Date().toISOString(),\n        metadata: {\n          booking_id: job.id,\n          reminder_type: reminderType,\n          automated: true\n        }\n      });\n\n      // Add to reminders list\n      setReminders(prev => [...prev, reminderMsg]);\n\n      return true;\n    } catch (error) {\n      console.error('Error sending automated reminder:', error);\n      return false;\n    }\n  };\n\n  const sendManualReminder = async (job) => {\n    setSendingId(job.id);\n    await sendAutomatedReminder(job, 'manual');\n    await loadUpcomingJobs();\n    setSendingId(null);\n  };\n\n  const getTimeUntilJob = (job) => {\n    const jobDateTime = new Date(`${job.date}T${job.start_time || '09:00'}`);\n    const now = new Date();\n    const diff = jobDateTime - now;\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n    if (hours < 0) return 'Past';\n    if (hours === 0) return `${minutes}m`;\n    if (hours < 24) return `${hours}h ${minutes}m`;\n    return `${Math.floor(hours / 24)}d ${hours % 24}h`;\n  };\n\n  const getJobTimeLabel = (job) => {\n    const jobDate = parseISO(job.date);\n    if (isToday(jobDate)) return 'Today';\n    if (isTomorrow(jobDate)) return 'Tomorrow';\n    return format(jobDate, 'MMM d');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  if (upcomingJobs.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"p-8 text-center\">\n          <Calendar className=\"w-12 h-12 text-slate-300 mx-auto mb-3\" />\n          <p className=\"text-slate-600 font-fredoka\">No upcoming jobs in the next 48 hours</p>\n          <p className=\"text-sm text-slate-500 font-verdana mt-1\">\n            Job reminders will appear here automatically\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Alert className=\"bg-gradient-to-r from-amber-50 to-orange-50 border-amber-200\">\n        <Bell className=\"w-4 h-4 text-amber-600\" />\n        <AlertDescription className=\"font-verdana\">\n          Automated reminders will be sent 24 hours and 2 hours before each job with all client-specific details\n        </AlertDescription>\n      </Alert>\n\n      {upcomingJobs.map((job) => {\n        const timeUntil = getTimeUntilJob(job);\n        const timeLabel = getJobTimeLabel(job);\n        const reminderSent24h = hasReminderBeenSent(job.id, '24h');\n        const reminderSent2h = hasReminderBeenSent(job.id, '2h');\n\n        return (\n          <Card key={job.id} className=\"border-2\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-start justify-between\">\n                <div>\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    <Badge className=\"bg-puretask-blue text-white\">\n                      {timeLabel}\n                    </Badge>\n                    <span className=\"text-sm font-verdana text-slate-600\">\n                      in {timeUntil}\n                    </span>\n                  </div>\n                  <CardTitle className=\"text-lg font-fredoka\">\n                    {job.hours}-Hour Cleaning\n                  </CardTitle>\n                </div>\n                <div className=\"flex gap-1\">\n                  {reminderSent24h && (\n                    <Badge variant=\"outline\" className=\"text-xs text-green-700 border-green-300\">\n                      <CheckCircle className=\"w-3 h-3 mr-1\" />\n                      24h\n                    </Badge>\n                  )}\n                  {reminderSent2h && (\n                    <Badge variant=\"outline\" className=\"text-xs text-green-700 border-green-300\">\n                      <CheckCircle className=\"w-3 h-3 mr-1\" />\n                      2h\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2 mb-4\">\n                <div className=\"flex items-start gap-2 text-sm\">\n                  <Calendar className=\"w-4 h-4 text-slate-500 mt-0.5\" />\n                  <span className=\"font-verdana\">\n                    {format(parseISO(job.date), 'EEEE, MMMM d, yyyy')} at {job.start_time}\n                  </span>\n                </div>\n                <div className=\"flex items-start gap-2 text-sm\">\n                  <MapPin className=\"w-4 h-4 text-slate-500 mt-0.5\" />\n                  <span className=\"font-verdana\">{job.address}</span>\n                </div>\n                <div className=\"flex items-start gap-2 text-sm\">\n                  <User className=\"w-4 h-4 text-slate-500 mt-0.5\" />\n                  <span className=\"font-verdana\">{job.client_email}</span>\n                </div>\n              </div>\n\n              {(job.parking_instructions || job.entry_instructions || job.has_pets) && (\n                <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-3\">\n                  <div className=\"flex items-start gap-2 mb-1\">\n                    <AlertCircle className=\"w-4 h-4 text-amber-600 mt-0.5\" />\n                    <span className=\"text-sm font-fredoka font-semibold text-amber-900\">\n                      Important Details:\n                    </span>\n                  </div>\n                  <div className=\"text-sm text-slate-700 font-verdana space-y-1 ml-6\">\n                    {job.parking_instructions && <p>üöó {job.parking_instructions}</p>}\n                    {job.entry_instructions && <p>üîë {job.entry_instructions}</p>}\n                    {job.has_pets && <p>üêæ {job.pet_details || 'Client has pets'}</p>}\n                  </div>\n                </div>\n              )}\n\n              <Button\n                onClick={() => sendManualReminder(job)}\n                disabled={sendingId === job.id}\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"w-full\"\n              >\n                {sendingId === job.id ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    Sending Reminder...\n                  </>\n                ) : (\n                  <>\n                    <Send className=\"w-4 h-4 mr-2\" />\n                    Send Reminder Now\n                  </>\n                )}\n              </Button>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\CleanerAIChatAssistant.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":6,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// CleanerAIChatAssistant - AI Chat Interface for Cleaners\r\n// Context-aware chat assistant integrated into job workflow\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { aiCleanerChatService, ChatMessage, CleanerContext } from '@/services/aiCleanerChatService';\r\nimport type { JobRecord } from '@/types/cleanerJobTypes';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Bot, Send, Loader2, Sparkles, TrendingUp, HelpCircle, Zap, X } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { toast } from 'sonner';\r\n\r\ninterface CleanerAIChatAssistantProps {\r\n  currentJob?: JobRecord;\r\n  cleanerId: string;\r\n  cleanerEmail: string;\r\n  stats?: {\r\n    totalJobs: number;\r\n    reliabilityScore: number;\r\n    avgRating: number;\r\n    totalEarnings: number;\r\n  };\r\n  minimized?: boolean;\r\n  onMinimize?: () => void;\r\n}\r\n\r\nexport default function CleanerAIChatAssistant({\r\n  currentJob,\r\n  cleanerId,\r\n  cleanerEmail,\r\n  stats,\r\n  minimized = false,\r\n  onMinimize\r\n}: CleanerAIChatAssistantProps) {\r\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\r\n  const [input, setInput] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [showQuickActions, setShowQuickActions] = useState(true);\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  \r\n  const context: CleanerContext = {\r\n    cleanerId,\r\n    cleanerEmail,\r\n    currentJob,\r\n    stats\r\n  };\r\n\r\n  // Auto-scroll to bottom when new messages arrive\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  // Welcome message on mount\r\n  useEffect(() => {\r\n    if (messages.length === 0) {\r\n      const welcomeMessage: ChatMessage = {\r\n        id: Date.now().toString(),\r\n        role: 'assistant',\r\n        content: currentJob \r\n          ? `üëã Hi! I'm here to help you with this ${currentJob.cleaning_type} cleaning job. Ask me anything or use the quick actions below!`\r\n          : `üëã Hi! I'm your PureTask AI Assistant. How can I help you today?`,\r\n        timestamp: new Date()\r\n      };\r\n      setMessages([welcomeMessage]);\r\n    }\r\n  }, []);\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!input.trim() || loading) return;\r\n\r\n    const userMessage: ChatMessage = {\r\n      id: Date.now().toString(),\r\n      role: 'user',\r\n      content: input,\r\n      timestamp: new Date()\r\n    };\r\n\r\n    setMessages(prev => [...prev, userMessage]);\r\n    setInput('');\r\n    setLoading(true);\r\n    setShowQuickActions(false);\r\n\r\n    try {\r\n      const response = await aiCleanerChatService.chat([...messages, userMessage], context);\r\n      \r\n      const assistantMessage: ChatMessage = {\r\n        id: (Date.now() + 1).toString(),\r\n        role: 'assistant',\r\n        content: response,\r\n        timestamp: new Date()\r\n      };\r\n      \r\n      setMessages(prev => [...prev, assistantMessage]);\r\n    } catch (error) {\r\n      toast.error('Failed to get AI response');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleQuickAction = (question: string) => {\r\n    setInput(question);\r\n    setShowQuickActions(false);\r\n    // Auto-send after a brief delay\r\n    setTimeout(() => {\r\n      handleSendMessage();\r\n    }, 100);\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const quickActions = aiCleanerChatService.getQuickActions(currentJob);\r\n\r\n  // Minimized view\r\n  if (minimized) {\r\n    return (\r\n      <motion.div\r\n        initial={{ scale: 0 }}\r\n        animate={{ scale: 1 }}\r\n        className=\"fixed bottom-4 right-4 z-50\"\r\n      >\r\n        <Button\r\n          onClick={onMinimize}\r\n          size=\"lg\"\r\n          className=\"rounded-full w-16 h-16 bg-info hover:bg-info/90 shadow-lg\"\r\n        >\r\n          <Bot className=\"w-8 h-8\" />\r\n        </Button>\r\n        {messages.length > 1 && (\r\n          <Badge className=\"absolute -top-2 -right-2 bg-error text-white\">\r\n            {messages.length - 1}\r\n          </Badge>\r\n        )}\r\n      </motion.div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className=\"border-info-border shadow-lg\">\r\n      <CardHeader className=\"bg-gradient-to-r from-info to-info/80 text-white\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Bot className=\"w-6 h-6\" />\r\n            <CardTitle className=\"font-heading text-lg\">AI Assistant</CardTitle>\r\n            {currentJob && (\r\n              <Badge variant=\"secondary\" className=\"ml-2\">\r\n                Job #{currentJob.id.slice(0, 8)}\r\n              </Badge>\r\n            )}\r\n          </div>\r\n          {onMinimize && (\r\n            <Button\r\n              onClick={onMinimize}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"text-white hover:bg-white/20\"\r\n            >\r\n              <X className=\"w-4 h-4\" />\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"p-0\">\r\n        {/* Messages Area */}\r\n        <div className=\"h-[400px] overflow-y-auto p-4 space-y-4 bg-gray-50\">\r\n          <AnimatePresence>\r\n            {messages.map((message) => (\r\n              <motion.div\r\n                key={message.id}\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0 }}\r\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\r\n              >\r\n                <div\r\n                  className={`max-w-[80%] rounded-lg p-3 ${\r\n                    message.role === 'user'\r\n                      ? 'bg-info text-white font-body'\r\n                      : 'bg-white border border-gray-200 font-body text-gray-800'\r\n                  }`}\r\n                >\r\n                  {message.role === 'assistant' && (\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <Bot className=\"w-4 h-4 text-info\" />\r\n                      <span className=\"text-xs font-heading font-semibold text-info\">\r\n                        PureTask AI\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  <p className=\"whitespace-pre-wrap\">{message.content}</p>\r\n                  <span className=\"text-xs opacity-70 mt-1 block\">\r\n                    {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\r\n                  </span>\r\n                </div>\r\n              </motion.div>\r\n            ))}\r\n          </AnimatePresence>\r\n\r\n          {loading && (\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              className=\"flex justify-start\"\r\n            >\r\n              <div className=\"bg-white border border-gray-200 rounded-lg p-3 flex items-center gap-2\">\r\n                <Loader2 className=\"w-4 h-4 animate-spin text-info\" />\r\n                <span className=\"text-sm font-body text-gray-600\">AI is thinking...</span>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          <div ref={messagesEndRef} />\r\n        </div>\r\n\r\n        {/* Quick Actions */}\r\n        {showQuickActions && messages.length <= 1 && (\r\n          <div className=\"p-4 bg-white border-t border-gray-200\">\r\n            <p className=\"text-sm font-heading font-semibold text-gray-700 mb-2\">\r\n              Quick Actions:\r\n            </p>\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              {quickActions.map((action, index) => (\r\n                <Button\r\n                  key={index}\r\n                  onClick={() => handleQuickAction(action.question)}\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  className=\"justify-start text-left h-auto py-2 px-3 font-body\"\r\n                >\r\n                  <span className=\"text-xs\">{action.label}</span>\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Input Area */}\r\n        <div className=\"p-4 bg-white border-t border-gray-200\">\r\n          <div className=\"flex gap-2\">\r\n            <input\r\n              type=\"text\"\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              onKeyPress={handleKeyPress}\r\n              placeholder=\"Ask me anything...\"\r\n              disabled={loading}\r\n              className=\"flex-1 border border-gray-300 rounded-lg px-4 py-2 font-body focus:outline-none focus:ring-2 focus:ring-info\"\r\n            />\r\n            <Button\r\n              onClick={handleSendMessage}\r\n              disabled={!input.trim() || loading}\r\n              className=\"bg-info hover:bg-info/90 text-white font-heading\"\r\n            >\r\n              {loading ? (\r\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n              ) : (\r\n                <Send className=\"w-5 h-5\" />\r\n              )}\r\n            </Button>\r\n          </div>\r\n          \r\n          {!showQuickActions && (\r\n            <Button\r\n              onClick={() => setShowQuickActions(true)}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"mt-2 text-xs font-body\"\r\n            >\r\n              <Sparkles className=\"w-3 h-3 mr-1\" />\r\n              Show quick actions\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// Floating AI Assistant Button (for when not embedded)\r\nexport function FloatingAIAssistant({\r\n  currentJob,\r\n  cleanerId,\r\n  cleanerEmail,\r\n  stats\r\n}: CleanerAIChatAssistantProps) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <AnimatePresence>\r\n        {isOpen && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 20, scale: 0.9 }}\r\n            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n            exit={{ opacity: 0, y: 20, scale: 0.9 }}\r\n            className=\"fixed bottom-24 right-4 z-50 w-96\"\r\n          >\r\n            <CleanerAIChatAssistant\r\n              currentJob={currentJob}\r\n              cleanerId={cleanerId}\r\n              cleanerEmail={cleanerEmail}\r\n              stats={stats}\r\n              minimized={false}\r\n              onMinimize={() => setIsOpen(false)}\r\n            />\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n\r\n      <CleanerAIChatAssistant\r\n        currentJob={currentJob}\r\n        cleanerId={cleanerId}\r\n        cleanerEmail={cleanerEmail}\r\n        stats={stats}\r\n        minimized={!isOpen}\r\n        onMinimize={() => setIsOpen(!isOpen)}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\CleanerAssistantWidget.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'recommendation' is defined but never used. Allowed unused args must match /^_/u.","line":110,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":110,"endColumn":55,"suggestions":[{"messageId":"removeVar","data":{"varName":"recommendation"},"fix":{"range":[3854,3870],"text":""},"desc":"Remove unused variable 'recommendation'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Calendar, DollarSign, MapPin, Clock, Check, X, Loader2 } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { toast } from 'sonner';\n\nexport default function CleanerAssistantWidget({ cleanerEmail }) {\n  const [pendingRequests, setPendingRequests] = useState([]);\n  const [recommendations, setRecommendations] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [processing, setProcessing] = useState(null);\n\n  useEffect(() => {\n    loadPendingRequests();\n  }, [cleanerEmail]);\n\n  const loadPendingRequests = async () => {\n    try {\n      // Get pending booking requests\n      const requests = await base44.entities.Booking.filter({\n        cleaner_email: cleanerEmail,\n        status: { $in: ['awaiting_cleaner_response', 'checking_fallback'] },\n        request_expires_at: { $gt: new Date().toISOString() }\n      });\n\n      setPendingRequests(requests);\n\n      // Get AI recommendations for each request\n      if (requests.length > 0) {\n        await getAIRecommendations(requests);\n      }\n    } catch (error) {\n      console.error('Error loading requests:', error);\n    }\n    setLoading(false);\n  };\n\n  const getAIRecommendations = async (requests) => {\n    try {\n      // Get cleaner profile and existing bookings for context\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n      const profile = profiles[0];\n\n      const existingBookings = await base44.entities.Booking.filter({\n        cleaner_email: cleanerEmail,\n        status: { $in: ['scheduled', 'accepted'] }\n      });\n\n      const prompt = `You are a scheduling assistant for a cleaner. Analyze these booking requests and provide recommendations.\n\nCLEANER INFO:\n- Name: ${profile.full_name}\n- Tier: ${profile.tier}\n- Base Rate: ${profile.base_rate_credits_per_hour} credits/hour\n- Preferred Services: ${profile.specialty_tags?.join(', ') || 'General cleaning'}\n\nEXISTING SCHEDULE:\n${existingBookings.map(b => `${b.date} ${b.start_time} - ${b.hours}h at ${b.address.split(',')[0]}`).join('\\n')}\n\nPENDING REQUESTS:\n${requests.map((b, i) => `Request ${i + 1}: ${b.date} ${b.start_time} - ${b.hours}h, ${b.cleaning_type}, ${(b.total_price * 0.8 / 100).toFixed(2)} earnings, Location: ${b.address.split(',')[0]}`).join('\\n')}\n\nFor EACH request, provide:\n1. recommendation: \"accept\" or \"decline\" or \"reschedule\"\n2. reason: Brief explanation (schedule fit, earnings, location)\n3. suggested_time: If reschedule, suggest better time\n4. priority: \"high\", \"medium\", or \"low\"\n\nReturn ONLY valid JSON array:\n[\n  {\n    \"request_index\": 0,\n    \"recommendation\": \"accept\",\n    \"reason\": \"Fits perfectly between morning jobs, great earnings\",\n    \"priority\": \"high\"\n  }\n]`;\n\n      const response = await base44.integrations.Core.InvokeLLM({\n        prompt: prompt,\n        response_json_schema: {\n          type: \"object\",\n          properties: {\n            recommendations: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  request_index: { type: \"number\" },\n                  recommendation: { type: \"string\" },\n                  reason: { type: \"string\" },\n                  suggested_time: { type: \"string\" },\n                  priority: { type: \"string\" }\n                }\n              }\n            }\n          }\n        }\n      });\n\n      setRecommendations(response.recommendations || []);\n    } catch (error) {\n      console.error('Error getting AI recommendations:', error);\n    }\n  };\n\n  const handleApprove = async (booking, recommendation) => {\n    setProcessing(booking.id);\n    try {\n      // Accept the booking\n      await base44.entities.Booking.update(booking.id, {\n        status: 'accepted',\n        cleaner_confirmed: true,\n        request_status: 'accepted'\n      });\n\n      // Send notification\n      await base44.entities.Notification.create({\n        recipient_email: booking.client_email,\n        type: 'booking_accepted',\n        title: '‚úì Booking Accepted!',\n        message: `Your cleaning for ${format(parseISO(booking.date), 'MMM d')} has been confirmed`,\n        link: '/ClientBookings',\n        is_read: false\n      });\n\n      toast.success('Booking accepted and added to your schedule!');\n      loadPendingRequests();\n    } catch (error) {\n      console.error('Error accepting booking:', error);\n      toast.error('Failed to accept booking');\n    }\n    setProcessing(null);\n  };\n\n  const handleDecline = async (booking) => {\n    setProcessing(booking.id);\n    try {\n      await base44.entities.Booking.update(booking.id, {\n        status: 'cleaner_declined',\n        request_status: 'declined'\n      });\n\n      toast.success('Booking declined');\n      loadPendingRequests();\n    } catch (error) {\n      console.error('Error declining booking:', error);\n      toast.error('Failed to decline booking');\n    }\n    setProcessing(null);\n  };\n\n  if (loading) {\n    return (\n      <Card>\n        <CardContent className=\"py-8\">\n          <Loader2 className=\"w-6 h-6 animate-spin mx-auto text-puretask-blue\" />\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (pendingRequests.length === 0) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"font-fredoka flex items-center gap-2\">\n            <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n            AI Assistant\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-gray-600 font-verdana\">\n            No pending requests. I'll notify you when new opportunities arrive! üéØ\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"font-fredoka flex items-center gap-2\">\n          <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n          AI Assistant - {pendingRequests.length} New Request{pendingRequests.length !== 1 ? 's' : ''}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {pendingRequests.map((booking, idx) => {\n          const recommendation = recommendations.find(r => r.request_index === idx);\n          const earnings = (booking.total_price * 0.8) / 100;\n\n          return (\n            <div\n              key={booking.id}\n              className={`p-4 rounded-lg border-2 ${\n                recommendation?.recommendation === 'accept'\n                  ? 'border-green-200 bg-green-50'\n                  : recommendation?.recommendation === 'decline'\n                  ? 'border-red-200 bg-red-50'\n                  : 'border-gray-200 bg-white'\n              }`}\n            >\n              {/* Recommendation Badge */}\n              {recommendation && (\n                <div className=\"flex items-center justify-between mb-3\">\n                  <Badge\n                    className={`${\n                      recommendation.recommendation === 'accept'\n                        ? 'bg-green-600'\n                        : recommendation.recommendation === 'decline'\n                        ? 'bg-red-600'\n                        : 'bg-amber-600'\n                    } text-white`}\n                  >\n                    <Sparkles className=\"w-3 h-3 mr-1\" />\n                    AI Suggests: {recommendation.recommendation.toUpperCase()}\n                  </Badge>\n                  <Badge variant=\"outline\" className={`text-xs ${\n                    recommendation.priority === 'high' ? 'border-red-500 text-red-700' :\n                    recommendation.priority === 'medium' ? 'border-amber-500 text-amber-700' :\n                    'border-gray-400 text-gray-600'\n                  }`}>\n                    {recommendation.priority} priority\n                  </Badge>\n                </div>\n              )}\n\n              {/* Booking Details */}\n              <div className=\"space-y-2 mb-3\">\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <Calendar className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"font-fredoka font-semibold\">\n                    {format(parseISO(booking.date), 'EEE, MMM d')} at {booking.start_time}\n                  </span>\n                  <Badge variant=\"outline\" className=\"ml-auto\">\n                    {booking.cleaning_type}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-gray-700\">\n                  <Clock className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"font-verdana\">{booking.hours} hours</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-gray-700\">\n                  <MapPin className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"font-verdana\">{booking.address.split(',')[0]}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <DollarSign className=\"w-4 h-4 text-green-600\" />\n                  <span className=\"font-fredoka font-semibold text-green-700\">\n                    ${earnings.toFixed(2)} earnings\n                  </span>\n                </div>\n              </div>\n\n              {/* AI Reasoning */}\n              {recommendation && (\n                <div className=\"p-2 bg-white/50 rounded text-xs mb-3\">\n                  <p className=\"font-verdana text-gray-700\">\n                    <span className=\"font-semibold\">AI Analysis:</span> {recommendation.reason}\n                  </p>\n                </div>\n              )}\n\n              {/* Actions */}\n              <div className=\"flex gap-2\">\n                <Button\n                  size=\"sm\"\n                  onClick={() => handleApprove(booking, recommendation)}\n                  disabled={processing === booking.id}\n                  className=\"flex-1 bg-green-600 hover:bg-green-700 text-white\"\n                >\n                  {processing === booking.id ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <>\n                      <Check className=\"w-4 h-4 mr-1\" />\n                      Accept\n                    </>\n                  )}\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={() => handleDecline(booking)}\n                  disabled={processing === booking.id}\n                  className=\"flex-1 border-red-300 text-red-600 hover:bg-red-50\"\n                >\n                  <X className=\"w-4 h-4 mr-1\" />\n                  Decline\n                </Button>\n              </div>\n            </div>\n          );\n        })}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\CommunicationService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\EarningsOptimizationPanel.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":15,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// EarningsOptimizationPanel - AI-powered earnings tips\r\n// Personalized recommendations to increase cleaner earnings\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { aiCleanerChatService, CleanerContext } from '@/services/aiCleanerChatService';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  TrendingUp, DollarSign, Target, Clock, Star, Award,\r\n  Zap, Calendar, MapPin, Loader2, Lightbulb, ChevronRight\r\n} from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface EarningsOptimizationPanelProps {\r\n  cleanerId: string;\r\n  cleanerEmail: string;\r\n  stats: {\r\n    totalJobs: number;\r\n    reliabilityScore: number;\r\n    avgRating: number;\r\n    totalEarnings: number;\r\n  };\r\n}\r\n\r\nexport default function EarningsOptimizationPanel({\r\n  cleanerId,\r\n  cleanerEmail,\r\n  stats\r\n}: EarningsOptimizationPanelProps) {\r\n  const [tips, setTips] = useState<string>('');\r\n  const [scheduleTips, setScheduleTips] = useState<string>('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState<'earnings' | 'schedule'>('earnings');\r\n\r\n  useEffect(() => {\r\n    loadOptimizations();\r\n  }, []);\r\n\r\n  const loadOptimizations = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const context: CleanerContext = {\r\n        cleanerId,\r\n        cleanerEmail,\r\n        stats\r\n      };\r\n\r\n      const [earningsTips, scheduleRecommendations] = await Promise.all([\r\n        aiCleanerChatService.getEarningsOptimization(context),\r\n        aiCleanerChatService.getScheduleRecommendations(context)\r\n      ]);\r\n\r\n      setTips(earningsTips);\r\n      setScheduleTips(scheduleRecommendations);\r\n    } catch (error) {\r\n      console.error('Failed to load optimization tips:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculate potential earnings increase\r\n  const getPotentialIncrease = () => {\r\n    const avgPerJob = stats.totalJobs > 0 ? stats.totalEarnings / stats.totalJobs : 40;\r\n    const reliabilityBonus = stats.reliabilityScore >= 90 ? 1.15 : 1.0;\r\n    const moreJobsPerWeek = 2; // Assume 2 more jobs per week\r\n    const potentialWeekly = avgPerJob * moreJobsPerWeek * reliabilityBonus;\r\n    const potentialMonthly = potentialWeekly * 4;\r\n    \r\n    return {\r\n      weekly: potentialWeekly,\r\n      monthly: potentialMonthly,\r\n      yearly: potentialMonthly * 12\r\n    };\r\n  };\r\n\r\n  const potential = getPotentialIncrease();\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"p-8 text-center\">\r\n          <Loader2 className=\"w-8 h-8 animate-spin text-info mx-auto mb-4\" />\r\n          <p className=\"font-body text-gray-600\">AI is analyzing your earnings potential...</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className=\"border-success-border\">\r\n      <CardHeader className=\"bg-gradient-to-r from-success-soft to-white\">\r\n        <CardTitle className=\"font-heading text-xl flex items-center gap-2\">\r\n          <TrendingUp className=\"w-6 h-6 text-success\" />\r\n          Earnings Optimization\r\n        </CardTitle>\r\n      </CardHeader>\r\n\r\n      <CardContent className=\"p-6 space-y-6\">\r\n        {/* Stats Overview */}\r\n        <div className=\"grid grid-cols-3 gap-4\">\r\n          <Card className=\"bg-success-soft border-success-border\">\r\n            <CardContent className=\"p-4 text-center\">\r\n              <DollarSign className=\"w-6 h-6 text-success mx-auto mb-2\" />\r\n              <p className=\"text-2xl font-heading font-bold text-success\">\r\n                ${stats.totalEarnings.toFixed(0)}\r\n              </p>\r\n              <p className=\"text-xs font-body text-gray-600\">Total Earned</p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"bg-system-soft border-system-border\">\r\n            <CardContent className=\"p-4 text-center\">\r\n              <Award className=\"w-6 h-6 text-system mx-auto mb-2\" />\r\n              <p className=\"text-2xl font-heading font-bold text-system\">\r\n                {stats.reliabilityScore}%\r\n              </p>\r\n              <p className=\"text-xs font-body text-gray-600\">Reliability</p>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"bg-warning-soft border-warning-border\">\r\n            <CardContent className=\"p-4 text-center\">\r\n              <Star className=\"w-6 h-6 text-warning mx-auto mb-2\" />\r\n              <p className=\"text-2xl font-heading font-bold text-warning\">\r\n                {stats.avgRating.toFixed(1)}\r\n              </p>\r\n              <p className=\"text-xs font-body text-gray-600\">Avg Rating</p>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Potential Earnings Card */}\r\n        <motion.div\r\n          initial={{ scale: 0.95 }}\r\n          animate={{ scale: 1 }}\r\n          className=\"bg-gradient-to-br from-success to-success/80 rounded-lg p-6 text-white\"\r\n        >\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <Target className=\"w-6 h-6\" />\r\n            <h3 className=\"font-heading font-bold text-lg\">Earnings Potential</h3>\r\n          </div>\r\n          <div className=\"grid grid-cols-3 gap-4 text-center\">\r\n            <div>\r\n              <p className=\"text-3xl font-heading font-bold\">\r\n                +${potential.weekly.toFixed(0)}\r\n              </p>\r\n              <p className=\"text-sm font-body opacity-90\">per week</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-3xl font-heading font-bold\">\r\n                +${potential.monthly.toFixed(0)}\r\n              </p>\r\n              <p className=\"text-sm font-body opacity-90\">per month</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-3xl font-heading font-bold\">\r\n                +${(potential.yearly / 1000).toFixed(1)}k\r\n              </p>\r\n              <p className=\"text-sm font-body opacity-90\">per year</p>\r\n            </div>\r\n          </div>\r\n          <p className=\"text-sm font-body mt-4 opacity-90\">\r\n            <Lightbulb className=\"w-4 h-4 inline mr-1\" />\r\n            By optimizing your schedule and accepting strategic jobs, you could earn this much more!\r\n          </p>\r\n        </motion.div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex gap-2 border-b\">\r\n          <button\r\n            onClick={() => setActiveTab('earnings')}\r\n            className={`flex-1 py-3 px-4 font-heading font-semibold transition-colors ${\r\n              activeTab === 'earnings'\r\n                ? 'text-success border-b-2 border-success'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            <DollarSign className=\"w-4 h-4 inline mr-2\" />\r\n            Earnings Tips\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('schedule')}\r\n            className={`flex-1 py-3 px-4 font-heading font-semibold transition-colors ${\r\n              activeTab === 'schedule'\r\n                ? 'text-success border-b-2 border-success'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            <Calendar className=\"w-4 h-4 inline mr-2\" />\r\n            Schedule Tips\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <motion.div\r\n          key={activeTab}\r\n          initial={{ opacity: 0, y: 10 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"space-y-4\"\r\n        >\r\n          {activeTab === 'earnings' && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-start gap-3 p-4 bg-success-soft rounded-lg\">\r\n                <Zap className=\"w-5 h-5 text-success mt-1 flex-shrink-0\" />\r\n                <div className=\"flex-1\">\r\n                  <h4 className=\"font-heading font-semibold text-gray-800 mb-2\">\r\n                    AI-Powered Recommendations\r\n                  </h4>\r\n                  <div className=\"font-body text-gray-700 whitespace-pre-wrap\">\r\n                    {tips}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Quick Actions */}\r\n              <div className=\"grid grid-cols-2 gap-3\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"justify-start font-body\"\r\n                  size=\"sm\"\r\n                >\r\n                  <Star className=\"w-4 h-4 mr-2 text-warning\" />\r\n                  Improve Rating\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"justify-start font-body\"\r\n                  size=\"sm\"\r\n                >\r\n                  <Award className=\"w-4 h-4 mr-2 text-system\" />\r\n                  Boost Reliability\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"justify-start font-body\"\r\n                  size=\"sm\"\r\n                >\r\n                  <Clock className=\"w-4 h-4 mr-2 text-info\" />\r\n                  Work Peak Hours\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"justify-start font-body\"\r\n                  size=\"sm\"\r\n                >\r\n                  <MapPin className=\"w-4 h-4 mr-2 text-success\" />\r\n                  Optimize Routes\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'schedule' && (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-start gap-3 p-4 bg-system-soft rounded-lg\">\r\n                <Calendar className=\"w-5 h-5 text-system mt-1 flex-shrink-0\" />\r\n                <div className=\"flex-1\">\r\n                  <h4 className=\"font-heading font-semibold text-gray-800 mb-2\">\r\n                    Schedule Optimization\r\n                  </h4>\r\n                  <div className=\"font-body text-gray-700 whitespace-pre-wrap\">\r\n                    {scheduleTips}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Best Times */}\r\n              <Card className=\"bg-gradient-to-r from-info-soft to-white\">\r\n                <CardContent className=\"p-4\">\r\n                  <h4 className=\"font-heading font-semibold mb-3 flex items-center gap-2\">\r\n                    <Clock className=\"w-5 h-5 text-info\" />\r\n                    Peak Earning Times\r\n                  </h4>\r\n                  <ul className=\"space-y-2 font-body text-sm\">\r\n                    <li className=\"flex items-center justify-between\">\r\n                      <span>Friday - Sunday mornings</span>\r\n                      <Badge variant=\"success\">High Demand</Badge>\r\n                    </li>\r\n                    <li className=\"flex items-center justify-between\">\r\n                      <span>Move-out cleanings (end of month)</span>\r\n                      <Badge variant=\"success\">High Pay</Badge>\r\n                    </li>\r\n                    <li className=\"flex items-center justify-between\">\r\n                      <span>Weekday afternoons</span>\r\n                      <Badge variant=\"system\">Moderate</Badge>\r\n                    </li>\r\n                  </ul>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* Refresh Button */}\r\n        <Button\r\n          onClick={loadOptimizations}\r\n          variant=\"outline\"\r\n          className=\"w-full font-heading\"\r\n          disabled={loading}\r\n        >\r\n          {loading ? (\r\n            <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n          ) : (\r\n            <ChevronRight className=\"w-4 h-4 mr-2\" />\r\n          )}\r\n          Refresh Recommendations\r\n        </Button>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\JobOfferRecommendation.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":6,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// JobOfferRecommendation - AI-powered job offer analysis\r\n// Helps cleaners make informed decisions about accepting jobs\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { aiCleanerChatService } from '@/services/aiCleanerChatService';\r\nimport type { JobRecord } from '@/types/cleanerJobTypes';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  TrendingUp, TrendingDown, Minus, DollarSign, Clock, MapPin,\r\n  CheckCircle, AlertTriangle, Zap, Target, Award, Loader2\r\n} from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface JobOfferRecommendationProps {\r\n  job: JobRecord;\r\n  cleanerId: string;\r\n  cleanerEmail: string;\r\n  stats?: {\r\n    totalJobs: number;\r\n    reliabilityScore: number;\r\n    avgRating: number;\r\n    totalEarnings: number;\r\n  };\r\n  onAccept?: () => void;\r\n  onDecline?: () => void;\r\n}\r\n\r\nexport default function JobOfferRecommendation({\r\n  job,\r\n  cleanerId,\r\n  cleanerEmail,\r\n  stats,\r\n  onAccept,\r\n  onDecline\r\n}: JobOfferRecommendationProps) {\r\n  const [analysis, setAnalysis] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showDetails, setShowDetails] = useState(false);\r\n\r\n  useEffect(() => {\r\n    analyzeOffer();\r\n  }, [job.id]);\r\n\r\n  const analyzeOffer = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const result = await aiCleanerChatService.analyzeJobOffer(job, {\r\n        cleanerId,\r\n        cleanerEmail,\r\n        currentJob: job,\r\n        stats\r\n      });\r\n      setAnalysis(result);\r\n    } catch (error) {\r\n      console.error('Failed to analyze job offer:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card className=\"border-info-border\">\r\n        <CardContent className=\"p-8 text-center\">\r\n          <Loader2 className=\"w-8 h-8 animate-spin text-info mx-auto mb-4\" />\r\n          <p className=\"font-body text-gray-600\">AI is analyzing this job offer...</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  if (!analysis) {\r\n    return null;\r\n  }\r\n\r\n  const getRecommendationBadge = () => {\r\n    const config = {\r\n      accept: {\r\n        icon: CheckCircle,\r\n        label: 'Recommended',\r\n        variant: 'success' as const,\r\n        color: 'text-success'\r\n      },\r\n      consider: {\r\n        icon: Minus,\r\n        label: 'Consider Carefully',\r\n        variant: 'warning' as const,\r\n        color: 'text-warning'\r\n      },\r\n      pass: {\r\n        icon: AlertTriangle,\r\n        label: 'Not Recommended',\r\n        variant: 'error' as const,\r\n        color: 'text-error'\r\n      }\r\n    };\r\n\r\n    const { icon: Icon, label, variant, color } = config[analysis.recommendation];\r\n\r\n    return (\r\n      <Badge variant={variant} className=\"font-heading text-base py-2 px-4\">\r\n        <Icon className={`w-5 h-5 mr-2 ${color}`} />\r\n        {label}\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={{ duration: 0.4 }}\r\n    >\r\n      <Card className=\"border-2 border-info\">\r\n        <CardHeader className=\"bg-gradient-to-r from-info-soft to-white\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"font-heading text-xl flex items-center gap-2\">\r\n              <Zap className=\"w-6 h-6 text-info\" />\r\n              AI Job Analysis\r\n            </CardTitle>\r\n            {getRecommendationBadge()}\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"p-6 space-y-6\">\r\n          {/* Key Metrics */}\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <Card className=\"bg-success-soft border-success-border\">\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <DollarSign className=\"w-5 h-5 text-success\" />\r\n                  <span className=\"text-sm font-body text-gray-600\">Estimated Earnings</span>\r\n                </div>\r\n                <p className=\"text-2xl font-heading font-bold text-success\">\r\n                  ${analysis.estimatedEarnings.toFixed(2)}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card className=\"bg-system-soft border-system-border\">\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <Clock className=\"w-5 h-5 text-system\" />\r\n                  <span className=\"text-sm font-body text-gray-600\">Time Required</span>\r\n                </div>\r\n                <p className=\"text-2xl font-heading font-bold text-system\">\r\n                  {Math.floor(analysis.estimatedTime / 60)}h {analysis.estimatedTime % 60}m\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* Reasons */}\r\n          <div>\r\n            <h3 className=\"font-heading font-semibold text-gray-800 mb-3 flex items-center gap-2\">\r\n              <Target className=\"w-5 h-5 text-info\" />\r\n              Why {analysis.recommendation === 'accept' ? 'You Should Accept' : analysis.recommendation === 'pass' ? 'You Should Pass' : 'Consider This Carefully'}:\r\n            </h3>\r\n            <ul className=\"space-y-2\">\r\n              {analysis.reasons.map((reason: string, index: number) => (\r\n                <motion.li\r\n                  key={index}\r\n                  initial={{ opacity: 0, x: -20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ delay: index * 0.1 }}\r\n                  className=\"flex items-start gap-2 font-body text-gray-700\"\r\n                >\r\n                  <CheckCircle className=\"w-5 h-5 text-info mt-0.5 flex-shrink-0\" />\r\n                  <span>{reason}</span>\r\n                </motion.li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n\r\n          {/* Job Details Toggle */}\r\n          <Button\r\n            onClick={() => setShowDetails(!showDetails)}\r\n            variant=\"outline\"\r\n            className=\"w-full font-heading\"\r\n          >\r\n            {showDetails ? 'Hide' : 'Show'} Job Details\r\n          </Button>\r\n\r\n          {showDetails && (\r\n            <motion.div\r\n              initial={{ opacity: 0, height: 0 }}\r\n              animate={{ opacity: 1, height: 'auto' }}\r\n              className=\"border-t pt-4 space-y-3\"\r\n            >\r\n              <div className=\"grid grid-cols-2 gap-4 font-body text-sm\">\r\n                <div>\r\n                  <span className=\"text-gray-600\">Date & Time:</span>\r\n                  <p className=\"font-semibold\">{job.date} at {job.time}</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-gray-600\">Cleaning Type:</span>\r\n                  <p className=\"font-semibold capitalize\">{job.cleaning_type}</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-gray-600\">Property Size:</span>\r\n                  <p className=\"font-semibold\">{job.bedrooms}BR / {job.bathrooms}BA</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-gray-600\">Duration:</span>\r\n                  <p className=\"font-semibold\">{job.duration_hours} hours</p>\r\n                </div>\r\n                <div className=\"col-span-2\">\r\n                  <span className=\"text-gray-600\">Address:</span>\r\n                  <p className=\"font-semibold flex items-center gap-1\">\r\n                    <MapPin className=\"w-4 h-4 text-system\" />\r\n                    {job.address}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          )}\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"flex gap-3 pt-4\">\r\n            <Button\r\n              onClick={onAccept}\r\n              disabled={!onAccept}\r\n              className=\"flex-1 bg-success hover:bg-success/90 text-white font-heading font-semibold\"\r\n              size=\"lg\"\r\n            >\r\n              <CheckCircle className=\"w-5 h-5 mr-2\" />\r\n              Accept Job\r\n            </Button>\r\n            <Button\r\n              onClick={onDecline}\r\n              disabled={!onDecline}\r\n              variant=\"outline\"\r\n              className=\"flex-1 font-heading font-semibold\"\r\n              size=\"lg\"\r\n            >\r\n              Decline\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Recommendation Tip */}\r\n          {analysis.recommendation === 'accept' && (\r\n            <Alert className=\"bg-success-soft border-success-border\">\r\n              <Award className=\"w-4 h-4 text-success\" />\r\n              <AlertDescription className=\"font-body\">\r\n                <strong>Pro Tip:</strong> This job aligns well with your profile. Accepting it could boost your earnings and reliability score!\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          {analysis.recommendation === 'consider' && (\r\n            <Alert className=\"bg-warning-soft border-warning-border\">\r\n              <AlertTriangle className=\"w-4 h-4 text-warning\" />\r\n              <AlertDescription className=\"font-body\">\r\n                <strong>Note:</strong> This job has some pros and cons. Review the details carefully before deciding.\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n\r\n          {analysis.recommendation === 'pass' && (\r\n            <Alert className=\"bg-error-soft border-error-border\">\r\n              <AlertTriangle className=\"w-4 h-4 text-error\" />\r\n              <AlertDescription className=\"font-body\">\r\n                <strong>Consider:</strong> There may be better opportunities available. Passing on this won't affect your reliability score.\r\n              </AlertDescription>\r\n            </Alert>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </motion.div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\MessagePreview.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\MessageSettingCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\ReliabilityImpactWidget.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ai\\SmartMatchingSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\AnalyticsChartCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\AnalyticsExportButton.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'filters' is assigned a value but never used. Allowed unused args must match /^_/u.","line":6,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":68,"suggestions":[{"messageId":"removeVar","data":{"varName":"filters"},"fix":{"range":[244,258],"text":""},"desc":"Remove unused variable 'filters'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Download, Loader2 } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\n\nexport default function AnalyticsExportButton({ entityName, filters = {}, filename = 'export.csv' }) {\n  const [exporting, setExporting] = useState(false);\n\n  const handleExport = async () => {\n    setExporting(true);\n    try {\n      let data;\n      if (entityName === 'PlatformAnalyticsDaily') {\n        data = await base44.entities.PlatformAnalyticsDaily.list('-created_date', 365);\n      } else if (entityName === 'CleanerDailySnapshot') {\n        data = await base44.entities.CleanerDailySnapshot.list('-created_date', 1000);\n      } else {\n        data = await base44.entities[entityName].list();\n      }\n      \n      if (data.length === 0) {\n        alert('No data to export');\n        setExporting(false);\n        return;\n      }\n      \n      // Convert to CSV\n      const headers = Object.keys(data[0]).filter(key => \n        !['id', 'created_by', 'created_date', 'updated_date'].includes(key)\n      );\n      \n      let csv = headers.join(',') + '\\n';\n      \n      data.forEach(row => {\n        const values = headers.map(header => {\n          let val = row[header];\n          if (typeof val === 'object') val = JSON.stringify(val);\n          if (typeof val === 'string') val = val.replace(/\"/g, '\"\"');\n          return `\"${val}\"`;\n        });\n        csv += values.join(',') + '\\n';\n      });\n      \n      // Download\n      const blob = new Blob([csv], { type: 'text/csv' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = filename;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      a.remove();\n      \n      setExporting(false);\n    } catch (error) {\n      console.error('Export error:', error);\n      alert('Export failed');\n      setExporting(false);\n    }\n  };\n\n  return (\n    <Button\n      onClick={handleExport}\n      disabled={exporting}\n      variant=\"outline\"\n      className=\"font-fredoka\"\n    >\n      {exporting ? (\n        <>\n          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n          Exporting...\n        </>\n      ) : (\n        <>\n          <Download className=\"w-4 h-4 mr-2\" />\n          Export CSV\n        </>\n      )}\n    </Button>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\AnalyticsService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\AnalyticsTracker.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":64,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"e"},"fix":{"range":[1916,1917],"text":""},"desc":"Remove unused variable 'e'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\n\n// Generate or retrieve session ID\nconst getSessionId = () => {\n  let sessionId = sessionStorage.getItem('analytics_session_id');\n  if (!sessionId) {\n    sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    sessionStorage.setItem('analytics_session_id', sessionId);\n  }\n  return sessionId;\n};\n\nexport function useAnalytics() {\n  const location = useLocation();\n  const lastPathRef = useRef('');\n\n  const trackEvent = async (eventType, metadata = {}) => {\n    try {\n      const user = await base44.auth.me().catch(() => null);\n      const sessionId = getSessionId();\n\n      await base44.entities.AnalyticsEvent.create({\n        event_type: eventType,\n        user_email: user?.email || 'guest',\n        user_type: user?.user_type || 'guest',\n        metadata: {\n          ...metadata,\n          referrer: document.referrer,\n          user_agent: navigator.userAgent,\n          screen_width: window.innerWidth,\n          screen_height: window.innerHeight\n        },\n        page_url: window.location.href,\n        session_id: sessionId,\n        timestamp: new Date().toISOString()\n      });\n    } catch (error) {\n      console.error('Analytics tracking error:', error);\n    }\n  };\n\n  // Track page views (only when path actually changes)\n  useEffect(() => {\n    const currentPath = location.pathname;\n    if (currentPath !== lastPathRef.current) {\n      lastPathRef.current = currentPath;\n      trackEvent('page_view', { \n        path: currentPath,\n        search: location.search \n      });\n    }\n  }, [location]);\n\n  return { trackEvent };\n}\n\n// Helper hook for tracking form abandonment\nexport function useFormAbandonment(formName, hasUnsavedChanges) {\n  const { trackEvent } = useAnalytics();\n\n  useEffect(() => {\n    const handleBeforeUnload = (e) => {\n      if (hasUnsavedChanges) {\n        trackEvent('form_abandoned', { \n          form_name: formName,\n          had_changes: true \n        });\n      }\n    };\n\n    window.addEventListener('beforeunload', handleBeforeUnload);\n    return () => window.removeEventListener('beforeunload', handleBeforeUnload);\n  }, [hasUnsavedChanges, formName]);\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\CleanerPerformanceDashboard.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":20,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// CleanerPerformanceDashboard - Advanced Analytics & Insights\r\n// Comprehensive performance tracking and AI-powered recommendations\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r\n  TrendingUp, TrendingDown, Award, Target, Clock, DollarSign,\r\n  Star, CheckCircle, AlertTriangle, Calendar, MapPin, Zap,\r\n  BarChart3, PieChart, Activity, Trophy, Loader2\r\n} from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\nimport {\r\n  LineChart, Line, BarChart, Bar, PieChart as RechartsPie, Pie, Cell,\r\n  XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\r\n} from 'recharts';\r\n\r\ninterface PerformanceStats {\r\n  // Overview\r\n  totalJobs: number;\r\n  completedJobs: number;\r\n  cancelledJobs: number;\r\n  totalEarnings: number;\r\n  avgEarningsPerJob: number;\r\n  \r\n  // Quality\r\n  reliabilityScore: number;\r\n  avgRating: number;\r\n  totalReviews: number;\r\n  \r\n  // Time\r\n  avgJobDuration: number;\r\n  totalHoursWorked: number;\r\n  onTimePercentage: number;\r\n  \r\n  // Trends\r\n  weeklyEarnings: number[];\r\n  weeklyJobs: number[];\r\n  ratingTrend: number[];\r\n  \r\n  // Breakdown\r\n  jobsByType: { type: string; count: number; earnings: number }[];\r\n  earningsByDay: { day: string; amount: number }[];\r\n}\r\n\r\nexport default function CleanerPerformanceDashboard({ cleanerId, cleanerEmail }) {\r\n  const [stats, setStats] = useState<PerformanceStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [timeRange, setTimeRange] = useState<'week' | 'month' | 'quarter' | 'year'>('month');\r\n  const [selectedMetric, setSelectedMetric] = useState<'earnings' | 'jobs' | 'ratings'>('earnings');\r\n\r\n  useEffect(() => {\r\n    loadPerformanceData();\r\n  }, [timeRange]);\r\n\r\n  const loadPerformanceData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Load all jobs for this cleaner\r\n      const jobs = await base44.entities.Job.filter({\r\n        assigned_cleaner_email: cleanerEmail\r\n      });\r\n\r\n      // Calculate stats\r\n      const completed = jobs.filter(j => j.state === 'COMPLETED_APPROVED');\r\n      const cancelled = jobs.filter(j => j.state === 'CANCELLED');\r\n      \r\n      const totalEarnings = completed.reduce((sum, j) => \r\n        sum + ((j.final_credits_charged || 0) * 0.8), 0\r\n      );\r\n      \r\n      const totalMinutes = completed.reduce((sum, j) => \r\n        sum + (j.actual_minutes_worked || 0), 0\r\n      );\r\n      \r\n      // Mock data for demo (TODO: calculate from real data)\r\n      const mockStats: PerformanceStats = {\r\n        totalJobs: jobs.length,\r\n        completedJobs: completed.length,\r\n        cancelledJobs: cancelled.length,\r\n        totalEarnings,\r\n        avgEarningsPerJob: completed.length > 0 ? totalEarnings / completed.length : 0,\r\n        \r\n        reliabilityScore: 92, // TODO: calculate real score\r\n        avgRating: 4.8,\r\n        totalReviews: completed.length,\r\n        \r\n        avgJobDuration: completed.length > 0 ? totalMinutes / completed.length : 0,\r\n        totalHoursWorked: totalMinutes / 60,\r\n        onTimePercentage: 95,\r\n        \r\n        weeklyEarnings: [450, 520, 480, 650],\r\n        weeklyJobs: [5, 6, 5, 7],\r\n        ratingTrend: [4.6, 4.7, 4.8, 4.8],\r\n        \r\n        jobsByType: [\r\n          { type: 'basic', count: 12, earnings: 960 },\r\n          { type: 'deep', count: 5, earnings: 750 },\r\n          { type: 'moveout', count: 3, earnings: 540 }\r\n        ],\r\n        \r\n        earningsByDay: [\r\n          { day: 'Mon', amount: 120 },\r\n          { day: 'Tue', amount: 160 },\r\n          { day: 'Wed', amount: 140 },\r\n          { day: 'Thu', amount: 180 },\r\n          { day: 'Fri', amount: 220 },\r\n          { day: 'Sat', amount: 280 },\r\n          { day: 'Sun', amount: 200 }\r\n        ]\r\n      };\r\n      \r\n      setStats(mockStats);\r\n    } catch (error) {\r\n      console.error('Failed to load performance data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-12\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-info\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!stats) return null;\r\n\r\n  const COLORS = {\r\n    primary: '#06B6D4',\r\n    success: '#22C55E',\r\n    warning: '#F59E0B',\r\n    error: '#EF4444',\r\n    info: '#3B82F6'\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with Time Range Selector */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-heading font-bold text-graphite\">Performance Dashboard</h2>\r\n          <p className=\"text-gray-600 font-body mt-1\">Track your progress and optimize your earnings</p>\r\n        </div>\r\n        \r\n        <div className=\"flex gap-2\">\r\n          {(['week', 'month', 'quarter', 'year'] as const).map(range => (\r\n            <Button\r\n              key={range}\r\n              onClick={() => setTimeRange(range)}\r\n              variant={timeRange === range ? 'default' : 'outline'}\r\n              size=\"sm\"\r\n              className=\"font-heading capitalize\"\r\n            >\r\n              {range}\r\n            </Button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Key Metrics Cards */}\r\n      <div className=\"grid grid-cols-4 gap-4\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.1 }}\r\n        >\r\n          <Card className=\"border-success-border bg-gradient-to-br from-success-soft to-white\">\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <DollarSign className=\"w-8 h-8 text-success\" />\r\n                <Badge variant=\"success\" className=\"font-heading\">\r\n                  +12%\r\n                </Badge>\r\n              </div>\r\n              <p className=\"text-3xl font-heading font-bold text-success\">\r\n                ${stats.totalEarnings.toFixed(0)}\r\n              </p>\r\n              <p className=\"text-sm font-body text-gray-600 mt-1\">Total Earnings</p>\r\n              <p className=\"text-xs font-body text-gray-500 mt-2\">\r\n                ${stats.avgEarningsPerJob.toFixed(2)} avg per job\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.2 }}\r\n        >\r\n          <Card className=\"border-system-border bg-gradient-to-br from-system-soft to-white\">\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <CheckCircle className=\"w-8 h-8 text-system\" />\r\n                <Badge variant=\"system\" className=\"font-heading\">\r\n                  {stats.completedJobs}\r\n                </Badge>\r\n              </div>\r\n              <p className=\"text-3xl font-heading font-bold text-system\">\r\n                {((stats.completedJobs / stats.totalJobs) * 100).toFixed(0)}%\r\n              </p>\r\n              <p className=\"text-sm font-body text-gray-600 mt-1\">Completion Rate</p>\r\n              <p className=\"text-xs font-body text-gray-500 mt-2\">\r\n                {stats.completedJobs} of {stats.totalJobs} jobs\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.3 }}\r\n        >\r\n          <Card className=\"border-warning-border bg-gradient-to-br from-warning-soft to-white\">\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <Star className=\"w-8 h-8 text-warning\" />\r\n                <Badge variant=\"warning\" className=\"font-heading\">\r\n                  +0.2\r\n                </Badge>\r\n              </div>\r\n              <p className=\"text-3xl font-heading font-bold text-warning\">\r\n                {stats.avgRating.toFixed(1)}\r\n              </p>\r\n              <p className=\"text-sm font-body text-gray-600 mt-1\">Average Rating</p>\r\n              <p className=\"text-xs font-body text-gray-500 mt-2\">\r\n                {stats.totalReviews} reviews\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.4 }}\r\n        >\r\n          <Card className=\"border-info-border bg-gradient-to-br from-info-soft to-white\">\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <Award className=\"w-8 h-8 text-info\" />\r\n                <Badge variant=\"info\" className=\"font-heading\">\r\n                  Gold\r\n                </Badge>\r\n              </div>\r\n              <p className=\"text-3xl font-heading font-bold text-info\">\r\n                {stats.reliabilityScore}%\r\n              </p>\r\n              <p className=\"text-sm font-body text-gray-600 mt-1\">Reliability Score</p>\r\n              <p className=\"text-xs font-body text-gray-500 mt-2\">\r\n                Top 15% of cleaners\r\n              </p>\r\n            </CardContent>\r\n          </Card>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Charts Row */}\r\n      <div className=\"grid grid-cols-2 gap-6\">\r\n        {/* Earnings Trend */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"font-heading flex items-center gap-2\">\r\n              <TrendingUp className=\"w-5 h-5 text-success\" />\r\n              Earnings Trend\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <LineChart data={stats.weeklyEarnings.map((amount, i) => ({\r\n                week: `Week ${i + 1}`,\r\n                earnings: amount\r\n              }))}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"week\" style={{ fontFamily: 'Quicksand' }} />\r\n                <YAxis style={{ fontFamily: 'Quicksand' }} />\r\n                <Tooltip />\r\n                <Line \r\n                  type=\"monotone\" \r\n                  dataKey=\"earnings\" \r\n                  stroke={COLORS.success} \r\n                  strokeWidth={3}\r\n                  dot={{ fill: COLORS.success, r: 6 }}\r\n                />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Earnings by Day */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"font-heading flex items-center gap-2\">\r\n              <BarChart3 className=\"w-5 h-5 text-system\" />\r\n              Earnings by Day\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <BarChart data={stats.earningsByDay}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"day\" style={{ fontFamily: 'Quicksand' }} />\r\n                <YAxis style={{ fontFamily: 'Quicksand' }} />\r\n                <Tooltip />\r\n                <Bar dataKey=\"amount\" fill={COLORS.primary} radius={[8, 8, 0, 0]} />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Jobs Breakdown */}\r\n      <div className=\"grid grid-cols-3 gap-6\">\r\n        <Card className=\"col-span-2\">\r\n          <CardHeader>\r\n            <CardTitle className=\"font-heading flex items-center gap-2\">\r\n              <Target className=\"w-5 h-5 text-info\" />\r\n              Job Type Performance\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4\">\r\n              {stats.jobsByType.map((job, index) => {\r\n                const percentage = (job.count / stats.totalJobs) * 100;\r\n                const avgEarnings = job.earnings / job.count;\r\n                \r\n                return (\r\n                  <div key={job.type} className=\"space-y-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"font-heading font-semibold capitalize\">{job.type} Cleaning</span>\r\n                      <span className=\"font-body text-sm text-gray-600\">\r\n                        {job.count} jobs ¬∑ ${avgEarnings.toFixed(0)} avg\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n                      <motion.div\r\n                        initial={{ width: 0 }}\r\n                        animate={{ width: `${percentage}%` }}\r\n                        transition={{ delay: index * 0.1, duration: 0.5 }}\r\n                        className=\"h-3 rounded-full\"\r\n                        style={{ \r\n                          backgroundColor: index === 0 ? COLORS.success : index === 1 ? COLORS.primary : COLORS.info \r\n                        }}\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between text-xs font-body text-gray-500\">\r\n                      <span>{percentage.toFixed(0)}% of total jobs</span>\r\n                      <span>${job.earnings.toFixed(0)} earned</span>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Quick Stats */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"font-heading flex items-center gap-2\">\r\n              <Activity className=\"w-5 h-5 text-warning\" />\r\n              Quick Stats\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between p-3 bg-system-soft rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Clock className=\"w-5 h-5 text-system\" />\r\n                <span className=\"font-body text-sm\">Avg Job Duration</span>\r\n              </div>\r\n              <span className=\"font-heading font-bold text-system\">\r\n                {Math.floor(stats.avgJobDuration / 60)}h {stats.avgJobDuration % 60}m\r\n              </span>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between p-3 bg-success-soft rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <CheckCircle className=\"w-5 h-5 text-success\" />\r\n                <span className=\"font-body text-sm\">On-Time Rate</span>\r\n              </div>\r\n              <span className=\"font-heading font-bold text-success\">\r\n                {stats.onTimePercentage}%\r\n              </span>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between p-3 bg-warning-soft rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Trophy className=\"w-5 h-5 text-warning\" />\r\n                <span className=\"font-body text-sm\">Total Hours</span>\r\n              </div>\r\n              <span className=\"font-heading font-bold text-warning\">\r\n                {stats.totalHoursWorked.toFixed(1)}h\r\n              </span>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center justify-between p-3 bg-error-soft rounded-lg\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-5 h-5 text-error\" />\r\n                <span className=\"font-body text-sm\">Cancellations</span>\r\n              </div>\r\n              <span className=\"font-heading font-bold text-error\">\r\n                {stats.cancelledJobs}\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* AI Insights */}\r\n      <Card className=\"border-2 border-info\">\r\n        <CardHeader className=\"bg-gradient-to-r from-info-soft to-white\">\r\n          <CardTitle className=\"font-heading flex items-center gap-2\">\r\n            <Zap className=\"w-5 h-5 text-info\" />\r\n            AI Performance Insights\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"grid grid-cols-2 gap-6\">\r\n            <div>\r\n              <h4 className=\"font-heading font-semibold text-success mb-3 flex items-center gap-2\">\r\n                <TrendingUp className=\"w-5 h-5\" />\r\n                What's Working Well\r\n              </h4>\r\n              <ul className=\"space-y-2 font-body text-sm\">\r\n                <li className=\"flex items-start gap-2\">\r\n                  <CheckCircle className=\"w-4 h-4 text-success mt-0.5\" />\r\n                  <span>Your weekend earnings are 35% above average</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <CheckCircle className=\"w-4 h-4 text-success mt-0.5\" />\r\n                  <span>On-time arrival rate is excellent (95%)</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <CheckCircle className=\"w-4 h-4 text-success mt-0.5\" />\r\n                  <span>Client ratings improving (+0.2 this month)</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            \r\n            <div>\r\n              <h4 className=\"font-heading font-semibold text-warning mb-3 flex items-center gap-2\">\r\n                <Target className=\"w-5 h-5\" />\r\n                Growth Opportunities\r\n              </h4>\r\n              <ul className=\"space-y-2 font-body text-sm\">\r\n                <li className=\"flex items-start gap-2\">\r\n                  <Zap className=\"w-4 h-4 text-warning mt-0.5\" />\r\n                  <span>Accept more deep cleaning jobs (+$150/mo potential)</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <Zap className=\"w-4 h-4 text-warning mt-0.5\" />\r\n                  <span>Work Tuesday mornings (lowest competition)</span>\r\n                </li>\r\n                <li className=\"flex items-start gap-2\">\r\n                  <Zap className=\"w-4 h-4 text-warning mt-0.5\" />\r\n                  <span>Reduce avg job time by 10min saves 2hrs/week</span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\KPICard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\analytics\\README.md.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected character ' '","line":1,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"# Module 10 - Analytics & KPI Engine\n\n## Overview\nA comprehensive analytics system built entirely on Base44, providing real-time insights and historical trends for the PureTask marketplace.\n\n## Architecture\n\n### Entities\n- **PlatformAnalyticsDaily**: Daily platform-wide metrics (365-day retention)\n- **CleanerDailySnapshot**: Per-cleaner daily performance (90-day retention)\n- **SubscriptionAnalytics**: Subscription KPIs (singleton)\n- **MembershipAnalytics**: Membership KPIs (singleton)\n- **DashboardCache**: Pre-computed dashboard payloads\n- **SystemAlert**: Anomaly detection alerts\n\n### Automations\n\n#### Real-time (Event-driven)\n- `analyticsAutomations.js`: Listens to booking, dispute, subscription events\n- Updates CleanerAnalytics immediately\n- Logs events to Event/AnalyticsEvent\n\n#### Batch (Nightly Cron)\n- `cronAnalytics.js`: Runs at 3:00 AM daily\n- Computes daily metrics for yesterday\n- Updates all analytics entities\n- Runs anomaly detection\n- Cleans up old records\n\n### Dashboards\n\n1. **CEO Dashboard**: High-level GMV, revenue, MRR trends\n2. **Ops Dashboard**: Bookings, cancellations, disputes, cleaner performance\n3. **Finance Dashboard**: Revenue breakdown, margins, payouts, refunds\n4. **Growth Dashboard**: User acquisition, funnels, subscriptions, retention\n5. **System Alerts**: Real-time anomaly alerts\n\n## Key Features\n\n- ‚úÖ Event-driven real-time updates\n- ‚úÖ Nightly batch aggregation\n- ‚úÖ Rolling 30/90-day windows\n- ‚úÖ Anomaly detection & alerting\n- ‚úÖ Pre-computed dashboard caches\n- ‚úÖ CSV export functionality\n- ‚úÖ No external dependencies (100% Base44)\n\n## Usage\n\n### Accessing Dashboards\nNavigate to Admin Dashboard ‚Üí Analytics Hub to access all dashboards.\n\n### Triggering Manual Analytics Update\nThe cron job runs automatically at 3:00 AM. To trigger manually, call the cronAnalytics function endpoint.\n\n### Creating Custom Alerts\nAlerts are automatically created when metrics exceed 2x baseline. To add custom alert types, update the `runAlertDetection` function in `cronAnalytics.js`.\n\n## Data Retention\n\n- PlatformAnalyticsDaily: 365 days\n- CleanerDailySnapshot: 90 days\n- Event/AnalyticsEvent: No automatic cleanup (consider manual cleanup for very high volumes)\n- DashboardCache: Overwritten nightly\n- SystemAlert: Manual resolution required\n\n## Constants\n\n```javascript\nCREDITS_PER_USD = 10\n```\n\n## KPI Formulas\n\n- **GMV**: Sum of final_charge_credits for completed bookings\n- **Platform Revenue**: GMV √ó 0.15\n- **Cancel Rate**: cancelled_bookings / total_bookings √ó 100\n- **Dispute Rate**: disputed_bookings / completed_bookings √ó 100\n- **MRR**: Sum of monthly_price for all active subscriptions/memberships\n\n## Future Enhancements (v2)\n\n- Cohort analysis\n- Geographic segmentation\n- Customer lifetime value (LTV)\n- More sophisticated churn prediction\n- ML-based demand forecasting","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\automation\\EventBus.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'base44' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"fix":{"range":[248,294],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"base44"},"fix":{"range":[248,292],"text":""},"desc":"Remove unused variable 'base44'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleaner_email' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":63,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleaner_email"},"fix":{"range":[1763,1778],"text":""},"desc":"Remove unused variable 'cleaner_email'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'invoice_id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":254,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":254,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"invoice_id"},"fix":{"range":[6805,6817],"text":""},"desc":"Remove unused variable 'invoice_id'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Event Bus - Section 2 Item 2 & Section 3.1\n * Central event dispatcher for domain events\n * Fans out to notification handlers, reliability updates, and automations\n */\n\nimport NotificationService from '../notifications/NotificationService';\nimport { base44 } from '@/api/base44Client';\n\n/**\n * Event Registry - Maps events to handlers\n */\nconst EVENT_HANDLERS = {\n  // Booking lifecycle events\n  booking_created: [handleBookingCreated],\n  job_invited: [handleJobInvited],\n  job_accepted: [handleJobAccepted],\n  job_checked_in: [handleJobCheckedIn],\n  job_checked_out: [handleJobCheckedOut],\n  job_approved: [handleJobApproved],\n  \n  // Credit events\n  credits_purchased: [handleCreditsPurchased],\n  subscription_renewed: [handleSubscriptionRenewed],\n  subscription_dunning: [handleSubscriptionDunning],\n  \n  // Dispute events\n  dispute_opened: [handleDisputeOpened],\n  dispute_resolved: [handleDisputeResolved],\n  \n  // Payout events\n  payout_sent: [handlePayoutSent],\n  payout_failed: [handlePayoutFailed],\n  \n  // Reliability events\n  reliability_changed: [handleReliabilityChanged]\n};\n\n/**\n * Emit an event and fan out to all handlers\n */\nexport const emit = async (eventName, payload) => {\n  console.log(`[EventBus] Emitting: ${eventName}`, payload);\n\n  const handlers = EVENT_HANDLERS[eventName] || [];\n  \n  const results = await Promise.allSettled(\n    handlers.map(handler => handler(payload))\n  );\n\n  const errors = results.filter(r => r.status === 'rejected');\n  if (errors.length > 0) {\n    console.error(`[EventBus] Errors in ${eventName}:`, errors);\n  }\n\n  return { success: errors.length === 0, errors };\n};\n\n/**\n * Handler: booking_created (Section 3 - Flow A)\n */\nasync function handleBookingCreated(payload) {\n  const { job_id, client_email, cleaner_email, start_at, address, client_name, cleaner_name } = payload;\n\n  // Send confirmation to client\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.booking_confirmed',\n    channel: 'email',\n    payload: {\n      first_name: client_name?.split(' ')[0] || 'there',\n      start_at,\n      address,\n      cleaner_name,\n      link: `https://app.puretask.com/booking/${job_id}`\n    }\n  });\n\n  // Send SMS confirmation\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'sms.booking_confirmed',\n    channel: 'sms',\n    payload: { start_at, address, link: `https://app.puretask.com/booking/${job_id}` }\n  });\n}\n\n/**\n * Handler: job_invited (Section 3 - Flow I)\n */\nasync function handleJobInvited(payload) {\n  const { job_id, cleaner_email } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    job_id,\n    template_key: 'sms.new_job_available',\n    channel: 'sms',\n    payload: { link: `https://app.puretask.com/jobs/${job_id}` }\n  });\n}\n\n/**\n * Handler: job_accepted\n */\nasync function handleJobAccepted(payload) {\n  const { job_id, client_email, cleaner_name } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.job_accepted',\n    channel: 'email',\n    payload: { \n      first_name: payload.client_name?.split(' ')[0] || 'there',\n      cleaner_name,\n      start_at: payload.start_at\n    }\n  });\n}\n\n/**\n * Handler: job_checked_in (Section 3 - Flow D)\n */\nasync function handleJobCheckedIn(payload) {\n  const { job_id, client_email, cleaner_name, eta } = payload;\n\n  // Send \"on the way\" notification\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.cleaner_on_the_way',\n    channel: 'email',\n    payload: {\n      first_name: payload.client_name?.split(' ')[0] || 'there',\n      cleaner_name,\n      eta: eta || 'Soon'\n    },\n    respect_quiet_hours: false // GPS arrival is exempt\n  });\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'sms.on_the_way',\n    channel: 'sms',\n    payload: { cleaner_name, eta: eta || 'Soon' },\n    respect_quiet_hours: false // GPS arrival is exempt\n  });\n}\n\n/**\n * Handler: job_checked_out (Section 3 - Flow E)\n */\nasync function handleJobCheckedOut(payload) {\n  const { job_id, client_email, cleaner_name } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.cleaning_completed',\n    channel: 'email',\n    payload: {\n      first_name: payload.client_name?.split(' ')[0] || 'there',\n      cleaner_name,\n      review_link: `https://app.puretask.com/booking/${job_id}/review`,\n      link: `https://app.puretask.com/booking/${job_id}/approve`\n    }\n  });\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'sms.finished',\n    channel: 'sms',\n    payload: { link: `https://app.puretask.com/booking/${job_id}/approve` }\n  });\n}\n\n/**\n * Handler: job_approved (Section 3 - Flow F)\n */\nasync function handleJobApproved(payload) {\n  const { job_id, client_email, cleaner_email, amount } = payload;\n\n  // Send receipt to client\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.invoice_receipt',\n    channel: 'email',\n    payload: {\n      first_name: payload.client_name?.split(' ')[0] || 'there',\n      amount: Math.round(amount * 10),\n      job_id,\n      date: payload.date || new Date().toLocaleDateString(),\n      cleaner_name: payload.cleaner_name,\n      hours: payload.hours || 0,\n      link: `https://app.puretask.com/booking/${job_id}/receipt`\n    }\n  });\n\n  // Notify cleaner of pending payout\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    job_id,\n    template_key: 'sms.payment_receipt',\n    channel: 'sms',\n    payload: { amount: Math.round(amount * 10) }\n  });\n}\n\n/**\n * Handler: credits_purchased\n */\nasync function handleCreditsPurchased(payload) {\n  const { user_email, credits } = payload;\n\n  await NotificationService.sendNotification({\n    user_email,\n    template_key: 'email.invoice_receipt',\n    channel: 'email',\n    payload: {\n      first_name: payload.first_name || 'there',\n      amount: Math.round(credits * 10)\n    }\n  });\n}\n\n/**\n * Handler: subscription_renewed (Section 3 - Flow 4.3)\n */\nasync function handleSubscriptionRenewed(payload) {\n  const { user_email, plan_name, credits } = payload;\n\n  await NotificationService.sendNotification({\n    user_email,\n    template_key: 'email.subscription_renewed',\n    channel: 'email',\n    payload: {\n      first_name: payload.first_name || 'there',\n      plan_name,\n      credits: Math.round(credits * 10)\n    }\n  });\n}\n\n/**\n * Handler: subscription_dunning (Section 3 - Flow G)\n */\nasync function handleSubscriptionDunning(payload) {\n  const { user_email, invoice_id } = payload;\n\n  await NotificationService.sendNotification({\n    user_email,\n    template_key: 'email.payment_failed',\n    channel: 'email',\n    payload: {\n      first_name: payload.first_name || 'there',\n      manage_link: `https://app.puretask.com/wallet/payment-methods`\n    },\n    respect_quiet_hours: false // Payment failures are urgent\n  });\n\n  await NotificationService.sendNotification({\n    user_email,\n    template_key: 'sms.payment_failed',\n    channel: 'sms',\n    payload: {\n      manage_link: `https://app.puretask.com/wallet/payment-methods`\n    },\n    respect_quiet_hours: false // Payment failures are urgent\n  });\n}\n\n/**\n * Handler: dispute_opened\n */\nasync function handleDisputeOpened(payload) {\n  const { job_id, client_email, cleaner_email } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.dispute_opened',\n    channel: 'email',\n    payload: { job_id }\n  });\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    job_id,\n    template_key: 'email.dispute_opened',\n    channel: 'email',\n    payload: { job_id }\n  });\n}\n\n/**\n * Handler: dispute_resolved\n */\nasync function handleDisputeResolved(payload) {\n  const { job_id, client_email, cleaner_email, resolution_summary } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: client_email,\n    job_id,\n    template_key: 'email.dispute_resolved',\n    channel: 'email',\n    payload: {\n      first_name: payload.client_name?.split(' ')[0] || 'there',\n      job_id,\n      resolution_summary\n    }\n  });\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    job_id,\n    template_key: 'email.dispute_resolved',\n    channel: 'email',\n    payload: {\n      first_name: payload.cleaner_name?.split(' ')[0] || 'there',\n      job_id,\n      resolution_summary\n    }\n  });\n}\n\n/**\n * Handler: payout_sent (Section 3 - Payout Flow)\n */\nasync function handlePayoutSent(payload) {\n  const { cleaner_email, amount } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    template_key: 'email.payout_sent',\n    channel: 'email',\n    payload: {\n      first_name: payload.cleaner_name?.split(' ')[0] || 'there',\n      amount: `$${amount.toFixed(2)}`\n    }\n  });\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    template_key: 'sms.payout_sent',\n    channel: 'sms',\n    payload: { amount: `$${amount.toFixed(2)}` }\n  });\n}\n\n/**\n * Handler: payout_failed\n */\nasync function handlePayoutFailed(payload) {\n  // Admin alert only\n  console.error('Payout failed:', payload);\n}\n\n/**\n * Handler: reliability_changed (Section 3 - Flow H)\n */\nasync function handleReliabilityChanged(payload) {\n  const { cleaner_email, score, tier } = payload;\n\n  await NotificationService.sendNotification({\n    user_email: cleaner_email,\n    template_key: 'sms.reliability_changed',\n    channel: 'sms',\n    payload: { score, tier }\n  });\n}\n\nexport default {\n  emit,\n  EVENT_HANDLERS\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\automation\\QuietHoursEnforcer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":15,"fix":{"range":[443,450],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[444,450],"text":""},"desc":"Remove unused variable 'Clock'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Quiet Hours Enforcer - Section 3.3\n * Manages notification timing based on user timezone\n * \n * Rules:\n * - Suppress SMS/Push 9pm - 8am local time\n * - Exceptions: password_reset, payment_failed, on_the_way, arrived_gps\n * - Queue suppressed messages for next morning\n */\n\nimport React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Clock, Moon, Sun, Shield } from 'lucide-react';\n\nexport const QuietHoursConfig = () => {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-t-2xl\">\n        <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n          <Moon className=\"w-6 h-6 text-indigo-600\" />\n          Quiet Hours Configuration\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          <div className=\"p-4 bg-indigo-50 rounded-2xl border border-indigo-200\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Moon className=\"w-5 h-5 text-indigo-600\" />\n              <span className=\"font-fredoka font-semibold text-graphite\">Quiet Hours</span>\n            </div>\n            <p className=\"text-2xl font-fredoka font-bold text-indigo-600 mb-1\">9:00 PM - 8:00 AM</p>\n            <p className=\"text-sm text-gray-600 font-verdana\">Recipient's local time</p>\n          </div>\n\n          <div className=\"p-4 bg-blue-50 rounded-2xl border border-blue-200\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Sun className=\"w-5 h-5 text-puretask-blue\" />\n              <span className=\"font-fredoka font-semibold text-graphite\">Active Hours</span>\n            </div>\n            <p className=\"text-2xl font-fredoka font-bold text-puretask-blue mb-1\">8:00 AM - 9:00 PM</p>\n            <p className=\"text-sm text-gray-600 font-verdana\">Normal delivery window</p>\n          </div>\n        </div>\n\n        <div>\n          <div className=\"flex items-center gap-2 mb-3\">\n            <Shield className=\"w-5 h-5 text-fresh-mint\" />\n            <h3 className=\"font-fredoka font-semibold text-graphite\">Always-Allowed (Urgent) Messages</h3>\n          </div>\n          <div className=\"flex flex-wrap gap-2\">\n            <Badge className=\"bg-red-100 text-red-700 rounded-full font-verdana\">Password Reset</Badge>\n            <Badge className=\"bg-red-100 text-red-700 rounded-full font-verdana\">Payment Failed</Badge>\n            <Badge className=\"bg-green-100 text-fresh-mint rounded-full font-verdana\">On The Way (GPS)</Badge>\n            <Badge className=\"bg-green-100 text-fresh-mint rounded-full font-verdana\">Arrived (GPS)</Badge>\n            <Badge className=\"bg-purple-100 text-purple-700 rounded-full font-verdana\">Admin Alerts</Badge>\n          </div>\n        </div>\n\n        <div className=\"p-4 bg-amber-50 rounded-2xl border border-amber-200\">\n          <p className=\"text-sm text-amber-900 font-verdana\">\n            <strong>Note:</strong> Suppressed messages are queued and sent at 8:00 AM local time the next morning. Email is not affected by quiet hours.\n          </p>\n        </div>\n\n        <div className=\"p-4 bg-soft-cloud rounded-2xl\">\n          <h3 className=\"font-fredoka font-semibold text-graphite mb-2\">Batching Window</h3>\n          <p className=\"text-gray-600 font-verdana text-sm\">\n            Non-urgent notifications are batched within a 30-second window by channel to reduce noise and improve user experience.\n          </p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default QuietHoursConfig;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\badges\\VerifiedBadges.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\blocking\\BlockCleanerButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\AIPersonalizedRecommendations.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"fix":{"range":[133,182],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[133,181],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":6,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"fix":{"range":[312,324],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[311,323],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'format' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"fix":{"range":[446,454],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"format"},"fix":{"range":[447,454],"text":""},"desc":"Remove unused variable 'format'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onSelectTime' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":87,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":99,"suggestions":[{"messageId":"removeVar","data":{"varName":"onSelectTime"},"fix":{"range":[568,582],"text":""},"desc":"Remove unused variable 'onSelectTime'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'clientProfile' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"clientProfile"},"fix":{"range":[724,737],"text":""},"desc":"Remove unused variable 'clientProfile'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingHistory' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingHistory"},"fix":{"range":[784,798],"text":""},"desc":"Remove unused variable 'bookingHistory'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { base44 } from '@/api/base44Client';\nimport { Sparkles, Clock, Star, Heart, DollarSign, Calendar, TrendingUp, Gift, Loader2, ChevronRight } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format, getHours } from 'date-fns';\n\nexport default function AIPersonalizedRecommendations({ clientEmail, onSelectCleaner, onSelectTime, onSelectAddOn }) {\n  const [recommendations, setRecommendations] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [bookingHistory, setBookingHistory] = useState([]);\n\n  useEffect(() => {\n    if (clientEmail) {\n      loadRecommendations();\n    }\n  }, [clientEmail]);\n\n  const loadRecommendations = async () => {\n    try {\n      setLoading(true);\n\n      // Load client profile\n      const profiles = await base44.entities.ClientProfile.filter({ user_email: clientEmail });\n      const profile = profiles[0];\n      setClientProfile(profile);\n\n      // Load booking history\n      const bookings = await base44.entities.Booking.filter(\n        { client_email: clientEmail, status: { $in: ['completed', 'approved'] } },\n        '-date',\n        20\n      );\n      setBookingHistory(bookings);\n\n      // Analyze patterns\n      const recommendations = await analyzeAndRecommend(profile, bookings);\n      setRecommendations(recommendations);\n    } catch (error) {\n      console.error('Error loading recommendations:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const analyzeAndRecommend = async (profile, bookings) => {\n    // Analyze booking patterns\n    const preferredDays = {};\n    const preferredTimes = {};\n    const cleanerFrequency = {};\n    const serviceTypes = {};\n    const addOns = {};\n\n    bookings.forEach(booking => {\n      // Day preferences\n      const day = new Date(booking.date).getDay();\n      preferredDays[day] = (preferredDays[day] || 0) + 1;\n\n      // Time preferences\n      const hour = getHours(new Date(`2000-01-01T${booking.start_time}`));\n      const timeSlot = hour < 12 ? 'morning' : hour < 17 ? 'afternoon' : 'evening';\n      preferredTimes[timeSlot] = (preferredTimes[timeSlot] || 0) + 1;\n\n      // Cleaner preferences\n      if (booking.cleaner_email) {\n        cleanerFrequency[booking.cleaner_email] = (cleanerFrequency[booking.cleaner_email] || 0) + 1;\n      }\n\n      // Service types\n      serviceTypes[booking.cleaning_type] = (serviceTypes[booking.cleaning_type] || 0) + 1;\n\n      // Add-ons\n      if (booking.additional_services) {\n        Object.keys(booking.additional_services).forEach(service => {\n          addOns[service] = (addOns[service] || 0) + 1;\n        });\n      }\n    });\n\n    // Get most preferred day\n    const topDay = Object.entries(preferredDays).sort((a, b) => b[1] - a[1])[0];\n    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    const preferredDay = topDay ? dayNames[topDay[0]] : null;\n\n    // Get most preferred time\n    const topTime = Object.entries(preferredTimes).sort((a, b) => b[1] - a[1])[0];\n    const preferredTimeSlot = topTime ? topTime[0] : 'morning';\n\n    // Get favorite cleaners\n    const topCleaners = Object.entries(cleanerFrequency)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 3);\n    \n    const favoriteCleanerEmails = topCleaners.map(([email]) => email);\n    const favoriteCleaners = [];\n    for (const email of favoriteCleanerEmails) {\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: email });\n      if (cleanerProfiles.length > 0) {\n        favoriteCleaners.push(cleanerProfiles[0]);\n      }\n    }\n\n    // Get frequently used add-ons\n    const topAddOns = Object.entries(addOns)\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 3)\n      .map(([service]) => service);\n\n    // Determine promotional offer\n    const totalBookings = bookings.length;\n    let promotionalOffer = null;\n    \n    if (totalBookings === 0) {\n      promotionalOffer = {\n        type: 'first_booking',\n        title: 'Welcome Bonus',\n        description: 'Get 15% off your first booking!',\n        discount: 15,\n        code: 'WELCOME15'\n      };\n    } else if (totalBookings >= 5 && !profile.membership_active) {\n      promotionalOffer = {\n        type: 'membership',\n        title: 'Upgrade to Plus',\n        description: 'Save 10% on all bookings with Plus membership',\n        discount: 10\n      };\n    } else if (totalBookings >= 3) {\n      const lastBooking = bookings[0];\n      const daysSinceLastBooking = Math.floor((Date.now() - new Date(lastBooking.date)) / (1000 * 60 * 60 * 24));\n      \n      if (daysSinceLastBooking > 60) {\n        promotionalOffer = {\n          type: 'comeback',\n          title: 'We Miss You!',\n          description: 'Get 20% off your next booking',\n          discount: 20,\n          code: 'COMEBACK20'\n        };\n      }\n    }\n\n    return {\n      favoriteCleaners,\n      preferredDay,\n      preferredTimeSlot,\n      topAddOns,\n      promotionalOffer,\n      bookingCount: totalBookings,\n      patterns: {\n        hasPattern: totalBookings >= 3,\n        frequency: totalBookings >= 5 ? 'regular' : totalBookings >= 2 ? 'occasional' : 'new'\n      }\n    };\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-2 border-purple-200\">\n        <CardContent className=\"p-8 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-purple-500 mx-auto mb-3\" />\n          <p className=\"text-sm text-gray-600 font-verdana\">Analyzing your preferences...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!recommendations || !recommendations.patterns.hasPattern) {\n    return null;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* AI Badge */}\n      <div className=\"flex items-center gap-2\">\n        <Sparkles className=\"w-5 h-5 text-purple-500\" />\n        <h3 className=\"text-lg font-fredoka font-bold text-graphite\">AI Recommendations</h3>\n        <Badge className=\"bg-purple-500 text-white border-0 font-fredoka\">Personalized</Badge>\n      </div>\n\n      {/* Promotional Offer */}\n      {recommendations.promotionalOffer && (\n        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>\n          <Card className=\"border-2 border-green-300 bg-gradient-to-r from-green-50 to-emerald-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"bg-green-500 p-2 rounded-lg\">\n                  <Gift className=\"w-5 h-5 text-white\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h4 className=\"font-fredoka font-bold text-graphite mb-1\">\n                    {recommendations.promotionalOffer.title}\n                  </h4>\n                  <p className=\"text-sm text-gray-700 font-verdana mb-2\">\n                    {recommendations.promotionalOffer.description}\n                  </p>\n                  {recommendations.promotionalOffer.code && (\n                    <Badge className=\"bg-green-600 text-white border-0 font-fredoka\">\n                      Code: {recommendations.promotionalOffer.code}\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n\n      {/* Favorite Cleaners */}\n      {recommendations.favoriteCleaners.length > 0 && (\n        <Card className=\"border-2 border-blue-200\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-fredoka flex items-center gap-2\">\n              <Heart className=\"w-4 h-4 text-red-500 fill-current\" />\n              Your Favorite Cleaners\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2\">\n            {recommendations.favoriteCleaners.slice(0, 2).map((cleaner, idx) => (\n              <motion.div\n                key={idx}\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: idx * 0.1 }}\n                className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg hover:bg-blue-100 transition-all cursor-pointer\"\n                onClick={() => onSelectCleaner && onSelectCleaner(cleaner)}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold\">\n                    {cleaner.full_name?.charAt(0) || 'C'}\n                  </div>\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite text-sm\">{cleaner.full_name}</p>\n                    <div className=\"flex items-center gap-1\">\n                      <Star className=\"w-3 h-3 text-yellow-500 fill-current\" />\n                      <span className=\"text-xs text-gray-600 font-verdana\">{cleaner.average_rating?.toFixed(1)}</span>\n                    </div>\n                  </div>\n                </div>\n                <ChevronRight className=\"w-4 h-4 text-gray-400\" />\n              </motion.div>\n            ))}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Optimal Timing */}\n      {recommendations.preferredDay && (\n        <Card className=\"border-2 border-cyan-200\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-fredoka flex items-center gap-2\">\n              <Clock className=\"w-4 h-4 text-cyan-600\" />\n              Best Time for You\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center justify-between p-3 bg-cyan-50 rounded-lg\">\n              <div>\n                <p className=\"text-sm font-verdana text-gray-700 mb-1\">\n                  You usually book on <span className=\"font-semibold\">{recommendations.preferredDay}</span>\n                </p>\n                <p className=\"text-sm font-verdana text-gray-700\">\n                  in the <span className=\"font-semibold capitalize\">{recommendations.preferredTimeSlot}</span>\n                </p>\n              </div>\n              <Calendar className=\"w-8 h-8 text-cyan-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Recommended Add-ons */}\n      {recommendations.topAddOns.length > 0 && (\n        <Card className=\"border-2 border-amber-200\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-fredoka flex items-center gap-2\">\n              <TrendingUp className=\"w-4 h-4 text-amber-600\" />\n              Services You Love\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex flex-wrap gap-2\">\n              {recommendations.topAddOns.map((addOn, idx) => (\n                <Badge\n                  key={idx}\n                  className=\"bg-amber-100 text-amber-800 border-amber-300 font-verdana cursor-pointer hover:bg-amber-200\"\n                  onClick={() => onSelectAddOn && onSelectAddOn(addOn)}\n                >\n                  {addOn.replace('_', ' ')}\n                </Badge>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\AdditionalServicesSelector.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[171,218],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[171,217],"text":""},"desc":"Remove unused variable 'Input'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ADDITIONAL_SERVICES } from '../cleaner/AdditionalServicesPricingEditor';\nimport { Plus, Minus, Info } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function AdditionalServicesSelector({ \n  cleanerPricing, \n  selectedServices, \n  onServicesChange \n}) {\n  const [quantities, setQuantities] = useState(selectedServices || {});\n\n  // Filter to only show services the cleaner offers\n  const availableServices = ADDITIONAL_SERVICES.filter(service => \n    cleanerPricing && cleanerPricing[service.key] && cleanerPricing[service.key] > 0\n  );\n\n  if (availableServices.length === 0) {\n    return null; // Don't show if cleaner doesn't offer any additional services\n  }\n\n  const handleQuantityChange = (serviceKey, delta) => {\n    const currentQty = quantities[serviceKey] || 0;\n    const newQty = Math.max(0, currentQty + delta);\n    \n    const newQuantities = { ...quantities };\n    if (newQty === 0) {\n      delete newQuantities[serviceKey];\n    } else {\n      newQuantities[serviceKey] = newQty;\n    }\n    \n    setQuantities(newQuantities);\n    onServicesChange(newQuantities);\n  };\n\n  const calculateTotal = () => {\n    let total = 0;\n    Object.keys(quantities).forEach(key => {\n      if (cleanerPricing[key]) {\n        total += quantities[key] * cleanerPricing[key];\n      }\n    });\n    return total;\n  };\n\n  const totalCredits = calculateTotal();\n\n  return (\n    <Card className=\"border-0 shadow-lg rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Info className=\"w-5 h-5 text-purple-600\" />\n          Additional Services (Optional)\n        </CardTitle>\n        <p className=\"text-sm text-gray-600 font-verdana mt-2\">\n          Add extra services to your booking - these are one-time charges\n        </p>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <div className=\"grid md:grid-cols-2 gap-4 mb-6\">\n          {availableServices.map((service) => {\n            const price = cleanerPricing[service.key];\n            const quantity = quantities[service.key] || 0;\n            const isSelected = quantity > 0;\n\n            return (\n              <motion.div\n                key={service.key}\n                layout\n                initial={{ opacity: 0, scale: 0.95 }}\n                animate={{ opacity: 1, scale: 1 }}\n              >\n                <Card \n                  className={`border-2 transition-all cursor-pointer rounded-2xl ${\n                    isSelected ? 'ring-2 shadow-lg' : 'hover:shadow-md'\n                  }`}\n                  style={{ \n                    backgroundColor: service.bgColor,\n                    borderColor: service.color,\n                    ringColor: isSelected ? service.color : 'transparent'\n                  }}\n                  onClick={() => handleQuantityChange(service.key, quantity === 0 ? 1 : 0)}\n                >\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-10 h-10 rounded-xl flex items-center justify-center\" style={{ backgroundColor: service.color }}>\n                          <service.icon className=\"w-5 h-5 text-white\" />\n                        </div>\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite\">{service.name}</p>\n                          <p className=\"text-xs text-gray-600 font-verdana\">{service.unit}</p>\n                        </div>\n                      </div>\n                      <Badge className=\"font-fredoka font-semibold\" style={{ backgroundColor: service.color, color: 'white' }}>\n                        {price} credits\n                      </Badge>\n                    </div>\n\n                    <AnimatePresence>\n                      {isSelected && (\n                        <motion.div\n                          initial={{ opacity: 0, height: 0 }}\n                          animate={{ opacity: 1, height: 'auto' }}\n                          exit={{ opacity: 0, height: 0 }}\n                          className=\"mt-4 pt-4 border-t\"\n                          style={{ borderColor: service.color }}\n                          onClick={(e) => e.stopPropagation()}\n                        >\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm font-fredoka font-semibold text-graphite\">Quantity</span>\n                            <div className=\"flex items-center gap-3\">\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleQuantityChange(service.key, -1);\n                                }}\n                                className=\"w-8 h-8 rounded-full p-0\"\n                                style={{ borderColor: service.color, color: service.color }}\n                              >\n                                <Minus className=\"w-4 h-4\" />\n                              </Button>\n                              <span className=\"text-lg font-fredoka font-bold\" style={{ color: service.color }}>\n                                {quantity}\n                              </span>\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleQuantityChange(service.key, 1);\n                                }}\n                                className=\"w-8 h-8 rounded-full p-0\"\n                                style={{ borderColor: service.color, color: service.color }}\n                              >\n                                <Plus className=\"w-4 h-4\" />\n                              </Button>\n                            </div>\n                          </div>\n                          <p className=\"text-xs text-gray-600 font-verdana mt-2 text-right\">\n                            Subtotal: {quantity * price} credits (${(quantity * price).toFixed(2)})\n                          </p>\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n\n                    {!isSelected && (\n                      <p className=\"text-xs text-gray-500 font-verdana text-center mt-2\">\n                        Click to add\n                      </p>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </div>\n\n        {totalCredits > 0 && (\n          <Alert className=\"rounded-2xl border-2\" style={{ backgroundColor: '#F0FDF4', borderColor: '#86EFAC' }}>\n            <AlertDescription className=\"flex items-center justify-between font-verdana\">\n              <span className=\"font-fredoka font-bold text-graphite\">Additional Services Total:</span>\n              <div className=\"text-right\">\n                <p className=\"text-2xl font-fredoka font-bold\" style={{ color: '#28C76F' }}>\n                  {totalCredits} credits\n                </p>\n                <p className=\"text-sm text-gray-600\">\n                  ‚âà ${totalCredits.toFixed(2)}\n                </p>\n              </div>\n            </AlertDescription>\n          </Alert>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\AutoApprovalWarning.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\AutoSaveIndicator.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CloudOff' is defined but never used.","line":3,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":25,"fix":{"range":[124,134],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CloudOff"},"fix":{"range":[123,133],"text":""},"desc":"Remove unused variable 'CloudOff'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Cloud, CloudOff, CheckCircle } from 'lucide-react';\n\nexport default function AutoSaveIndicator({ isSaving, lastSaved }) {\n  const [showSaved, setShowSaved] = useState(false);\n\n  useEffect(() => {\n    if (!isSaving && lastSaved) {\n      setShowSaved(true);\n      const timer = setTimeout(() => setShowSaved(false), 2000);\n      return () => clearTimeout(timer);\n    }\n  }, [isSaving, lastSaved]);\n\n  return (\n    <div className=\"fixed bottom-6 left-6 z-50\">\n      <AnimatePresence mode=\"wait\">\n        {isSaving && (\n          <motion.div\n            key=\"saving\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            className=\"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-full shadow-lg\"\n          >\n            <Cloud className=\"w-4 h-4 animate-pulse\" />\n            <span className=\"text-sm font-fredoka\">Saving...</span>\n          </motion.div>\n        )}\n        \n        {showSaved && !isSaving && (\n          <motion.div\n            key=\"saved\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            className=\"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-full shadow-lg\"\n          >\n            <CheckCircle className=\"w-4 h-4\" />\n            <span className=\"text-sm font-fredoka\">Saved</span>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\AvailabilityEnforcement.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BackupCleanerFinder.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookAgainButton.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36,"fix":{"range":[24,35],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[24,35],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { RefreshCw, Calendar as CalendarIcon, Clock, MapPin, Sparkles } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport { Badge } from '@/components/ui/badge';\n\nexport default function BookAgainButton({ lastBooking, cleanerProfile, variant = 'default', className = '' }) {\n  const navigate = useNavigate();\n  const [showDialog, setShowDialog] = useState(false);\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [selectedTime, setSelectedTime] = useState(lastBooking?.start_time || '09:00');\n  const [loading, setLoading] = useState(false);\n\n  const timeSlots = [\n    '08:00', '08:30', '09:00', '09:30', '10:00', '10:30',\n    '11:00', '11:30', '12:00', '12:30', '13:00', '13:30',\n    '14:00', '14:30', '15:00', '15:30', '16:00', '16:30', '17:00'\n  ];\n\n  const handleBookAgain = async () => {\n    if (!selectedDate || !selectedTime) return;\n    \n    setLoading(true);\n    try {\n      // Create draft booking with all previous details\n      const draft = await base44.entities.DraftBooking.create({\n        client_email: lastBooking.client_email,\n        cleaner_email: lastBooking.cleaner_email,\n        fallback_cleaners: lastBooking.fallback_cleaners || [],\n        current_step: 4, // Skip to review step\n        date: format(selectedDate, 'yyyy-MM-dd'),\n        start_time: selectedTime,\n        hours: lastBooking.hours,\n        tasks: lastBooking.tasks,\n        task_quantities: lastBooking.task_quantities || {},\n        address: lastBooking.address,\n        latitude: lastBooking.latitude,\n        longitude: lastBooking.longitude,\n        bedrooms: lastBooking.bedrooms || 0,\n        bathrooms: lastBooking.bathrooms || 0,\n        square_feet: lastBooking.square_feet || 0,\n        home_type: lastBooking.home_type || 'apartment',\n        has_pets: lastBooking.has_pets || false,\n        allergy_severity: lastBooking.allergy_severity || 'none',\n        product_allergies_text: lastBooking.product_allergies_text || '',\n        specific_allergies_list: lastBooking.specific_allergies_list || [],\n        product_preferences: lastBooking.product_preferences || '',\n        parking_instructions: lastBooking.parking_instructions || '',\n        entry_instructions: lastBooking.entry_instructions || '',\n        total_price: lastBooking.total_price\n      });\n\n      // Navigate to payment step\n      navigate(createPageUrl('BookingFlow') + `?draft=${draft.id}&step=4`);\n    } catch (error) {\n      console.error('Error creating repeat booking:', error);\n    }\n    setLoading(false);\n  };\n\n  if (!lastBooking || !cleanerProfile) return null;\n\n  return (\n    <>\n      <Button\n        onClick={() => setShowDialog(true)}\n        variant={variant}\n        className={`${variant === 'default' ? 'bg-emerald-500 hover:bg-emerald-600 text-white' : ''} ${className}`}\n      >\n        <RefreshCw className=\"w-4 h-4 mr-2\" />\n        Book {cleanerProfile.full_name} Again\n      </Button>\n\n      <Dialog open={showDialog} onOpenChange={setShowDialog}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"text-2xl flex items-center gap-2\">\n              <Sparkles className=\"w-6 h-6 text-emerald-500\" />\n              Book {cleanerProfile.full_name} Again\n            </DialogTitle>\n            <p className=\"text-sm text-slate-600 mt-2\">\n              We'll use all your previous details. Just pick a date and time!\n            </p>\n          </DialogHeader>\n\n          <div className=\"space-y-6 py-4\">\n            {/* Quick Summary of What's Being Booked */}\n            <div className=\"p-4 bg-gradient-to-br from-emerald-50 to-green-50 rounded-lg border-2 border-emerald-200\">\n              <p className=\"text-sm font-semibold text-emerald-900 mb-3 flex items-center gap-2\">\n                <CalendarIcon className=\"w-4 h-4\" />\n                Booking Summary:\n              </p>\n              <div className=\"grid md:grid-cols-2 gap-3\">\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <Clock className=\"w-4 h-4 text-emerald-600\" />\n                  <span className=\"text-slate-700\">{lastBooking.hours} hours cleaning</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <MapPin className=\"w-4 h-4 text-emerald-600\" />\n                  <span className=\"text-slate-700 truncate\">{lastBooking.address}</span>\n                </div>\n              </div>\n              <div className=\"mt-3 pt-3 border-t border-emerald-200\">\n                <div className=\"flex flex-wrap gap-2\">\n                  {lastBooking.tasks?.slice(0, 4).map((task, idx) => (\n                    <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n                      {task.replace(/_/g, ' ')}\n                    </Badge>\n                  ))}\n                  {lastBooking.tasks?.length > 4 && (\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      +{lastBooking.tasks.length - 4} more\n                    </Badge>\n                  )}\n                </div>\n              </div>\n              <div className=\"mt-3 text-right\">\n                <span className=\"text-2xl font-bold text-emerald-600\">\n                  ${lastBooking.total_price.toFixed(2)}\n                </span>\n              </div>\n            </div>\n\n            {/* Date Selection */}\n            <div>\n              <label className=\"text-sm font-semibold text-slate-900 mb-3 block\">\n                Select Date\n              </label>\n              <div className=\"flex justify-center\">\n                <Calendar\n                  mode=\"single\"\n                  selected={selectedDate}\n                  onSelect={setSelectedDate}\n                  disabled={(date) => date < new Date()}\n                  className=\"rounded-lg border-2 border-slate-200\"\n                />\n              </div>\n            </div>\n\n            {/* Time Selection */}\n            <div>\n              <label className=\"text-sm font-semibold text-slate-900 mb-2 block\">\n                Select Time\n              </label>\n              <Select value={selectedTime} onValueChange={setSelectedTime}>\n                <SelectTrigger className=\"border-2 border-slate-200\">\n                  <SelectValue placeholder=\"Choose a time\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {timeSlots.map(time => (\n                    <SelectItem key={time} value={time}>\n                      {convertTo12Hour(time)}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <DialogFooter className=\"gap-2\">\n            <Button variant=\"outline\" onClick={() => setShowDialog(false)} disabled={loading}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleBookAgain}\n              disabled={!selectedDate || !selectedTime || loading}\n              className=\"bg-emerald-500 hover:bg-emerald-600\"\n            >\n              {loading ? (\n                <>\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\" />\n                  Processing...\n                </>\n              ) : (\n                'Continue to Payment'\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingActions.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":4,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":57,"fix":{"range":[133,148],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[132,147],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleConfirmBooking' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":144,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":144,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleConfirmBooking"},"fix":{"range":[5169,5955],"text":""},"desc":"Remove unused variable 'handleConfirmBooking'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Calendar, XCircle, AlertTriangle, MessageSquare, Receipt, CheckCircle2, X } from 'lucide-react'; // Added CheckCircle2 and X for accept/decline icons\nimport RescheduleBooking from './RescheduleBooking';\nimport CancellationPolicy from './CancellationPolicy';\nimport DisputeForm from '../disputes/DisputeForm';\nimport ReceiptModal from '../receipts/ReceiptModal';\n\n// Assuming base44 is a custom utility or API client.\n// This import path is a common convention; adjust if your project uses a different path.\nimport * as base44 from '@/lib/base44';\n\nexport default function BookingActions({ booking, userEmail, userType, cleanerAvailability, onUpdate }) {\n  const [showReschedule, setShowReschedule] = useState(false);\n  const [showCancel, setShowCancel] = useState(false);\n  const [showDispute, setShowDispute] = useState(false);\n  const [showReceipt, setShowReceipt] = useState(false);\n\n  // New state for handling accept/decline actions\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const canReschedule = () => {\n    return booking.status === 'pending_confirmation' || booking.status === 'confirmed';\n  };\n\n  const canCancel = () => {\n    return booking.status !== 'completed' && booking.status !== 'cancelled' && booking.status !== 'disputed';\n  };\n\n  const canDispute = () => {\n    return booking.status === 'completed' && userType === 'client';\n  };\n\n  const canViewReceipt = () => {\n    return booking.status === 'completed';\n  };\n\n  // New conditions for cleaner actions\n  const canAcceptDecline = () => {\n    // Only cleaner can accept/decline if booking is awaiting cleaner confirmation\n    return userType === 'cleaner' && booking.cleaner_email === userEmail && booking.status === 'pending_confirmation' && !booking.cleaner_confirmed;\n  };\n\n  const handleAccept = async () => {\n    if (!booking) return;\n    setLoading(true);\n    setError('');\n\n    try {\n      await base44.entities.Booking.update(booking.id, {\n        cleaner_confirmed: true,\n        status: booking.client_confirmed ? 'scheduled' : 'awaiting_client_confirmation' // Ensure status logic is correct\n      });\n\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'cleaner_confirmed',\n        user_email: booking.cleaner_email,\n        details: 'Cleaner confirmed the booking',\n        timestamp: new Date().toISOString()\n      });\n\n      // ADDED: Send notification to client\n      try {\n        const clientUsers = await base44.entities.User.filter({ email: booking.client_email });\n        if (clientUsers.length > 0 && clientUsers[0].sms_consent) { // Assuming sms_consent implies email consent or general notification preference\n          await base44.integrations.Core.SendEmail({\n            to: booking.client_email,\n            subject: '‚úÖ Cleaner Confirmed Your Booking!',\n            body: `Great news! Your cleaner has accepted your booking:\n\nDate: ${booking.date}\nTime: ${booking.start_time}\nAddress: ${booking.address}\n\nYour booking is now confirmed. You'll receive a reminder 24 hours before.`\n          });\n        }\n      } catch (notifErr) {\n        console.error('Failed to notify client:', notifErr);\n      }\n\n      if (onUpdate) onUpdate();\n    } catch (err) {\n      console.error('Error accepting booking:', err);\n      setError('Failed to accept booking');\n    }\n    setLoading(false);\n  };\n\n  const handleDecline = async () => {\n    if (!booking) return;\n    setLoading(true);\n    setError('');\n\n    try {\n      // Existing booking update logic (implied by \"keep existing code until after booking update\")\n      await base44.entities.Booking.update(booking.id, {\n        cleaner_confirmed: false,\n        status: 'declined_by_cleaner' // Assuming this is the status for a declined booking\n      });\n\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'cleaner_declined',\n        user_email: booking.cleaner_email,\n        details: 'Cleaner declined the booking',\n        timestamp: new Date().toISOString()\n      });\n\n      // ADDED: Send notification to client\n      try {\n        const clientUsers = await base44.entities.User.filter({ email: booking.client_email });\n        if (clientUsers.length > 0 && clientUsers[0].sms_consent) { // Assuming sms_consent implies email consent or general notification preference\n          await base44.integrations.Core.SendEmail({\n            to: booking.client_email,\n            subject: '‚ùå Cleaner Declined Your Booking',\n            body: `Unfortunately, your cleaner had to decline your booking:\n\nDate: ${booking.date}\nTime: ${booking.start_time}\n\nDon't worry! You can:\n1. Browse for another cleaner\n2. Or we'll help you find a backup cleaner\n\nYour payment has not been charged.`\n          });\n        }\n      } catch (notifErr) {\n        console.error('Failed to notify client:', notifErr);\n      }\n\n      if (onUpdate) onUpdate();\n    } catch (err) {\n      console.error('Error declining booking:', err);\n      setError('Failed to decline booking');\n    }\n    setLoading(false);\n  };\n\n  const handleConfirmBooking = async () => {\n    try {\n      const updateField = userType === 'client' ? 'client_confirmed' : 'cleaner_confirmed';\n      \n      await base44.entities.Booking.update(booking.id, {\n        [updateField]: true\n      });\n\n      // Check if both parties have confirmed\n      const updatedBooking = await base44.entities.Booking.get(booking.id);\n      \n      if (updatedBooking.client_confirmed && updatedBooking.cleaner_confirmed) {\n        // Import the confirmation service dynamically\n        const { checkAndSendConfirmation } = await import('./BookingConfirmationService');\n        await checkAndSendConfirmation(booking.id);\n      }\n\n      if (onUpdate) onUpdate();\n    } catch (error) {\n      console.error('Error confirming booking:', error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-wrap gap-2\">\n      {canAcceptDecline() && (\n        <>\n          <Button\n            variant=\"outline\"\n            onClick={handleAccept}\n            className=\"flex items-center gap-2 text-green-600 border-green-200 hover:bg-green-50\"\n            disabled={loading}\n          >\n            <CheckCircle2 className=\"w-4 h-4\" />\n            {loading ? 'Accepting...' : 'Accept Booking'}\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={handleDecline}\n            className=\"flex items-center gap-2 text-red-600 border-red-200 hover:bg-red-50\"\n            disabled={loading}\n          >\n            <X className=\"w-4 h-4\" />\n            {loading ? 'Declining...' : 'Decline Booking'}\n          </Button>\n          {error && <p className=\"text-red-500 text-sm\">{error}</p>}\n        </>\n      )}\n\n      {canReschedule() && (\n        <Button\n          variant=\"outline\"\n          onClick={() => setShowReschedule(true)}\n          className=\"flex items-center gap-2\"\n          disabled={loading}\n        >\n          <Calendar className=\"w-4 h-4\" />\n          Reschedule\n        </Button>\n      )}\n\n      {canCancel() && (\n        <Button\n          variant=\"outline\"\n          onClick={() => setShowCancel(true)}\n          className=\"flex items-center gap-2 text-red-600 border-red-200 hover:bg-red-50\"\n          disabled={loading}\n        >\n          <XCircle className=\"w-4 h-4\" />\n          Cancel\n        </Button>\n      )}\n\n      {canDispute() && (\n        <Button\n          variant=\"outline\"\n          onClick={() => setShowDispute(true)}\n          className=\"flex items-center gap-2 text-amber-600 border-amber-200 hover:bg-amber-50\"\n          disabled={loading}\n        >\n          <AlertTriangle className=\"w-4 h-4\" />\n          File Dispute\n        </Button>\n      )}\n\n      {canViewReceipt() && (\n        <Button\n          variant=\"outline\"\n          onClick={() => setShowReceipt(true)}\n          className=\"flex items-center gap-2\"\n          disabled={loading}\n        >\n          <Receipt className=\"w-4 h-4\" />\n          View Receipt\n        </Button>\n      )}\n\n      {/* Modals */}\n      {showReschedule && (\n        <RescheduleBooking\n          booking={booking}\n          cleanerAvailability={cleanerAvailability}\n          open={showReschedule}\n          onClose={() => setShowReschedule(false)}\n          onRescheduled={() => {\n            setShowReschedule(false);\n            if (onUpdate) onUpdate();\n          }}\n        />\n      )}\n\n      {showCancel && (\n        <CancellationPolicy\n          booking={booking}\n          userEmail={userEmail}\n          userType={userType}\n          open={showCancel}\n          onClose={() => setShowCancel(false)}\n          onCancelled={() => {\n            setShowCancel(false);\n            if (onUpdate) onUpdate();\n          }}\n        />\n      )}\n\n      {showDispute && (\n        <DisputeForm\n          booking={booking}\n          userEmail={userEmail}\n          filedBy={userType}\n          open={showDispute}\n          onClose={() => setShowDispute(false)}\n          onSubmitted={() => {\n            setShowDispute(false);\n            if (onUpdate) onUpdate();\n          }}\n        />\n      )}\n\n      {showReceipt && (\n        <ReceiptModal\n          booking={booking}\n          open={showReceipt}\n          onClose={() => setShowReceipt(false)}\n        />\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingCalendar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingCart.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Sparkles' is defined but never used.","line":6,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":69,"fix":{"range":[328,338],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Sparkles"},"fix":{"range":[327,337],"text":""},"desc":"Remove unused variable 'Sparkles'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ShoppingCart, Trash2, Edit, Calendar, Clock, Home, Sparkles, Tag } from 'lucide-react';\nimport { format } from 'date-fns';\n\nexport default function BookingCart({ \n  bookings, \n  onRemoveBooking, \n  onEditBooking, \n  appliedOffer,\n  totalOriginalPrice,\n  totalDiscount,\n  finalTotalPrice \n}) {\n  \n  const getServiceTypeLabel = (type) => {\n    const labels = {\n      basic: 'Basic Cleaning',\n      deep: 'Deep Cleaning',\n      moveout: 'Move-Out Cleaning'\n    };\n    return labels[type] || type;\n  };\n\n  const getServiceTypeBadge = (type) => {\n    const styles = {\n      basic: 'bg-blue-100 text-blue-800',\n      deep: 'bg-amber-100 text-amber-800',\n      moveout: 'bg-purple-100 text-purple-800'\n    };\n    return styles[type] || 'bg-gray-100 text-gray-800';\n  };\n\n  if (bookings.length === 0) {\n    return (\n      <Card className=\"border-2 border-gray-200 rounded-2xl\">\n        <CardContent className=\"py-12 text-center\">\n          <ShoppingCart className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-fredoka font-bold text-graphite mb-2\">\n            Your Cart is Empty\n          </h3>\n          <p className=\"text-sm text-gray-600 font-verdana\">\n            Add bookings to get started\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-2 border-puretask-blue rounded-2xl shadow-lg sticky top-20\">\n      <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <ShoppingCart className=\"w-5 h-5 text-puretask-blue\" />\n          Booking Cart ({bookings.length})\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-4 space-y-4 max-h-[60vh] overflow-y-auto\">\n        {/* Bookings List */}\n        {bookings.map((booking, index) => (\n          <div \n            key={index} \n            className=\"border-2 border-gray-200 rounded-xl p-3 hover:border-puretask-blue transition-all\"\n          >\n            <div className=\"flex items-start justify-between mb-2\">\n              <Badge className={`${getServiceTypeBadge(booking.serviceType)} font-fredoka`}>\n                {getServiceTypeLabel(booking.serviceType)}\n              </Badge>\n              <div className=\"flex gap-1\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => onEditBooking(index)}\n                  className=\"h-7 w-7 p-0 hover:bg-blue-50\"\n                >\n                  <Edit className=\"w-3 h-3 text-puretask-blue\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => onRemoveBooking(index)}\n                  className=\"h-7 w-7 p-0 hover:bg-red-50\"\n                >\n                  <Trash2 className=\"w-3 h-3 text-red-600\" />\n                </Button>\n              </div>\n            </div>\n            \n            <div className=\"space-y-1 text-sm font-verdana\">\n              <div className=\"flex items-center gap-2 text-gray-700\">\n                <Calendar className=\"w-3 h-3\" />\n                {format(new Date(booking.date), 'MMM d, yyyy')}\n              </div>\n              <div className=\"flex items-center gap-2 text-gray-700\">\n                <Clock className=\"w-3 h-3\" />\n                {booking.time} ‚Ä¢ {booking.hours}h\n              </div>\n              <div className=\"flex items-center gap-2 text-gray-700\">\n                <Home className=\"w-3 h-3\" />\n                {booking.address.split(',')[0]}\n              </div>\n            </div>\n\n            <div className=\"mt-2 pt-2 border-t flex justify-between items-center\">\n              <span className=\"text-xs text-gray-500 font-verdana\">Estimated</span>\n              <span className=\"font-fredoka font-bold text-puretask-blue\">\n                {booking.estimatedCredits} credits\n              </span>\n            </div>\n          </div>\n        ))}\n\n        {/* Applied Offer */}\n        {appliedOffer && (\n          <Alert className=\"border-green-200 bg-green-50 rounded-xl\">\n            <Tag className=\"w-4 h-4 text-green-600\" />\n            <AlertDescription className=\"text-sm font-verdana\">\n              <span className=\"font-semibold text-green-800\">{appliedOffer.offer_name}</span>\n              <br />\n              <span className=\"text-green-700\">{appliedOffer.display_message}</span>\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Pricing Summary */}\n        <div className=\"space-y-2 pt-4 border-t-2 border-gray-200\">\n          <div className=\"flex justify-between text-sm font-verdana\">\n            <span className=\"text-gray-600\">Subtotal:</span>\n            <span className=\"text-graphite font-semibold\">{totalOriginalPrice} credits</span>\n          </div>\n          \n          {totalDiscount > 0 && (\n            <div className=\"flex justify-between text-sm font-verdana\">\n              <span className=\"text-green-600\">Discount:</span>\n              <span className=\"text-green-600 font-semibold\">-{totalDiscount} credits</span>\n            </div>\n          )}\n\n          <div className=\"flex justify-between pt-2 border-t\">\n            <span className=\"font-fredoka font-bold text-lg text-graphite\">Total:</span>\n            <div className=\"text-right\">\n              <span className=\"font-fredoka font-bold text-2xl text-puretask-blue\">\n                {finalTotalPrice}\n              </span>\n              <span className=\"text-sm text-gray-500 font-verdana ml-1\">credits</span>\n              <div className=\"text-xs text-gray-500 font-verdana\">\n                ‚âà ${(finalTotalPrice / 10).toFixed(2)} USD\n              </div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingConfirmationService.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'sendTimeReminderNotification' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":31,"fix":{"range":[193,225],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"sendTimeReminderNotification"},"fix":{"range":[192,224],"text":""},"desc":"Remove unused variable 'sendTimeReminderNotification'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'sendFallbackActivatedNotification' is defined but never used.","line":8,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":36,"fix":{"range":[225,262],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"sendFallbackActivatedNotification"},"fix":{"range":[224,261],"text":""},"desc":"Remove unused variable 'sendFallbackActivatedNotification'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'booking' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":270,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":270,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"booking"},"fix":{"range":[8715,8776],"text":""},"desc":"Remove unused variable 'booking'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleanerProfile' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":299,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":299,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanerProfile"},"fix":{"range":[9834,9942],"text":""},"desc":"Remove unused variable 'cleanerProfile'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport { base44 } from '@/api/base44Client';\nimport { format, parseISO } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport {\n  sendCleanerOpenedRequestNotification,\n  sendTimeReminderNotification,\n  sendFallbackActivatedNotification,\n  sendBookingConfirmedNotification\n} from '../notifications/ProactiveNotifications';\n\n/**\n * Generates and sends detailed booking confirmation to both client and cleaner\n */\nexport async function sendBookingConfirmation(booking) {\n  try {\n    // Get user details\n    const clientUsers = await base44.entities.User.filter({ email: booking.client_email });\n    const cleanerUsers = await base44.entities.User.filter({ email: booking.cleaner_email });\n\n    if (clientUsers.length === 0 || cleanerUsers.length === 0) {\n      console.error('Could not find client or cleaner user');\n      return { success: false };\n    }\n\n    const client = clientUsers[0];\n    const cleaner = cleanerUsers[0];\n\n    // Get cleaner profile for additional details\n    const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: cleaner.email });\n    const cleanerProfile = cleanerProfiles[0];\n\n    // Format booking details\n    const formattedDate = format(parseISO(booking.date), 'EEEE, MMMM d, yyyy');\n    const formattedTime = convertTo12Hour(booking.start_time);\n    const endTimeCalculation = new Date(`2000-01-01T${booking.start_time}`);\n    endTimeCalculation.setHours(endTimeCalculation.getHours() + booking.hours);\n    const endTime = convertTo12Hour(endTimeCalculation.toTimeString().slice(0, 5));\n\n    // Calculate cleaner payout (85% of total)\n    const cleanerPayout = (booking.total_price * 0.85).toFixed(2);\n    const platformFee = (booking.total_price * 0.15).toFixed(2);\n\n    // Format tasks list\n    const tasksList = booking.tasks.map(task =>\n      `  ‚Ä¢ ${task.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}`\n    ).join('\\n');\n\n    // Generate confirmation agreement text\n    const agreementText = `\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n                 BOOKING CONFIRMATION AGREEMENT\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nCONFIRMATION NUMBER: ${booking.id.slice(0, 8).toUpperCase()}\nBOOKING DATE: ${formattedDate}\nCONFIRMED ON: ${format(new Date(), 'MMMM d, yyyy \\'at\\' h:mm a')}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nPARTIES:\n\nClient:\n  Name: ${client.full_name}\n  Email: ${client.email}\n  Phone: ${client.phone || 'Not provided'}\n\nCleaner:\n  Name: ${cleaner.full_name}\n  Email: ${cleaner.email}\n  Phone: ${cleaner.phone || 'Not provided'}\n  ${cleanerProfile ? `Tier: ${cleanerProfile.tier} | Reliability Score: ${cleanerProfile.reliability_score}/100` : ''}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nSERVICE DETAILS:\n\nüìÖ Date: ${formattedDate}\n‚è∞ Time: ${formattedTime} - ${endTime}\n‚è±Ô∏è  Duration: ${booking.hours} hour${booking.hours !== 1 ? 's' : ''}\n\nüìç Location:\n  ${booking.address}\n\nüßπ Services Requested:\n${tasksList}\n\n${booking.task_quantities && Object.keys(booking.task_quantities).length > 0 ? `\nüìä Quantities:\n${Object.entries(booking.task_quantities).map(([key, val]) => `  ‚Ä¢ ${key}: ${val}`).join('\\n')}\n` : ''}\n\n${booking.notes ? `\nüìù Special Instructions:\n  ${booking.notes}\n` : ''}\n\n${booking.parking_instructions ? `\nüÖøÔ∏è  Parking Instructions:\n  ${booking.parking_instructions}\n` : ''}\n\n${booking.entry_instructions ? `\nüö™ Entry Instructions:\n  ${booking.entry_instructions}\n` : ''}\n\n${booking.product_allergies ? `\n‚ö†Ô∏è  Product Allergies/Sensitivities:\n  ${booking.product_allergies}\n` : ''}\n\n${booking.product_preferences ? `\n‚ú® Product Preferences:\n  ${booking.product_preferences}\n` : ''}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nPAYMENT BREAKDOWN:\n\nTotal Service Cost: $${booking.total_price.toFixed(2)}\nPlatform Fee (15%): $${platformFee}\nCleaner Payout (85%): $${cleanerPayout}\n\nPayment Status: SECURED ‚úì\nPayment will be released to cleaner after service completion and photo verification.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nTERMS OF AGREEMENT:\n\nClient Responsibilities:\n‚úì Ensure property access at scheduled time\n‚úì Provide accurate special instructions\n‚úì Be available for any questions or concerns\n‚úì Review and rate service after completion\n\nCleaner Responsibilities:\n‚úì Arrive within 15 minutes of scheduled time\n‚úì GPS check-in upon arrival\n‚úì Take before and after photos\n‚úì Complete all agreed-upon tasks\n‚úì Follow all product preferences and allergies\n\nCancellation Policy:\n‚Ä¢ More than 24 hours: Free cancellation or reschedule\n‚Ä¢ Less than 24 hours: 50% cancellation fee\n‚Ä¢ No-show: Full charge + $15 inconvenience fee\n\nQuality Guarantee:\nBoth parties agree to PureTask's quality standards and dispute resolution process.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nBy accepting this booking, both parties agree to the terms outlined above\nand acknowledge their responsibilities for a successful service.\n\nQuestions? Contact PureTask Support: support@puretask.com\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n          Thank you for using PureTask! ‚ú®\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;\n\n    // Send to CLIENT\n    await base44.integrations.Core.SendEmail({\n      to: client.email,\n      subject: `‚úÖ Booking Confirmed - ${formattedDate} at ${formattedTime}`,\n      body: `Hi ${client.full_name},\n\nGreat news! Your cleaning service has been confirmed with ${cleaner.full_name}.\n\n${agreementText}\n\nWHAT'S NEXT FOR YOU:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n1. You'll receive a reminder 24 hours before your appointment\n2. Make sure someone is available to provide access if needed\n3. Your cleaner will check in via GPS when they arrive\n4. You'll see before/after photos when the service is complete\n5. Please review your cleaner to help maintain quality standards\n\nNeed to make changes? Log in to your dashboard to reschedule or cancel.\n\nBest regards,\nThe PureTask Team`\n    });\n\n    // Send to CLEANER\n    await base44.integrations.Core.SendEmail({\n      to: cleaner.email,\n      subject: `‚úÖ New Job Confirmed - ${formattedDate} at ${formattedTime} ($${cleanerPayout} payout)`,\n      body: `Hi ${cleaner.full_name},\n\nCongratulations! You have a new confirmed cleaning job.\n\n${agreementText}\n\nWHAT'S NEXT FOR YOU:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n1. Review all special instructions and product requirements\n2. Arrive within 15 minutes of scheduled time: ${formattedTime}\n3. Check in via GPS when you arrive (mandatory)\n4. Take clear before photos of all areas you'll be cleaning\n5. Complete all agreed-upon tasks thoroughly\n6. Take after photos showing your great work\n7. Check out via GPS when complete\n\nIMPORTANT REMINDERS:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n‚úì GPS check-in is REQUIRED (affects your reliability score)\n‚úì Before/after photos are REQUIRED for payment release\n‚úì Respect all product allergies and preferences listed above\n‚úì You have a 15-minute grace period for arrival time\n\nYour payout of $${cleanerPayout} will be available in your earnings after service completion and photo verification.\n\nGood luck and great cleaning!\nThe PureTask Team`\n    });\n\n    // Log the confirmation event\n    await base44.entities.Event.create({\n      booking_id: booking.id,\n      event_type: 'confirmed',\n      user_email: 'system',\n      details: `Confirmation agreement sent to both ${client.email} and ${cleaner.email}`,\n      timestamp: new Date().toISOString()\n    });\n\n    return { success: true };\n  } catch (error) {\n    console.error('Error sending booking confirmation:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n/**\n * Check if both parties have confirmed and send confirmation if yes\n */\nexport async function checkAndSendConfirmation(bookingId) {\n  try {\n    const booking = await base44.entities.Booking.get(bookingId);\n\n    // Only send if both parties have confirmed and status is pending_confirmation\n    if (booking.client_confirmed && booking.cleaner_confirmed && booking.status === 'pending_confirmation') {\n      // Update status to confirmed\n      await base44.entities.Booking.update(bookingId, {\n        status: 'confirmed'\n      });\n\n      // Send confirmation to both parties\n      await sendBookingConfirmation(booking);\n\n      return { success: true, message: 'Booking confirmed and notifications sent' };\n    }\n\n    return { success: false, message: 'Waiting for both parties to confirm' };\n  } catch (error) {\n    console.error('Error checking and sending confirmation:', error);\n    return { success: false, error: error.message };\n  }\n}\n\nexport async function processBookingRequest(bookingId) {\n  const booking = await base44.entities.Booking.get(bookingId);\n\n  // Set expiration time\n  const requestSentAt = new Date();\n  const requestExpiresAt = new Date(requestSentAt.getTime() + 4 * 60 * 60 * 1000); // 4 hours\n\n  await base44.entities.Booking.update(bookingId, {\n    request_sent_at: requestSentAt.toISOString(),\n    request_expires_at: requestExpiresAt.toISOString(),\n    status: 'awaiting_cleaner_response'\n  });\n\n  // Note: In production, you'd use a proper job queue (AWS SQS, Redis, etc.)\n  // For now, we'll track these in a simple way\n  console.log(`Booking ${bookingId} request sent, expires at ${requestExpiresAt.toISOString()}`);\n}\n\n// This would be called when cleaner views the booking\nexport async function notifyCleanerViewedBooking(bookingId) {\n  try {\n    const booking = await base44.entities.Booking.get(bookingId);\n\n    // Update viewed timestamp\n    await base44.entities.Booking.update(bookingId, {\n      cleaner_viewed_at: new Date().toISOString()\n    });\n\n    // Send notification to client\n    const [clientUser] = await base44.entities.User.filter({ email: booking.client_email });\n    const [cleanerProfile] = await base44.entities.CleanerProfile.filter({ user_email: booking.cleaner_email }); // This variable isn't used, but kept from the outline.\n    const [cleanerUser] = await base44.entities.User.filter({ email: booking.cleaner_email });\n\n    await sendCleanerOpenedRequestNotification(booking, clientUser, cleanerUser);\n  } catch (error) {\n    console.error('Error notifying cleaner viewed booking:', error);\n  }\n}\n\n// This would be called when cleaner accepts\nexport async function handleCleanerAcceptance(bookingId) {\n  try {\n    const booking = await base44.entities.Booking.get(bookingId);\n\n    await base44.entities.Booking.update(bookingId, {\n      status: 'scheduled',\n      cleaner_confirmed: true\n    });\n\n    const [clientUser] = await base44.entities.User.filter({ email: booking.client_email });\n    const [cleanerUser] = await base44.entities.User.filter({ email: booking.cleaner_email });\n\n    await sendBookingConfirmedNotification(booking, clientUser, cleanerUser);\n  } catch (error) {\n    console.error('Error handling cleaner acceptance:', error);\n  }\n}\n\n/**\n * Complete a booking and handle new cleaner milestone\n */\nexport async function completeBookingAndCheckMilestone(bookingId) {\n  try {\n    const booking = await base44.entities.Booking.get(bookingId);\n\n    // Get cleaner profile\n    const cleanerProfiles = await base44.entities.CleanerProfile.filter({\n      user_email: booking.cleaner_email\n    });\n\n    if (cleanerProfiles.length === 0) {\n      throw new Error('Cleaner profile not found');\n    }\n\n    const cleanerProfile = cleanerProfiles[0];\n    const previousJobCount = cleanerProfile.total_jobs || 0;\n\n    // Increment job count\n    await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n      total_jobs: previousJobCount + 1\n    });\n\n    // If this was their 5th job, send congratulations email\n    if (previousJobCount === 4) { // Was 4, now will be 5\n      const cleanerUsers = await base44.entities.User.filter({ email: booking.cleaner_email });\n      const cleanerUser = cleanerUsers[0];\n\n      await base44.integrations.Core.SendEmail({\n        from_name: 'PureTask',\n        to: booking.cleaner_email,\n        subject: 'üéâ Congratulations! You completed your first 5 jobs!',\n        body: `<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n    .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n    .header { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 40px; text-align: center; border-radius: 10px; }\n    .content { background: #f9fafb; padding: 30px; border-radius: 10px; margin-top: 20px; }\n    .milestone-badge { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; margin: 20px 0; }\n    .cta-button { display: inline-block; background: #10b981; color: white; padding: 15px 30px; text-decoration: none; border-radius: 8px; margin: 20px 0; font-weight: bold; }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"header\">\n      <h1 style=\"margin: 0; font-size: 32px;\">üéâ Amazing Milestone!</h1>\n      <p style=\"margin: 10px 0 0 0; font-size: 18px; opacity: 0.9;\">You've completed your first 5 jobs!</p>\n    </div>\n\n    <div class=\"content\">\n      <h2 style=\"color: #059669;\">Congratulations, ${cleanerUser?.full_name || 'Cleaner'}!</h2>\n\n      <p>This is a huge achievement! You've successfully completed your first 5 jobs on PureTask and are now a verified, experienced cleaner on our platform.</p>\n\n      <div class=\"milestone-badge\">\n        <h3 style=\"margin: 0; font-size: 24px;\">‚ú® New Cleaner Program Complete</h3>\n        <p style=\"margin: 10px 0 0 0;\">Your introductory discount has now ended</p>\n      </div>\n\n      <h3 style=\"color: #059669;\">What's Changed:</h3>\n      <ul>\n        <li><strong>Full Rate Earnings:</strong> You now charge your full rate of <strong>$${cleanerProfile.hourly_rate}/hour</strong></li>\n        <li><strong>No More Subsidy:</strong> The platform subsidy has ended - you're earning 100% of your posted rate</li>\n        <li><strong>Established Profile:</strong> You now have reviews and a track record that attracts clients</li>\n        <li><strong>Priority Placement Ended:</strong> Your \"New Cleaner\" badge has been removed</li>\n      </ul>\n\n      <h3 style=\"color: #059669;\">Keep Growing:</h3>\n      <ul>\n        <li>Maintain your high reliability score to attract premium clients</li>\n        <li>Encourage clients to leave reviews after each job</li>\n        <li>Complete your profile with before/after photos</li>\n        <li>Consider adding specialty services to stand out</li>\n      </ul>\n\n      <div style=\"text-align: center;\">\n        <a href=\"${typeof window !== 'undefined' ? window.location.origin : ''}/CleanerDashboard\" class=\"cta-button\">\n          View Your Dashboard\n        </a>\n      </div>\n\n      <p style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb; color: #6b7280; font-size: 14px;\">\n        Keep up the excellent work! We're excited to see your continued success on PureTask.\n      </p>\n    </div>\n  </div>\n</body>\n</html>`\n      });\n\n      console.log(`üéâ Sent 5-job milestone email to ${booking.cleaner_email}`);\n    }\n\n    return {\n      success: true,\n      milestone_reached: previousJobCount === 4,\n      new_job_count: previousJobCount + 1\n    };\n  } catch (error) {\n    console.error('Error completing booking and checking milestone:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingConflictChecker.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingDetailsModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"fix":{"range":[293,342],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[293,341],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Separator' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":19,"fix":{"range":[342,397],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Separator"},"fix":{"range":[342,396],"text":""},"desc":"Remove unused variable 'Separator'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Phone' is defined but never used.","line":9,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":39,"fix":{"range":[438,445],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Phone"},"fix":{"range":[437,444],"text":""},"desc":"Remove unused variable 'Phone'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Mail' is defined but never used.","line":9,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":45,"fix":{"range":[445,451],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Mail"},"fix":{"range":[444,450],"text":""},"desc":"Remove unused variable 'Mail'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":10,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":61,"fix":{"range":[516,531],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[515,530],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Receipt' is defined but never used.","line":11,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":53,"fix":{"range":[576,585],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Receipt"},"fix":{"range":[575,584],"text":""},"desc":"Remove unused variable 'Receipt'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'motion' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":16,"fix":{"range":[717,758],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[717,756],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Separator } from '@/components/ui/separator';\nimport {\n  Calendar, Clock, MapPin, User, Phone, Mail, Star, DollarSign,\n  CheckCircle, Home, Droplets, Package, Image, MessageSquare,\n  AlertCircle, XCircle, TrendingUp, Loader2, Receipt, FileText\n} from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport { motion } from 'framer-motion';\n\nexport default function BookingDetailsModal({ booking, open, onClose }) {\n  const [cleaner, setCleaner] = useState(null);\n  const [review, setReview] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (open && booking) {\n      loadDetails();\n    }\n  }, [open, booking]);\n\n  const loadDetails = async () => {\n    setLoading(true);\n    try {\n      // Load cleaner profile\n      if (booking.cleaner_email) {\n        const cleanerProfiles = await base44.entities.CleanerProfile.filter({\n          user_email: booking.cleaner_email\n        });\n        if (cleanerProfiles.length > 0) {\n          setCleaner(cleanerProfiles[0]);\n        }\n      }\n\n      // Load review\n      const reviews = await base44.entities.Review.filter({\n        booking_id: booking.id\n      });\n      if (reviews.length > 0) {\n        setReview(reviews[0]);\n      }\n    } catch (error) {\n      console.error('Error loading booking details:', error);\n    }\n    setLoading(false);\n  };\n\n  if (!booking) return null;\n\n  const getStatusConfig = (status) => {\n    const configs = {\n      scheduled: { label: 'Scheduled', color: 'bg-blue-100 text-blue-700', icon: Calendar },\n      accepted: { label: 'Accepted', color: 'bg-blue-100 text-blue-700', icon: CheckCircle },\n      on_the_way: { label: 'On The Way', color: 'bg-cyan-100 text-cyan-700', icon: TrendingUp },\n      in_progress: { label: 'In Progress', color: 'bg-amber-100 text-amber-700', icon: Loader2 },\n      awaiting_client: { label: 'Awaiting Review', color: 'bg-purple-100 text-purple-700', icon: Star },\n      completed: { label: 'Completed', color: 'bg-green-100 text-green-700', icon: CheckCircle },\n      approved: { label: 'Approved', color: 'bg-green-100 text-green-700', icon: CheckCircle },\n      cancelled: { label: 'Cancelled', color: 'bg-gray-100 text-gray-600', icon: XCircle },\n      disputed: { label: 'Disputed', color: 'bg-red-100 text-red-700', icon: AlertCircle }\n    };\n    return configs[status] || configs.scheduled;\n  };\n\n  const statusConfig = getStatusConfig(booking.status);\n  const StatusIcon = statusConfig.icon;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"text-3xl font-fredoka font-bold text-graphite flex items-center gap-3\">\n            <div className=\"bg-gradient-to-br from-puretask-blue to-cyan-500 p-3 rounded-2xl\">\n              <FileText className=\"w-6 h-6 text-white\" />\n            </div>\n            Booking Details\n          </DialogTitle>\n        </DialogHeader>\n\n        {loading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n          </div>\n        ) : (\n          <div className=\"space-y-6 mt-4\">\n            {/* Status Banner */}\n            <div className={`${statusConfig.color} rounded-2xl p-4 flex items-center justify-between`}>\n              <div className=\"flex items-center gap-3\">\n                <StatusIcon className=\"w-6 h-6\" />\n                <div>\n                  <p className=\"font-fredoka font-bold text-lg\">{statusConfig.label}</p>\n                  <p className=\"text-sm opacity-80 font-verdana\">\n                    Booking ID: {booking.id.slice(0, 8)}\n                  </p>\n                </div>\n              </div>\n              <Badge className=\"bg-white/50 border-0 text-inherit font-fredoka\">\n                {format(parseISO(booking.date), 'MMM d, yyyy')}\n              </Badge>\n            </div>\n\n            {/* Date & Time */}\n            <Card className=\"border-2 border-blue-100 bg-white\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n                  <h3 className=\"font-fredoka font-bold text-slate-900 text-lg\">Date & Time</h3>\n                </div>\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div className=\"bg-blue-50 p-4 rounded-2xl\">\n                    <p className=\"text-xs text-slate-600 font-verdana uppercase mb-1 font-semibold\">Date</p>\n                    <p className=\"font-fredoka font-bold text-slate-900\">\n                      {format(parseISO(booking.date), 'EEEE, MMMM d, yyyy')}\n                    </p>\n                  </div>\n                  <div className=\"bg-blue-50 p-4 rounded-2xl\">\n                    <p className=\"text-xs text-slate-600 font-verdana uppercase mb-1 font-semibold\">Time</p>\n                    <p className=\"font-fredoka font-bold text-slate-900 flex items-center gap-2\">\n                      <Clock className=\"w-4 h-4 text-puretask-blue\" />\n                      {convertTo12Hour(booking.start_time)} ({booking.hours} hours)\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Location */}\n            <Card className=\"border-2 border-purple-100 bg-white\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <MapPin className=\"w-5 h-5 text-purple-600\" />\n                  <h3 className=\"font-fredoka font-bold text-slate-900 text-lg\">Location</h3>\n                </div>\n                <div className=\"bg-purple-50 p-4 rounded-2xl\">\n                  <p className=\"font-verdana text-slate-900\">{booking.address}</p>\n                  {booking.entry_instructions && (\n                    <div className=\"mt-3 pt-3 border-t border-purple-200\">\n                      <p className=\"text-xs text-slate-600 font-verdana uppercase mb-1 font-semibold\">Entry Instructions</p>\n                      <p className=\"text-sm font-verdana text-slate-800\">{booking.entry_instructions}</p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {/* Cleaner Info */}\n              {cleaner && (\n                <Card className=\"border-2 border-green-100 bg-white\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-2 mb-4\">\n                      <User className=\"w-5 h-5 text-green-600\" />\n                      <h3 className=\"font-fredoka font-bold text-slate-900 text-lg\">Cleaner</h3>\n                    </div>\n                    <div className=\"flex items-start gap-4\">\n                      <div className=\"relative\">\n                        {cleaner.profile_photo_url ? (\n                          <img\n                            src={cleaner.profile_photo_url}\n                            alt={cleaner.full_name}\n                            className=\"w-20 h-20 rounded-2xl object-cover border-2 border-white shadow-lg\"\n                          />\n                        ) : (\n                          <div className=\"w-20 h-20 rounded-2xl bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center text-white font-fredoka font-bold text-2xl shadow-lg\">\n                            {cleaner.full_name?.charAt(0) || 'C'}\n                          </div>\n                        )}\n                        {cleaner.admin_verified && (\n                          <div className=\"absolute -bottom-2 -right-2 bg-green-500 rounded-full p-1.5 border-2 border-white shadow\">\n                            <CheckCircle className=\"w-4 h-4 text-white\" />\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"font-fredoka font-bold text-graphite text-lg mb-1\">\n                          {cleaner.full_name || 'Professional Cleaner'}\n                        </p>\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <Badge className=\"bg-green-100 text-green-700 font-fredoka border-0\">\n                            {cleaner.tier || 'Pro'}\n                          </Badge>\n                          {cleaner.average_rating && (\n                            <div className=\"flex items-center gap-1\">\n                              <Star className=\"w-4 h-4 text-amber-500 fill-current\" />\n                              <span className=\"text-sm font-verdana text-gray-700\">\n                                {cleaner.average_rating.toFixed(1)}\n                              </span>\n                            </div>\n                          )}\n                        </div>\n                        <p className=\"text-xs text-gray-500 font-verdana\">{booking.cleaner_email}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Service Details */}\n              <Card className=\"border-2 border-amber-100 bg-white\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <Droplets className=\"w-5 h-5 text-amber-600\" />\n                    <h3 className=\"font-fredoka font-bold text-slate-900 text-lg\">Service</h3>\n                  </div>\n                  <div className=\"space-y-3\">\n                    <div className=\"bg-amber-50 p-4 rounded-2xl\">\n                      <p className=\"text-xs text-slate-600 font-verdana uppercase mb-1 font-semibold\">Cleaning Type</p>\n                      <p className=\"font-fredoka font-bold text-slate-900 capitalize\">\n                        {booking.cleaning_type || 'Basic'} Cleaning\n                      </p>\n                    </div>\n                    {(booking.bedrooms || booking.bathrooms || booking.square_feet) && (\n                      <div className=\"bg-amber-50 p-4 rounded-2xl\">\n                        <p className=\"text-xs text-slate-600 font-verdana uppercase mb-2 font-semibold\">Property Details</p>\n                        <div className=\"flex flex-wrap gap-3 text-sm font-verdana\">\n                          {booking.bedrooms && (\n                            <span className=\"flex items-center gap-1\">\n                              <Home className=\"w-4 h-4 text-amber-600\" />\n                              {booking.bedrooms} bed\n                            </span>\n                          )}\n                          {booking.bathrooms && (\n                            <span className=\"flex items-center gap-1\">\n                              <Droplets className=\"w-4 h-4 text-amber-600\" />\n                              {booking.bathrooms} bath\n                            </span>\n                          )}\n                          {booking.square_feet && (\n                            <span>{booking.square_feet} sq ft</span>\n                          )}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Pricing */}\n            <Card className=\"border-2 border-emerald-100 bg-white\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <DollarSign className=\"w-5 h-5 text-emerald-600\" />\n                  <h3 className=\"font-fredoka font-bold text-slate-900 text-lg\">Pricing Breakdown</h3>\n                </div>\n                <div className=\"bg-emerald-50/50 p-6 rounded-2xl space-y-4\">\n                  {/* Base Rate */}\n                  <div className=\"flex items-center justify-between pb-3 border-b border-gray-300\">\n                    <div>\n                      <p className=\"text-sm text-slate-600 font-verdana mb-1 font-semibold\">Hourly Rate</p>\n                      <p className=\"font-fredoka font-bold text-slate-900\">\n                        {booking.snapshot_total_rate_cph || booking.snapshot_base_rate_cph || 'N/A'} credits/hour\n                      </p>\n                      <p className=\"text-xs text-slate-600 font-verdana mt-1\">\n                        {booking.hours || booking.estimated_hours} hours √ó {booking.snapshot_total_rate_cph || booking.snapshot_base_rate_cph} credits\n                      </p>\n                    </div>\n                    <p className=\"text-xl font-fredoka font-bold text-slate-900\">\n                      {Math.round((booking.snapshot_total_rate_cph || booking.snapshot_base_rate_cph || 0) * (booking.hours || booking.estimated_hours || 0))}\n                    </p>\n                  </div>\n\n                  {/* Additional Services */}\n                  {booking.additional_services && Object.keys(booking.additional_services).length > 0 && (\n                    <div className=\"space-y-2\">\n                      <p className=\"text-sm font-verdana font-semibold text-slate-800\">Additional Services</p>\n                      {Object.entries(booking.additional_services).map(([service, quantity]) => {\n                        if (quantity > 0) {\n                          const servicePrice = booking.snapshot_additional_service_prices?.[service] || 0;\n                          const serviceCost = servicePrice * quantity;\n                          return (\n                            <div key={service} className=\"flex items-center justify-between py-2 px-3 bg-white border border-emerald-200 rounded-xl\">\n                              <div className=\"flex items-center gap-2\">\n                                <Package className=\"w-4 h-4 text-emerald-600\" />\n                                <div>\n                                  <p className=\"text-sm font-verdana text-slate-900 capitalize font-medium\">\n                                    {service.replace(/_/g, ' ')}\n                                  </p>\n                                  <p className=\"text-xs text-slate-600\">\n                                    {quantity} √ó {servicePrice} credits\n                                  </p>\n                                </div>\n                              </div>\n                              <p className=\"font-fredoka font-bold text-slate-900\">\n                                {serviceCost}\n                              </p>\n                            </div>\n                          );\n                        }\n                        return null;\n                      })}\n                    </div>\n                  )}\n\n                  {/* Total */}\n                  <div className=\"flex items-center justify-between pt-4 border-t-2 border-slate-300\">\n                    <div>\n                      <p className=\"text-sm text-slate-600 font-verdana mb-1 font-semibold\">Total Amount</p>\n                      <p className=\"font-fredoka text-lg font-bold text-slate-900\">\n                        {Math.round(booking.total_price)} credits\n                      </p>\n                      <p className=\"text-xs text-slate-600 font-verdana mt-1\">\n                        = ${booking.total_price.toFixed(2)} USD\n                      </p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-4xl font-fredoka font-bold text-emerald-600\">\n                        {Math.round(booking.total_price)}\n                      </p>\n                      <p className=\"text-sm text-slate-600 font-verdana\">credits</p>\n                    </div>\n                  </div>\n\n                  {booking.actual_hours && booking.actual_hours !== booking.hours && (\n                    <div className=\"pt-3 border-t border-gray-200 bg-blue-50 -mx-6 -mb-6 p-4 rounded-b-2xl\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">\n                        ‚ÑπÔ∏è Actual time worked: <span className=\"font-bold\">{booking.actual_hours}h</span>\n                        {booking.refund_credits > 0 && (\n                          <span className=\"text-green-600\"> ‚Ä¢ Refunded: {booking.refund_credits} credits</span>\n                        )}\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Photos */}\n            {(booking.before_photos?.length > 0 || booking.after_photos?.length > 0) && (\n              <Card className=\"border-2 border-pink-100\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <Image className=\"w-5 h-5 text-pink-600\" />\n                    <h3 className=\"font-fredoka font-bold text-graphite text-lg\">Photos</h3>\n                  </div>\n                  <div className=\"grid md:grid-cols-2 gap-6\">\n                    {booking.before_photos?.length > 0 && (\n                      <div>\n                        <p className=\"text-sm text-gray-500 font-verdana uppercase mb-3\">Before</p>\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {booking.before_photos.map((photo, idx) => (\n                            <img\n                              key={idx}\n                              src={photo}\n                              alt={`Before ${idx + 1}`}\n                              className=\"w-full h-32 object-cover rounded-xl\"\n                            />\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                    {booking.after_photos?.length > 0 && (\n                      <div>\n                        <p className=\"text-sm text-gray-500 font-verdana uppercase mb-3\">After</p>\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {booking.after_photos.map((photo, idx) => (\n                            <img\n                              key={idx}\n                              src={photo}\n                              alt={`After ${idx + 1}`}\n                              className=\"w-full h-32 object-cover rounded-xl\"\n                            />\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Review */}\n            {review && (\n              <Card className=\"border-2 border-yellow-100 bg-gradient-to-br from-yellow-50 to-amber-50\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <Star className=\"w-5 h-5 text-yellow-600 fill-current\" />\n                    <h3 className=\"font-fredoka font-bold text-graphite text-lg\">Your Review</h3>\n                  </div>\n                  <div className=\"bg-white p-6 rounded-2xl\">\n                    <div className=\"flex items-center gap-1 mb-3\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star\n                          key={i}\n                          className={`w-6 h-6 ${\n                            i < review.rating ? 'text-yellow-500 fill-current' : 'text-gray-300'\n                          }`}\n                        />\n                      ))}\n                      <span className=\"ml-2 text-xl font-fredoka font-bold text-graphite\">\n                        {review.rating}.0\n                      </span>\n                    </div>\n                    {review.comment && (\n                      <p className=\"text-gray-700 font-verdana leading-relaxed\">{review.comment}</p>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Notes */}\n            {booking.notes && (\n              <Card className=\"border-2 border-gray-200\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <FileText className=\"w-5 h-5 text-gray-600\" />\n                    <h3 className=\"font-fredoka font-bold text-graphite text-lg\">Additional Notes</h3>\n                  </div>\n                  <div className=\"bg-gray-50 p-4 rounded-2xl\">\n                    <p className=\"text-gray-700 font-verdana\">{booking.notes}</p>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingEscrowService.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'calculateCleanerPayout' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":25,"fix":{"range":[274,300],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"calculateCleanerPayout"},"fix":{"range":[273,299],"text":""},"desc":"Remove unused variable 'calculateCleanerPayout'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Booking Escrow Service\n * Handles credit escrow, holds, releases, and charges for bookings\n */\n\nimport { base44 } from '@/api/base44Client';\nimport {\n  getSelectedAddon,\n  calculateTotalRate,\n  calculateEscrow,\n  calculateActualHours,\n  calculateFinalChargeAndRefund,\n  calculateCleanerPayout,\n  getPayoutPercentage,\n  CREDITS_PER_USD\n} from '../credits/CreditCalculator';\n\n/**\n * Create booking with escrow hold\n */\nexport async function createBookingWithEscrow(bookingData, cleanerProfile, currentUser) {\n  try {\n    // 1. Calculate rates and escrow\n    const selectedAddon = getSelectedAddon(\n      bookingData.cleaning_type || 'basic',\n      cleanerProfile.deep_addon_credits_per_hour,\n      cleanerProfile.moveout_addon_credits_per_hour\n    );\n    \n    const totalRate = calculateTotalRate(\n      cleanerProfile.base_rate_credits_per_hour,\n      selectedAddon\n    );\n    \n    const escrow = calculateEscrow(bookingData.estimated_hours || bookingData.hours, totalRate);\n    \n    // 2. Check balance\n    const userBalance = currentUser.wallet_credits_balance || 0;\n    if (userBalance < escrow) {\n      return {\n        success: false,\n        error: 'insufficient_credits',\n        required: escrow,\n        available: userBalance,\n        shortfall: escrow - userBalance\n      };\n    }\n    \n    // 3. Create booking with frozen snapshots\n    const booking = await base44.entities.Booking.create({\n      ...bookingData,\n      cleaner_email: cleanerProfile.user_email,\n      estimated_hours: bookingData.estimated_hours || bookingData.hours,\n      snapshot_base_rate_cph: cleanerProfile.base_rate_credits_per_hour,\n      snapshot_deep_addon_cph: cleanerProfile.deep_addon_credits_per_hour,\n      snapshot_moveout_addon_cph: cleanerProfile.moveout_addon_credits_per_hour,\n      snapshot_selected_addon_cph: selectedAddon,\n      snapshot_total_rate_cph: totalRate,\n      payout_percentage_at_accept: cleanerProfile.payout_percentage || getPayoutPercentage(cleanerProfile.tier),\n      escrow_credits_reserved: escrow,\n      status: 'created',\n      payment_held: true\n    });\n    \n    // 4. Create hold transaction\n    const newBalance = userBalance - escrow;\n    await base44.entities.CreditTransaction.create({\n      client_email: currentUser.email,\n      transaction_type: 'hold',\n      amount_credits: -escrow,\n      booking_id: booking.id,\n      note: `Escrow hold for booking on ${bookingData.date}`,\n      balance_after: newBalance\n    });\n    \n    // 5. Update user balance\n    await base44.auth.updateMe({\n      wallet_credits_balance: newBalance\n    });\n    \n    return {\n      success: true,\n      booking: booking,\n      escrow_held: escrow,\n      new_balance: newBalance\n    };\n    \n  } catch (error) {\n    console.error('Escrow creation error:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n/**\n * Process check-out and calculate final charge\n */\nexport async function processCheckOut(booking, checkOutTime, checkOutGPS) {\n  try {\n    if (!booking.check_in_time) {\n      throw new Error('Cannot check out without check-in');\n    }\n    \n    // 1. Calculate actual hours and charges\n    const actualHours = calculateActualHours(booking.check_in_time, checkOutTime);\n    const { finalCharge, refund } = calculateFinalChargeAndRefund(\n      actualHours,\n      booking.snapshot_total_rate_cph,\n      booking.escrow_credits_reserved\n    );\n    \n    // 2. Get current client\n    const client = await base44.entities.User.list();\n    const currentClient = client.find(u => u.email === booking.client_email);\n    const currentBalance = currentClient?.wallet_credits_balance || 0;\n    \n    // 3. Release refund if any\n    let balanceAfterRefund = currentBalance;\n    if (refund > 0) {\n      balanceAfterRefund = currentBalance + refund;\n      await base44.entities.CreditTransaction.create({\n        client_email: booking.client_email,\n        transaction_type: 'release',\n        amount_credits: refund,\n        booking_id: booking.id,\n        note: `Refund: worked ${actualHours}h vs ${booking.estimated_hours}h estimated`,\n        balance_after: balanceAfterRefund\n      });\n      \n      // Update client balance\n      await base44.auth.updateMe({\n        wallet_credits_balance: balanceAfterRefund\n      });\n    }\n    \n    // 4. Charge final amount\n    const balanceAfterCharge = balanceAfterRefund - finalCharge;\n    await base44.entities.CreditTransaction.create({\n      client_email: booking.client_email,\n      transaction_type: 'charge',\n      amount_credits: -finalCharge,\n      booking_id: booking.id,\n      note: `Final charge: ${actualHours}h at ${booking.snapshot_total_rate_cph} credits/h`,\n      balance_after: balanceAfterCharge\n    });\n    \n    // 5. Update booking\n    await base44.entities.Booking.update(booking.id, {\n      check_out_time: checkOutTime,\n      check_out_location: checkOutGPS,\n      actual_hours: actualHours,\n      final_charge_credits: finalCharge,\n      refund_credits: refund,\n      status: 'awaiting_client',\n      payment_captured: true\n    });\n    \n    return {\n      success: true,\n      actual_hours: actualHours,\n      final_charge: finalCharge,\n      refund: refund,\n      new_balance: balanceAfterCharge\n    };\n    \n  } catch (error) {\n    console.error('Check-out processing error:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n/**\n * Approve booking and create cleaner earnings\n */\nexport async function approveBooking(booking) {\n  try {\n    if (booking.status !== 'awaiting_client' && booking.status !== 'completed') {\n      throw new Error('Booking not ready for approval');\n    }\n    \n    if (!booking.final_charge_credits) {\n      throw new Error('Final charge not calculated');\n    }\n    \n    // 1. Create cleaner earnings record\n    const payoutRate = booking.payout_percentage_at_accept;\n    const usdDue = (booking.final_charge_credits / CREDITS_PER_USD) * payoutRate;\n    \n    await base44.entities.CleanerEarning.create({\n      cleaner_email: booking.cleaner_email,\n      booking_id: booking.id,\n      credits_earned: booking.final_charge_credits,\n      payout_percentage: payoutRate,\n      usd_due: usdDue,\n      status: 'pending'\n    });\n    \n    // 2. Update booking status\n    await base44.entities.Booking.update(booking.id, {\n      status: 'approved'\n    });\n    \n    // 3. Update cleaner's job count\n    const cleanerProfiles = await base44.entities.CleanerProfile.filter({\n      user_email: booking.cleaner_email\n    });\n    \n    if (cleanerProfiles.length > 0) {\n      const profile = cleanerProfiles[0];\n      await base44.entities.CleanerProfile.update(profile.id, {\n        total_jobs: (profile.total_jobs || 0) + 1\n      });\n    }\n    \n    return {\n      success: true,\n      earnings_created: true,\n      usd_due: usdDue\n    };\n    \n  } catch (error) {\n    console.error('Approval error:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\n/**\n * Handle dispute resolution\n */\nexport async function resolveDispute(booking, resolution, partialRefundCredits = 0) {\n  try {\n    const client = await base44.entities.User.list();\n    const currentClient = client.find(u => u.email === booking.client_email);\n    const currentBalance = currentClient?.wallet_credits_balance || 0;\n    \n    if (resolution === 'client_favor') {\n      // Full refund to client\n      const refundAmount = booking.final_charge_credits;\n      const newBalance = currentBalance + refundAmount;\n      \n      await base44.entities.CreditTransaction.create({\n        client_email: booking.client_email,\n        transaction_type: 'refund',\n        amount_credits: refundAmount,\n        booking_id: booking.id,\n        note: 'Dispute resolved in client favor - full refund',\n        balance_after: newBalance\n      });\n      \n      await base44.auth.updateMe({\n        wallet_credits_balance: newBalance\n      });\n      \n      await base44.entities.Booking.update(booking.id, {\n        dispute_status: 'client_favor',\n        status: 'disputed'\n      });\n      \n    } else if (resolution === 'cleaner_favor') {\n      // Create full cleaner earnings\n      await approveBooking(booking);\n      \n      await base44.entities.Booking.update(booking.id, {\n        dispute_status: 'cleaner_favor',\n        status: 'approved'\n      });\n      \n    } else if (resolution === 'partial') {\n      // Partial refund to client\n      if (partialRefundCredits > 0) {\n        const newBalance = currentBalance + partialRefundCredits;\n        \n        await base44.entities.CreditTransaction.create({\n          client_email: booking.client_email,\n          transaction_type: 'refund',\n          amount_credits: partialRefundCredits,\n          booking_id: booking.id,\n          note: 'Partial refund from dispute resolution',\n          balance_after: newBalance\n        });\n        \n        await base44.auth.updateMe({\n          wallet_credits_balance: newBalance\n        });\n      }\n      \n      // Partial cleaner earnings\n      const remainingCredits = booking.final_charge_credits - partialRefundCredits;\n      const payoutRate = booking.payout_percentage_at_accept;\n      const usdDue = (remainingCredits / CREDITS_PER_USD) * payoutRate;\n      \n      await base44.entities.CleanerEarning.create({\n        cleaner_email: booking.cleaner_email,\n        booking_id: booking.id,\n        credits_earned: remainingCredits,\n        payout_percentage: payoutRate,\n        usd_due: usdDue,\n        status: 'pending'\n      });\n      \n      await base44.entities.Booking.update(booking.id, {\n        dispute_status: 'partial',\n        status: 'approved'\n      });\n    }\n    \n    return { success: true };\n    \n  } catch (error) {\n    console.error('Dispute resolution error:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\nexport default {\n  createBookingWithEscrow,\n  processCheckOut,\n  approveBooking,\n  resolveDispute\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingProgressTracker.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"fix":{"range":[85,132],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[85,131],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle, Circle, Loader2 } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nconst BOOKING_STEPS = [\n  { id: 1, label: 'Date & Time', description: 'Choose when' },\n  { id: 2, label: 'Services & Address', description: 'What & where' },\n  { id: 3, label: 'Review Details', description: 'Confirm booking' },\n  { id: 4, label: 'Payment', description: 'Secure checkout' }\n];\n\nexport default function BookingProgressTracker({ currentStep, completedSteps = [] }) {\n  return (\n    <Card className=\"border-0 shadow-lg mb-8\">\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center justify-between\">\n          {BOOKING_STEPS.map((step, idx) => (\n            <React.Fragment key={step.id}>\n              <div className=\"flex flex-col items-center flex-1\">\n                <motion.div\n                  initial={{ scale: 0.8, opacity: 0 }}\n                  animate={{ scale: 1, opacity: 1 }}\n                  transition={{ delay: idx * 0.1 }}\n                  className=\"relative\"\n                >\n                  <div className={`w-12 h-12 rounded-full flex items-center justify-center transition-all ${\n                    currentStep === step.id\n                      ? 'bg-emerald-500 text-white shadow-lg scale-110'\n                      : completedSteps.includes(step.id) || currentStep > step.id\n                      ? 'bg-emerald-100 text-emerald-600'\n                      : 'bg-slate-100 text-slate-400'\n                  }`}>\n                    {completedSteps.includes(step.id) || currentStep > step.id ? (\n                      <CheckCircle className=\"w-6 h-6\" />\n                    ) : currentStep === step.id ? (\n                      <Loader2 className=\"w-6 h-6 animate-spin\" />\n                    ) : (\n                      <Circle className=\"w-6 h-6\" />\n                    )}\n                  </div>\n                  {currentStep === step.id && (\n                    <motion.div\n                      className=\"absolute inset-0 rounded-full bg-emerald-500 opacity-20\"\n                      animate={{ scale: [1, 1.3, 1] }}\n                      transition={{ repeat: Infinity, duration: 2 }}\n                    />\n                  )}\n                </motion.div>\n                <div className=\"mt-2 text-center hidden md:block\">\n                  <p className={`text-sm font-semibold ${\n                    currentStep === step.id ? 'text-emerald-600' : 'text-slate-600'\n                  }`}>\n                    {step.label}\n                  </p>\n                  <p className=\"text-xs text-slate-500\">{step.description}</p>\n                </div>\n              </div>\n              \n              {idx < BOOKING_STEPS.length - 1 && (\n                <div className={`flex-1 h-1 mx-2 transition-all ${\n                  currentStep > step.id\n                    ? 'bg-emerald-500'\n                    : 'bg-slate-200'\n                }`} />\n              )}\n            </React.Fragment>\n          ))}\n        </div>\n        \n        {/* Mobile step label */}\n        <div className=\"md:hidden mt-4 text-center\">\n          <p className=\"text-sm font-semibold text-emerald-600\">\n            Step {currentStep}: {BOOKING_STEPS[currentStep - 1].label}\n          </p>\n          <p className=\"text-xs text-slate-500\">{BOOKING_STEPS[currentStep - 1].description}</p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingRequestExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BookingStatusIndicator.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":4,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":42,"fix":{"range":[128,134],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[127,133],"text":""},"desc":"Remove unused variable 'Star'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { \n  Clock, CheckCircle2, XCircle, AlertCircle, Loader2, \n  MessageSquare, Navigation, Camera, Star, Shield, Calendar\n} from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { motion } from 'framer-motion';\n\nexport default function BookingStatusIndicator({ status, context = 'full' }) {\n  const statusConfig = {\n    created: {\n      icon: Clock,\n      label: 'Creating',\n      color: 'bg-gray-100 text-gray-700',\n      description: 'Setting up your booking...',\n      userAction: null\n    },\n    payment_hold: {\n      icon: Shield,\n      label: 'Payment Secured',\n      color: 'bg-blue-100 text-blue-700',\n      description: 'Credits held safely in escrow',\n      userAction: null\n    },\n    awaiting_cleaner_response: {\n      icon: Loader2,\n      label: 'Awaiting Response',\n      color: 'bg-yellow-100 text-yellow-700',\n      description: 'Cleaner reviewing your request (24h window)',\n      userAction: 'Wait for cleaner to accept',\n      animated: true\n    },\n    checking_fallback: {\n      icon: Loader2,\n      label: 'Finding Cleaner',\n      color: 'bg-blue-100 text-blue-700',\n      description: 'Checking with alternative cleaners...',\n      userAction: 'We\\'re on it - you\\'ll be notified soon',\n      animated: true\n    },\n    open_to_fallbacks: {\n      icon: MessageSquare,\n      label: 'Open Request',\n      color: 'bg-purple-100 text-purple-700',\n      description: 'Multiple cleaners reviewing your request',\n      userAction: 'First to accept gets the job!'\n    },\n    accepted: {\n      icon: CheckCircle2,\n      label: 'Accepted',\n      color: 'bg-green-100 text-green-700',\n      description: 'Cleaner accepted your booking!',\n      userAction: null\n    },\n    scheduled: {\n      icon: Calendar,\n      label: 'Scheduled',\n      color: 'bg-blue-100 text-blue-700',\n      description: 'All set for your cleaning day',\n      userAction: 'Cleaner will notify when on the way'\n    },\n    on_the_way: {\n      icon: Navigation,\n      label: 'On The Way',\n      color: 'bg-blue-100 text-blue-700',\n      description: 'Cleaner is traveling to your location',\n      userAction: 'Prepare for arrival'\n    },\n    in_progress: {\n      icon: Loader2,\n      label: 'Cleaning',\n      color: 'bg-purple-100 text-purple-700',\n      description: 'Cleaner is working on your space',\n      userAction: 'In progress...',\n      animated: true\n    },\n    completed: {\n      icon: Camera,\n      label: 'Completed',\n      color: 'bg-green-100 text-green-700',\n      description: 'Cleaner finished and uploaded photos',\n      userAction: 'Review within 12 hours'\n    },\n    awaiting_client: {\n      icon: AlertCircle,\n      label: 'Review Needed',\n      color: 'bg-orange-100 text-orange-700',\n      description: 'Please review the completed job',\n      userAction: 'Review now or auto-approves in 12h',\n      urgent: true\n    },\n    approved: {\n      icon: CheckCircle2,\n      label: 'Approved',\n      color: 'bg-green-100 text-green-700',\n      description: 'Job approved, payment settled',\n      userAction: null\n    },\n    cancelled: {\n      icon: XCircle,\n      label: 'Cancelled',\n      color: 'bg-red-100 text-red-700',\n      description: 'Booking was cancelled',\n      userAction: null\n    },\n    disputed: {\n      icon: AlertCircle,\n      label: 'Under Review',\n      color: 'bg-red-100 text-red-700',\n      description: 'Support team reviewing dispute',\n      userAction: 'We\\'ll contact you within 24h'\n    },\n    cleaner_declined: {\n      icon: XCircle,\n      label: 'Declined',\n      color: 'bg-red-100 text-red-700',\n      description: 'Cleaner declined this request',\n      userAction: 'Checking with alternatives...'\n    }\n  };\n\n  const config = statusConfig[status] || {\n    icon: Clock,\n    label: status,\n    color: 'bg-gray-100 text-gray-700',\n    description: 'Processing...',\n    userAction: null\n  };\n\n  const Icon = config.icon;\n\n  if (context === 'badge-only') {\n    return (\n      <Badge className={`${config.color} font-fredoka flex items-center gap-1`}>\n        <Icon className={`w-3 h-3 ${config.animated ? 'animate-spin' : ''}`} />\n        {config.label}\n      </Badge>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 5 }}\n      animate={{ opacity: 1, y: 0 }}\n      className={`rounded-xl p-4 ${config.color.replace('text', 'border').replace('bg', 'bg')} border-2`}\n    >\n      <div className=\"flex items-start gap-3\">\n        <div className=\"mt-0.5\">\n          <Icon className={`w-5 h-5 ${config.animated ? 'animate-spin' : ''}`} />\n        </div>\n        <div className=\"flex-1\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h4 className=\"font-fredoka font-bold text-sm\">{config.label}</h4>\n            {config.urgent && (\n              <Badge className=\"bg-red-600 text-white font-fredoka text-xs\">Urgent</Badge>\n            )}\n          </div>\n          <p className=\"text-xs font-verdana opacity-90 mb-2\">{config.description}</p>\n          {config.userAction && (\n            <div className=\"text-xs font-verdana font-semibold opacity-75 flex items-center gap-1\">\n              <span>‚Üí</span>\n              <span>{config.userAction}</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\BundleOffers.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"fix":{"range":[225,274],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[225,273],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":7,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":72,"fix":{"range":[405,410],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[405,410],"text":""},"desc":"Remove unused variable 'Zap'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Sparkles, Tag, CheckCircle, TrendingUp, Package, Calendar, Zap } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function BundleOffers({ \n  bookingData, \n  totalCredits, \n  onApplyBundle \n}) {\n  const [availableOffers, setAvailableOffers] = useState([]);\n  const [selectedBundle, setSelectedBundle] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadOffers();\n  }, [bookingData]);\n\n  const loadOffers = async () => {\n    try {\n      const allOffers = await base44.entities.BundleOffer.filter({\n        is_active: true\n      });\n\n      // Filter offers based on current booking context\n      const applicable = allOffers.filter(offer => {\n        // Check if offer is still valid\n        if (offer.valid_until) {\n          const validDate = new Date(offer.valid_until);\n          if (validDate < new Date()) return false;\n        }\n\n        // Check offer conditions\n        if (offer.offer_type === 'multi_service' && bookingData?.additional_services) {\n          const serviceCount = Object.keys(bookingData.additional_services).length;\n          const requiredCount = offer.conditions?.min_services || 3;\n          return serviceCount >= requiredCount;\n        }\n\n        if (offer.offer_type === 'upgrade_upsell' && bookingData?.cleaning_type === 'basic') {\n          return true;\n        }\n\n        if (offer.offer_type === 'multi_booking') {\n          // Could check booking history here\n          return true;\n        }\n\n        return false;\n      });\n\n      setAvailableOffers(applicable);\n    } catch (error) {\n      console.error('Error loading bundle offers:', error);\n    }\n    setLoading(false);\n  };\n\n  const calculateDiscount = (offer) => {\n    if (offer.discount_percentage) {\n      return Math.round(totalCredits * (offer.discount_percentage / 100));\n    }\n    if (offer.discount_amount) {\n      return Math.round(offer.discount_amount * 10); // Convert USD to credits\n    }\n    return 0;\n  };\n\n  const handleSelectBundle = (offer) => {\n    const discount = calculateDiscount(offer);\n    setSelectedBundle(offer);\n    if (onApplyBundle) {\n      onApplyBundle({\n        offerId: offer.id,\n        offerName: offer.offer_name,\n        discountCredits: discount,\n        discountPercentage: offer.discount_percentage || 0\n      });\n    }\n  };\n\n  const handleRemoveBundle = () => {\n    setSelectedBundle(null);\n    if (onApplyBundle) {\n      onApplyBundle(null);\n    }\n  };\n\n  if (loading || availableOffers.length === 0) {\n    return null;\n  }\n\n  return (\n    <Card className=\"border-2 border-purple-300 shadow-xl rounded-2xl bg-gradient-to-br from-purple-50 to-pink-50\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-100 to-pink-100 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Tag className=\"w-6 h-6 text-purple-600\" />\n          Special Offers Available!\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-4\">\n        <AnimatePresence>\n          {availableOffers.map((offer, idx) => {\n            const discount = calculateDiscount(offer);\n            const isSelected = selectedBundle?.id === offer.id;\n\n            return (\n              <motion.div\n                key={offer.id}\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: 20 }}\n                transition={{ delay: idx * 0.1 }}\n              >\n                <Card className={`border-2 transition-all cursor-pointer rounded-2xl ${\n                  isSelected \n                    ? 'border-purple-500 bg-purple-100 shadow-lg scale-105' \n                    : 'border-purple-200 bg-white hover:shadow-md hover:scale-102'\n                }`}\n                onClick={() => isSelected ? handleRemoveBundle() : handleSelectBundle(offer)}\n                >\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          {offer.offer_type === 'multi_service' && <Package className=\"w-4 h-4 text-purple-600\" />}\n                          {offer.offer_type === 'multi_booking' && <Calendar className=\"w-4 h-4 text-purple-600\" />}\n                          {offer.offer_type === 'upgrade_upsell' && <TrendingUp className=\"w-4 h-4 text-purple-600\" />}\n                          \n                          <p className=\"font-fredoka font-bold text-graphite\">{offer.offer_name}</p>\n                          \n                          {isSelected && (\n                            <Badge className=\"bg-purple-600 text-white rounded-full font-fredoka\">\n                              <CheckCircle className=\"w-3 h-3 mr-1\" />\n                              Applied\n                            </Badge>\n                          )}\n                        </div>\n                        \n                        <p className=\"text-sm text-gray-700 font-verdana mb-3\">\n                          {offer.display_message}\n                        </p>\n\n                        {offer.valid_until && (\n                          <p className=\"text-xs text-gray-500 font-verdana\">\n                            Expires: {new Date(offer.valid_until).toLocaleDateString()}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"text-right ml-4\">\n                        <Badge className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white font-fredoka text-lg px-4 py-2 rounded-full\">\n                          -{discount}\n                        </Badge>\n                        <p className=\"text-xs text-gray-600 font-verdana mt-1\">credits off</p>\n                        <p className=\"text-xs text-gray-500 font-verdana\">\n                          ‚âà ${(discount / 10).toFixed(2)}\n                        </p>\n                      </div>\n                    </div>\n\n                    {isSelected && (\n                      <motion.div\n                        initial={{ opacity: 0, height: 0 }}\n                        animate={{ opacity: 1, height: 'auto' }}\n                        className=\"pt-3 border-t border-purple-300\"\n                      >\n                        <div className=\"flex items-center justify-between text-sm font-verdana\">\n                          <span className=\"text-purple-900 font-semibold\">Your savings:</span>\n                          <span className=\"text-xl font-fredoka font-bold text-purple-600\">\n                            {discount} credits\n                          </span>\n                        </div>\n                      </motion.div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </AnimatePresence>\n\n        {selectedBundle && (\n          <Alert className=\"border-purple-300 bg-purple-100 rounded-2xl\">\n            <Sparkles className=\"w-4 h-4 text-purple-700\" />\n            <AlertDescription className=\"text-purple-900 font-verdana font-semibold\">\n              Bundle discount applied! You're saving {calculateDiscount(selectedBundle)} credits.\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {!selectedBundle && availableOffers.length > 1 && (\n          <p className=\"text-xs text-center text-gray-500 font-verdana\">\n            üí° Click an offer to apply it to your booking\n          </p>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CalendarBooking.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":6,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":45,"fix":{"range":[318,328],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[317,327],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addWeeks' is defined but never used.","line":7,"column":82,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":90,"fix":{"range":[498,508],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addWeeks"},"fix":{"range":[497,507],"text":""},"desc":"Remove unused variable 'addWeeks'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isTomorrow' is defined but never used.","line":7,"column":92,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":102,"fix":{"range":[508,520],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isTomorrow"},"fix":{"range":[507,519],"text":""},"desc":"Remove unused variable 'isTomorrow'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isWeekend' is defined but never used.","line":7,"column":104,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":113,"fix":{"range":[519,530],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isWeekend"},"fix":{"range":[519,530],"text":""},"desc":"Remove unused variable 'isWeekend'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'expandedTimeGroup' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"expandedTimeGroup"},"fix":{"range":[1437,1454],"text":""},"desc":"Remove unused variable 'expandedTimeGroup'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setExpandedTimeGroup' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"setExpandedTimeGroup"},"fix":{"range":[1454,1476],"text":""},"desc":"Remove unused variable 'setExpandedTimeGroup'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ChevronLeft, ChevronRight, Calendar, Clock, AlertCircle, Info, Zap, Sun, Sunset, Moon, Check, Sparkles } from 'lucide-react';\nimport { format, addDays, startOfWeek, isSameDay, isToday, isBefore, startOfDay, addWeeks, isTomorrow, isWeekend } from 'date-fns';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { getAvailableTimeSlots, getUnavailableDays } from '../cleaner/AvailabilityChecker';\nimport { checkCleanerAvailability } from './AvailabilityEnforcement';\nimport { toast } from 'sonner';\nimport { Skeleton } from '@/components/ui/skeleton';\n\nexport default function CalendarBooking({ \n  cleaner,\n  selectedDate, \n  selectedTime, \n  onDateTimeSelect,\n  onDateSelect,\n  onTimeSelect \n}) {\n  const [currentStartDate, setCurrentStartDate] = useState(startOfWeek(new Date(), { weekStartsOn: 0 }));\n  const [availabilityError, setAvailabilityError] = useState('');\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [unavailableDays, setUnavailableDays] = useState([]);\n  const [checkingAvailability, setCheckingAvailability] = useState(false);\n  const [loadingSlots, setLoadingSlots] = useState(false);\n  const [expandedTimeGroup, setExpandedTimeGroup] = useState('all');\n\n  useEffect(() => {\n    if (cleaner) {\n      setUnavailableDays(getUnavailableDays(cleaner));\n    }\n  }, [cleaner]);\n\n  useEffect(() => {\n    const loadSlots = async () => {\n      if (selectedDate && cleaner) {\n        setLoadingSlots(true);\n        const dateObj = typeof selectedDate === 'string' ? new Date(selectedDate) : selectedDate;\n        const slots = await getAvailableTimeSlots(cleaner, dateObj);\n        setAvailableSlots(slots);\n        setLoadingSlots(false);\n      }\n    };\n    loadSlots();\n  }, [selectedDate, cleaner]);\n\n  const handleDateSelect = (date) => {\n    setAvailabilityError('');\n    \n    const today = startOfDay(new Date());\n    if (isBefore(date, today)) {\n      setAvailabilityError('Cannot book dates in the past');\n      return;\n    }\n\n    const dayOfWeek = date.getDay();\n    if (unavailableDays.includes(dayOfWeek)) {\n      const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n      setAvailabilityError(`${cleaner?.full_name || 'This cleaner'} is not available on ${dayNames[dayOfWeek]}s`);\n      return;\n    }\n\n    // Format date without timezone offset issues\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    const day = String(date.getDate()).padStart(2, '0');\n    const dateString = `${year}-${month}-${day}`;\n\n    // Support both callback patterns\n    if (onDateSelect) {\n      onDateSelect(dateString);\n    }\n    if (onDateTimeSelect) {\n      onDateTimeSelect(dateString, selectedTime);\n    }\n  };\n\n  const handleTimeSelect = async (time) => {\n    if (!selectedDate) {\n      setAvailabilityError('Please select a date first');\n      return;\n    }\n\n    setCheckingAvailability(true);\n    setAvailabilityError('');\n\n    // Support both callback patterns\n    if (onTimeSelect) {\n      onTimeSelect(time);\n      setCheckingAvailability(false);\n      return;\n    }\n\n    try {\n      const dateStr = typeof selectedDate === 'string' ? selectedDate : selectedDate.toISOString().split('T')[0];\n      const estimatedHours = 3;\n\n      if (cleaner?.user_email) {\n        const availability = await checkCleanerAvailability(\n          cleaner.user_email,\n          dateStr,\n          time,\n          estimatedHours\n        );\n\n        if (!availability.available) {\n          setAvailabilityError(availability.reason);\n          toast.error(availability.reason);\n          \n          if (availability.conflicts && availability.conflicts.length > 0) {\n            const conflict = availability.conflicts[0];\n            toast.error(\n              `Conflicts with existing booking at ${conflict.start_time}`,\n              { duration: 4000 }\n            );\n          }\n          return;\n        }\n      }\n\n      if (onDateTimeSelect) {\n        onDateTimeSelect(selectedDate, time);\n      }\n      toast.success('Time slot selected!');\n\n    } catch (error) {\n      console.error('Error checking availability:', error);\n      setAvailabilityError('Error checking availability. Please try again.');\n      toast.error('Could not verify availability');\n    } finally {\n      setCheckingAvailability(false);\n    }\n  };\n\n  const goToPreviousWeek = () => {\n    setCurrentStartDate(addDays(currentStartDate, -14));\n  };\n\n  const goToNextWeek = () => {\n    setCurrentStartDate(addDays(currentStartDate, 14));\n  };\n\n  const handleQuickSelect = (days) => {\n    const date = addDays(new Date(), days);\n    handleDateSelect(date);\n  };\n\n  // Generate 2 weeks (14 days)\n  const twoWeekDays = Array.from({ length: 14 }, (_, i) => addDays(currentStartDate, i));\n\n  const parsedSelectedDate = selectedDate ? (typeof selectedDate === 'string' ? new Date(selectedDate) : selectedDate) : null;\n\n  // Group time slots by period\n  const groupTimeSlots = (slots) => {\n    const morning = slots.filter(s => {\n      const hour = parseInt(s.time.split(':')[0]);\n      return hour >= 6 && hour < 12;\n    });\n    const afternoon = slots.filter(s => {\n      const hour = parseInt(s.time.split(':')[0]);\n      return hour >= 12 && hour < 17;\n    });\n    const evening = slots.filter(s => {\n      const hour = parseInt(s.time.split(':')[0]);\n      return hour >= 17 && hour < 21;\n    });\n    return { morning, afternoon, evening };\n  };\n\n  const groupedSlots = groupTimeSlots(availableSlots);\n\n  return (\n    <div className=\"space-y-8 max-w-5xl mx-auto\">\n      {/* Confirmation Summary */}\n      <AnimatePresence>\n        {parsedSelectedDate && selectedTime && (\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            className=\"bg-gradient-to-r from-puretask-blue to-cyan-400 rounded-2xl p-6 text-white shadow-sm\"\n          >\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 bg-white rounded-xl flex items-center justify-center\">\n                  <Check className=\"w-7 h-7 text-puretask-blue\" />\n                </div>\n                <div>\n                  <p className=\"text-sm opacity-90 font-verdana\">You selected</p>\n                  <p className=\"text-2xl font-fredoka font-bold\">\n                    {format(parsedSelectedDate, 'EEEE, MMM d')} at {selectedTime}\n                  </p>\n                </div>\n              </div>\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                onClick={() => onTimeSelect && onTimeSelect(null)}\n                className=\"text-white hover:bg-white/20 font-fredoka\"\n              >\n                Change\n              </Button>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Quick Select Buttons */}\n      <div>\n        <p className=\"text-sm font-verdana text-gray-600 mb-3 flex items-center gap-2\">\n          <Zap className=\"w-4 h-4 text-puretask-blue\" />\n          Quick Select\n        </p>\n        <div className=\"flex flex-wrap gap-3\">\n          <Button\n            onClick={() => handleQuickSelect(1)}\n            variant=\"outline\"\n            className=\"rounded-full border-puretask-blue text-puretask-blue hover:bg-blue-50 font-fredoka\"\n          >\n            Tomorrow\n          </Button>\n          <Button\n            onClick={() => handleQuickSelect(2)}\n            variant=\"outline\"\n            className=\"rounded-full border-puretask-blue text-puretask-blue hover:bg-blue-50 font-fredoka\"\n          >\n            In 2 Days\n          </Button>\n          <Button\n            onClick={() => handleQuickSelect(7)}\n            variant=\"outline\"\n            className=\"rounded-full border-puretask-blue text-puretask-blue hover:bg-blue-50 font-fredoka\"\n          >\n            Next Week\n          </Button>\n        </div>\n      </div>\n\n      {/* Calendar Header with Navigation */}\n      <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <Button onClick={goToPreviousWeek} variant=\"ghost\" size=\"sm\" className=\"text-puretask-blue hover:bg-blue-50 rounded-full font-fredoka\">\n            <ChevronLeft className=\"w-4 h-4\" />\n            <span className=\"ml-2\">Previous 2 Weeks</span>\n          </Button>\n          <div className=\"text-center\">\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite\">\n              {format(currentStartDate, 'MMM d')} - {format(addDays(currentStartDate, 13), 'MMM d, yyyy')}\n            </h3>\n            <p className=\"text-sm text-gray-600 font-verdana\">Select your preferred date</p>\n          </div>\n          <Button onClick={goToNextWeek} variant=\"ghost\" size=\"sm\" className=\"text-puretask-blue hover:bg-blue-50 rounded-full font-fredoka\">\n            <span className=\"mr-2\">Next 2 Weeks</span>\n            <ChevronRight className=\"w-4 h-4\" />\n          </Button>\n        </div>\n\n        {/* Legend */}\n        <div className=\"flex gap-4 text-xs font-verdana text-gray-600 justify-center mb-4 pb-4 border-b border-gray-100\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded-full bg-puretask-blue\"></div>\n            <span>Today</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded-full bg-puretask-blue border-2 border-puretask-blue\"></div>\n            <span>Selected</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded-full bg-gray-200\"></div>\n            <span>Unavailable</span>\n          </div>\n        </div>\n\n        {/* 2-Week Calendar */}\n        <div className=\"grid grid-cols-7 gap-3\">\n          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n            <div key={day} className=\"text-center text-xs font-fredoka font-semibold text-gray-500 pb-2\">\n              {day}\n            </div>\n          ))}\n          \n          {twoWeekDays.map((date, idx) => {\n            const isPast = isBefore(startOfDay(date), startOfDay(new Date()));\n            const isSelected = parsedSelectedDate && isSameDay(date, parsedSelectedDate);\n            const dayOfWeek = date.getDay();\n            const isUnavailable = unavailableDays.includes(dayOfWeek);\n            const isTodayDate = isToday(date);\n            \n            return (\n              <motion.button\n                key={idx}\n                whileHover={!isPast && !isUnavailable ? { scale: 1.02 } : {}}\n                whileTap={!isPast && !isUnavailable ? { scale: 0.98 } : {}}\n                onClick={() => !isPast && !isUnavailable && handleDateSelect(date)}\n                disabled={isPast || isUnavailable}\n                className={`\n                  aspect-square p-4 rounded-xl transition-all font-fredoka font-semibold relative\n                  ${isPast ? 'bg-gray-50 text-gray-300 cursor-not-allowed' : ''}\n                  ${isUnavailable && !isPast ? 'bg-gray-50 text-gray-300 cursor-not-allowed' : ''}\n                  ${isSelected ? 'bg-puretask-blue text-white shadow-sm ring-2 ring-puretask-blue ring-offset-2' : ''}\n                  ${!isPast && !isUnavailable && !isSelected ? 'hover:bg-blue-50 bg-white border border-gray-200 hover:border-puretask-blue' : ''}\n                  ${isTodayDate && !isPast && !isSelected ? 'ring-1 ring-puretask-blue' : ''}\n                `}\n              >\n                <div className=\"text-base\">{format(date, 'd')}</div>\n                {isTodayDate && !isSelected && (\n                  <div className=\"absolute bottom-2 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-puretask-blue rounded-full\"></div>\n                )}\n                {isSelected && (\n                  <Check className=\"absolute top-1 right-1 w-3 h-3\" />\n                )}\n              </motion.button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Time Selection Area */}\n      <AnimatePresence>\n        {parsedSelectedDate && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            className=\"space-y-6\"\n          >\n            <Card className=\"border border-gray-100 shadow-sm rounded-2xl overflow-hidden\">\n              <CardHeader className=\"bg-white border-b border-gray-100 p-6\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center\">\n                    <Clock className=\"w-6 h-6 text-puretask-blue\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-fredoka font-bold text-graphite\">Select Your Time</h3>\n                    <p className=\"text-gray-600 font-verdana text-sm\">\n                      {format(parsedSelectedDate, 'EEEE, MMMM d, yyyy')}\n                    </p>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                {loadingSlots ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-2 mb-3\">\n                      <Skeleton className=\"h-4 w-24\" />\n                    </div>\n                    <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3\">\n                      {[...Array(12)].map((_, i) => (\n                        <Skeleton key={i} className=\"h-12 rounded-xl\" />\n                      ))}\n                    </div>\n                  </div>\n                ) : availableSlots.length > 0 ? (\n                  <div className=\"space-y-6\">\n                    {/* Morning Slots */}\n                    {groupedSlots.morning.length > 0 && (\n                      <div>\n                        <div className=\"flex items-center gap-2 mb-3\">\n                          <Sun className=\"w-4 h-4 text-amber-500\" />\n                          <h4 className=\"font-fredoka font-semibold text-graphite\">Morning (6 AM - 12 PM)</h4>\n                          <Badge className=\"bg-amber-50 text-amber-700 border-amber-200\">\n                            {groupedSlots.morning.filter(s => s.available).length} available\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2\">\n                          {groupedSlots.morning.map((slot) => (\n                            <Button\n                              key={slot.time}\n                              onClick={() => handleTimeSelect(slot.time)}\n                              variant={selectedTime === slot.time ? 'default' : 'outline'}\n                              disabled={checkingAvailability || !slot.available}\n                              className={`h-11 font-fredoka font-medium text-sm rounded-xl ${\n                                selectedTime === slot.time\n                                  ? 'bg-puretask-blue hover:bg-puretask-blue/90 text-white shadow-sm'\n                                  : !slot.available\n                                  ? 'bg-gray-50 text-gray-400 border-gray-200 cursor-not-allowed'\n                                  : 'hover:border-puretask-blue hover:bg-blue-50 border-gray-200'\n                              }`}\n                            >\n                              {slot.display}\n                            </Button>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Afternoon Slots */}\n                    {groupedSlots.afternoon.length > 0 && (\n                      <div>\n                        <div className=\"flex items-center gap-2 mb-3\">\n                          <Sunset className=\"w-4 h-4 text-orange-500\" />\n                          <h4 className=\"font-fredoka font-semibold text-graphite\">Afternoon (12 PM - 5 PM)</h4>\n                          <Badge className=\"bg-orange-50 text-orange-700 border-orange-200\">\n                            {groupedSlots.afternoon.filter(s => s.available).length} available\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2\">\n                          {groupedSlots.afternoon.map((slot) => (\n                            <Button\n                              key={slot.time}\n                              onClick={() => handleTimeSelect(slot.time)}\n                              variant={selectedTime === slot.time ? 'default' : 'outline'}\n                              disabled={checkingAvailability || !slot.available}\n                              className={`h-11 font-fredoka font-medium text-sm rounded-xl ${\n                                selectedTime === slot.time\n                                  ? 'bg-puretask-blue hover:bg-puretask-blue/90 text-white shadow-sm'\n                                  : !slot.available\n                                  ? 'bg-gray-50 text-gray-400 border-gray-200 cursor-not-allowed'\n                                  : 'hover:border-puretask-blue hover:bg-blue-50 border-gray-200'\n                              }`}\n                            >\n                              {slot.display}\n                            </Button>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Evening Slots */}\n                    {groupedSlots.evening.length > 0 && (\n                      <div>\n                        <div className=\"flex items-center gap-2 mb-3\">\n                          <Moon className=\"w-4 h-4 text-indigo-500\" />\n                          <h4 className=\"font-fredoka font-semibold text-graphite\">Evening (5 PM - 9 PM)</h4>\n                          <Badge className=\"bg-indigo-50 text-indigo-700 border-indigo-200\">\n                            {groupedSlots.evening.filter(s => s.available).length} available\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2\">\n                          {groupedSlots.evening.map((slot) => (\n                            <Button\n                              key={slot.time}\n                              onClick={() => handleTimeSelect(slot.time)}\n                              variant={selectedTime === slot.time ? 'default' : 'outline'}\n                              disabled={checkingAvailability || !slot.available}\n                              className={`h-11 font-fredoka font-medium text-sm rounded-xl ${\n                                selectedTime === slot.time\n                                  ? 'bg-puretask-blue hover:bg-puretask-blue/90 text-white shadow-sm'\n                                  : !slot.available\n                                  ? 'bg-gray-50 text-gray-400 border-gray-200 cursor-not-allowed'\n                                  : 'hover:border-puretask-blue hover:bg-blue-50 border-gray-200'\n                              }`}\n                            >\n                              {slot.display}\n                            </Button>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <Alert className=\"bg-amber-50 border border-amber-200 rounded-xl\">\n                    <AlertCircle className=\"w-5 h-5 text-amber-600\" />\n                    <AlertDescription className=\"text-amber-900 font-verdana\">\n                      No time slots available on this date. Please select another day.\n                    </AlertDescription>\n                  </Alert>\n                )}\n                {checkingAvailability && (\n                  <div className=\"text-center text-gray-600 font-verdana mt-4 flex items-center justify-center gap-2\">\n                    <Sparkles className=\"w-4 h-4 animate-spin\" />\n                    Checking availability...\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Error Messages */}\n      <AnimatePresence>\n        {availabilityError && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n          >\n            <Alert className=\"bg-red-50 border border-red-200 rounded-xl\">\n              <AlertCircle className=\"w-4 h-4 text-red-600\" />\n              <AlertDescription className=\"text-red-900 font-verdana\">\n                {availabilityError}\n              </AlertDescription>\n            </Alert>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Cleaner Availability Info */}\n      {cleaner?.availability && (\n        <Alert className=\"bg-blue-50 border border-blue-200 rounded-xl\">\n          <Info className=\"w-4 h-4 text-puretask-blue\" />\n          <AlertDescription className=\"text-gray-700 font-verdana\">\n            <strong className=\"font-fredoka text-sm text-graphite\">{cleaner.full_name}'s Available Days:</strong>\n            <div className=\"mt-2 flex flex-wrap gap-3 text-xs\">\n              {cleaner.availability\n                .filter(a => a.available)\n                .map((a, idx) => {\n                  const convertTo12Hour = (time) => {\n                    if (!time) return '';\n                    const [hours, minutes] = time.split(':').map(Number);\n                    const period = hours >= 12 ? 'PM' : 'AM';\n                    const hours12 = hours % 12 || 12;\n                    return `${hours12}:${String(minutes).padStart(2, '0')} ${period}`;\n                  };\n                  \n                  return (\n                    <Badge key={idx} variant=\"outline\" className=\"bg-white border-blue-200 text-gray-700\">\n                      <strong>{a.day}:</strong> {convertTo12Hour(a.start_time)} - {convertTo12Hour(a.end_time)}\n                    </Badge>\n                  );\n                })}\n            </div>\n          </AlertDescription>\n        </Alert>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CancelBookingDialog.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cancelling' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"cancelling"},"fix":{"range":[281,291],"text":""},"desc":"Remove unused variable 'cancelling'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setReason' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":8,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"setReason"},"fix":{"range":[342,353],"text":""},"desc":"Remove unused variable 'setReason'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\nimport CancellationFeePreview from './CancellationFeePreview';\n\nexport default function CancelBookingDialog({ open, onOpenChange, booking, onSuccess }) {\n  const [cancelling, setCancelling] = useState(false);\n  const [reason, setReason] = useState('');\n\n  const handleConfirmCancel = async () => {\n    setCancelling(true);\n    try {\n      await base44.functions.invoke('bookingAutomations', {\n        action: 'cancel_booking',\n        booking_id: booking.id,\n        cancelled_by: 'client',\n        cancellation_reason: reason || 'Client cancelled'\n      });\n\n      toast.success('Booking cancelled successfully');\n      onOpenChange(false);\n      if (onSuccess) onSuccess();\n    } catch (error) {\n      console.error('Error cancelling booking:', error);\n      toast.error('Failed to cancel booking');\n    } finally {\n      setCancelling(false);\n    }\n  };\n\n  return (\n    <CancellationFeePreview\n      booking={booking}\n      open={open}\n      onConfirm={handleConfirmCancel}\n      onCancel={() => onOpenChange(false)}\n    />\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CancellationFeePreview.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":2,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":45,"fix":{"range":[87,97],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[86,96],"text":""},"desc":"Remove unused variable 'Calendar'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { AlertTriangle, DollarSign, Calendar, Clock } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { motion } from 'framer-motion';\n\nexport default function CancellationFeePreview({ booking, onConfirm, onCancel, open }) {\n  const [feeInfo, setFeeInfo] = useState(null);\n\n  useEffect(() => {\n    if (!booking) return;\n\n    const now = new Date();\n    const bookingDate = new Date(booking.date);\n    const hoursUntil = (bookingDate - now) / (1000 * 60 * 60);\n\n    const escrow = booking.escrow_credits_reserved || 0;\n    let feePercent = 0;\n    let feeAmount = 0;\n    let refundAmount = escrow;\n    let reason = '';\n    let reasonColor = 'green';\n\n    if (hoursUntil > 24) {\n      // Free cancellation\n      feePercent = 0;\n      feeAmount = 0;\n      refundAmount = escrow;\n      reason = 'Free cancellation (more than 24 hours)';\n      reasonColor = 'green';\n    } else if (hoursUntil > 0) {\n      // Late cancellation fee\n      feePercent = 30;\n      feeAmount = Math.round(escrow * 0.30);\n      refundAmount = escrow - feeAmount;\n      reason = 'Late cancellation fee (less than 24 hours)';\n      reasonColor = 'yellow';\n    } else {\n      // No-show or very late\n      feePercent = 80;\n      feeAmount = Math.round(escrow * 0.80);\n      refundAmount = escrow - feeAmount;\n      reason = 'No-show fee (booking time passed)';\n      reasonColor = 'red';\n    }\n\n    setFeeInfo({\n      feePercent,\n      feeAmount,\n      refundAmount,\n      escrow,\n      reason,\n      reasonColor,\n      hoursUntil: Math.max(0, hoursUntil)\n    });\n  }, [booking]);\n\n  if (!feeInfo) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onCancel}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 font-fredoka text-xl\">\n            <AlertTriangle className={`w-6 h-6 ${\n              feeInfo.reasonColor === 'red' ? 'text-red-600' :\n              feeInfo.reasonColor === 'yellow' ? 'text-yellow-600' :\n              'text-green-600'\n            }`} />\n            Cancel This Booking?\n          </DialogTitle>\n          <DialogDescription>\n            Here's what happens when you cancel\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          {/* Timeline Info */}\n          <div className={`p-4 rounded-lg border-2 ${\n            feeInfo.reasonColor === 'red' ? 'bg-red-50 border-red-300' :\n            feeInfo.reasonColor === 'yellow' ? 'bg-yellow-50 border-yellow-300' :\n            'bg-green-50 border-green-300'\n          }`}>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Clock className=\"w-5 h-5\" />\n              <span className=\"font-fredoka font-semibold\">\n                {feeInfo.hoursUntil > 0 \n                  ? `${Math.floor(feeInfo.hoursUntil)} hours until booking`\n                  : 'Booking time has passed'}\n              </span>\n            </div>\n            <p className=\"text-sm font-verdana\">{feeInfo.reason}</p>\n          </div>\n\n          {/* Fee Breakdown */}\n          <div className=\"bg-gray-50 rounded-lg p-4 space-y-3 border-2 border-gray-200\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-gray-600 font-verdana\">Original Hold:</span>\n              <span className=\"font-fredoka font-semibold\">{feeInfo.escrow} credits</span>\n            </div>\n\n            {feeInfo.feeAmount > 0 && (\n              <motion.div\n                initial={{ opacity: 0, x: -10 }}\n                animate={{ opacity: 1, x: 0 }}\n                className=\"flex justify-between items-center text-red-600\"\n              >\n                <span className=\"font-verdana flex items-center gap-1\">\n                  <DollarSign className=\"w-4 h-4\" />\n                  Cancellation Fee ({feeInfo.feePercent}%):\n                </span>\n                <span className=\"font-fredoka font-bold\">-{feeInfo.feeAmount} credits</span>\n              </motion.div>\n            )}\n\n            <div className=\"pt-3 border-t-2 border-gray-300 flex justify-between items-center\">\n              <span className=\"text-gray-900 font-fredoka font-semibold\">You Get Back:</span>\n              <span className=\"text-2xl font-fredoka font-bold text-green-600\">\n                {feeInfo.refundAmount} credits\n              </span>\n            </div>\n          </div>\n\n          {/* Warning Message */}\n          {feeInfo.feeAmount > 0 && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              className=\"bg-yellow-50 border-l-4 border-yellow-400 p-3 text-sm\"\n            >\n              <p className=\"font-verdana text-yellow-800\">\n                <strong>Note:</strong> To avoid fees, cancel at least 24 hours before your scheduled time.\n              </p>\n            </motion.div>\n          )}\n        </div>\n\n        <DialogFooter className=\"gap-2\">\n          <Button variant=\"outline\" onClick={onCancel} className=\"font-fredoka\">\n            Keep Booking\n          </Button>\n          <Button\n            onClick={onConfirm}\n            className={`font-fredoka ${\n              feeInfo.feeAmount > 0 \n                ? 'bg-red-600 hover:bg-red-700' \n                : 'bg-blue-600 hover:bg-blue-700'\n            }`}\n          >\n            Confirm Cancellation\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CancellationPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CancellationPolicyEnforcement.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ClientBookingCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"fix":{"range":[403,420],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[402,419],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":10,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":61,"fix":{"range":[451,464],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[451,464],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CancelBookingDialog' is defined but never used.","line":13,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":27,"fix":{"range":[523,580],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CancelBookingDialog"},"fix":{"range":[530,555],"text":""},"desc":"Remove unused variable 'CancelBookingDialog'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onUpdate' is defined but never used. Allowed unused args must match /^_/u.","line":22,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":62,"suggestions":[{"messageId":"removeVar","data":{"varName":"onUpdate"},"fix":{"range":[1040,1050],"text":""},"desc":"Remove unused variable 'onUpdate'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'showCancelDialog' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"showCancelDialog"},"fix":{"range":[1160,1176],"text":""},"desc":"Remove unused variable 'showCancelDialog'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":26,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[1227,1234],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isPastBooking' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":84,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"isPastBooking"},"fix":{"range":[3203,3272],"text":""},"desc":"Remove unused variable 'isPastBooking'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  MapPin, Calendar, Clock, User, DollarSign, Sparkles,\n  MessageSquare, CalendarRange, X, CheckCircle2, AlertCircle\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport CancelBookingDialog from './CancelBookingDialog';\nimport MessageButton from '../messaging/MessageButton';\nimport EscrowStatusBadge from './EscrowStatusBadge';\nimport FallbackCleanerStatus from './FallbackCleanerStatus';\nimport AutoApprovalWarning from './AutoApprovalWarning';\nimport ReviewCountdownTimer from './ReviewCountdownTimer';\nimport HoursComparisonDisplay from './HoursComparisonDisplay';\nimport PricingBreakdownCard from './PricingBreakdownCard';\n\nexport default function ClientBookingCard({ booking, onUpdate, showActions }) {\n  const navigate = useNavigate();\n  const [cleaner, setCleaner] = useState(null);\n  const [showCancelDialog, setShowCancelDialog] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadCleaner();\n  }, [booking]);\n\n  const loadCleaner = async () => {\n    try {\n      const profiles = await base44.entities.CleanerProfile.filter({\n        user_email: booking.cleaner_email\n      });\n      if (profiles.length > 0) {\n        setCleaner(profiles[0]);\n      }\n    } catch (error) {\n      console.error('Error loading cleaner:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleReschedule = () => {\n    localStorage.setItem('rescheduleBookingId', booking.id);\n    navigate(createPageUrl('BookingFlow') + `?cleaner=${booking.cleaner_email}&reschedule=true`);\n  };\n\n\n\n  const getStatusBadge = (status) => {\n    const statusConfig = {\n      created: { label: 'Created', variant: 'secondary' },\n      payment_hold: { label: 'Payment Hold', variant: 'secondary' },\n      awaiting_cleaner_response: { label: 'Awaiting Response', variant: 'warningSoft' },\n      accepted: { label: 'Accepted', variant: 'success' },\n      scheduled: { label: 'Scheduled', variant: 'system' },\n      on_the_way: { label: 'On The Way', variant: 'systemSoft' },\n      in_progress: { label: 'In Progress', variant: 'system' },\n      completed: { label: 'Completed', variant: 'success' },\n      awaiting_client: { label: 'Awaiting Review', variant: 'warningSoft' },\n      approved: { label: 'Approved', variant: 'success' },\n      cancelled: { label: 'Cancelled', variant: 'error' },\n      disputed: { label: 'Disputed', variant: 'error' }\n    };\n\n    const config = statusConfig[status] || { label: status, variant: 'secondary' };\n    return <Badge variant={config.variant} className=\"font-heading\">{config.label}</Badge>;\n  };\n\n  const getCleaningTypeLabel = (type) => {\n    const types = {\n      basic: 'Basic Cleaning',\n      deep: 'Deep Cleaning',\n      moveout: 'Move-Out Cleaning'\n    };\n    return types[type] || type;\n  };\n\n  const bookingDate = booking.date ? new Date(booking.date) : null;\n  const isPastBooking = bookingDate ? bookingDate < new Date() : false;\n\n  return (\n    <>\n      <Card className=\"hover:shadow-lg transition-shadow\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex flex-col md:flex-row md:items-start md:justify-between gap-4\">\n            {/* Left Section */}\n            <div className=\"flex-1 space-y-3\">\n              {/* Header */}\n              <div className=\"flex items-start justify-between\">\n                <div>\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Sparkles className=\"w-5 h-5 text-system\" />\n                    <h3 className=\"text-xl font-heading font-bold text-graphite\">\n                      {getCleaningTypeLabel(booking.cleaning_type)}\n                    </h3>\n                  </div>\n                  <div className=\"flex items-center gap-2 flex-wrap\">\n                    {getStatusBadge(booking.status)}\n                    <EscrowStatusBadge booking={booking} />\n                  </div>\n                </div>\n              </div>\n\n              {/* Cleaner Info */}\n              {cleaner && (\n                <div className=\"flex items-center gap-2 text-gray-700\">\n                  <User className=\"w-4 h-4 text-puretask-blue\" />\n                  <span className=\"font-verdana font-semibold\">{cleaner.business_name || cleaner.user_email}</span>\n                </div>\n              )}\n\n              {/* Date & Time */}\n              <div className=\"flex items-center gap-4 text-gray-600 font-verdana\">\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-4 h-4 text-puretask-blue\" />\n                  <span>{bookingDate ? format(bookingDate, 'MMM dd, yyyy') : 'N/A'}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Clock className=\"w-4 h-4 text-puretask-blue\" />\n                  <span>{booking.start_time || 'N/A'} ({booking.hours}h)</span>\n                </div>\n              </div>\n\n              {/* Address */}\n              <div className=\"flex items-start gap-2 text-gray-600 font-verdana\">\n                <MapPin className=\"w-4 h-4 text-puretask-blue mt-1 flex-shrink-0\" />\n                <span className=\"text-sm\">{booking.address}</span>\n              </div>\n\n              {/* Additional Services */}\n              {booking.additional_services && Object.keys(booking.additional_services).length > 0 && (\n                <div className=\"flex flex-wrap gap-2 mt-2\">\n                  {Object.keys(booking.additional_services)\n                    .filter(key => booking.additional_services[key] > 0)\n                    .map(key => {\n                      const serviceNames = {\n                        windows: 'Windows',\n                        blinds: 'Blinds',\n                        oven: 'Oven',\n                        refrigerator: 'Refrigerator',\n                        light_fixtures: 'Light Fixtures',\n                        inside_cabinets: 'Inside Cabinets',\n                        baseboards: 'Baseboards',\n                        laundry: 'Laundry'\n                      };\n                      return (\n                        <Badge key={key} variant=\"outline\" className=\"text-xs font-verdana\">\n                          +{serviceNames[key]} x{booking.additional_services[key]}\n                        </Badge>\n                      );\n                    })}\n                </div>\n              )}\n\n              {/* Fallback Status */}\n              {(booking.status === 'checking_fallback' || booking.status === 'open_to_fallbacks') && (\n                <FallbackCleanerStatus booking={booking} />\n              )}\n\n              {/* Auto-Approval Warning */}\n              {booking.status === 'awaiting_client' && booking.client_review_deadline && (\n                <AutoApprovalWarning booking={booking} />\n              )}\n\n              {/* Review Countdown Timer */}\n              {booking.status === 'awaiting_client' && booking.client_review_deadline && (\n                <ReviewCountdownTimer deadline={booking.client_review_deadline} />\n              )}\n\n              {/* Hours Comparison */}\n              {booking.check_out_time && booking.actual_hours && (\n                <HoursComparisonDisplay booking={booking} />\n              )}\n\n              {/* Price */}\n              <div className=\"flex items-center gap-2 text-lg font-fredoka font-bold text-graphite\">\n                <DollarSign className=\"w-5 h-5 text-fresh-mint\" />\n                <span>{booking.final_charge_credits || booking.total_price} credits</span>\n              </div>\n\n              {/* Pricing Breakdown */}\n              <PricingBreakdownCard booking={booking} />\n\n              {/* Cancellation Info */}\n              {booking.status === 'cancelled' && booking.cancelled_by && (\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-sm\">\n                  <p className=\"font-verdana text-gray-700\">\n                    <span className=\"font-semibold\">Cancelled by:</span> {booking.cancelled_by}\n                  </p>\n                  {booking.cancellation_reason && (\n                    <p className=\"font-verdana text-gray-600 mt-1\">\n                      <span className=\"font-semibold\">Reason:</span> {booking.cancellation_reason}\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Right Section - Actions */}\n            {showActions && (\n              <div className=\"flex flex-col gap-2 md:min-w-[200px]\">\n                {booking.cleaner_email && (\n                  <MessageButton\n                    recipientEmail={booking.cleaner_email}\n                    bookingId={booking.id}\n                    variant=\"outline\"\n                    className=\"w-full\"\n                  />\n                )}\n\n                {booking.status === 'awaiting_cleaner_response' || booking.status === 'accepted' || booking.status === 'scheduled' ? (\n                  <>\n                    <Button\n                      onClick={handleReschedule}\n                      variant=\"outline\"\n                      className=\"w-full\"\n                    >\n                      <CalendarRange className=\"w-4 h-4 mr-2\" />\n                      Reschedule\n                    </Button>\n                    <Button\n                      onClick={() => setShowCancelDialog(true)}\n                      variant=\"outline\"\n                      className=\"w-full border-red-300 text-red-600 hover:bg-red-50\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      Cancel Booking\n                    </Button>\n                  </>\n                ) : null}\n\n                {booking.status === 'awaiting_client' && (\n                  <Button\n                    onClick={() => navigate(createPageUrl('ClientReview') + `?booking=${booking.id}`)}\n                    className=\"w-full brand-gradient\"\n                  >\n                    <CheckCircle2 className=\"w-4 h-4 mr-2\" />\n                    Review & Approve\n                  </Button>\n                )}\n\n                {booking.status === 'completed' && !booking.review_submitted && (\n                  <Button\n                    onClick={() => navigate(createPageUrl('ClientReview') + `?booking=${booking.id}`)}\n                    variant=\"outline\"\n                    className=\"w-full\"\n                  >\n                    Leave Review\n                  </Button>\n                )}\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Using new CancellationFeePreview instead of old CancelBookingDialog */}\n      {/* <CancelBookingDialog\n        open={showCancelDialog}\n        onOpenChange={setShowCancelDialog}\n        booking={booking}\n        onSuccess={onUpdate}\n      /> */}\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ConflictChecker.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\CopyLastBookingButton.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":4,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":27,"fix":{"range":[159,172],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[159,172],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { base44 } from '@/api/base44Client';\nimport { Copy, CheckCircle } from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function CopyLastBookingButton({ userEmail, onCopy }) {\n  const [lastBooking, setLastBooking] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadLastBooking();\n  }, [userEmail]);\n\n  const loadLastBooking = async () => {\n    try {\n      const bookings = await base44.entities.Booking.filter(\n        { client_email: userEmail },\n        '-created_date',\n        1\n      );\n      \n      if (bookings.length > 0) {\n        setLastBooking(bookings[0]);\n      }\n    } catch (error) {\n      console.error('Error loading last booking:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleCopy = () => {\n    if (!lastBooking) return;\n\n    const copiedData = {\n      address: lastBooking.address,\n      latitude: lastBooking.latitude,\n      longitude: lastBooking.longitude,\n      bedrooms: lastBooking.bedrooms,\n      bathrooms: lastBooking.bathrooms,\n      square_feet: lastBooking.square_feet,\n      home_type: lastBooking.home_type,\n      has_pets: lastBooking.has_pets,\n      parking_instructions: lastBooking.parking_instructions,\n      entry_instructions: lastBooking.entry_instructions,\n      product_preferences: lastBooking.product_preferences,\n      product_allergies: lastBooking.product_allergies\n    };\n\n    onCopy(copiedData);\n    toast.success('Copied details from your last booking!');\n  };\n\n  if (loading || !lastBooking) {\n    return null;\n  }\n\n  return (\n    <Button\n      type=\"button\"\n      variant=\"outline\"\n      onClick={handleCopy}\n      className=\"rounded-full font-fredoka font-semibold border-2 border-blue-300 hover:bg-blue-50 text-blue-700\"\n    >\n      <Copy className=\"w-4 h-4 mr-2\" />\n      Copy from Last Booking\n    </Button>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\DraftBookingBanner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\EscrowReleaseTimer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"fix":{"range":[155,204],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[155,203],"text":""},"desc":"Remove unused variable 'Button'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Clock, CheckCircle, Loader2, AlertTriangle } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { differenceInHours, differenceInMinutes, addHours, format } from 'date-fns';\nimport { toast } from 'sonner';\n\nexport default function EscrowReleaseTimer({ booking, onUpdate }) {\n  const [timeRemaining, setTimeRemaining] = useState(null);\n  const [releasing, setReleasing] = useState(false);\n\n  useEffect(() => {\n    if (booking.status === 'completed' && !booking.payment_captured) {\n      calculateTimeRemaining();\n      const interval = setInterval(calculateTimeRemaining, 60000); // Update every minute\n      return () => clearInterval(interval);\n    }\n  }, [booking]);\n\n  const calculateTimeRemaining = () => {\n    if (!booking.check_out_time) return;\n\n    const checkoutTime = new Date(booking.check_out_time);\n    const releaseTime = addHours(checkoutTime, 48);\n    const now = new Date();\n\n    const hoursLeft = differenceInHours(releaseTime, now);\n    const minutesLeft = differenceInMinutes(releaseTime, now) % 60;\n\n    setTimeRemaining({\n      hours: Math.max(0, hoursLeft),\n      minutes: Math.max(0, minutesLeft),\n      releaseTime,\n      isPastDeadline: now > releaseTime\n    });\n  };\n\n  const handleAutoRelease = async () => {\n    setReleasing(true);\n    try {\n      // Auto-approve the booking\n      await base44.entities.Booking.update(booking.id, {\n        status: 'approved',\n        payment_captured: true\n      });\n\n      // Record final charge\n      const actualHours = booking.actual_hours || booking.hours;\n      const totalRateCPH = booking.snapshot_total_rate_cph || 300;\n      const additionalServicesCredits = booking.additional_services_cost_credits || 0;\n      const finalCharge = (actualHours * totalRateCPH) + additionalServicesCredits;\n\n      await base44.entities.Booking.update(booking.id, {\n        final_charge_credits: finalCharge\n      });\n\n      toast.success('Payment automatically released to cleaner');\n      if (onUpdate) onUpdate();\n    } catch (error) {\n      console.error('Error auto-releasing payment:', error);\n      toast.error('Failed to release payment');\n    }\n    setReleasing(false);\n  };\n\n  useEffect(() => {\n    // Auto-release if past deadline\n    if (timeRemaining?.isPastDeadline && !booking.payment_captured && !releasing) {\n      handleAutoRelease();\n    }\n  }, [timeRemaining?.isPastDeadline]);\n\n  if (!timeRemaining || booking.payment_captured) {\n    return null;\n  }\n\n  const percentage = ((48 - timeRemaining.hours) / 48) * 100;\n  const isUrgent = timeRemaining.hours < 6;\n\n  return (\n    <Card className={`border-2 shadow-lg rounded-2xl ${\n      isUrgent ? 'border-amber-400 bg-amber-50' : 'border-blue-300 bg-blue-50'\n    }`}>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-start justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <Clock className={`w-6 h-6 ${isUrgent ? 'text-amber-600' : 'text-puretask-blue'}`} />\n            <div>\n              <p className=\"font-fredoka font-bold text-graphite\">\n                {timeRemaining.isPastDeadline ? 'Auto-Approval Processing' : 'Auto-Approval Timer'}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">\n                Payment will be automatically released to cleaner\n              </p>\n            </div>\n          </div>\n          <Badge className={`${\n            isUrgent ? 'bg-amber-500' : 'bg-puretask-blue'\n          } text-white rounded-full font-fredoka`}>\n            {timeRemaining.isPastDeadline ? 'Processing' : 'Pending'}\n          </Badge>\n        </div>\n\n        {!timeRemaining.isPastDeadline ? (\n          <>\n            <div className=\"mb-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"text-sm font-verdana text-gray-600\">Time Remaining</span>\n                <span className={`font-fredoka font-bold ${\n                  isUrgent ? 'text-amber-700' : 'text-puretask-blue'\n                }`}>\n                  {timeRemaining.hours}h {timeRemaining.minutes}m\n                </span>\n              </div>\n              \n              <div className=\"w-full bg-gray-200 rounded-full h-3 overflow-hidden\">\n                <motion.div\n                  className={`h-3 ${isUrgent ? 'bg-amber-500' : 'bg-puretask-blue'}`}\n                  initial={{ width: 0 }}\n                  animate={{ width: `${percentage}%` }}\n                  transition={{ duration: 0.5 }}\n                />\n              </div>\n            </div>\n\n            <Alert className={`${\n              isUrgent ? 'border-amber-300 bg-amber-100' : 'border-blue-200 bg-blue-100'\n            } rounded-2xl`}>\n              <AlertDescription className=\"text-sm font-verdana\">\n                {isUrgent ? (\n                  <>\n                    <AlertTriangle className=\"w-4 h-4 inline mr-2 text-amber-700\" />\n                    <strong>Action needed soon!</strong> Payment will auto-release at{' '}\n                    {format(timeRemaining.releaseTime, 'MMM d, h:mm a')}\n                  </>\n                ) : (\n                  <>\n                    <Clock className=\"w-4 h-4 inline mr-2 text-blue-700\" />\n                    Payment will automatically release at{' '}\n                    {format(timeRemaining.releaseTime, 'MMM d, h:mm a')} if no action is taken\n                  </>\n                )}\n              </AlertDescription>\n            </Alert>\n\n            <div className=\"mt-4 p-4 bg-white rounded-2xl border border-gray-200\">\n              <p className=\"text-sm font-fredoka font-semibold text-graphite mb-2\">\n                What happens at auto-release?\n              </p>\n              <ul className=\"space-y-1 text-sm font-verdana text-gray-600\">\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5\" />\n                  <span>Payment is released to the cleaner</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5\" />\n                  <span>Booking is marked as approved</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5\" />\n                  <span>You can still submit a review</span>\n                </li>\n              </ul>\n            </div>\n          </>\n        ) : (\n          <div className=\"flex items-center justify-center py-6\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue mr-3\" />\n            <p className=\"font-fredoka font-semibold text-graphite\">\n              Releasing payment to cleaner...\n            </p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\EscrowStatusBadge.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25,"fix":{"range":[12,26],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[12,26],"text":""},"desc":"Remove unused variable 'useState'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Shield, Lock, CheckCircle2, HelpCircle } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip';\nimport { motion } from 'framer-motion';\n\nexport default function EscrowStatusBadge({ booking }) {\n  const getEscrowStatus = () => {\n    if (!booking.payment_held && !booking.payment_captured) {\n      return {\n        status: 'released',\n        label: 'Refunded',\n        color: 'bg-gray-100 text-gray-700 border-gray-300',\n        icon: CheckCircle2,\n        description: 'Credits returned to your wallet'\n      };\n    }\n\n    if (booking.payment_held && !booking.payment_captured) {\n      return {\n        status: 'held',\n        label: 'Held in Escrow',\n        color: 'bg-yellow-100 text-yellow-700 border-yellow-300',\n        icon: Lock,\n        description: `${booking.escrow_credits_reserved || 0} credits held safely until job completion`\n      };\n    }\n\n    if (booking.payment_captured) {\n      return {\n        status: 'captured',\n        label: 'Payment Settled',\n        color: 'bg-green-100 text-green-700 border-green-300',\n        icon: CheckCircle2,\n        description: `Final charge: ${booking.final_charge_credits || 0} credits`\n      };\n    }\n\n    return {\n      status: 'unknown',\n      label: 'Processing',\n      color: 'bg-gray-100 text-gray-700 border-gray-300',\n      icon: Shield,\n      description: 'Payment processing...'\n    };\n  };\n\n  const escrow = getEscrowStatus();\n  const Icon = escrow.icon;\n\n  return (\n    <TooltipProvider>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <motion.div\n            whileHover={{ scale: 1.05 }}\n            className=\"inline-block\"\n          >\n            <Badge className={`${escrow.color} border-2 font-fredoka font-semibold px-3 py-1.5 flex items-center gap-2 cursor-help`}>\n              <Icon className=\"w-4 h-4\" />\n              {escrow.label}\n              <HelpCircle className=\"w-3 h-3 opacity-60\" />\n            </Badge>\n          </motion.div>\n        </TooltipTrigger>\n        <TooltipContent className=\"max-w-xs\">\n          <div className=\"space-y-2\">\n            <p className=\"font-fredoka font-semibold\">Payment Protection</p>\n            <p className=\"text-sm\">{escrow.description}</p>\n            \n            {escrow.status === 'held' && (\n              <div className=\"text-xs text-gray-500 mt-2 pt-2 border-t\">\n                <p>‚Ä¢ Credits are safe and reserved for this job</p>\n                <p>‚Ä¢ Adjusted after actual hours are calculated</p>\n                <p>‚Ä¢ Refunded if job is cancelled early</p>\n              </div>\n            )}\n\n            {escrow.status === 'captured' && booking.refund_credits > 0 && (\n              <div className=\"text-xs text-green-600 mt-2 pt-2 border-t\">\n                <p>‚úì Refunded {booking.refund_credits} credits (actual &lt; estimate)</p>\n              </div>\n            )}\n          </div>\n        </TooltipContent>\n      </Tooltip>\n    </TooltipProvider>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\FallbackCleanerSelector.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingDate' is defined but never used. Allowed unused args must match /^_/u.","line":43,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingDate"},"fix":{"range":[1721,1736],"text":""},"desc":"Remove unused variable 'bookingDate'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingTime' is defined but never used. Allowed unused args must match /^_/u.","line":44,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingTime"},"fix":{"range":[1736,1751],"text":""},"desc":"Remove unused variable 'bookingTime'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Badge } from '@/components/ui/badge';\nimport { Info, Sparkles, CheckCircle, AlertCircle, Star } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n// Helper for Skeleton Card\nconst SkeletonCleanerCard = () => (\n  <div className=\"relative p-4 rounded-lg border-2 border-slate-200 bg-white animate-pulse\">\n    <div className=\"flex items-start gap-3 mb-3\">\n      <div className=\"w-16 h-16 bg-slate-200 rounded-lg\"></div>\n      <div className=\"flex-1\">\n        <div className=\"h-5 bg-slate-200 rounded w-3/4 mb-2\"></div>\n        <div className=\"h-4 bg-slate-200 rounded w-1/2\"></div>\n      </div>\n      <div className=\"text-right\">\n        <div className=\"h-6 bg-slate-200 rounded w-12 mb-1\"></div>\n        <div className=\"h-3 bg-slate-200 rounded w-8\"></div>\n      </div>\n    </div>\n    <div className=\"flex items-center gap-2 flex-wrap\">\n      <div className=\"h-5 bg-slate-200 rounded w-20\"></div>\n      <div className=\"h-5 bg-slate-200 rounded w-32\"></div>\n    </div>\n  </div>\n);\n\n// Helper for Tier Badge colors\nconst getTierColorClasses = (tier) => {\n  switch (tier) {\n    case 'Developing': return { bg: 'bg-blue-100 text-blue-800 border-blue-200' };\n    case 'Semi Pro': return { bg: 'bg-green-100 text-green-800 border-green-200' };\n    case 'Pro': return { bg: 'bg-purple-100 text-purple-800 border-purple-200' };\n    case 'Elite': return { bg: 'bg-yellow-100 text-yellow-800 border-yellow-200' };\n    default: return { bg: 'bg-slate-100 text-slate-800 border-slate-200' };\n  }\n};\n\nexport default function FallbackCleanerSelector({ \n  primaryCleanerEmail, \n  selectedBackups = [], \n  onBackupsChange,\n  bookingDate,\n  bookingTime \n}) {\n  const [availableCleaners, setAvailableCleaners] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [primaryCleaner, setPrimaryCleaner] = useState(null);\n\n  useEffect(() => {\n    if (primaryCleanerEmail) {\n      loadAvailableCleaners();\n    }\n  }, [primaryCleanerEmail]);\n\n  // Calculate similarity score between cleaners\n  const scoreCleanerSimilarity = (cleaner, primaryCleaner) => {\n    let score = 0;\n    \n    // Similar hourly rate (within $10)\n    const rateDiff = Math.abs(cleaner.hourly_rate - primaryCleaner.hourly_rate);\n    if (rateDiff <= 10) {\n      score += 30;\n    } else if (rateDiff <= 20) {\n      score += 15;\n    }\n    \n    // Same tier\n    if (cleaner.tier === primaryCleaner.tier) {\n      score += 25;\n    } else {\n      // Adjacent tiers get partial credit\n      const tiers = ['Developing', 'Semi Pro', 'Pro', 'Elite'];\n      const primaryIndex = tiers.indexOf(primaryCleaner.tier);\n      const cleanerIndex = tiers.indexOf(cleaner.tier);\n      if (primaryIndex !== -1 && cleanerIndex !== -1 && Math.abs(primaryIndex - cleanerIndex) === 1) {\n        score += 12;\n      }\n    }\n    \n    // Similar rating (within 0.5 stars)\n    const ratingDiff = Math.abs(cleaner.average_rating - primaryCleaner.average_rating);\n    if (ratingDiff <= 0.5) {\n      score += 20;\n    } else if (ratingDiff <= 1.0) {\n      score += 10;\n    }\n    \n    // Overlapping service tags\n    const primaryTags = new Set(primaryCleaner.service_tags || []);\n    const overlap = (cleaner.service_tags || []).filter(t => primaryTags.has(t));\n    score += overlap.length * 5;\n    \n    // High reliability score\n    if (cleaner.reliability_score >= 85) {\n      score += 15;\n    } else if (cleaner.reliability_score >= 75) {\n      score += 8;\n    }\n    \n    // Similar product preference\n    if (cleaner.product_preference === primaryCleaner.product_preference) {\n      score += 10;\n    }\n    \n    return score;\n  };\n\n  const loadAvailableCleaners = async () => {\n    setLoading(true);\n    try {\n      const [fetchedPrimary] = await base44.entities.CleanerProfile.filter(\n        { user_email: primaryCleanerEmail }\n      );\n      setPrimaryCleaner(fetchedPrimary);\n      \n      if (!fetchedPrimary) {\n        setAvailableCleaners([]);\n        setLoading(false);\n        return;\n      }\n      \n      const allCleaners = await base44.entities.CleanerProfile.filter(\n        { is_active: true },\n        '-reliability_score',\n        100\n      );\n      \n      const others = allCleaners\n        .filter(c => \n          c.user_email !== primaryCleanerEmail &&\n          c.service_locations?.some(loc => fetchedPrimary.service_locations?.includes(loc))\n        )\n        .map(c => ({\n          ...c,\n          similarityScore: scoreCleanerSimilarity(c, fetchedPrimary)\n        }))\n        .sort((a, b) => b.similarityScore - a.similarityScore)\n        .slice(0, 8);\n      \n      setAvailableCleaners(others);\n      \n      // Auto-select top 2 if no selections yet\n      if (selectedBackups.length === 0 && others.length >= 2) {\n        onBackupsChange([others[0].user_email, others[1].user_email]);\n      }\n    } catch (error) {\n      console.error('Error loading backup cleaners:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleToggleBackup = (cleanerEmail) => {\n    const current = [...selectedBackups];\n    const index = current.indexOf(cleanerEmail);\n    \n    if (index > -1) {\n      current.splice(index, 1);\n    } else {\n      current.push(cleanerEmail);\n    }\n    \n    onBackupsChange(current);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-start gap-3 p-4 bg-blue-50 rounded-lg border border-blue-200\">\n        <Info className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n        <div>\n          <p className=\"font-medium text-blue-900 mb-1\">Smart Backup Selection</p>\n          <p className=\"text-sm text-blue-800\">\n            We've pre-selected the 2 most similar cleaners to {primaryCleaner?.full_name || 'your first choice'} \n            based on rate, tier, ratings, and services. You can change these anytime.\n          </p>\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          {[...Array(4)].map((_, i) => (\n            <SkeletonCleanerCard key={i} />\n          ))}\n        </div>\n      ) : (\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          {availableCleaners.map((cleaner, index) => {\n            const isRecommended = index < 2;\n            const isSelected = selectedBackups.includes(cleaner.user_email);\n            const selectionIndex = selectedBackups.indexOf(cleaner.user_email);\n            \n            return (\n              <motion.div\n                key={cleaner.user_email}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.1 }}\n                className={`relative p-4 rounded-lg border-2 transition-all cursor-pointer ${\n                  isSelected \n                    ? 'border-emerald-500 bg-emerald-50' \n                    : 'border-slate-200 bg-white hover:border-emerald-300'\n                }`}\n                onClick={() => handleToggleBackup(cleaner.user_email)}\n              >\n                {isRecommended && !isSelected && (\n                  <div className=\"absolute -top-2 -right-2 z-10\">\n                    <Badge className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg\">\n                      <Sparkles className=\"w-3 h-3 mr-1\" />\n                      Recommended\n                    </Badge>\n                  </div>\n                )}\n                \n                {isSelected && (\n                  <div className=\"absolute -top-2 -right-2 z-10\">\n                    <Badge className=\"bg-emerald-500 text-white shadow-lg\">\n                      Backup #{selectionIndex + 1}\n                    </Badge>\n                  </div>\n                )}\n\n                <div className=\"flex items-start gap-3 mb-3\">\n                  <div className=\"relative\">\n                    {cleaner.profile_photo_url ? (\n                      <img\n                        src={cleaner.profile_photo_url}\n                        alt={cleaner.full_name}\n                        className=\"w-16 h-16 rounded-lg object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-16 h-16 bg-gradient-to-br from-emerald-400 to-cyan-500 rounded-lg flex items-center justify-center text-white text-xl font-bold\">\n                        {cleaner.full_name ? cleaner.full_name[0].toUpperCase() : '?'}\n                      </div>\n                    )}\n                    {isSelected && (\n                      <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center\">\n                        <CheckCircle className=\"w-4 h-4 text-white\" />\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-semibold text-slate-900\">{cleaner.full_name}</h4>\n                    <div className=\"flex items-center gap-2 text-sm text-slate-600 mt-1\">\n                      <Star className=\"w-4 h-4 text-amber-400 fill-current\" />\n                      <span>{cleaner.average_rating?.toFixed(1) || 'N/A'}</span>\n                      <span>‚Ä¢</span>\n                      <span>{cleaner.total_jobs || 0} jobs</span>\n                    </div>\n                  </div>\n\n                  <div className=\"text-right\">\n                    <p className=\"text-lg font-bold text-emerald-600\">\n                      ${cleaner.hourly_rate}\n                    </p>\n                    <p className=\"text-xs text-slate-500\">per hour</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2 flex-wrap\">\n                  <Badge variant=\"outline\" className={getTierColorClasses(cleaner.tier).bg}>\n                    {cleaner.tier}\n                  </Badge>\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {cleaner.reliability_score}/100 reliability\n                  </Badge>\n                </div>\n\n                {isRecommended && (\n                  <div className=\"mt-3 p-2 bg-purple-50 rounded text-xs text-purple-700\">\n                    <strong>Why recommended:</strong> Similar rate, tier, and services\n                  </div>\n                )}\n              </motion.div>\n            );\n          })}\n        </div>\n      )}\n\n      {selectedBackups.length === 0 && !loading && (\n        <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200 flex items-start gap-3\">\n          <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0\" />\n          <div>\n            <p className=\"font-medium text-amber-900 mb-1\">No Backup Cleaners Selected</p>\n            <p className=\"text-sm text-amber-800\">\n              Select at least one backup to ensure your cleaning gets confirmed even if your \n              first choice isn't available.\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\FallbackCleanerStatus.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle2' is defined but never used.","line":2,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36,"fix":{"range":[49,63],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle2"},"fix":{"range":[48,62],"text":""},"desc":"Remove unused variable 'CheckCircle2'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Users, Clock, CheckCircle2, XCircle, Loader2 } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { motion } from 'framer-motion';\n\nexport default function FallbackCleanerStatus({ booking }) {\n  if (!booking) return null;\n\n  const isFallbackMode = booking.status === 'checking_fallback' || \n                         booking.status === 'open_to_fallbacks' ||\n                         (booking.requested_cleaners && booking.requested_cleaners.length > 1);\n\n  if (!isFallbackMode) return null;\n\n  const requestedCount = booking.requested_cleaners?.length || 0;\n  const totalFallbacks = booking.fallback_cleaners?.length || 0;\n  const currentCleaner = booking.current_request_cleaner_email;\n\n  const isOpenToAll = booking.status === 'open_to_fallbacks';\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"bg-blue-50 border-2 border-blue-300 rounded-xl p-4\"\n    >\n      <div className=\"flex items-start gap-3\">\n        <div className=\"mt-1\">\n          {isOpenToAll ? (\n            <Users className=\"w-6 h-6 text-blue-600\" />\n          ) : (\n            <Loader2 className=\"w-6 h-6 text-blue-600 animate-spin\" />\n          )}\n        </div>\n\n        <div className=\"flex-1\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h4 className=\"font-fredoka font-bold text-blue-900\">\n              {isOpenToAll ? 'Finding You a Cleaner' : 'Checking Availability'}\n            </h4>\n            <Badge className=\"bg-blue-600 text-white font-fredoka\">\n              {requestedCount}/{Math.max(requestedCount, totalFallbacks)} Asked\n            </Badge>\n          </div>\n\n          <p className=\"text-sm text-gray-700 font-verdana mb-3\">\n            {isOpenToAll ? (\n              <>We've sent your request to <strong>{totalFallbacks} qualified cleaners</strong>. First to accept gets the job!</>\n            ) : (\n              <>Waiting for response from alternative cleaner. We'll notify you once confirmed.</>\n            )}\n          </p>\n\n          {/* Timeline */}\n          <div className=\"space-y-2\">\n            {booking.requested_cleaners?.map((email, idx) => {\n              const isPrimary = idx === 0;\n              const isDeclined = idx < requestedCount - 1; // All but current are declined\n              const isCurrent = email === currentCleaner;\n\n              return (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, x: -10 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                  className=\"flex items-center gap-2 text-sm\"\n                >\n                  {isDeclined ? (\n                    <XCircle className=\"w-4 h-4 text-red-500 flex-shrink-0\" />\n                  ) : isCurrent ? (\n                    <Clock className=\"w-4 h-4 text-blue-500 flex-shrink-0 animate-pulse\" />\n                  ) : (\n                    <Clock className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />\n                  )}\n                  <span className=\"text-gray-600 font-verdana\">\n                    {isPrimary ? 'First Choice' : `Alternative ${idx}`} Cleaner\n                    {isDeclined && ' - Declined'}\n                    {isCurrent && ' - Waiting for response...'}\n                  </span>\n                </motion.div>\n              );\n            })}\n          </div>\n\n          {/* Expiry Info */}\n          {booking.overall_job_offer_expires_at && (\n            <div className=\"mt-3 pt-3 border-t border-blue-200\">\n              <p className=\"text-xs text-gray-600 font-verdana\">\n                <Clock className=\"w-3 h-3 inline mr-1\" />\n                Offer expires: {new Date(booking.overall_job_offer_expires_at).toLocaleDateString()} at {new Date(booking.overall_job_offer_expires_at).toLocaleTimeString()}\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\FirstTimeWizard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\HoursComparisonDisplay.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isSame' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":23,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"isSame"},"fix":{"range":[877,920],"text":""},"desc":"Remove unused variable 'isSame'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Clock, TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { motion } from 'framer-motion';\n\nexport default function HoursComparisonDisplay({ booking }) {\n  if (!booking) return null;\n\n  const estimatedHours = booking.estimated_hours || booking.hours || 0;\n  const actualHours = booking.actual_hours || booking.hours || 0;\n  const difference = actualHours - estimatedHours;\n  \n  // Only show if there's actual time tracking data\n  const hasActualData = booking.check_in_time && booking.check_out_time;\n  if (!hasActualData) return null;\n\n  const rate = booking.snapshot_total_rate_cph || 300;\n  const creditDifference = Math.abs(difference * rate);\n  const usdDifference = (creditDifference / 10).toFixed(2);\n\n  const isOver = difference > 0.1;\n  const isUnder = difference < -0.1;\n  const isSame = Math.abs(difference) <= 0.1;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      className={`rounded-xl p-4 border-2 ${\n        isOver \n          ? 'bg-red-50 border-red-300'\n          : isUnder\n          ? 'bg-green-50 border-green-300'\n          : 'bg-gray-50 border-gray-300'\n      }`}\n    >\n      <div className=\"flex items-start gap-3\">\n        <div className=\"mt-1\">\n          {isOver ? (\n            <TrendingUp className=\"w-6 h-6 text-red-600\" />\n          ) : isUnder ? (\n            <TrendingDown className=\"w-6 h-6 text-green-600\" />\n          ) : (\n            <Minus className=\"w-6 h-6 text-gray-600\" />\n          )}\n        </div>\n\n        <div className=\"flex-1\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h4 className=\"font-fredoka font-bold text-gray-900\">\n              Time Comparison\n            </h4>\n            <Badge className={`${\n              isOver \n                ? 'bg-red-600 text-white'\n                : isUnder\n                ? 'bg-green-600 text-white'\n                : 'bg-gray-600 text-white'\n            } font-fredoka font-bold`}>\n              {isOver ? '+' : ''}{difference.toFixed(1)} hrs\n            </Badge>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-3 mb-3\">\n            {/* Estimated */}\n            <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\n              <div className=\"text-xs text-gray-500 font-verdana mb-1\">Estimated</div>\n              <div className=\"flex items-center gap-2\">\n                <Clock className=\"w-4 h-4 text-gray-400\" />\n                <span className=\"text-lg font-fredoka font-semibold\">{estimatedHours}h</span>\n              </div>\n              <div className=\"text-xs text-gray-500 mt-1\">\n                {(estimatedHours * rate)} credits\n              </div>\n            </div>\n\n            {/* Actual */}\n            <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\n              <div className=\"text-xs text-gray-500 font-verdana mb-1\">Actual</div>\n              <div className=\"flex items-center gap-2\">\n                <Clock className=\"w-4 h-4 text-blue-600\" />\n                <span className=\"text-lg font-fredoka font-semibold text-blue-600\">{actualHours.toFixed(1)}h</span>\n              </div>\n              <div className=\"text-xs text-gray-500 mt-1\">\n                {(actualHours * rate).toFixed(0)} credits\n              </div>\n            </div>\n          </div>\n\n          {/* Explanation */}\n          <div className={`text-sm font-verdana p-3 rounded-lg ${\n            isOver \n              ? 'bg-red-100 text-red-800'\n              : isUnder\n              ? 'bg-green-100 text-green-800'\n              : 'bg-gray-100 text-gray-800'\n          }`}>\n            {isOver ? (\n              <>\n                <strong>Additional charge:</strong> Job took longer than estimated.\n                <br />\n                <span className=\"text-xs\">+{creditDifference} credits (${usdDifference}) will be charged</span>\n              </>\n            ) : isUnder ? (\n              <>\n                <strong>Refund issued:</strong> Job finished faster than estimated!\n                <br />\n                <span className=\"text-xs\">{creditDifference} credits (${usdDifference}) refunded to your wallet</span>\n              </>\n            ) : (\n              <>\n                <strong>On target:</strong> Job completed within estimated time.\n              </>\n            )}\n          </div>\n\n          {/* Check-in/out times */}\n          <div className=\"mt-3 pt-3 border-t border-gray-200 text-xs text-gray-600 font-verdana space-y-1\">\n            <div className=\"flex justify-between\">\n              <span>Check-in:</span>\n              <span className=\"font-semibold\">\n                {booking.check_in_time && new Date(booking.check_in_time).toLocaleTimeString()}\n              </span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Check-out:</span>\n              <span className=\"font-semibold\">\n                {booking.check_out_time && new Date(booking.check_out_time).toLocaleTimeString()}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\InsufficientCreditsDialog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\LiveBookingStatus.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isPast' is defined but never used.","line":12,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":53,"fix":{"range":[550,558],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isPast"},"fix":{"range":[549,557],"text":""},"desc":"Remove unused variable 'isPast'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isFuture' is defined but never used.","line":12,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":63,"fix":{"range":[557,567],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isFuture"},"fix":{"range":[557,567],"text":""},"desc":"Remove unused variable 'isFuture'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { \n  Clock, CheckCircle, AlertCircle, Loader2, Calendar, \n  MapPin, User, MessageSquare, ArrowRight, Bell, Camera\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { format, parseISO, differenceInHours, isPast, isFuture } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\n\nconst STATUS_CONFIG = {\n  'payment_hold': {\n    label: 'Payment Hold Placed',\n    color: 'blue',\n    icon: Clock,\n    progress: 16,\n    description: 'Waiting for cleaner confirmation',\n    urgent: false\n  },\n  'awaiting_cleaner_response': {\n    label: 'Awaiting Cleaner',\n    color: 'amber',\n    icon: Clock,\n    progress: 25,\n    description: 'Cleaner has 4 hours to respond',\n    urgent: true\n  },\n  'checking_fallback': {\n    label: 'Finding Backup Cleaner',\n    color: 'purple',\n    icon: Loader2,\n    progress: 35,\n    description: 'Checking backup cleaners',\n    urgent: true\n  },\n  'scheduled': {\n    label: 'Confirmed & Scheduled',\n    color: 'emerald',\n    icon: CheckCircle,\n    progress: 50,\n    description: 'Your cleaning is all set!',\n    urgent: false\n  },\n  'on_the_way': {\n    label: 'Cleaner On The Way',\n    color: 'blue',\n    icon: MapPin,\n    progress: 75,\n    description: 'Your cleaner is heading to you',\n    urgent: false\n  },\n  'in_progress': {\n    label: 'Cleaning In Progress',\n    color: 'indigo',\n    icon: Loader2,\n    progress: 85,\n    description: 'Your home is being cleaned',\n    urgent: false\n  },\n  'completed': {\n    label: 'Completed',\n    color: 'green',\n    icon: CheckCircle,\n    progress: 100,\n    description: 'Cleaning finished - review photos',\n    urgent: false\n  },\n  'cancelled': {\n    label: 'Cancelled',\n    color: 'red',\n    icon: AlertCircle,\n    progress: 0,\n    description: 'This booking was cancelled',\n    urgent: false\n  },\n  'disputed': {\n    label: 'Under Review',\n    color: 'orange',\n    icon: AlertCircle,\n    progress: 90,\n    description: 'Support team is reviewing',\n    urgent: true\n  }\n};\n\nexport default function LiveBookingStatus({ bookingId, onUpdate }) {\n  const navigate = useNavigate();\n  const [booking, setBooking] = useState(null);\n  const [cleaner, setCleaner] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (bookingId) {\n      loadBooking();\n      // Poll for updates every 30 seconds\n      const interval = setInterval(loadBooking, 30000);\n      return () => clearInterval(interval);\n    }\n  }, [bookingId]);\n\n  const loadBooking = async () => {\n    try {\n      const fetchedBooking = await base44.entities.Booking.get(bookingId);\n      setBooking(fetchedBooking);\n\n      if (fetchedBooking.cleaner_email) {\n        const cleanerProfiles = await base44.entities.CleanerProfile.filter({\n          user_email: fetchedBooking.cleaner_email\n        });\n        if (cleanerProfiles.length > 0) {\n          setCleaner(cleanerProfiles[0]);\n        }\n      }\n\n      if (onUpdate) {\n        onUpdate(fetchedBooking);\n      }\n    } catch (err) {\n      console.error('Error loading booking:', err);\n      setError('Failed to load booking status');\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-lg\">\n        <CardContent className=\"p-6 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500 mx-auto mb-2\" />\n          <p className=\"text-sm text-slate-600\">Loading booking status...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error || !booking) {\n    return (\n      <Card className=\"border-red-200 bg-red-50\">\n        <CardContent className=\"p-6 text-center\">\n          <AlertCircle className=\"w-8 h-8 text-red-500 mx-auto mb-2\" />\n          <p className=\"text-sm text-red-800\">{error || 'Booking not found'}</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const statusConfig = STATUS_CONFIG[booking.status] || STATUS_CONFIG['payment_hold'];\n  const StatusIcon = statusConfig.icon;\n  const isUrgent = statusConfig.urgent;\n\n  const bookingDateTime = parseISO(`${booking.date}T${booking.start_time}`);\n  const hoursUntilBooking = differenceInHours(bookingDateTime, new Date());\n  const isToday = hoursUntilBooking >= 0 && hoursUntilBooking < 24;\n  const isTomorrow = hoursUntilBooking >= 24 && hoursUntilBooking < 48;\n\n  return (\n    <AnimatePresence mode=\"wait\">\n      <motion.div\n        key={booking.status}\n        initial={{ opacity: 0, y: 10 }}\n        animate={{ opacity: 1, y: 0 }}\n        exit={{ opacity: 0, y: -10 }}\n        transition={{ duration: 0.3 }}\n      >\n        <Card className={`border-2 ${\n          isUrgent ? 'border-amber-300 bg-amber-50' : 'border-slate-200 bg-white'\n        } shadow-lg overflow-hidden`}>\n          {/* Status Header */}\n          <div className={`bg-gradient-to-r ${\n            statusConfig.color === 'blue' ? 'from-blue-500 to-cyan-600' :\n            statusConfig.color === 'emerald' ? 'from-emerald-500 to-green-600' :\n            statusConfig.color === 'amber' ? 'from-amber-500 to-yellow-600' :\n            statusConfig.color === 'purple' ? 'from-purple-500 to-pink-600' :\n            statusConfig.color === 'indigo' ? 'from-indigo-500 to-blue-600' :\n            statusConfig.color === 'green' ? 'from-green-500 to-emerald-600' :\n            statusConfig.color === 'red' ? 'from-red-500 to-rose-600' :\n            'from-slate-500 to-gray-600'\n          } p-4 text-white`}>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center\">\n                  <StatusIcon className={`w-5 h-5 ${\n                    statusConfig.icon === Loader2 ? 'animate-spin' : ''\n                  }`} />\n                </div>\n                <div>\n                  <h3 className=\"font-bold text-lg\">{statusConfig.label}</h3>\n                  <p className=\"text-sm text-white/90\">{statusConfig.description}</p>\n                </div>\n              </div>\n              {isUrgent && (\n                <motion.div\n                  animate={{ scale: [1, 1.1, 1] }}\n                  transition={{ repeat: Infinity, duration: 2 }}\n                >\n                  <Bell className=\"w-5 h-5\" />\n                </motion.div>\n              )}\n            </div>\n          </div>\n\n          <CardContent className=\"p-6 space-y-4\">\n            {/* Progress Bar */}\n            <div>\n              <div className=\"flex justify-between items-center mb-2\">\n                <span className=\"text-xs font-medium text-slate-600\">Progress</span>\n                <span className=\"text-xs font-bold text-slate-900\">{statusConfig.progress}%</span>\n              </div>\n              <Progress value={statusConfig.progress} className=\"h-2\" />\n            </div>\n\n            {/* Booking Info */}\n            <div className=\"grid grid-cols-2 gap-4 pt-4 border-t border-slate-200\">\n              <div>\n                <div className=\"flex items-center gap-2 text-slate-600 mb-1\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span className=\"text-xs font-medium\">Date & Time</span>\n                </div>\n                <p className=\"text-sm font-semibold text-slate-900\">\n                  {format(bookingDateTime, 'MMM d, yyyy')}\n                </p>\n                <p className=\"text-xs text-slate-600\">{convertTo12Hour(booking.start_time)}</p>\n                {isToday && (\n                  <Badge className=\"mt-1 bg-emerald-100 text-emerald-800 border-emerald-300 text-[10px]\">\n                    Today\n                  </Badge>\n                )}\n                {isTomorrow && (\n                  <Badge className=\"mt-1 bg-blue-100 text-blue-800 border-blue-300 text-[10px]\">\n                    Tomorrow\n                  </Badge>\n                )}\n              </div>\n\n              {cleaner && (\n                <div>\n                  <div className=\"flex items-center gap-2 text-slate-600 mb-1\">\n                    <User className=\"w-4 h-4\" />\n                    <span className=\"text-xs font-medium\">Your Cleaner</span>\n                  </div>\n                  <p className=\"text-sm font-semibold text-slate-900\">{cleaner.full_name}</p>\n                  <Badge className=\"mt-1 bg-purple-100 text-purple-800 border-purple-200 text-[10px]\">\n                    {cleaner.tier} ‚Ä¢ {cleaner.average_rating.toFixed(1)}‚òÖ\n                  </Badge>\n                </div>\n              )}\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"flex gap-2 pt-4 border-t border-slate-200\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"flex-1\"\n                onClick={() => navigate(createPageUrl('Inbox'))}\n              >\n                <MessageSquare className=\"w-4 h-4 mr-2\" />\n                Message\n              </Button>\n              <Button\n                size=\"sm\"\n                className=\"flex-1 bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700\"\n                onClick={() => navigate(createPageUrl(`ClientDashboard?booking=${bookingId}`))}\n              >\n                View Details\n                <ArrowRight className=\"w-4 h-4 ml-2\" />\n              </Button>\n            </div>\n\n            {/* Time-sensitive alerts */}\n            {booking.status === 'awaiting_cleaner_response' && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                className=\"bg-amber-50 border border-amber-200 rounded-lg p-3\"\n              >\n                <div className=\"flex items-start gap-2\">\n                  <Clock className=\"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-xs text-amber-800\">\n                    <p className=\"font-semibold mb-1\">Waiting for Confirmation</p>\n                    <p>Your cleaner has 4 hours to accept. If they don't respond, we'll automatically check your backup cleaners.</p>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n\n            {booking.status === 'completed' && !booking.review_submitted && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                className=\"bg-green-50 border border-green-200 rounded-lg p-3\"\n              >\n                <div className=\"flex items-start gap-2\">\n                  <Camera className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-xs text-green-800\">\n                    <p className=\"font-semibold mb-1\">Cleaning Complete!</p>\n                    <p>Review the before/after photos and leave feedback for your cleaner.</p>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n          </CardContent>\n        </Card>\n      </motion.div>\n    </AnimatePresence>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ModificationApprovalCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ModifyBookingModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[403,450],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[403,449],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, Clock, DollarSign, Sparkles, Loader2, AlertCircle } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { toast } from 'sonner';\n\nexport default function ModifyBookingModal({ booking, open, onClose, userType }) {\n  const [modificationType, setModificationType] = useState('reschedule');\n  const [newDate, setNewDate] = useState(booking?.date || '');\n  const [newTime, setNewTime] = useState(booking?.start_time || '');\n  const [newHours, setNewHours] = useState(booking?.hours || 3);\n  const [reason, setReason] = useState('');\n  const [specialRequest, setSpecialRequest] = useState(booking?.notes || '');\n  const [loading, setLoading] = useState(false);\n  const [aiCheck, setAiCheck] = useState(null);\n  const [checkingAvailability, setCheckingAvailability] = useState(false);\n\n  const checkAvailability = async () => {\n    if (!newDate || !newTime) return;\n    \n    setCheckingAvailability(true);\n    try {\n      const response = await base44.functions.invoke('bookingModifications', {\n        action: 'checkAvailability',\n        booking_id: booking.id,\n        cleaner_email: booking.cleaner_email,\n        new_date: newDate,\n        new_time: newTime,\n        new_hours: newHours\n      });\n\n      if (response.data.success) {\n        setAiCheck(response.data);\n      }\n    } catch (error) {\n      console.error('Error checking availability:', error);\n      toast.error('Failed to check availability');\n    }\n    setCheckingAvailability(false);\n  };\n\n  useEffect(() => {\n    if (modificationType === 'reschedule' && newDate && newTime) {\n      checkAvailability();\n    }\n  }, [newDate, newTime, newHours]);\n\n  const handleSubmit = async () => {\n    setLoading(true);\n    try {\n      const response = await base44.functions.invoke('bookingModifications', {\n        action: 'requestModification',\n        booking_id: booking.id,\n        requested_by: userType,\n        requester_email: userType === 'client' ? booking.client_email : booking.cleaner_email,\n        modification_type: modificationType,\n        new_date: newDate,\n        new_time: newTime,\n        new_hours: newHours,\n        special_request_text: specialRequest,\n        reason: reason,\n        original_date: booking.date,\n        original_time: booking.start_time,\n        original_hours: booking.hours\n      });\n\n      if (response.data.success) {\n        toast.success('Modification request sent!');\n        onClose();\n      } else {\n        toast.error(response.data.message || 'Failed to send request');\n      }\n    } catch (error) {\n      console.error('Error submitting modification:', error);\n      toast.error('Failed to submit modification request');\n    }\n    setLoading(false);\n  };\n\n  const priceDifference = aiCheck?.price_difference || 0;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n            <Sparkles className=\"w-6 h-6 text-puretask-blue\" />\n            Modify Booking\n          </DialogTitle>\n          <DialogDescription className=\"font-verdana\">\n            Request changes to your booking - the other party will need to approve\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 mt-4\">\n          {/* Modification Type */}\n          <div>\n            <Label className=\"font-fredoka mb-2 block\">What would you like to change?</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <Button\n                variant={modificationType === 'reschedule' ? 'default' : 'outline'}\n                onClick={() => setModificationType('reschedule')}\n                className=\"h-auto py-3\"\n              >\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                Reschedule\n              </Button>\n              <Button\n                variant={modificationType === 'duration_change' ? 'default' : 'outline'}\n                onClick={() => setModificationType('duration_change')}\n                className=\"h-auto py-3\"\n              >\n                <Clock className=\"w-4 h-4 mr-2\" />\n                Change Duration\n              </Button>\n              <Button\n                variant={modificationType === 'special_request' ? 'default' : 'outline'}\n                onClick={() => setModificationType('special_request')}\n                className=\"h-auto py-3\"\n              >\n                Add Special Request\n              </Button>\n            </div>\n          </div>\n\n          {/* Reschedule Fields */}\n          {(modificationType === 'reschedule' || modificationType === 'duration_change') && (\n            <>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"newDate\" className=\"font-fredoka\">New Date</Label>\n                  <Input\n                    id=\"newDate\"\n                    type=\"date\"\n                    value={newDate}\n                    onChange={(e) => setNewDate(e.target.value)}\n                    min={format(new Date(), 'yyyy-MM-dd')}\n                    className=\"mt-1\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"newTime\" className=\"font-fredoka\">New Time</Label>\n                  <Input\n                    id=\"newTime\"\n                    type=\"time\"\n                    value={newTime}\n                    onChange={(e) => setNewTime(e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <Label htmlFor=\"newHours\" className=\"font-fredoka\">Duration (hours)</Label>\n                <Input\n                  id=\"newHours\"\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"8\"\n                  step=\"0.5\"\n                  value={newHours}\n                  onChange={(e) => setNewHours(parseFloat(e.target.value))}\n                  className=\"mt-1\"\n                />\n              </div>\n\n              {/* AI Availability Check */}\n              {checkingAvailability && (\n                <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                  <Loader2 className=\"w-4 h-4 animate-spin text-puretask-blue inline mr-2\" />\n                  <span className=\"text-sm font-verdana\">Checking availability with AI...</span>\n                </div>\n              )}\n\n              {aiCheck && !checkingAvailability && (\n                <div className={`p-4 rounded-lg border-2 ${aiCheck.available ? 'bg-green-50 border-green-200' : 'bg-amber-50 border-amber-200'}`}>\n                  <div className=\"flex items-start gap-2\">\n                    {aiCheck.available ? (\n                      <div className=\"w-full\">\n                        <p className=\"font-fredoka font-semibold text-green-700 flex items-center gap-2\">\n                          ‚úì Slot Available\n                        </p>\n                        <p className=\"text-sm text-gray-700 font-verdana mt-1\">{aiCheck.message}</p>\n                      </div>\n                    ) : (\n                      <div className=\"w-full\">\n                        <p className=\"font-fredoka font-semibold text-amber-700 flex items-center gap-2\">\n                          <AlertCircle className=\"w-4 h-4\" />\n                          Potential Conflict\n                        </p>\n                        <p className=\"text-sm text-gray-700 font-verdana mt-1\">{aiCheck.message}</p>\n                        \n                        {aiCheck.alternative_slots?.length > 0 && (\n                          <div className=\"mt-3\">\n                            <p className=\"text-xs font-fredoka font-semibold mb-2\">AI Suggested Alternatives:</p>\n                            <div className=\"space-y-2\">\n                              {aiCheck.alternative_slots.slice(0, 3).map((slot, idx) => (\n                                <button\n                                  key={idx}\n                                  onClick={() => {\n                                    setNewDate(slot.date);\n                                    setNewTime(slot.time);\n                                  }}\n                                  className=\"w-full text-left p-2 bg-white rounded border border-amber-200 hover:border-amber-400 text-xs font-verdana\"\n                                >\n                                  {format(parseISO(slot.date), 'MMM d')} at {slot.time} ({slot.reason})\n                                </button>\n                              ))}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Price Difference */}\n              {priceDifference !== 0 && (\n                <div className={`p-3 rounded-lg border ${priceDifference > 0 ? 'bg-amber-50 border-amber-200' : 'bg-green-50 border-green-200'}`}>\n                  <div className=\"flex items-center gap-2\">\n                    <DollarSign className=\"w-4 h-4\" />\n                    <span className=\"font-fredoka font-semibold\">Price Adjustment:</span>\n                    <span className={`font-verdana ${priceDifference > 0 ? 'text-amber-700' : 'text-green-700'}`}>\n                      {priceDifference > 0 ? '+' : ''}{priceDifference} credits\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                    {priceDifference > 0 ? 'Additional charge will apply' : 'You will receive a partial refund'}\n                  </p>\n                </div>\n              )}\n            </>\n          )}\n\n          {/* Special Request */}\n          {modificationType === 'special_request' && (\n            <div>\n              <Label htmlFor=\"specialRequest\" className=\"font-fredoka\">Special Request</Label>\n              <Textarea\n                id=\"specialRequest\"\n                value={specialRequest}\n                onChange={(e) => setSpecialRequest(e.target.value)}\n                placeholder=\"Please focus extra on the kitchen and bathroom today...\"\n                rows={4}\n                className=\"mt-1\"\n              />\n            </div>\n          )}\n\n          {/* Reason */}\n          <div>\n            <Label htmlFor=\"reason\" className=\"font-fredoka\">Reason for Change (Optional)</Label>\n            <Textarea\n              id=\"reason\"\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              placeholder=\"Emergency came up, need to adjust timing...\"\n              rows={2}\n              className=\"mt-1\"\n            />\n          </div>\n\n          {/* Current vs New Summary */}\n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <p className=\"font-fredoka font-semibold mb-3\">Summary:</p>\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div>\n                <p className=\"text-gray-500 font-verdana text-xs\">Current</p>\n                <p className=\"font-verdana\">{format(parseISO(booking.date), 'MMM d, yyyy')}</p>\n                <p className=\"font-verdana\">{booking.start_time} ‚Ä¢ {booking.hours}h</p>\n              </div>\n              {modificationType !== 'special_request' && (\n                <div>\n                  <p className=\"text-gray-500 font-verdana text-xs\">New</p>\n                  <p className=\"font-verdana\">{newDate ? format(parseISO(newDate), 'MMM d, yyyy') : '‚Äî'}</p>\n                  <p className=\"font-verdana\">{newTime || '‚Äî'} ‚Ä¢ {newHours}h</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex justify-end gap-3 pt-4\">\n            <Button variant=\"outline\" onClick={onClose} disabled={loading}>\n              Cancel\n            </Button>\n            <Button \n              onClick={handleSubmit} \n              disabled={loading || (modificationType === 'reschedule' && (!newDate || !newTime))}\n              className=\"brand-gradient text-white\"\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Submitting...\n                </>\n              ) : (\n                'Send Request'\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\MultiBookingCalendar.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isSameMonth' is defined but never used.","line":6,"column":85,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":96,"fix":{"range":[372,385],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isSameMonth"},"fix":{"range":[371,384],"text":""},"desc":"Remove unused variable 'isSameMonth'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":6,"column":109,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":116,"fix":{"range":[396,405],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[395,404],"text":""},"desc":"Remove unused variable 'addDays'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isAfter' is defined but never used.","line":6,"column":118,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":125,"fix":{"range":[405,414],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isAfter"},"fix":{"range":[404,413],"text":""},"desc":"Remove unused variable 'isAfter'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, ChevronLeft, ChevronRight, X } from 'lucide-react';\nimport { format, addMonths, subMonths, startOfMonth, endOfMonth, eachDayOfInterval, isSameMonth, isSameDay, addDays, isAfter, isBefore } from 'date-fns';\n\nexport default function MultiBookingCalendar({ selectedDates, onDatesChange, minDate = new Date() }) {\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n\n  const monthStart = startOfMonth(currentMonth);\n  const monthEnd = endOfMonth(currentMonth);\n  const daysInMonth = eachDayOfInterval({ start: monthStart, end: monthEnd });\n\n  const handleDateClick = (date) => {\n    // Don't allow selecting dates in the past\n    if (isBefore(date, minDate)) return;\n\n    const isSelected = selectedDates.some(d => isSameDay(new Date(d), date));\n    \n    if (isSelected) {\n      // Remove date\n      onDatesChange(selectedDates.filter(d => !isSameDay(new Date(d), date)));\n    } else {\n      // Add date\n      onDatesChange([...selectedDates, format(date, 'yyyy-MM-dd')]);\n    }\n  };\n\n  const clearAllDates = () => {\n    onDatesChange([]);\n  };\n\n  const nextMonth = () => setCurrentMonth(addMonths(currentMonth, 1));\n  const prevMonth = () => setCurrentMonth(subMonths(currentMonth, 1));\n\n  return (\n    <Card className=\"border-2 border-puretask-blue rounded-2xl\">\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n            <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n            Select Dates\n          </CardTitle>\n          {selectedDates.length > 0 && (\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              onClick={clearAllDates}\n              className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\n            >\n              <X className=\"w-4 h-4 mr-1\" />\n              Clear All\n            </Button>\n          )}\n        </div>\n        {selectedDates.length > 0 && (\n          <Badge className=\"bg-puretask-blue text-white font-fredoka\">\n            {selectedDates.length} date{selectedDates.length !== 1 ? 's' : ''} selected\n          </Badge>\n        )}\n      </CardHeader>\n      <CardContent>\n        {/* Month Navigation */}\n        <div className=\"flex items-center justify-between mb-4\">\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            onClick={prevMonth}\n            className=\"hover:bg-blue-50\"\n          >\n            <ChevronLeft className=\"w-5 h-5\" />\n          </Button>\n          <h3 className=\"font-fredoka font-bold text-lg text-graphite\">\n            {format(currentMonth, 'MMMM yyyy')}\n          </h3>\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            onClick={nextMonth}\n            className=\"hover:bg-blue-50\"\n          >\n            <ChevronRight className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Day Headers */}\n        <div className=\"grid grid-cols-7 gap-2 mb-2\">\n          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\n            <div key={day} className=\"text-center text-xs font-fredoka font-semibold text-gray-500 p-2\">\n              {day}\n            </div>\n          ))}\n        </div>\n\n        {/* Calendar Grid */}\n        <div className=\"grid grid-cols-7 gap-2\">\n          {/* Empty cells for days before month starts */}\n          {Array.from({ length: monthStart.getDay() }).map((_, index) => (\n            <div key={`empty-${index}`} className=\"p-2\" />\n          ))}\n          \n          {/* Days of the month */}\n          {daysInMonth.map(date => {\n            const isSelected = selectedDates.some(d => isSameDay(new Date(d), date));\n            const isPast = isBefore(date, minDate);\n            const isToday = isSameDay(date, new Date());\n\n            return (\n              <button\n                key={date.toISOString()}\n                onClick={() => handleDateClick(date)}\n                disabled={isPast}\n                className={`\n                  p-2 rounded-lg text-sm font-verdana font-medium transition-all\n                  ${isPast ? 'text-gray-300 cursor-not-allowed' : 'cursor-pointer hover:bg-blue-50'}\n                  ${isSelected ? 'bg-puretask-blue text-white hover:bg-blue-600 shadow-md' : 'text-graphite'}\n                  ${isToday && !isSelected ? 'border-2 border-puretask-blue' : ''}\n                `}\n              >\n                {format(date, 'd')}\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Selected Dates List */}\n        {selectedDates.length > 0 && (\n          <div className=\"mt-4 pt-4 border-t\">\n            <p className=\"text-sm font-fredoka font-semibold text-gray-700 mb-2\">\n              Selected Dates:\n            </p>\n            <div className=\"flex flex-wrap gap-2\">\n              {selectedDates.sort().map(date => (\n                <Badge \n                  key={date} \n                  className=\"bg-blue-100 text-puretask-blue font-verdana cursor-pointer hover:bg-blue-200\"\n                  onClick={() => handleDateClick(new Date(date))}\n                >\n                  {format(new Date(date), 'MMM d, yyyy')}\n                  <X className=\"w-3 h-3 ml-1\" />\n                </Badge>\n              ))}\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\PhotoProofProgress.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\PricingBreakdownCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ChevronUp' is defined but never used.","line":2,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":44,"fix":{"range":[74,85],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ChevronUp"},"fix":{"range":[73,84],"text":""},"desc":"Remove unused variable 'ChevronUp'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'baseSubtotal' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":21,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"baseSubtotal"},"fix":{"range":[1011,1049],"text":""},"desc":"Remove unused variable 'baseSubtotal'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'addonSubtotal' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":22,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"addonSubtotal"},"fix":{"range":[1052,1092],"text":""},"desc":"Remove unused variable 'addonSubtotal'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { DollarSign, ChevronDown, ChevronUp, Info, TrendingUp, Tag } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function PricingBreakdownCard({ booking }) {\n  const [expanded, setExpanded] = useState(false);\n\n  if (!booking) return null;\n\n  const baseRate = booking.snapshot_base_rate_cph || 0;\n  const addonRate = booking.snapshot_selected_addon_cph || 0;\n  const totalRate = booking.snapshot_total_rate_cph || baseRate + addonRate;\n  const hours = booking.actual_hours || booking.hours || 0;\n  const additionalServices = booking.additional_services_cost_credits || 0;\n  const membershipDiscount = booking.snapshot_membership_discount_pct || 0;\n  const dynamicMultiplier = booking.snapshot_dynamic_pricing_multiplier || 1;\n  const tierMultiplier = booking.snapshot_tier_multiplier || 1;\n\n  const baseSubtotal = hours * baseRate;\n  const addonSubtotal = hours * addonRate;\n  const subtotal = hours * totalRate;\n  const finalTotal = booking.final_charge_credits || booking.total_price || (subtotal + additionalServices);\n\n  const appliedLabels = booking.applied_pricing_labels || [];\n\n  return (\n    <Card className=\"border-2 border-blue-200\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <DollarSign className=\"w-5 h-5 text-blue-600\" />\n            Pricing Details\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-3\">\n        {/* Always Visible: Final Total */}\n        <div className=\"bg-blue-50 rounded-lg p-3 border-2 border-blue-300\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"font-fredoka font-semibold text-gray-700\">Total Charge:</span>\n            <span className=\"text-2xl font-fredoka font-bold text-blue-600\">\n              {finalTotal} credits\n            </span>\n          </div>\n          <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n            ‚âà ${(finalTotal / 10).toFixed(2)} USD\n          </p>\n        </div>\n\n        <AnimatePresence>\n          {expanded && (\n            <motion.div\n              initial={{ height: 0, opacity: 0 }}\n              animate={{ height: 'auto', opacity: 1 }}\n              exit={{ height: 0, opacity: 0 }}\n              transition={{ duration: 0.3 }}\n              className=\"space-y-3 overflow-hidden\"\n            >\n              {/* Frozen Rates Notice */}\n              <div className=\"bg-green-50 border-l-4 border-green-400 p-3 rounded\">\n                <p className=\"text-xs font-verdana text-green-800 flex items-center gap-1\">\n                  <Info className=\"w-4 h-4\" />\n                  <strong>Price Protection:</strong> Rates frozen at booking time\n                </p>\n              </div>\n\n              {/* Base Rate */}\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600 font-verdana\">Base Rate:</span>\n                  <span className=\"font-fredoka\">{baseRate} credits/hour</span>\n                </div>\n\n                {/* Cleaning Type Add-on */}\n                {addonRate > 0 && (\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600 font-verdana\">\n                      {booking.cleaning_type === 'deep' ? 'Deep Clean' : 'Move-Out'} Add-on:\n                    </span>\n                    <span className=\"font-fredoka text-blue-600\">+{addonRate} credits/hour</span>\n                  </div>\n                )}\n\n                {/* Total Rate */}\n                <div className=\"flex justify-between text-sm pt-2 border-t\">\n                  <span className=\"text-gray-700 font-verdana font-semibold\">Hourly Rate:</span>\n                  <span className=\"font-fredoka font-semibold\">{totalRate} credits/hour</span>\n                </div>\n              </div>\n\n              {/* Hours Calculation */}\n              <div className=\"bg-gray-50 rounded-lg p-3 space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600 font-verdana\">Hours:</span>\n                  <span className=\"font-fredoka\">{hours} hours</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600 font-verdana\">Subtotal:</span>\n                  <span className=\"font-fredoka\">{subtotal} credits</span>\n                </div>\n              </div>\n\n              {/* Additional Services */}\n              {additionalServices > 0 && (\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span className=\"text-gray-600 font-verdana\">Additional Services:</span>\n                    <span className=\"font-fredoka text-blue-600\">+{additionalServices} credits</span>\n                  </div>\n                  {booking.additional_services && Object.keys(booking.additional_services).length > 0 && (\n                    <div className=\"pl-4 space-y-1\">\n                      {Object.entries(booking.additional_services).map(([service, qty]) => (\n                        qty > 0 && (\n                          <div key={service} className=\"text-xs text-gray-500 flex justify-between\">\n                            <span className=\"capitalize\">{service.replace(/_/g, ' ')}:</span>\n                            <span>√ó{qty}</span>\n                          </div>\n                        )\n                      ))}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Pricing Modifiers */}\n              {(membershipDiscount > 0 || dynamicMultiplier !== 1 || tierMultiplier !== 1) && (\n                <div className=\"bg-yellow-50 rounded-lg p-3 space-y-2 border border-yellow-200\">\n                  <div className=\"flex items-center gap-2 text-sm font-fredoka font-semibold text-yellow-800\">\n                    <TrendingUp className=\"w-4 h-4\" />\n                    Applied Adjustments:\n                  </div>\n                  {membershipDiscount > 0 && (\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-600\">Membership Discount:</span>\n                      <span className=\"text-green-600 font-fredoka\">-{membershipDiscount}%</span>\n                    </div>\n                  )}\n                  {dynamicMultiplier !== 1 && (\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-600\">Dynamic Pricing:</span>\n                      <span className={`font-fredoka ${dynamicMultiplier > 1 ? 'text-red-600' : 'text-green-600'}`}>\n                        √ó{dynamicMultiplier}\n                      </span>\n                    </div>\n                  )}\n                  {tierMultiplier !== 1 && (\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"text-gray-600\">Cleaner Tier:</span>\n                      <span className=\"font-fredoka\">√ó{tierMultiplier}</span>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Applied Labels */}\n              {appliedLabels.length > 0 && (\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2 text-sm font-fredoka font-semibold text-gray-700\">\n                    <Tag className=\"w-4 h-4\" />\n                    Active Offers:\n                  </div>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {appliedLabels.map((label, idx) => (\n                      <Badge key={idx} className=\"bg-purple-100 text-purple-700 border-purple-300 font-verdana text-xs\">\n                        {label}\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Snapshot Info */}\n              <div className=\"pt-3 border-t text-xs text-gray-500 font-verdana\">\n                <p>All rates frozen at booking time. Current market rates don't affect your price.</p>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\QuickBookPresets.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\RecurringBookingSetup.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":9,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":35,"fix":{"range":[458,467],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[457,466],"text":""},"desc":"Remove unused variable 'addDays'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setDayOfWeek' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"setDayOfWeek"},"fix":{"range":[668,682],"text":""},"desc":"Remove unused variable 'setDayOfWeek'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Repeat, Calendar, Info } from 'lucide-react';\nimport { format, addWeeks, addDays, addMonths } from 'date-fns';\n\nexport default function RecurringBookingSetup({ bookingTemplate, onGenerateDates, onCancel }) {\n  const [frequency, setFrequency] = useState('weekly');\n  const [dayOfWeek, setDayOfWeek] = useState('Monday');\n  const [occurrences, setOccurrences] = useState(4);\n  const [previewDates, setPreviewDates] = useState([]);\n\n  const generatePreviewDates = () => {\n    const dates = [];\n    const startDate = new Date(bookingTemplate.date);\n    \n    for (let i = 0; i < occurrences; i++) {\n      let nextDate;\n      if (frequency === 'weekly') {\n        nextDate = addWeeks(startDate, i);\n      } else if (frequency === 'biweekly') {\n        nextDate = addWeeks(startDate, i * 2);\n      } else if (frequency === 'monthly') {\n        nextDate = addMonths(startDate, i);\n      }\n      dates.push(format(nextDate, 'yyyy-MM-dd'));\n    }\n    \n    setPreviewDates(dates);\n    return dates;\n  };\n\n  const handleGenerate = () => {\n    const dates = generatePreviewDates();\n    onGenerateDates({\n      frequency,\n      dayOfWeek,\n      occurrences,\n      dates\n    });\n  };\n\n  React.useEffect(() => {\n    if (occurrences > 0) {\n      generatePreviewDates();\n    }\n  }, [frequency, occurrences, bookingTemplate.date]);\n\n  return (\n    <Card className=\"border-2 border-purple-300 rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Repeat className=\"w-5 h-5 text-purple-600\" />\n          Set Up Recurring Bookings\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <Alert className=\"border-purple-200 bg-purple-50 rounded-xl\">\n          <Info className=\"w-4 h-4 text-purple-600\" />\n          <AlertDescription className=\"text-sm text-purple-900 font-verdana\">\n            Create multiple bookings with the same settings, repeating at regular intervals.\n          </AlertDescription>\n        </Alert>\n\n        {/* Frequency Selection */}\n        <div>\n          <Label className=\"font-fredoka font-medium text-graphite mb-2 block\">\n            Frequency\n          </Label>\n          <div className=\"grid grid-cols-3 gap-3\">\n            {[\n              { value: 'weekly', label: 'Weekly' },\n              { value: 'biweekly', label: 'Bi-Weekly' },\n              { value: 'monthly', label: 'Monthly' }\n            ].map(option => (\n              <button\n                key={option.value}\n                type=\"button\"\n                onClick={() => setFrequency(option.value)}\n                className={`p-3 rounded-xl text-sm font-fredoka font-semibold transition-all border-2 ${\n                  frequency === option.value\n                    ? 'border-purple-500 bg-purple-500 text-white shadow-lg'\n                    : 'border-gray-300 bg-white text-graphite hover:border-purple-300'\n                }`}\n              >\n                {option.label}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Number of Occurrences */}\n        <div>\n          <Label className=\"font-fredoka font-medium text-graphite mb-2 block\">\n            Number of Bookings\n          </Label>\n          <Input\n            type=\"number\"\n            min=\"1\"\n            max=\"52\"\n            value={occurrences}\n            onChange={(e) => setOccurrences(parseInt(e.target.value) || 1)}\n            className=\"font-verdana\"\n          />\n          <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n            Maximum 52 recurring bookings\n          </p>\n        </div>\n\n        {/* Preview Dates */}\n        {previewDates.length > 0 && (\n          <div className=\"bg-gray-50 rounded-xl p-4\">\n            <p className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 flex items-center gap-2\">\n              <Calendar className=\"w-4 h-4\" />\n              Preview ({previewDates.length} bookings)\n            </p>\n            <div className=\"max-h-48 overflow-y-auto space-y-1\">\n              {previewDates.map((date, index) => (\n                <div key={index} className=\"flex items-center justify-between text-sm font-verdana py-1\">\n                  <span className=\"text-gray-700\">Booking #{index + 1}</span>\n                  <Badge variant=\"outline\" className=\"font-verdana\">\n                    {format(new Date(date), 'MMM d, yyyy')} at {bookingTemplate.time}\n                  </Badge>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex gap-3 pt-4 border-t\">\n          <Button\n            variant=\"outline\"\n            onClick={onCancel}\n            className=\"flex-1 rounded-full font-fredoka font-semibold\"\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handleGenerate}\n            className=\"flex-1 bg-purple-600 hover:bg-purple-700 text-white rounded-full font-fredoka font-semibold\"\n          >\n            Generate {occurrences} Bookings\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\RescheduleBooking.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[200,247],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[200,246],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Calendar, Clock, Loader2, AlertCircle } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport CalendarBooking from './CalendarBooking';\nimport { differenceInHours } from 'date-fns';\n\nexport default function RescheduleBooking({ booking, cleanerAvailability, open, onClose, onRescheduled }) {\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [selectedTime, setSelectedTime] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSelectSlot = (date, time) => {\n    setSelectedDate(date);\n    setSelectedTime(time);\n    setError('');\n  };\n\n  const handleReschedule = async () => {\n    if (!selectedDate || !selectedTime) {\n      setError('Please select a new date and time');\n      return;\n    }\n\n    const bookingDate = new Date(booking.date + 'T' + booking.start_time);\n    const now = new Date();\n    const hoursUntilBooking = differenceInHours(bookingDate, now);\n\n    // Check if rescheduling is within policy (24 hours before)\n    if (hoursUntilBooking < 24 && booking.reschedule_count >= 1) {\n      setError(\"Free rescheduling is only available more than 24 hours before your booking. You have already used your free reschedule.\");\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n\n    try {\n      const oldDate = booking.date;\n      const oldTime = booking.start_time;\n\n      // Update the booking\n      await base44.entities.Booking.update(booking.id, {\n        date: selectedDate.toISOString().split('T')[0],\n        start_time: selectedTime,\n        rescheduled_from: `${oldDate} ${oldTime}`,\n        reschedule_count: (booking.reschedule_count || 0) + 1\n      });\n\n      // Log event\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'booking_rescheduled',\n        user_email: booking.client_email,\n        details: `Rescheduled from ${oldDate} ${oldTime} to ${selectedDate.toISOString().split('T')[0]} ${selectedTime}`,\n        timestamp: new Date().toISOString()\n      });\n\n      // Send notification to cleaner\n      try {\n        const cleanerUsers = await base44.entities.User.filter({ email: booking.cleaner_email });\n        if (cleanerUsers.length > 0 && cleanerUsers[0].sms_consent) {\n          await base44.integrations.Core.SendEmail({\n            to: booking.cleaner_email,\n            subject: 'üìÖ Booking Rescheduled',\n            body: `A booking has been rescheduled:\n\nOld Date: ${oldDate} at ${oldTime}\nNew Date: ${selectedDate.toISOString().split('T')[0]} at ${selectedTime}\n\nAddress: ${booking.address}\n\nPlease check your calendar for the updated time.`\n          });\n        }\n      } catch (notifErr) {\n        console.error('Failed to notify cleaner:', notifErr);\n      }\n\n      if (onRescheduled) onRescheduled();\n      onClose();\n    } catch (err) {\n      console.error('Error rescheduling booking:', err);\n      setError('Failed to reschedule booking. Please try again.');\n    }\n    setLoading(false);\n  };\n\n  const bookingDate = new Date(booking.date + 'T' + booking.start_time);\n  const now = new Date();\n  const hoursUntilBooking = differenceInHours(bookingDate, now);\n  const isFreeReschedule = hoursUntilBooking >= 24 && (booking.reschedule_count || 0) === 0;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"w-6 h-6 text-blue-500\" />\n            Reschedule Booking\n          </DialogTitle>\n          <DialogDescription>\n            Select a new date and time for your cleaning\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          {error && (\n            <Alert variant=\"destructive\">\n              <AlertCircle className=\"w-4 h-4\" />\n              <AlertDescription>{error}</AlertDescription>\n            </Alert>\n          )}\n\n          <div className=\"bg-slate-50 p-4 rounded-lg\">\n            <h4 className=\"font-semibold mb-2\">Current Booking</h4>\n            <div className=\"flex items-center gap-4 text-sm\">\n              <div className=\"flex items-center gap-1\">\n                <Calendar className=\"w-4 h-4 text-slate-500\" />\n                <span>{booking.date}</span>\n              </div>\n              <div className=\"flex items-center gap-1\">\n                <Clock className=\"w-4 h-4 text-slate-500\" />\n                <span>{booking.start_time}</span>\n              </div>\n            </div>\n          </div>\n\n          {isFreeReschedule ? (\n            <Alert className=\"bg-green-50 border-green-200\">\n              <AlertDescription className=\"text-green-900\">\n                ‚úì Free reschedule available (more than 24 hours in advance)\n              </AlertDescription>\n            </Alert>\n          ) : (\n            <Alert className=\"bg-amber-50 border-amber-200\">\n              <AlertDescription className=\"text-amber-900\">\n                <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n                {booking.reschedule_count >= 1 ? \n                  \"You have used your free reschedule. Additional changes may incur a fee.\" : \n                  \"Rescheduling less than 24 hours before may incur a fee.\"}\n              </AlertDescription>\n            </Alert>\n          )}\n\n          <CalendarBooking\n            availability={cleanerAvailability}\n            onSelectSlot={handleSelectSlot}\n            selectedDate={selectedDate}\n            selectedTime={selectedTime}\n          />\n\n          <div className=\"flex gap-3\">\n            <Button variant=\"outline\" onClick={onClose} className=\"flex-1\" disabled={loading}>\n              Cancel\n            </Button>\n            <Button \n              onClick={handleReschedule} \n              className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\n              disabled={!selectedDate || !selectedTime || loading}\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Rescheduling...\n                </>\n              ) : (\n                <>\n                  <Calendar className=\"w-4 h-4 mr-2\" />\n                  Confirm Reschedule\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ReviewCountdownTimer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":33,"fix":{"range":[167,184],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[167,184],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Clock, AlertTriangle } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function ReviewCountdownTimer({ deadline }) {\n  const [timeLeft, setTimeLeft] = useState('');\n  const [isUrgent, setIsUrgent] = useState(false);\n  const [percentage, setPercentage] = useState(100);\n\n  useEffect(() => {\n    const calculateTimeLeft = () => {\n      const now = new Date();\n      const end = new Date(deadline);\n      const diff = end - now;\n\n      if (diff <= 0) {\n        setTimeLeft('Expired');\n        setPercentage(0);\n        return;\n      }\n\n      const hours = Math.floor(diff / (1000 * 60 * 60));\n      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n      \n      // Calculate percentage (12 hours = 100%)\n      const totalMinutes = 12 * 60;\n      const remainingMinutes = hours * 60 + minutes;\n      const pct = (remainingMinutes / totalMinutes) * 100;\n      setPercentage(pct);\n\n      setIsUrgent(hours < 2);\n      \n      if (hours > 0) {\n        setTimeLeft(`${hours}h ${minutes}m`);\n      } else {\n        setTimeLeft(`${minutes}m`);\n      }\n    };\n\n    calculateTimeLeft();\n    const interval = setInterval(calculateTimeLeft, 30000); // Update every 30s\n\n    return () => clearInterval(interval);\n  }, [deadline]);\n\n  if (!deadline) return null;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      className={`rounded-xl p-4 border-2 ${\n        isUrgent \n          ? 'bg-red-50 border-red-300' \n          : 'bg-blue-50 border-blue-300'\n      }`}\n    >\n      <div className=\"flex items-center justify-between mb-2\">\n        <div className=\"flex items-center gap-2\">\n          {isUrgent ? (\n            <AlertTriangle className=\"w-5 h-5 text-red-600\" />\n          ) : (\n            <Clock className=\"w-5 h-5 text-blue-600\" />\n          )}\n          <span className={`font-fredoka font-semibold ${\n            isUrgent ? 'text-red-700' : 'text-blue-700'\n          }`}>\n            Review Deadline\n          </span>\n        </div>\n        <Badge className={`${\n          isUrgent \n            ? 'bg-red-600 text-white' \n            : 'bg-blue-600 text-white'\n        } font-fredoka font-bold text-sm px-3 py-1`}>\n          {timeLeft}\n        </Badge>\n      </div>\n\n      <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\n        <motion.div\n          className={`h-2 rounded-full ${\n            isUrgent ? 'bg-red-600' : 'bg-blue-600'\n          }`}\n          initial={{ width: '100%' }}\n          animate={{ width: `${percentage}%` }}\n          transition={{ duration: 0.5 }}\n        />\n      </div>\n\n      <p className=\"text-sm text-gray-600 font-verdana\">\n        {isUrgent ? (\n          <strong className=\"text-red-600\">Urgent:</strong>\n        ) : null} Review this job or it will auto-approve in {timeLeft}\n      </p>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\SmartBundleSuggestions.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":5,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":37,"fix":{"range":[235,242],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[235,242],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'homeType' is defined but never used. Allowed unused args must match /^_/u.","line":11,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"homeType"},"fix":{"range":[433,442],"text":""},"desc":"Remove unused variable 'homeType'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingHistory' is assigned a value but never used. Allowed unused args must match /^_/u.","line":11,"column":90,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":104,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingHistory"},"fix":{"range":[477,498],"text":""},"desc":"Remove unused variable 'bookingHistory'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, TrendingUp, Clock } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\n/**\n * Analyzes booking context and suggests relevant bundles\n */\nexport function analyzeBundleSuggestions({ homeType, squareFeet, hasPets, selectedTasks, bookingHistory = [] }) {\n  const suggestions = [];\n\n  // Move-out scenario\n  if (selectedTasks.includes('deep_clean') && !selectedTasks.includes('oven')) {\n    suggestions.push({\n      id: 'moveout',\n      name: 'Complete Move-Out Clean',\n      reason: 'Perfect for getting your deposit back',\n      tasks: ['oven', 'refrigerator', 'interior_walls'],\n      savings: 20,\n      confidence: 0.9\n    });\n  }\n\n  // Spring cleaning scenario\n  if (selectedTasks.includes('deep_clean') && !selectedTasks.includes('windows')) {\n    suggestions.push({\n      id: 'spring',\n      name: 'Spring Refresh',\n      reason: 'Popular combo for seasonal deep clean',\n      tasks: ['windows', 'interior_walls'],\n      savings: 15,\n      confidence: 0.8\n    });\n  }\n\n  // Kitchen focus\n  if (selectedTasks.includes('kitchen') && !selectedTasks.includes('oven') && !selectedTasks.includes('refrigerator')) {\n    suggestions.push({\n      id: 'kitchen_deep',\n      name: 'Kitchen Deep Clean',\n      reason: 'Get every inch of your kitchen sparkling',\n      tasks: ['oven', 'refrigerator', 'dishes'],\n      savings: 15,\n      confidence: 0.85\n    });\n  }\n\n  // Large home bonus\n  if (squareFeet > 2000 && !selectedTasks.includes('organizing')) {\n    suggestions.push({\n      id: 'large_home',\n      name: 'Large Home Package',\n      reason: 'Extra help for bigger spaces',\n      tasks: ['organizing', 'laundry'],\n      savings: 10,\n      confidence: 0.7\n    });\n  }\n\n  // Pet owner special\n  if (hasPets && !selectedTasks.includes('deep_clean')) {\n    suggestions.push({\n      id: 'pet_owner',\n      name: 'Pet-Friendly Deep Clean',\n      reason: 'Remove pet hair and dander thoroughly',\n      tasks: ['deep_clean'],\n      savings: 15,\n      confidence: 0.75\n    });\n  }\n\n  // Sort by confidence and return top 2\n  return suggestions\n    .sort((a, b) => b.confidence - a.confidence)\n    .slice(0, 2);\n}\n\nexport default function SmartBundleSuggestions({ \n  homeType, \n  squareFeet, \n  hasPets, \n  selectedTasks,\n  appliedBundles,\n  onApplyBundle \n}) {\n  const [suggestions, setSuggestions] = useState([]);\n  const [dismissed, setDismissed] = useState([]);\n\n  useEffect(() => {\n    const newSuggestions = analyzeBundleSuggestions({\n      homeType,\n      squareFeet,\n      hasPets,\n      selectedTasks\n    });\n\n    // Filter out already applied or dismissed\n    const filtered = newSuggestions.filter(\n      s => !appliedBundles.includes(s.id) && !dismissed.includes(s.id)\n    );\n\n    setSuggestions(filtered);\n  }, [homeType, squareFeet, hasPets, selectedTasks, appliedBundles, dismissed]);\n\n  if (suggestions.length === 0) return null;\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center gap-2 mb-3\">\n        <TrendingUp className=\"w-5 h-5 text-purple-600\" />\n        <h3 className=\"font-semibold text-slate-900\">Recommended for You</h3>\n      </div>\n\n      <AnimatePresence>\n        {suggestions.map((suggestion) => (\n          <motion.div\n            key={suggestion.id}\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: 20 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"border-2 border-purple-200 bg-gradient-to-r from-purple-50 to-pink-50 overflow-hidden\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between mb-2\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <Sparkles className=\"w-5 h-5 text-purple-600\" />\n                      <h4 className=\"font-bold text-purple-900\">{suggestion.name}</h4>\n                    </div>\n                    <p className=\"text-sm text-purple-700 mb-2\">{suggestion.reason}</p>\n                    \n                    <div className=\"flex flex-wrap gap-1 mb-3\">\n                      {suggestion.tasks.map(task => (\n                        <Badge key={task} variant=\"outline\" className=\"text-xs bg-white border-purple-300 text-purple-800\">\n                          {task.replace(/_/g, ' ')}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n\n                  <Badge className=\"bg-emerald-500 text-white ml-3 flex-shrink-0\">\n                    Save ${suggestion.savings}\n                  </Badge>\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    size=\"sm\"\n                    onClick={() => onApplyBundle(suggestion)}\n                    className=\"flex-1 bg-purple-600 hover:bg-purple-700 text-white\"\n                  >\n                    <Sparkles className=\"w-4 h-4 mr-1\" />\n                    Add Bundle\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={() => setDismissed([...dismissed, suggestion.id])}\n                    className=\"text-slate-600 hover:text-slate-900\"\n                  >\n                    Dismiss\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        ))}\n      </AnimatePresence>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\StickyPriceSummary.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\TaskSelector.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\booking\\ValidationMessage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\campaigns\\AutomationPerformance.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":3,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":26,"fix":{"range":[111,123],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[110,122],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":3,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":37,"fix":{"range":[123,134],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[122,133],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":5,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":57,"fix":{"range":[269,281],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[269,281],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, Star, Bell, MessageSquare, TrendingUp } from 'lucide-react';\n\nexport default function AutomationPerformance() {\n  const [stats, setStats] = useState({\n    reminders: { sent: 0, delivered: 0 },\n    reviews: { sent: 0, submitted: 0 },\n    confirmations: { sent: 0, delivered: 0 },\n    reengagement: { sent: 0, converted: 0 }\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadStats();\n  }, []);\n\n  const loadStats = async () => {\n    try {\n      const logs = await base44.asServiceRole.entities.MessageDeliveryLog.list('-sent_at', 500);\n\n      const reminders = logs.filter(l => l.message_type === 'pre_cleaning_reminder');\n      const reviews = logs.filter(l => l.message_type === 'review_request');\n      const confirmations = logs.filter(l => l.message_type === 'booking_confirmation');\n      const reengagement = logs.filter(l => l.message_type === 'reengagement');\n\n      const countDelivered = (logs) => {\n        return logs.reduce((count, log) => {\n          const successCount = log.delivery_results?.filter(r => r.success).length || 0;\n          return count + successCount;\n        }, 0);\n      };\n\n      // Count submitted reviews\n      const reviewBookings = await base44.asServiceRole.entities.Booking.filter({\n        review_submitted: true\n      });\n\n      setStats({\n        reminders: { sent: reminders.length, delivered: countDelivered(reminders) },\n        reviews: { sent: reviews.length, submitted: reviewBookings.length },\n        confirmations: { sent: confirmations.length, delivered: countDelivered(confirmations) },\n        reengagement: { sent: reengagement.length, converted: 0 }\n      });\n    } catch (error) {\n      console.error('Error loading stats:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const automations = [\n    {\n      name: 'Pre-Cleaning Reminders',\n      icon: Calendar,\n      color: 'blue',\n      sent: stats.reminders.sent,\n      metric: stats.reminders.delivered,\n      metricLabel: 'Delivered',\n      rate: stats.reminders.sent > 0 ? ((stats.reminders.delivered / stats.reminders.sent) * 100).toFixed(0) : 0\n    },\n    {\n      name: 'Review Requests',\n      icon: Star,\n      color: 'yellow',\n      sent: stats.reviews.sent,\n      metric: stats.reviews.submitted,\n      metricLabel: 'Reviews Received',\n      rate: stats.reviews.sent > 0 ? ((stats.reviews.submitted / stats.reviews.sent) * 100).toFixed(0) : 0\n    },\n    {\n      name: 'Booking Confirmations',\n      icon: Bell,\n      color: 'green',\n      sent: stats.confirmations.sent,\n      metric: stats.confirmations.delivered,\n      metricLabel: 'Delivered',\n      rate: stats.confirmations.sent > 0 ? ((stats.confirmations.delivered / stats.confirmations.sent) * 100).toFixed(0) : 0\n    },\n    {\n      name: 'Re-engagement Campaigns',\n      icon: MessageSquare,\n      color: 'purple',\n      sent: stats.reengagement.sent,\n      metric: stats.reengagement.converted,\n      metricLabel: 'Converted',\n      rate: stats.reengagement.sent > 0 ? ((stats.reengagement.converted / stats.reengagement.sent) * 100).toFixed(0) : 0\n    }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {[1, 2, 3, 4].map(i => (\n          <Card key={i} className=\"animate-pulse\">\n            <CardContent className=\"p-6\">\n              <div className=\"h-24 bg-gray-200 rounded\"></div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n      {automations.map((auto) => {\n        const Icon = auto.icon;\n        return (\n          <Card key={auto.name}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <Icon className={`w-8 h-8 text-${auto.color}-500`} />\n                <Badge className={`bg-${auto.color}-100 text-${auto.color}-800`}>\n                  {auto.rate}%\n                </Badge>\n              </div>\n              <p className=\"font-fredoka font-bold text-lg mb-1\">{auto.name}</p>\n              <div className=\"space-y-1\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">Sent:</span>\n                  <span className=\"font-bold\">{auto.sent}</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-600\">{auto.metricLabel}:</span>\n                  <span className=\"font-bold text-green-600\">{auto.metric}</span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\campaigns\\ReengagementAnalytics.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":3,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":26,"fix":{"range":[111,123],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[110,122],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":3,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":37,"fix":{"range":[123,134],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[122,133],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":20,"fix":{"range":[233,245],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[234,245],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, Users, Mail, Calendar, DollarSign } from 'lucide-react';\n\nexport default function ReengagementAnalytics() {\n  const [analytics, setAnalytics] = useState({\n    totalCampaignsSent: 0,\n    successfulDeliveries: 0,\n    reactivatedClients: 0,\n    revenueGenerated: 0\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadAnalytics();\n  }, []);\n\n  const loadAnalytics = async () => {\n    try {\n      // Get all re-engagement campaign logs\n      const logs = await base44.asServiceRole.entities.MessageDeliveryLog.filter({\n        message_type: 'reengagement'\n      });\n\n      const successfulDeliveries = logs.reduce((count, log) => {\n        const successCount = log.delivery_results?.filter(r => r.success).length || 0;\n        return count + successCount;\n      }, 0);\n\n      // Get bookings created after re-engagement campaigns\n      const campaignClientEmails = [...new Set(logs.map(l => l.client_email))];\n      let reactivatedCount = 0;\n      let totalRevenue = 0;\n\n      for (const clientEmail of campaignClientEmails) {\n        const clientLogs = logs.filter(l => l.client_email === clientEmail);\n        const lastCampaignDate = new Date(clientLogs[0]?.sent_at);\n\n        // Check if they booked after campaign\n        const bookingsAfterCampaign = await base44.asServiceRole.entities.Booking.filter({\n          client_email: clientEmail,\n          created_date: { $gte: lastCampaignDate.toISOString() }\n        });\n\n        if (bookingsAfterCampaign.length > 0) {\n          reactivatedCount++;\n          totalRevenue += bookingsAfterCampaign.reduce((sum, b) => sum + (b.total_price || 0), 0);\n        }\n      }\n\n      setAnalytics({\n        totalCampaignsSent: logs.length,\n        successfulDeliveries,\n        reactivatedClients: reactivatedCount,\n        revenueGenerated: totalRevenue\n      });\n    } catch (error) {\n      console.error('Error loading analytics:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        {[1, 2, 3, 4].map(i => (\n          <Card key={i} className=\"animate-pulse\">\n            <CardContent className=\"p-6\">\n              <div className=\"h-20 bg-gray-200 rounded\"></div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Mail className=\"w-8 h-8 text-blue-500\" />\n            <Badge className=\"bg-blue-100 text-blue-800\">Total</Badge>\n          </div>\n          <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n            {analytics.totalCampaignsSent}\n          </p>\n          <p className=\"text-sm text-gray-600 font-verdana\">Campaigns Sent</p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Calendar className=\"w-8 h-8 text-green-500\" />\n            <Badge className=\"bg-green-100 text-green-800\">Delivered</Badge>\n          </div>\n          <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n            {analytics.successfulDeliveries}\n          </p>\n          <p className=\"text-sm text-gray-600 font-verdana\">Successful Deliveries</p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <Users className=\"w-8 h-8 text-purple-500\" />\n            <Badge className=\"bg-purple-100 text-purple-800\">Reactivated</Badge>\n          </div>\n          <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n            {analytics.reactivatedClients}\n          </p>\n          <p className=\"text-sm text-gray-600 font-verdana\">Clients Won Back</p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <DollarSign className=\"w-8 h-8 text-green-500\" />\n            <Badge className=\"bg-green-100 text-green-800\">Revenue</Badge>\n          </div>\n          <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n            ${analytics.revenueGenerated.toFixed(0)}\n          </p>\n          <p className=\"text-sm text-gray-600 font-verdana\">Generated</p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\campaigns\\ReengagementPreview.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\chat\\AIChatAssistant.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\chat\\FAQChatbot.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":8,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[440,457],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[440,457],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { base44 } from '@/api/base44Client';\nimport { MessageSquare, Send, X, Minimize2, Maximize2, Sparkles, Loader2 } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from '../messaging/MessageBubble';\n\nexport default function FAQChatbot({ agentName, title, userType }) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [conversation, setConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  useEffect(() => {\n    if (isOpen && !conversation) {\n      initConversation();\n    }\n  }, [isOpen]);\n\n  // Subscribe to conversation updates\n  useEffect(() => {\n    if (!conversation?.id) return;\n\n    const unsubscribe = base44.agents.subscribeToConversation(conversation.id, (data) => {\n      setMessages(data.messages || []);\n    });\n\n    return () => unsubscribe();\n  }, [conversation?.id]);\n\n  const initConversation = async () => {\n    try {\n      setLoading(true);\n      \n      // Check if there's an existing conversation for this agent\n      const existingConversations = await base44.agents.listConversations({\n        agent_name: agentName\n      });\n\n      if (existingConversations && existingConversations.length > 0) {\n        // Use the most recent conversation\n        const latest = existingConversations[0];\n        setConversation(latest);\n        setMessages(latest.messages || []);\n      } else {\n        // Create new conversation\n        const newConv = await base44.agents.createConversation({\n          agent_name: agentName,\n          metadata: {\n            name: `${title} Chat`,\n            description: `FAQ assistance for ${userType}`,\n            user_type: userType\n          }\n        });\n        setConversation(newConv);\n        setMessages(newConv.messages || []);\n      }\n    } catch (err) {\n      console.error('Error initializing conversation:', err);\n      setError('Failed to start chat. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const sendMessage = async () => {\n    if (!input.trim() || !conversation) return;\n\n    const userMessage = input.trim();\n    setInput('');\n    setLoading(true);\n\n    try {\n      await base44.agents.addMessage(conversation, {\n        role: 'user',\n        content: userMessage\n      });\n    } catch (err) {\n      console.error('Error sending message:', err);\n      setError('Failed to send message. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  if (!isOpen) {\n    return (\n      <motion.div\n        initial={{ scale: 0 }}\n        animate={{ scale: 1 }}\n        className=\"fixed bottom-6 right-6 z-50\"\n      >\n        <Button\n          onClick={() => setIsOpen(true)}\n          className=\"h-16 w-16 rounded-full shadow-lg brand-gradient hover:opacity-90 relative\"\n        >\n          <MessageSquare className=\"w-7 h-7 text-white\" />\n          <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white flex items-center justify-center\">\n            <Sparkles className=\"w-3 h-3 text-white\" />\n          </div>\n        </Button>\n      </motion.div>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: 20 }}\n      className={`fixed ${isMinimized ? 'bottom-6 right-6' : 'bottom-6 right-6'} z-50 ${isMinimized ? 'w-80' : 'w-96 h-[600px]'}`}\n    >\n      <Card className=\"border-2 shadow-2xl flex flex-col h-full\">\n        {/* Header */}\n        <CardHeader className=\"bg-gradient-to-r from-purple-500 to-blue-500 text-white p-4 flex-shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-5 h-5\" />\n              <CardTitle className=\"font-fredoka text-lg\">{title}</CardTitle>\n              <Badge className=\"bg-green-500 text-white border-0 text-xs\">\n                AI\n              </Badge>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => setIsMinimized(!isMinimized)}\n                className=\"text-white hover:bg-white/20 h-8 w-8\"\n              >\n                {isMinimized ? <Maximize2 className=\"w-4 h-4\" /> : <Minimize2 className=\"w-4 h-4\" />}\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => setIsOpen(false)}\n                className=\"text-white hover:bg-white/20 h-8 w-8\"\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n\n        {!isMinimized && (\n          <>\n            {/* Messages */}\n            <CardContent className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50\">\n              {loading && messages.length === 0 ? (\n                <div className=\"flex items-center justify-center h-full\">\n                  <Loader2 className=\"w-8 h-8 animate-spin text-purple-500\" />\n                </div>\n              ) : messages.length === 0 ? (\n                <div className=\"flex flex-col items-center justify-center h-full text-center\">\n                  <Sparkles className=\"w-12 h-12 text-purple-500 mb-4\" />\n                  <p className=\"font-fredoka font-semibold text-graphite mb-2\">\n                    Hi! How can I help you today?\n                  </p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">\n                    Ask me anything about payments, bookings, or policies!\n                  </p>\n                </div>\n              ) : (\n                <>\n                  {messages.map((msg, idx) => (\n                    <MessageBubble key={idx} message={msg} />\n                  ))}\n                  <div ref={messagesEndRef} />\n                </>\n              )}\n\n              {error && (\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-600 font-verdana\">\n                  {error}\n                </div>\n              )}\n            </CardContent>\n\n            {/* Input */}\n            <div className=\"p-4 border-t bg-white flex-shrink-0\">\n              <div className=\"flex gap-2\">\n                <Input\n                  value={input}\n                  onChange={(e) => setInput(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder=\"Type your question...\"\n                  disabled={loading}\n                  className=\"flex-1\"\n                />\n                <Button\n                  onClick={sendMessage}\n                  disabled={!input.trim() || loading}\n                  className=\"brand-gradient\"\n                >\n                  {loading ? (\n                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                  ) : (\n                    <Send className=\"w-4 h-4\" />\n                  )}\n                </Button>\n              </div>\n              <p className=\"text-xs text-gray-500 mt-2 font-verdana\">\n                Powered by AI ‚Ä¢ Instant answers 24/7\n              </p>\n            </div>\n          </>\n        )}\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AICommunicationSettings.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Checkbox' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18,"fix":{"range":[487,540],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Checkbox"},"fix":{"range":[487,539],"text":""},"desc":"Remove unused variable 'Checkbox'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { \n  Bot, Mail, MessageSquare, Phone, Clock, CheckCircle2, \n  Send, ThumbsUp, Star, Calendar, Sparkles, AlertCircle,\n  Save, RotateCcw, Info, DollarSign\n} from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function AICommunicationSettings() {\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [settings, setSettings] = useState({\n    ai_scheduling_enabled: false,\n    prioritize_gap_filling: true,\n    suggest_days_in_advance: 14,\n    notify_client_not_interested: true,\n    booking_confirmation: {\n      enabled: true,\n      channels: ['in_app', 'email'],\n      custom_template: \"Hi {client_name}! Your cleaning is confirmed for {date} at {time}. Looking forward to making your space sparkle! - {cleaner_name}\"\n    },\n    pre_cleaning_reminder: {\n      enabled: true,\n      days_before: 1,\n      channels: ['sms', 'in_app'],\n      custom_template: \"Hi {client_name}! Just a reminder that I'll be cleaning your place tomorrow at {time}. Please ensure access is available. Thanks! - {cleaner_name}\"\n    },\n    on_my_way: {\n      enabled: true,\n      channels: ['sms', 'in_app'],\n      include_eta: true,\n      custom_template: \"Hi {client_name}! I'm on my way to your place. ETA: {eta} minutes. See you soon! - {cleaner_name}\"\n    },\n    post_cleaning_summary: {\n      enabled: true,\n      channels: ['in_app', 'email'],\n      custom_template: \"Hi {client_name}! Your cleaning is complete. Thank you for trusting me with your space! I hope you love the results. - {cleaner_name}\"\n    },\n    review_request: {\n      enabled: true,\n      hours_after_completion: 24,\n      channels: ['in_app', 'email'],\n      custom_template: \"Hi {client_name}! I hope you're enjoying your clean space! If you have a moment, I'd really appreciate your feedback. It helps me improve my service. - {cleaner_name}\"\n    },\n    tip_request: {\n      enabled: false,\n      hours_after_completion: 48,\n      channels: ['in_app', 'email'],\n      custom_template: \"Hi {client_name}! I'm so glad I could help make your space shine! If you were happy with the service, I'd be grateful for a tip. It really helps support my work. - {cleaner_name}\"\n    },\n    reengagement: {\n      enabled: false,\n      inactive_weeks: 8,\n      target_few_bookings: 1,\n      channels: ['email', 'in_app'],\n      discount_percentage: 0,\n      custom_template: \"Hi {client_name}! I noticed it's been a while since your last cleaning. I'd love to help you get your space refreshed again! {discount_text} - {cleaner_name}\"\n    }\n  });\n\n  useEffect(() => {\n    loadSettings();\n  }, []);\n\n  const loadSettings = async () => {\n    try {\n      setLoading(true);\n      const user = await base44.auth.me();\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: user.email });\n      \n      if (profiles.length > 0) {\n        setCleanerProfile(profiles[0]);\n        if (profiles[0].communication_settings) {\n          setSettings({ ...settings, ...profiles[0].communication_settings });\n        }\n      }\n    } catch (error) {\n      toast.error('Failed to load settings');\n      console.error(error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const saveSettings = async () => {\n    try {\n      setSaving(true);\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        communication_settings: settings\n      });\n      toast.success('Settings saved successfully!');\n    } catch (error) {\n      toast.error('Failed to save settings');\n      console.error(error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const resetToDefaults = () => {\n    setSettings({\n      ai_scheduling_enabled: false,\n      prioritize_gap_filling: true,\n      suggest_days_in_advance: 14,\n      notify_client_not_interested: true,\n      booking_confirmation: {\n        enabled: true,\n        channels: ['in_app', 'email'],\n        custom_template: \"Hi {client_name}! Your cleaning is confirmed for {date} at {time}. Looking forward to making your space sparkle! - {cleaner_name}\"\n      },\n      pre_cleaning_reminder: {\n        enabled: true,\n        days_before: 1,\n        channels: ['sms', 'in_app'],\n        custom_template: \"Hi {client_name}! Just a reminder that I'll be cleaning your place tomorrow at {time}. Please ensure access is available. Thanks! - {cleaner_name}\"\n      },\n      on_my_way: {\n        enabled: true,\n        channels: ['sms', 'in_app'],\n        include_eta: true,\n        custom_template: \"Hi {client_name}! I'm on my way to your place. ETA: {eta} minutes. See you soon! - {cleaner_name}\"\n      },\n      post_cleaning_summary: {\n        enabled: true,\n        channels: ['in_app', 'email'],\n        custom_template: \"Hi {client_name}! Your cleaning is complete. Thank you for trusting me with your space! I hope you love the results. - {cleaner_name}\"\n      },\n      review_request: {\n        enabled: true,\n        hours_after_completion: 24,\n        channels: ['in_app', 'email'],\n        custom_template: \"Hi {client_name}! I hope you're enjoying your clean space! If you have a moment, I'd really appreciate your feedback. It helps me improve my service. - {cleaner_name}\"\n      },\n      tip_request: {\n        enabled: false,\n        hours_after_completion: 48,\n        channels: ['in_app', 'email'],\n        custom_template: \"Hi {client_name}! I'm so glad I could help make your space shine! If you were happy with the service, I'd be grateful for a tip. It really helps support my work. - {cleaner_name}\"\n      },\n      reengagement: {\n        enabled: false,\n        inactive_weeks: 8,\n        target_few_bookings: 1,\n        channels: ['email', 'in_app'],\n        discount_percentage: 0,\n        custom_template: \"Hi {client_name}! I noticed it's been a while since your last cleaning. I'd love to help you get your space refreshed again! {discount_text} - {cleaner_name}\"\n      }\n    });\n    toast.info('Settings reset to defaults');\n  };\n\n  const updateSetting = (path, value) => {\n    const keys = path.split('.');\n    const newSettings = { ...settings };\n    let current = newSettings;\n    \n    for (let i = 0; i < keys.length - 1; i++) {\n      if (!current[keys[i]]) current[keys[i]] = {};\n      current = current[keys[i]];\n    }\n    current[keys[keys.length - 1]] = value;\n    \n    setSettings(newSettings);\n  };\n\n  const toggleChannel = (messagePath, channel) => {\n    const currentChannels = settings[messagePath]?.channels || [];\n    const newChannels = currentChannels.includes(channel)\n      ? currentChannels.filter(c => c !== channel)\n      : [...currentChannels, channel];\n    updateSetting(`${messagePath}.channels`, newChannels);\n  };\n\n  const countActiveAutomations = () => {\n    let count = 0;\n    if (settings.ai_scheduling_enabled) count++;\n    if (settings.booking_confirmation?.enabled) count++;\n    if (settings.pre_cleaning_reminder?.enabled) count++;\n    if (settings.on_my_way?.enabled) count++;\n    if (settings.post_cleaning_summary?.enabled) count++;\n    if (settings.review_request?.enabled) count++;\n    if (settings.tip_request?.enabled) count++;\n    if (settings.reengagement?.enabled) count++;\n    return count;\n  };\n\n  const ChannelSelector = ({ messagePath, availableChannels = ['sms', 'email', 'in_app'] }) => {\n    const channels = settings[messagePath]?.channels || [];\n    \n    return (\n      <div className=\"space-y-2\">\n        <Label>Channels</Label>\n        <div className=\"flex flex-wrap gap-2\">\n          {availableChannels.map(channel => (\n            <div\n              key={channel}\n              onClick={() => toggleChannel(messagePath, channel)}\n              className={`flex items-center gap-2 px-3 py-2 rounded-lg border-2 cursor-pointer transition-all ${\n                channels.includes(channel)\n                  ? 'border-puretask-blue bg-blue-50'\n                  : 'border-gray-200 hover:border-gray-300'\n              }`}\n            >\n              {channel === 'sms' && <Phone className=\"w-4 h-4\" />}\n              {channel === 'email' && <Mail className=\"w-4 h-4\" />}\n              {channel === 'in_app' && <MessageSquare className=\"w-4 h-4\" />}\n              <span className=\"text-sm font-medium capitalize\">{channel.replace('_', ' ')}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  const MessagePreview = ({ template }) => {\n    const sampleData = {\n      client_name: 'Sarah Johnson',\n      cleaner_name: cleanerProfile?.full_name || 'You',\n      date: 'January 15, 2025',\n      time: '10:00 AM',\n      address: '123 Main St',\n      eta: '15',\n      hours: '3',\n      discount_text: 'Use code WELCOME15 for 15% off!',\n      review_link: 'https://puretask.com/review/123'\n    };\n\n    let preview = template;\n    Object.keys(sampleData).forEach(key => {\n      preview = preview.replace(new RegExp(`{${key}}`, 'g'), sampleData[key]);\n    });\n\n    return (\n      <div className=\"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200\">\n        <div className=\"flex items-center gap-2 mb-2\">\n          <Info className=\"w-4 h-4 text-gray-500\" />\n          <span className=\"text-xs text-gray-600 font-medium\">Preview</span>\n        </div>\n        <p className=\"text-sm text-gray-700\">{preview}</p>\n        <p className=\"text-xs text-gray-500 mt-2\">\n          {template.length} characters {template.length > 160 && '‚Ä¢ SMS may be split into multiple messages'}\n        </p>\n      </div>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-puretask-blue\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto space-y-6\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <div className=\"flex items-center gap-3 mb-2\">\n              <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-puretask-blue to-indigo-500 flex items-center justify-center\">\n                <Bot className=\"w-6 h-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-fredoka font-bold text-graphite\">AI Communication Automation</h1>\n                <p className=\"text-gray-600 font-verdana\">Configure how and when AI communicates with your clients</p>\n              </div>\n            </div>\n          </div>\n          <Badge className=\"bg-puretask-blue text-white font-fredoka\">\n            {countActiveAutomations()} Active\n          </Badge>\n        </div>\n      </div>\n\n      {/* AI Scheduling Settings */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n            <CardTitle className=\"font-fredoka\">AI-Driven Scheduling</CardTitle>\n          </div>\n          <CardDescription>Let AI suggest optimal booking times to clients</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"font-medium\">Enable AI Scheduling Suggestions</Label>\n              <p className=\"text-sm text-gray-600\">AI will analyze your schedule and suggest optimal times to clients</p>\n            </div>\n            <Switch\n              checked={settings.ai_scheduling_enabled}\n              onCheckedChange={(checked) => updateSetting('ai_scheduling_enabled', checked)}\n            />\n          </div>\n\n          {settings.ai_scheduling_enabled && (\n            <>\n              <div className=\"space-y-2\">\n                <Label>Suggest bookings up to (days in advance)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"90\"\n                  value={settings.suggest_days_in_advance}\n                  onChange={(e) => updateSetting('suggest_days_in_advance', parseInt(e.target.value))}\n                />\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label className=\"font-medium\">Prioritize Gap-Filling</Label>\n                  <p className=\"text-sm text-gray-600\">Prefer times that reduce travel between bookings</p>\n                </div>\n                <Switch\n                  checked={settings.prioritize_gap_filling}\n                  onCheckedChange={(checked) => updateSetting('prioritize_gap_filling', checked)}\n                />\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label className=\"font-medium\">Notify on Client Decline</Label>\n                  <p className=\"text-sm text-gray-600\">Get notified when clients choose \"not interested\"</p>\n                </div>\n                <Switch\n                  checked={settings.notify_client_not_interested}\n                  onCheckedChange={(checked) => updateSetting('notify_client_not_interested', checked)}\n                />\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Booking Confirmation */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <CheckCircle2 className=\"w-5 h-5 text-green-600\" />\n            <CardTitle className=\"font-fredoka\">Booking Confirmation</CardTitle>\n          </div>\n          <CardDescription>Automatically confirm bookings with clients</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Confirmation Messages</Label>\n            <Switch\n              checked={settings.booking_confirmation?.enabled}\n              onCheckedChange={(checked) => updateSetting('booking_confirmation.enabled', checked)}\n            />\n          </div>\n\n          {settings.booking_confirmation?.enabled && (\n            <>\n              <ChannelSelector messagePath=\"booking_confirmation\" />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.booking_confirmation?.custom_template}\n                  onChange={(e) => updateSetting('booking_confirmation.custom_template', e.target.value)}\n                  rows={3}\n                  placeholder=\"Your confirmation message...\"\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{date}'}, {'{time}'}, {'{cleaner_name}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.booking_confirmation?.custom_template} />\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Pre-Cleaning Reminder */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Clock className=\"w-5 h-5 text-orange-600\" />\n            <CardTitle className=\"font-fredoka\">Pre-Cleaning Reminder</CardTitle>\n          </div>\n          <CardDescription>Send reminders before scheduled cleanings</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Reminders</Label>\n            <Switch\n              checked={settings.pre_cleaning_reminder?.enabled}\n              onCheckedChange={(checked) => updateSetting('pre_cleaning_reminder.enabled', checked)}\n            />\n          </div>\n\n          {settings.pre_cleaning_reminder?.enabled && (\n            <>\n              <div className=\"space-y-2\">\n                <Label>Send reminder (days before)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"7\"\n                  value={settings.pre_cleaning_reminder?.days_before}\n                  onChange={(e) => updateSetting('pre_cleaning_reminder.days_before', parseInt(e.target.value))}\n                />\n              </div>\n\n              <ChannelSelector messagePath=\"pre_cleaning_reminder\" />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.pre_cleaning_reminder?.custom_template}\n                  onChange={(e) => updateSetting('pre_cleaning_reminder.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{time}'}, {'{cleaner_name}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.pre_cleaning_reminder?.custom_template} />\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* On My Way */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Send className=\"w-5 h-5 text-blue-600\" />\n            <CardTitle className=\"font-fredoka\">\"On My Way\" Notification</CardTitle>\n          </div>\n          <CardDescription>Alert clients when you're heading to their location</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable \"On My Way\" Messages</Label>\n            <Switch\n              checked={settings.on_my_way?.enabled}\n              onCheckedChange={(checked) => updateSetting('on_my_way.enabled', checked)}\n            />\n          </div>\n\n          {settings.on_my_way?.enabled && (\n            <>\n              <ChannelSelector messagePath=\"on_my_way\" availableChannels={['sms', 'in_app']} />\n              \n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label className=\"font-medium\">Include GPS-based ETA</Label>\n                  <p className=\"text-sm text-gray-600\">Show estimated arrival time</p>\n                </div>\n                <Switch\n                  checked={settings.on_my_way?.include_eta}\n                  onCheckedChange={(checked) => updateSetting('on_my_way.include_eta', checked)}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.on_my_way?.custom_template}\n                  onChange={(e) => updateSetting('on_my_way.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{eta}'}, {'{cleaner_name}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.on_my_way?.custom_template} />\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Post-Cleaning Summary */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Sparkles className=\"w-5 h-5 text-purple-600\" />\n            <CardTitle className=\"font-fredoka\">Post-Cleaning Summary</CardTitle>\n          </div>\n          <CardDescription>Send a thank you message after completing cleanings</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Summary Messages</Label>\n            <Switch\n              checked={settings.post_cleaning_summary?.enabled}\n              onCheckedChange={(checked) => updateSetting('post_cleaning_summary.enabled', checked)}\n            />\n          </div>\n\n          {settings.post_cleaning_summary?.enabled && (\n            <>\n              <ChannelSelector messagePath=\"post_cleaning_summary\" />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.post_cleaning_summary?.custom_template}\n                  onChange={(e) => updateSetting('post_cleaning_summary.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{cleaner_name}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.post_cleaning_summary?.custom_template} />\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Review Request */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <Star className=\"w-5 h-5 text-yellow-600\" />\n            <CardTitle className=\"font-fredoka\">Review Request</CardTitle>\n          </div>\n          <CardDescription>Request feedback from satisfied clients</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Review Requests</Label>\n            <Switch\n              checked={settings.review_request?.enabled}\n              onCheckedChange={(checked) => updateSetting('review_request.enabled', checked)}\n            />\n          </div>\n\n          {settings.review_request?.enabled && (\n            <>\n              <div className=\"space-y-2\">\n                <Label>Send request (hours after completion)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"168\"\n                  value={settings.review_request?.hours_after_completion}\n                  onChange={(e) => updateSetting('review_request.hours_after_completion', parseInt(e.target.value))}\n                />\n              </div>\n\n              <ChannelSelector messagePath=\"review_request\" />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.review_request?.custom_template}\n                  onChange={(e) => updateSetting('review_request.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{cleaner_name}'}, {'{review_link}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.review_request?.custom_template} />\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Tip Request */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <DollarSign className=\"w-5 h-5 text-green-600\" />\n            <CardTitle className=\"font-fredoka\">Tip Request</CardTitle>\n          </div>\n          <CardDescription>Politely request tips from satisfied clients</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Tip Requests</Label>\n            <Switch\n              checked={settings.tip_request?.enabled}\n              onCheckedChange={(checked) => updateSetting('tip_request.enabled', checked)}\n            />\n          </div>\n\n          {settings.tip_request?.enabled && (\n            <>\n              <div className=\"space-y-2\">\n                <Label>Send request (hours after completion)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"168\"\n                  value={settings.tip_request?.hours_after_completion}\n                  onChange={(e) => updateSetting('tip_request.hours_after_completion', parseInt(e.target.value))}\n                />\n                <p className=\"text-xs text-gray-500\">Recommended: 48-72 hours after completion</p>\n              </div>\n\n              <ChannelSelector messagePath=\"tip_request\" availableChannels={['email', 'in_app']} />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.tip_request?.custom_template}\n                  onChange={(e) => updateSetting('tip_request.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{cleaner_name}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.tip_request?.custom_template} />\n\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n                <div className=\"flex gap-2\">\n                  <Info className=\"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5\" />\n                  <div>\n                    <p className=\"text-sm text-blue-800 font-medium\">Respectful tipping culture</p>\n                    <p className=\"text-xs text-blue-700 mt-1\">Tip requests are sent politely and include an easy way to tip directly through the platform</p>\n                  </div>\n                </div>\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Re-engagement Campaign */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <ThumbsUp className=\"w-5 h-5 text-indigo-600\" />\n            <CardTitle className=\"font-fredoka\">Re-engagement Campaign</CardTitle>\n          </div>\n          <CardDescription>Win back inactive clients automatically</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <Label className=\"font-medium\">Enable Re-engagement</Label>\n            <Switch\n              checked={settings.reengagement?.enabled}\n              onCheckedChange={(checked) => updateSetting('reengagement.enabled', checked)}\n            />\n          </div>\n\n          {settings.reengagement?.enabled && (\n            <>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Inactive after (weeks)</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"52\"\n                    value={settings.reengagement?.inactive_weeks}\n                    onChange={(e) => updateSetting('reengagement.inactive_weeks', parseInt(e.target.value))}\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Target clients with ‚â§ bookings</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"10\"\n                    value={settings.reengagement?.target_few_bookings}\n                    onChange={(e) => updateSetting('reengagement.target_few_bookings', parseInt(e.target.value))}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Offer discount (%)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"50\"\n                  value={settings.reengagement?.discount_percentage}\n                  onChange={(e) => updateSetting('reengagement.discount_percentage', parseInt(e.target.value))}\n                />\n                <p className=\"text-xs text-gray-500\">Set to 0 for no discount</p>\n              </div>\n\n              <ChannelSelector messagePath=\"reengagement\" />\n              \n              <div className=\"space-y-2\">\n                <Label>Custom Message Template</Label>\n                <Textarea\n                  value={settings.reengagement?.custom_template}\n                  onChange={(e) => updateSetting('reengagement.custom_template', e.target.value)}\n                  rows={3}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Available variables: {'{client_name}'}, {'{cleaner_name}'}, {'{discount_text}'}\n                </p>\n              </div>\n\n              <MessagePreview template={settings.reengagement?.custom_template} />\n\n              <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3\">\n                <div className=\"flex gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5\" />\n                  <div>\n                    <p className=\"text-sm text-amber-800 font-medium\">Campaign runs weekly</p>\n                    <p className=\"text-xs text-amber-700 mt-1\">Clients won't receive more than one message per month to avoid spam</p>\n                  </div>\n                </div>\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Footer Actions */}\n      <div className=\"sticky bottom-4 bg-white rounded-xl border-2 border-gray-200 shadow-lg p-4\">\n        <div className=\"flex items-center justify-between\">\n          <Button\n            variant=\"outline\"\n            onClick={resetToDefaults}\n            className=\"gap-2\"\n          >\n            <RotateCcw className=\"w-4 h-4\" />\n            Reset to Defaults\n          </Button>\n\n          <Button\n            onClick={saveSettings}\n            disabled={saving}\n            className=\"brand-gradient text-white gap-2\"\n          >\n            <Save className=\"w-4 h-4\" />\n            {saving ? 'Saving...' : 'Save All Settings'}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AIProfileAssistant.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"fix":{"range":[271,278],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[272,278],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":6,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":33,"fix":{"range":[277,295],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[277,295],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":9,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":49,"fix":{"range":[429,441],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[428,440],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  Sparkles, Loader2, CheckCircle, Lightbulb, MapPin, \n  Award, Calendar, Package, FileText, TrendingUp, DollarSign\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\n\nexport default function AIProfileAssistant({ profile, bookings = [], reviews = [], onUpdate }) {\n  const [loading, setLoading] = useState(false);\n  const [suggestions, setSuggestions] = useState(null);\n  const [selectedSuggestions, setSelectedSuggestions] = useState({\n    specialties: [],\n    serviceAreas: []\n  });\n\n  const generateAISuggestions = async () => {\n    setLoading(true);\n    try {\n      // Gather cleaner data for AI analysis\n      const completedJobs = bookings.filter(b => b.status === 'approved' || b.status === 'completed');\n      const jobTypes = completedJobs.map(b => b.cleaning_type);\n      const jobLocations = [...new Set(completedJobs.map(b => b.address).filter(Boolean))];\n      const reviewTexts = reviews.map(r => r.comment).filter(Boolean).slice(0, 10);\n      \n      const analysisPrompt = `\nYou are an AI assistant helping professional cleaners optimize their profiles. Analyze the following data and provide actionable recommendations:\n\nCLEANER PROFILE:\n- Bio: ${profile.bio || 'Not provided'}\n- Current Specialties: ${profile.specialty_tags?.join(', ') || 'None'}\n- Total Jobs Completed: ${profile.total_jobs || 0}\n- Average Rating: ${profile.average_rating || 0}/5\n- Service Locations: ${profile.service_locations?.join(', ') || 'None'}\n- Years of Experience (self-reported): ${profile.years_of_experience || 0}\n\nJOB HISTORY:\n- Completed Jobs: ${completedJobs.length}\n- Job Types: ${jobTypes.join(', ')}\n- Unique Locations: ${jobLocations.length}\n\nCLIENT REVIEWS (sample):\n${reviewTexts.slice(0, 5).map((r, i) => `${i + 1}. \"${r}\"`).join('\\n')}\n\nTASK: Provide recommendations in the following JSON format (no markdown, just JSON):\n{\n  \"specialties\": {\n    \"suggested\": [\"list of 3-5 specialty tags that match their experience\"],\n    \"reasoning\": \"brief explanation\"\n  },\n  \"experienceYears\": {\n    \"estimated\": number (0.5 to 20),\n    \"reasoning\": \"explanation based on jobs and reviews\"\n  },\n  \"serviceAreas\": {\n    \"suggested\": [\"3-5 location areas based on job locations\"],\n    \"reasoning\": \"why these areas make sense\"\n  },\n  \"cleaningProcess\": {\n    \"recommendations\": [\"3-5 specific process improvements\"],\n    \"reasoning\": \"brief explanation\"\n  },\n  \"materials\": {\n    \"recommended\": [\"5-7 essential cleaning products\"],\n    \"reasoning\": \"why these are recommended\"\n  },\n  \"bioImprovement\": {\n    \"suggested\": \"improved bio text (2-3 sentences)\",\n    \"highlights\": [\"3 key selling points to emphasize\"]\n  },\n  \"pricingInsight\": {\n    \"recommendation\": \"pricing strategy suggestion\",\n    \"reasoning\": \"market positioning advice\"\n  }\n}\n\nUse only these specialty options: Pet-Friendly, Eco-Warrior, Deep Clean Expert, Move-Out Specialist, Same-Day Available, Senior-Friendly, Child-Safe Products, Allergy-Conscious, Organization Pro, Post-Construction\n`;\n\n      const response = await base44.integrations.Core.InvokeLLM({\n        prompt: analysisPrompt,\n        response_json_schema: {\n          type: \"object\",\n          properties: {\n            specialties: {\n              type: \"object\",\n              properties: {\n                suggested: { type: \"array\", items: { type: \"string\" } },\n                reasoning: { type: \"string\" }\n              }\n            },\n            experienceYears: {\n              type: \"object\",\n              properties: {\n                estimated: { type: \"number\" },\n                reasoning: { type: \"string\" }\n              }\n            },\n            serviceAreas: {\n              type: \"object\",\n              properties: {\n                suggested: { type: \"array\", items: { type: \"string\" } },\n                reasoning: { type: \"string\" }\n              }\n            },\n            cleaningProcess: {\n              type: \"object\",\n              properties: {\n                recommendations: { type: \"array\", items: { type: \"string\" } },\n                reasoning: { type: \"string\" }\n              }\n            },\n            materials: {\n              type: \"object\",\n              properties: {\n                recommended: { type: \"array\", items: { type: \"string\" } },\n                reasoning: { type: \"string\" }\n              }\n            },\n            bioImprovement: {\n              type: \"object\",\n              properties: {\n                suggested: { type: \"string\" },\n                highlights: { type: \"array\", items: { type: \"string\" } }\n              }\n            },\n            pricingInsight: {\n              type: \"object\",\n              properties: {\n                recommendation: { type: \"string\" },\n                reasoning: { type: \"string\" }\n              }\n            }\n          }\n        }\n      });\n\n      setSuggestions(response);\n      toast.success('AI analysis complete!');\n    } catch (error) {\n      console.error('AI analysis error:', error);\n      toast.error('Failed to generate suggestions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const applySuggestion = async (type, value) => {\n    try {\n      let updates = {};\n      \n      switch (type) {\n        case 'specialties':\n          updates.specialty_tags = value;\n          break;\n        case 'experience':\n          updates.years_of_experience = value;\n          break;\n        case 'serviceAreas':\n          updates.service_locations = value;\n          break;\n        case 'bio':\n          updates.bio = value;\n          break;\n      }\n\n      await base44.entities.CleanerProfile.update(profile.id, updates);\n      toast.success('Profile updated!');\n      if (onUpdate) onUpdate({ ...profile, ...updates });\n    } catch (error) {\n      console.error('Update error:', error);\n      toast.error('Failed to update profile');\n    }\n  };\n\n  const toggleSpecialty = (specialty) => {\n    setSelectedSuggestions(prev => ({\n      ...prev,\n      specialties: prev.specialties.includes(specialty)\n        ? prev.specialties.filter(s => s !== specialty)\n        : [...prev.specialties, specialty]\n    }));\n  };\n\n  const toggleServiceArea = (area) => {\n    setSelectedSuggestions(prev => ({\n      ...prev,\n      serviceAreas: prev.serviceAreas.includes(area)\n        ? prev.serviceAreas.filter(a => a !== area)\n        : [...prev.serviceAreas, area]\n    }));\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white\">\n        <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n          <Sparkles className=\"w-6 h-6\" />\n          AI Profile Assistant\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        {!suggestions ? (\n          <div className=\"text-center py-8\">\n            <Sparkles className=\"w-16 h-16 text-purple-500 mx-auto mb-4\" />\n            <h3 className=\"font-fredoka font-bold text-xl text-graphite mb-2\">\n              Get AI-Powered Profile Recommendations\n            </h3>\n            <p className=\"text-gray-600 font-verdana mb-6 max-w-md mx-auto\">\n              Our AI will analyze your bio, job history, and reviews to suggest improvements for your profile.\n            </p>\n            <Button\n              onClick={generateAISuggestions}\n              disabled={loading}\n              className=\"brand-gradient text-white font-fredoka font-bold px-8 py-6 text-lg\"\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Analyzing...\n                </>\n              ) : (\n                <>\n                  <Sparkles className=\"w-5 h-5 mr-2\" />\n                  Generate AI Suggestions\n                </>\n              )}\n            </Button>\n          </div>\n        ) : (\n          <AnimatePresence>\n            <div className=\"space-y-6\">\n              {/* Specialties */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"bg-purple-50 border-2 border-purple-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3 mb-3\">\n                  <Award className=\"w-6 h-6 text-purple-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Recommended Specialties</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-3\">{suggestions.specialties.reasoning}</p>\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {suggestions.specialties.suggested.map((spec, i) => (\n                        <Badge\n                          key={i}\n                          onClick={() => toggleSpecialty(spec)}\n                          className={`cursor-pointer transition-all ${\n                            selectedSuggestions.specialties.includes(spec)\n                              ? 'bg-purple-600 text-white'\n                              : 'bg-white text-purple-600 border-2 border-purple-300'\n                          }`}\n                        >\n                          {spec}\n                        </Badge>\n                      ))}\n                    </div>\n                    {selectedSuggestions.specialties.length > 0 && (\n                      <Button\n                        onClick={() => applySuggestion('specialties', selectedSuggestions.specialties)}\n                        size=\"sm\"\n                        className=\"bg-purple-600 text-white font-fredoka\"\n                      >\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        Apply Selected\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Experience Years */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.1 }}\n                className=\"bg-blue-50 border-2 border-blue-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <Calendar className=\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Estimated Experience</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-3\">{suggestions.experienceYears.reasoning}</p>\n                    <div className=\"flex items-center gap-3\">\n                      <Badge className=\"bg-blue-600 text-white text-lg px-4 py-2\">\n                        {suggestions.experienceYears.estimated} Years\n                      </Badge>\n                      <Button\n                        onClick={() => applySuggestion('experience', suggestions.experienceYears.estimated)}\n                        size=\"sm\"\n                        className=\"bg-blue-600 text-white font-fredoka\"\n                      >\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        Apply\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Service Areas */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.2 }}\n                className=\"bg-green-50 border-2 border-green-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <MapPin className=\"w-6 h-6 text-green-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Optimal Service Areas</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-3\">{suggestions.serviceAreas.reasoning}</p>\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {suggestions.serviceAreas.suggested.map((area, i) => (\n                        <Badge\n                          key={i}\n                          onClick={() => toggleServiceArea(area)}\n                          className={`cursor-pointer transition-all ${\n                            selectedSuggestions.serviceAreas.includes(area)\n                              ? 'bg-green-600 text-white'\n                              : 'bg-white text-green-600 border-2 border-green-300'\n                          }`}\n                        >\n                          {area}\n                        </Badge>\n                      ))}\n                    </div>\n                    {selectedSuggestions.serviceAreas.length > 0 && (\n                      <Button\n                        onClick={() => applySuggestion('serviceAreas', selectedSuggestions.serviceAreas)}\n                        size=\"sm\"\n                        className=\"bg-green-600 text-white font-fredoka\"\n                      >\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        Apply Selected\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Bio Improvement */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.3 }}\n                className=\"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <FileText className=\"w-6 h-6 text-indigo-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Improved Bio</h3>\n                    <p className=\"text-sm text-gray-700 font-verdana mb-3 italic\">\"{suggestions.bioImprovement.suggested}\"</p>\n                    <div className=\"mb-3\">\n                      <p className=\"text-xs text-gray-600 font-verdana mb-2\">Key highlights to emphasize:</p>\n                      <ul className=\"space-y-1\">\n                        {suggestions.bioImprovement.highlights.map((h, i) => (\n                          <li key={i} className=\"text-xs text-gray-700 font-verdana flex items-start gap-2\">\n                            <CheckCircle className=\"w-3 h-3 text-indigo-600 mt-0.5 flex-shrink-0\" />\n                            {h}\n                          </li>\n                        ))}\n                      </ul>\n                    </div>\n                    <Button\n                      onClick={() => applySuggestion('bio', suggestions.bioImprovement.suggested)}\n                      size=\"sm\"\n                      className=\"bg-indigo-600 text-white font-fredoka\"\n                    >\n                      <CheckCircle className=\"w-4 h-4 mr-2\" />\n                      Use This Bio\n                    </Button>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Cleaning Process */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.4 }}\n                className=\"bg-amber-50 border-2 border-amber-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <Lightbulb className=\"w-6 h-6 text-amber-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Process Improvements</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-3\">{suggestions.cleaningProcess.reasoning}</p>\n                    <ul className=\"space-y-2\">\n                      {suggestions.cleaningProcess.recommendations.map((rec, i) => (\n                        <li key={i} className=\"text-sm text-gray-700 font-verdana flex items-start gap-2\">\n                          <CheckCircle className=\"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0\" />\n                          {rec}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Materials */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.5 }}\n                className=\"bg-teal-50 border-2 border-teal-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <Package className=\"w-6 h-6 text-teal-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Recommended Materials</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-3\">{suggestions.materials.reasoning}</p>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      {suggestions.materials.recommended.map((mat, i) => (\n                        <Badge key={i} className=\"bg-teal-100 text-teal-700 border-2 border-teal-300 justify-start\">\n                          {mat}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Pricing Insight */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.6 }}\n                className=\"bg-pink-50 border-2 border-pink-200 rounded-xl p-4\"\n              >\n                <div className=\"flex items-start gap-3\">\n                  <DollarSign className=\"w-6 h-6 text-pink-600 flex-shrink-0 mt-1\" />\n                  <div className=\"flex-1\">\n                    <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Pricing Strategy</h3>\n                    <p className=\"text-sm text-gray-700 font-verdana mb-2\">{suggestions.pricingInsight.recommendation}</p>\n                    <p className=\"text-xs text-gray-600 font-verdana italic\">{suggestions.pricingInsight.reasoning}</p>\n                  </div>\n                </div>\n              </motion.div>\n\n              {/* Regenerate Button */}\n              <Button\n                onClick={generateAISuggestions}\n                variant=\"outline\"\n                className=\"w-full border-2 border-purple-300 text-purple-600 hover:bg-purple-50 font-fredoka font-bold\"\n              >\n                <Sparkles className=\"w-4 h-4 mr-2\" />\n                Regenerate Suggestions\n              </Button>\n            </div>\n          </AnimatePresence>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AdditionalServicesPricingEditor.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AdvancedFiltersPanel.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'allLocations' is defined but never used. Allowed unused args must match /^_/u.","line":9,"column":82,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":94,"suggestions":[{"messageId":"removeVar","data":{"varName":"allLocations"},"fix":{"range":[441,455],"text":""},"desc":"Remove unused variable 'allLocations'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Slider } from '@/components/ui/slider';\nimport { Button } from '@/components/ui/button';\nimport { X } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdvancedFiltersPanel({ filters, onFilterChange, onClose, allLocations }) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, height: 0 }}\n      animate={{ opacity: 1, height: 'auto' }}\n      exit={{ opacity: 0, height: 0 }}\n      className=\"bg-soft-cloud border-b-2 border-gray-200\"\n    >\n      <Card className=\"max-w-7xl mx-auto border-0 shadow-none rounded-none bg-transparent\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite\">Filter Options</h3>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={onClose}\n              className=\"rounded-full hover:bg-gray-200\"\n            >\n              <X className=\"w-5 h-5\" />\n            </Button>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {/* Price Range */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Price Range (credits/hr)\n              </label>\n              <div className=\"space-y-3\">\n                <Slider\n                  value={[filters.minPrice, filters.maxPrice]}\n                  onValueChange={([min, max]) => {\n                    onFilterChange('minPrice', min);\n                    onFilterChange('maxPrice', max);\n                  }}\n                  min={0}\n                  max={100}\n                  step={5}\n                  className=\"w-full\"\n                />\n                <div className=\"flex justify-between text-sm font-verdana text-gray-600\">\n                  <span>{filters.minPrice} credits</span>\n                  <span>{filters.maxPrice} credits</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Minimum Rating */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Minimum Rating\n              </label>\n              <Select \n                value={filters.minRating.toString()} \n                onValueChange={(value) => onFilterChange('minRating', parseFloat(value))}\n              >\n                <SelectTrigger className=\"rounded-full border-2 border-gray-200 font-verdana bg-white\">\n                  <SelectValue placeholder=\"Any rating\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"0\">Any rating</SelectItem>\n                  <SelectItem value=\"3\">3+ stars</SelectItem>\n                  <SelectItem value=\"4\">4+ stars</SelectItem>\n                  <SelectItem value=\"4.5\">4.5+ stars</SelectItem>\n                  <SelectItem value=\"4.8\">4.8+ stars</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Reliability Score */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Reliability Score\n              </label>\n              <Select \n                value={filters.minReliability.toString()} \n                onValueChange={(value) => onFilterChange('minReliability', parseInt(value))}\n              >\n                <SelectTrigger className=\"rounded-full border-2 border-gray-200 font-verdana bg-white\">\n                  <SelectValue placeholder=\"Any score\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"0\">Any score</SelectItem>\n                  <SelectItem value=\"90\">Elite (90-100)</SelectItem>\n                  <SelectItem value=\"75\">Pro (75-89)</SelectItem>\n                  <SelectItem value=\"60\">Semi Pro (60-74)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Availability */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Availability\n              </label>\n              <Select \n                value={filters.availability} \n                onValueChange={(value) => onFilterChange('availability', value)}\n              >\n                <SelectTrigger className=\"rounded-full border-2 border-gray-200 font-verdana bg-white\">\n                  <SelectValue placeholder=\"Any time\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Any time</SelectItem>\n                  <SelectItem value=\"today\">Today</SelectItem>\n                  <SelectItem value=\"tomorrow\">Tomorrow</SelectItem>\n                  <SelectItem value=\"week\">This week</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Cleaning Type */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Cleaning Type Specialty\n              </label>\n              <Select \n                value={filters.cleaningType} \n                onValueChange={(value) => onFilterChange('cleaningType', value)}\n              >\n                <SelectTrigger className=\"rounded-full border-2 border-gray-200 font-verdana bg-white\">\n                  <SelectValue placeholder=\"All types\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All types</SelectItem>\n                  <SelectItem value=\"basic\">Basic clean</SelectItem>\n                  <SelectItem value=\"deep\">Deep clean</SelectItem>\n                  <SelectItem value=\"move-out\">Move-out clean</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Tier */}\n            <div>\n              <label className=\"text-sm font-fredoka font-semibold text-gray-700 mb-3 block\">\n                Tier Level\n              </label>\n              <Select \n                value={filters.tier} \n                onValueChange={(value) => onFilterChange('tier', value)}\n              >\n                <SelectTrigger className=\"rounded-full border-2 border-gray-200 font-verdana bg-white\">\n                  <SelectValue placeholder=\"All tiers\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All tiers</SelectItem>\n                  <SelectItem value=\"Elite\">Elite</SelectItem>\n                  <SelectItem value=\"Pro\">Pro</SelectItem>\n                  <SelectItem value=\"Semi Pro\">Semi Pro</SelectItem>\n                  <SelectItem value=\"Developing\">Developing</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AvailabilityChecker.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'base44' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":16,"fix":{"range":[0,45],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"base44"},"fix":{"range":[0,44],"text":""},"desc":"Remove unused variable 'base44'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\nimport { getBlockedTimeSlots } from '../booking/BookingConflictChecker';\n\n/**\n * Cleaner Availability Checker\n * Validates if a cleaner is available for a specific date/time\n * Now includes conflict checking against existing bookings\n */\n\nexport const checkCleanerAvailability = (cleanerProfile, date, startTime) => {\n  if (!cleanerProfile || !date || !startTime) {\n    return { available: false, reason: 'Missing required parameters' };\n  }\n\n  // Check if cleaner is active\n  if (!cleanerProfile.is_active) {\n    return { available: false, reason: 'Cleaner is not currently accepting bookings' };\n  }\n\n  // Get day of week (0 = Sunday, 1 = Monday, etc.)\n  const dayOfWeek = date.getDay();\n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  const dayName = dayNames[dayOfWeek];\n\n  // Check weekly availability schedule\n  const availability = cleanerProfile.availability || [];\n  const daySchedule = availability.find(a => a.day === dayName);\n\n  if (!daySchedule || !daySchedule.available) {\n    return { \n      available: false, \n      reason: `${cleanerProfile.full_name} is not available on ${dayName}s` \n    };\n  }\n\n  // Check if time falls within available hours\n  if (daySchedule.start_time && daySchedule.end_time) {\n    const requestedTime = parseTime(startTime);\n    const availableStart = parseTime(daySchedule.start_time);\n    const availableEnd = parseTime(daySchedule.end_time);\n\n    if (requestedTime < availableStart || requestedTime > availableEnd) {\n      return {\n        available: false,\n        reason: `${cleanerProfile.full_name} is available ${dayName}s from ${convertTo12Hour(daySchedule.start_time)} to ${convertTo12Hour(daySchedule.end_time)}`\n      };\n    }\n  }\n\n  // Check blackout dates (future feature - would need BlackoutDate entity)\n  // const blackoutDates = await checkBlackoutDates(cleanerProfile.user_email, date);\n  // if (blackoutDates.length > 0) {\n  //   return { available: false, reason: 'This date is blocked by the cleaner' };\n  // }\n\n  return { available: true, reason: null };\n};\n\nexport const getAvailableTimeSlots = async (cleanerProfile, date) => {\n  const slots = [];\n  \n  if (!cleanerProfile || !date) return slots;\n\n  const dayOfWeek = date.getDay();\n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  const dayName = dayNames[dayOfWeek];\n\n  const availability = cleanerProfile.availability || [];\n  const daySchedule = availability.find(a => a.day === dayName);\n\n  if (!daySchedule || !daySchedule.available) {\n    return slots; // No slots available on this day\n  }\n\n  // Generate time slots from start to end time\n  const startTime = daySchedule.start_time || '08:00';\n  const endTime = daySchedule.end_time || '18:00';\n\n  const start = parseTime(startTime);\n  const end = parseTime(endTime);\n\n  // Get blocked time slots from existing bookings\n  const dateString = typeof date === 'string' ? date : date.toISOString().split('T')[0];\n  const blockedSlots = await getBlockedTimeSlots(cleanerProfile.user_email, dateString);\n\n  // Generate 30-minute intervals\n  for (let time = start; time <= end - 30; time += 30) {\n    const hours = Math.floor(time / 60);\n    const minutes = time % 60;\n    const timeString = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;\n    \n    // Check if this slot is blocked by an existing booking\n    const isBlocked = blockedSlots.includes(timeString);\n    \n    slots.push({\n      time: timeString,\n      display: convertTo12Hour(timeString),\n      available: !isBlocked\n    });\n  }\n\n  return slots;\n};\n\nexport const getUnavailableDays = (cleanerProfile) => {\n  const unavailableDays = [];\n  \n  if (!cleanerProfile || !cleanerProfile.availability) {\n    return unavailableDays;\n  }\n\n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  \n  dayNames.forEach((day, index) => {\n    const daySchedule = cleanerProfile.availability.find(a => a.day === day);\n    if (!daySchedule || !daySchedule.available) {\n      unavailableDays.push(index);\n    }\n  });\n\n  return unavailableDays;\n};\n\n// Helper: Parse time string to minutes\nconst parseTime = (timeString) => {\n  if (!timeString) return 0;\n  const [hours, minutes] = timeString.split(':').map(Number);\n  return hours * 60 + minutes;\n};\n\n// Helper: Convert 24h to 12h format\nconst convertTo12Hour = (time24) => {\n  if (!time24) return '';\n  const [hours, minutes] = time24.split(':').map(Number);\n  const period = hours >= 12 ? 'PM' : 'AM';\n  const hours12 = hours % 12 || 12;\n  return `${hours12}:${String(minutes).padStart(2, '0')} ${period}`;\n};\n\nexport default {\n  checkCleanerAvailability,\n  getAvailableTimeSlots,\n  getUnavailableDays\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\AvailabilityEditor.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\CleanerCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":7,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":29,"fix":{"range":[285,292],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[284,291],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":7,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":46,"fix":{"range":[302,309],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[301,308],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":7,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":59,"fix":{"range":[308,321],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[308,321],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Star, MapPin, Award, Sparkles, Clock, CheckCircle } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { getTierBadgeColor, getTierCardClasses, getTierLightColor, getTierSolidColor, getTierTextColor } from '../utils/tierColors';\n\nexport default function CleanerCard({ cleaner }) {\n  const isNewCleaner = cleaner.total_jobs < 5;\n  const baseRateCredits = cleaner.base_rate_credits_per_hour || cleaner.hourly_rate || 300;\n  const baseRate = baseRateCredits / 10; // Credits to dollars\n  const discountedRate = isNewCleaner ? baseRate * 0.85 : baseRate;\n  const displayScore = cleaner.reliability_score || (isNewCleaner ? 30 : 75);\n\n  const tierIcons = {\n    'Elite': 'üëë',\n    'Pro': '‚≠ê',\n    'Semi Pro': 'üí´',\n    'Developing': 'üåü'\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={{ y: -8, scale: 1.02 }}\n      transition={{ duration: 0.3 }}\n    >\n      <Card className={`h-full hover:shadow-2xl transition-all duration-300 rounded-3xl overflow-hidden ${getTierCardClasses(cleaner.tier)} shadow-xl`}>\n        {isNewCleaner && (\n          <div className=\"bg-gradient-to-r from-fresh-mint to-green-500 text-white py-2 px-4 text-center\">\n            <p className=\"text-sm font-fredoka font-bold flex items-center justify-center gap-2\">\n              <Sparkles className=\"w-4 h-4\" />\n              New Cleaner - 15% Off First Booking!\n            </p>\n          </div>\n        )}\n        \n        <CardContent className=\"p-6\">\n          {/* Header */}\n          <div className=\"flex items-start justify-between mb-4\">\n            <Badge className={`${getTierBadgeColor(cleaner.tier)} px-4 py-1.5 rounded-full font-fredoka font-bold shadow-md border`}>\n              {tierIcons[cleaner.tier] || 'üåü'} {cleaner.tier || 'Developing'}\n            </Badge>\n            {cleaner.instant_book_enabled && (\n              <Badge className=\"bg-fresh-mint text-white px-3 py-1 rounded-full font-fredoka text-xs shadow-md\">\n                Instant Book\n              </Badge>\n            )}\n          </div>\n\n          {/* Profile Section */}\n          <div className=\"flex items-start gap-4 mb-6\">\n            <div className={`w-20 h-20 rounded-3xl flex items-center justify-center text-white font-fredoka font-bold text-3xl shadow-lg flex-shrink-0`} style={{ backgroundColor: getTierSolidColor(cleaner.tier) }}>\n              {cleaner.full_name?.[0] || 'C'}\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2 line-clamp-1\">\n                {cleaner.full_name}\n              </h3>\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Star className=\"w-5 h-5 fill-amber-400 text-amber-400\" />\n                <span className=\"text-lg font-fredoka font-bold text-graphite\">\n                  {cleaner.average_rating?.toFixed(1) || '5.0'}\n                </span>\n                <span className=\"text-sm text-gray-500 font-verdana\">\n                  ({cleaner.total_reviews || 0})\n                </span>\n              </div>\n              {cleaner.service_locations?.[0] && (\n                <div className=\"flex items-center gap-1 text-sm text-gray-600 font-verdana\">\n                  <MapPin className=\"w-4 h-4 text-puretask-blue\" />\n                  <span className=\"line-clamp-1\">{cleaner.service_locations[0]}</span>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Reliability Score */}\n          <div className=\"bg-soft-cloud rounded-2xl p-4 mb-4\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <span className=\"text-sm font-fredoka font-semibold text-graphite\">Reliability Score</span>\n              <span className={`text-3xl font-fredoka font-bold ${getTierTextColor(cleaner.tier)}`}>\n                {displayScore}\n              </span>\n            </div>\n            <div className=\"h-3 bg-gray-200 rounded-full overflow-hidden\">\n              <motion.div\n                initial={{ width: 0 }}\n                animate={{ width: `${displayScore}%` }}\n                transition={{ duration: 1, delay: 0.2 }}\n                className={`h-full bg-gradient-to-r ${getScoreColor(displayScore)}`}\n              />\n            </div>\n          </div>\n\n          {/* Stats */}\n          <div className=\"grid grid-cols-2 gap-3 mb-4\">\n            <div className={`rounded-2xl p-3 text-center border-2`} style={{ backgroundColor: getTierLightColor(cleaner.tier), borderColor: getTierSolidColor(cleaner.tier) }}>\n              <p className=\"text-xs text-gray-600 mb-1 font-verdana\">Jobs Done</p>\n              <p className={`text-2xl font-fredoka font-bold ${getTierTextColor(cleaner.tier)}`}>\n                {cleaner.total_jobs || 0}\n              </p>\n            </div>\n            <div className={`rounded-2xl p-3 text-center border-2`} style={{ backgroundColor: getTierLightColor(cleaner.tier), borderColor: getTierSolidColor(cleaner.tier) }}>\n              <p className=\"text-xs text-gray-600 mb-1 font-verdana\">On-Time</p>\n              <p className={`text-2xl font-fredoka font-bold ${getTierTextColor(cleaner.tier)}`}>\n                {cleaner.on_time_rate?.toFixed(0) || (isNewCleaner ? 50 : 100)}%\n              </p>\n            </div>\n          </div>\n\n          {/* Bio */}\n          {cleaner.bio && (\n            <p className=\"text-sm text-gray-600 mb-4 line-clamp-2 font-verdana leading-relaxed\">\n              {cleaner.bio}\n            </p>\n          )}\n\n          {/* Pricing */}\n          <div className={`rounded-2xl p-4 mb-4 border-2`} style={{ backgroundColor: getTierLightColor(cleaner.tier), borderColor: getTierSolidColor(cleaner.tier) }}>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-xs text-gray-600 font-verdana mb-1\">Starting at</p>\n                <div className=\"flex items-baseline gap-2\">\n                  <span className={`text-3xl font-fredoka font-bold ${getTierTextColor(cleaner.tier)}`}>\n                    ${discountedRate.toFixed(2)}\n                  </span>\n                  <span className=\"text-sm text-gray-600 font-verdana\">/hour</span>\n                </div>\n              </div>\n              {isNewCleaner && (\n                <div className=\"text-right\">\n                  <p className=\"text-xs text-gray-500 line-through font-verdana\">\n                    ${baseRate.toFixed(2)}/hr\n                  </p>\n                  <Badge className=\"bg-fresh-mint text-white font-fredoka text-xs mt-1 shadow-md\">\n                    Save 15%\n                  </Badge>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Action Button */}\n          <Link to={createPageUrl(`CleanerProfile?cleaner=${cleaner.user_email}`)}>\n            <Button className={`w-full text-white rounded-full font-fredoka font-bold shadow-lg hover:shadow-xl text-base py-6`} style={{ backgroundColor: getTierSolidColor(cleaner.tier) }}>\n              View Profile & Book\n            </Button>\n          </Link>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\CleanerPricingSettings.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Sparkles' is defined but never used.","line":8,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":36,"fix":{"range":[414,424],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Sparkles"},"fix":{"range":[413,423],"text":""},"desc":"Remove unused variable 'Sparkles'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Slider } from '@/components/ui/slider';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { DollarSign, Info, Sparkles, TrendingUp } from 'lucide-react';\nimport {\n  TIER_BASE_RANGES,\n  ADDON_RANGES,\n  getTierKey,\n  validateBaseRate,\n  validateAddonRate,\n  getPayoutPercentage,\n  creditsToUSD\n} from '../credits/CreditCalculator';\n\nexport default function CleanerPricingSettings({ cleanerProfile, onUpdate }) {\n  const [baseRate, setBaseRate] = useState(300);\n  const [deepAddon, setDeepAddon] = useState(30);\n  const [moveoutAddon, setMoveoutAddon] = useState(30);\n  const [saving, setSaving] = useState(false);\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    if (cleanerProfile) {\n      setBaseRate(cleanerProfile.base_rate_credits_per_hour || 300);\n      setDeepAddon(cleanerProfile.deep_addon_credits_per_hour || 30);\n      setMoveoutAddon(cleanerProfile.moveout_addon_credits_per_hour || 30);\n    }\n  }, [cleanerProfile]);\n\n  const tierKey = getTierKey(cleanerProfile?.tier);\n  const baseRange = TIER_BASE_RANGES[tierKey] || TIER_BASE_RANGES['Semi Pro'];\n  const addonRange = ADDON_RANGES['deep']; // Both deep and moveout use same range\n  const payoutPercentage = getPayoutPercentage(cleanerProfile?.tier);\n\n  const handleSave = async () => {\n    setSaving(true);\n    setMessage('');\n    \n    try {\n      // Validate rates\n      const baseValidation = validateBaseRate(baseRate, cleanerProfile?.tier);\n      if (!baseValidation.valid) {\n        throw new Error(baseValidation.error);\n      }\n      \n      const deepValidation = validateAddonRate(deepAddon, 'deep');\n      if (!deepValidation.valid) {\n        throw new Error(deepValidation.error);\n      }\n      \n      const moveoutValidation = validateAddonRate(moveoutAddon, 'moveout');\n      if (!moveoutValidation.valid) {\n        throw new Error(moveoutValidation.error);\n      }\n      \n      // Update profile\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        base_rate_credits_per_hour: baseRate,\n        deep_addon_credits_per_hour: deepAddon,\n        moveout_addon_credits_per_hour: moveoutAddon,\n        payout_percentage: payoutPercentage\n      });\n      \n      setMessage('‚úÖ Pricing updated successfully!');\n      if (onUpdate) onUpdate();\n      \n      setTimeout(() => setMessage(''), 3000);\n    } catch (error) {\n      console.error('Error updating pricing:', error);\n      setMessage('‚ùå ' + error.message);\n    }\n    \n    setSaving(false);\n  };\n\n  // Calculate earnings preview\n  const basicEarnings = creditsToUSD(baseRate * 3) * payoutPercentage;\n  const deepEarnings = creditsToUSD((baseRate + deepAddon) * 3) * payoutPercentage;\n  const moveoutEarnings = creditsToUSD((baseRate + moveoutAddon) * 3) * payoutPercentage;\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <DollarSign className=\"w-6 h-6 text-emerald-600\" />\n          Your Pricing Settings\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        {message && (\n          <Alert>\n            <AlertDescription>{message}</AlertDescription>\n          </Alert>\n        )}\n\n        {/* Tier Badge */}\n        <div className=\"flex items-center justify-between p-4 bg-slate-50 rounded-lg\">\n          <div>\n            <p className=\"text-sm text-slate-600\">Your Tier</p>\n            <p className=\"text-2xl font-bold text-slate-900\">{cleanerProfile?.tier || 'Semi Pro'}</p>\n          </div>\n          <Badge className=\"bg-emerald-500 text-white\">\n            {(payoutPercentage * 100).toFixed(0)}% Payout Rate\n          </Badge>\n        </div>\n\n        {/* Info Alert */}\n        <Alert className=\"border-blue-200 bg-blue-50\">\n          <Info className=\"w-4 h-4 text-blue-600\" />\n          <AlertDescription className=\"text-blue-900 text-sm\">\n            <strong>How it works:</strong> Set your rates in credits (10 credits = $1). \n            You earn {(payoutPercentage * 100).toFixed(0)}% of what clients pay. \n            Rates are frozen when clients book, so changes only affect new bookings.\n          </AlertDescription>\n        </Alert>\n\n        {/* Base Rate */}\n        <div>\n          <div className=\"flex items-center justify-between mb-3\">\n            <label className=\"text-base font-semibold\">Base Rate (Basic Clean)</label>\n            <div className=\"text-right\">\n              <p className=\"text-2xl font-bold text-slate-900\">{baseRate}</p>\n              <p className=\"text-xs text-slate-600\">credits/hr (‚âà${creditsToUSD(baseRate)}/hr)</p>\n            </div>\n          </div>\n          <Slider\n            value={[baseRate]}\n            onValueChange={([value]) => setBaseRate(value)}\n            min={baseRange.min}\n            max={baseRange.max}\n            step={5}\n            className=\"mb-2\"\n          />\n          <div className=\"flex items-center justify-between text-xs text-slate-500\">\n            <span>{baseRange.min} credits/hr</span>\n            <span>{baseRange.max} credits/hr</span>\n          </div>\n          <p className=\"text-sm text-slate-600 mt-2\">\n            Your tier allows {baseRange.min}-{baseRange.max} credits/hr\n          </p>\n        </div>\n\n        {/* Deep Clean Add-On */}\n        <div>\n          <div className=\"flex items-center justify-between mb-3\">\n            <label className=\"text-base font-semibold\">Deep Clean Add-On</label>\n            <div className=\"text-right\">\n              <p className=\"text-2xl font-bold text-blue-600\">+{deepAddon}</p>\n              <p className=\"text-xs text-slate-600\">credits/hr (‚âà+${creditsToUSD(deepAddon)}/hr)</p>\n            </div>\n          </div>\n          <Slider\n            value={[deepAddon]}\n            onValueChange={([value]) => setDeepAddon(value)}\n            min={addonRange.min}\n            max={addonRange.max}\n            step={5}\n            className=\"mb-2\"\n          />\n          <div className=\"flex items-center justify-between text-xs text-slate-500\">\n            <span>+{addonRange.min} credits/hr</span>\n            <span>+{addonRange.max} credits/hr</span>\n          </div>\n          <p className=\"text-sm text-slate-600 mt-2\">\n            Applied when client selects \"Deep Clean\"\n          </p>\n        </div>\n\n        {/* Move-Out Add-On */}\n        <div>\n          <div className=\"flex items-center justify-between mb-3\">\n            <label className=\"text-base font-semibold\">Move-Out Add-On</label>\n            <div className=\"text-right\">\n              <p className=\"text-2xl font-bold text-purple-600\">+{moveoutAddon}</p>\n              <p className=\"text-xs text-slate-600\">credits/hr (‚âà+${creditsToUSD(moveoutAddon)}/hr)</p>\n            </div>\n          </div>\n          <Slider\n            value={[moveoutAddon]}\n            onValueChange={([value]) => setMoveoutAddon(value)}\n            min={addonRange.min}\n            max={addonRange.max}\n            step={5}\n            className=\"mb-2\"\n          />\n          <div className=\"flex items-center justify-between text-xs text-slate-500\">\n            <span>+{addonRange.min} credits/hr</span>\n            <span>+{addonRange.max} credits/hr</span>\n          </div>\n          <p className=\"text-sm text-slate-600 mt-2\">\n            Applied when client selects \"Move-Out Clean\"\n          </p>\n        </div>\n\n        {/* Earnings Preview */}\n        <div className=\"bg-gradient-to-r from-emerald-50 to-green-50 p-6 rounded-lg border border-emerald-200\">\n          <h4 className=\"font-bold text-slate-900 mb-4 flex items-center gap-2\">\n            <TrendingUp className=\"w-5 h-5 text-emerald-600\" />\n            Your Earnings Preview (3 hours)\n          </h4>\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"text-center p-3 bg-white rounded-lg\">\n              <p className=\"text-xs text-slate-600 mb-1\">Basic Clean</p>\n              <p className=\"text-2xl font-bold text-emerald-600\">${basicEarnings.toFixed(2)}</p>\n              <p className=\"text-xs text-slate-500\">{baseRate} cr/hr</p>\n            </div>\n            <div className=\"text-center p-3 bg-white rounded-lg\">\n              <p className=\"text-xs text-slate-600 mb-1\">Deep Clean</p>\n              <p className=\"text-2xl font-bold text-blue-600\">${deepEarnings.toFixed(2)}</p>\n              <p className=\"text-xs text-slate-500\">{baseRate + deepAddon} cr/hr</p>\n            </div>\n            <div className=\"text-center p-3 bg-white rounded-lg\">\n              <p className=\"text-xs text-slate-600 mb-1\">Move-Out</p>\n              <p className=\"text-2xl font-bold text-purple-600\">${moveoutEarnings.toFixed(2)}</p>\n              <p className=\"text-xs text-slate-500\">{baseRate + moveoutAddon} cr/hr</p>\n            </div>\n          </div>\n          <p className=\"text-xs text-center text-slate-600 mt-3\">\n            You keep {(payoutPercentage * 100).toFixed(0)}% ‚Ä¢ Platform fee {((1 - payoutPercentage) * 100).toFixed(0)}%\n          </p>\n        </div>\n\n        {/* Save Button */}\n        <Button\n          onClick={handleSave}\n          disabled={saving}\n          className=\"w-full bg-gradient-to-r from-emerald-500 to-green-600\"\n          size=\"lg\"\n        >\n          {saving ? 'Saving...' : 'Save Pricing'}\n        </Button>\n\n        {/* Tips */}\n        <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n          <p className=\"text-sm text-blue-900 mb-2\">\n            <strong>üí° Tips:</strong>\n          </p>\n          <ul className=\"text-sm text-blue-900 space-y-1\">\n            <li>‚Ä¢ Higher rates may reduce bookings but increase earnings per job</li>\n            <li>‚Ä¢ Add-ons only apply when clients select that cleaning type</li>\n            <li>‚Ä¢ Competitive pricing helps you get more bookings</li>\n            <li>‚Ä¢ Your tier determines your rate ranges</li>\n          </ul>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\ComprehensiveProfileEditor.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[370,417],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[370,416],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'formData' is defined but never used. Allowed unused args must match /^_/u.","line":601,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":601,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"formData"},"fix":{"range":[28537,28546],"text":""},"desc":"Remove unused variable 'formData'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setFormData' is defined but never used. Allowed unused args must match /^_/u.","line":601,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":601,"endColumn":52,"suggestions":[{"messageId":"removeVar","data":{"varName":"setFormData"},"fix":{"range":[28545,28558],"text":""},"desc":"Remove unused variable 'setFormData'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Switch } from '@/components/ui/switch';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  DollarSign, Sparkles, Calendar, MessageSquare, Camera, Video, \n  Image, CheckCircle, Clock, User, Bell, Shield, Settings, AlertTriangle\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\n\nconst PRODUCT_PREFERENCES = [\n  { value: 'standard', label: 'Standard Cleaning Products', description: 'Effective, affordable cleaning supplies' },\n  { value: 'eco-friendly', label: 'Eco-Friendly Products', description: 'Environmentally conscious, natural cleaners' },\n  { value: 'professional-grade', label: 'Professional-Grade Products', description: 'Commercial-quality cleaning supplies' },\n  { value: 'premium-eco', label: 'Premium Eco-Luxury', description: 'Top-tier eco-friendly and specialized products' }\n];\n\nconst SPECIALTY_TAGS = [\n  'Pet-Friendly', 'Eco-Warrior', 'Deep Clean Expert', 'Move-Out Specialist', \n  'Same-Day Available', 'Senior-Friendly', 'Child-Safe Products', 'Allergy-Conscious',\n  'Organization Pro', 'Post-Construction'\n];\n\nconst ADDITIONAL_SERVICES = [\n  { value: 'windows', label: 'Window Cleaning' },\n  { value: 'blinds', label: 'Blinds Cleaning' },\n  { value: 'oven', label: 'Oven Cleaning' },\n  { value: 'refrigerator', label: 'Refrigerator Cleaning' },\n  { value: 'light_fixtures', label: 'Light Fixtures' },\n  { value: 'inside_cabinets', label: 'Inside Cabinets' },\n  { value: 'baseboards', label: 'Baseboards' },\n  { value: 'laundry', label: 'Laundry Service' }\n];\n\nexport function ProfileTab({ formData, setFormData, editing, user, cleanerProfile }) {\n  return (\n    <>\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <User className=\"w-6 h-6 text-fresh-mint\" />\n            Performance Overview\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid md:grid-cols-3 gap-4\">\n            <div className=\"bg-green-50 p-4 rounded-2xl border-2 border-green-200\">\n              <p className=\"text-sm text-green-600 font-verdana mb-1\">Reliability Score</p>\n              <p className=\"text-3xl font-fredoka font-bold text-green-900\">{cleanerProfile.reliability_score || 75}</p>\n            </div>\n            <div className=\"bg-blue-50 p-4 rounded-2xl border-2 border-blue-200\">\n              <p className=\"text-sm text-puretask-blue font-verdana mb-1\">On-Time Rate</p>\n              <p className=\"text-3xl font-fredoka font-bold text-blue-900\">{cleanerProfile.on_time_rate}%</p>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-2xl border-2 border-purple-200\">\n              <p className=\"text-sm text-purple-600 font-verdana mb-1\">Photo Compliance</p>\n              <p className=\"text-3xl font-fredoka font-bold text-purple-900\">{cleanerProfile.photo_compliance_rate}%</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n          <CardTitle className=\"font-fredoka text-graphite\">Basic Information</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {editing ? (\n            <>\n              <div>\n                <Label htmlFor=\"full_name\" className=\"font-fredoka text-graphite\">Full Name</Label>\n                <Input\n                  id=\"full_name\"\n                  value={formData.full_name}\n                  onChange={(e) => setFormData({ ...formData, full_name: e.target.value })}\n                  className=\"rounded-full font-verdana\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"phone\" className=\"font-fredoka text-graphite\">Phone Number</Label>\n                <Input\n                  id=\"phone\"\n                  type=\"tel\"\n                  value={formData.phone}\n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                  className=\"rounded-full font-verdana\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"bio\" className=\"font-fredoka text-graphite\">Professional Bio</Label>\n                <Textarea\n                  id=\"bio\"\n                  value={formData.bio}\n                  onChange={(e) => setFormData({ ...formData, bio: e.target.value })}\n                  rows={4}\n                  placeholder=\"Tell clients about your experience, approach to cleaning, and what makes you unique...\"\n                  className=\"rounded-2xl font-verdana\"\n                />\n              </div>\n            </>\n          ) : (\n            <>\n              <div className=\"grid md:grid-cols-2 gap-6\">\n                <div>\n                  <Label className=\"text-gray-600 font-fredoka\">Email</Label>\n                  <p className=\"text-graphite mt-1 flex items-center gap-2 font-verdana\">\n                    {user.email}\n                  </p>\n                </div>\n                <div>\n                  <Label className=\"text-gray-600 font-fredoka\">Phone</Label>\n                  <p className=\"text-graphite mt-1 flex items-center gap-2 font-verdana\">\n                    {user.phone || 'Not set'}\n                  </p>\n                </div>\n              </div>\n              \n              {cleanerProfile.bio && (\n                <div>\n                  <Label className=\"text-gray-600 font-fredoka\">Bio</Label>\n                  <p className=\"text-graphite mt-2 leading-relaxed font-verdana\">{cleanerProfile.bio}</p>\n                </div>\n              )}\n            </>\n          )}\n        </CardContent>\n      </Card>\n    </>\n  );\n}\n\nexport function PricingTab({ formData, setFormData, editing, cleanerProfile }) {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <DollarSign className=\"w-6 h-6 text-fresh-mint\" />\n          Pricing & Rates\n        </CardTitle>\n        <CardDescription className=\"font-verdana\">Configure your base rates and add-on pricing</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {editing ? (\n          <>\n            <div>\n              <Label className=\"font-fredoka text-graphite mb-2 block\">Base Rate (Credits/Hour)</Label>\n              <Input\n                type=\"number\"\n                value={formData.base_rate_credits_per_hour}\n                onChange={(e) => setFormData({ ...formData, base_rate_credits_per_hour: e.target.value })}\n                min=\"150\"\n                max=\"850\"\n                className=\"rounded-full font-verdana\"\n              />\n              <p className=\"text-xs text-gray-500 mt-1 font-verdana\">Recommended: 150-850 credits/hr depending on tier</p>\n            </div>\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <Label className=\"font-fredoka text-graphite mb-2 block\">Deep Clean Add-On (Credits/Hour)</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.deep_addon_credits_per_hour}\n                  onChange={(e) => setFormData({ ...formData, deep_addon_credits_per_hour: e.target.value })}\n                  min=\"30\"\n                  max=\"80\"\n                  className=\"rounded-full font-verdana\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1 font-verdana\">Typical: 30-80 credits/hr</p>\n              </div>\n              <div>\n                <Label className=\"font-fredoka text-graphite mb-2 block\">Move-Out Add-On (Credits/Hour)</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.moveout_addon_credits_per_hour}\n                  onChange={(e) => setFormData({ ...formData, moveout_addon_credits_per_hour: e.target.value })}\n                  min=\"30\"\n                  max=\"80\"\n                  className=\"rounded-full font-verdana\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1 font-verdana\">Typical: 30-80 credits/hr</p>\n              </div>\n            </div>\n            <div>\n              <Label htmlFor=\"hourly_rate\" className=\"font-fredoka text-graphite\">Display Hourly Rate ($)</Label>\n              <Input\n                id=\"hourly_rate\"\n                type=\"number\"\n                value={formData.hourly_rate}\n                onChange={(e) => setFormData({ ...formData, hourly_rate: e.target.value })}\n                min=\"15\"\n                max=\"200\"\n                className=\"rounded-full font-verdana\"\n              />\n              <p className=\"text-xs text-gray-500 mt-1 font-verdana\">This is displayed to clients as reference</p>\n            </div>\n          </>\n        ) : (\n          <div className=\"grid md:grid-cols-3 gap-4\">\n            <div className=\"bg-green-50 p-4 rounded-2xl border-2 border-green-200\">\n              <p className=\"text-sm text-green-600 font-verdana mb-1\">Base Rate</p>\n              <p className=\"text-3xl font-fredoka font-bold text-green-900\">{cleanerProfile.base_rate_credits_per_hour || 150}</p>\n              <p className=\"text-xs text-gray-600 font-verdana\">credits/hour</p>\n            </div>\n            <div className=\"bg-blue-50 p-4 rounded-2xl border-2 border-blue-200\">\n              <p className=\"text-sm text-blue-600 font-verdana mb-1\">Deep Clean +</p>\n              <p className=\"text-3xl font-fredoka font-bold text-blue-900\">+{cleanerProfile.deep_addon_credits_per_hour || 50}</p>\n              <p className=\"text-xs text-gray-600 font-verdana\">credits/hour</p>\n            </div>\n            <div className=\"bg-purple-50 p-4 rounded-2xl border-2 border-purple-200\">\n              <p className=\"text-sm text-purple-600 font-verdana mb-1\">Move-Out +</p>\n              <p className=\"text-3xl font-fredoka font-bold text-purple-900\">+{cleanerProfile.moveout_addon_credits_per_hour || 50}</p>\n              <p className=\"text-xs text-gray-600 font-verdana\">credits/hour</p>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function ServicesTab({ formData, setFormData, editing, toggleSpecialty, toggleService }) {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Sparkles className=\"w-6 h-6 text-purple-600\" />\n          Services & Specialties\n        </CardTitle>\n        <CardDescription className=\"font-verdana\">Showcase your unique skills and services to attract the right clients</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Specialty Tags */}\n        <div>\n          <Label className=\"font-fredoka text-graphite mb-3 block\">Specialty Tags</Label>\n          <p className=\"text-sm text-gray-600 font-verdana mb-3\">Select all that apply to highlight your expertise</p>\n          <div className=\"flex flex-wrap gap-2\">\n            {SPECIALTY_TAGS.map(tag => (\n              <motion.button\n                key={tag}\n                type=\"button\"\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                onClick={() => editing && toggleSpecialty(tag)}\n                disabled={!editing}\n                className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${\n                  formData.specialty_tags.includes(tag)\n                    ? 'bg-purple-600 text-white shadow-lg'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                } ${!editing && 'cursor-default'}`}\n              >\n                {tag}\n              </motion.button>\n            ))}\n          </div>\n        </div>\n\n        {/* Additional Services */}\n        <div>\n          <Label className=\"font-fredoka text-graphite mb-3 block\">Additional Services Offered</Label>\n          <p className=\"text-sm text-gray-600 font-verdana mb-3\">Expand your earning potential by offering these extras</p>\n          <div className=\"grid md:grid-cols-2 gap-3\">\n            {ADDITIONAL_SERVICES.map(service => (\n              <button\n                key={service.value}\n                type=\"button\"\n                onClick={() => editing && toggleService(service.value)}\n                disabled={!editing}\n                className={`flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${\n                  formData.offers_additional_services.includes(service.value)\n                    ? 'border-fresh-mint bg-green-50'\n                    : 'border-gray-200 hover:border-gray-300'\n                } ${!editing && 'cursor-default'}`}\n              >\n                <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\n                  formData.offers_additional_services.includes(service.value)\n                    ? 'border-fresh-mint bg-fresh-mint'\n                    : 'border-gray-300'\n                }`}>\n                  {formData.offers_additional_services.includes(service.value) && (\n                    <CheckCircle className=\"w-4 h-4 text-white\" />\n                  )}\n                </div>\n                <span className=\"font-fredoka text-graphite\">{service.label}</span>\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Product Preference */}\n        <div>\n          <Label className=\"font-fredoka text-graphite mb-3 block\">Product Preference</Label>\n          <p className=\"text-sm text-gray-600 font-verdana mb-3\">Let clients know what products you use</p>\n          <div className=\"space-y-3\">\n            {PRODUCT_PREFERENCES.map(pref => (\n              <button\n                key={pref.value}\n                type=\"button\"\n                onClick={() => editing && setFormData({ ...formData, product_preference: pref.value })}\n                disabled={!editing}\n                className={`w-full text-left p-4 rounded-2xl border-2 transition-all ${\n                  formData.product_preference === pref.value\n                    ? 'border-fresh-mint bg-green-50'\n                    : 'border-gray-200 hover:border-fresh-mint'\n                } ${!editing && 'cursor-default'}`}\n              >\n                <div className=\"flex items-start gap-3\">\n                  {formData.product_preference === pref.value && (\n                    <CheckCircle className=\"w-5 h-5 text-fresh-mint mt-0.5 flex-shrink-0\" />\n                  )}\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite\">{pref.label}</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">{pref.description}</p>\n                  </div>\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function AvailabilityTab({ formData, setFormData, editing }) {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-orange-50 to-amber-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Calendar className=\"w-6 h-6 text-orange-600\" />\n          Availability Preferences\n        </CardTitle>\n        <CardDescription className=\"font-verdana\">Manage your booking preferences and availability settings</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Instant Book */}\n        <div className=\"flex items-center justify-between p-4 bg-blue-50 rounded-2xl border-2 border-blue-200\">\n          <div className=\"flex-1\">\n            <Label className=\"font-fredoka text-graphite mb-1 block\">Instant Book</Label>\n            <p className=\"text-sm text-gray-600 font-verdana\">Auto-accept bookings within your availability</p>\n          </div>\n          <Switch\n            checked={formData.instant_book_enabled}\n            onCheckedChange={(checked) => editing && setFormData({ ...formData, instant_book_enabled: checked })}\n            disabled={!editing}\n          />\n        </div>\n\n        {formData.instant_book_enabled && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n          >\n            <Label className=\"font-fredoka text-graphite mb-2 block\">Instant Book Window (Hours)</Label>\n            <Input\n              type=\"number\"\n              value={formData.instant_book_hours}\n              onChange={(e) => setFormData({ ...formData, instant_book_hours: e.target.value })}\n              min=\"24\"\n              max=\"168\"\n              disabled={!editing}\n              className=\"rounded-full font-verdana\"\n            />\n            <p className=\"text-xs text-gray-500 mt-1 font-verdana\">Auto-accept bookings scheduled within this timeframe</p>\n          </motion.div>\n        )}\n\n        {/* Subscriptions */}\n        <div className=\"flex items-center justify-between p-4 bg-purple-50 rounded-2xl border-2 border-purple-200\">\n          <div className=\"flex-1\">\n            <Label className=\"font-fredoka text-graphite mb-1 block\">Accept Recurring Bookings</Label>\n            <p className=\"text-sm text-gray-600 font-verdana\">Allow clients to book you for recurring cleanings</p>\n          </div>\n          <Switch\n            checked={formData.accepts_subscriptions}\n            onCheckedChange={(checked) => editing && setFormData({ ...formData, accepts_subscriptions: checked })}\n            disabled={!editing}\n          />\n        </div>\n\n        {/* Advanced Availability */}\n        <div className=\"p-4 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl border-2 border-indigo-200\">\n          <p className=\"font-fredoka font-semibold text-graphite mb-2\">Advanced Availability</p>\n          <p className=\"text-sm text-gray-600 font-verdana mb-3\">Set custom time slots and manage your weekly schedule in detail</p>\n          <Link to={createPageUrl('CleanerSchedule')}>\n            <Button variant=\"outline\" className=\"rounded-full font-fredoka\">\n              <Clock className=\"w-4 h-4 mr-2\" />\n              Manage Schedule\n            </Button>\n          </Link>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function CommunicationTab({ formData, setFormData, editing }) {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-cyan-50 to-blue-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <MessageSquare className=\"w-6 h-6 text-cyan-600\" />\n          Automated Communication\n        </CardTitle>\n        <CardDescription className=\"font-verdana\">Configure automatic messages to clients for a professional experience</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Booking Confirmation */}\n        <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Booking Confirmation</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Send confirmation when job is accepted</p>\n            </div>\n            <Switch\n              checked={formData.communication_settings.booking_confirmation.enabled}\n              onCheckedChange={(checked) => editing && setFormData({\n                ...formData,\n                communication_settings: {\n                  ...formData.communication_settings,\n                  booking_confirmation: { ...formData.communication_settings.booking_confirmation, enabled: checked }\n                }\n              })}\n              disabled={!editing}\n            />\n          </div>\n        </div>\n\n        {/* Pre-Cleaning Reminder */}\n        <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Pre-Cleaning Reminder</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Remind client before arrival (1 day before)</p>\n            </div>\n            <Switch\n              checked={formData.communication_settings.pre_cleaning_reminder.enabled}\n              onCheckedChange={(checked) => editing && setFormData({\n                ...formData,\n                communication_settings: {\n                  ...formData.communication_settings,\n                  pre_cleaning_reminder: { ...formData.communication_settings.pre_cleaning_reminder, enabled: checked }\n                }\n              })}\n              disabled={!editing}\n            />\n          </div>\n        </div>\n\n        {/* On My Way */}\n        <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">On My Way Notification</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Alert client when heading to location with ETA</p>\n            </div>\n            <Switch\n              checked={formData.communication_settings.on_my_way.enabled}\n              onCheckedChange={(checked) => editing && setFormData({\n                ...formData,\n                communication_settings: {\n                  ...formData.communication_settings,\n                  on_my_way: { ...formData.communication_settings.on_my_way, enabled: checked }\n                }\n              })}\n              disabled={!editing}\n            />\n          </div>\n        </div>\n\n        {/* Post-Cleaning Summary */}\n        <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Post-Cleaning Summary</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Send summary after job completion</p>\n            </div>\n            <Switch\n              checked={formData.communication_settings.post_cleaning_summary.enabled}\n              onCheckedChange={(checked) => editing && setFormData({\n                ...formData,\n                communication_settings: {\n                  ...formData.communication_settings,\n                  post_cleaning_summary: { ...formData.communication_settings.post_cleaning_summary, enabled: checked }\n                }\n              })}\n              disabled={!editing}\n            />\n          </div>\n        </div>\n\n        {/* Review Request */}\n        <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div>\n              <Label className=\"font-fredoka text-graphite\">Review Request</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Ask for feedback 24 hours after completion</p>\n            </div>\n            <Switch\n              checked={formData.communication_settings.review_request.enabled}\n              onCheckedChange={(checked) => editing && setFormData({\n                ...formData,\n                communication_settings: {\n                  ...formData.communication_settings,\n                  review_request: { ...formData.communication_settings.review_request, enabled: checked }\n                }\n              })}\n              disabled={!editing}\n            />\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function PortfolioTab({ cleanerProfile }) {\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl\">\n      <CardHeader className=\"bg-gradient-to-r from-pink-50 to-rose-50 rounded-t-2xl\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Camera className=\"w-6 h-6 text-pink-600\" />\n          Portfolio & Media\n        </CardTitle>\n        <CardDescription className=\"font-verdana\">Showcase your best work to attract more clients</CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Video Intro */}\n        <div className=\"p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl border-2 border-purple-200\">\n          <div className=\"flex items-start gap-4\">\n            <div className=\"w-12 h-12 bg-purple-600 rounded-xl flex items-center justify-center flex-shrink-0\">\n              <Video className=\"w-6 h-6 text-white\" />\n            </div>\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite text-lg mb-2 block\">Video Introduction</Label>\n              <p className=\"text-sm text-gray-600 font-verdana mb-3\">\n                {cleanerProfile.video_intro_url\n                  ? 'Your video intro is set! Clients love seeing who they\\'ll be working with.'\n                  : 'Upload a 30-60 second intro video to stand out and build trust with clients. Cleaners with videos get 3x more bookings!'}\n              </p>\n              <Button variant=\"outline\" className=\"rounded-full font-fredoka\" disabled>\n                <Video className=\"w-4 h-4 mr-2\" />\n                {cleanerProfile.video_intro_url ? 'Update Video' : 'Add Video Intro'}\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Portfolio Items */}\n        <div className=\"p-6 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl border-2 border-blue-200\">\n          <div className=\"flex items-start gap-4\">\n            <div className=\"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center flex-shrink-0\">\n              <Image className=\"w-6 h-6 text-white\" />\n            </div>\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite text-lg mb-2 block\">Work Portfolio</Label>\n              <p className=\"text-sm text-gray-600 font-verdana mb-3\">\n                {cleanerProfile.portfolio_items?.length > 0\n                  ? `You have ${cleanerProfile.portfolio_items.length} portfolio items. Keep adding your best work to showcase your skills!`\n                  : 'Upload before/after photos of your best cleaning jobs. Portfolios increase booking rates by up to 5x!'}\n              </p>\n              <Button variant=\"outline\" className=\"rounded-full font-fredoka\" disabled>\n                <Camera className=\"w-4 h-4 mr-2\" />\n                {cleanerProfile.portfolio_items?.length > 0 ? 'Manage Portfolio' : 'Add Portfolio Items'}\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Profile Photo */}\n        <div className=\"p-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl border-2 border-green-200\">\n          <div className=\"flex items-start gap-4\">\n            <div className=\"w-12 h-12 bg-green-600 rounded-xl flex items-center justify-center flex-shrink-0\">\n              <User className=\"w-6 h-6 text-white\" />\n            </div>\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite text-lg mb-2 block\">Profile Photo</Label>\n              <p className=\"text-sm text-gray-600 font-verdana mb-3\">\n                {cleanerProfile.profile_photo_url\n                  ? 'Your profile photo looks great! A professional photo builds trust and credibility.'\n                  : 'Add a friendly, professional photo to your profile. Profiles with photos get 2x more views!'}\n              </p>\n              <Button variant=\"outline\" className=\"rounded-full font-fredoka\" disabled>\n                <Camera className=\"w-4 h-4 mr-2\" />\n                {cleanerProfile.profile_photo_url ? 'Update Photo' : 'Add Profile Photo'}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function SettingsTab({ formData, setFormData, editing }) {\n  return (\n    <div className=\"space-y-6\">\n      {/* Notification Preferences */}\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-t-2xl\">\n          <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n            <Bell className=\"w-6 h-6 text-indigo-600\" />\n            Notification Preferences\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">Choose how you want to receive notifications</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Email Notifications</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Receive updates via email</p>\n            </div>\n            <Switch disabled={!editing} defaultChecked />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">SMS Notifications</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Get text messages for important updates</p>\n            </div>\n            <Switch disabled={!editing} defaultChecked />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Push Notifications</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Receive in-app notifications</p>\n            </div>\n            <Switch disabled={!editing} defaultChecked />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Marketing Emails</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Receive tips, promotions, and updates</p>\n            </div>\n            <Switch disabled={!editing} />\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Privacy Settings */}\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n          <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n            <Shield className=\"w-6 h-6 text-green-600\" />\n            Privacy & Security\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">Manage your privacy and security preferences</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Profile Visibility</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Make your profile visible to clients</p>\n            </div>\n            <Switch disabled={!editing} defaultChecked />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Show Reviews</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Display client reviews on your profile</p>\n            </div>\n            <Switch disabled={!editing} defaultChecked />\n          </div>\n\n          <div className=\"flex items-center justify-between p-4 rounded-2xl border-2 border-gray-200\">\n            <div className=\"flex-1\">\n              <Label className=\"font-fredoka text-graphite mb-1 block\">Two-Factor Authentication</Label>\n              <p className=\"text-sm text-gray-600 font-verdana\">Add an extra layer of security</p>\n            </div>\n            <Button variant=\"outline\" className=\"rounded-full font-fredoka\" size=\"sm\" disabled>\n              Enable 2FA\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Account Preferences */}\n      <Card className=\"border-0 shadow-xl rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n          <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n            <Settings className=\"w-6 h-6 text-blue-600\" />\n            Account Preferences\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">Customize your account settings</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n            <Label className=\"font-fredoka text-graphite mb-2 block\">Language</Label>\n            <select className=\"w-full p-2 border rounded-full font-verdana\" disabled={!editing}>\n              <option>English</option>\n              <option>Spanish</option>\n              <option>French</option>\n            </select>\n          </div>\n\n          <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n            <Label className=\"font-fredoka text-graphite mb-2 block\">Timezone</Label>\n            <select className=\"w-full p-2 border rounded-full font-verdana\" disabled={!editing}>\n              <option>Eastern Time (ET)</option>\n              <option>Central Time (CT)</option>\n              <option>Mountain Time (MT)</option>\n              <option>Pacific Time (PT)</option>\n            </select>\n          </div>\n\n          <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n            <Label className=\"font-fredoka text-graphite mb-2 block\">Currency</Label>\n            <select className=\"w-full p-2 border rounded-full font-verdana\" disabled={!editing}>\n              <option>USD ($)</option>\n              <option>CAD ($)</option>\n              <option>EUR (‚Ç¨)</option>\n              <option>GBP (¬£)</option>\n            </select>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Danger Zone */}\n      <Card className=\"border-0 shadow-xl rounded-2xl border-2 border-red-200\">\n        <CardHeader className=\"bg-gradient-to-r from-red-50 to-orange-50 rounded-t-2xl\">\n          <CardTitle className=\"font-fredoka text-red-600 flex items-center gap-2\">\n            <AlertTriangle className=\"w-6 h-6\" />\n            Danger Zone\n          </CardTitle>\n          <CardDescription className=\"font-verdana\">Irreversible actions - proceed with caution</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"p-4 rounded-2xl border-2 border-gray-200\">\n            <Label className=\"font-fredoka text-graphite mb-1 block\">Deactivate Account</Label>\n            <p className=\"text-sm text-gray-600 font-verdana mb-3\">Temporarily disable your account</p>\n            <Button variant=\"outline\" className=\"rounded-full font-fredoka text-orange-600 border-orange-600 hover:bg-orange-50\" disabled>\n              Deactivate\n            </Button>\n          </div>\n\n          <div className=\"p-4 rounded-2xl border-2 border-red-200 bg-red-50\">\n            <Label className=\"font-fredoka text-red-600 mb-1 block\">Delete Account</Label>\n            <p className=\"text-sm text-red-700 font-verdana mb-3\">Permanently delete your account and all data</p>\n            <Button variant=\"destructive\" className=\"rounded-full font-fredoka\" disabled>\n              Delete Account\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\CustomAvailabilityEditor.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\EarningsBreakdown.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'creditsToUSD' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":22,"fix":{"range":[399,413],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"creditsToUSD"},"fix":{"range":[400,413],"text":""},"desc":"Remove unused variable 'creditsToUSD'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"/**\n * Earnings Breakdown - Section 5\n * Displays detailed earnings information for cleaners\n */\n\nimport React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { DollarSign, TrendingUp, Calendar, Award, AlertCircle } from 'lucide-react';\nimport { creditsToUSD, formatUSD, formatCredits } from '../credits/CreditCalculator';\n\nexport default function EarningsBreakdown({ earnings, profile }) {\n  // Calculate totals\n  const pendingEarnings = earnings.filter(e => e.status === 'pending');\n  const paidEarnings = earnings.filter(e => e.status === 'paid');\n  \n  const pendingCredits = pendingEarnings.reduce((sum, e) => sum + (e.credits_earned || 0), 0);\n  const pendingUSD = pendingEarnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n  \n  const lifetimeCredits = earnings.reduce((sum, e) => sum + (e.credits_earned || 0), 0);\n  const lifetimeUSD = earnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n  \n  const paidUSD = paidEarnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n  \n  const payoutRate = profile?.payout_percentage || 0.80;\n  const tier = profile?.tier || 'Semi Pro';\n  \n  return (\n    <div className=\"space-y-6\">\n      {/* Earnings Summary Cards */}\n      <div className=\"grid md:grid-cols-3 gap-6\">\n        <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-500 to-orange-600 text-white\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <DollarSign className=\"w-8 h-8 opacity-80\" />\n              <Badge className=\"bg-white/20 text-white\">Pending</Badge>\n            </div>\n            <p className=\"text-4xl font-bold mb-1\">{formatUSD(pendingUSD)}</p>\n            <p className=\"text-sm opacity-90\">Awaiting Payout</p>\n            <p className=\"text-xs opacity-75 mt-2\">\n              {formatCredits(pendingCredits)} credits ‚Ä¢ {pendingEarnings.length} jobs\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-lg bg-gradient-to-br from-emerald-500 to-green-600 text-white\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <TrendingUp className=\"w-8 h-8 opacity-80\" />\n              <Badge className=\"bg-white/20 text-white\">Lifetime</Badge>\n            </div>\n            <p className=\"text-4xl font-bold mb-1\">{formatUSD(lifetimeUSD)}</p>\n            <p className=\"text-sm opacity-90\">Total Earned</p>\n            <p className=\"text-xs opacity-75 mt-2\">\n              {formatCredits(lifetimeCredits)} credits ‚Ä¢ {earnings.length} jobs\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-500 to-cyan-600 text-white\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <Calendar className=\"w-8 h-8 opacity-80\" />\n              <Badge className=\"bg-white/20 text-white\">Paid Out</Badge>\n            </div>\n            <p className=\"text-4xl font-bold mb-1\">{formatUSD(paidUSD)}</p>\n            <p className=\"text-sm opacity-90\">Already Received</p>\n            <p className=\"text-xs opacity-75 mt-2\">\n              {paidEarnings.length} payout{paidEarnings.length !== 1 ? 's' : ''}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Payout Info */}\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <Award className=\"w-6 h-6 text-purple-600\" />\n            Your Payout Rate\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <div>\n              <div className=\"flex items-center justify-between mb-3\">\n                <span className=\"text-slate-600\">Current Tier</span>\n                <Badge className=\"bg-purple-100 text-purple-700 text-lg px-4 py-1\">\n                  {tier}\n                </Badge>\n              </div>\n              \n              <div className=\"flex items-center justify-between mb-3\">\n                <span className=\"text-slate-600\">Payout Rate</span>\n                <span className=\"text-3xl font-bold text-purple-600\">\n                  {(payoutRate * 100).toFixed(0)}%\n                </span>\n              </div>\n              \n              <p className=\"text-sm text-slate-600 mb-4\">\n                You earn {(payoutRate * 100).toFixed(0)}% of credits charged. \n                Platform keeps {((1 - payoutRate) * 100).toFixed(0)}% for operations.\n              </p>\n              \n              {payoutRate < 0.85 && (\n                <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\n                  <p className=\"text-sm text-blue-900\">\n                    <strong>üí° Tip:</strong> Reach Elite tier to earn 85% payouts!\n                  </p>\n                </div>\n              )}\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <div className=\"flex justify-between text-sm mb-2\">\n                  <span className=\"text-slate-600\">Example: 300 credits</span>\n                  <span className=\"font-medium\">= $30.00</span>\n                </div>\n                <Progress value={100} className=\"h-2 bg-slate-200\" />\n                <div className=\"flex justify-between text-xs mt-1\">\n                  <span className=\"text-emerald-600\">You: ${(30 * payoutRate).toFixed(2)}</span>\n                  <span className=\"text-slate-500\">Platform: ${(30 * (1 - payoutRate)).toFixed(2)}</span>\n                </div>\n              </div>\n\n              <div>\n                <div className=\"flex justify-between text-sm mb-2\">\n                  <span className=\"text-slate-600\">Example: 500 credits</span>\n                  <span className=\"font-medium\">= $50.00</span>\n                </div>\n                <Progress value={100} className=\"h-2 bg-slate-200\" />\n                <div className=\"flex justify-between text-xs mt-1\">\n                  <span className=\"text-emerald-600\">You: ${(50 * payoutRate).toFixed(2)}</span>\n                  <span className=\"text-slate-500\">Platform: ${(50 * (1 - payoutRate)).toFixed(2)}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Payment Schedule */}\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"w-6 h-6 text-blue-600\" />\n            Payment Schedule\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start gap-3 p-4 bg-blue-50 rounded-lg\">\n              <div className=\"w-2 h-2 rounded-full bg-blue-500 mt-2\"></div>\n              <div className=\"flex-1\">\n                <p className=\"font-semibold text-slate-900\">Weekly Payouts</p>\n                <p className=\"text-sm text-slate-600\">\n                  Processed every Monday for jobs completed the previous week\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-start gap-3 p-4 bg-slate-50 rounded-lg\">\n              <div className=\"w-2 h-2 rounded-full bg-slate-400 mt-2\"></div>\n              <div className=\"flex-1\">\n                <p className=\"font-semibold text-slate-900\">Instant Payout (Coming Soon)</p>\n                <p className=\"text-sm text-slate-600\">\n                  Get paid instantly for a 5% fee (available to Elite tier)\n                </p>\n              </div>\n            </div>\n\n            {pendingEarnings.length > 0 && (\n              <div className=\"mt-4 p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                <div className=\"flex items-start gap-3\">\n                  <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5\" />\n                  <div>\n                    <p className=\"font-semibold text-amber-900\">\n                      Next Payout: {formatUSD(pendingUSD)}\n                    </p>\n                    <p className=\"text-sm text-amber-800\">\n                      {pendingEarnings.length} completed job{pendingEarnings.length !== 1 ? 's' : ''} pending payout\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\EarningsCalculator.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15,"fix":{"range":[273,320],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[273,319],"text":""},"desc":"Remove unused variable 'Input'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":8,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":39,"fix":{"range":[447,454],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[447,454],"text":""},"desc":"Remove unused variable 'Award'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Slider } from '@/components/ui/slider';\nimport { Badge } from '@/components/ui/badge';\nimport { DollarSign, TrendingUp, Award } from 'lucide-react';\n\nexport default function EarningsCalculator() {\n  const [city, setCity] = useState('boston');\n  const [tier, setTier] = useState('Semi Pro');\n  const [hoursPerWeek, setHoursPerWeek] = useState(20);\n\n  const cityRates = {\n    boston: { Developing: 25, 'Semi Pro': 35, Pro: 45, Elite: 60 },\n    newyork: { Developing: 30, 'Semi Pro': 40, Pro: 55, Elite: 75 },\n    chicago: { Developing: 22, 'Semi Pro': 32, Pro: 42, Elite: 55 },\n    sanfrancisco: { Developing: 35, 'Semi Pro': 50, Pro: 65, Elite: 85 }\n  };\n\n  const hourlyRate = cityRates[city][tier];\n  const weeklyEarnings = hourlyRate * hoursPerWeek * 0.85; // 85% after platform fee\n  const monthlyEarnings = weeklyEarnings * 4.33;\n  const yearlyEarnings = monthlyEarnings * 12;\n\n  return (\n    <Card className=\"border-0 shadow-xl bg-gradient-to-br from-emerald-50 to-green-50\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-2xl\">\n          <DollarSign className=\"w-7 h-7 text-emerald-600\" />\n          Earnings Calculator\n        </CardTitle>\n        <p className=\"text-slate-600 mt-2\">See your earning potential as a PureTask cleaner</p>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        <div>\n          <Label>Your City</Label>\n          <Select value={city} onValueChange={setCity}>\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"boston\">Boston</SelectItem>\n              <SelectItem value=\"newyork\">New York</SelectItem>\n              <SelectItem value=\"chicago\">Chicago</SelectItem>\n              <SelectItem value=\"sanfrancisco\">San Francisco</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div>\n          <Label>Target Tier</Label>\n          <Select value={tier} onValueChange={setTier}>\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"Developing\">Developing</SelectItem>\n              <SelectItem value=\"Semi Pro\">Semi Pro</SelectItem>\n              <SelectItem value=\"Pro\">Pro</SelectItem>\n              <SelectItem value=\"Elite\">Elite</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div>\n          <div className=\"flex justify-between mb-2\">\n            <Label>Hours Per Week</Label>\n            <Badge variant=\"outline\">{hoursPerWeek} hours</Badge>\n          </div>\n          <Slider\n            value={[hoursPerWeek]}\n            onValueChange={([value]) => setHoursPerWeek(value)}\n            min={5}\n            max={40}\n            step={5}\n          />\n        </div>\n\n        <div className=\"border-t pt-6 space-y-4\">\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-slate-600\">Hourly Rate:</span>\n            <span className=\"text-2xl font-bold text-emerald-600\">${hourlyRate}/hr</span>\n          </div>\n\n          <div className=\"bg-white rounded-lg p-4 space-y-3\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-slate-600\">Weekly:</span>\n              <span className=\"font-bold text-lg\">${weeklyEarnings.toFixed(0)}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"text-slate-600\">Monthly:</span>\n              <span className=\"font-bold text-lg\">${monthlyEarnings.toFixed(0)}</span>\n            </div>\n            <div className=\"flex justify-between items-center border-t pt-3\">\n              <span className=\"text-slate-900 font-semibold\">Yearly:</span>\n              <span className=\"font-bold text-2xl text-emerald-600\">${yearlyEarnings.toFixed(0)}</span>\n            </div>\n          </div>\n\n          <p className=\"text-xs text-slate-500 text-center\">\n            * Earnings shown after 15% platform fee. Actual earnings may vary.\n          </p>\n        </div>\n\n        <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-200\">\n          <div className=\"flex items-start gap-3\">\n            <TrendingUp className=\"w-5 h-5 text-blue-600 mt-0.5\" />\n            <div className=\"text-sm text-blue-900\">\n              <p className=\"font-semibold mb-1\">Tier Up to Earn More!</p>\n              <p>Elite cleaners in {city === 'boston' ? 'Boston' : city === 'newyork' ? 'New York' : city === 'chicago' ? 'Chicago' : 'San Francisco'} earn ${cityRates[city].Elite}/hr - \n              that's ${((cityRates[city].Elite * hoursPerWeek * 0.85 * 12 * 4.33) / 1000).toFixed(0)}k/year!</p>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\EnhancedCleanerCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15,"fix":{"range":[167,214],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[167,213],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":7,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":22,"fix":{"range":[277,285],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[276,284],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":7,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":29,"fix":{"range":[285,292],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[284,291],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Sparkles' is defined but never used.","line":7,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":39,"fix":{"range":[292,302],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Sparkles"},"fix":{"range":[291,301],"text":""},"desc":"Remove unused variable 'Sparkles'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":7,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":46,"fix":{"range":[302,309],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[301,308],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":7,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":59,"fix":{"range":[309,322],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[308,321],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":7,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":65,"fix":{"range":[322,328],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[321,327],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Droplet' is defined but never used.","line":7,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":74,"fix":{"range":[328,337],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Droplet"},"fix":{"range":[327,336],"text":""},"desc":"Remove unused variable 'Droplet'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Truck' is defined but never used.","line":7,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":81,"fix":{"range":[337,344],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Truck"},"fix":{"range":[336,343],"text":""},"desc":"Remove unused variable 'Truck'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Key' is defined but never used.","line":7,"column":83,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":86,"fix":{"range":[343,348],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Key"},"fix":{"range":[343,348],"text":""},"desc":"Remove unused variable 'Key'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'getTierBadgeColor' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":27,"fix":{"range":[420,439],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"getTierBadgeColor"},"fix":{"range":[421,439],"text":""},"desc":"Remove unused variable 'getTierBadgeColor'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'getTierCardClasses' is defined but never used.","line":9,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":47,"fix":{"range":[439,459],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"getTierCardClasses"},"fix":{"range":[438,458],"text":""},"desc":"Remove unused variable 'getTierCardClasses'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'getTierLightColor' is defined but never used.","line":9,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":66,"fix":{"range":[459,478],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"getTierLightColor"},"fix":{"range":[458,477],"text":""},"desc":"Remove unused variable 'getTierLightColor'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'getTierSolidColor' is defined but never used.","line":9,"column":68,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":85,"fix":{"range":[477,496],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"getTierSolidColor"},"fix":{"range":[477,496],"text":""},"desc":"Remove unused variable 'getTierSolidColor'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onPin' is defined but never used. Allowed unused args must match /^_/u.","line":11,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":61,"suggestions":[{"messageId":"removeVar","data":{"varName":"onPin"},"fix":{"range":[581,588],"text":""},"desc":"Remove unused variable 'onPin'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isPinned' is defined but never used. Allowed unused args must match /^_/u.","line":11,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":71,"suggestions":[{"messageId":"removeVar","data":{"varName":"isPinned"},"fix":{"range":[588,598],"text":""},"desc":"Remove unused variable 'isPinned'."}]}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":14,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Star, MapPin, Award, Sparkles, Clock, CheckCircle, Home, Droplet, Truck, Key } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { getTierBadgeColor, getTierCardClasses, getTierLightColor, getTierSolidColor } from '../utils/tierColors';\n\nexport default function EnhancedCleanerCard({ cleaner, onPin, isPinned }) {\n  const baseRateCredits = cleaner.base_rate_credits_per_hour || cleaner.hourly_rate || 25;\n  const baseRate = baseRateCredits; // 1 credit = $1 USD\n  const displayScore = cleaner.reliability_score || 75;\n\n  const tierGradientClass = {\n    'Elite': 'bg-gradient-to-r from-purple-600 to-purple-700',\n    'Pro': 'bg-gradient-to-r from-blue-600 to-blue-700',\n    'Semi Pro': 'bg-gradient-to-r from-emerald-600 to-emerald-700',\n    'Developing': 'bg-gradient-to-r from-slate-600 to-slate-700'\n  }[cleaner.tier] || 'bg-gradient-to-r from-slate-600 to-slate-700';\n\n  const tierLightBgClass = {\n    'Elite': 'bg-purple-50',\n    'Pro': 'bg-blue-50',\n    'Semi Pro': 'bg-emerald-50',\n    'Developing': 'bg-slate-50'\n  }[cleaner.tier] || 'bg-slate-50';\n\n  const tierBorderClass = {\n    'Elite': 'border-purple-300',\n    'Pro': 'border-blue-300',\n    'Semi Pro': 'border-emerald-300',\n    'Developing': 'border-slate-300'\n  }[cleaner.tier] || 'border-slate-300';\n\n  const tierTextClass = {\n    'Elite': 'text-purple-700',\n    'Pro': 'text-blue-700',\n    'Semi Pro': 'text-emerald-700',\n    'Developing': 'text-slate-700'\n  }[cleaner.tier] || 'text-slate-700';\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={{ y: -2 }}\n      transition={{ duration: 0.15 }}\n    >\n      <Card className={`h-full hover:shadow-lg transition-all duration-200 rounded-xl overflow-hidden bg-white border ${tierBorderClass}`}>\n        <CardContent className=\"p-4\">\n          {/* Tier Badge */}\n          <div className=\"flex justify-center mb-3\">\n            <div className={`px-3 py-1 rounded-full ${tierGradientClass} text-white text-xs font-fredoka font-bold shadow-sm`}>\n              {cleaner.tier || 'Developing'}\n            </div>\n          </div>\n\n          {/* Name & Initial */}\n          <div className=\"text-center mb-3\">\n            <div className={`w-14 h-14 mx-auto rounded-full ${tierGradientClass} flex items-center justify-center text-white font-fredoka font-bold text-xl shadow-sm mb-2`}>\n              {cleaner.full_name?.[0] || 'C'}\n            </div>\n            <h3 className=\"font-fredoka font-bold text-sm text-slate-900 line-clamp-1\">\n              {cleaner.full_name || 'Cleaner'}\n            </h3>\n          </div>\n\n          {/* Stats Row */}\n          <div className=\"grid grid-cols-2 gap-2 mb-3\">\n            <div className={`${tierLightBgClass} rounded-lg p-2 text-center`}>\n              <div className=\"flex items-center justify-center gap-1 mb-1\">\n                <Star className=\"w-3 h-3 fill-amber-400 text-amber-400\" />\n                <span className=\"text-sm font-fredoka font-bold text-slate-900\">\n                  {cleaner.average_rating?.toFixed(1) || '5.0'}\n                </span>\n              </div>\n              <p className=\"text-xs text-slate-600 font-verdana\">{cleaner.total_reviews || 0} reviews</p>\n            </div>\n            <div className={`${tierLightBgClass} rounded-lg p-2 text-center`}>\n              <p className=\"text-sm font-fredoka font-bold text-slate-900 mb-1\">{displayScore}</p>\n              <p className=\"text-xs text-slate-600 font-verdana\">Score</p>\n            </div>\n          </div>\n\n          {/* Price */}\n          <div className=\"text-center mb-3\">\n            <p className=\"text-xs text-slate-600 font-verdana mb-0.5\">Starting at</p>\n            <p className={`text-xl font-fredoka font-bold ${tierTextClass}`}>\n              ${baseRate.toFixed(0)}\n              <span className=\"text-sm text-slate-600 font-normal\">/hr</span>\n            </p>\n          </div>\n\n          {/* View Profile Button */}\n          <Link to={createPageUrl(`CleanerProfile?email=${cleaner.user_email}`)}>\n            <Button className={`w-full ${tierGradientClass} text-white rounded-lg font-verdana font-semibold text-xs py-2 hover:opacity-90 shadow-sm`}>\n              View Profile\n            </Button>\n          </Link>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\InstantBookSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\MilestoneRewards.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":7,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":38,"fix":{"range":[360,365],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[359,364],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":96,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[2743,2750],"text":""},"desc":"Remove unused variable 'loading'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Award, TrendingUp, Star, Zap, Trophy, Gift, Check, Briefcase, DollarSign, Shield, Sparkles } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\n\nconst MILESTONE_DEFINITIONS = [\n  {\n    type: 'first_10_jobs',\n    title: '10 Jobs Completed',\n    description: 'Complete your first 10 jobs',\n    icon: Briefcase,\n    target: 10,\n    reward: 'Free instant payout (no 5% fee)',\n    rewardType: 'free_instant_payout',\n    rewardValue: 1\n  },\n  {\n    type: 'first_50_jobs',\n    title: '50 Jobs Milestone',\n    description: 'Complete 50 jobs',\n    icon: Trophy,\n    target: 50,\n    reward: '+2% bonus payout for 1 week',\n    rewardType: 'bonus_percentage',\n    rewardValue: 2\n  },\n  {\n    type: 'first_100_jobs',\n    title: '100 Jobs Milestone',\n    description: 'Complete 100 jobs',\n    icon: Award,\n    target: 100,\n    reward: '+3% bonus payout for 2 weeks',\n    rewardType: 'bonus_percentage',\n    rewardValue: 3\n  },\n  {\n    type: 'perfect_month',\n    title: 'Perfect Month',\n    description: 'Complete a month with 100% attendance and 5-star reviews',\n    icon: Star,\n    target: 1,\n    reward: 'Free instant payout + Featured profile for 1 week',\n    rewardType: 'free_instant_payout',\n    rewardValue: 1\n  },\n  {\n    type: 'earnings_1000',\n    title: '$1,000 Earned',\n    description: 'Earn your first $1,000',\n    icon: DollarSign,\n    target: 1000,\n    reward: 'Free instant payout',\n    rewardType: 'free_instant_payout',\n    rewardValue: 1\n  },\n  {\n    type: 'earnings_5000',\n    title: '$5,000 Earned',\n    description: 'Earn $5,000 total',\n    icon: TrendingUp,\n    target: 5000,\n    reward: '+2% bonus for 2 weeks',\n    rewardType: 'bonus_percentage',\n    rewardValue: 2\n  },\n  {\n    type: 'zero_cancellations_3months',\n    title: 'Reliability Champion',\n    description: 'Zero cancellations for 3 months',\n    icon: Shield,\n    target: 90,\n    reward: 'Priority listing + Free instant payout',\n    rewardType: 'priority_listing',\n    rewardValue: 14\n  },\n  {\n    type: 'reliability_elite',\n    title: 'Elite Status Achieved',\n    description: 'Reach Elite tier (90+ reliability score)',\n    icon: Sparkles,\n    target: 90,\n    reward: 'Permanent 85% payout rate',\n    rewardType: 'bonus_percentage',\n    rewardValue: 5\n  }\n];\n\nexport default function MilestoneRewards({ cleanerEmail, profile }) {\n  const [milestones, setMilestones] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [claiming, setClaiming] = useState(null);\n\n  useEffect(() => {\n    loadMilestones();\n  }, [cleanerEmail]);\n\n  const loadMilestones = async () => {\n    try {\n      const achieved = await base44.entities.CleanerMilestone.filter({ cleaner_email: cleanerEmail });\n      setMilestones(achieved);\n    } catch (error) {\n      console.error('Error loading milestones:', error);\n    }\n    setLoading(false);\n  };\n\n  const checkAndAwardMilestones = async () => {\n    try {\n      const totalJobs = profile.total_jobs || 0;\n      const reliabilityScore = profile.reliability_score || 0;\n      \n      // Calculate total earnings\n      const earnings = await base44.entities.CleanerEarning.filter({ cleaner_email: cleanerEmail });\n      const totalEarned = earnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n\n      // Check each milestone\n      for (const milestone of MILESTONE_DEFINITIONS) {\n        const alreadyAchieved = milestones.some(m => m.milestone_type === milestone.type);\n        if (alreadyAchieved) continue;\n\n        let achieved = false;\n\n        // Check job-based milestones\n        if (milestone.type.includes('jobs') && totalJobs >= milestone.target) {\n          achieved = true;\n        }\n\n        // Check earnings milestones\n        if (milestone.type.includes('earnings') && totalEarned >= milestone.target) {\n          achieved = true;\n        }\n\n        // Check reliability milestones\n        if (milestone.type === 'reliability_elite' && reliabilityScore >= 90) {\n          achieved = true;\n        }\n\n        // Check cancellation milestone\n        if (milestone.type === 'zero_cancellations_3months') {\n          const threeMonthsAgo = new Date();\n          threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);\n          \n          const recentBookings = await base44.entities.Booking.filter({\n            cleaner_email: cleanerEmail,\n            created_date: { $gte: threeMonthsAgo.toISOString() },\n            cancelled_by: cleanerEmail\n          });\n          \n          achieved = recentBookings.length === 0;\n        }\n\n        // Check perfect month\n        if (milestone.type === 'perfect_month') {\n          const oneMonthAgo = new Date();\n          oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);\n          \n          const monthBookings = await base44.entities.Booking.filter({\n            cleaner_email: cleanerEmail,\n            created_date: { $gte: oneMonthAgo.toISOString() },\n            status: { $in: ['completed', 'approved'] }\n          });\n\n          const monthReviews = await base44.entities.Review.filter({\n            cleaner_email: cleanerEmail,\n            created_date: { $gte: oneMonthAgo.toISOString() }\n          });\n\n          const allFiveStars = monthReviews.every(r => r.rating === 5);\n          achieved = monthBookings.length >= 10 && allFiveStars && profile.attendance_rate === 100;\n        }\n\n        if (achieved) {\n          await awardMilestone(milestone);\n        }\n      }\n\n      await loadMilestones();\n    } catch (error) {\n      console.error('Error checking milestones:', error);\n    }\n  };\n\n  const awardMilestone = async (milestone) => {\n    try {\n      const expiresDate = new Date();\n      expiresDate.setDate(expiresDate.getDate() + (milestone.rewardValue || 7));\n\n      await base44.entities.CleanerMilestone.create({\n        cleaner_email: cleanerEmail,\n        milestone_type: milestone.type,\n        reward_type: milestone.rewardType,\n        reward_value: milestone.rewardValue,\n        reward_description: milestone.reward,\n        achieved_date: new Date().toISOString(),\n        expires_date: expiresDate.toISOString(),\n        is_active: true,\n        used: false\n      });\n\n      // Send celebration email\n      await base44.integrations.Core.SendEmail({\n        to: cleanerEmail,\n        subject: `üéâ Milestone Achieved: ${milestone.title}!`,\n        body: `Congratulations! You have achieved the \"${milestone.title}\" milestone!\\n\\nYour reward: ${milestone.reward}\\n\\nKeep up the great work!`\n      });\n\n      toast.success(`üéâ Milestone achieved: ${milestone.title}!`);\n    } catch (error) {\n      console.error('Error awarding milestone:', error);\n    }\n  };\n\n  const claimReward = async (milestoneId) => {\n    setClaiming(milestoneId);\n    try {\n      await base44.entities.CleanerMilestone.update(milestoneId, {\n        used: true,\n        used_date: new Date().toISOString()\n      });\n\n      toast.success('Reward claimed successfully!');\n      await loadMilestones();\n    } catch (error) {\n      console.error('Error claiming reward:', error);\n      toast.error('Failed to claim reward');\n    }\n    setClaiming(null);\n  };\n\n  const getMilestoneProgress = (milestone) => {\n    const totalJobs = profile.total_jobs || 0;\n    const reliabilityScore = profile.reliability_score || 0;\n\n    if (milestone.type.includes('jobs')) {\n      return Math.min(100, (totalJobs / milestone.target) * 100);\n    }\n    if (milestone.type === 'reliability_elite') {\n      return Math.min(100, (reliabilityScore / 90) * 100);\n    }\n    return 0;\n  };\n\n  useEffect(() => {\n    checkAndAwardMilestones();\n  }, [profile]);\n\n  const activeMilestones = milestones.filter(m => m.is_active && !m.used);\n  const usedMilestones = milestones.filter(m => m.used);\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"border-0 shadow-xl bg-gradient-to-br from-amber-50 to-orange-50\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Trophy className=\"w-6 h-6 text-amber-600\" />\n            Milestone Rewards\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-slate-600 mb-4\">\n            Earn rewards by hitting major milestones! Free payouts, bonus earnings, and more.\n          </p>\n\n          {/* Active Rewards */}\n          {activeMilestones.length > 0 && (\n            <div className=\"mb-6\">\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-3 flex items-center gap-2\">\n                <Gift className=\"w-5 h-5 text-emerald-500\" />\n                Active Rewards\n              </h3>\n              <div className=\"grid gap-3\">\n                {activeMilestones.map((milestone) => {\n                  const definition = MILESTONE_DEFINITIONS.find(d => d.type === milestone.milestone_type);\n                  const Icon = definition?.icon || Award;\n                  \n                  return (\n                    <motion.div\n                      key={milestone.id}\n                      initial={{ scale: 0.9, opacity: 0 }}\n                      animate={{ scale: 1, opacity: 1 }}\n                      className=\"p-4 bg-white rounded-xl border-2 border-amber-300 shadow-md\"\n                    >\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex items-start gap-3\">\n                          <div className=\"w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl flex items-center justify-center\">\n                            <Icon className=\"w-6 h-6 text-white\" />\n                          </div>\n                          <div>\n                            <p className=\"font-bold text-slate-900\">{definition?.title}</p>\n                            <p className=\"text-sm text-slate-600 mb-2\">{milestone.reward_description}</p>\n                            <Badge className=\"bg-amber-100 text-amber-800\">\n                              Expires: {new Date(milestone.expires_date).toLocaleDateString()}\n                            </Badge>\n                          </div>\n                        </div>\n                        <Button\n                          onClick={() => claimReward(milestone.id)}\n                          disabled={claiming === milestone.id}\n                          className=\"bg-gradient-to-r from-emerald-500 to-green-600\"\n                        >\n                          {claiming === milestone.id ? 'Claiming...' : 'Claim Reward'}\n                        </Button>\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Progress Towards Milestones */}\n          <div>\n            <h3 className=\"text-lg font-semibold text-slate-900 mb-3 flex items-center gap-2\">\n              <TrendingUp className=\"w-5 h-5 text-blue-500\" />\n              Your Progress\n            </h3>\n            <div className=\"grid gap-4\">\n              {MILESTONE_DEFINITIONS.map((milestone) => {\n                const achieved = milestones.some(m => m.milestone_type === milestone.type);\n                const progress = getMilestoneProgress(milestone);\n                const Icon = milestone.icon;\n\n                return (\n                  <div\n                    key={milestone.type}\n                    className={`p-4 rounded-xl border-2 ${\n                      achieved\n                        ? 'bg-green-50 border-green-300'\n                        : progress > 0\n                        ? 'bg-blue-50 border-blue-200'\n                        : 'bg-slate-50 border-slate-200'\n                    }`}\n                  >\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"flex items-start gap-3 flex-1\">\n                        <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${\n                          achieved\n                            ? 'bg-green-500'\n                            : progress > 0\n                            ? 'bg-blue-500'\n                            : 'bg-slate-400'\n                        }`}>\n                          {achieved ? (\n                            <Check className=\"w-6 h-6 text-white\" />\n                          ) : (\n                            <Icon className=\"w-6 h-6 text-white\" />\n                          )}\n                        </div>\n                        <div className=\"flex-1\">\n                          <p className=\"font-bold text-slate-900\">{milestone.title}</p>\n                          <p className=\"text-sm text-slate-600 mb-2\">{milestone.description}</p>\n                          {!achieved && progress > 0 && (\n                            <Progress value={progress} className=\"h-2\" />\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <Badge className={achieved ? 'bg-green-500 text-white' : 'bg-slate-200 text-slate-600'}>\n                          {achieved ? 'Achieved' : `${Math.round(progress)}%`}\n                        </Badge>\n                        <p className=\"text-xs text-slate-500 mt-1\">{milestone.reward}</p>\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Used Rewards History */}\n          {usedMilestones.length > 0 && (\n            <div className=\"mt-6\">\n              <h3 className=\"text-lg font-semibold text-slate-900 mb-3\">Claimed Rewards</h3>\n              <div className=\"space-y-2\">\n                {usedMilestones.map((milestone) => (\n                  <div key={milestone.id} className=\"p-3 bg-slate-100 rounded-lg flex items-center justify-between\">\n                    <div>\n                      <p className=\"font-medium text-slate-700\">{milestone.reward_description}</p>\n                      <p className=\"text-xs text-slate-500\">\n                        Claimed: {new Date(milestone.used_date).toLocaleDateString()}\n                      </p>\n                    </div>\n                    <Check className=\"w-5 h-5 text-green-600\" />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\PortfolioManager.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Sparkles' is defined but never used.","line":11,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":38,"fix":{"range":[490,500],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Sparkles"},"fix":{"range":[490,500],"text":""},"desc":"Remove unused variable 'Sparkles'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'categoryConfig' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":125,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"categoryConfig"},"fix":{"range":[3932,4006],"text":""},"desc":"Remove unused variable 'categoryConfig'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Camera, Plus, X, Upload, Loader2, Star, \n  ChevronLeft, ChevronRight, Sparkles \n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst CATEGORIES = [\n  { value: 'kitchen', label: 'Kitchen', icon: 'üç≥' },\n  { value: 'bathroom', label: 'Bathroom', icon: 'üöø' },\n  { value: 'bedroom', label: 'Bedroom', icon: 'üõèÔ∏è' },\n  { value: 'living_room', label: 'Living Room', icon: 'üõãÔ∏è' },\n  { value: 'office', label: 'Office', icon: 'üíº' },\n  { value: 'outdoor', label: 'Outdoor', icon: 'üå≥' },\n  { value: 'deep_clean', label: 'Deep Clean', icon: '‚ú®' },\n  { value: 'move_out', label: 'Move-Out', icon: 'üì¶' },\n  { value: 'post_construction', label: 'Post-Construction', icon: 'üèóÔ∏è' },\n  { value: 'other', label: 'Other', icon: 'üì∏' }\n];\n\nexport default function PortfolioManager({ portfolioItems = [], onPortfolioUpdated }) {\n  const [items, setItems] = useState(portfolioItems);\n  const [showAddForm, setShowAddForm] = useState(false);\n  const [uploadingBefore, setUploadingBefore] = useState(false);\n  const [uploadingAfter, setUploadingAfter] = useState(false);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  \n  const [newItem, setNewItem] = useState({\n    title: '',\n    description: '',\n    before_photo_url: '',\n    after_photo_url: '',\n    category: 'kitchen',\n    date: new Date().toISOString().split('T')[0],\n    featured: false\n  });\n\n  const handlePhotoUpload = async (e, type) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    if (!file.type.startsWith('image/')) {\n      alert('Please upload an image file');\n      return;\n    }\n\n    if (type === 'before') setUploadingBefore(true);\n    else setUploadingAfter(true);\n\n    try {\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      setNewItem({\n        ...newItem,\n        [type === 'before' ? 'before_photo_url' : 'after_photo_url']: file_url\n      });\n    } catch (error) {\n      console.error('Upload error:', error);\n      alert('Failed to upload photo');\n    } finally {\n      if (type === 'before') setUploadingBefore(false);\n      else setUploadingAfter(false);\n    }\n  };\n\n  const addItem = () => {\n    if (!newItem.title || !newItem.before_photo_url || !newItem.after_photo_url) {\n      alert('Please fill in title and upload both photos');\n      return;\n    }\n\n    const updatedItems = [...items, newItem];\n    setItems(updatedItems);\n    if (onPortfolioUpdated) {\n      onPortfolioUpdated(updatedItems);\n    }\n\n    setNewItem({\n      title: '',\n      description: '',\n      before_photo_url: '',\n      after_photo_url: '',\n      category: 'kitchen',\n      date: new Date().toISOString().split('T')[0],\n      featured: false\n    });\n    setShowAddForm(false);\n  };\n\n  const removeItem = (index) => {\n    const updatedItems = items.filter((_, i) => i !== index);\n    setItems(updatedItems);\n    if (onPortfolioUpdated) {\n      onPortfolioUpdated(updatedItems);\n    }\n    if (currentIndex >= updatedItems.length) {\n      setCurrentIndex(Math.max(0, updatedItems.length - 1));\n    }\n  };\n\n  const toggleFeatured = (index) => {\n    const updatedItems = items.map((item, i) =>\n      i === index ? { ...item, featured: !item.featured } : item\n    );\n    setItems(updatedItems);\n    if (onPortfolioUpdated) {\n      onPortfolioUpdated(updatedItems);\n    }\n  };\n\n  const nextItem = () => {\n    setCurrentIndex((prev) => (prev + 1) % items.length);\n  };\n\n  const prevItem = () => {\n    setCurrentIndex((prev) => (prev - 1 + items.length) % items.length);\n  };\n\n  const categoryConfig = CATEGORIES.find(c => c.value === newItem.category);\n\n  return (\n    <Card className=\"border-2 border-pink-200 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-r from-pink-50 to-purple-50\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <Camera className=\"w-5 h-5 text-pink-600\" />\n            Portfolio ({items.length} {items.length === 1 ? 'item' : 'items'})\n          </div>\n          <Button\n            onClick={() => setShowAddForm(!showAddForm)}\n            size=\"sm\"\n            className=\"bg-pink-500 hover:bg-pink-600 text-white font-fredoka\"\n          >\n            <Plus className=\"w-4 h-4 mr-1\" />\n            Add Work\n          </Button>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        {/* Add New Item Form */}\n        <AnimatePresence>\n          {showAddForm && (\n            <motion.div\n              initial={{ opacity: 0, height: 0 }}\n              animate={{ opacity: 1, height: 'auto' }}\n              exit={{ opacity: 0, height: 0 }}\n              className=\"border-2 border-pink-200 rounded-xl p-6 space-y-4 bg-pink-50\"\n            >\n              <h3 className=\"font-fredoka font-bold text-graphite text-lg\">Add Portfolio Item</h3>\n              \n              <div>\n                <Label htmlFor=\"title\" className=\"font-fredoka\">Title *</Label>\n                <Input\n                  id=\"title\"\n                  value={newItem.title}\n                  onChange={(e) => setNewItem({ ...newItem, title: e.target.value })}\n                  placeholder=\"e.g., Kitchen Deep Clean Transformation\"\n                  className=\"rounded-xl font-verdana\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"description\" className=\"font-fredoka\">Description</Label>\n                <Textarea\n                  id=\"description\"\n                  value={newItem.description}\n                  onChange={(e) => setNewItem({ ...newItem, description: e.target.value })}\n                  placeholder=\"Describe the work you did...\"\n                  rows={3}\n                  className=\"rounded-xl font-verdana\"\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"category\" className=\"font-fredoka\">Category *</Label>\n                <select\n                  id=\"category\"\n                  value={newItem.category}\n                  onChange={(e) => setNewItem({ ...newItem, category: e.target.value })}\n                  className=\"w-full p-2 border rounded-xl font-verdana\"\n                >\n                  {CATEGORIES.map(cat => (\n                    <option key={cat.value} value={cat.value}>\n                      {cat.icon} {cat.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                {/* Before Photo */}\n                <div>\n                  <Label className=\"font-fredoka\">Before Photo *</Label>\n                  {newItem.before_photo_url ? (\n                    <div className=\"relative\">\n                      <img\n                        src={newItem.before_photo_url}\n                        alt=\"Before\"\n                        className=\"w-full h-48 object-cover rounded-xl border-2 border-gray-300\"\n                      />\n                      <Button\n                        onClick={() => setNewItem({ ...newItem, before_photo_url: '' })}\n                        size=\"icon\"\n                        variant=\"destructive\"\n                        className=\"absolute top-2 right-2 rounded-full\"\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  ) : (\n                    <label className=\"cursor-pointer block\">\n                      <div className=\"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-gray-50 transition-all\">\n                        {uploadingBefore ? (\n                          <Loader2 className=\"w-8 h-8 animate-spin text-gray-400 mx-auto\" />\n                        ) : (\n                          <>\n                            <Upload className=\"w-8 h-8 text-gray-400 mx-auto mb-2\" />\n                            <p className=\"text-sm font-verdana text-gray-600\">Upload Before</p>\n                          </>\n                        )}\n                      </div>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handlePhotoUpload(e, 'before')}\n                        disabled={uploadingBefore}\n                        className=\"hidden\"\n                      />\n                    </label>\n                  )}\n                </div>\n\n                {/* After Photo */}\n                <div>\n                  <Label className=\"font-fredoka\">After Photo *</Label>\n                  {newItem.after_photo_url ? (\n                    <div className=\"relative\">\n                      <img\n                        src={newItem.after_photo_url}\n                        alt=\"After\"\n                        className=\"w-full h-48 object-cover rounded-xl border-2 border-green-400\"\n                      />\n                      <Button\n                        onClick={() => setNewItem({ ...newItem, after_photo_url: '' })}\n                        size=\"icon\"\n                        variant=\"destructive\"\n                        className=\"absolute top-2 right-2 rounded-full\"\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  ) : (\n                    <label className=\"cursor-pointer block\">\n                      <div className=\"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:bg-gray-50 transition-all\">\n                        {uploadingAfter ? (\n                          <Loader2 className=\"w-8 h-8 animate-spin text-gray-400 mx-auto\" />\n                        ) : (\n                          <>\n                            <Upload className=\"w-8 h-8 text-gray-400 mx-auto mb-2\" />\n                            <p className=\"text-sm font-verdana text-gray-600\">Upload After</p>\n                          </>\n                        )}\n                      </div>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handlePhotoUpload(e, 'after')}\n                        disabled={uploadingAfter}\n                        className=\"hidden\"\n                      />\n                    </label>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex gap-2 justify-end\">\n                <Button\n                  onClick={() => setShowAddForm(false)}\n                  variant=\"outline\"\n                  className=\"font-fredoka\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={addItem}\n                  className=\"bg-pink-500 hover:bg-pink-600 text-white font-fredoka\"\n                >\n                  Add to Portfolio\n                </Button>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Portfolio Display */}\n        {items.length > 0 ? (\n          <div>\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={currentIndex}\n                initial={{ opacity: 0, x: 100 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -100 }}\n                className=\"space-y-4\"\n              >\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm font-fredoka font-bold text-gray-600 mb-2\">BEFORE</p>\n                    <img\n                      src={items[currentIndex].before_photo_url}\n                      alt=\"Before\"\n                      className=\"w-full h-64 object-cover rounded-xl shadow-lg border-2 border-gray-300\"\n                    />\n                  </div>\n                  <div>\n                    <p className=\"text-sm font-fredoka font-bold text-green-600 mb-2\">AFTER</p>\n                    <img\n                      src={items[currentIndex].after_photo_url}\n                      alt=\"After\"\n                      className=\"w-full h-64 object-cover rounded-xl shadow-lg border-2 border-green-400\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-fredoka font-bold text-lg text-graphite mb-1\">\n                      {items[currentIndex].title}\n                    </h4>\n                    {items[currentIndex].description && (\n                      <p className=\"text-sm text-gray-600 font-verdana mb-2\">\n                        {items[currentIndex].description}\n                      </p>\n                    )}\n                    <div className=\"flex items-center gap-2 flex-wrap\">\n                      <Badge className=\"bg-pink-100 text-pink-700 font-fredoka\">\n                        {CATEGORIES.find(c => c.value === items[currentIndex].category)?.icon}{' '}\n                        {CATEGORIES.find(c => c.value === items[currentIndex].category)?.label}\n                      </Badge>\n                      {items[currentIndex].date && (\n                        <Badge variant=\"outline\" className=\"font-verdana\">\n                          {new Date(items[currentIndex].date).toLocaleDateString()}\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      onClick={() => toggleFeatured(currentIndex)}\n                      size=\"icon\"\n                      variant=\"outline\"\n                      className={items[currentIndex].featured ? 'bg-amber-50 border-amber-400' : ''}\n                    >\n                      <Star className={`w-4 h-4 ${items[currentIndex].featured ? 'fill-amber-400 text-amber-400' : 'text-gray-400'}`} />\n                    </Button>\n                    <Button\n                      onClick={() => removeItem(currentIndex)}\n                      size=\"icon\"\n                      variant=\"outline\"\n                      className=\"text-red-600 border-red-300 hover:bg-red-50\"\n                    >\n                      <X className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </motion.div>\n            </AnimatePresence>\n\n            {items.length > 1 && (\n              <div className=\"flex items-center justify-between mt-4\">\n                <Button\n                  onClick={prevItem}\n                  size=\"icon\"\n                  variant=\"outline\"\n                  className=\"rounded-full\"\n                >\n                  <ChevronLeft className=\"w-5 h-5\" />\n                </Button>\n                <div className=\"flex gap-2\">\n                  {items.map((_, idx) => (\n                    <button\n                      key={idx}\n                      onClick={() => setCurrentIndex(idx)}\n                      className={`w-2 h-2 rounded-full transition-all ${\n                        idx === currentIndex ? 'bg-pink-500 w-6' : 'bg-gray-300'\n                      }`}\n                    />\n                  ))}\n                </div>\n                <Button\n                  onClick={nextItem}\n                  size=\"icon\"\n                  variant=\"outline\"\n                  className=\"rounded-full\"\n                >\n                  <ChevronRight className=\"w-5 h-5\" />\n                </Button>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-center py-12 text-gray-500\">\n            <Camera className=\"w-16 h-16 mx-auto mb-4 text-gray-300\" />\n            <p className=\"font-fredoka font-semibold mb-2\">No portfolio items yet</p>\n            <p className=\"text-sm font-verdana\">Add your best work to showcase your cleaning skills!</p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\QuickCompareDrawer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\SpecialtiesEditor.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Plus' is defined but never used.","line":8,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":24,"fix":{"range":[383,389],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Plus"},"fix":{"range":[382,388],"text":""},"desc":"Remove unused variable 'Plus'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'X' is defined but never used.","line":8,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":27,"fix":{"range":[389,392],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"X"},"fix":{"range":[388,391],"text":""},"desc":"Remove unused variable 'X'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Sparkles, Plus, X, Check } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst SPECIALTY_OPTIONS = [\n  { value: 'Pet-Friendly', icon: 'üêæ', description: 'Experienced with homes that have pets' },\n  { value: 'Eco-Warrior', icon: 'üåø', description: 'Specializes in eco-friendly cleaning products' },\n  { value: 'Deep Clean Expert', icon: '‚ú®', description: 'Expert in thorough deep cleaning' },\n  { value: 'Move-Out Specialist', icon: 'üì¶', description: 'Specialist in move-out cleaning' },\n  { value: 'Same-Day Available', icon: '‚ö°', description: 'Can accommodate same-day requests' },\n  { value: 'Senior-Friendly', icon: '‚ù§Ô∏è', description: 'Patient and caring with seniors' },\n  { value: 'Child-Safe Products', icon: 'üë∂', description: 'Uses only child-safe cleaning products' },\n  { value: 'Allergy-Conscious', icon: 'üå∏', description: 'Mindful of allergies and sensitivities' },\n  { value: 'Organization Pro', icon: 'üìã', description: 'Excels at organizing and decluttering' },\n  { value: 'Post-Construction', icon: 'üèóÔ∏è', description: 'Experienced in post-construction cleanup' }\n];\n\nexport default function SpecialtiesEditor({ selectedSpecialties = [], specialtyDetails = {}, onSpecialtiesUpdated }) {\n  const [specialties, setSpecialties] = useState(selectedSpecialties);\n  const [details, setDetails] = useState(specialtyDetails);\n  const [expandedSpecialty, setExpandedSpecialty] = useState(null);\n\n  const toggleSpecialty = (specialty) => {\n    const updated = specialties.includes(specialty)\n      ? specialties.filter(s => s !== specialty)\n      : [...specialties, specialty];\n    \n    setSpecialties(updated);\n    if (onSpecialtiesUpdated) {\n      onSpecialtiesUpdated(updated, details);\n    }\n  };\n\n  const updateDetails = (specialty, field, value) => {\n    const updated = {\n      ...details,\n      [specialty]: {\n        ...details[specialty],\n        [field]: value\n      }\n    };\n    setDetails(updated);\n    if (onSpecialtiesUpdated) {\n      onSpecialtiesUpdated(specialties, updated);\n    }\n  };\n\n  return (\n    <Card className=\"border-2 border-indigo-200 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-r from-indigo-50 to-purple-50\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Sparkles className=\"w-5 h-5 text-indigo-600\" />\n          Specialties & Expertise\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <p className=\"text-sm text-gray-600 font-verdana\">\n          Select your specialties and add details to stand out to clients looking for specific expertise.\n        </p>\n\n        <div className=\"space-y-3\">\n          {SPECIALTY_OPTIONS.map((option) => {\n            const isSelected = specialties.includes(option.value);\n            const isExpanded = expandedSpecialty === option.value;\n\n            return (\n              <div key={option.value} className=\"space-y-2\">\n                <button\n                  onClick={() => toggleSpecialty(option.value)}\n                  className={`w-full text-left p-4 rounded-xl border-2 transition-all ${\n                    isSelected\n                      ? 'border-indigo-400 bg-indigo-50'\n                      : 'border-gray-200 hover:border-indigo-200'\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      {isSelected && (\n                        <div className=\"w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center flex-shrink-0\">\n                          <Check className=\"w-4 h-4 text-white\" />\n                        </div>\n                      )}\n                      <div>\n                        <p className=\"font-fredoka font-semibold text-graphite\">\n                          {option.icon} {option.value}\n                        </p>\n                        <p className=\"text-sm text-gray-600 font-verdana\">{option.description}</p>\n                      </div>\n                    </div>\n                    {isSelected && (\n                      <Button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setExpandedSpecialty(isExpanded ? null : option.value);\n                        }}\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        className=\"text-indigo-600 hover:bg-indigo-100 font-fredoka\"\n                      >\n                        {isExpanded ? 'Hide' : 'Add'} Details\n                      </Button>\n                    )}\n                  </div>\n                </button>\n\n                <AnimatePresence>\n                  {isSelected && isExpanded && (\n                    <motion.div\n                      initial={{ opacity: 0, height: 0 }}\n                      animate={{ opacity: 1, height: 'auto' }}\n                      exit={{ opacity: 0, height: 0 }}\n                      className=\"ml-4 border-l-4 border-indigo-300 pl-4 space-y-4\"\n                    >\n                      <div>\n                        <Label className=\"font-fredoka text-sm\">Detailed Description</Label>\n                        <Textarea\n                          value={details[option.value]?.description || ''}\n                          onChange={(e) => updateDetails(option.value, 'description', e.target.value)}\n                          placeholder={`Describe your ${option.value.toLowerCase()} expertise...`}\n                          rows={3}\n                          className=\"rounded-xl font-verdana text-sm\"\n                        />\n                      </div>\n\n                      <div className=\"grid md:grid-cols-2 gap-4\">\n                        <div>\n                          <Label className=\"font-fredoka text-sm\">Years of Experience</Label>\n                          <Input\n                            type=\"number\"\n                            value={details[option.value]?.years_experience || ''}\n                            onChange={(e) => updateDetails(option.value, 'years_experience', e.target.value)}\n                            placeholder=\"e.g., 5\"\n                            min=\"0\"\n                            className=\"rounded-xl font-verdana\"\n                          />\n                        </div>\n\n                        <div>\n                          <Label className=\"font-fredoka text-sm\">Certifications (optional)</Label>\n                          <Input\n                            value={details[option.value]?.certifications || ''}\n                            onChange={(e) => updateDetails(option.value, 'certifications', e.target.value)}\n                            placeholder=\"e.g., Green Cleaning Certified\"\n                            className=\"rounded-xl font-verdana\"\n                          />\n                        </div>\n                      </div>\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n            );\n          })}\n        </div>\n\n        {specialties.length > 0 && (\n          <div className=\"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-4\">\n            <p className=\"text-sm font-fredoka font-semibold text-indigo-900 mb-3\">\n              Selected Specialties ({specialties.length}):\n            </p>\n            <div className=\"flex flex-wrap gap-2\">\n              {specialties.map(specialty => {\n                const option = SPECIALTY_OPTIONS.find(o => o.value === specialty);\n                return (\n                  <Badge\n                    key={specialty}\n                    className=\"bg-white border-2 border-indigo-300 text-indigo-700 font-fredoka\"\n                  >\n                    {option?.icon} {specialty}\n                  </Badge>\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\StickyFiltersBar.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'allLocations' is defined but never used. Allowed unused args must match /^_/u.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"allLocations"},"fix":{"range":[476,492],"text":""},"desc":"Remove unused variable 'allLocations'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Search, SlidersHorizontal, X } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\n\nexport default function StickyFiltersBar({ \n  filters, \n  onFilterChange, \n  onResetFilters,\n  onSearch, \n  showAdvanced, \n  setShowAdvanced,\n  allLocations \n}) {\n  const activeFiltersCount = [\n    filters.search,\n    filters.minRating > 0,\n    filters.minReliability > 0,\n    filters.availability !== 'all',\n    filters.cleaningType !== 'all',\n    filters.tier !== 'all',\n    filters.minPrice > 0 || filters.maxPrice < 100\n  ].filter(Boolean).length;\n\n  return (\n    <div className=\"sticky top-16 z-40 bg-white border-b-2 border-gray-200 shadow-md\">\n      <div className=\"max-w-7xl mx-auto px-6 py-4\">\n        <div className=\"flex flex-col lg:flex-row gap-4\">\n          {/* Search Bar */}\n          <div className=\"relative flex-1 flex gap-2\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n              <Input\n                placeholder=\"Search by city, ZIP, cleaner name...\"\n                value={filters.search}\n                onChange={(e) => onFilterChange('search', e.target.value)}\n                onKeyDown={(e) => e.key === 'Enter' && onSearch()}\n                className=\"pl-12 h-12 rounded-full border-2 border-gray-200 focus:border-puretask-blue font-verdana bg-soft-cloud\"\n              />\n            </div>\n            <Button\n              onClick={onSearch}\n              className=\"h-12 px-8 rounded-full brand-gradient text-white font-fredoka font-semibold hover:opacity-90\"\n            >\n              <Search className=\"w-5 h-5 mr-2\" />\n              Search\n            </Button>\n          </div>\n\n          {/* Quick Filters */}\n          <div className=\"flex flex-wrap gap-2\">\n            {/* Sort */}\n            <Select value={filters.sortBy} onValueChange={(value) => onFilterChange('sortBy', value)}>\n              <SelectTrigger className=\"w-[180px] rounded-full border-2 border-gray-200 font-fredoka h-12 bg-soft-cloud\">\n                <SelectValue placeholder=\"Sort by\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"recommended\">üåü PureTask Recommended</SelectItem>\n                <SelectItem value=\"top_rated\">‚≠ê Top Rated</SelectItem>\n                <SelectItem value=\"most_reliable\">‚ö° Most Reliable</SelectItem>\n                <SelectItem value=\"lowest_price\">üí∏ Lowest Price</SelectItem>\n              </SelectContent>\n            </Select>\n\n            {/* Advanced Filters Button */}\n            <Button\n              variant={showAdvanced ? \"default\" : \"outline\"}\n              onClick={() => setShowAdvanced(!showAdvanced)}\n              className={`rounded-full font-fredoka h-12 px-6 ${\n                showAdvanced \n                  ? 'brand-gradient text-white' \n                  : 'border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50'\n              }`}\n            >\n              <SlidersHorizontal className=\"w-5 h-5 mr-2\" />\n              Filters\n              {activeFiltersCount > 0 && (\n                <Badge className=\"ml-2 bg-white text-puretask-blue rounded-full h-6 w-6 p-0 flex items-center justify-center\">\n                  {activeFiltersCount}\n                </Badge>\n              )}\n            </Button>\n\n            {/* Reset Filters */}\n            {activeFiltersCount > 0 && (\n              <Button\n                variant=\"ghost\"\n                onClick={onResetFilters}\n                className=\"rounded-full font-fredoka h-12 text-red-600 hover:bg-red-50\"\n              >\n                <X className=\"w-5 h-5 mr-1\" />\n                Clear\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\VideoIntroUpload.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":8,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[461,478],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[461,478],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useRef } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Video, Upload, Trash2, Play, Loader2, CheckCircle, Info, Sparkles } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\n\nexport default function VideoIntroUpload({ cleanerProfile, onUpdate }) {\n  const [uploading, setUploading] = useState(false);\n  const [deleting, setDeleting] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const fileInputRef = useRef(null);\n\n  const hasVideo = cleanerProfile.video_intro_url;\n\n  const handleFileSelect = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('video/')) {\n      toast.error('Please upload a video file');\n      return;\n    }\n\n    // Validate file size (max 100MB)\n    const maxSize = 100 * 1024 * 1024;\n    if (file.size > maxSize) {\n      toast.error('Video must be less than 100MB');\n      return;\n    }\n\n    setUploading(true);\n    setUploadProgress(0);\n\n    try {\n      // Simulate upload progress\n      const progressInterval = setInterval(() => {\n        setUploadProgress(prev => Math.min(prev + 10, 90));\n      }, 200);\n\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n\n      clearInterval(progressInterval);\n      setUploadProgress(100);\n\n      // Update profile with video URL\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        video_intro_url: file_url\n      });\n\n      toast.success('Video uploaded successfully!');\n      if (onUpdate) onUpdate();\n    } catch (error) {\n      console.error('Error uploading video:', error);\n      toast.error('Failed to upload video');\n    } finally {\n      setUploading(false);\n      setUploadProgress(0);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!confirm('Are you sure you want to delete your video intro?')) return;\n\n    setDeleting(true);\n    try {\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        video_intro_url: null\n      });\n      toast.success('Video deleted');\n      if (onUpdate) onUpdate();\n    } catch (error) {\n      console.error('Error deleting video:', error);\n      toast.error('Failed to delete video');\n    }\n    setDeleting(false);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl rounded-2xl bg-gradient-to-br from-purple-50 to-indigo-50\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-100 to-indigo-100 rounded-t-2xl\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n            <Video className=\"w-6 h-6 text-purple-600\" />\n            Video Introduction\n          </CardTitle>\n          {hasVideo && (\n            <Badge className=\"bg-fresh-mint text-white font-fredoka\">\n              <CheckCircle className=\"w-3 h-3 mr-1\" />\n              Uploaded\n            </Badge>\n          )}\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-6 space-y-6\">\n        <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n          <Info className=\"w-5 h-5 text-puretask-blue\" />\n          <AlertTitle className=\"font-fredoka font-bold text-graphite\">Why Add a Video?</AlertTitle>\n          <AlertDescription className=\"font-verdana text-gray-700 mt-2 space-y-1\">\n            <p>‚ú® Profiles with videos get <strong>3x more bookings</strong></p>\n            <p>üé• Keep it under 30 seconds</p>\n            <p>üí° Introduce yourself, show your personality, highlight your experience</p>\n          </AlertDescription>\n        </Alert>\n\n        {/* Current Video Preview */}\n        {hasVideo && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n          >\n            <Card className=\"border-2 border-purple-300 rounded-2xl overflow-hidden\">\n              <CardContent className=\"p-0\">\n                <div className=\"aspect-video bg-black relative\">\n                  <video\n                    src={cleanerProfile.video_intro_url}\n                    controls\n                    className=\"w-full h-full\"\n                    preload=\"metadata\"\n                  >\n                    Your browser does not support video playback.\n                  </video>\n                  \n                  <div className=\"absolute top-3 right-3\">\n                    <Badge className=\"bg-purple-600 text-white font-fredoka\">\n                      <Play className=\"w-3 h-3 mr-1\" />\n                      Your Intro\n                    </Badge>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Upload Section */}\n        <div className=\"space-y-4\">\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"video/*\"\n            onChange={handleFileSelect}\n            className=\"hidden\"\n          />\n\n          {uploading ? (\n            <Card className=\"border-2 border-purple-300 bg-purple-50 rounded-2xl\">\n              <CardContent className=\"p-6\">\n                <div className=\"text-center\">\n                  <Loader2 className=\"w-12 h-12 animate-spin text-purple-600 mx-auto mb-4\" />\n                  <p className=\"font-fredoka font-bold text-graphite mb-2\">Uploading Video...</p>\n                  <div className=\"w-full bg-gray-200 rounded-full h-3 mb-2\">\n                    <motion.div\n                      className=\"bg-purple-600 h-3 rounded-full\"\n                      initial={{ width: 0 }}\n                      animate={{ width: `${uploadProgress}%` }}\n                      transition={{ duration: 0.3 }}\n                    />\n                  </div>\n                  <p className=\"text-sm text-gray-600 font-verdana\">{uploadProgress}% complete</p>\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-2 gap-3\">\n              <Button\n                onClick={() => fileInputRef.current?.click()}\n                className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n              >\n                <Upload className=\"w-4 h-4 mr-2\" />\n                {hasVideo ? 'Replace Video' : 'Upload Video'}\n              </Button>\n\n              {hasVideo && (\n                <Button\n                  onClick={handleDelete}\n                  disabled={deleting}\n                  variant=\"destructive\"\n                  className=\"rounded-full font-fredoka\"\n                >\n                  {deleting ? (\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  ) : (\n                    <Trash2 className=\"w-4 h-4 mr-2\" />\n                  )}\n                  Delete\n                </Button>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Tips */}\n        <Card className=\"border-2 border-green-200 bg-green-50 rounded-2xl\">\n          <CardContent className=\"p-4\">\n            <p className=\"font-fredoka font-semibold text-graphite mb-3 text-sm\">Video Tips:</p>\n            <ul className=\"space-y-2 text-sm font-verdana text-gray-700\">\n              <li className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5 flex-shrink-0\" />\n                <span><strong>Length:</strong> 20-30 seconds is perfect</span>\n              </li>\n              <li className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5 flex-shrink-0\" />\n                <span><strong>Lighting:</strong> Good natural light, face the camera</span>\n              </li>\n              <li className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5 flex-shrink-0\" />\n                <span><strong>Content:</strong> Name, experience, what makes you unique</span>\n              </li>\n              <li className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-fresh-mint mt-0.5 flex-shrink-0\" />\n                <span><strong>Format:</strong> MP4, MOV, or WebM (max 100MB)</span>\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Impact Stats */}\n        {hasVideo && (\n          <Card className=\"border-2 border-purple-300 bg-gradient-to-br from-purple-100 to-pink-100 rounded-2xl\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <Sparkles className=\"w-8 h-8 text-purple-600\" />\n                <div>\n                  <p className=\"font-fredoka font-bold text-purple-900 mb-1\">Profile Complete!</p>\n                  <p className=\"text-sm text-purple-700 font-verdana\">\n                    Cleaners with videos earn 40% more and get booked 3x faster\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cleaner\\VideoIntroUploader.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Play' is defined but never used.","line":6,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":54,"fix":{"range":[328,334],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Play"},"fix":{"range":[328,334],"text":""},"desc":"Remove unused variable 'Play'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Upload, Video, Loader2, CheckCircle, X, Play } from 'lucide-react';\n\nexport default function VideoIntroUploader({ currentVideoUrl, onVideoUploaded }) {\n  const [uploading, setUploading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [preview, setPreview] = useState(currentVideoUrl || null);\n\n  const handleVideoUpload = async (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file\n    if (!file.type.startsWith('video/')) {\n      setMessage('Please upload a video file');\n      return;\n    }\n\n    // Check file size (max 50MB)\n    if (file.size > 50 * 1024 * 1024) {\n      setMessage('Video file must be less than 50MB');\n      return;\n    }\n\n    setUploading(true);\n    setMessage('');\n\n    try {\n      // Upload video\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      \n      setPreview(file_url);\n      if (onVideoUploaded) {\n        onVideoUploaded(file_url);\n      }\n      setMessage('Video uploaded successfully! Save your profile to apply changes.');\n    } catch (error) {\n      console.error('Video upload error:', error);\n      setMessage('Failed to upload video. Please try again.');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const removeVideo = () => {\n    setPreview(null);\n    if (onVideoUploaded) {\n      onVideoUploaded(null);\n    }\n    setMessage('Video removed. Save your profile to apply changes.');\n  };\n\n  return (\n    <Card className=\"border-2 border-purple-200 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n        <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n          <Video className=\"w-5 h-5 text-purple-600\" />\n          Intro Video\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-4\">\n        <p className=\"text-sm text-gray-600 font-verdana\">\n          Upload a short video (30-60 seconds) introducing yourself to potential clients. Show your personality and cleaning expertise!\n        </p>\n\n        {message && (\n          <Alert className={message.includes('success') ? 'border-green-500 bg-green-50' : 'border-amber-500 bg-amber-50'}>\n            {message.includes('success') ? (\n              <CheckCircle className=\"w-4 h-4 text-green-600\" />\n            ) : (\n              <X className=\"w-4 h-4 text-amber-600\" />\n            )}\n            <AlertDescription className=\"font-verdana\">{message}</AlertDescription>\n          </Alert>\n        )}\n\n        {preview ? (\n          <div className=\"space-y-4\">\n            <div className=\"relative aspect-video bg-gray-900 rounded-xl overflow-hidden\">\n              <video\n                src={preview}\n                controls\n                className=\"w-full h-full\"\n              >\n                Your browser does not support the video tag.\n              </video>\n            </div>\n            <Button\n              onClick={removeVideo}\n              variant=\"outline\"\n              className=\"w-full border-red-300 text-red-600 hover:bg-red-50 font-fredoka\"\n            >\n              <X className=\"w-4 h-4 mr-2\" />\n              Remove Video\n            </Button>\n          </div>\n        ) : (\n          <div>\n            <label htmlFor=\"video-upload\" className=\"cursor-pointer\">\n              <div className=\"border-2 border-dashed border-purple-300 rounded-xl p-8 text-center hover:bg-purple-50 transition-all\">\n                {uploading ? (\n                  <div className=\"flex flex-col items-center gap-3\">\n                    <Loader2 className=\"w-12 h-12 animate-spin text-purple-600\" />\n                    <p className=\"font-fredoka text-purple-600\">Uploading video...</p>\n                  </div>\n                ) : (\n                  <div className=\"flex flex-col items-center gap-3\">\n                    <Upload className=\"w-12 h-12 text-purple-600\" />\n                    <div>\n                      <p className=\"font-fredoka font-semibold text-graphite mb-1\">\n                        Click to upload video\n                      </p>\n                      <p className=\"text-sm text-gray-600 font-verdana\">\n                        MP4, MOV, AVI (max 50MB)\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </label>\n            <input\n              id=\"video-upload\"\n              type=\"file\"\n              accept=\"video/*\"\n              onChange={handleVideoUpload}\n              disabled={uploading}\n              className=\"hidden\"\n            />\n          </div>\n        )}\n\n        <div className=\"bg-blue-50 border-2 border-blue-200 rounded-xl p-4\">\n          <p className=\"text-sm font-fredoka font-semibold text-blue-900 mb-2\">üí° Tips for a great intro video:</p>\n          <ul className=\"text-sm text-blue-800 font-verdana space-y-1 list-disc list-inside\">\n            <li>Keep it under 60 seconds</li>\n            <li>Speak clearly and smile</li>\n            <li>Mention your experience and specialties</li>\n            <li>Film in good lighting</li>\n            <li>Show your cleaning supplies or a workspace</li>\n          </ul>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\config\\CreditSystemConfig.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\AutoCreditIssuer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\CreditCalculator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\CreditSystemExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":2,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33,"fix":{"range":[68,74],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[67,73],"text":""},"desc":"Remove unused variable 'Info'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[211,258],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[211,257],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Coins, DollarSign, Info, ChevronDown, Shield, TrendingUp } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function CreditSystemExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <Card className=\"border-2 border-blue-200 bg-blue-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Coins className=\"w-5 h-5 text-blue-600\" />\n            How Credits Work\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              {/* Conversion Rate */}\n              <div className=\"bg-white rounded-xl p-4 border-2 border-blue-300\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <DollarSign className=\"w-5 h-5 text-blue-600\" />\n                  <h4 className=\"font-fredoka font-bold text-gray-800\">Simple Conversion</h4>\n                </div>\n                <div className=\"text-center py-4\">\n                  <div className=\"text-4xl font-fredoka font-bold text-blue-600 mb-2\">\n                    10 Credits = $1 USD\n                  </div>\n                  <div className=\"flex justify-center gap-4 text-sm font-verdana text-gray-600\">\n                    <span>100 credits = $10</span>\n                    <span>‚Ä¢</span>\n                    <span>500 credits = $50</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Why Credits */}\n              <div className=\"bg-green-50 rounded-xl p-4 border-2 border-green-300\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <Shield className=\"w-5 h-5 text-green-600\" />\n                  <h4 className=\"font-fredoka font-bold text-gray-800\">Why Use Credits?</h4>\n                </div>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Payment Protection:</strong> Credits held safely until job completion</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Fair Pricing:</strong> Pay only for actual time worked (not estimate)</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Easy Refunds:</strong> Unused credits returned immediately</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Flexible:</strong> Buy in bulk, save for later, or get discounts</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* How It Works */}\n              <div className=\"bg-yellow-50 rounded-xl p-4 border-2 border-yellow-300\">\n                <div className=\"flex items-center gap-2 mb-3\">\n                  <TrendingUp className=\"w-5 h-5 text-yellow-600\" />\n                  <h4 className=\"font-fredoka font-bold text-gray-800\">Payment Flow</h4>\n                </div>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">1</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Book & Hold</p>\n                      <p className=\"text-gray-600 font-verdana\">Credits held in escrow (estimate √ó rate)</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">2</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Job Complete</p>\n                      <p className=\"text-gray-600 font-verdana\">Actual hours calculated from check-in/out</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">3</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Final Charge</p>\n                      <p className=\"text-gray-600 font-verdana\">Charged for actual time, excess refunded</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-green-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">4</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Review & Approve</p>\n                      <p className=\"text-gray-600 font-verdana\">Client approves (or auto-approves after 12h)</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Examples */}\n              <div className=\"bg-gray-50 rounded-lg p-3\">\n                <h4 className=\"font-fredoka font-semibold text-gray-800 mb-2 text-sm\">Examples:</h4>\n                <div className=\"space-y-2 text-xs font-verdana text-gray-700\">\n                  <div className=\"flex justify-between\">\n                    <span>3hr job at 300 credits/hr:</span>\n                    <span className=\"font-semibold\">900 credits ($90)</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Actual time: 2.5 hours:</span>\n                    <span className=\"font-semibold text-green-600\">750 credits charged, 150 refunded</span>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\CreditSystemService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\CreditWallet.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Sparkles' is defined but never used.","line":8,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":53,"fix":{"range":[454,464],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Sparkles"},"fix":{"range":[454,464],"text":""},"desc":"Remove unused variable 'Sparkles'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CREDITS_PER_USD' is defined but never used.","line":9,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":53,"fix":{"range":[523,540],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CREDITS_PER_USD"},"fix":{"range":[523,540],"text":""},"desc":"Remove unused variable 'CREDITS_PER_USD'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Wallet, Plus, History, DollarSign, Sparkles } from 'lucide-react';\nimport { usdToCredits, creditsToUSD, CREDITS_PER_USD } from './CreditCalculator';\nimport { motion } from 'framer-motion';\n\nconst CREDIT_PACKAGES = [\n  { usd: 50, credits: 50, bonus: 0, popular: false },\n  { usd: 100, credits: 100, bonus: 5, popular: true, label: 'Most Popular' },\n  { usd: 200, credits: 200, bonus: 15, popular: false },\n  { usd: 500, credits: 500, bonus: 50, popular: false, label: 'Best Value' }\n];\n\nexport default function CreditWallet({ user, onBalanceUpdate }) {\n  const [balance, setBalance] = useState(0);\n  const [transactions, setTransactions] = useState([]);\n  const [showPurchase, setShowPurchase] = useState(false);\n  const [showHistory, setShowHistory] = useState(false);\n  const [customAmount, setCustomAmount] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    loadBalance();\n    loadTransactions();\n  }, [user]);\n\n  const loadBalance = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setBalance(currentUser.wallet_credits_balance || 0);\n    } catch (error) {\n      console.error('Error loading balance:', error);\n    }\n  };\n\n  const loadTransactions = async () => {\n    try {\n      const txns = await base44.entities.CreditTransaction.filter(\n        { client_email: user.email },\n        '-created_date',\n        20\n      );\n      setTransactions(txns);\n    } catch (error) {\n      console.error('Error loading transactions:', error);\n    }\n  };\n\n  const handlePurchase = async (pkg) => {\n    setLoading(true);\n    try {\n      const totalCredits = pkg.credits + pkg.bonus;\n      \n      // Create purchase transaction\n      await base44.entities.CreditTransaction.create({\n        client_email: user.email,\n        transaction_type: 'purchase',\n        amount_credits: totalCredits,\n        note: `Purchased ${pkg.credits} credits${pkg.bonus > 0 ? ` + ${pkg.bonus} bonus` : ''} for $${pkg.usd}`,\n        balance_after: balance + totalCredits\n      });\n      \n      // Update user balance\n      await base44.auth.updateMe({\n        wallet_credits_balance: balance + totalCredits\n      });\n      \n      setBalance(balance + totalCredits);\n      if (onBalanceUpdate) onBalanceUpdate(balance + totalCredits);\n      \n      setShowPurchase(false);\n      loadTransactions();\n      \n      alert(`‚úÖ Successfully added ${totalCredits.toLocaleString()} credits to your wallet!`);\n    } catch (error) {\n      console.error('Purchase error:', error);\n      alert('Failed to purchase credits');\n    }\n    setLoading(false);\n  };\n\n  const handleCustomPurchase = async () => {\n    const usd = parseFloat(customAmount);\n    if (!usd || usd < 10) {\n      alert('Minimum purchase is $10');\n      return;\n    }\n    \n    await handlePurchase({\n      usd: usd,\n      credits: usdToCredits(usd),\n      bonus: 0\n    });\n    setCustomAmount('');\n  };\n\n  const getTransactionIcon = (type) => {\n    switch (type) {\n      case 'purchase': return 'üí≥';\n      case 'hold': return 'üîí';\n      case 'release': return 'üîì';\n      case 'charge': return 'üì§';\n      case 'refund': return 'üíö';\n      default: return 'üìù';\n    }\n  };\n\n  return (\n    <>\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n          <CardTitle className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Wallet className=\"w-6 h-6 text-emerald-600\" />\n              Credit Wallet\n            </div>\n            <Button size=\"sm\" onClick={() => setShowHistory(true)} variant=\"outline\">\n              <History className=\"w-4 h-4 mr-2\" />\n              History\n            </Button>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"text-center mb-6\">\n            <p className=\"text-sm text-slate-600 mb-2\">Your Balance</p>\n            <p className=\"text-5xl font-bold text-emerald-600 mb-1\">\n              {balance.toLocaleString()}\n            </p>\n            <p className=\"text-sm text-slate-500\">\n              credits (‚âà ${creditsToUSD(balance).toFixed(2)})\n            </p>\n          </div>\n          \n          <Button \n            onClick={() => setShowPurchase(true)}\n            className=\"w-full bg-gradient-to-r from-emerald-500 to-green-600\"\n            size=\"lg\"\n          >\n            <Plus className=\"w-5 h-5 mr-2\" />\n            Add Credits\n          </Button>\n        </CardContent>\n      </Card>\n\n      {/* Purchase Dialog */}\n      <Dialog open={showPurchase} onOpenChange={setShowPurchase}>\n        <DialogContent className=\"max-w-3xl\">\n          <DialogHeader>\n            <DialogTitle>Purchase Credits</DialogTitle>\n          </DialogHeader>\n          \n          <div className=\"space-y-6\">\n            <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n              <p className=\"text-sm text-blue-900\">\n                <strong>How it works:</strong> 1 credit = $1 USD. Credits are used to book cleanings. \n                You only pay for actual time worked (rounded to 15-min increments).\n              </p>\n            </div>\n\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              {CREDIT_PACKAGES.map((pkg, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.05 }}\n                >\n                  <Card className={`relative ${pkg.popular ? 'border-2 border-emerald-500' : 'border'}`}>\n                    {pkg.label && (\n                      <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2\">\n                        <Badge className=\"bg-emerald-500 text-white\">{pkg.label}</Badge>\n                      </div>\n                    )}\n                    <CardContent className=\"p-6 text-center\">\n                      <p className=\"text-4xl font-bold text-slate-900 mb-1\">\n                        {(pkg.credits + pkg.bonus).toLocaleString()}\n                      </p>\n                      <p className=\"text-sm text-slate-600 mb-1\">credits</p>\n                      {pkg.bonus > 0 && (\n                        <p className=\"text-xs text-emerald-600 font-semibold mb-3\">\n                          +{pkg.bonus} bonus credits!\n                        </p>\n                      )}\n                      <p className=\"text-2xl font-bold text-slate-900 mb-4\">${pkg.usd}</p>\n                      <Button\n                        onClick={() => handlePurchase(pkg)}\n                        disabled={loading}\n                        className={pkg.popular ? 'w-full bg-emerald-500 hover:bg-emerald-600' : 'w-full'}\n                      >\n                        {loading ? 'Processing...' : 'Purchase'}\n                      </Button>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n\n            <div>\n              <p className=\"text-sm font-semibold text-slate-700 mb-3\">Custom Amount</p>\n              <div className=\"flex gap-3\">\n                <div className=\"flex-1 relative\">\n                  <DollarSign className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400\" />\n                  <Input\n                    type=\"number\"\n                    placeholder=\"Enter USD amount\"\n                    value={customAmount}\n                    onChange={(e) => setCustomAmount(e.target.value)}\n                    min=\"10\"\n                    className=\"pl-10\"\n                  />\n                </div>\n                <Button onClick={handleCustomPurchase} disabled={loading || !customAmount}>\n                  Purchase {customAmount && usdToCredits(parseFloat(customAmount)).toLocaleString()} Credits\n                </Button>\n              </div>\n              <p className=\"text-xs text-slate-500 mt-2\">Minimum $10</p>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* History Dialog */}\n      <Dialog open={showHistory} onOpenChange={setShowHistory}>\n        <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Transaction History</DialogTitle>\n          </DialogHeader>\n          \n          <div className=\"space-y-3\">\n            {transactions.length === 0 ? (\n              <p className=\"text-center text-slate-500 py-12\">No transactions yet</p>\n            ) : (\n              transactions.map((txn) => (\n                <Card key={txn.id} className=\"border\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-start gap-3\">\n                        <span className=\"text-2xl\">{getTransactionIcon(txn.transaction_type)}</span>\n                        <div>\n                          <p className=\"font-semibold text-slate-900 capitalize\">\n                            {txn.transaction_type.replace('_', ' ')}\n                          </p>\n                          <p className=\"text-sm text-slate-600\">{txn.note}</p>\n                          <p className=\"text-xs text-slate-500\">\n                            {new Date(txn.created_date).toLocaleString()}\n                          </p>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className={`text-lg font-bold ${txn.amount_credits > 0 ? 'text-emerald-600' : 'text-slate-900'}`}>\n                          {txn.amount_credits > 0 ? '+' : ''}{txn.amount_credits.toLocaleString()}\n                        </p>\n                        <p className=\"text-xs text-slate-500\">\n                          Balance: {txn.balance_after?.toLocaleString() || 'N/A'}\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\credits\\TransactionHistory.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[178,225],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[178,224],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, ArrowUpCircle, ArrowDownCircle } from 'lucide-react';\nimport { \n  getTransactionTypeLabel, \n  getTransactionColor, \n  formatTransactionAmount,\n  creditsToUSD \n} from './CreditSystemService';\nimport { format } from 'date-fns';\n\nexport default function TransactionHistory({ clientEmail, limit = 20 }) {\n  const [transactions, setTransactions] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadTransactions();\n  }, [clientEmail]);\n\n  const loadTransactions = async () => {\n    setLoading(true);\n    try {\n      const txs = await base44.entities.CreditTransaction.filter(\n        { client_email: clientEmail },\n        '-created_date',\n        limit\n      );\n      setTransactions(txs);\n    } catch (error) {\n      console.error('Error loading transactions:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  if (transactions.length === 0) {\n    return (\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardContent className=\"p-8 text-center\">\n          <p className=\"text-gray-500 font-verdana\">No transactions yet</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"rounded-3xl border-0 shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-fredoka text-2xl\">Transaction History</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {transactions.map((tx) => {\n          const isPositive = tx.amount_credits >= 0;\n          const color = getTransactionColor(tx.transaction_type);\n          \n          return (\n            <div\n              key={tx.id}\n              className=\"flex items-center justify-between p-4 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors\"\n            >\n              <div className=\"flex items-center gap-4\">\n                <div className={`p-2 rounded-full ${isPositive ? 'bg-green-100' : 'bg-red-100'}`}>\n                  {isPositive ? (\n                    <ArrowUpCircle className=\"w-5 h-5 text-green-600\" />\n                  ) : (\n                    <ArrowDownCircle className=\"w-5 h-5 text-red-600\" />\n                  )}\n                </div>\n                <div>\n                  <p className=\"font-fredoka font-semibold text-graphite\">\n                    {getTransactionTypeLabel(tx.transaction_type)}\n                  </p>\n                  {tx.note && (\n                    <p className=\"text-sm text-gray-600 font-verdana\">{tx.note}</p>\n                  )}\n                  <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                    {format(new Date(tx.created_date), 'MMM d, yyyy h:mm a')}\n                  </p>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <p className={`font-fredoka font-bold text-xl ${color}`}>\n                  {formatTransactionAmount(tx.amount_credits)}\n                </p>\n                <p className=\"text-sm text-gray-500 font-verdana\">\n                  ${creditsToUSD(Math.abs(tx.amount_credits)).toFixed(2)}\n                </p>\n                <p className=\"text-xs text-gray-400 font-verdana mt-1\">\n                  Balance: {tx.balance_after?.toLocaleString() || 'N/A'}\n                </p>\n              </div>\n            </div>\n          );\n        })}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\BookingExpiration.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\EmailCampaignCron.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'base44' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"fix":{"range":[41,86],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"base44"},"fix":{"range":[41,85],"text":""},"desc":"Remove unused variable 'base44'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Loader2, Mail, CheckCircle, AlertCircle } from 'lucide-react';\nimport { processEmailCampaigns, initializeDefaultCampaigns } from '../email/EmailCampaignScheduler';\n\nexport default function EmailCampaignCron() {\n  const [running, setRunning] = useState(false);\n  const [initializing, setInitializing] = useState(false);\n  const [result, setResult] = useState(null);\n\n  const handleRun = async () => {\n    setRunning(true);\n    setResult(null);\n    \n    try {\n      const res = await processEmailCampaigns();\n      setResult(res);\n    } catch (error) {\n      setResult({\n        success: false,\n        error: error.message\n      });\n    }\n    \n    setRunning(false);\n  };\n\n  const handleInitialize = async () => {\n    setInitializing(true);\n    \n    try {\n      await initializeDefaultCampaigns();\n      setResult({\n        success: true,\n        message: 'Email campaigns initialized successfully'\n      });\n    } catch (error) {\n      setResult({\n        success: false,\n        error: error.message\n      });\n    }\n    \n    setInitializing(false);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Mail className=\"w-5 h-5 mr-2 text-blue-500\" />\n          Email Campaign Scheduler\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <p className=\"text-sm text-slate-600\">\n          Process and send scheduled nurture emails to users based on their activity.\n        </p>\n\n        <div className=\"flex gap-3\">\n          <Button\n            onClick={handleRun}\n            disabled={running || initializing}\n            className=\"flex-1 bg-blue-500 hover:bg-blue-600\"\n          >\n            {running ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Processing...\n              </>\n            ) : (\n              <>\n                <Mail className=\"w-4 h-4 mr-2\" />\n                Send Emails\n              </>\n            )}\n          </Button>\n\n          <Button\n            onClick={handleInitialize}\n            disabled={running || initializing}\n            variant=\"outline\"\n          >\n            {initializing ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Init...\n              </>\n            ) : (\n              'Initialize Campaigns'\n            )}\n          </Button>\n        </div>\n\n        {result && (\n          <Alert className={result.success ? 'border-emerald-200 bg-emerald-50' : 'border-red-200 bg-red-50'}>\n            {result.success ? (\n              <CheckCircle className=\"w-4 h-4 text-emerald-600\" />\n            ) : (\n              <AlertCircle className=\"w-4 h-4 text-red-600\" />\n            )}\n            <AlertDescription className={result.success ? 'text-emerald-900' : 'text-red-900'}>\n              {result.success ? (\n                result.message || `Sent ${result.emailsSent} emails with ${result.errors} errors`\n              ) : (\n                `Error: ${result.error}`\n              )}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"bg-slate-50 p-4 rounded-lg text-xs text-slate-600\">\n          <strong>Campaigns:</strong>\n          <ul className=\"mt-2 space-y-1 ml-4 list-disc\">\n            <li>Post-Booking Follow-up (review request + re-booking)</li>\n            <li>Signup Nurture (welcome series for non-bookers)</li>\n            <li>Subscription Upsell (after 2nd booking)</li>\n            <li>Referral Reminder (after successful referral)</li>\n          </ul>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\JobStartRemindersCron.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\RecurringBookingGenerator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\SendBookingReminders.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\UpdateAvailabilityCache.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\cron\\UpdateReliabilityScores.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\dashboard\\SmartSchedulingWidget.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":6,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":35,"fix":{"range":[302,309],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[301,308],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":6,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":43,"fix":{"range":[309,317],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[308,316],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":6,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":55,"fix":{"range":[317,329],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[316,328],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Calendar, Clock, MapPin, TrendingUp, Check, X, Loader2 } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function SmartSchedulingWidget({ cleanerEmail, onUpdate }) {\n  const [suggestions, setSuggestions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [processing, setProcessing] = useState(null);\n\n  useEffect(() => {\n    loadSuggestions();\n  }, [cleanerEmail]);\n\n  const loadSuggestions = async () => {\n    try {\n      setLoading(true);\n      \n      const profile = await base44.entities.CleanerProfile.filter({ \n        user_email: cleanerEmail \n      }).then(p => p[0]);\n\n      if (!profile?.communication_settings?.ai_scheduling_enabled) {\n        setLoading(false);\n        return;\n      }\n\n      // Get existing bookings\n      const bookings = await base44.entities.Booking.filter({ \n        cleaner_email: cleanerEmail,\n        status: { $in: ['scheduled', 'accepted'] }\n      });\n\n      // Generate suggestions\n      const prompt = `Analyze this cleaner's schedule and suggest 2 optimal booking opportunities for the next 7 days.\n\nCurrent bookings: ${bookings.length}\nCleaner tier: ${profile.tier}\nService areas: ${profile.service_locations?.join(', ') || 'Not specified'}\n\nReturn ONLY a valid JSON array with 2 suggestions:\n[\n  {\n    \"date\": \"2025-01-05\",\n    \"time\": \"10:00 AM\",\n    \"duration\": 3,\n    \"reason\": \"Fill morning gap\",\n    \"match_score\": 85\n  }\n]`;\n\n      const response = await base44.integrations.Core.InvokeLLM({\n        prompt,\n        response_json_schema: {\n          type: \"object\",\n          properties: {\n            suggestions: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  date: { type: \"string\" },\n                  time: { type: \"string\" },\n                  duration: { type: \"number\" },\n                  reason: { type: \"string\" },\n                  match_score: { type: \"number\" }\n                }\n              }\n            }\n          }\n        }\n      });\n\n      setSuggestions(response.suggestions?.slice(0, 2) || []);\n    } catch (error) {\n      console.error('Error loading suggestions:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleAccept = async (suggestion) => {\n    setProcessing(suggestion);\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    setSuggestions(prev => prev.filter(s => s !== suggestion));\n    setProcessing(null);\n    if (onUpdate) onUpdate();\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-2 border-blue-200\">\n        <CardContent className=\"p-6 text-center\">\n          <Loader2 className=\"w-6 h-6 animate-spin text-puretask-blue mx-auto mb-2\" />\n          <p className=\"text-xs text-gray-600\">Analyzing schedule...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (suggestions.length === 0) return null;\n\n  return (\n    <Card className=\"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-base font-fredoka flex items-center gap-2\">\n            <Sparkles className=\"w-4 h-4 text-puretask-blue\" />\n            Smart Scheduling\n          </CardTitle>\n          <Badge className=\"bg-puretask-blue text-white text-xs\">AI</Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <AnimatePresence>\n          {suggestions.map((suggestion, idx) => (\n            <motion.div\n              key={idx}\n              initial={{ opacity: 0, scale: 0.95 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.95 }}\n              className=\"bg-white rounded-lg p-3 border-2 border-blue-100\"\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-1\">\n                    <Calendar className=\"w-3 h-3 text-gray-500\" />\n                    <span className=\"text-sm font-verdana font-semibold\">\n                      {format(parseISO(suggestion.date), 'MMM d')} at {suggestion.time}\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-gray-600 font-verdana\">\n                    {suggestion.reason} ‚Ä¢ {suggestion.duration}h booking\n                  </p>\n                </div>\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  {suggestion.match_score}%\n                </Badge>\n              </div>\n              \n              <div className=\"flex gap-2 mt-2\">\n                <Button\n                  size=\"sm\"\n                  onClick={() => handleAccept(suggestion)}\n                  disabled={processing === suggestion}\n                  className=\"flex-1 brand-gradient text-white text-xs h-7\"\n                >\n                  {processing === suggestion ? (\n                    <Loader2 className=\"w-3 h-3 animate-spin\" />\n                  ) : (\n                    <>\n                      <Check className=\"w-3 h-3 mr-1\" />\n                      Interested\n                    </>\n                  )}\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"outline\"\n                  onClick={() => setSuggestions(prev => prev.filter(s => s !== suggestion))}\n                  disabled={processing === suggestion}\n                  className=\"text-xs h-7\"\n                >\n                  <X className=\"w-3 h-3\" />\n                </Button>\n              </div>\n            </motion.div>\n          ))}\n        </AnimatePresence>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\dashboard\\UpcomingJobReminders.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\disputes\\DisputeForm.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'disputeWindow' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":21,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"disputeWindow"},"fix":{"range":[1076,1124],"text":""},"desc":"Remove unused variable 'disputeWindow'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { AlertTriangle, Loader2 } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport DisputeWindowEnforcement, { useDisputeWindow } from './DisputeWindowEnforcement';\nimport DisputeProcessExplainer from './DisputeProcessExplainer';\n\nexport default function DisputeForm({ booking, onDisputeFiled }) {\n  const [loading, setLoading] = useState(false);\n  const [category, setCategory] = useState('');\n  const [description, setDescription] = useState('');\n  const [evidencePhotos, setEvidencePhotos] = useState([]);\n  const [uploading, setUploading] = useState(false);\n\n  const disputeWindow = useDisputeWindow(booking);\n\n  const categories = [\n    { value: 'quality_issue', label: 'Quality Issue' },\n    { value: 'no_show', label: 'No Show' },\n    { value: 'late_arrival', label: 'Late Arrival' },\n    { value: 'damage', label: 'Damage/Breakage' },\n    { value: 'safety_concern', label: 'Safety Concern' },\n    { value: 'payment_issue', label: 'Payment Issue' },\n    { value: 'other', label: 'Other' }\n  ];\n\n  const handleFileUpload = async (e) => {\n    const files = Array.from(e.target.files);\n    if (files.length === 0) return;\n\n    setUploading(true);\n    try {\n      const urls = [];\n      for (const file of files) {\n        const { file_url } = await base44.integrations.Core.UploadFile({ file });\n        urls.push(file_url);\n      }\n      setEvidencePhotos(prev => [...prev, ...urls]);\n    } catch (error) {\n      console.error('Error uploading files:', error);\n      alert('Failed to upload files');\n    }\n    setUploading(false);\n  };\n\n  const handleSubmit = async () => {\n    if (!category || !description.trim()) {\n      alert('Please fill in all required fields');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // Create dispute\n      // NOTE: user_email and filed_by were removed from props per outline.\n      // This implementation assumes these values are either inferred by the backend/SDK\n      // or are not strictly required for this specific interaction.\n      await base44.entities.Dispute.create({\n        booking_id: booking.id,\n        category,\n        description: description.trim(),\n        evidence_photos: evidencePhotos,\n        status: 'open'\n      });\n\n      // Update booking status\n      await base44.entities.Booking.update(booking.id, {\n        status: 'disputed'\n      });\n\n      // Log event\n      // NOTE: user_email was removed from props per outline.\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'dispute_opened',\n        details: `Dispute filed: ${category}`,\n        timestamp: new Date().toISOString()\n      });\n\n      // Notify admin\n      try {\n        // NOTE: filed_by and user_email removed from email body as they are no longer in props.\n        await base44.integrations.Core.SendEmail({\n          to: 'admin@puretask.com', // Replace with actual admin email\n          subject: 'üö® New Dispute Filed',\n          body: `A new dispute has been filed:\n\nBooking ID: ${booking.id}\nCategory: ${category}\nDescription: ${description}\n\nPlease review in the admin dashboard.`\n        });\n      } catch (notifErr) {\n        console.error('Failed to notify admin:', notifErr);\n      }\n\n      if (onDisputeFiled) onDisputeFiled();\n    } catch (error) {\n      console.error('Error filing dispute:', error);\n      alert('Failed to file dispute. Please try again.');\n    }\n    setLoading(false);\n  };\n\n  const handleClearForm = () => {\n    setCategory('');\n    setDescription('');\n    setEvidencePhotos([]);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className=\"bg-gradient-to-r from-red-50 to-orange-50\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <AlertTriangle className=\"w-6 h-6 text-red-600\" />\n          File a Dispute\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        <DisputeProcessExplainer />\n\n        <p className=\"text-sm text-slate-700\">\n          Report an issue with this booking. Our support team will review and respond within 24 hours.\n        </p>\n\n        {/* Dispute Window Enforcement */}\n        <DisputeWindowEnforcement booking={booking}>\n          {(windowStatus, hasExistingDispute) => (\n            <>\n              {/* Show form only if can dispute */}\n              {windowStatus.canDispute && !hasExistingDispute ? (\n                <>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <Label>Issue Category *</Label>\n                      <Select value={category} onValueChange={setCategory}>\n                        <SelectTrigger className=\"mt-2\">\n                          <SelectValue placeholder=\"Select category...\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {categories.map(cat => (\n                            <SelectItem key={cat.value} value={cat.value}>\n                              {cat.label}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Description *</Label>\n                      <Textarea\n                        value={description}\n                        onChange={(e) => setDescription(e.target.value)}\n                        placeholder=\"Please provide detailed information about the issue...\"\n                        rows={6}\n                        className=\"mt-2\"\n                      />\n                      <p className=\"text-xs text-slate-500 mt-1\">\n                        {description.length}/1000 characters\n                      </p>\n                    </div>\n\n                    <div>\n                      <Label>Evidence Photos (Optional)</Label>\n                      <div className=\"mt-2 space-y-2\">\n                        <Input\n                          type=\"file\"\n                          accept=\"image/*\"\n                          multiple\n                          onChange={handleFileUpload}\n                          disabled={uploading}\n                        />\n                        {uploading && (\n                          <p className=\"text-sm text-blue-600 flex items-center gap-2\">\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\n                            Uploading...\n                          </p>\n                        )}\n                        {evidencePhotos.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2 mt-2\">\n                            {evidencePhotos.map((url, idx) => (\n                              <div key={idx} className=\"relative\">\n                                <img src={url} alt=\"Evidence\" className=\"w-20 h-20 object-cover rounded border\" />\n                                <button\n                                  onClick={() => setEvidencePhotos(prev => prev.filter((_, i) => i !== idx))}\n                                  className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs\"\n                                >\n                                  √ó\n                                </button>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\n                      <p className=\"text-sm text-amber-900\">\n                        <strong>What happens next:</strong> Our team will review your dispute within 24 hours.\n                        We may contact both parties for additional information. Resolution typically takes 2-3 business days.\n                      </p>\n                    </div>\n\n                    <div className=\"flex gap-3\">\n                      <Button\n                        variant=\"outline\"\n                        onClick={handleClearForm}\n                        className=\"flex-1\"\n                        disabled={loading}\n                      >\n                        Clear Form\n                      </Button>\n                      <Button\n                        onClick={handleSubmit}\n                        className=\"flex-1 bg-red-600 hover:bg-red-700\"\n                        disabled={loading || !category || !description.trim()}\n                      >\n                        {loading ? (\n                          <>\n                            <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                            Filing Dispute...\n                          </>\n                        ) : (\n                          <>\n                            <AlertTriangle className=\"w-4 h-4 mr-2\" />\n                            Submit Dispute\n                          </>\n                        )}\n                      </Button>\n                    </div>\n                  </div>\n                </>\n              ) : (\n                <Alert className=\"border-slate-200 bg-slate-50\">\n                  <AlertDescription className=\"text-slate-700\">\n                    {windowStatus.notYetCompleted &&\n                      'Dispute filing will be available after job completion.'}\n                    {windowStatus.expired &&\n                      'The dispute window has closed. Please contact support for assistance.'}\n                    {hasExistingDispute &&\n                      'A dispute has already been filed for this booking.'}\n                  </AlertDescription>\n                </Alert>\n              )}\n            </>\n          )}\n        </DisputeWindowEnforcement>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\disputes\\DisputeProcessExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":2,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":41,"fix":{"range":[69,82],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[68,81],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Scale, ChevronDown, AlertCircle, Users, Clock } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function DisputeProcessExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <Card className=\"border-2 border-orange-200 bg-orange-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Scale className=\"w-5 h-5 text-orange-600\" />\n            Dispute Resolution Process\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              {/* Timeline */}\n              <div className=\"bg-white rounded-xl p-4 border-2 border-orange-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5 text-orange-600\" />\n                  Resolution Timeline\n                </h4>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-8 h-8 rounded-full bg-orange-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">1</div>\n                    <div className=\"text-sm flex-1\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">File Dispute</p>\n                      <p className=\"text-gray-600 font-verdana text-xs\">Submit within 48 hours of job completion</p>\n                    </div>\n                    <Badge className=\"bg-gray-100 text-gray-700 font-verdana text-xs\">Day 1</Badge>\n                  </div>\n\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-8 h-8 rounded-full bg-orange-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">2</div>\n                    <div className=\"text-sm flex-1\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Initial Review</p>\n                      <p className=\"text-gray-600 font-verdana text-xs\">Team reviews evidence and contacts both parties</p>\n                    </div>\n                    <Badge className=\"bg-gray-100 text-gray-700 font-verdana text-xs\">24h</Badge>\n                  </div>\n\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-8 h-8 rounded-full bg-orange-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">3</div>\n                    <div className=\"text-sm flex-1\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Investigation</p>\n                      <p className=\"text-gray-600 font-verdana text-xs\">Photos, GPS, messages reviewed for fair decision</p>\n                    </div>\n                    <Badge className=\"bg-gray-100 text-gray-700 font-verdana text-xs\">48h</Badge>\n                  </div>\n\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-8 h-8 rounded-full bg-green-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">4</div>\n                    <div className=\"text-sm flex-1\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Resolution</p>\n                      <p className=\"text-gray-600 font-verdana text-xs\">Decision made, refunds/credits issued if applicable</p>\n                    </div>\n                    <Badge className=\"bg-gray-100 text-gray-700 font-verdana text-xs\">72h</Badge>\n                  </div>\n                </div>\n              </div>\n\n              {/* Possible Outcomes */}\n              <div className=\"bg-blue-50 rounded-xl p-4 border-2 border-blue-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3\">Possible Outcomes</h4>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex items-start gap-2\">\n                    <Badge className=\"bg-green-600 text-white font-fredoka text-xs\">Client</Badge>\n                    <p>Full/partial refund + service credit</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <Badge className=\"bg-blue-600 text-white font-fredoka text-xs\">Split</Badge>\n                    <p>Partial refund, both parties compensated</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <Badge className=\"bg-purple-600 text-white font-fredoka text-xs\">Cleaner</Badge>\n                    <p>Payment upheld, no client refund</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <Badge className=\"bg-gray-600 text-white font-fredoka text-xs\">None</Badge>\n                    <p>Insufficient evidence, no action taken</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Fair Review */}\n              <div className=\"bg-purple-50 rounded-lg p-3 border-l-4 border-purple-400\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <Users className=\"w-5 h-5 text-purple-600\" />\n                  <h4 className=\"font-fredoka font-semibold text-gray-800 text-sm\">Fair & Impartial</h4>\n                </div>\n                <p className=\"text-xs text-gray-700 font-verdana\">\n                  Our support team reviews all evidence objectively: photos, GPS data, messages, and both parties' accounts. We aim for fair outcomes that protect everyone.\n                </p>\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\disputes\\DisputeResolutionTool.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36,"fix":{"range":[24,35],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[24,35],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { AlertCircle, CheckCircle, Scale, X } from 'lucide-react';\n\nexport default function DisputeResolutionTool({ dispute, booking, onResolved }) {\n  const [resolving, setResolving] = useState(false);\n  const [outcome, setOutcome] = useState('');\n  const [refundCredits, setRefundCredits] = useState(dispute.requested_refund_credits || 0);\n  const [notes, setNotes] = useState('');\n\n  const handleResolve = async () => {\n    if (!outcome) {\n      alert('Please select an outcome');\n      return;\n    }\n\n    setResolving(true);\n    try {\n      const user = await base44.auth.me();\n      \n      await base44.entities.Dispute.update(dispute.id, {\n        resolved_outcome: outcome,\n        final_refund_credits: outcome === 'no_action' || outcome === 'cleaner_favor' ? 0 : refundCredits,\n        resolution: notes,\n        resolved_by: user.email,\n        resolved_at: new Date().toISOString(),\n        status: 'resolved'\n      });\n\n      if (onResolved) {\n        onResolved();\n      }\n    } catch (error) {\n      console.error('Error resolving dispute:', error);\n      alert('Failed to resolve dispute. Please try again.');\n    }\n    setResolving(false);\n  };\n\n  const outcomeOptions = [\n    { value: 'client_favor', label: 'Client Wins (Full Refund)', icon: CheckCircle, color: 'bg-green-100 text-green-800' },\n    { value: 'split', label: 'Split Decision (Partial Refund)', icon: Scale, color: 'bg-yellow-100 text-yellow-800' },\n    { value: 'cleaner_favor', label: 'Cleaner Wins (No Refund)', icon: CheckCircle, color: 'bg-blue-100 text-blue-800' },\n    { value: 'no_action', label: 'No Action (Invalid/Duplicate)', icon: X, color: 'bg-gray-100 text-gray-800' }\n  ];\n\n  return (\n    <Card className=\"rounded-3xl border-0 shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n          <Scale className=\"w-5 h-5\" />\n          Resolve Dispute\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Dispute Info */}\n        <div className=\"p-4 bg-gray-50 rounded-2xl space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-verdana text-gray-600\">Filed By:</span>\n            <Badge>{dispute.filed_by}</Badge>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-verdana text-gray-600\">Category:</span>\n            <Badge variant=\"secondary\">{dispute.category}</Badge>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-verdana text-gray-600\">Requested Refund:</span>\n            <span className=\"font-fredoka font-semibold\">\n              {dispute.requested_refund_credits || 0} credits\n            </span>\n          </div>\n          <div className=\"pt-2 border-t border-gray-200\">\n            <p className=\"text-sm font-verdana text-gray-700\">{dispute.description}</p>\n          </div>\n        </div>\n\n        {/* Outcome Selection */}\n        <div>\n          <label className=\"block text-sm font-verdana font-semibold text-gray-700 mb-3\">\n            Select Outcome\n          </label>\n          <div className=\"space-y-2\">\n            {outcomeOptions.map((option) => {\n              const Icon = option.icon;\n              return (\n                <button\n                  key={option.value}\n                  onClick={() => setOutcome(option.value)}\n                  className={`w-full p-4 rounded-2xl border-2 transition-all text-left ${\n                    outcome === option.value\n                      ? 'border-puretask-blue bg-blue-50'\n                      : 'border-gray-200 hover:border-gray-300'\n                  }`}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <Icon className={`w-5 h-5 ${outcome === option.value ? 'text-puretask-blue' : 'text-gray-400'}`} />\n                    <span className=\"font-fredoka font-semibold text-graphite\">\n                      {option.label}\n                    </span>\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* Refund Amount (if applicable) */}\n        {outcome && outcome !== 'no_action' && outcome !== 'cleaner_favor' && (\n          <div>\n            <label className=\"block text-sm font-verdana font-semibold text-gray-700 mb-2\">\n              Final Refund Amount (Credits)\n            </label>\n            <Input\n              type=\"number\"\n              value={refundCredits}\n              onChange={(e) => setRefundCredits(parseFloat(e.target.value) || 0)}\n              min=\"0\"\n              max={booking.final_charge_credits || booking.escrow_credits_reserved || 1000}\n            />\n            <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n              ${(refundCredits / 10).toFixed(2)} USD\n            </p>\n          </div>\n        )}\n\n        {/* Resolution Notes */}\n        <div>\n          <label className=\"block text-sm font-verdana font-semibold text-gray-700 mb-2\">\n            Resolution Notes\n          </label>\n          <Textarea\n            value={notes}\n            onChange={(e) => setNotes(e.target.value)}\n            placeholder=\"Explain the resolution decision...\"\n            className=\"min-h-[100px]\"\n          />\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex gap-3 pt-4\">\n          <Button\n            onClick={handleResolve}\n            disabled={!outcome || resolving}\n            className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-semibold\"\n          >\n            {resolving ? 'Processing...' : 'Resolve Dispute'}\n          </Button>\n        </div>\n\n        {/* Warning */}\n        {outcome === 'client_favor' && (\n          <div className=\"flex items-start gap-2 p-3 bg-yellow-50 rounded-2xl\">\n            <AlertCircle className=\"w-5 h-5 text-yellow-600 mt-0.5\" />\n            <div className=\"text-sm font-verdana text-yellow-800\">\n              Full refund will reverse cleaner earnings and may impact their reliability score.\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\disputes\\DisputeWindowEnforcement.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\disputes\\FileDisputeForm.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\email\\CampaignDefinitions.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\email\\CampaignScheduler.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\email\\EmailCampaignCron.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\email\\EmailCampaignScheduler.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'now' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":47,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"now"},"fix":{"range":[1177,1200],"text":""},"desc":"Remove unused variable 'now'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\n\n/**\n * Process and send scheduled email campaigns\n * Run this via cron every day\n */\nexport async function processEmailCampaigns() {\n  console.log('üìß Starting email campaign processing...');\n  \n  try {\n    const campaigns = await base44.entities.EmailCampaign.filter({ is_active: true });\n    \n    let emailsSent = 0;\n    let errors = 0;\n    \n    for (const campaign of campaigns) {\n      try {\n        const result = await processCampaign(campaign);\n        emailsSent += result.sent;\n        errors += result.errors;\n      } catch (error) {\n        console.error(`Error processing campaign ${campaign.campaign_name}:`, error);\n        errors++;\n      }\n    }\n    \n    console.log(`‚úÖ Email campaign processing complete: ${emailsSent} sent, ${errors} errors`);\n    \n    return {\n      success: true,\n      emailsSent,\n      errors\n    };\n  } catch (error) {\n    console.error('‚ùå Critical error in email campaign processing:', error);\n    return {\n      success: false,\n      error: error.message\n    };\n  }\n}\n\nasync function processCampaign(campaign) {\n  let sent = 0;\n  let errors = 0;\n  const now = new Date();\n  \n  // Find users who should receive this campaign\n  let eligibleUsers = [];\n  \n  switch (campaign.trigger_event) {\n    case 'booking_completed':\n      eligibleUsers = await findUsersWithCompletedBookings();\n      break;\n    case 'signup_no_booking':\n      eligibleUsers = await findUsersWithNoBookings();\n      break;\n    case 'second_booking_completed':\n      eligibleUsers = await findUsersWithTwoBookings();\n      break;\n    case 'referred_friend':\n      eligibleUsers = await findUsersWhoReferred();\n      break;\n  }\n  \n  for (const user of eligibleUsers) {\n    try {\n      // Check if user already received emails from this campaign\n      const sentEmails = await base44.entities.EmailCampaignSent.filter({\n        user_email: user.email,\n        campaign_name: campaign.campaign_name\n      });\n      \n      // Find next email to send\n      const nextEmailIndex = sentEmails.length;\n      \n      if (nextEmailIndex >= campaign.emails.length) {\n        continue; // All emails sent\n      }\n      \n      const nextEmail = campaign.emails[nextEmailIndex];\n      \n      // Check if it's time to send (delay_days after trigger)\n      const shouldSend = await checkIfShouldSend(user, campaign, nextEmail, sentEmails);\n      \n      if (shouldSend) {\n        await sendCampaignEmail(user, campaign, nextEmail, nextEmailIndex);\n        sent++;\n      }\n    } catch (error) {\n      console.error(`Error sending to ${user.email}:`, error);\n      errors++;\n    }\n  }\n  \n  return { sent, errors };\n}\n\nasync function findUsersWithCompletedBookings() {\n  const completedBookings = await base44.entities.Booking.filter({ \n    status: 'completed',\n    review_submitted: false\n  });\n  \n  const uniqueUsers = new Set();\n  const users = [];\n  \n  for (const booking of completedBookings) {\n    if (!uniqueUsers.has(booking.client_email)) {\n      uniqueUsers.add(booking.client_email);\n      const [userObj] = await base44.entities.User.filter({ email: booking.client_email });\n      if (userObj) {\n        users.push({ \n          email: booking.client_email, \n          triggerDate: booking.updated_date,\n          bookingId: booking.id\n        });\n      }\n    }\n  }\n  \n  return users;\n}\n\nasync function findUsersWithNoBookings() {\n  const allUsers = await base44.entities.User.filter({ user_type: 'client' });\n  const users = [];\n  \n  for (const user of allUsers) {\n    const bookings = await base44.entities.Booking.filter({ client_email: user.email });\n    \n    if (bookings.length === 0) {\n      const signupDate = new Date(user.created_date);\n      const daysSinceSignup = (Date.now() - signupDate) / (1000 * 60 * 60 * 24);\n      \n      // Only target users who signed up 3+ days ago\n      if (daysSinceSignup >= 3) {\n        users.push({ \n          email: user.email, \n          triggerDate: user.created_date \n        });\n      }\n    }\n  }\n  \n  return users;\n}\n\nasync function findUsersWithTwoBookings() {\n  const allBookings = await base44.entities.Booking.filter({ status: 'completed' });\n  const userBookingCounts = {};\n  \n  for (const booking of allBookings) {\n    if (!userBookingCounts[booking.client_email]) {\n      userBookingCounts[booking.client_email] = [];\n    }\n    userBookingCounts[booking.client_email].push(booking);\n  }\n  \n  const users = [];\n  for (const [email, bookings] of Object.entries(userBookingCounts)) {\n    if (bookings.length === 2) {\n      users.push({ \n        email, \n        triggerDate: bookings[1].updated_date \n      });\n    }\n  }\n  \n  return users;\n}\n\nasync function findUsersWhoReferred() {\n  const referrals = await base44.entities.Referral.filter({ \n    status: 'completed',\n    referrer_reward_issued: true\n  });\n  \n  const users = [];\n  for (const referral of referrals) {\n    users.push({ \n      email: referral.referrer_email, \n      triggerDate: referral.updated_date \n    });\n  }\n  \n  return users;\n}\n\nasync function checkIfShouldSend(user, campaign, email, sentEmails) {\n  const now = new Date();\n  const triggerDate = new Date(user.triggerDate);\n  const daysSinceTrigger = (now - triggerDate) / (1000 * 60 * 60 * 24);\n  \n  // Check if enough days have passed since trigger\n  if (daysSinceTrigger < email.delay_days) {\n    return false;\n  }\n  \n  // Check if we already sent this specific email\n  const alreadySent = sentEmails.some(s => s.email_index === sentEmails.length);\n  if (alreadySent) {\n    return false;\n  }\n  \n  return true;\n}\n\nasync function sendCampaignEmail(user, campaign, email, emailIndex) {\n  const baseUrl = typeof window !== 'undefined' ? window.location.origin : 'https://puretask.com';\n  \n  // Replace placeholders in email\n  const personalizedBody = email.body\n    .replace('{{user_email}}', user.email)\n    .replace('{{cta_url}}', `${baseUrl}${email.cta_url || createPageUrl('BrowseCleaners')}`);\n  \n  await base44.integrations.Core.SendEmail({\n    to: user.email,\n    subject: email.subject,\n    body: personalizedBody\n  });\n  \n  // Record that we sent this email\n  await base44.entities.EmailCampaignSent.create({\n    user_email: user.email,\n    campaign_name: campaign.campaign_name,\n    email_index: emailIndex,\n    sent_at: new Date().toISOString()\n  });\n  \n  console.log(`‚úâÔ∏è  Sent \"${email.subject}\" to ${user.email}`);\n}\n\n/**\n * Initialize default email campaigns\n * Run this once to seed the database\n */\nexport async function initializeDefaultCampaigns() {\n  const campaigns = [\n    {\n      campaign_name: 'Post-Booking Follow-up',\n      trigger_event: 'booking_completed',\n      is_active: true,\n      emails: [\n        {\n          delay_days: 1,\n          subject: '‚ù§Ô∏è How was your cleaning?',\n          body: `Hi there!\n\nWe hope you loved your cleaning yesterday! \n\nWould you mind leaving a quick review for your cleaner? It helps them grow their business and helps other clients find great cleaners.\n\n{{cta_url}}\n\nThank you!\nThe PureTask Team`,\n          cta_text: 'Leave a Review',\n          cta_url: '/BookingHistory'\n        },\n        {\n          delay_days: 7,\n          subject: 'üßπ Ready for another cleaning?',\n          body: `Hi again!\n\nIt's been a week since your last cleaning. Ready to book again?\n\nBook the same cleaner you loved, or try someone new!\n\n{{cta_url}}\n\nBest,\nThe PureTask Team`,\n          cta_text: 'Book Again',\n          cta_url: '/BrowseCleaners'\n        }\n      ]\n    },\n    {\n      campaign_name: 'Signup Nurture',\n      trigger_event: 'signup_no_booking',\n      is_active: true,\n      emails: [\n        {\n          delay_days: 3,\n          subject: 'üëã Ready to book your first cleaning?',\n          body: `Hi!\n\nWe noticed you signed up but haven't booked yet. \n\nHere's what makes PureTask different:\n‚úÖ GPS-verified check-ins\n‚úÖ Before/after photo proof\n‚úÖ Vetted, rated cleaners\n‚úÖ Flexible scheduling\n\nReady to get started?\n\n{{cta_url}}\n\nQuestions? Just reply to this email!\n\nThe PureTask Team`,\n          cta_text: 'Browse Cleaners',\n          cta_url: '/BrowseCleaners'\n        },\n        {\n          delay_days: 7,\n          subject: 'üíö Get 10% off your first booking',\n          body: `Still thinking about it?\n\nWe'd love to help you experience PureTask. Here's 10% off your first cleaning!\n\nUse code: WELCOME10\n\n{{cta_url}}\n\nThis offer expires in 48 hours!\n\nThe PureTask Team`,\n          cta_text: 'Book Now',\n          cta_url: '/BrowseCleaners'\n        }\n      ]\n    },\n    {\n      campaign_name: 'Subscription Upsell',\n      trigger_event: 'second_booking_completed',\n      is_active: true,\n      emails: [\n        {\n          delay_days: 3,\n          subject: 'üí∞ Save 20% with a subscription',\n          body: `Congratulations on your second cleaning!\n\nSince you're a repeat customer, you might love our subscription plans:\n\n‚úÖ Save 20% on every cleaning\n‚úÖ Same cleaner every time\n‚úÖ Never worry about booking\n‚úÖ Pause anytime\n\n{{cta_url}}\n\nWorth checking out!\n\nThe PureTask Team`,\n          cta_text: 'View Plans',\n          cta_url: '/BrowseCleaners'\n        }\n      ]\n    },\n    {\n      campaign_name: 'Referral Reminder',\n      trigger_event: 'referred_friend',\n      is_active: true,\n      emails: [\n        {\n          delay_days: 14,\n          subject: 'üéÅ You earned $20! Share again?',\n          body: `Great news! Your referral just completed their first booking.\n\nYou earned $20 in credits!\n\nWant to earn more? Share your referral link again:\n\n{{cta_url}}\n\nYou get $20, they get $20. Win-win!\n\nThe PureTask Team`,\n          cta_text: 'Get Referral Link',\n          cta_url: '/Profile'\n        }\n      ]\n    }\n  ];\n  \n  for (const campaign of campaigns) {\n    const existing = await base44.entities.EmailCampaign.filter({ \n      campaign_name: campaign.campaign_name \n    });\n    \n    if (existing.length === 0) {\n      await base44.entities.EmailCampaign.create(campaign);\n      console.log(`‚úÖ Created campaign: ${campaign.campaign_name}`);\n    }\n  }\n  \n  console.log('‚ú® Email campaigns initialized');\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\favorites\\FavoriteButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\featureFlags\\FeatureFlagService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\gps\\CheckInPromptModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[208,255],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[208,254],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"fix":{"range":[263,271],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[264,271],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":5,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":48,"fix":{"range":[289,302],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[289,302],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { MapPin, Navigation, Clock, AlertCircle } from 'lucide-react';\nimport GPSCheckIn from './GPSCheckIn';\n\n/**\n * Modal prompt for GPS check-in/check-out with location validation\n */\nexport default function CheckInPromptModal({ \n  booking, \n  open, \n  onClose, \n  onCheckInComplete,\n  onCheckOutComplete \n}) {\n  const [shouldShow, setShouldShow] = useState(false);\n\n  useEffect(() => {\n    if (!booking) {\n      setShouldShow(false);\n      return;\n    }\n\n    // Always show if explicitly opened (manual check-in/out)\n    if (open) {\n      setShouldShow(true);\n      return;\n    }\n\n    // Auto-show logic for check-in reminder\n    if (!booking.check_in_time) {\n      const now = new Date();\n      const jobDateTime = new Date(`${booking.date}T${booking.start_time}`);\n      const timeDiff = (jobDateTime - now) / (1000 * 60); // minutes\n\n      if (timeDiff <= 15 && timeDiff >= -30) {\n        setShouldShow(true);\n      }\n    }\n  }, [booking, open]);\n\n  const handleCheckInComplete = (checkInData) => {\n    if (onCheckInComplete) onCheckInComplete(checkInData);\n    onClose();\n  };\n\n  const handleCheckOutComplete = (checkOutData) => {\n    if (onCheckOutComplete) onCheckOutComplete(checkOutData);\n    onClose();\n  };\n\n  const isCheckingOut = booking?.check_in_time && booking?.status !== 'completed';\n\n  return (\n    <Dialog open={open && shouldShow} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Navigation className=\"w-6 h-6 text-emerald-600\" />\n            {isCheckingOut ? 'Check Out & Complete Job' : 'Check In to Start Job'}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          <Alert className={`${isCheckingOut ? 'bg-blue-50 border-blue-200' : 'bg-emerald-50 border-emerald-200'}`}>\n            <Clock className={`w-4 h-4 ${isCheckingOut ? 'text-blue-600' : 'text-emerald-600'}`} />\n            <AlertDescription className={isCheckingOut ? 'text-blue-900' : 'text-emerald-900'}>\n              {isCheckingOut \n                ? 'Please check out to record your completion time and finalize the job.'\n                : 'Please check in to confirm you have arrived at the location.'}\n            </AlertDescription>\n          </Alert>\n\n          {booking && (\n            <div className=\"grid grid-cols-2 gap-4 p-4 bg-slate-50 rounded-lg\">\n              <div>\n                <p className=\"text-sm text-slate-600\">Address</p>\n                <p className=\"font-semibold text-slate-900 text-sm\">{booking.address}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-slate-600\">Scheduled Time</p>\n                <p className=\"font-semibold text-slate-900\">{booking.start_time}</p>\n              </div>\n              {booking.check_in_time && (\n                <div className=\"col-span-2\">\n                  <p className=\"text-sm text-slate-600\">Checked In At</p>\n                  <p className=\"font-semibold text-emerald-700\">\n                    {new Date(booking.check_in_time).toLocaleTimeString()}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          <GPSCheckIn\n            booking={booking}\n            onCheckInComplete={handleCheckInComplete}\n            onCheckOutComplete={handleCheckOutComplete}\n          />\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\gps\\GPSCheckIn.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":23,"fix":{"range":[309,316],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[308,315],"text":""},"desc":"Remove unused variable 'Clock'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { MapPin, Clock, CheckCircle, AlertTriangle, Loader2, AlertCircle } from 'lucide-react';\nimport { validateGPSLocation, getCurrentPosition, formatDistance, getValidationStatusColor } from './GPSValidator';\nimport { analytics } from '../analytics/AnalyticsService';\nimport toast from 'react-hot-toast'; // Assuming react-hot-toast is installed and configured\n\nexport default function GPSCheckIn({ booking, onCheckInComplete, onCheckOutComplete }) {\n  const [loading, setLoading] = useState(false);\n  const [position, setPosition] = useState(null);\n  const [validationResult, setValidationResult] = useState(null);\n  const [error, setError] = useState('');\n\n  // Determine if the current action is checking out\n  const isCheckingOut = booking?.check_in_time && !booking?.check_out_time;\n\n  useEffect(() => {\n    // If checking out and no position is set, attempt to get location automatically.\n    // This provides a better UX for checkout. For check-in, we typically want explicit action.\n    if (isCheckingOut && !position) {\n      handleGetLocation();\n    }\n  }, [isCheckingOut, position]); // Re-run if isCheckingOut changes or position is cleared\n\n  const handleGetLocation = async () => {\n    setLoading(true);\n    setError('');\n    setValidationResult(null);\n    setPosition(null); // Clear previous position\n\n    try {\n      const currentPosition = await getCurrentPosition();\n      setPosition(currentPosition);\n\n      // Validate against job location\n      const validation = validateGPSLocation(\n        currentPosition,\n        {\n          latitude: booking.latitude,\n          longitude: booking.longitude\n        }\n      );\n\n      setValidationResult(validation);\n\n      if (!validation.valid) {\n        setError(validation.message);\n      }\n\n    } catch (err) {\n      setError(err.message || 'Failed to get location. Please ensure location services are enabled.');\n    }\n\n    setLoading(false);\n  };\n\n  const handleCheckIn = async () => {\n    if (!validationResult?.valid) {\n      setError('You must be within 250m of the job location to check in.');\n      return;\n    }\n\n    setLoading(true);\n    setError(''); // Clear any previous errors\n\n    try {\n      const checkInData = {\n        check_in_time: new Date().toISOString(),\n        check_in_location: JSON.stringify({\n          latitude: position.latitude,\n          longitude: position.longitude,\n          accuracy: position.accuracy,\n          distance_from_job: validationResult.distance,\n          timestamp: position.timestamp\n        }),\n        status: 'in_progress'\n      };\n\n      await base44.entities.Booking.update(booking.id, checkInData);\n\n      // Create event\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'check_in',\n        user_email: booking.cleaner_email,\n        details: `Checked in at ${formatDistance(validationResult.distance)} from job site`,\n        timestamp: new Date().toISOString()\n      });\n\n      analytics.cleaner('check_in', {\n        booking_id: booking.id,\n        distance_from_job: validationResult.distance,\n        accuracy: position.accuracy\n      });\n\n      toast.success('Successfully checked in!');\n\n      if (onCheckInComplete) {\n        onCheckInComplete(checkInData);\n      }\n\n    } catch (err) {\n      console.error('Check-in error:', err);\n      setError('Failed to check in. Please try again.');\n    }\n\n    setLoading(false);\n  };\n\n  const handleCheckOut = async () => {\n    if (!validationResult?.valid) {\n      setError('You must be within 250m of the job location to check out.');\n      return;\n    }\n\n    setLoading(true);\n    setError(''); // Clear any previous errors\n\n    try {\n      const checkInTime = new Date(booking.check_in_time);\n      const checkOutTime = new Date();\n      const durationMs = checkOutTime - checkInTime;\n      const durationHours = durationMs / (1000 * 60 * 60);\n      const actualHours = Math.ceil(durationHours * 4) / 4; // Round up to nearest 0.25h\n\n      const checkOutData = {\n        check_out_time: checkOutTime.toISOString(),\n        check_out_location: JSON.stringify({\n          latitude: position.latitude,\n          longitude: position.longitude,\n          accuracy: position.accuracy,\n          distance_from_job: validationResult.distance,\n          timestamp: position.timestamp\n        }),\n        actual_hours: actualHours,\n        status: 'completed'\n      };\n\n      await base44.entities.Booking.update(booking.id, checkOutData);\n\n      // Create event\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'check_out',\n        user_email: booking.cleaner_email,\n        details: `Checked out after ${actualHours}h at ${formatDistance(validationResult.distance)} from job site`,\n        timestamp: new Date().toISOString()\n      });\n\n      analytics.cleaner('check_out', {\n        booking_id: booking.id,\n        actual_hours: actualHours,\n        distance_from_job: validationResult.distance\n      });\n\n      toast.success(`Job completed! Worked ${actualHours} hours.`);\n\n      if (onCheckOutComplete) {\n        onCheckOutComplete(checkOutData);\n      }\n\n    } catch (err) {\n      console.error('Check-out error:', err);\n      setError('Failed to check out. Please try again.');\n    }\n\n    setLoading(false);\n  };\n\n  // Determine the status color for the UI\n  const statusColor = validationResult\n    ? getValidationStatusColor(validationResult.valid, validationResult.distance)\n    : 'slate';\n\n  // Prevent actions if booking or required details are missing\n  if (!booking || !booking.latitude || !booking.longitude) {\n    return (\n      <Card className=\"border-0 shadow-xl\">\n        <CardHeader className=\"bg-gradient-to-r from-red-50 to-red-100\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <AlertTriangle className=\"w-6 h-6 text-red-600\" />\n            GPS Check-In/Out Error\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <Alert className=\"border-red-200 bg-red-50\">\n            <AlertDescription className=\"text-red-900\">\n              <p>Booking details (latitude/longitude) are missing. Cannot perform GPS operations.</p>\n            </AlertDescription>\n          </Alert>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className={`bg-gradient-to-r from-${statusColor}-50 to-${statusColor}-100`}>\n        <CardTitle className=\"flex items-center gap-2\">\n          <MapPin className={`w-6 h-6 text-${statusColor}-600`} />\n          GPS {isCheckingOut ? 'Check-Out' : 'Check-In'}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-4\">\n        {/* Instructions */}\n        <Alert className={`border-${statusColor}-200 bg-${statusColor}-50`}>\n          <AlertDescription className={`text-${statusColor}-900`}>\n            {isCheckingOut ? (\n              <div>\n                <p className=\"font-semibold mb-1\">Ready to check out?</p>\n                <p className=\"text-sm\">Verify your location to complete the job.</p>\n              </div>\n            ) : (\n              <div>\n                <p className=\"font-semibold mb-1\">Before you start cleaning:</p>\n                <p className=\"text-sm\">You must be within 250m of the job location to check in.</p>\n              </div>\n            )}\n          </AlertDescription>\n        </Alert>\n\n        {/* Get Location Button - Only show if location hasn't been obtained yet or if there's an error */}\n        {!position || error ? (\n          <Button\n            onClick={handleGetLocation}\n            disabled={loading}\n            className=\"w-full bg-system hover:bg-system/90 text-white font-heading font-semibold\"\n            size=\"lg\"\n          >\n            {loading ? (\n              <>\n                <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                Getting Location...\n              </>\n            ) : (\n              <>\n                <MapPin className=\"w-5 h-5 mr-2\" />\n                Get My Location\n              </>\n            )}\n          </Button>\n        ) : null}\n\n        {/* Validation Result */}\n        {validationResult && position && (\n          <div className=\"space-y-3\">\n            <Alert className={`border-${statusColor}-200 bg-${statusColor}-50`}>\n              <AlertDescription className={`text-${statusColor}-900`}>\n                <div className=\"flex items-start gap-2\">\n                  {validationResult.valid ? (\n                    <CheckCircle className={`w-5 h-5 text-${statusColor}-600 mt-0.5`} />\n                  ) : (\n                    <AlertCircle className={`w-5 h-5 text-${statusColor}-600 mt-0.5`} />\n                  )}\n                  <div>\n                    <p className=\"font-semibold\">{validationResult.message}</p>\n                    <div className=\"mt-2 text-sm space-y-1\">\n                      <p>Distance: <strong>{formatDistance(validationResult.distance)}</strong></p>\n                      <p>GPS Accuracy: <strong>{Math.round(position.accuracy)}m</strong></p>\n                    </div>\n                  </div>\n                </div>\n              </AlertDescription>\n            </Alert>\n\n            {validationResult.valid ? (\n              <Button\n                onClick={isCheckingOut ? handleCheckOut : handleCheckIn}\n                disabled={loading}\n                className={`w-full bg-${statusColor}-500 hover:bg-${statusColor}-600 text-white`}\n                size=\"lg\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle className=\"w-5 h-5 mr-2\" />\n                    Confirm {isCheckingOut ? 'Check-Out' : 'Check-In'}\n                  </>\n                )}\n              </Button>\n            ) : (\n              // If not valid, show a \"Try Again\" button\n              <Button\n                onClick={handleGetLocation}\n                disabled={loading}\n                variant=\"outline\"\n                className=\"w-full\"\n                size=\"lg\"\n              >\n                <MapPin className=\"w-5 h-5 mr-2\" />\n                Try Again\n              </Button>\n            )}\n          </div>\n        )}\n\n        {/* Error Display */}\n        {error && !validationResult?.valid && (\n          <Alert className=\"border-red-200 bg-red-50\">\n            <AlertDescription className=\"text-red-900\">\n              <div className=\"flex items-start gap-2\">\n                <AlertCircle className=\"w-5 h-5 text-red-600 mt-0.5\" />\n                <p>{error}</p>\n              </div>\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Job Location Info */}\n        <div className=\"pt-4 border-t\">\n          <p className=\"text-sm text-slate-600 mb-2\">Job Location:</p>\n          <p className=\"text-sm font-medium text-slate-900\">{booking.address}</p>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\gps\\GPSExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\gps\\GPSValidator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\home\\ImageCarousel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\insurance\\InsuranceAddon.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingPrice' is defined but never used. Allowed unused args must match /^_/u.","line":16,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":54,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingPrice"},"fix":{"range":[519,532],"text":""},"desc":"Remove unused variable 'bookingPrice'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { Shield, CheckCircle, AlertCircle } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\n\nexport default function InsuranceAddon({ bookingPrice, onInsuranceChange }) {\n  const [selected, setSelected] = useState(false);\n  const insuranceFee = 7; // Fixed $7 fee\n\n  const handleToggle = (checked) => {\n    setSelected(checked);\n    onInsuranceChange(checked, insuranceFee);\n  };\n\n  return (\n    <Card className=\"border-2 border-blue-300 bg-gradient-to-r from-blue-50 to-cyan-50\">\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-start gap-4\">\n          <Checkbox\n            id=\"insurance\"\n            checked={selected}\n            onCheckedChange={handleToggle}\n            className=\"mt-1\"\n          />\n          <div className=\"flex-1\">\n            <Label htmlFor=\"insurance\" className=\"text-lg font-semibold text-slate-900 cursor-pointer flex items-center gap-2\">\n              <Shield className=\"w-5 h-5 text-blue-600\" />\n              PureTask Protect\n              <Badge className=\"bg-blue-600 text-white ml-2\">+${insuranceFee}</Badge>\n            </Label>\n            <p className=\"text-sm text-slate-600 mt-1 mb-4\">\n              Complete peace of mind for your cleaning\n            </p>\n\n            <div className=\"grid md:grid-cols-2 gap-3 mb-4\">\n              <div className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-slate-900\">Damage Protection</p>\n                  <p className=\"text-slate-600\">Up to $500</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-slate-900\">Lost Items</p>\n                  <p className=\"text-slate-600\">Up to $300</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-slate-900\">No-Show Protection</p>\n                  <p className=\"text-slate-600\">Free replacement</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-slate-900\">Instant Refund</p>\n                  <p className=\"text-slate-600\">If unsatisfied</p>\n                </div>\n              </div>\n            </div>\n\n            <Dialog>\n              <DialogTrigger asChild>\n                <Button variant=\"link\" className=\"text-blue-600 p-0 h-auto text-sm\">\n                  View full coverage details\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"max-w-lg\">\n                <DialogHeader>\n                  <DialogTitle className=\"flex items-center gap-2\">\n                    <Shield className=\"w-6 h-6 text-blue-600\" />\n                    PureTask Protect Coverage\n                  </DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <div>\n                    <h4 className=\"font-semibold text-slate-900 mb-2\">What's Covered:</h4>\n                    <ul className=\"space-y-2\">\n                      <li className=\"flex items-start gap-2 text-sm\">\n                        <CheckCircle className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span><strong>Accidental Damage:</strong> Up to $500 for items damaged during cleaning</span>\n                      </li>\n                      <li className=\"flex items-start gap-2 text-sm\">\n                        <CheckCircle className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span><strong>Lost/Stolen Items:</strong> Up to $300 for items that go missing</span>\n                      </li>\n                      <li className=\"flex items-start gap-2 text-sm\">\n                        <CheckCircle className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span><strong>No-Show Protection:</strong> Free same-day replacement cleaner</span>\n                      </li>\n                      <li className=\"flex items-start gap-2 text-sm\">\n                        <CheckCircle className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span><strong>Satisfaction Guarantee:</strong> Instant refund if you're not happy</span>\n                      </li>\n                    </ul>\n                  </div>\n\n                  <div className=\"bg-amber-50 rounded-lg p-4 border border-amber-200\">\n                    <div className=\"flex items-start gap-2\">\n                      <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-sm text-amber-900\">\n                        <p className=\"font-semibold mb-1\">How Claims Work:</p>\n                        <ul className=\"list-disc list-inside space-y-1\">\n                          <li>Claims under $100 are auto-approved instantly</li>\n                          <li>Larger claims reviewed within 24 hours</li>\n                          <li>Submit via the app with photos</li>\n                        </ul>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"text-xs text-slate-500\">\n                    <p>* Claims must be submitted within 48 hours of cleaning completion. See full terms and conditions for exclusions and limits.</p>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\insurance\\InsuranceExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[213,260],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[213,259],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Shield, ChevronDown, AlertCircle, CheckCircle2, DollarSign } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function InsuranceExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <Card className=\"border-2 border-green-200 bg-green-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Shield className=\"w-5 h-5 text-green-600\" />\n            Damage Protection Insurance\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              {/* Coverage */}\n              <div className=\"bg-white rounded-xl p-4 border-2 border-green-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <CheckCircle2 className=\"w-5 h-5 text-green-600\" />\n                  What's Covered\n                </h4>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Accidental Damage:</strong> Up to $2,500 per incident</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Broken Items:</strong> Furniture, electronics, decorations</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Property Damage:</strong> Walls, floors, fixtures</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-green-600 font-bold\">‚úì</span>\n                    <p><strong>Fast Claims:</strong> 24-48 hour processing</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Pricing */}\n              <div className=\"bg-blue-50 rounded-xl p-4 border-2 border-blue-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <DollarSign className=\"w-5 h-5 text-blue-600\" />\n                  Simple Pricing\n                </h4>\n                <div className=\"bg-white rounded-lg p-3 text-center\">\n                  <p className=\"text-xs text-gray-600 font-verdana mb-1\">Add to any booking for:</p>\n                  <p className=\"text-3xl font-fredoka font-bold text-blue-600\">$5</p>\n                  <p className=\"text-xs text-gray-500 font-verdana mt-1\">One-time fee per booking</p>\n                </div>\n              </div>\n\n              {/* How Claims Work */}\n              <div className=\"bg-yellow-50 rounded-xl p-4 border-2 border-yellow-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3\">How Claims Work</h4>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-yellow-700 font-bold\">1.</span>\n                    <p>File a claim within <strong>24 hours</strong> of damage</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-yellow-700 font-bold\">2.</span>\n                    <p>Upload photos and description of damage</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-yellow-700 font-bold\">3.</span>\n                    <p>Our team reviews and approves within 48 hours</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-yellow-700 font-bold\">4.</span>\n                    <p>Compensation issued as credits or direct payment</p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-green-50 border-l-4 border-green-400 p-3 rounded text-xs text-green-800 font-verdana\">\n                <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n                <strong>Peace of Mind:</strong> All cleaners are screened, but accidents happen. Insurance protects you!\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\DailyScheduleView.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":5,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":35,"fix":{"range":[227,239],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[226,238],"text":""},"desc":"Remove unused variable 'DollarSign'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Clock, MapPin, DollarSign, Calendar, Eye, Home, Bed, Bath } from 'lucide-react';\nimport { format, parseISO, isToday } from 'date-fns';\nimport { motion } from 'framer-motion';\n\nexport default function DailyScheduleView({ jobs, selectedDate, onSelectJob, myJobIds = [] }) {\n  const displayDate = selectedDate || new Date();\n  \n  // Filter jobs for selected date - Handle both available and claimed jobs\n  const dayJobs = jobs.filter(job => {\n    try {\n      const jobDate = parseISO(job.date);\n      return format(jobDate, 'yyyy-MM-dd') === format(displayDate, 'yyyy-MM-dd');\n    } catch {\n      return false;\n    }\n  }).sort((a, b) => a.start_time.localeCompare(b.start_time));\n\n  // Group by time slots\n  const timeSlots = [\n    { label: 'Morning (6 AM - 12 PM)', start: '06:00', end: '12:00' },\n    { label: 'Afternoon (12 PM - 5 PM)', start: '12:00', end: '17:00' },\n    { label: 'Evening (5 PM - 10 PM)', start: '17:00', end: '22:00' }\n  ];\n\n  const getJobsForSlot = (start, end) => {\n    return dayJobs.filter(job => job.start_time >= start && job.start_time < end);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Calendar className=\"w-6 h-6 text-blue-500\" />\n          My Schedule for {format(displayDate, 'EEEE, MMMM d, yyyy')}\n          {isToday(displayDate) && (\n            <Badge className=\"ml-2 bg-emerald-500\">Today</Badge>\n          )}\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {dayJobs.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <Calendar className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n            <p className=\"text-lg text-slate-500\">No jobs scheduled for this day</p>\n            <p className=\"text-sm text-slate-400 mt-2\">Browse available jobs to claim more work</p>\n          </div>\n        ) : (\n          <>\n            {timeSlots.map(slot => {\n              const slotJobs = getJobsForSlot(slot.start, slot.end);\n              if (slotJobs.length === 0) return null;\n\n              return (\n                <div key={slot.label}>\n                  <h3 className=\"font-semibold text-slate-700 mb-3 flex items-center gap-2\">\n                    <Clock className=\"w-4 h-4\" />\n                    {slot.label}\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {slotJobs.map((job, index) => {\n                      const isMine = myJobIds.includes(job.id);\n                      return (\n                        <motion.div\n                          key={job.id}\n                          initial={{ opacity: 0, x: -20 }}\n                          animate={{ opacity: 1, x: 0 }}\n                          transition={{ delay: index * 0.1 }}\n                        >\n                          <Card className={`${isMine ? 'border-emerald-500 bg-emerald-50' : 'border-slate-200'}`}>\n                            <CardContent className=\"p-4\">\n                              <div className=\"flex items-start justify-between\">\n                                <div className=\"flex-1\">\n                                  <div className=\"flex items-center gap-2 mb-2\">\n                                    <Clock className=\"w-4 h-4 text-blue-500\" />\n                                    <span className=\"font-semibold text-slate-900\">{job.start_time}</span>\n                                    <span className=\"text-slate-500\">‚Ä¢</span>\n                                    <span className=\"text-slate-600\">{job.hours}h</span>\n                                    {isMine && (\n                                      <Badge className=\"bg-emerald-500\">Your Job</Badge>\n                                    )}\n                                  </div>\n                                  <div className=\"flex items-start gap-2 text-sm text-slate-600 mb-2\">\n                                    <MapPin className=\"w-4 h-4 mt-0.5 flex-shrink-0\" />\n                                    <span className=\"line-clamp-1\">{job.address}</span>\n                                  </div>\n                                  \n                                  {/* Property Details */}\n                                  <div className=\"flex items-center gap-3 mb-2 text-xs text-slate-500\">\n                                    <span className=\"flex items-center gap-1\">\n                                      <Home className=\"w-3 h-3\" />\n                                      {job.home_type || 'N/A'}\n                                    </span>\n                                    <span className=\"flex items-center gap-1\">\n                                      <Bed className=\"w-3 h-3\" />\n                                      {job.bedrooms || 0} bed\n                                    </span>\n                                    <span className=\"flex items-center gap-1\">\n                                      <Bath className=\"w-3 h-3\" />\n                                      {job.bathrooms || 0} bath\n                                    </span>\n                                  </div>\n                                  \n                                  <div className=\"flex flex-wrap gap-1\">\n                                    {job.tasks?.slice(0, 3).map((task, idx) => (\n                                      <Badge key={idx} variant=\"outline\" className=\"text-xs\">\n                                        {task.replace(/_/g, ' ')}\n                                      </Badge>\n                                    ))}\n                                    {job.tasks && job.tasks.length > 3 && (\n                                      <Badge variant=\"outline\" className=\"text-xs\">\n                                        +{job.tasks.length - 3} more\n                                      </Badge>\n                                    )}\n                                  </div>\n                                </div>\n                                <div className=\"text-right ml-4\">\n                                  <p className=\"text-xl font-bold text-emerald-600 mb-2\">\n                                    ${job.total_price}\n                                  </p>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => onSelectJob(job)}\n                                  >\n                                    <Eye className=\"w-4 h-4 mr-1\" />\n                                    View\n                                  </Button>\n                                </div>\n                              </div>\n                            </CardContent>\n                          </Card>\n                        </motion.div>\n                      );\n                    })}\n                  </div>\n                </div>\n              );\n            })}\n          </>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\InJobIssueReporter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":28,"fix":{"range":[221,233],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[220,232],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'getServiceIcon' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":24,"fix":{"range":[431,447],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"getServiceIcon"},"fix":{"range":[432,447],"text":""},"desc":"Remove unused variable 'getServiceIcon'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isRecommended' is assigned a value but never used. Allowed unused args must match /^_/u.","line":15,"column":82,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":95,"suggestions":[{"messageId":"removeVar","data":{"varName":"isRecommended"},"fix":{"range":[573,596],"text":""},"desc":"Remove unused variable 'isRecommended'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'showPayHighlight' is assigned a value but never used. Allowed unused args must match /^_/u.","line":15,"column":123,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":139,"suggestions":[{"messageId":"removeVar","data":{"varName":"showPayHighlight"},"fix":{"range":[614,640],"text":""},"desc":"Remove unused variable 'showPayHighlight'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":26,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":37,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":19}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport {\n  MapPin, Clock, DollarSign, Home, Bed, Bath,\n  Maximize, Eye, Zap, Briefcase\n} from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { getServiceIcon, ServiceBadge } from '../utils/serviceIcons';\n\nexport default function JobCard({ job, index, onSelect, onClaim, isMine = false, isRecommended = false, isUrgent = false, showPayHighlight = false }) {\n  const [isClaimed, setIsClaimed] = useState(isMine);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  const handleOptimisticClaim = async () => {\n    setIsAnimating(true);\n    setIsClaimed(true);\n\n    try {\n      await onClaim(job.id);\n      toast.success('Job claimed successfully!');\n    } catch (error) {\n      setIsClaimed(false);\n      toast.error('Failed to claim job. Please try again.');\n    }\n    setIsAnimating(false);\n  };\n\n  const getFormattedDate = () => {\n    try {\n      const parsedDate = typeof job.date === 'string' ? parseISO(job.date) : new Date(job.date);\n      return format(parsedDate, 'EEE, MMM d');\n    } catch (error) {\n      return job.date;\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ delay: index * 0.05 }}\n      whileHover={{ y: -4 }}\n    >\n      <Card className={`border-0 shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden cursor-pointer ${\n        isClaimed ? 'ring-2 ring-emerald-500' : ''\n      }`} onClick={() => onSelect(job)}>\n        {isUrgent && (\n          <div className=\"bg-gradient-to-r from-amber-400 to-orange-500 px-4 py-2 flex items-center justify-center gap-2\">\n            <Zap className=\"w-4 h-4 text-white\" />\n            <span className=\"text-white font-semibold text-sm\">Today - Act Fast!</span>\n          </div>\n        )}\n\n        <CardContent className=\"p-6\">\n          {/* Date & Time */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-2\">\n              <Clock className=\"w-5 h-5 text-blue-500\" />\n              <div>\n                <p className=\"font-semibold text-slate-900\">{getFormattedDate()}</p>\n                <p className=\"text-sm text-slate-600\">{job.start_time} ‚Ä¢ {job.hours}h</p>\n              </div>\n            </div>\n            <div className=\"text-right\">\n              <p className=\"text-2xl font-bold text-emerald-600\">${job.total_price}</p>\n              <p className=\"text-xs text-slate-500\">${(job.total_price / job.hours).toFixed(0)}/hr</p>\n            </div>\n          </div>\n\n          {/* Address */}\n          <div className=\"flex items-start gap-2 mb-4\">\n            <MapPin className=\"w-4 h-4 text-emerald-500 mt-1 flex-shrink-0\" />\n            <p className=\"text-sm text-slate-700 line-clamp-2\">{job.address}</p>\n          </div>\n\n          {/* Property Details */}\n          <div className=\"grid grid-cols-4 gap-2 mb-4\">\n            <div className=\"text-center bg-slate-50 rounded p-2\">\n              <Bed className=\"w-4 h-4 text-slate-600 mx-auto mb-1\" />\n              <p className=\"text-xs font-semibold\">{job.bedrooms || 0}</p>\n            </div>\n            <div className=\"text-center bg-slate-50 rounded p-2\">\n              <Bath className=\"w-4 h-4 text-slate-600 mx-auto mb-1\" />\n              <p className=\"text-xs font-semibold\">{job.bathrooms || 0}</p>\n            </div>\n            <div className=\"text-center bg-slate-50 rounded p-2\">\n              <Maximize className=\"w-4 h-4 text-slate-600 mx-auto mb-1\" />\n              <p className=\"text-xs font-semibold\">{job.square_feet || 'N/A'}</p>\n            </div>\n            <div className=\"text-center bg-slate-50 rounded p-2\">\n              <Home className=\"w-4 h-4 text-slate-600 mx-auto mb-1\" />\n              <p className=\"text-xs font-semibold capitalize\">{job.home_type?.slice(0, 4) || 'N/A'}</p>\n            </div>\n          </div>\n\n          {/* Tasks with NEW icon system */}\n          {job.tasks && job.tasks.length > 0 && (\n            <div className=\"mb-4\">\n              <p className=\"text-xs text-slate-500 mb-2 uppercase font-semibold\">Services</p>\n              <div className=\"flex flex-wrap gap-2\">\n                {job.tasks.slice(0, 3).map((task, idx) => (\n                  <ServiceBadge key={idx} serviceName={task} size=\"small\" />\n                ))}\n                {job.tasks.length > 3 && (\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    +{job.tasks.length - 3} more\n                  </Badge>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Action Buttons with Animation */}\n          <div className=\"flex gap-2\">\n            <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className=\"flex-1\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={(e) => { e.stopPropagation(); onSelect(job); }}\n                className=\"w-full\"\n              >\n                <Eye className=\"w-4 h-4 mr-2\" />\n                Details\n              </Button>\n            </motion.div>\n            {!isClaimed && onClaim && (\n              <motion.div\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                animate={isAnimating ? { scale: [1, 1.05, 1] } : {}}\n                transition={{ duration: 0.3 }}\n                className=\"flex-1\"\n              >\n                <Button\n                  size=\"sm\"\n                  onClick={(e) => { e.stopPropagation(); handleOptimisticClaim(); }}\n                  className=\"w-full bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700\"\n                  disabled={isAnimating}\n                >\n                  <Briefcase className=\"w-4 h-4 mr-2\" />\n                  Claim\n                </Button>\n              </motion.div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobCardWithCheckIn.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobDetailsFullModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":6,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":26,"fix":{"range":[238,245],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[237,244],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":6,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":54,"fix":{"range":[267,273],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[266,272],"text":""},"desc":"Remove unused variable 'User'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Briefcase' is defined but never used.","line":6,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":71,"fix":{"range":[279,290],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Briefcase"},"fix":{"range":[278,289],"text":""},"desc":"Remove unused variable 'Briefcase'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Phone' is defined but never used.","line":6,"column":85,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":90,"fix":{"range":[302,309],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Phone"},"fix":{"range":[301,308],"text":""},"desc":"Remove unused variable 'Phone'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { X, MapPin, Clock, Calendar, DollarSign, User, Home, Briefcase, Navigation, Phone, MessageSquare, CheckCircle, Camera } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { motion } from 'framer-motion';\nimport { Dialog, DialogContent, DialogHeader } from '@/components/ui/dialog';\n\nexport default function JobDetailsFullModal({ job, onClose, onStartJob, onCompleteJob }) {\n  const [showFullMap, setShowFullMap] = useState(false);\n\n  if (!job) return null;\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'scheduled': return 'bg-blue-500 text-white';\n      case 'cleaning_now': return 'bg-green-500 text-white';\n      case 'in_progress': return 'bg-purple-500 text-white';\n      case 'awaiting_cleaner': return 'bg-amber-500 text-white';\n      case 'completed': return 'bg-emerald-500 text-white';\n      default: return 'bg-slate-500 text-white';\n    }\n  };\n\n  const getStatusLabel = (status) => {\n    const labels = {\n      'scheduled': 'Scheduled',\n      'cleaning_now': 'Cleaning Now',\n      'in_progress': 'In Progress',\n      'awaiting_cleaner': 'Awaiting Confirmation',\n      'completed': 'Completed'\n    };\n    return labels[status] || status;\n  };\n\n  const openInGoogleMaps = () => {\n    if (job.latitude && job.longitude) {\n      window.open(`https://www.google.com/maps/dir/?api=1&destination=${job.latitude},${job.longitude}`, '_blank');\n    } else {\n      window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(job.address)}`, '_blank');\n    }\n  };\n\n  // Google Maps Static API for preview\n  const mapImageUrl = job.latitude && job.longitude\n    ? `https://maps.googleapis.com/maps/api/staticmap?center=${job.latitude},${job.longitude}&zoom=15&size=600x300&markers=color:red%7C${job.latitude},${job.longitude}&key=YOUR_GOOGLE_MAPS_API_KEY`\n    : null;\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-hidden p-0 rounded-xl flex flex-col\">\n        <motion.div\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.3 }}\n          className=\"flex flex-col h-full\"\n        >\n          {/* Header */}\n          <DialogHeader className=\"sticky top-0 bg-gradient-to-r from-blue-500 to-cyan-600 text-white p-6 flex items-start justify-between rounded-t-xl z-10\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-3 mb-2\">\n                <Calendar className=\"w-6 h-6\" />\n                <h2 className=\"text-2xl font-bold\">\n                  {format(parseISO(job.date), 'EEEE, MMMM d, yyyy')}\n                </h2>\n              </div>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={onClose}\n              className=\"text-white hover:bg-white/20\"\n            >\n              <X className=\"w-6 h-6\" />\n            </Button>\n          </DialogHeader>\n\n          <div className=\"p-6 space-y-6 flex-1 overflow-y-auto\">\n            {/* Location Section with Map */}\n            <motion.div\n              initial={{ opacity: 0, x: -10 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.05, duration: 0.3 }}\n            >\n              <Card className=\"border-2 border-blue-200 bg-blue-50/50\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-blue-900\">\n                    <MapPin className=\"w-5 h-5\" />\n                    Location\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"bg-white p-4 rounded-lg\">\n                    <p className=\"font-medium text-slate-900 mb-1\">{job.address}</p>\n                    {job.latitude && job.longitude && (\n                      <p className=\"text-sm text-slate-500\">\n                        GPS: {job.latitude.toFixed(6)}, {job.longitude.toFixed(6)}\n                      </p>\n                    )}\n                  </div>\n\n                  {/* Map Preview */}\n                  {mapImageUrl && (\n                    <div className=\"relative\">\n                      <img\n                        src={mapImageUrl}\n                        alt=\"Location Map\"\n                        className=\"w-full h-48 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity\"\n                        onClick={() => setShowFullMap(!showFullMap)}\n                      />\n                      <div className=\"absolute top-2 right-2\">\n                        <Badge className=\"bg-white text-slate-900 shadow-lg\">\n                          Click to expand\n                        </Badge>\n                      </div>\n                    </div>\n                  )}\n\n                  <Button\n                    onClick={openInGoogleMaps}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                  >\n                    <Navigation className=\"w-4 h-4 mr-2\" />\n                    Get Directions in Google Maps\n                  </Button>\n\n                  {job.parking_instructions && (\n                    <div className=\"bg-amber-50 border border-amber-200 p-3 rounded-lg\">\n                      <p className=\"text-sm font-medium text-amber-900 mb-1\">Parking Instructions:</p>\n                      <p className=\"text-sm text-amber-800\">{job.parking_instructions}</p>\n                    </div>\n                  )}\n\n                  {job.entry_instructions && (\n                    <div className=\"bg-blue-50 border border-blue-200 p-3 rounded-lg\">\n                      <p className=\"text-sm font-medium text-blue-900 mb-1\">Entry Instructions:</p>\n                      <p className=\"text-sm text-blue-800\">{job.entry_instructions}</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Payment Info */}\n            <motion.div\n              initial={{ opacity: 0, x: -10 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.1, duration: 0.3 }}\n            >\n              <Card className=\"border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <DollarSign className=\"w-5 h-5 text-green-600\" />\n                    Payment\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-slate-600\">Total</span>\n                      <span className=\"text-2xl font-bold text-slate-900\">${job.total_price.toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between items-center text-sm\">\n                      <span className=\"text-slate-600\">Your Earnings (85%)</span>\n                      <span className=\"font-semibold text-green-600\">${(job.total_price * 0.85).toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between items-center text-sm\">\n                      <span className=\"text-slate-600\">Platform Fee (15%)</span>\n                      <span className=\"text-slate-500\">${(job.total_price * 0.15).toFixed(2)}</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Date & Time (New Card - extracted from old header) */}\n            <motion.div\n              initial={{ opacity: 0, x: 10 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.2, duration: 0.3 }}\n            >\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-5 h-5 text-blue-600\" />\n                    Job Schedule & Status\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-slate-600\">Date</span>\n                      <span className=\"font-medium\">{format(parseISO(job.date), 'MMMM d, yyyy')}</span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-slate-600\">Start Time</span>\n                      <span className=\"font-medium\">{job.start_time}</span>\n                    </div>\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-slate-600\">Duration</span>\n                      <span className=\"font-medium\">{job.hours} hours</span>\n                    </div>\n                    <div className=\"flex justify-between items-center pt-2 border-t mt-2\">\n                      <span className=\"text-slate-600\">Status</span>\n                      <Badge className={getStatusColor(job.status)}>\n                        {getStatusLabel(job.status)}\n                      </Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Property Info */}\n            <motion.div\n              initial={{ opacity: 0, x: -10 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: 0.3, duration: 0.3 }}\n            >\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Home className=\"w-5 h-5 text-purple-600\" />\n                    Property Details\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-slate-600\">Type</span>\n                      <span className=\"font-medium capitalize\">{job.home_type || 'N/A'}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-slate-600\">Bedrooms</span>\n                      <span className=\"font-medium\">{job.bedrooms || 'N/A'}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-slate-600\">Bathrooms</span>\n                      <span className=\"font-medium\">{job.bathrooms || 'N/A'}</span>\n                    </div>\n                    {job.square_feet && (\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-slate-600\">Square Feet</span>\n                        <span className=\"font-medium\">{job.square_feet} sq ft</span>\n                      </div>\n                    )}\n                    {job.has_pets && (\n                      <div className=\"flex items-center gap-2 pt-2 border-t\">\n                        <Badge className=\"bg-amber-100 text-amber-800\">\n                          Pets Present\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            {/* Tasks */}\n            {job.tasks && job.tasks.length > 0 && (\n              <motion.div\n                initial={{ opacity: 0, x: 10 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: 0.4, duration: 0.3 }}\n              >\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600\" />\n                      Tasks to Complete\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid md:grid-cols-2 gap-2\">\n                      {job.tasks.map((task, idx) => (\n                        <div key={idx} className=\"flex items-center gap-2 bg-slate-50 p-3 rounded-lg\">\n                          <CheckCircle className=\"w-4 h-4 text-emerald-500\" />\n                          <span className=\"text-sm font-medium text-slate-700\">{task}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            )}\n\n            {/* Special Instructions */}\n            {(job.product_allergies || job.product_preferences || job.notes) && (\n              <motion.div\n                initial={{ opacity: 0, x: -10 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: 0.5, duration: 0.3 }}\n              >\n                <Card className=\"border-2 border-amber-200 bg-amber-50/50\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-amber-900\">\n                      <MessageSquare className=\"w-5 h-5\" />\n                      Special Instructions & Preferences\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    {job.product_allergies && (\n                      <div className=\"bg-white p-3 rounded-lg\">\n                        <p className=\"text-sm font-semibold text-red-700 mb-1\">‚ö†Ô∏è Product Allergies:</p>\n                        <p className=\"text-sm text-slate-700\">{job.product_allergies}</p>\n                      </div>\n                    )}\n                    {job.product_preferences && (\n                      <div className=\"bg-white p-3 rounded-lg\">\n                        <p className=\"text-sm font-semibold text-blue-700 mb-1\">Product Preferences:</p>\n                        <p className=\"text-sm text-slate-700\">{job.product_preferences}</p>\n                      </div>\n                    )}\n                    {job.notes && (\n                      <div className=\"bg-white p-3 rounded-lg\">\n                        <p className=\"text-sm font-semibold text-slate-700 mb-1\">Additional Notes:</p>\n                        <p className=\"text-sm text-slate-700\">{job.notes}</p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            )}\n          </div>\n\n          {/* Action Buttons */}\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.6, duration: 0.3 }}\n            className=\"p-6 pt-4 border-t bg-white sticky bottom-0 z-10 flex gap-3\"\n          >\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              className=\"flex-1\"\n            >\n              Close\n            </Button>\n            {job.status === 'scheduled' && onStartJob && (\n              <Button\n                onClick={() => onStartJob(job)}\n                className=\"flex-1 bg-green-600 hover:bg-green-700\"\n              >\n                <CheckCircle className=\"w-4 h-4 mr-2\" />\n                Check In & Start Job\n              </Button>\n            )}\n            {(job.status === 'cleaning_now' || job.status === 'in_progress') && onCompleteJob && (\n              <Button\n                onClick={() => onCompleteJob(job)}\n                className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\n              >\n                <Camera className=\"w-4 h-4 mr-2\" />\n                Complete & Upload Photos\n              </Button>\n            )}\n          </motion.div>\n        </motion.div>\n      </DialogContent>\n\n      {/* Full Map Modal */}\n      {showFullMap && mapImageUrl && (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-[60] p-4\"\n          onClick={() => setShowFullMap(false)}\n        >\n          <motion.div\n            initial={{ scale: 0.95 }}\n            animate={{ scale: 1 }}\n            exit={{ scale: 0.95 }}\n            className=\"relative max-w-6xl w-full\"\n          >\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setShowFullMap(false)}\n              className=\"absolute top-2 right-2 bg-white text-slate-900 hover:bg-slate-100 z-10\"\n            >\n              <X className=\"w-6 h-6\" />\n            </Button>\n            <img\n              src={mapImageUrl}\n              alt=\"Full Map\"\n              className=\"w-full h-auto rounded-lg\"\n            />\n          </motion.div>\n        </motion.div>\n      )}\n    </Dialog>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobDetailsModal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":2,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":39,"fix":{"range":[54,66],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[53,65],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":2,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":50,"fix":{"range":[65,76],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[65,76],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":8,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":20,"fix":{"range":[349,355],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[348,354],"text":""},"desc":"Remove unused variable 'User'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Shield' is defined but never used.","line":9,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":21,"fix":{"range":[408,416],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Shield"},"fix":{"range":[407,415],"text":""},"desc":"Remove unused variable 'Shield'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Camera' is defined but never used.","line":9,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":39,"fix":{"range":[425,433],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Camera"},"fix":{"range":[425,433],"text":""},"desc":"Remove unused variable 'Camera'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":5,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  MapPin, Clock, DollarSign, Home, Bed, Bath, Maximize,\n  X, Calendar, User, Briefcase, CheckCircle, AlertTriangle,\n  Navigation, Shield, Sparkles, Camera\n} from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport { ServiceBadge } from '../utils/serviceIcons';\nimport { motion } from 'framer-motion';\n\nexport default function JobDetailsModal({ job, onClose, onClaim, canClaim = true, isMine = false }) {\n  if (!job) return null;\n\n  const formattedDate = format(parseISO(job.date), 'EEEE, MMMM d, yyyy');\n\n  const openInGoogleMaps = () => {\n    if (job.latitude && job.longitude) {\n      window.open(`https://www.google.com/maps/dir/?api=1&destination=${job.latitude},${job.longitude}`, '_blank');\n    } else {\n      window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(job.address)}`, '_blank');\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={onClose}>\n      <motion.div\n        initial={{ scale: 0.95, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0.95, opacity: 0 }}\n        className=\"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header with gradient */}\n        <div className=\"sticky top-0 bg-gradient-to-r from-emerald-500 to-green-600 text-white p-6 rounded-t-2xl flex items-start justify-between z-10\">\n          <div className=\"flex-1\">\n            <div className=\"flex items-center gap-3 mb-2\">\n              <Calendar className=\"w-6 h-6\" />\n              <h2 className=\"text-2xl font-bold\">{formattedDate}</h2>\n            </div>\n            <div className=\"flex items-center gap-4 text-white/90\">\n              <div className=\"flex items-center gap-2\">\n                <Clock className=\"w-4 h-4\" />\n                <span>{convertTo12Hour(job.start_time)}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Briefcase className=\"w-4 h-4\" />\n                <span>{job.hours} Hour{job.hours !== 1 ? 's' : ''}</span>\n              </div>\n            </div>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={onClose}\n            className=\"text-white hover:bg-white/20\"\n          >\n            <X className=\"w-6 h-6\" />\n          </Button>\n        </div>\n\n        <div className=\"p-6 space-y-6\">\n          {/* Status Alert */}\n          {isMine && (\n            <Alert className=\"bg-emerald-50 border-emerald-200\">\n              <CheckCircle className=\"w-4 h-4 text-emerald-600\" />\n              <AlertDescription className=\"text-emerald-900 font-semibold\">\n                You've Claimed This Job!\n              </AlertDescription>\n            </Alert>\n          )}\n\n          {/* Top Grid: Payment + Property */}\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {/* Payment Card */}\n            <Card className=\"border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <DollarSign className=\"w-6 h-6 text-emerald-600\" />\n                  <h3 className=\"text-lg font-bold text-slate-900\">Your Earnings</h3>\n                </div>\n                <div className=\"text-center py-4\">\n                  <p className=\"text-5xl font-black text-emerald-600 mb-2\">\n                    ${(job.total_price * 0.85).toFixed(2)}\n                  </p>\n                  <p className=\"text-sm text-slate-600 mb-1\">85% Of Total</p>\n                  <p className=\"text-xs text-slate-500\">Total: ${job.total_price.toFixed(2)} (15% Platform Fee)</p>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Property Details Card */}\n            <Card className=\"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-cyan-50\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <Home className=\"w-6 h-6 text-blue-600\" />\n                  <h3 className=\"text-lg font-bold text-slate-900\">Property Details</h3>\n                </div>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"text-center p-3 bg-white rounded-lg\">\n                    <Bed className=\"w-6 h-6 text-slate-600 mx-auto mb-2\" />\n                    <p className=\"text-2xl font-bold text-slate-900\">{job.bedrooms || 0}</p>\n                    <p className=\"text-xs text-slate-500\">Bedrooms</p>\n                  </div>\n                  <div className=\"text-center p-3 bg-white rounded-lg\">\n                    <Bath className=\"w-6 h-6 text-slate-600 mx-auto mb-2\" />\n                    <p className=\"text-2xl font-bold text-slate-900\">{job.bathrooms || 0}</p>\n                    <p className=\"text-xs text-slate-500\">Bathrooms</p>\n                  </div>\n                  <div className=\"text-center p-3 bg-white rounded-lg\">\n                    <Maximize className=\"w-6 h-6 text-slate-600 mx-auto mb-2\" />\n                    <p className=\"text-2xl font-bold text-slate-900\">{job.square_feet || 'N/A'}</p>\n                    <p className=\"text-xs text-slate-500\">Sq Ft</p>\n                  </div>\n                  <div className=\"text-center p-3 bg-white rounded-lg\">\n                    <Home className=\"w-6 h-6 text-slate-600 mx-auto mb-2\" />\n                    <p className=\"text-2xl font-bold text-slate-900 capitalize\">{job.home_type || 'N/A'}</p>\n                    <p className=\"text-xs text-slate-500\">Type</p>\n                  </div>\n                </div>\n                {job.has_pets && (\n                  <Badge className=\"mt-3 w-full justify-center bg-amber-100 text-amber-800\">\n                    üêæ Pets Present\n                  </Badge>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Location Section */}\n          <Card className=\"border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-indigo-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <MapPin className=\"w-6 h-6 text-purple-600\" />\n                <h3 className=\"text-lg font-bold text-slate-900\">Location & Access</h3>\n              </div>\n              \n              <div className=\"bg-white p-4 rounded-xl mb-4\">\n                <p className=\"font-semibold text-slate-900 text-lg\">{job.address}</p>\n                {job.latitude && job.longitude && (\n                  <p className=\"text-sm text-slate-500 mt-1\">\n                    GPS: {job.latitude.toFixed(6)}, {job.longitude.toFixed(6)}\n                  </p>\n                )}\n              </div>\n\n              <Button\n                onClick={openInGoogleMaps}\n                className=\"w-full bg-purple-600 hover:bg-purple-700 mb-4\"\n              >\n                <Navigation className=\"w-4 h-4 mr-2\" />\n                Get Directions In Google Maps\n              </Button>\n\n              {job.parking_instructions && (\n                <div className=\"bg-amber-50 border-2 border-amber-200 p-4 rounded-lg mb-3\">\n                  <p className=\"text-sm font-bold text-amber-900 mb-1\">üÖøÔ∏è Parking Instructions:</p>\n                  <p className=\"text-sm text-amber-800\">{job.parking_instructions}</p>\n                </div>\n              )}\n\n              {job.entry_instructions && (\n                <div className=\"bg-blue-50 border-2 border-blue-200 p-4 rounded-lg\">\n                  <p className=\"text-sm font-bold text-blue-900 mb-1\">üîë Entry Instructions:</p>\n                  <p className=\"text-sm text-blue-800\">{job.entry_instructions}</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Services/Tasks Section */}\n          <Card className=\"border-2 border-slate-200\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <Sparkles className=\"w-6 h-6 text-indigo-600\" />\n                <h3 className=\"text-lg font-bold text-slate-900\">Services Requested</h3>\n              </div>\n              \n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                {job.tasks?.map((task, idx) => (\n                  <ServiceBadge key={idx} serviceName={task} size=\"default\" className=\"justify-center py-3\" />\n                ))}\n              </div>\n\n              {job.task_quantities && Object.keys(job.task_quantities).length > 0 && (\n                <div className=\"mt-4 p-4 bg-slate-50 rounded-lg\">\n                  <p className=\"text-sm font-bold text-slate-700 mb-2\">üìã Quantities:</p>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {Object.entries(job.task_quantities).map(([key, value]) => (\n                      <div key={key} className=\"flex justify-between text-sm\">\n                        <span className=\"text-slate-600 capitalize\">{key.replace(/_/g, ' ')}:</span>\n                        <span className=\"font-semibold text-slate-900\">{value}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Special Instructions */}\n          {(job.notes || job.product_allergies || job.product_preferences) && (\n            <Card className=\"border-2 border-amber-200 bg-amber-50/50\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                  <AlertTriangle className=\"w-6 h-6 text-amber-600\" />\n                  <h3 className=\"text-lg font-bold text-amber-900\">Special Instructions & Preferences</h3>\n                </div>\n\n                <div className=\"space-y-3\">\n                  {job.product_allergies && (\n                    <Alert className=\"bg-red-50 border-red-300\">\n                      <AlertTriangle className=\"w-4 h-4 text-red-600\" />\n                      <AlertDescription>\n                        <p className=\"font-bold text-red-900 mb-1\">‚ö†Ô∏è Product Allergies:</p>\n                        <p className=\"text-red-800\">{job.product_allergies}</p>\n                      </AlertDescription>\n                    </Alert>\n                  )}\n\n                  {job.product_preferences && (\n                    <div className=\"bg-green-50 border-2 border-green-200 p-4 rounded-lg\">\n                      <p className=\"text-sm font-bold text-green-900 mb-1\">‚ú® Product Preferences:</p>\n                      <p className=\"text-sm text-green-800\">{job.product_preferences}</p>\n                    </div>\n                  )}\n\n                  {job.notes && (\n                    <div className=\"bg-blue-50 border-2 border-blue-200 p-4 rounded-lg\">\n                      <p className=\"text-sm font-bold text-blue-900 mb-1\">üìù Additional Notes:</p>\n                      <p className=\"text-sm text-blue-800\">{job.notes}</p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex gap-3 pt-4 border-t-2 border-slate-200\">\n            <Button variant=\"outline\" onClick={onClose} className=\"flex-1\" size=\"lg\">\n              Close\n            </Button>\n            {!isMine && canClaim && onClaim && (\n              <Button \n                onClick={() => onClaim(job.id)} \n                className=\"flex-1 bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white\"\n                size=\"lg\"\n              >\n                <Briefcase className=\"w-5 h-5 mr-2\" />\n                Claim This Job\n              </Button>\n            )}\n          </div>\n        </div>\n      </motion.div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobEndCheckOut.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobMapPreview.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobPhotoUpload.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobStartCheckIn.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobSummaryModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobTaskChecklist.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":36,"fix":{"range":[24,35],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[24,35],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Checkbox' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18,"fix":{"range":[133,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Checkbox"},"fix":{"range":[133,185],"text":""},"desc":"Remove unused variable 'Checkbox'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { CheckSquare, Square } from 'lucide-react';\n\nexport default function JobTaskChecklist({ booking }) {\n  const [completedTasks, setCompletedTasks] = useState([]);\n\n  const getDefaultTasks = () => {\n    const tasks = [];\n    \n    if (booking.cleaning_type === 'basic') {\n      tasks.push(\n        'Dust all surfaces',\n        'Vacuum all floors',\n        'Mop hard floors',\n        'Clean kitchen counters and sink',\n        'Clean bathrooms (toilets, sinks, showers)',\n        'Take out trash',\n        'Wipe down appliance exteriors'\n      );\n    } else if (booking.cleaning_type === 'deep') {\n      tasks.push(\n        'Dust all surfaces including baseboards',\n        'Vacuum all floors and carpets',\n        'Mop all hard floors',\n        'Deep clean kitchen (counters, sink, stovetop)',\n        'Deep clean bathrooms (scrub tiles, grout)',\n        'Clean inside microwave',\n        'Wipe down all appliances',\n        'Clean light fixtures',\n        'Dust ceiling fans',\n        'Take out trash'\n      );\n    } else if (booking.cleaning_type === 'moveout') {\n      tasks.push(\n        'Deep clean all rooms',\n        'Clean inside all cabinets and drawers',\n        'Clean inside all appliances',\n        'Scrub all bathroom fixtures',\n        'Clean baseboards throughout',\n        'Clean all light fixtures',\n        'Vacuum and mop all floors',\n        'Clean windows and window sills',\n        'Remove all trash',\n        'Final walkthrough inspection'\n      );\n    }\n\n    // Add additional services tasks\n    if (booking.additional_services) {\n      if (booking.additional_services.windows > 0) {\n        tasks.push(`Clean ${booking.additional_services.windows} window(s)`);\n      }\n      if (booking.additional_services.blinds > 0) {\n        tasks.push(`Clean ${booking.additional_services.blinds} blind set(s)`);\n      }\n      if (booking.additional_services.oven > 0) {\n        tasks.push(`Deep clean ${booking.additional_services.oven} oven(s)`);\n      }\n      if (booking.additional_services.refrigerator > 0) {\n        tasks.push(`Clean inside ${booking.additional_services.refrigerator} refrigerator(s)`);\n      }\n      if (booking.additional_services.inside_cabinets > 0) {\n        tasks.push(`Clean inside ${booking.additional_services.inside_cabinets} cabinet section(s)`);\n      }\n      if (booking.additional_services.laundry > 0) {\n        tasks.push(`Complete ${booking.additional_services.laundry} load(s) of laundry`);\n      }\n    }\n\n    return tasks;\n  };\n\n  const tasks = booking.tasks || getDefaultTasks();\n\n  const toggleTask = (taskIndex) => {\n    if (completedTasks.includes(taskIndex)) {\n      setCompletedTasks(completedTasks.filter(i => i !== taskIndex));\n    } else {\n      setCompletedTasks([...completedTasks, taskIndex]);\n    }\n  };\n\n  const completionPercentage = tasks.length > 0 \n    ? Math.round((completedTasks.length / tasks.length) * 100) \n    : 0;\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <CheckSquare className=\"w-5 h-5 text-puretask-blue\" />\n            Task Checklist\n          </CardTitle>\n          <div className=\"text-right\">\n            <p className=\"text-2xl font-fredoka font-bold text-puretask-blue\">\n              {completionPercentage}%\n            </p>\n            <p className=\"text-xs text-gray-500 font-verdana\">\n              {completedTasks.length} of {tasks.length} complete\n            </p>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"mb-4 bg-gray-200 rounded-full h-2 overflow-hidden\">\n          <div \n            className=\"bg-puretask-blue h-full transition-all duration-300\"\n            style={{ width: `${completionPercentage}%` }}\n          />\n        </div>\n\n        <div className=\"space-y-3\">\n          {tasks.map((task, index) => (\n            <div \n              key={index}\n              className=\"flex items-start gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer\"\n              onClick={() => toggleTask(index)}\n            >\n              <div className=\"mt-0.5\">\n                {completedTasks.includes(index) ? (\n                  <CheckSquare className=\"w-5 h-5 text-fresh-mint\" />\n                ) : (\n                  <Square className=\"w-5 h-5 text-gray-400\" />\n                )}\n              </div>\n              <span \n                className={`font-verdana flex-1 ${\n                  completedTasks.includes(index) \n                    ? 'line-through text-gray-500' \n                    : 'text-gray-700'\n                }`}\n              >\n                {task}\n              </span>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobTimeline.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25,"fix":{"range":[12,26],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useState"},"fix":{"range":[12,26],"text":""},"desc":"Remove unused variable 'useState'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[157,169],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[156,168],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[168,179],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[168,179],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":7,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":35,"fix":{"range":[330,342],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[329,341],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Navigation' is defined but never used.","line":7,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":52,"fix":{"range":[347,359],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Navigation"},"fix":{"range":[346,358],"text":""},"desc":"Remove unused variable 'Navigation'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Camera' is defined but never used.","line":7,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":60,"fix":{"range":[359,367],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Camera"},"fix":{"range":[358,366],"text":""},"desc":"Remove unused variable 'Camera'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onReload' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":105,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":113,"suggestions":[{"messageId":"removeVar","data":{"varName":"onReload"},"fix":{"range":[724,734],"text":""},"desc":"Remove unused variable 'onReload'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'userEmail' is defined but never used. Allowed unused args must match /^_/u.","line":13,"column":115,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":124,"suggestions":[{"messageId":"removeVar","data":{"varName":"userEmail"},"fix":{"range":[734,745],"text":""},"desc":"Remove unused variable 'userEmail'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'idx' is defined but never used. Allowed unused args must match /^_/u.","line":114,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[4393,4398],"text":""},"desc":"Remove unused variable 'idx'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { MapPin, Clock, DollarSign, Eye, Navigation, Camera, CheckCircle, AlertCircle } from 'lucide-react';\nimport { format, parseISO, isToday, isTomorrow } from 'date-fns';\nimport { motion } from 'framer-motion';\nimport { convertTo12Hour } from '../utils/timeUtils';\nimport JobMapPreview from './JobMapPreview';\n\nexport default function JobTimeline({ jobs, inProgressJobs, completedJobs, onSelectJob, onStatusChange, onReload, userEmail }) {\n  const navigate = useNavigate();\n\n  const getDateLabel = (dateString) => {\n    const date = parseISO(dateString);\n    if (isToday(date)) return 'Today';\n    if (isTomorrow(date)) return 'Tomorrow';\n    return format(date, 'EEEE, MMMM d');\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'confirmed': return 'bg-green-500';\n      case 'pending_confirmation': return 'bg-amber-500';\n      case 'in_progress': return 'bg-blue-500';\n      case 'completed': return 'bg-slate-500';\n      default: return 'bg-slate-500';\n    }\n  };\n\n  // Group jobs by date\n  const groupJobsByDate = () => {\n    const grouped = {};\n    \n    jobs.forEach(job => {\n      const dateKey = job.date;\n      if (!grouped[dateKey]) {\n        grouped[dateKey] = [];\n      }\n      grouped[dateKey].push(job);\n    });\n\n    // Sort jobs within each date by start_time\n    Object.keys(grouped).forEach(date => {\n      grouped[date].sort((a, b) => a.start_time.localeCompare(b.start_time));\n    });\n\n    return grouped;\n  };\n\n  const groupedJobs = groupJobsByDate();\n  const sortedDates = Object.keys(groupedJobs).sort();\n\n  return (\n    <div className=\"space-y-8\">\n      {/* In Progress Jobs */}\n      {inProgressJobs.length > 0 && (\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2\">\n            <div className=\"w-3 h-3 bg-blue-500 rounded-full animate-pulse\"></div>\n            Currently Working\n          </h2>\n          <div className=\"space-y-4\">\n            {inProgressJobs.map((job) => (\n              <motion.div\n                key={job.id}\n                initial={{ opacity: 0, scale: 0.95 }}\n                animate={{ opacity: 1, scale: 1 }}\n              >\n                <Card className=\"border-2 border-blue-500 shadow-lg\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div>\n                        <Badge className=\"bg-blue-500 text-white mb-2\">IN PROGRESS</Badge>\n                        <h3 className=\"text-xl font-bold text-slate-900\">{format(parseISO(job.date), 'EEEE, MMMM d')}</h3>\n                        <p className=\"text-slate-600\">{convertTo12Hour(job.start_time)} ‚Ä¢ {job.hours} hours</p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold text-blue-600\">${(job.total_price * 0.85).toFixed(2)}</p>\n                        <p className=\"text-sm text-slate-500\">Your earnings</p>\n                      </div>\n                    </div>\n\n                    <JobMapPreview job={job} />\n\n                    <div className=\"mt-4 flex gap-2\">\n                      <Button\n                        onClick={() => onSelectJob(job)}\n                        className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\n                      >\n                        <Eye className=\"w-4 h-4 mr-2\" />\n                        View Details\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        onClick={() => onStatusChange(job, 'completed')}\n                        className=\"flex-1 text-green-600 border-green-300 hover:bg-green-50\"\n                      >\n                        <CheckCircle className=\"w-4 h-4 mr-2\" />\n                        Mark Complete\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Upcoming Jobs by Date */}\n      {sortedDates.map((date, idx) => (\n        <div key={date}>\n          <h2 className=\"text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2\">\n            <Clock className=\"w-6 h-6 text-emerald-500\" />\n            {getDateLabel(date)}\n          </h2>\n          <div className=\"space-y-4\">\n            {groupedJobs[date].map((job, jobIdx) => (\n              <motion.div\n                key={job.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: jobIdx * 0.1 }}\n              >\n                <Card className=\"border-0 shadow-lg hover:shadow-xl transition-shadow\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <Badge className={getStatusColor(job.status)}>\n                            {job.status.replace('_', ' ').toUpperCase()}\n                          </Badge>\n                          {job.status === 'pending_confirmation' && (\n                            <Badge variant=\"outline\" className=\"text-amber-600 border-amber-300 animate-pulse\">\n                              <AlertCircle className=\"w-3 h-3 mr-1\" />\n                              Needs Confirmation\n                            </Badge>\n                          )}\n                        </div>\n                        <h3 className=\"text-lg font-bold text-slate-900 mb-1\">\n                          {convertTo12Hour(job.start_time)} ‚Ä¢ {job.hours} hour{job.hours !== 1 ? 's' : ''}\n                        </h3>\n                        <div className=\"flex items-center gap-2 text-slate-600\">\n                          <MapPin className=\"w-4 h-4\" />\n                          <span className=\"text-sm\">{job.address}</span>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold text-emerald-600\">${(job.total_price * 0.85).toFixed(2)}</p>\n                        <p className=\"text-sm text-slate-500\">Your earnings</p>\n                      </div>\n                    </div>\n\n                    {/* Tasks */}\n                    {job.tasks && job.tasks.length > 0 && (\n                      <div className=\"mb-4\">\n                        <p className=\"text-sm font-semibold text-slate-700 mb-2\">Tasks:</p>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {job.tasks.map((task, idx) => (\n                            <Badge key={idx} variant=\"outline\">{task}</Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n\n                    <JobMapPreview job={job} />\n\n                    <div className=\"mt-4 flex gap-2\">\n                      <Button\n                        onClick={() => onSelectJob(job)}\n                        variant=\"outline\"\n                        className=\"flex-1\"\n                      >\n                        <Eye className=\"w-4 h-4 mr-2\" />\n                        View Full Details\n                      </Button>\n                      {job.status === 'pending_confirmation' && (\n                        <Button\n                          onClick={() => onStatusChange(job, 'confirmed')}\n                          className=\"flex-1 bg-emerald-600 hover:bg-emerald-700\"\n                        >\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\n                          Confirm Job\n                        </Button>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      ))}\n\n      {/* Empty State */}\n      {sortedDates.length === 0 && inProgressJobs.length === 0 && (\n        <Card className=\"border-0 shadow-lg\">\n          <CardContent className=\"p-12 text-center\">\n            <Clock className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n            <h3 className=\"text-xl font-bold text-slate-900 mb-2\">No Upcoming Jobs</h3>\n            <p className=\"text-slate-600 mb-4\">Browse available jobs to get started</p>\n            <Button onClick={() => navigate(createPageUrl('BrowseJobs'))}>\n              Browse Jobs\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Completed Jobs Summary */}\n      {completedJobs.length > 0 && (\n        <div>\n          <h2 className=\"text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2\">\n            <CheckCircle className=\"w-6 h-6 text-green-500\" />\n            Recently Completed\n          </h2>\n          <Card className=\"border-0 shadow-md bg-green-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-lg font-semibold text-slate-900\">\n                    {completedJobs.length} completed job{completedJobs.length !== 1 ? 's' : ''}\n                  </p>\n                  <p className=\"text-sm text-slate-600 mt-1\">\n                    Total earned: ${completedJobs.reduce((sum, j) => sum + (j.total_price * 0.85), 0).toFixed(2)}\n                  </p>\n                </div>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => navigate(createPageUrl('CleanerPayouts'))}\n                >\n                  View Payouts\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobsCalendarView.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"fix":{"range":[85,132],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[85,131],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":18,"fix":{"range":[189,199],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[190,199],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":5,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":26,"fix":{"range":[199,207],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[198,206],"text":""},"desc":"Remove unused variable 'MapPin'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Calendar, MapPin, Clock, DollarSign, ChevronLeft, ChevronRight } from 'lucide-react';\nimport { format, startOfMonth, endOfMonth, eachDayOfInterval, isSameDay, parseISO, startOfWeek, endOfWeek, addMonths, subMonths } from 'date-fns';\n\nexport default function JobsCalendarView({ jobs, onSelectJob, myJobIds = [] }) {\n  const [currentMonth, setCurrentMonth] = React.useState(new Date());\n\n  const monthStart = startOfMonth(currentMonth);\n  const monthEnd = endOfMonth(currentMonth);\n  const calendarStart = startOfWeek(monthStart);\n  const calendarEnd = endOfWeek(monthEnd);\n  const calendarDays = eachDayOfInterval({ start: calendarStart, end: calendarEnd });\n\n  const getJobsForDay = (day) => {\n    return jobs.filter(job => {\n      try {\n        return isSameDay(parseISO(job.date), day);\n      } catch {\n        return false;\n      }\n    });\n  };\n\n  const nextMonth = () => {\n    setCurrentMonth(addMonths(currentMonth, 1));\n  };\n\n  const prevMonth = () => {\n    setCurrentMonth(subMonths(currentMonth, 1));\n  };\n\n  const today = () => {\n    setCurrentMonth(new Date());\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardContent className=\"p-6\">\n        {/* Calendar Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-3\">\n            <Button variant=\"outline\" size=\"sm\" onClick={today}>\n              Today\n            </Button>\n            <Button variant=\"outline\" size=\"icon\" onClick={prevMonth}>\n              <ChevronLeft className=\"w-4 h-4\" />\n            </Button>\n            <h2 className=\"text-2xl font-bold text-slate-900\">\n              {format(currentMonth, 'MMMM yyyy')}\n            </h2>\n            <Button variant=\"outline\" size=\"icon\" onClick={nextMonth}>\n              <ChevronRight className=\"w-4 h-4\" />\n            </Button>\n          </div>\n          <div className=\"flex items-center gap-4 text-sm\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-4 h-4 rounded bg-emerald-500\"></div>\n              <span className=\"text-slate-600\">Your Jobs</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-4 h-4 rounded bg-blue-500\"></div>\n              <span className=\"text-slate-600\">Available</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Weekday Headers */}\n        <div className=\"grid grid-cols-7 gap-2 mb-2\">\n          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\n            <div key={day} className=\"text-center text-sm font-semibold text-slate-600 py-2\">\n              {day}\n            </div>\n          ))}\n        </div>\n\n        {/* Calendar Grid */}\n        <div className=\"grid grid-cols-7 gap-2\">\n          {calendarDays.map(day => {\n            const dayJobs = getJobsForDay(day);\n            const isCurrentMonth = day.getMonth() === currentMonth.getMonth();\n            const isToday = isSameDay(day, new Date());\n\n            return (\n              <div\n                key={day.toString()}\n                className={`min-h-24 p-2 rounded-lg border transition-all ${\n                  isToday ? 'border-emerald-500 bg-emerald-50 ring-2 ring-emerald-200' : 'border-slate-200'\n                } ${!isCurrentMonth ? 'bg-slate-50 opacity-50' : 'bg-white hover:shadow-md'}`}\n              >\n                <div className={`text-sm font-semibold mb-1 ${\n                  isToday ? 'text-emerald-700' : 'text-slate-700'\n                }`}>\n                  {format(day, 'd')}\n                </div>\n                <div className=\"space-y-1\">\n                  {dayJobs.slice(0, 3).map(job => {\n                    const isMine = myJobIds.includes(job.id);\n                    return (\n                      <button\n                        key={job.id}\n                        onClick={() => onSelectJob(job)}\n                        className={`w-full text-left p-1.5 rounded text-xs transition-all ${\n                          isMine \n                            ? 'bg-emerald-500 text-white hover:bg-emerald-600 shadow-sm' \n                            : 'bg-blue-100 text-blue-900 hover:bg-blue-200'\n                        }`}\n                      >\n                        <div className=\"font-semibold truncate flex items-center gap-1\">\n                          <Clock className=\"w-3 h-3\" />\n                          {job.start_time}\n                        </div>\n                        <div className=\"truncate flex items-center gap-1\">\n                          <DollarSign className=\"w-3 h-3\" />\n                          ${job.total_price}\n                        </div>\n                      </button>\n                    );\n                  })}\n                  {dayJobs.length > 3 && (\n                    <div className=\"text-xs text-slate-500 text-center font-medium\">\n                      +{dayJobs.length - 3} more\n                    </div>\n                  )}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\JobsMonthlyCalendar.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[123,170],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[123,169],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Briefcase' is defined but never used.","line":6,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":56,"fix":{"range":[263,274],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Briefcase"},"fix":{"range":[263,274],"text":""},"desc":"Remove unused variable 'Briefcase'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'getStatusLabel' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":39,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"getStatusLabel"},"fix":{"range":[1573,1903],"text":""},"desc":"Remove unused variable 'getStatusLabel'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { ChevronLeft, ChevronRight, Calendar, Briefcase } from 'lucide-react';\nimport { format, startOfMonth, endOfMonth, eachDayOfInterval, isSameDay, isSameMonth, addMonths, subMonths, startOfWeek, endOfWeek } from 'date-fns';\n\nexport default function JobsMonthlyCalendar({ jobs, onJobClick }) {\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n\n  const monthStart = startOfMonth(currentMonth);\n  const monthEnd = endOfMonth(currentMonth);\n  const calendarStart = startOfWeek(monthStart);\n  const calendarEnd = endOfWeek(monthEnd);\n  \n  const days = eachDayOfInterval({ start: calendarStart, end: calendarEnd });\n\n  const getJobsForDay = (day) => {\n    return jobs.filter(job => isSameDay(new Date(job.date), day));\n  };\n\n  const nextMonth = () => setCurrentMonth(addMonths(currentMonth, 1));\n  const prevMonth = () => setCurrentMonth(subMonths(currentMonth, 1));\n  const today = () => setCurrentMonth(new Date());\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'scheduled': return 'bg-blue-500';\n      case 'payment_hold': return 'bg-cyan-500';\n      case 'awaiting_cleaner': return 'bg-amber-500';\n      case 'cleaning_now': return 'bg-green-500';\n      case 'in_progress': return 'bg-purple-500';\n      case 'reschedule_requested': return 'bg-orange-500';\n      default: return 'bg-slate-400';\n    }\n  };\n\n  const getStatusLabel = (status) => {\n    const labels = {\n      'scheduled': 'Confirmed',\n      'payment_hold': 'Pending',\n      'awaiting_cleaner': 'Awaiting',\n      'cleaning_now': 'Active',\n      'in_progress': 'In Progress',\n      'reschedule_requested': 'Reschedule Requested'\n    };\n    return labels[status] || status;\n  };\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"w-6 h-6 text-blue-600\" />\n            {format(currentMonth, 'MMMM yyyy')}\n          </CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={today}>\n              Today\n            </Button>\n            <Button variant=\"outline\" size=\"icon\" onClick={prevMonth}>\n              <ChevronLeft className=\"w-4 h-4\" />\n            </Button>\n            <Button variant=\"outline\" size=\"icon\" onClick={nextMonth}>\n              <ChevronRight className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        {/* Day headers */}\n        <div className=\"grid grid-cols-7 gap-2 mb-2\">\n          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\n            <div key={day} className=\"text-center text-sm font-semibold text-slate-600 py-2\">\n              {day}\n            </div>\n          ))}\n        </div>\n\n        {/* Calendar days */}\n        <div className=\"grid grid-cols-7 gap-2\">\n          {days.map((day, idx) => {\n            const dayJobs = getJobsForDay(day);\n            const isToday = isSameDay(day, new Date());\n            const isCurrentMonth = isSameMonth(day, currentMonth);\n\n            return (\n              <div\n                key={idx}\n                className={`min-h-24 p-2 rounded-lg border transition-all ${\n                  isCurrentMonth ? 'bg-white border-slate-200' : 'bg-slate-50 border-slate-100'\n                } ${isToday ? 'ring-2 ring-blue-500 border-blue-500' : ''} ${\n                  dayJobs.length > 0 ? 'cursor-pointer hover:shadow-md' : ''\n                }`}\n              >\n                <div className={`text-sm font-medium mb-1 ${\n                  isCurrentMonth ? 'text-slate-900' : 'text-slate-400'\n                } ${isToday ? 'text-blue-600 font-bold' : ''}`}>\n                  {format(day, 'd')}\n                </div>\n                \n                {dayJobs.length > 0 && (\n                  <div className=\"space-y-1\">\n                    {dayJobs.slice(0, 3).map((job, jobIdx) => (\n                      <div\n                        key={jobIdx}\n                        onClick={() => onJobClick(job)}\n                        className={`${getStatusColor(job.status)} text-white text-xs px-2 py-1 rounded cursor-pointer hover:opacity-80 transition-opacity truncate`}\n                        title={`${job.start_time} - ${job.address}`}\n                      >\n                        {job.start_time}\n                      </div>\n                    ))}\n                    {dayJobs.length > 3 && (\n                      <div className=\"text-xs text-slate-500 text-center\">\n                        +{dayJobs.length - 3} more\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Legend */}\n        <div className=\"flex flex-wrap items-center gap-4 mt-6 pt-4 border-t border-slate-200\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-blue-500\"></div>\n            <span className=\"text-sm text-slate-600\">Confirmed</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-cyan-500\"></div>\n            <span className=\"text-sm text-slate-600\">Payment Held</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-amber-500\"></div>\n            <span className=\"text-sm text-slate-600\">Awaiting Confirmation</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-green-500\"></div>\n            <span className=\"text-sm text-slate-600\">Cleaning Now</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-purple-500\"></div>\n            <span className=\"text-sm text-slate-600\">In Progress</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded bg-orange-500\"></div>\n            <span className=\"text-sm text-slate-600\">Reschedule Requested</span>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\OnMyWayButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\jobs\\UpcomingWeekJobs.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\loyalty\\LOYALTY_PROGRAM_GUIDE.md.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected character ' '","line":1,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"# PureTask Loyalty Program Guide\n\n## üéÅ Rewards Catalog\n\n### 1. **10% Off Next Booking** (100 points)\n- Immediate 10% discount on next cleaning service\n- Valid for 30 days after redemption\n- Stackable with tier benefits\n\n### 2. **15% Off Next Booking** (200 points)\n- Immediate 15% discount on next cleaning service\n- Valid for 30 days after redemption\n- Great value for regular customers\n\n### 3. **20% Off Next Booking** (350 points)\n- Maximum discount reward - 20% off\n- Valid for 30 days after redemption\n- Best value for high-point earners\n\n### 4. **Free Add-On Service** (150 points)\n- One free add-on service (windows, oven, refrigerator, etc.)\n- Valid for 60 days\n- Choose any add-on worth up to $30\n\n### 5. **Priority Booking Pass** (250 points)\n- Jump to the front of the booking queue\n- Active for 7 days\n- Get access to premium time slots\n\n### 6. **Early Access to New Cleaners** (300 points)\n- Book with new Elite cleaners before public release\n- Valid for 14 days\n- Be the first to experience top talent\n\n---\n\n## üì± Automated Notifications Schedule\n\n### 1. **Points Earned Notification**\n**When:** Immediately after booking completion or qualifying action\n**Content:** \n- Points earned amount\n- Reason for earning\n- New total balance\n**Example:** \"+100 Loyalty Points! You earned 100 points for completing your booking. Total: 450 points\"\n\n### 2. **Tier Upgrade Notification**\n**When:** Immediately when crossing tier threshold\n**Content:**\n- New tier name\n- Congratulations message\n- List of new benefits unlocked\n**Priority:** High\n**Example:** \"üéâ Upgraded to Silver Tier! Congratulations! You've reached Silver tier. Enjoy 10% off every 5th booking, free add-ons, and priority support!\"\n\n### 3. **Reward Redeemed Notification**\n**When:** Immediately after redeeming a reward\n**Content:**\n- Reward name\n- Usage instructions\n- Expiration reminder\n**Example:** \"üéÅ Reward Redeemed! 15% Off Next Booking - Use within 30 days\"\n\n### 4. **Birthday Bonus Notification**\n**When:** Automatically on client's birthday (checked daily via cron)\n**Content:**\n- Birthday greeting\n- Bonus points awarded (100 points)\n- Personal touch\n**Priority:** High\n**Example:** \"üéÇ Happy Birthday! We added 100 bonus loyalty points to your account. Enjoy your special day!\"\n\n### 5. **Monthly Loyalty Summary**\n**When:** First day of each month (via scheduled function)\n**Content:**\n- Current tier status\n- Current point balance\n- Points needed for next tier\n- Available rewards reminder\n**Example:** \"üìä Your Monthly Loyalty Update: Gold Tier ‚Ä¢ 1,850 points ‚Ä¢ 150 points to Platinum tier\"\n\n### 6. **Reward Expiration Warning**\n**When:** 7 days before reward expires\n**Content:**\n- Reward name\n- Days remaining\n- Call to action to use it\n**Example:** \"‚è∞ Reward Expiring Soon! Your '20% Off Next Booking' expires in 7 days. Book now to use it!\"\n\n---\n\n## üéØ Tier Benefits Summary\n\n### Bronze (0-499 points)\n- 5% discount on 5th booking\n- Birthday bonus points\n\n### Silver (500-1,499 points)\n- 10% discount on every 5th booking\n- Free add-on service\n- Priority customer support\n\n### Gold (1,500-2,999 points)\n- 15% discount on every 5th booking\n- 2 free add-ons per month\n- Priority booking access\n- Early access to new cleaners\n\n### Platinum (3,000+ points)\n- 20% off ALL bookings\n- Free add-on with every booking\n- VIP priority support\n- Dedicated account manager\n- Exclusive perks and experiences\n\n---\n\n## üí∞ Points Earning Rules\n\n- **Complete a Booking:** 100 points\n- **First Booking Bonus:** 50 points (one-time)\n- **Submit a Review:** 25 points\n- **Refer a Friend:** 200 points (when they complete first booking)\n- **Birthday Bonus:** 100 points (automatic, once per year)\n- **Active Subscription:** 50 points per month\n\n---\n\n## üîÑ Integration Points\n\n### Booking System Integration\n- Points automatically awarded when booking status changes to \"approved\"\n- Rewards can be applied at checkout\n- Active rewards shown in booking flow\n\n### Profile Integration\n- Loyalty tier badge displayed on profile\n- Points balance visible in header/wallet\n- Tier progress bar in dashboard\n\n### Notification System\n- All loyalty events trigger notifications\n- In-app + email notifications\n- Push notifications for tier upgrades\n\n### Analytics Integration\n- Track redemption rates\n- Monitor tier distribution\n- Measure engagement with loyalty program","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\loyalty\\LoyaltyDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\loyalty\\LoyaltyExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'idx' is defined but never used. Allowed unused args must match /^_/u.","line":107,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[4379,4384],"text":""},"desc":"Remove unused variable 'idx'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Gift, Star, Trophy, ChevronDown, Zap, AlertCircle } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function LoyaltyExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  const tiers = [\n    {\n      name: 'Bronze',\n      threshold: 0,\n      color: 'bg-orange-700',\n      benefits: ['Earn 1 point per $1', 'Birthday bonus', 'Member support']\n    },\n    {\n      name: 'Silver',\n      threshold: 500,\n      color: 'bg-gray-400',\n      benefits: ['Earn 1.5 points per $1', '10% off rewards', 'Priority booking']\n    },\n    {\n      name: 'Gold',\n      threshold: 1500,\n      color: 'bg-yellow-500',\n      benefits: ['Earn 2 points per $1', '15% off rewards', 'Free add-ons', 'Early access']\n    },\n    {\n      name: 'Platinum',\n      threshold: 3000,\n      color: 'bg-purple-600',\n      benefits: ['Earn 3 points per $1', '20% off rewards', 'Premium perks', 'Exclusive deals']\n    }\n  ];\n\n  const rewards = [\n    { name: '10% Discount', points: 100, value: '$10+' },\n    { name: '15% Discount', points: 200, value: '$15+' },\n    { name: '20% Discount', points: 300, value: '$20+' },\n    { name: 'Free Add-On Service', points: 250, value: '$15+' },\n    { name: 'Priority Booking', points: 150, value: 'Skip the line' }\n  ];\n\n  return (\n    <Card className=\"border-2 border-yellow-200 bg-yellow-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Gift className=\"w-5 h-5 text-yellow-600\" />\n            Loyalty Rewards Program\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              {/* How to Earn */}\n              <div className=\"bg-white rounded-xl p-4 border-2 border-yellow-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <Star className=\"w-5 h-5 text-yellow-600\" />\n                  How to Earn Points\n                </h4>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex justify-between items-center p-2 bg-yellow-50 rounded-lg\">\n                    <span>Every dollar spent:</span>\n                    <span className=\"font-fredoka font-bold text-yellow-700\">+1-3 points</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-2 bg-yellow-50 rounded-lg\">\n                    <span>Leave a review:</span>\n                    <span className=\"font-fredoka font-bold text-yellow-700\">+10 points</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-2 bg-yellow-50 rounded-lg\">\n                    <span>Refer a friend:</span>\n                    <span className=\"font-fredoka font-bold text-yellow-700\">+50 points</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-2 bg-yellow-50 rounded-lg\">\n                    <span>Complete 5 bookings:</span>\n                    <span className=\"font-fredoka font-bold text-yellow-700\">+100 points</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Loyalty Tiers */}\n              <div className=\"space-y-2\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 flex items-center gap-2\">\n                  <Trophy className=\"w-5 h-5 text-yellow-600\" />\n                  Loyalty Tiers\n                </h4>\n                {tiers.map((tier, idx) => (\n                  <div\n                    key={tier.name}\n                    className=\"bg-white rounded-lg p-3 border-2 border-gray-200\"\n                  >\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className={`w-8 h-8 ${tier.color} rounded-lg flex items-center justify-center`}>\n                          <Trophy className=\"w-5 h-5 text-white\" />\n                        </div>\n                        <span className=\"font-fredoka font-bold text-gray-800\">{tier.name}</span>\n                      </div>\n                      <Badge className=\"bg-gray-100 text-gray-700 border-0 font-verdana\">\n                        {tier.threshold}+ points\n                      </Badge>\n                    </div>\n                    <div className=\"flex flex-wrap gap-1 ml-10\">\n                      {tier.benefits.map((benefit, bIdx) => (\n                        <Badge key={bIdx} variant=\"outline\" className=\"text-xs font-verdana\">\n                          {benefit}\n                        </Badge>\n                      ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              {/* Rewards Catalog */}\n              <div className=\"bg-green-50 rounded-xl p-4 border-2 border-green-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <Zap className=\"w-5 h-5 text-green-600\" />\n                  Popular Rewards\n                </h4>\n                <div className=\"space-y-2\">\n                  {rewards.map((reward, idx) => (\n                    <div\n                      key={idx}\n                      className=\"flex items-center justify-between p-2 bg-white rounded-lg border border-green-200\"\n                    >\n                      <span className=\"text-sm font-verdana text-gray-700\">{reward.name}</span>\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"text-xs text-gray-500 font-verdana\">{reward.value}</span>\n                        <Badge className=\"bg-green-600 text-white font-fredoka\">\n                          {reward.points} pts\n                        </Badge>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              <div className=\"bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-xs text-blue-800 font-verdana\">\n                <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n                <strong>Pro Tip:</strong> Combine with membership for maximum savings - earn points + get member discounts!\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\loyalty\\LoyaltyService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\matching\\AvailabilityAnalyzer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\matching\\MatchResultsDisplay.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":5,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":33,"fix":{"range":[229,237],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[228,236],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'primary' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":15,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"primary"},"fix":{"range":[505,513],"text":""},"desc":"Remove unused variable 'primary'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'fallbacks' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":15,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"fallbacks"},"fix":{"range":[512,523],"text":""},"desc":"Remove unused variable 'fallbacks'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Sparkles, Award, MapPin, CheckCircle } from 'lucide-react';\n\n/**\n * Display SmartMatch results with primary + fallback cleaners\n */\nexport default function MatchResultsDisplay({ matchResults, onSelectCleaner }) {\n  if (!matchResults || !matchResults.scores) {\n    return null;\n  }\n\n  const { primary, fallbacks, scores } = matchResults;\n\n  return (\n    <Card className=\"rounded-3xl border-0 shadow-xl bg-gradient-to-br from-indigo-50 to-purple-50\">\n      <CardHeader>\n        <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n          <Sparkles className=\"w-6 h-6 text-puretask-blue\" />\n          Smart Match Results\n        </CardTitle>\n        <p className=\"text-sm text-gray-600 font-verdana mt-2\">\n          We found {scores.length} qualified cleaners ranked by compatibility\n        </p>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {scores.map((result, index) => (\n          <div\n            key={result.email}\n            className={`p-4 rounded-2xl transition-all ${\n              index === 0 \n                ? 'bg-gradient-to-r from-blue-100 to-indigo-100 border-2 border-puretask-blue' \n                : 'bg-white hover:bg-gray-50'\n            }`}\n          >\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                {index === 0 && (\n                  <Award className=\"w-6 h-6 text-puretask-blue\" />\n                )}\n                <div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"font-fredoka font-bold text-graphite\">\n                      {result.name || result.email}\n                    </span>\n                    {index === 0 && (\n                      <Badge className=\"bg-puretask-blue text-white\">\n                        Best Match\n                      </Badge>\n                    )}\n                    {index > 0 && index <= 2 && (\n                      <Badge variant=\"secondary\">\n                        Backup #{index}\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-2 mt-1\">\n                    <div className=\"flex items-center gap-1 text-xs text-gray-600\">\n                      <CheckCircle className=\"w-3 h-3\" />\n                      {Math.round(result.score * 100)}% Match\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {index === 0 && onSelectCleaner && (\n                <Button\n                  onClick={() => onSelectCleaner(result.email)}\n                  className=\"brand-gradient text-white rounded-full font-fredoka\"\n                  size=\"sm\"\n                >\n                  Select\n                </Button>\n              )}\n            </div>\n          </div>\n        ))}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\matching\\SmartMatchExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\matching\\SmartMatchingEngine.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'date' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":35,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"date"},"fix":{"range":[588,598],"text":""},"desc":"Remove unused variable 'date'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'start_time' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":36,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"start_time"},"fix":{"range":[598,614],"text":""},"desc":"Remove unused variable 'start_time'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'estimated_hours' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"estimated_hours"},"fix":{"range":[614,635],"text":""},"desc":"Remove unused variable 'estimated_hours'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'hours' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":38,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":10,"suggestions":[{"messageId":"removeVar","data":{"varName":"hours"},"fix":{"range":[635,646],"text":""},"desc":"Remove unused variable 'hours'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleaning_type' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":39,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleaning_type"},"fix":{"range":[646,665],"text":""},"desc":"Remove unused variable 'cleaning_type'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'address' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":40,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":12,"suggestions":[{"messageId":"removeVar","data":{"varName":"address"},"fix":{"range":[665,678],"text":""},"desc":"Remove unused variable 'address'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'latitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":41,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"latitude"},"fix":{"range":[678,692],"text":""},"desc":"Remove unused variable 'latitude'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'longitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":42,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"longitude"},"fix":{"range":[692,707],"text":""},"desc":"Remove unused variable 'longitude'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'maxDistance' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":197,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":197,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"maxDistance"},"fix":{"range":[5916,5973],"text":""},"desc":"Remove unused variable 'maxDistance'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * MODULE 5 - Smart Match Engine\n * Filters, scores, and ranks cleaners for optimal matching\n */\n\nimport { base44 } from '@/api/base44Client';\n\n// Scoring weights\nconst WEIGHTS = {\n  distance: 0.15,\n  reliability: 0.20,\n  rating: 0.10,\n  tier: 0.10,\n  specialty: 0.10,\n  product: 0.05,\n  loyalty: 0.20,\n  acceptance: 0.05,\n  budget: 0.05\n};\n\n// Tier scoring map\nconst TIER_SCORES = {\n  'Developing': 0.3,\n  'Semi Pro': 0.6,\n  'Pro': 0.85,\n  'Elite': 1.0\n};\n\n/**\n * Main SmartMatch Pipeline\n */\nexport async function findBestCleaners(bookingData, topN = 5) {\n  const {\n    client_email,\n    date,\n    start_time,\n    estimated_hours,\n    hours,\n    cleaning_type,\n    address,\n    latitude,\n    longitude,\n    recurring_booking_id\n  } = bookingData;\n\n  // STEP 1: Load context\n  const [allCleaners, clientProfile, matchPrefs, favorites, blocks, blockedUsers] = await Promise.all([\n    base44.entities.CleanerProfile.filter({ is_active: true }),\n    base44.entities.ClientProfile.filter({ user_email: client_email }).then(r => r[0] || null),\n    base44.entities.SmartMatchPreference.filter({ client_email }).then(r => r[0] || null),\n    base44.entities.FavoriteCleaner.filter({ client_email }),\n    base44.entities.BlockedCleaner.filter({ client_email }),\n    base44.entities.BlockedUser.filter({ blocker_email: client_email })\n  ]);\n\n  // Get recurring cleaner if applicable\n  let recurringCleaner = null;\n  if (recurring_booking_id) {\n    const recurrings = await base44.entities.RecurringBooking.filter({ id: recurring_booking_id });\n    if (recurrings.length > 0) {\n      recurringCleaner = recurrings[0].cleaner_email;\n    }\n  }\n\n  const blockedEmails = new Set([\n    ...blocks.map(b => b.cleaner_email),\n    ...blockedUsers.map(b => b.blocked_email)\n  ]);\n\n  // STEP 2: Apply hard filters\n  const candidates = allCleaners.filter(cleaner => \n    passesHardFilters(cleaner, bookingData, blockedEmails)\n  );\n\n  if (candidates.length === 0) {\n    return { primary: null, fallbacks: [], scores: [] };\n  }\n\n  // STEP 3: Compute SmartMatchScore for each\n  const scoredCandidates = await Promise.all(\n    candidates.map(async cleaner => {\n      const score = await calculateSmartMatchScore(\n        cleaner,\n        bookingData,\n        clientProfile,\n        matchPrefs,\n        favorites,\n        recurringCleaner\n      );\n      return { cleaner, score };\n    })\n  );\n\n  // STEP 4: Sort descending by score\n  scoredCandidates.sort((a, b) => b.score - a.score);\n\n  // STEP 5: Select primary + fallbacks\n  const topCandidates = scoredCandidates.slice(0, topN);\n  const primary = topCandidates[0]?.cleaner.user_email || null;\n  const fallbacks = topCandidates.slice(1).map(c => c.cleaner.user_email);\n\n  return {\n    primary,\n    fallbacks,\n    scores: topCandidates.map(c => ({\n      email: c.cleaner.user_email,\n      score: c.score,\n      name: c.cleaner.full_name\n    }))\n  };\n}\n\n/**\n * SECTION 3: Hard Filters (all must pass)\n */\nfunction passesHardFilters(cleaner, bookingData, blockedEmails) {\n  // Filter 1: Active\n  if (!cleaner.is_active) return false;\n\n  // Filter 2: Not blocked\n  if (blockedEmails.has(cleaner.user_email)) return false;\n\n  // Filter 3: Within service area\n  // TODO: Implement precise lat/lng distance check when available\n  // For now: accept all (or check service_locations if we have city/zip)\n\n  // Filter 4: Available for time window\n  if (!isAvailableForBooking(cleaner, bookingData)) return false;\n\n  // Filter 5: Offers required service\n  // Basic/deep/moveout always OK for standard cleaners\n\n  return true;\n}\n\n/**\n * Check cleaner availability\n */\nfunction isAvailableForBooking(cleaner, bookingData) {\n  if (!cleaner.availability || cleaner.availability.length === 0) {\n    return true; // No availability set = assume available\n  }\n\n  const bookingDate = new Date(bookingData.date);\n  const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n  const bookingDay = dayNames[bookingDate.getDay()];\n\n  const dayAvailability = cleaner.availability.find(a => a.day === bookingDay);\n  if (!dayAvailability || !dayAvailability.available) {\n    return false;\n  }\n\n  // Check time window\n  const startHour = parseInt(bookingData.start_time?.split(':')[0] || '9');\n  const endHour = startHour + (bookingData.estimated_hours || bookingData.hours || 2);\n\n  const availStart = parseInt(dayAvailability.start_time?.split(':')[0] || '0');\n  const availEnd = parseInt(dayAvailability.end_time?.split(':')[0] || '23');\n\n  return startHour >= availStart && endHour <= availEnd;\n}\n\n/**\n * SECTION 4: SmartMatch Score Calculation\n */\nasync function calculateSmartMatchScore(cleaner, bookingData, clientProfile, matchPrefs, favorites, recurringCleaner) {\n  const scores = {\n    distance: calculateDistanceScore(cleaner, bookingData, matchPrefs),\n    reliability: (cleaner.reliability_score || 75) / 100,\n    rating: calculateRatingScore(cleaner),\n    tier: calculateTierScore(cleaner, matchPrefs),\n    specialty: calculateSpecialtyScore(cleaner, clientProfile, matchPrefs),\n    product: calculateProductScore(cleaner, matchPrefs),\n    loyalty: calculateLoyaltyScore(cleaner, bookingData, clientProfile, favorites, recurringCleaner),\n    acceptance: calculateAcceptanceScore(cleaner, bookingData),\n    budget: 0.5 // Placeholder - would normalize rates within candidate set\n  };\n\n  const finalScore = \n    WEIGHTS.distance * scores.distance +\n    WEIGHTS.reliability * scores.reliability +\n    WEIGHTS.rating * scores.rating +\n    WEIGHTS.tier * scores.tier +\n    WEIGHTS.specialty * scores.specialty +\n    WEIGHTS.product * scores.product +\n    WEIGHTS.loyalty * scores.loyalty +\n    WEIGHTS.acceptance * scores.acceptance +\n    WEIGHTS.budget * scores.budget;\n\n  return finalScore;\n}\n\n// Distance Score (0-1)\nfunction calculateDistanceScore(cleaner, bookingData, matchPrefs) {\n  // TODO: Use lat/lng when available\n  // For now: zone-based approximation\n  const maxDistance = matchPrefs?.max_distance_miles || 15;\n  \n  // Check if booking location is in cleaner's service areas\n  if (cleaner.service_locations && cleaner.service_locations.length > 0) {\n    // Simple match for now\n    return 1.0; // Same city/zip\n  }\n  \n  return 0.7; // Nearby region\n}\n\n// Rating Score (0-1)\nfunction calculateRatingScore(cleaner) {\n  const rating = cleaner.average_rating || 4.5;\n  return Math.max(0, Math.min(1, (rating - 3) / 2));\n}\n\n// Tier Score (0-1)\nfunction calculateTierScore(cleaner, matchPrefs) {\n  let score = TIER_SCORES[cleaner.tier] || 0.6;\n  \n  // Bonus if preferred tier matches\n  if (matchPrefs?.preferred_tier === 'Pro' && ['Pro', 'Elite'].includes(cleaner.tier)) {\n    score = Math.min(1.0, score + 0.05);\n  } else if (matchPrefs?.preferred_tier === 'Elite' && cleaner.tier === 'Elite') {\n    score = Math.min(1.0, score + 0.1);\n  }\n  \n  return score;\n}\n\n// Specialty Match Score (0-1)\nfunction calculateSpecialtyScore(cleaner, clientProfile, matchPrefs) {\n  const preferredSpecialties = \n    matchPrefs?.preferred_specialty_tags || \n    clientProfile?.preferred_specialty_tags || \n    [];\n  \n  if (preferredSpecialties.length === 0) {\n    return 0.5; // No preference\n  }\n  \n  const cleanerTags = cleaner.specialty_tags || [];\n  const overlap = preferredSpecialties.filter(tag => cleanerTags.includes(tag)).length;\n  \n  return overlap / preferredSpecialties.length;\n}\n\n// Product Preference Score (0-1)\nfunction calculateProductScore(cleaner, matchPrefs) {\n  const preferredProduct = matchPrefs?.preferred_product_type;\n  const cleanerProduct = cleaner.product_preference;\n  \n  if (!preferredProduct || preferredProduct === 'any') {\n    return 0.7;\n  }\n  \n  if (preferredProduct === cleanerProduct) {\n    return 1.0;\n  }\n  \n  return 0.2; // Mismatch\n}\n\n// Loyalty Score (0-1)\nfunction calculateLoyaltyScore(cleaner, bookingData, clientProfile, favorites, recurringCleaner) {\n  // Recurring booking with this cleaner\n  if (recurringCleaner === cleaner.user_email) {\n    return 1.0;\n  }\n  \n  // Favorite cleaner\n  if (favorites.some(f => f.cleaner_email === cleaner.user_email)) {\n    return 0.9;\n  }\n  \n  // Same cleaner preference + was last cleaner\n  if (clientProfile?.last_booked_cleaner === cleaner.user_email) {\n    return 0.8;\n  }\n  \n  return 0.3; // Default\n}\n\n// Acceptance Likelihood Score (0-1)\nfunction calculateAcceptanceScore(cleaner, bookingData) {\n  if (!cleaner.typical_acceptance_rate_by_time) {\n    return 0.5; // No data\n  }\n  \n  // Build time slot key (e.g., \"Mon_09-12\")\n  const bookingDate = new Date(bookingData.date);\n  const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n  const day = dayNames[bookingDate.getDay()];\n  const hour = parseInt(bookingData.start_time?.split(':')[0] || '9');\n  const timeSlot = `${Math.floor(hour / 3) * 3}-${Math.floor(hour / 3) * 3 + 3}`; // 3-hour buckets\n  \n  const key = `${day}_${timeSlot}`;\n  const rate = cleaner.typical_acceptance_rate_by_time[key];\n  \n  return rate ? rate / 100 : 0.5;\n}\n\n/**\n * Check if cleaner qualifies for instant book\n */\nexport function isInstantBookEligible(cleaner, bookingData) {\n  if (!cleaner.instant_book_enabled) return false;\n  \n  // Check if booking is far enough in future\n  const bookingDateTime = new Date(`${bookingData.date}T${bookingData.start_time}`);\n  const hoursUntilStart = (bookingDateTime - new Date()) / (1000 * 60 * 60);\n  const requiredHours = cleaner.instant_book_hours || 48;\n  \n  if (hoursUntilStart < requiredHours) return false;\n  \n  // Check reliability threshold\n  const reliabilityScore = (cleaner.reliability_score || 75) / 100;\n  if (reliabilityScore < 0.8) return false;\n  \n  return true;\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\membership\\MembershipExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":2,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":73,"fix":{"range":[100,113],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[100,113],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'idx' is defined but never used. Allowed unused args must match /^_/u.","line":67,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":67,"endColumn":38,"suggestions":[{"messageId":"removeVar","data":{"varName":"idx"},"fix":{"range":[2398,2403],"text":""},"desc":"Remove unused variable 'idx'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Crown, ChevronDown, Star, CheckCircle2, DollarSign, AlertCircle } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function MembershipExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  const tiers = [\n    {\n      name: 'Standard',\n      price: 0,\n      discount: 0,\n      benefits: ['Standard pricing', 'Basic support', 'All cleaners available']\n    },\n    {\n      name: 'Plus',\n      price: 29,\n      discount: 10,\n      benefits: ['10% off all bookings', 'Priority support', 'Free cancellations', 'Loyalty points boost']\n    },\n    {\n      name: 'Platinum',\n      price: 79,\n      discount: 20,\n      benefits: ['20% off all bookings', 'VIP support', 'Unlimited free cancellations', '2x loyalty points', 'Exclusive cleaners', 'Insurance included']\n    }\n  ];\n\n  return (\n    <Card className=\"border-2 border-yellow-200 bg-gradient-to-r from-yellow-50 to-amber-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Crown className=\"w-5 h-5 text-yellow-600\" />\n            Membership Plans\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              <p className=\"text-sm font-verdana text-gray-700 mb-4\">\n                Save money on every booking with a monthly membership. The more you clean, the more you save!\n              </p>\n\n              {/* Tier Comparison */}\n              <div className=\"space-y-3\">\n                {tiers.map((tier, idx) => (\n                  <div\n                    key={tier.name}\n                    className={`bg-white rounded-xl p-4 border-2 ${\n                      tier.name === 'Plus' ? 'border-blue-400' : 'border-gray-200'\n                    }`}\n                  >\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div>\n                        <h4 className=\"font-fredoka font-bold text-gray-800 text-lg flex items-center gap-2\">\n                          {tier.name}\n                          {tier.name === 'Plus' && (\n                            <Badge className=\"bg-blue-600 text-white font-fredoka\">Popular</Badge>\n                          )}\n                        </h4>\n                        {tier.discount > 0 && (\n                          <p className=\"text-sm text-green-600 font-fredoka font-semibold mt-1\">\n                            Save {tier.discount}% on every booking\n                          </p>\n                        )}\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-3xl font-fredoka font-bold text-gray-800\">\n                          ${tier.price}\n                        </p>\n                        <p className=\"text-xs text-gray-500 font-verdana\">per month</p>\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-1\">\n                      {tier.benefits.map((benefit, bIdx) => (\n                        <div key={bIdx} className=\"flex items-start gap-2 text-sm\">\n                          <CheckCircle2 className=\"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5\" />\n                          <span className=\"font-verdana text-gray-700\">{benefit}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              {/* Savings Calculator */}\n              <div className=\"bg-green-50 rounded-xl p-4 border-2 border-green-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <DollarSign className=\"w-5 h-5 text-green-600\" />\n                  Example Savings\n                </h4>\n                <div className=\"space-y-2 text-sm font-verdana\">\n                  <div className=\"flex justify-between items-center p-2 bg-white rounded-lg\">\n                    <span className=\"text-gray-700\">2 cleanings/month @ $100 each:</span>\n                    <span className=\"font-fredoka font-bold\">$200</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-2 bg-green-100 rounded-lg\">\n                    <span className=\"text-gray-700\">Plus membership ($29):</span>\n                    <span className=\"font-fredoka font-bold text-green-600\">Save $20/mo</span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-2 bg-green-100 rounded-lg\">\n                    <span className=\"text-gray-700\">Platinum membership ($79):</span>\n                    <span className=\"font-fredoka font-bold text-green-600\">Save $40/mo</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-xs text-blue-800 font-verdana\">\n                <Star className=\"w-4 h-4 inline mr-1\" />\n                <strong>Pro Tip:</strong> If you clean twice a month or more, a membership pays for itself!\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\membership\\MembershipUpgrade.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Shield' is defined but never used.","line":5,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":36,"fix":{"range":[232,240],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Shield"},"fix":{"range":[231,239],"text":""},"desc":"Remove unused variable 'Shield'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":5,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":47,"fix":{"range":[245,250],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[245,250],"text":""},"desc":"Remove unused variable 'Zap'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle, Crown, Shield, Star, Zap } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function MembershipUpgrade({ currentTier = 'Standard', onUpgrade }) {\n  const tiers = [\n    {\n      name: 'Plus',\n      price: 9.99,\n      icon: <Star className=\"w-8 h-8 text-amber-500\" />,\n      color: 'amber',\n      benefits: [\n        '10% off all bookings',\n        'Priority booking access',\n        'Free cancellations',\n        'Dedicated customer support',\n        'Monthly cleaning reminders'\n      ]\n    },\n    {\n      name: 'Platinum',\n      price: 19.99,\n      icon: <Crown className=\"w-8 h-8 text-purple-500\" />,\n      color: 'purple',\n      popular: true,\n      benefits: [\n        'Everything in Plus, plus:',\n        '15% off all bookings',\n        'PureTask Protect included',\n        'Same-day booking priority',\n        'Concierge service',\n        'VIP support line'\n      ]\n    }\n  ];\n\n  if (currentTier !== 'Standard') return null;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <h2 className=\"text-3xl font-bold text-slate-900 mb-2\">Upgrade Your Experience</h2>\n        <p className=\"text-slate-600\">Save more, book easier, get VIP treatment</p>\n      </div>\n\n      <div className=\"grid md:grid-cols-2 gap-6\">\n        {tiers.map((tier) => (\n          <motion.div\n            key={tier.name}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            whileHover={{ scale: 1.02 }}\n          >\n            <Card className={`relative border-2 ${\n              tier.popular \n                ? 'border-purple-300 shadow-2xl' \n                : 'border-slate-200'\n            }`}>\n              {tier.popular && (\n                <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2\">\n                  <Badge className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-1\">\n                    MOST POPULAR\n                  </Badge>\n                </div>\n              )}\n\n              <CardHeader className={`bg-gradient-to-br from-${tier.color}-50 to-${tier.color}-100`}>\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"text-2xl flex items-center gap-2\">\n                      {tier.icon}\n                      PureTask {tier.name}\n                    </CardTitle>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-3xl font-bold text-slate-900\">${tier.price}</p>\n                    <p className=\"text-sm text-slate-600\">/month</p>\n                  </div>\n                </div>\n              </CardHeader>\n\n              <CardContent className=\"p-6\">\n                <ul className=\"space-y-3 mb-6\">\n                  {tier.benefits.map((benefit, index) => (\n                    <li key={index} className=\"flex items-start gap-2\">\n                      <CheckCircle className={`w-5 h-5 text-${tier.color}-600 mt-0.5 flex-shrink-0`} />\n                      <span className=\"text-slate-700\">{benefit}</span>\n                    </li>\n                  ))}\n                </ul>\n\n                <Button\n                  onClick={() => onUpgrade(tier.name)}\n                  className={`w-full ${\n                    tier.popular\n                      ? 'bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600'\n                      : 'bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600'\n                  }`}\n                  size=\"lg\"\n                >\n                  Upgrade to {tier.name}\n                </Button>\n\n                {tier.popular && (\n                  <p className=\"text-xs text-center text-slate-500 mt-3\">\n                    Save up to $600/year with Platinum\n                  </p>\n                )}\n              </CardContent>\n            </Card>\n          </motion.div>\n        ))}\n      </div>\n\n      <div className=\"text-center\">\n        <p className=\"text-sm text-slate-500\">\n          Cancel anytime. No long-term contracts. Money-back guarantee.\n        </p>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\ChatConversation.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[154,201],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[154,200],"text":""},"desc":"Remove unused variable 'Input'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Card' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14,"fix":{"range":[209,215],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Card"},"fix":{"range":[210,215],"text":""},"desc":"Remove unused variable 'Card'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardContent' is defined but never used.","line":5,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":27,"fix":{"range":[215,228],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardContent"},"fix":{"range":[214,227],"text":""},"desc":"Remove unused variable 'CardContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":39,"fix":{"range":[228,240],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[227,239],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":5,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":50,"fix":{"range":[239,250],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[239,250],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ImageIcon' is defined but never used.","line":8,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":60,"fix":{"range":[420,440],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ImageIcon"},"fix":{"range":[419,439],"text":""},"desc":"Remove unused variable 'ImageIcon'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'motion' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"fix":{"range":[466,507],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[466,505],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Textarea } from '@/components/ui/textarea';\nimport MessageBubble from './MessageBubble';\nimport { Send, Paperclip, Loader2, User, Image as ImageIcon, X } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function ChatConversation({ conversationId, currentUser }) {\n  const [messages, setMessages] = useState([]);\n  const [newMessageContent, setNewMessageContent] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadedFile, setUploadedFile] = useState(null);\n  const [otherParticipant, setOtherParticipant] = useState(null);\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  useEffect(() => {\n    if (conversationId) {\n      loadConversation();\n      markAsRead();\n    }\n  }, [conversationId]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const loadConversation = async () => {\n    setIsLoading(true);\n    try {\n      // Load thread details\n      const thread = await base44.entities.ConversationThread.filter({ id: conversationId });\n      if (thread[0]) {\n        const otherEmail = thread[0].participants?.find(p => p !== currentUser?.email);\n        setOtherParticipant(otherEmail);\n      }\n\n      // Load messages\n      const conversationMessages = await base44.entities.Message.filter(\n        { thread_id: conversationId },\n        'created_date'\n      );\n      setMessages(conversationMessages);\n    } catch (error) {\n      console.error('Error loading conversation:', error);\n    }\n    setIsLoading(false);\n  };\n\n  const markAsRead = async () => {\n    try {\n      const userType = currentUser?.user_type || 'client';\n      const updates = {};\n      \n      if (userType === 'client') {\n        updates.unread_count_client = 0;\n      } else if (userType === 'cleaner') {\n        updates.unread_count_cleaner = 0;\n      }\n\n      await base44.entities.ConversationThread.update(conversationId, updates);\n\n      // Mark messages as read\n      const unreadMessages = await base44.entities.Message.filter({\n        thread_id: conversationId,\n        receiver_email: currentUser.email,\n        is_read: false\n      });\n\n      for (const msg of unreadMessages) {\n        await base44.entities.Message.update(msg.id, {\n          is_read: true,\n          read_at: new Date().toISOString()\n        });\n      }\n    } catch (error) {\n      console.error('Error marking as read:', error);\n    }\n  };\n\n  const handleFileSelect = async (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setIsUploading(true);\n    try {\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      setUploadedFile({\n        url: file_url,\n        name: file.name,\n        type: file.type\n      });\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      alert('Failed to upload file. Please try again.');\n    }\n    setIsUploading(false);\n  };\n\n  const handleSendMessage = async () => {\n    if (!newMessageContent.trim() && !uploadedFile) return;\n\n    setIsSending(true);\n    try {\n      const messageType = uploadedFile \n        ? (uploadedFile.type.startsWith('image/') ? 'image' : 'attachment')\n        : 'text';\n\n      const newMessage = await base44.entities.Message.create({\n        thread_id: conversationId,\n        sender_email: currentUser.email,\n        receiver_email: otherParticipant,\n        content: newMessageContent.trim(),\n        type: messageType,\n        attachment_url: uploadedFile?.url || null,\n        is_read: false,\n        delivery_status: 'sent'\n      });\n\n      // Update thread with last message\n      await base44.entities.ConversationThread.update(conversationId, {\n        last_message_content: newMessageContent.trim() || 'Sent an attachment',\n        last_message_timestamp: new Date().toISOString(),\n        [`unread_count_${currentUser.user_type === 'client' ? 'cleaner' : 'client'}`]: \n          (await base44.entities.ConversationThread.filter({ id: conversationId }))[0]?.[`unread_count_${currentUser.user_type === 'client' ? 'cleaner' : 'client'}`] + 1 || 1\n      });\n\n      setMessages(prev => [...prev, newMessage]);\n      setNewMessageContent('');\n      setUploadedFile(null);\n    } catch (error) {\n      console.error('Error sending message:', error);\n      alert('Failed to send message. Please try again.');\n    }\n    setIsSending(false);\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"h-full flex items-center justify-center bg-soft-cloud\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col bg-soft-cloud\">\n      {/* Header */}\n      <div className=\"bg-white border-b-2 border-gray-200 p-6 shadow-sm\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"w-12 h-12 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold text-lg\">\n            {otherParticipant?.[0]?.toUpperCase() || 'U'}\n          </div>\n          <div>\n            <h2 className=\"text-2xl font-fredoka font-bold text-graphite\">\n              {otherParticipant || 'Unknown User'}\n            </h2>\n            <p className=\"text-sm text-gray-500 font-verdana\">Active conversation</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Messages Area */}\n      <div className=\"flex-1 overflow-y-auto p-6 space-y-2\">\n        {messages.length === 0 ? (\n          <div className=\"h-full flex flex-col items-center justify-center text-center\">\n            <User className=\"w-20 h-20 text-gray-300 mb-4\" />\n            <p className=\"text-xl font-fredoka font-bold text-gray-600 mb-2\">\n              Start the conversation\n            </p>\n            <p className=\"text-gray-500 font-verdana\">\n              Send a message to {otherParticipant}\n            </p>\n          </div>\n        ) : (\n          <>\n            {messages.map((message) => (\n              <MessageBubble\n                key={message.id}\n                message={message}\n                isUser={message.sender_email === currentUser.email}\n              />\n            ))}\n            <div ref={messagesEndRef} />\n          </>\n        )}\n      </div>\n\n      {/* File Preview */}\n      {uploadedFile && (\n        <div className=\"px-6 py-3 bg-blue-50 border-t border-blue-200\">\n          <div className=\"flex items-center gap-3 bg-white rounded-lg p-3 border border-blue-300\">\n            {uploadedFile.type.startsWith('image/') ? (\n              <img src={uploadedFile.url} alt=\"Preview\" className=\"w-16 h-16 rounded object-cover\" />\n            ) : (\n              <Paperclip className=\"w-8 h-8 text-gray-500\" />\n            )}\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-fredoka font-semibold text-graphite truncate\">\n                {uploadedFile.name}\n              </p>\n              <p className=\"text-xs text-gray-500 font-verdana\">Ready to send</p>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setUploadedFile(null)}\n              className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\n            >\n              <X className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Input Area */}\n      <div className=\"bg-white border-t-2 border-gray-200 p-6 shadow-lg\">\n        <div className=\"flex gap-3\">\n          <input\n            type=\"file\"\n            ref={fileInputRef}\n            onChange={handleFileSelect}\n            className=\"hidden\"\n            accept=\"image/*,.pdf,.doc,.docx\"\n          />\n          \n          <Button\n            variant=\"outline\"\n            size=\"icon\"\n            onClick={() => fileInputRef.current?.click()}\n            disabled={isUploading || isSending}\n            className=\"flex-shrink-0 border-2 border-gray-300 hover:border-puretask-blue\"\n          >\n            {isUploading ? (\n              <Loader2 className=\"w-5 h-5 animate-spin\" />\n            ) : (\n              <Paperclip className=\"w-5 h-5\" />\n            )}\n          </Button>\n\n          <Textarea\n            value={newMessageContent}\n            onChange={(e) => setNewMessageContent(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"Type your message...\"\n            disabled={isSending}\n            className=\"flex-1 min-h-[48px] max-h-32 resize-none font-verdana\"\n            rows={1}\n          />\n\n          <Button\n            onClick={handleSendMessage}\n            disabled={(!newMessageContent.trim() && !uploadedFile) || isSending}\n            className=\"flex-shrink-0 brand-gradient text-white font-fredoka font-bold px-6\"\n          >\n            {isSending ? (\n              <Loader2 className=\"w-5 h-5 animate-spin\" />\n            ) : (\n              <>\n                <Send className=\"w-5 h-5 mr-2\" />\n                Send\n              </>\n            )}\n          </Button>\n        </div>\n\n        <p className=\"text-xs text-gray-500 font-verdana mt-3\">\n          Press Enter to send, Shift + Enter for new line\n        </p>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\ChatMessage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\ConversationListItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\MessageBubble.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\MessageButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\MessageTemplates.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23,"fix":{"range":[535,550],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[536,550],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Badge } from '@/components/ui/badge';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { MessageSquare, Plus, Trash2 } from 'lucide-react';\nimport { toast } from 'sonner';\n\nconst DEFAULT_TEMPLATES = [\n  {\n    title: \"Thank You\",\n    content: \"Thank you so much! I appreciate your help.\",\n    user_type: \"both\"\n  },\n  {\n    title: \"Running Late\",\n    content: \"Hi! I'm running about 10 minutes late. I'll be there shortly. Sorry for the delay!\",\n    user_type: \"cleaner\"\n  },\n  {\n    title: \"On My Way\",\n    content: \"Hello! I'm on my way to your location. I should arrive in about 15 minutes.\",\n    user_type: \"cleaner\"\n  },\n  {\n    title: \"Question About Job\",\n    content: \"Hi! I have a quick question about the cleaning job. When would be a good time to discuss?\",\n    user_type: \"both\"\n  },\n  {\n    title: \"Great Job\",\n    content: \"Thank you for the excellent cleaning job! Everything looks amazing.\",\n    user_type: \"client\"\n  }\n];\n\nexport default function MessageTemplates({ userType, onSelect }) {\n  const [templates, setTemplates] = useState([]);\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\n  const [newTemplate, setNewTemplate] = useState({ title: '', content: '' });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  const loadTemplates = async () => {\n    try {\n      const user = await base44.auth.me();\n      const userTemplates = await base44.entities.MessageTemplate.filter({ user_email: user.email });\n      \n      // Combine user templates with default templates\n      const filteredDefaults = DEFAULT_TEMPLATES.filter(t => \n        t.user_type === 'both' || t.user_type === userType\n      );\n      \n      setTemplates([...userTemplates, ...filteredDefaults.map(t => ({ ...t, is_default: true }))]);\n    } catch (error) {\n      console.error('Error loading templates:', error);\n    }\n    setLoading(false);\n  };\n\n  const handleCreateTemplate = async () => {\n    if (!newTemplate.title.trim() || !newTemplate.content.trim()) {\n      toast.error('Please fill in all fields');\n      return;\n    }\n\n    try {\n      const user = await base44.auth.me();\n      await base44.entities.MessageTemplate.create({\n        user_email: user.email,\n        title: newTemplate.title,\n        content: newTemplate.content,\n        user_type: userType\n      });\n\n      toast.success('Template created');\n      setNewTemplate({ title: '', content: '' });\n      setShowCreateDialog(false);\n      loadTemplates();\n    } catch (error) {\n      console.error('Error creating template:', error);\n      toast.error('Failed to create template');\n    }\n  };\n\n  const handleDeleteTemplate = async (templateId) => {\n    if (!confirm('Delete this template?')) return;\n\n    try {\n      await base44.entities.MessageTemplate.delete(templateId);\n      toast.success('Template deleted');\n      loadTemplates();\n    } catch (error) {\n      console.error('Error deleting template:', error);\n      toast.error('Failed to delete template');\n    }\n  };\n\n  const handleUseTemplate = async (template) => {\n    if (!template.is_default && template.id) {\n      try {\n        await base44.entities.MessageTemplate.update(template.id, {\n          usage_count: (template.usage_count || 0) + 1\n        });\n      } catch (error) {\n        console.error('Error updating usage count:', error);\n      }\n    }\n    onSelect(template);\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg mt-2\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-sm\">Quick Replies</CardTitle>\n          <Dialog open={showCreateDialog} onOpenChange={setShowCreateDialog}>\n            <DialogTrigger asChild>\n              <Button size=\"sm\" variant=\"outline\">\n                <Plus className=\"w-4 h-4 mr-2\" />\n                New Template\n              </Button>\n            </DialogTrigger>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Create Message Template</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label>Template Name</Label>\n                  <Input\n                    value={newTemplate.title}\n                    onChange={(e) => setNewTemplate({ ...newTemplate, title: e.target.value })}\n                    placeholder=\"e.g., Running Late\"\n                    className=\"mt-2\"\n                  />\n                </div>\n                <div>\n                  <Label>Message Content</Label>\n                  <Textarea\n                    value={newTemplate.content}\n                    onChange={(e) => setNewTemplate({ ...newTemplate, content: e.target.value })}\n                    placeholder=\"Type your template message...\"\n                    rows={4}\n                    className=\"mt-2\"\n                  />\n                </div>\n                <Button onClick={handleCreateTemplate} className=\"w-full\">\n                  Create Template\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-2\">\n        {loading ? (\n          <p className=\"text-sm text-slate-500\">Loading templates...</p>\n        ) : templates.length === 0 ? (\n          <p className=\"text-sm text-slate-500\">No templates yet. Create your first one!</p>\n        ) : (\n          templates.map((template, idx) => (\n            <div\n              key={idx}\n              className=\"flex items-start justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors group\"\n            >\n              <button\n                onClick={() => handleUseTemplate(template)}\n                className=\"flex-1 text-left\"\n              >\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <span className=\"font-medium text-sm\">{template.title}</span>\n                  {template.is_default && (\n                    <Badge variant=\"outline\" className=\"text-xs\">Default</Badge>\n                  )}\n                </div>\n                <p className=\"text-xs text-slate-600 line-clamp-2\">{template.content}</p>\n              </button>\n              {!template.is_default && template.id && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => handleDeleteTemplate(template.id)}\n                  className=\"opacity-0 group-hover:opacity-100 transition-opacity\"\n                >\n                  <Trash2 className=\"w-4 h-4 text-red-500\" />\n                </Button>\n              )}\n            </div>\n          ))\n        )}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\QuickActions.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Camera' is defined but never used.","line":6,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":31,"fix":{"range":[234,242],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Camera"},"fix":{"range":[233,241],"text":""},"desc":"Remove unused variable 'Camera'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { base44 } from '@/api/base44Client';\nimport { toast } from 'sonner';\nimport { Clock, MapPin, Camera, CheckCircle, AlertCircle, Calendar, Home } from 'lucide-react';\n\nconst QUICK_RESPONSES = {\n  cleaner_to_client: [\n    { id: 'on_my_way', label: 'On My Way', icon: MapPin, message: \"Hi! I'm on my way to your location now. I'll be there within 15 minutes.\" },\n    { id: 'running_late', label: 'Running Late', icon: Clock, message: \"Hi, I'm running a few minutes late due to traffic. I'll be there as soon as possible. Apologies for the delay!\" },\n    { id: 'arrived', label: 'Arrived', icon: CheckCircle, message: \"Hi! I've arrived and am ready to start the cleaning.\" },\n    { id: 'halfway_done', label: 'Halfway Done', icon: Clock, message: \"Update: I'm about halfway through the cleaning. Everything is going well!\" },\n    { id: 'finished', label: 'Finished', icon: CheckCircle, message: \"All done! I've uploaded before/after photos. Please take a look and let me know if you need anything touched up.\" },\n    { id: 'question_product', label: 'Product Question', icon: AlertCircle, message: \"Quick question: I noticed [item/area]. Would you like me to use a specific product or approach for this?\" },\n  ],\n  client_to_cleaner: [\n    { id: 'confirm_time', label: 'Confirm Time', icon: Calendar, message: \"Hi! Just confirming our appointment for today. See you soon!\" },\n    { id: 'parking', label: 'Parking Info', icon: MapPin, message: \"Parking information: You can park in [location]. The access code is [code] if needed.\" },\n    { id: 'entry_code', label: 'Entry Code', icon: Home, message: \"Entry information: [door code/key location]. Please lock up when you're done.\" },\n    { id: 'focus_area', label: 'Focus Area', icon: AlertCircle, message: \"Hi! Please pay special attention to [area/room] today. Thank you!\" },\n    { id: 'running_late', label: 'Running Late', icon: Clock, message: \"Hi, I'm running a bit late. I'll be home around [time]. Feel free to start without me there.\" },\n    { id: 'approval', label: 'Looks Great!', icon: CheckCircle, message: \"Everything looks fantastic! Great job, thank you so much!\" },\n  ]\n};\n\nexport default function QuickActions({ booking, user, thread, onActionSent }) {\n  const [sending, setSending] = React.useState(null);\n\n  const handleQuickResponse = async (response) => {\n    setSending(response.id);\n    \n    try {\n      const otherParticipant = thread.participants.find(p => p !== user.email);\n      \n      await base44.entities.Message.create({\n        thread_id: thread.id,\n        sender_email: user.email,\n        receiver_email: otherParticipant,\n        booking_id: booking.id,\n        content: response.message,\n        type: 'quick_action',\n        delivery_status: 'sent'\n      });\n\n      await base44.entities.ConversationThread.update(thread.id, {\n        last_message_content: response.message.substring(0, 100),\n        last_message_timestamp: new Date().toISOString(),\n        [user.user_type === 'client' ? 'unread_count_cleaner' : 'unread_count_client']: \n          (user.user_type === 'client' ? thread.unread_count_cleaner : thread.unread_count_client) + 1\n      });\n\n      toast.success('Message sent');\n      if (onActionSent) onActionSent();\n    } catch (error) {\n      console.error('Error sending quick response:', error);\n      toast.error('Failed to send message');\n    }\n    \n    setSending(null);\n  };\n\n  const responses = user.user_type === 'cleaner' \n    ? QUICK_RESPONSES.cleaner_to_client \n    : QUICK_RESPONSES.client_to_cleaner;\n\n  return (\n    <Card className=\"mb-6 border-0 shadow-lg bg-gradient-to-r from-blue-50 to-cyan-50\">\n      <CardContent className=\"p-6\">\n        <h3 className=\"text-lg font-fredoka font-bold text-graphite mb-4\">Quick Responses</h3>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n          {responses.map((response) => {\n            const Icon = response.icon;\n            return (\n              <Button\n                key={response.id}\n                onClick={() => handleQuickResponse(response)}\n                disabled={sending === response.id}\n                variant=\"outline\"\n                className=\"h-auto py-4 px-4 flex flex-col items-center gap-2 hover:bg-blue-100 hover:border-puretask-blue rounded-2xl\"\n              >\n                <Icon className={`w-6 h-6 ${sending === response.id ? 'animate-pulse' : ''}`} />\n                <span className=\"text-sm font-fredoka font-semibold text-center\">{response.label}</span>\n              </Button>\n            );\n          })}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\TypingIndicator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\messaging\\UnreadCountExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bell' is defined but never used.","line":2,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":29,"fix":{"range":[50,56],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bell"},"fix":{"range":[49,55],"text":""},"desc":"Remove unused variable 'Bell'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":2,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":42,"fix":{"range":[55,68],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[55,68],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React from 'react';\nimport { MessageSquare, Bell, AlertCircle } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\nimport { motion } from 'framer-motion';\n\nexport default function UnreadCountExplainer({ count, context = 'general' }) {\n  if (count === 0) return null;\n\n  const messages = {\n    general: {\n      title: 'New Messages',\n      description: `You have ${count} unread message${count > 1 ? 's' : ''} waiting for you`\n    },\n    booking_request: {\n      title: 'Action Required',\n      description: `${count} client${count > 1 ? 's are' : ' is'} waiting for your response`\n    },\n    job_update: {\n      title: 'Job Updates',\n      description: `${count} important update${count > 1 ? 's' : ''} about your jobs`\n    }\n  };\n\n  const msg = messages[context] || messages.general;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.9 }}\n      animate={{ opacity: 1, scale: 1 }}\n      className=\"bg-blue-50 border-l-4 border-blue-500 rounded-lg p-3 flex items-start gap-3\"\n    >\n      <div className=\"mt-0.5\">\n        <div className=\"relative\">\n          <MessageSquare className=\"w-5 h-5 text-blue-600\" />\n          <motion.div\n            animate={{ scale: [1, 1.2, 1] }}\n            transition={{ repeat: Infinity, duration: 2 }}\n            className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full\"\n          />\n        </div>\n      </div>\n      <div className=\"flex-1\">\n        <h4 className=\"font-fredoka font-semibold text-blue-900 text-sm\">{msg.title}</h4>\n        <p className=\"text-xs text-gray-700 font-verdana mt-1\">{msg.description}</p>\n      </div>\n      <Badge className=\"bg-red-500 text-white font-fredoka font-bold\">\n        {count}\n      </Badge>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\AutomatedNotifications.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\BookingConfirmationEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\BookingReminderCron.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'tomorrow' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":12,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"tomorrow"},"fix":{"range":[318,381],"text":""},"desc":"Remove unused variable 'tomorrow'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'in2Hours' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"in2Hours"},"fix":{"range":[384,446],"text":""},"desc":"Remove unused variable 'in2Hours'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Module 8 - Booking Reminder Cron\n// Sends reminders 24h and 2h before scheduled bookings\n\nimport { sendNotification } from './NotificationEngineService.js';\n\n/**\n * Check for bookings needing reminders\n * Run this hourly via cron\n */\nexport async function sendBookingReminders(base44) {\n  const now = new Date();\n  const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);\n  const in2Hours = new Date(now.getTime() + 2 * 60 * 60 * 1000);\n\n  try {\n    // Get scheduled bookings\n    const bookings = await base44.asServiceRole.entities.Booking.filter({\n      status: 'scheduled'\n    });\n\n    for (const booking of bookings) {\n      const bookingDateTime = new Date(`${booking.date}T${booking.start_time}`);\n      const hoursUntil = (bookingDateTime - now) / (1000 * 60 * 60);\n\n      // Check if we should send 24h reminder\n      if (hoursUntil <= 24 && hoursUntil > 23) {\n        await send24HourReminder(base44, booking);\n      }\n\n      // Check if we should send 2h reminder\n      if (hoursUntil <= 2 && hoursUntil > 1.5) {\n        await send2HourReminder(base44, booking);\n      }\n    }\n\n    console.log(`[BookingReminderCron] Checked ${bookings.length} bookings`);\n  } catch (error) {\n    console.error('[BookingReminderCron] Error:', error);\n  }\n}\n\nasync function send24HourReminder(base44, booking) {\n  const cleanerName = await getUserName(base44, booking.cleaner_email);\n  const clientName = await getUserName(base44, booking.client_email);\n\n  await sendNotification(base44, 'booking_reminder_client', booking.client_email, {\n    client_name: clientName,\n    cleaner_name: cleanerName,\n    booking_date: booking.date,\n    booking_time: booking.start_time,\n    address: booking.address,\n    booking_id: booking.id\n  }, { bookingId: booking.id });\n\n  await sendNotification(base44, 'booking_reminder_cleaner', booking.cleaner_email, {\n    cleaner_name: cleanerName,\n    booking_date: booking.date,\n    booking_time: booking.start_time,\n    address: booking.address,\n    hours: booking.hours,\n    booking_id: booking.id\n  }, { bookingId: booking.id });\n}\n\nasync function send2HourReminder(base44, booking) {\n  const cleanerName = await getUserName(base44, booking.cleaner_email);\n\n  await sendNotification(base44, 'booking_reminder_cleaner', booking.cleaner_email, {\n    cleaner_name: cleanerName,\n    booking_date: booking.date,\n    booking_time: booking.start_time,\n    address: booking.address,\n    hours: booking.hours,\n    booking_id: booking.id\n  }, { bookingId: booking.id });\n}\n\nasync function getUserName(base44, email) {\n  try {\n    const users = await base44.asServiceRole.entities.User.filter({ email });\n    return users[0]?.full_name || 'User';\n  } catch {\n    return 'User';\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\EmailNotificationService.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'vars' is defined but never used. Allowed unused args must match /^_/u.","line":171,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":171,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"vars"},"fix":{"range":[7482,7486],"text":""},"desc":"Remove unused variable 'vars'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\n\n// Email & SMS Template System for PureTask\n// Based on comprehensive messaging document\n\nconst TEMPLATES = {\n  // CLIENT EMAILS\n  'email.client.welcome': {\n    subject: 'Welcome to PureTask ‚Äî Your clean home starts here ‚ú®',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Thanks for joining <strong>PureTask</strong> ‚Äî the easiest way to book verified cleaners on your schedule.</p>\n        \n        <p>With PureTask, you get:</p>\n        <ul>\n          <li>‚úÖ GPS check-in / check-out</li>\n          <li>‚úÖ Before & after photos</li>\n          <li>‚úÖ Reliability Score for every cleaner</li>\n        </ul>\n        \n        <p>üëâ Book your first cleaning anytime:<br/>\n        <a href=\"${vars.booking_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Book Now</a></p>\n        \n        <p>Have questions? Just reply ‚Äî a real human will answer.</p>\n        <p>‚Äî The PureTask Team</p>\n      </div>\n    `,\n    sms: null\n  },\n\n  'email.client.booking_confirmation': {\n    subject: (vars) => `‚úÖ Your cleaning is booked! ${vars.date} at ${vars.time}`,\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>You're all set. Here are the details:</p>\n        \n        <div style=\"background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <p><strong>Cleaner:</strong> ${vars.cleaner_name}</p>\n          <p><strong>Arrival Window:</strong> ${vars.date} ‚Äî ${vars.time}</p>\n          <p><strong>Service Address:</strong> ${vars.address}</p>\n          <p><strong>Total Estimate:</strong> ${vars.price}</p>\n        </div>\n        \n        <p>Your cleaner will:</p>\n        <ul>\n          <li>GPS check-in upon arrival</li>\n          <li>Upload before & after photos</li>\n          <li>Check-out only after service is completed</li>\n        </ul>\n        \n        <p>Need to update or reschedule?<br/>\n        üëâ <a href=\"${vars.manage_booking_link}\" style=\"color: #10b981;\">Manage Booking</a></p>\n        \n        <p>We appreciate you choosing PureTask.</p>\n      </div>\n    `,\n    sms: (vars) => `‚úÖ Your cleaning is booked for ${vars.date} at ${vars.time}. Cleaner: ${vars.cleaner_name}. Manage: ${vars.manage_booking_link}`\n  },\n\n  'email.client.cleaner_on_way': {\n    subject: 'Your cleaner is on the way! üöó‚ú®',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>${vars.cleaner_name} just checked in and is heading to your location.</p>\n        <p>You'll receive another update when they arrive.</p>\n        <p>‚Äî PureTask Team</p>\n      </div>\n    `,\n    sms: (vars) => `üöó Your cleaner ${vars.cleaner_name} is on the way to your address.`\n  },\n\n  'email.client.cleaning_completed': {\n    subject: '‚úÖ Cleaning completed ‚Äî how did we do?',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Your cleaning is now finished. Payment is processing.</p>\n        \n        <p>‚úî Before & after photos uploaded<br/>\n        ‚úî GPS check-out completed</p>\n        \n        <p>Rate your cleaner (optional but appreciated):<br/>\n        <a href=\"${vars.rate_cleaner_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Rate Cleaner</a></p>\n        \n        <p>Thank you for using PureTask!</p>\n      </div>\n    `,\n    sms: (vars) => `‚ú® Cleaning complete! Rate your cleaner: ${vars.rate_cleaner_link}`\n  },\n\n  'email.client.review_request': {\n    subject: 'Quick rating? It helps small cleaners grow üíõ',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Your feedback helps great cleaners earn more and get priority bookings.</p>\n        \n        <p>Rate your cleaner here:<br/>\n        üëâ <a href=\"${vars.rate_cleaner_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Leave Review</a></p>\n        \n        <p>Thanks for supporting independent cleaners üôå</p>\n      </div>\n    `,\n    sms: (vars) => `How did we do? Leave a quick rating (10 seconds): ${vars.rate_cleaner_link}`\n  },\n\n  // CLEANER EMAILS\n  'email.cleaner.welcome': {\n    subject: 'Welcome to PureTask ‚Äî earn more by doing great work ‚úÖ',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.cleaner_name},</h2>\n        <p>Welcome aboard! You now have access to clients in your area.</p>\n        \n        <p>Your earnings increase based on your <strong>Reliability Score</strong>.</p>\n        \n        <p>Reliability Score = Show up + great service + happy customers<br/>\n        Higher score = higher pay + priority placement + instant booking access.</p>\n        \n        <p>Start accepting bookings:<br/>\n        üëâ <a href=\"${vars.cleaner_dashboard_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Open Dashboard</a></p>\n        \n        <p>Let's build your business.</p>\n      </div>\n    `,\n    sms: null\n  },\n\n  'email.cleaner.job_invited': {\n    subject: (vars) => `üö® New Job Available ‚Äî ${vars.date} @ ${vars.time}`,\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hey ${vars.cleaner_name},</h2>\n        <p>A customer selected you for a cleaning job.</p>\n        \n        <div style=\"background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <p><strong>Service:</strong> ${vars.job_type}</p>\n          <p><strong>Date:</strong> ${vars.date}</p>\n          <p><strong>Pay:</strong> $${vars.pay}</p>\n        </div>\n        \n        <p>üëâ <a href=\"${vars.job_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px;\">Accept or Decline</a></p>\n      </div>\n    `,\n    sms: (vars) => `üö® New Job Available! ${vars.date} @ ${vars.time} ‚Äî Pay $${vars.pay}. Accept here: ${vars.job_link}`\n  },\n\n  'email.cleaner.job_confirmed': {\n    subject: (vars) => `You're booked! ${vars.date} @ ${vars.time}`,\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>You're confirmed for the job below:</h2>\n        \n        <p><strong>Customer:</strong> ${vars.customer_name}<br/>\n        <strong>Check-in:</strong> Must GPS check-in when arriving<br/>\n        <strong>Photos:</strong> Upload before & after</p>\n        \n        <p style=\"background: #fef3c7; padding: 15px; border-radius: 8px;\">\n          ‚ö†Ô∏è Your Reliability Score depends on completing these steps.\n        </p>\n      </div>\n    `,\n    sms: (vars) => `‚úÖ You're booked for ${vars.date} @ ${vars.time}. Remember: GPS check-in + photos required.`\n  },\n\n  'email.cleaner.reliability_changed': {\n    subject: (vars) => `Update: Your Reliability Score changed üìà`,\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hey ${vars.cleaner_name},</h2>\n        <p>Your Reliability Score is now <strong>${vars.score}</strong>.</p>\n        \n        <p>Keep doing great work and you unlock:</p>\n        <ul>\n          <li>Higher pay</li>\n          <li>Priority placement</li>\n          <li>Instant Booking</li>\n        </ul>\n        \n        <p><a href=\"${vars.score_dashboard_link}\" style=\"color: #10b981;\">View score breakdown</a></p>\n      </div>\n    `,\n    sms: (vars) => `üìä Update: Your Reliability Score is now ${vars.score}. Better score = higher pay + priority placement.`\n  },\n\n  // MARKETING EMAILS\n  'email.marketing.first_cleaning': {\n    subject: 'Get $25 off your first cleaning ‚ú®',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Try PureTask and get:</p>\n        <ul>\n          <li>‚ú® Verified cleaners</li>\n          <li>‚ú® Before & after photos</li>\n          <li>‚ú® Reliability Score (no guesswork)</li>\n        </ul>\n        \n        <p>Use code: <strong>CLEAN25</strong></p>\n        <p><a href=\"${vars.booking_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Book Now</a></p>\n      </div>\n    `,\n    sms: (vars) => `‚ú® Get $25 off your first PureTask cleaning. Use code: CLEAN25. Book now: ${vars.booking_link}`\n  },\n\n  'email.marketing.winback': {\n    subject: (vars) => `We miss you ‚Äî here's $${vars.credit} off`,\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Haven't seen you in a while ‚Äî here's a $${vars.credit} credit on your account.</p>\n        \n        <p>No code needed.<br/>\n        Just book: <a href=\"${vars.booking_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Book Cleaning</a></p>\n      </div>\n    `,\n    sms: (vars) => `We miss you üßΩ Come back and get $${vars.credit} off your next cleaning. Book here: ${vars.booking_link}`\n  },\n\n  'email.marketing.referral': {\n    subject: 'Give $20, Get $20 ü§ù',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>When you share your link:</h2>\n        <p>Your friend gets <strong>$20 off</strong>,<br/>\n        You get <strong>$20 PureTask credit</strong> after their first cleaning.</p>\n        \n        <p>Referral link:<br/>\n        <a href=\"${vars.referral_link}\" style=\"display: inline-block; background: #10b981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Share PureTask</a></p>\n      </div>\n    `,\n    sms: (vars) => `Give $20, Get $20 ü§ù Share this link: ${vars.referral_link}`\n  },\n\n  // SYSTEM EMAILS\n  'email.system.payment_failed': {\n    subject: 'Payment issue ‚Äî action required',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2 style=\"color: #dc2626;\">Payment Issue</h2>\n        <p>We couldn't process your payment for your recent cleaning.</p>\n        \n        <p><strong>Reason:</strong> ${vars.reason || 'Card declined'}</p>\n        \n        <p><a href=\"${vars.payment_link}\" style=\"display: inline-block; background: #dc2626; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; margin-top: 10px;\">Update Payment Info</a></p>\n      </div>\n    `,\n    sms: (vars) => `‚ö†Ô∏è Payment failed. Update payment to avoid account lock: ${vars.payment_link}`\n  },\n\n  'email.system.payment_receipt': {\n    subject: 'Invoice for your recent cleaning üßæ',\n    html: (vars) => `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Hi ${vars.first_name},</h2>\n        <p>Here's your receipt for the cleaning completed on ${vars.date}.</p>\n        \n        <div style=\"background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n          <p><strong>Amount Charged:</strong> ${vars.price}</p>\n          <p><strong>Cleaner:</strong> ${vars.cleaner_name}</p>\n        </div>\n        \n        <p>Thanks again for choosing PureTask!</p>\n      </div>\n    `,\n    sms: (vars) => `üßæ Payment processed: ${vars.price}. Receipt sent to your email.`\n  }\n};\n\n// Main notification service\nexport async function sendNotification(templateId, recipientEmail, variables, options = {}) {\n  try {\n    const template = TEMPLATES[templateId];\n    if (!template) {\n      console.error(`Template ${templateId} not found`);\n      return { success: false, error: 'Template not found' };\n    }\n\n    const results = {};\n\n    // Build base URL for app links\n    const baseUrl = window.location.origin;\n    const enrichedVars = {\n      ...variables,\n      booking_link: variables.booking_link || `${baseUrl}${createPageUrl('BrowseCleaners')}`,\n      manage_booking_link: variables.manage_booking_link || (variables.booking_id ? `${baseUrl}${createPageUrl('BookingHistory')}` : ''),\n      cleaner_dashboard_link: variables.cleaner_dashboard_link || `${baseUrl}${createPageUrl('CleanerDashboard')}`,\n      rate_cleaner_link: variables.rate_cleaner_link || (variables.booking_id ? `${baseUrl}${createPageUrl('BookingHistory')}` : ''),\n      score_dashboard_link: variables.score_dashboard_link || `${baseUrl}${createPageUrl('CleanerInsights')}`,\n      job_link: variables.job_link || `${baseUrl}${createPageUrl('CleanerJobs')}`,\n      payment_link: variables.payment_link || `${baseUrl}${createPageUrl('Profile')}`,\n      referral_link: variables.referral_link || `${baseUrl}${createPageUrl('Home')}`\n    };\n\n    // Send Email (default behavior unless disabled)\n    if (options.sendEmail !== false && template.html) {\n      try {\n        const subject = typeof template.subject === 'function' \n          ? template.subject(enrichedVars) \n          : template.subject;\n        \n        const body = typeof template.html === 'function'\n          ? template.html(enrichedVars)\n          : template.html;\n\n        await base44.integrations.Core.SendEmail({\n          to: recipientEmail,\n          subject: subject,\n          body: body\n        });\n\n        // Log delivery\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `email_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: templateId.replace('email.', '').replace('.', '_'),\n          channel: 'email',\n          status: 'sent',\n          template_id: templateId,\n          recipient_email: recipientEmail,\n          subject: subject,\n          body: body,\n          metadata: variables,\n          sent_at: new Date().toISOString(),\n          can_retry: true\n        });\n\n        results.email = 'sent';\n      } catch (emailError) {\n        console.error('Email send error:', emailError);\n        results.email = 'failed';\n        \n        // Log failure\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `email_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: templateId.replace('email.', '').replace('.', '_'),\n          channel: 'email',\n          status: 'failed',\n          template_id: templateId,\n          recipient_email: recipientEmail,\n          error_message: emailError.message,\n          metadata: variables,\n          can_retry: true\n        });\n      }\n    }\n\n    // Send SMS (if template has SMS version and enabled)\n    if (options.sendSMS && template.sms && variables.phone) {\n      try {\n        const smsBody = typeof template.sms === 'function'\n          ? template.sms(enrichedVars)\n          : template.sms;\n\n        // Note: SMS sending would require Twilio integration\n        // For now, we'll log it to MessageDeliveryLog\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `sms_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: templateId.replace('email.', 'sms.').replace('.', '_'),\n          channel: 'sms',\n          status: 'pending',\n          template_id: templateId.replace('email.', 'sms.'),\n          recipient_phone: variables.phone,\n          body: smsBody,\n          metadata: variables,\n          can_retry: true\n        });\n\n        results.sms = 'logged';\n      } catch (smsError) {\n        console.error('SMS log error:', smsError);\n        results.sms = 'failed';\n      }\n    }\n\n    return { success: true, results };\n  } catch (error) {\n    console.error('Notification service error:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// Convenience functions for specific scenarios\nexport async function sendBookingConfirmation(booking, clientName, cleanerName) {\n  return sendNotification('email.client.booking_confirmation', booking.client_email, {\n    first_name: clientName.split(' ')[0],\n    cleaner_name: cleanerName,\n    date: new Date(booking.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' }),\n    time: booking.start_time,\n    address: booking.address,\n    price: `$${booking.total_price}`,\n    booking_id: booking.id,\n    manage_booking_link: `${window.location.origin}${createPageUrl('BookingHistory')}`\n  });\n}\n\nexport async function sendCleanerOnWay(booking, clientName, cleanerName) {\n  return sendNotification('email.client.cleaner_on_way', booking.client_email, {\n    first_name: clientName.split(' ')[0],\n    cleaner_name: cleanerName,\n    booking_id: booking.id\n  }, { sendSMS: true, phone: booking.client_phone });\n}\n\nexport async function sendCleaningCompleted(booking, clientName) {\n  return sendNotification('email.client.cleaning_completed', booking.client_email, {\n    first_name: clientName.split(' ')[0],\n    booking_id: booking.id,\n    rate_cleaner_link: `${window.location.origin}${createPageUrl('BookingHistory')}`\n  }, { sendSMS: true, phone: booking.client_phone });\n}\n\nexport async function sendWelcomeEmail(userEmail, userName, userType) {\n  const templateId = userType === 'client' ? 'email.client.welcome' : 'email.cleaner.welcome';\n  const firstName = userName.split(' ')[0];\n  \n  return sendNotification(templateId, userEmail, {\n    first_name: firstName,\n    cleaner_name: userName,\n    booking_link: `${window.location.origin}${createPageUrl('BrowseCleaners')}`,\n    cleaner_dashboard_link: `${window.location.origin}${createPageUrl('CleanerDashboard')}`\n  });\n}\n\nexport async function sendJobInvite(booking, cleanerEmail, cleanerName) {\n  return sendNotification('email.cleaner.job_invited', cleanerEmail, {\n    cleaner_name: cleanerName,\n    job_type: booking.tasks?.join(', ') || 'Standard Clean',\n    date: new Date(booking.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' }),\n    time: booking.start_time,\n    pay: booking.total_price * 0.85, // 85% goes to cleaner\n    job_link: `${window.location.origin}${createPageUrl('CleanerJobs')}`\n  }, { sendSMS: true, phone: booking.cleaner_phone });\n}\n\nexport async function sendReliabilityScoreUpdate(cleanerEmail, cleanerName, newScore, oldScore) {\n  const changes = [];\n  if (newScore > oldScore) changes.push(`‚úÖ Score increased [+${newScore - oldScore}]`);\n  if (newScore < oldScore) changes.push(`‚ö† Score decreased [-${oldScore - newScore}]`);\n  \n  return sendNotification('email.cleaner.reliability_changed', cleanerEmail, {\n    cleaner_name: cleanerName,\n    score: newScore,\n    changes: changes.join(', '),\n    score_dashboard_link: `${window.location.origin}${createPageUrl('CleanerInsights')}`\n  }, { sendSMS: true });\n}\n\nexport async function sendPaymentReceipt(booking, clientEmail, clientName, cleanerName) {\n  return sendNotification('email.system.payment_receipt', clientEmail, {\n    first_name: clientName.split(' ')[0],\n    date: new Date(booking.date).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }),\n    price: `$${booking.total_price}`,\n    cleaner_name: cleanerName,\n    booking_id: booking.id\n  }, { sendSMS: true, phone: booking.client_phone });\n}\n\nexport async function sendPaymentFailed(booking, clientEmail, clientName, reason) {\n  return sendNotification('email.system.payment_failed', clientEmail, {\n    first_name: clientName.split(' ')[0],\n    booking_id: booking.id,\n    reason: reason,\n    payment_link: `${window.location.origin}${createPageUrl('Profile')}`\n  }, { sendSMS: true, phone: booking.client_phone });\n}\n\nexport async function sendReviewRequest(booking, clientEmail, clientName) {\n  return sendNotification('email.client.review_request', clientEmail, {\n    first_name: clientName.split(' ')[0],\n    booking_id: booking.id,\n    rate_cleaner_link: `${window.location.origin}${createPageUrl('BookingHistory')}`\n  }, { sendSMS: true, phone: booking.client_phone });\n}\n\nexport async function sendWinbackEmail(clientEmail, clientName, creditAmount = 20) {\n  return sendNotification('email.marketing.winback', clientEmail, {\n    first_name: clientName.split(' ')[0],\n    credit: creditAmount,\n    booking_link: `${window.location.origin}${createPageUrl('BrowseCleaners')}`\n  }, { sendSMS: true });\n}\n\nexport async function sendReferralInvite(referrerEmail, referrerName, referralLink) {\n  return sendNotification('email.marketing.referral', referrerEmail, {\n    first_name: referrerName.split(' ')[0],\n    referral_link: referralLink\n  }, { sendSMS: true });\n}\n\nexport default {\n  sendNotification,\n  sendBookingConfirmation,\n  sendCleanerOnWay,\n  sendCleaningCompleted,\n  sendWelcomeEmail,\n  sendJobInvite,\n  sendReliabilityScoreUpdate,\n  sendPaymentReceipt,\n  sendPaymentFailed,\n  sendReviewRequest,\n  sendWinbackEmail,\n  sendReferralInvite,\n  TEMPLATES\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\EmailService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\JobStartNotifications.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\NotificationDispatcher.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'options' is assigned a value but never used. Allowed unused args must match /^_/u.","line":17,"column":91,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":98,"suggestions":[{"messageId":"removeVar","data":{"varName":"options"},"fix":{"range":[654,668],"text":""},"desc":"Remove unused variable 'options'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { renderEmailTemplate, renderSMSTemplate, renderPushTemplate, validateVariables } from './TemplateRenderer';\n\n/**\n * Notification Dispatcher - Sends multi-channel notifications using templates\n * Handles Email, SMS, and Push notifications with logging\n */\n\n// Helper to build full URLs for email links\nfunction buildFullUrl(pageName, params = '') {\n  const baseUrl = window.location.origin;\n  const path = createPageUrl(pageName);\n  return `${baseUrl}${path}${params}`;\n}\n\nexport async function sendNotificationFromTemplate(templateId, recipientEmail, variables, options = {}) {\n  try {\n    // Load template\n    const templates = await base44.entities.EmailTemplate.filter({ \n      template_id: templateId, \n      is_active: true \n    });\n    \n    if (templates.length === 0) {\n      console.error(`Template ${templateId} not found or inactive`);\n      return { success: false, error: 'Template not found' };\n    }\n    \n    const template = templates[0];\n    \n    // Validate variables\n    const validation = validateVariables(template, variables);\n    if (!validation.valid) {\n      console.warn(`Missing variables for ${templateId}:`, validation.missing);\n    }\n    \n    const results = {};\n    const eventId = `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const eventName = templateId.replace('email.', '').replace(/\\./g, '_');\n    \n    // Send Email\n    if (template.send_email && template.html_body) {\n      try {\n        const rendered = renderEmailTemplate(template, variables);\n        \n        await base44.integrations.Core.SendEmail({\n          to: recipientEmail,\n          subject: rendered.subject,\n          body: rendered.html\n        });\n        \n        // Log delivery\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `email_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: eventName,\n          channel: 'email',\n          status: 'sent',\n          template_id: templateId,\n          recipient_email: recipientEmail,\n          subject: rendered.subject,\n          body: rendered.html,\n          metadata: { variables, event_id: eventId },\n          sent_at: new Date().toISOString(),\n          provider: 'internal',\n          can_retry: true\n        });\n        \n        results.email = 'sent';\n      } catch (emailError) {\n        console.error('Email send error:', emailError);\n        \n        // Log failure\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `email_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: eventName,\n          channel: 'email',\n          status: 'failed',\n          template_id: templateId,\n          recipient_email: recipientEmail,\n          error_message: emailError.message,\n          metadata: { variables, event_id: eventId },\n          provider: 'internal',\n          can_retry: true\n        });\n        \n        results.email = 'failed';\n      }\n    }\n    \n    // Send SMS (if enabled and phone provided)\n    if (template.send_sms && template.sms_body && variables.phone) {\n      try {\n        const smsBody = renderSMSTemplate(template, variables);\n        \n        // Log SMS (actual sending would require Twilio integration)\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `sms_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: eventName,\n          channel: 'sms',\n          status: 'pending',\n          template_id: templateId.replace('email.', 'sms.'),\n          recipient_phone: variables.phone,\n          body: smsBody,\n          metadata: { variables, event_id: eventId },\n          provider: 'internal',\n          can_retry: true\n        });\n        \n        results.sms = 'logged';\n      } catch (smsError) {\n        console.error('SMS log error:', smsError);\n        results.sms = 'failed';\n      }\n    }\n    \n    // Send Push (if enabled)\n    if (template.send_push && template.push_title && variables.user_id) {\n      try {\n        const push = renderPushTemplate(template, variables);\n        \n        // Log push (actual sending would require OneSignal/FCM integration)\n        await base44.entities.MessageDeliveryLog.create({\n          delivery_id: `push_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          event_name: eventName,\n          channel: 'push',\n          status: 'pending',\n          template_id: templateId.replace('email.', 'push.'),\n          recipient_email: recipientEmail,\n          subject: push.title,\n          body: push.body,\n          metadata: { \n            variables, \n            event_id: eventId,\n            deep_link: push.deepLink \n          },\n          provider: 'internal',\n          can_retry: true\n        });\n        \n        results.push = 'logged';\n      } catch (pushError) {\n        console.error('Push log error:', pushError);\n        results.push = 'failed';\n      }\n    }\n    \n    return { success: true, results, event_id: eventId };\n  } catch (error) {\n    console.error('Notification dispatcher error:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// Convenience wrapper functions for common scenarios\nexport async function sendBookingConfirmation(booking, client, cleaner) {\n  const variables = {\n    first_name: client.full_name?.split(' ')[0] || 'there',\n    cleaner_name: cleaner.full_name,\n    date: new Date(booking.date).toLocaleDateString('en-US', { \n      weekday: 'long', month: 'long', day: 'numeric' \n    }),\n    time: booking.start_time,\n    address: booking.address,\n    price: `$${booking.total_price}`,\n    booking_id: booking.id,\n    manage_booking_link: buildFullUrl('BookingHistory'),\n    link: buildFullUrl('BookingHistory'),\n    phone: client.phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.booking_confirmation',\n    booking.client_email,\n    variables\n  );\n}\n\nexport async function sendCleanerOnWay(booking, client, cleaner) {\n  const variables = {\n    first_name: client.full_name?.split(' ')[0] || 'there',\n    cleaner_name: cleaner.full_name,\n    booking_id: booking.id,\n    link: buildFullUrl('BookingHistory'),\n    phone: client.phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.cleaner_on_way',\n    booking.client_email,\n    variables\n  );\n}\n\nexport async function sendCleaningCompleted(booking, client) {\n  const variables = {\n    first_name: client.full_name?.split(' ')[0] || 'there',\n    booking_id: booking.id,\n    rate_cleaner_link: buildFullUrl('BookingHistory'),\n    link: buildFullUrl('BookingHistory'),\n    phone: client.phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.cleaning_completed',\n    booking.client_email,\n    variables\n  );\n}\n\nexport async function sendWelcomeClient(clientEmail, clientName) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    booking_link: buildFullUrl('BrowseCleaners'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.welcome',\n    clientEmail,\n    variables\n  );\n}\n\nexport async function sendWelcomeCleaner(cleanerEmail, cleanerName) {\n  const variables = {\n    cleaner_name: cleanerName,\n    cleaner_dashboard_link: buildFullUrl('CleanerDashboard'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.cleaner.welcome',\n    cleanerEmail,\n    variables\n  );\n}\n\nexport async function sendJobInvite(booking, cleanerEmail, cleanerName) {\n  const variables = {\n    cleaner_name: cleanerName,\n    job_type: booking.tasks?.join(', ') || 'Standard Clean',\n    date: new Date(booking.date).toLocaleDateString('en-US', { \n      weekday: 'long', month: 'long', day: 'numeric' \n    }),\n    time: booking.start_time,\n    pay: (booking.total_price * 0.85).toFixed(2),\n    job_link: buildFullUrl('BrowseJobs'),\n    link: buildFullUrl('BrowseJobs'),\n    job_id: booking.id,\n    accept_url: buildFullUrl('BrowseJobs'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.cleaner.job_invited',\n    cleanerEmail,\n    variables\n  );\n}\n\nexport async function sendReliabilityScoreUpdate(cleanerEmail, cleanerName, newScore, oldScore) {\n  const variables = {\n    cleaner_name: cleanerName,\n    score: newScore,\n    old_score: oldScore,\n    score_dashboard_link: buildFullUrl('CleanerAnalytics'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.cleaner.reliability_changed',\n    cleanerEmail,\n    variables\n  );\n}\n\nexport async function sendReviewRequest(booking, clientEmail, clientName) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    booking_id: booking.id,\n    rate_cleaner_link: buildFullUrl('BookingHistory'),\n    link: buildFullUrl('BookingHistory'),\n    phone: booking.client_phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.review_request',\n    clientEmail,\n    variables\n  );\n}\n\nexport async function sendPaymentReceipt(booking, clientEmail, clientName, cleanerName) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    date: new Date(booking.date).toLocaleDateString('en-US', { \n      month: 'long', day: 'numeric', year: 'numeric' \n    }),\n    price: `$${booking.total_price}`,\n    cleaner_name: cleanerName,\n    amount: booking.total_price,\n    booking_id: booking.id,\n    phone: booking.client_phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.client.receipt',\n    clientEmail,\n    variables\n  );\n}\n\nexport async function sendPaymentFailed(booking, clientEmail, clientName, reason) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    booking_id: booking.id,\n    reason: reason || 'Card declined',\n    payment_link: buildFullUrl('Profile'),\n    link: buildFullUrl('Profile'),\n    phone: booking.client_phone,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.system.payment_failed',\n    clientEmail,\n    variables\n  );\n}\n\nexport async function sendWinbackEmail(clientEmail, clientName, creditAmount = 20) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    credit: creditAmount,\n    booking_link: buildFullUrl('BrowseCleaners'),\n    link: buildFullUrl('BrowseCleaners'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.marketing.winback',\n    clientEmail,\n    variables\n  );\n}\n\nexport async function sendReferralEmail(referrerEmail, referrerName, referralLink) {\n  const variables = {\n    first_name: referrerName.split(' ')[0],\n    referral_link: referralLink,\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.marketing.referral',\n    referrerEmail,\n    variables\n  );\n}\n\nexport async function sendFirstCleaningPromo(clientEmail, clientName) {\n  const variables = {\n    first_name: clientName.split(' ')[0],\n    booking_link: buildFullUrl('BrowseCleaners'),\n    link: buildFullUrl('BrowseCleaners'),\n    year: new Date().getFullYear()\n  };\n  \n  return sendNotificationFromTemplate(\n    'email.marketing.first_cleaning',\n    clientEmail,\n    variables\n  );\n}\n\nexport default {\n  sendNotificationFromTemplate,\n  sendBookingConfirmation,\n  sendCleanerOnWay,\n  sendCleaningCompleted,\n  sendWelcomeClient,\n  sendWelcomeCleaner,\n  sendJobInvite,\n  sendReliabilityScoreUpdate,\n  sendReviewRequest,\n  sendPaymentReceipt,\n  sendPaymentFailed,\n  sendWinbackEmail,\n  sendReferralEmail,\n  sendFirstCleaningPromo\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\NotificationDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\NotificationService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\ProactiveNotifications.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\TemplateRenderer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\notifications\\TemplateSeeder.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\offers\\BundleOfferCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\onboarding\\ClientOnboardingTutorial.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":21,"fix":{"range":[189,202],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[190,202],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { CheckCircle, Search, Calendar, Star } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function ClientOnboardingTutorial({ open, onComplete }) {\n  const [step, setStep] = useState(0);\n\n  const steps = [\n    {\n      icon: <Search className=\"w-16 h-16 text-blue-500\" />,\n      title: 'Welcome to PureTask!',\n      description: 'Let\\'s show you how easy it is to book a verified cleaner in 3 simple steps.',\n      action: 'Get Started'\n    },\n    {\n      icon: <Search className=\"w-16 h-16 text-emerald-500\" />,\n      title: '1. Find Your Perfect Cleaner',\n      description: 'Browse verified cleaners or use our Smart Matching to get personalized recommendations. Filter by specialty, ratings, and price.',\n      action: 'Next'\n    },\n    {\n      icon: <Calendar className=\"w-16 h-16 text-purple-500\" />,\n      title: '2. Book in Minutes',\n      description: 'Pick your date, select tasks, and add any special instructions. We\\'ll hold payment until the job is done to your satisfaction.',\n      action: 'Next'\n    },\n    {\n      icon: <Star className=\"w-16 h-16 text-amber-500\" />,\n      title: '3. Relax & Enjoy',\n      description: 'Track your cleaner with GPS, get before/after photos, and rate your experience. Your satisfaction is guaranteed!',\n      action: 'Start Booking'\n    }\n  ];\n\n  const currentStep = steps[step];\n\n  const handleNext = () => {\n    if (step < steps.length - 1) {\n      setStep(step + 1);\n    } else {\n      onComplete();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={() => {}}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <div className=\"flex justify-between items-center mb-4\">\n            <div className=\"flex gap-2\">\n              {steps.map((_, index) => (\n                <div\n                  key={index}\n                  className={`h-2 rounded-full transition-all ${\n                    index === step ? 'w-8 bg-blue-500' : 'w-2 bg-slate-300'\n                  }`}\n                />\n              ))}\n            </div>\n            <span className=\"text-sm text-slate-500\">\n              {step + 1} / {steps.length}\n            </span>\n          </div>\n        </DialogHeader>\n\n        <AnimatePresence mode=\"wait\">\n          <motion.div\n            key={step}\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n            className=\"text-center py-8\"\n          >\n            <motion.div\n              animate={{ y: [0, -10, 0] }}\n              transition={{ repeat: Infinity, duration: 2, ease: \"easeInOut\" }}\n              className=\"mb-6\"\n            >\n              {currentStep.icon}\n            </motion.div>\n\n            <DialogTitle className=\"text-2xl font-bold text-slate-900 mb-4\">\n              {currentStep.title}\n            </DialogTitle>\n\n            <p className=\"text-slate-600 mb-8\">\n              {currentStep.description}\n            </p>\n\n            <div className=\"flex gap-3\">\n              {step > 0 && (\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setStep(step - 1)}\n                  className=\"flex-1\"\n                >\n                  Back\n                </Button>\n              )}\n              <Button\n                onClick={handleNext}\n                className={`${step === 0 ? 'w-full' : 'flex-1'} bg-gradient-to-r from-blue-500 to-cyan-500`}\n              >\n                {currentStep.action}\n              </Button>\n            </div>\n\n            {step === steps.length - 1 && (\n              <button\n                onClick={onComplete}\n                className=\"mt-4 text-sm text-slate-500 hover:text-slate-700\"\n              >\n                Skip tutorial\n              </button>\n            )}\n          </motion.div>\n        </AnimatePresence>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\onboarding\\ClientQuestionnaire.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":11,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":46,"fix":{"range":[658,665],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[657,664],"text":""},"desc":"Remove unused variable 'Clock'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Progress } from '@/components/ui/progress';\nimport { Home, MapPin, Phone, Calendar, Clock, Heart, Shield, CheckCircle } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function ClientQuestionnaire({ initialData = {}, onComplete, onSkip }) {\n  const [step, setStep] = useState(1);\n  const [formData, setFormData] = useState({\n    // Contact Info\n    phone_number: initialData.phone_number || '',\n    \n    // Home Details\n    default_address: initialData.default_address || '',\n    default_address_line2: initialData.default_address_line2 || '',\n    default_city: initialData.default_city || '',\n    default_state: initialData.default_state || '',\n    default_zip: initialData.default_zip || '',\n    default_bedrooms: initialData.default_bedrooms || '',\n    default_bathrooms: initialData.default_bathrooms || '',\n    default_square_feet: initialData.default_square_feet || '',\n    default_home_type: initialData.default_home_type || 'house',\n    \n    // Pets & Access\n    has_pets: initialData.has_pets || false,\n    pet_details: initialData.pet_details || '',\n    default_parking_instructions: initialData.default_parking_instructions || '',\n    default_entry_instructions: initialData.default_entry_instructions || '',\n    \n    // Preferences\n    preferred_days: initialData.preferred_days || [],\n    preferred_time_of_day: initialData.preferred_time_of_day || 'flexible',\n    preferred_frequency: initialData.preferred_frequency || 'as_needed',\n    product_preferences: initialData.product_preferences || '',\n    product_allergies: initialData.product_allergies || '',\n    special_requests: initialData.special_requests || '',\n    preferred_specialty_tags: initialData.preferred_specialty_tags || [],\n    preferred_additional_services: initialData.preferred_additional_services || [],\n    \n    // Detailed Cleaning Preferences\n    focus_areas: initialData.focus_areas || '',\n    avoid_areas: initialData.avoid_areas || '',\n    pet_temperament: initialData.pet_temperament || '',\n    cleaning_priorities: initialData.cleaning_priorities || [],\n    \n    // Alternate Contact\n    alternate_email: initialData.alternate_email || ''\n  });\n\n  const totalSteps = 6;\n  const progress = (step / totalSteps) * 100;\n\n  const handleChange = (field, value) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleDayToggle = (day) => {\n    setFormData(prev => ({\n      ...prev,\n      preferred_days: prev.preferred_days.includes(day)\n        ? prev.preferred_days.filter(d => d !== day)\n        : [...prev.preferred_days, day]\n    }));\n  };\n\n  const handleSpecialtyToggle = (tag) => {\n    setFormData(prev => ({\n      ...prev,\n      preferred_specialty_tags: prev.preferred_specialty_tags.includes(tag)\n        ? prev.preferred_specialty_tags.filter(t => t !== tag)\n        : [...prev.preferred_specialty_tags, tag]\n    }));\n  };\n\n  const handleServiceToggle = (service) => {\n    setFormData(prev => ({\n      ...prev,\n      preferred_additional_services: prev.preferred_additional_services.includes(service)\n        ? prev.preferred_additional_services.filter(s => s !== service)\n        : [...prev.preferred_additional_services, service]\n    }));\n  };\n\n  const handlePriorityToggle = (priority) => {\n    setFormData(prev => ({\n      ...prev,\n      cleaning_priorities: prev.cleaning_priorities.includes(priority)\n        ? prev.cleaning_priorities.filter(p => p !== priority)\n        : [...prev.cleaning_priorities, priority]\n    }));\n  };\n\n  const nextStep = () => {\n    if (step < totalSteps) setStep(step + 1);\n  };\n\n  const prevStep = () => {\n    if (step > 1) setStep(step - 1);\n  };\n\n  const handleSubmit = () => {\n    onComplete(formData);\n  };\n\n  const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n  const specialties = [\n    'Pet-Friendly',\n    'Eco-Warrior',\n    'Deep Clean Expert',\n    'Move-Out Specialist',\n    'Same-Day Available',\n    'Senior-Friendly',\n    'Child-Safe Products',\n    'Allergy-Conscious'\n  ];\n\n  const additionalServices = [\n    { value: 'windows', label: 'Windows', icon: 'ü™ü' },\n    { value: 'blinds', label: 'Blinds/Curtains', icon: 'ü™ü' },\n    { value: 'oven', label: 'Oven Deep Clean', icon: 'üî•' },\n    { value: 'refrigerator', label: 'Refrigerator', icon: '‚ùÑÔ∏è' },\n    { value: 'light_fixtures', label: 'Light Fixtures', icon: 'üí°' },\n    { value: 'inside_cabinets', label: 'Inside Cabinets', icon: 'üóÑÔ∏è' },\n    { value: 'baseboards', label: 'Baseboards', icon: 'üìè' },\n    { value: 'laundry', label: 'Laundry', icon: 'üëï' }\n  ];\n\n  return (\n    <div className=\"max-w-3xl mx-auto py-8 px-4\">\n      {/* Progress Bar */}\n      <div className=\"mb-8\">\n        <div className=\"flex justify-between items-center mb-2\">\n          <span className=\"text-sm font-fredoka font-medium text-graphite\">\n            Step {step} of {totalSteps}\n          </span>\n          <span className=\"text-sm font-verdana text-gray-500\">{Math.round(progress)}% Complete</span>\n        </div>\n        <Progress value={progress} className=\"h-2\" />\n      </div>\n\n      <AnimatePresence mode=\"wait\">\n        {/* STEP 1: Contact Information */}\n        {step === 1 && (\n          <motion.div\n            key=\"step1\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <Phone className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Contact Information</CardTitle>\n                    <CardDescription className=\"font-verdana\">How can we reach you?</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"phone\" className=\"font-fredoka\">Phone Number *</Label>\n                  <Input\n                    id=\"phone\"\n                    type=\"tel\"\n                    placeholder=\"(555) 123-4567\"\n                    value={formData.phone_number}\n                    onChange={(e) => handleChange('phone_number', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                    We'll use this to send booking confirmations and updates\n                  </p>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"alternate_email\" className=\"font-fredoka\">Alternate Email (Optional)</Label>\n                  <Input\n                    id=\"alternate_email\"\n                    type=\"email\"\n                    placeholder=\"alternate@email.com\"\n                    value={formData.alternate_email}\n                    onChange={(e) => handleChange('alternate_email', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                    An additional email for booking notifications or account recovery\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* STEP 2: Home Details */}\n        {step === 2 && (\n          <motion.div\n            key=\"step2\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <Home className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Home Details</CardTitle>\n                    <CardDescription className=\"font-verdana\">Tell us about your space</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"address\" className=\"font-fredoka\">Address *</Label>\n                  <Input\n                    id=\"address\"\n                    placeholder=\"123 Main Street\"\n                    value={formData.default_address}\n                    onChange={(e) => handleChange('default_address', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"address2\" className=\"font-fredoka\">Apt/Suite/Unit (Optional)</Label>\n                  <Input\n                    id=\"address2\"\n                    placeholder=\"Apt 4B\"\n                    value={formData.default_address_line2}\n                    onChange={(e) => handleChange('default_address_line2', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"city\" className=\"font-fredoka\">City *</Label>\n                    <Input\n                      id=\"city\"\n                      placeholder=\"San Francisco\"\n                      value={formData.default_city}\n                      onChange={(e) => handleChange('default_city', e.target.value)}\n                      className=\"mt-1\"\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"state\" className=\"font-fredoka\">State *</Label>\n                    <Input\n                      id=\"state\"\n                      placeholder=\"CA\"\n                      value={formData.default_state}\n                      onChange={(e) => handleChange('default_state', e.target.value)}\n                      className=\"mt-1\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"zip\" className=\"font-fredoka\">ZIP Code *</Label>\n                  <Input\n                    id=\"zip\"\n                    placeholder=\"94102\"\n                    value={formData.default_zip}\n                    onChange={(e) => handleChange('default_zip', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"home_type\" className=\"font-fredoka\">Home Type *</Label>\n                  <Select value={formData.default_home_type} onValueChange={(value) => handleChange('default_home_type', value)}>\n                    <SelectTrigger className=\"mt-1\">\n                      <SelectValue placeholder=\"Select home type\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"apartment\">Apartment</SelectItem>\n                      <SelectItem value=\"house\">House</SelectItem>\n                      <SelectItem value=\"condo\">Condo</SelectItem>\n                      <SelectItem value=\"townhouse\">Townhouse</SelectItem>\n                      <SelectItem value=\"office\">Office</SelectItem>\n                      <SelectItem value=\"other\">Other</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-2 block\">Bedrooms</Label>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    {[1, 2, 3, 4, 5, '5+'].map(num => (\n                      <button\n                        key={num}\n                        type=\"button\"\n                        onClick={() => handleChange('default_bedrooms', num === '5+' ? 6 : num)}\n                        className={`w-12 h-12 rounded-full font-fredoka font-semibold transition-all ${\n                          formData.default_bedrooms === (num === '5+' ? 6 : num)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        {num}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-2 block\">Bathrooms</Label>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    {[1, 1.5, 2, 2.5, 3, 3.5, '4+'].map(num => (\n                      <button\n                        key={num}\n                        type=\"button\"\n                        onClick={() => handleChange('default_bathrooms', num === '4+' ? 4 : num)}\n                        className={`w-12 h-12 rounded-full font-fredoka font-semibold transition-all ${\n                          formData.default_bathrooms === (num === '4+' ? 4 : num)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        {num}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-2 block\">Home Size (Square Feet)</Label>\n                  <div className=\"space-y-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => handleChange('default_square_feet', 800)}\n                      className={`w-full px-4 py-3 rounded-lg font-verdana text-sm transition-all text-left ${\n                        formData.default_square_feet === 800\n                          ? 'bg-green-500 text-white'\n                          : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                      }`}\n                    >\n                      1000 or less\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleChange('default_square_feet', 1500)}\n                      className={`w-full px-4 py-3 rounded-lg font-verdana text-sm transition-all text-left ${\n                        formData.default_square_feet === 1500\n                          ? 'bg-green-500 text-white'\n                          : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                      }`}\n                    >\n                      Less than 2500\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleChange('default_square_feet', 3000)}\n                      className={`w-full px-4 py-3 rounded-lg font-verdana text-sm transition-all text-left ${\n                        formData.default_square_feet === 3000\n                          ? 'bg-green-500 text-white'\n                          : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                      }`}\n                    >\n                      Above 2500 sq ft\n                    </button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* STEP 3: Access & Pets */}\n        {step === 3 && (\n          <motion.div\n            key=\"step3\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <MapPin className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Access & Pets</CardTitle>\n                    <CardDescription className=\"font-verdana\">Help cleaners prepare for their visit</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"parking\" className=\"font-fredoka\">Parking Instructions</Label>\n                  <Textarea\n                    id=\"parking\"\n                    placeholder=\"Street parking available on Main St. Use visitor spots in front of building.\"\n                    value={formData.default_parking_instructions}\n                    onChange={(e) => handleChange('default_parking_instructions', e.target.value)}\n                    className=\"mt-1\"\n                    rows={3}\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"entry\" className=\"font-fredoka\">Entry/Access Instructions</Label>\n                  <Textarea\n                    id=\"entry\"\n                    placeholder=\"Key is under the mat. Ring doorbell if locked. Gate code is #1234.\"\n                    value={formData.default_entry_instructions}\n                    onChange={(e) => handleChange('default_entry_instructions', e.target.value)}\n                    className=\"mt-1\"\n                    rows={3}\n                  />\n                </div>\n\n                <div className=\"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg\">\n                  <Checkbox\n                    id=\"pets\"\n                    checked={formData.has_pets}\n                    onCheckedChange={(checked) => handleChange('has_pets', checked)}\n                  />\n                  <div className=\"flex-1\">\n                    <Label htmlFor=\"pets\" className=\"font-fredoka cursor-pointer\">I have pets</Label>\n                    <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                      This helps us match you with pet-friendly cleaners\n                    </p>\n                  </div>\n                </div>\n\n                {formData.has_pets && (\n                  <>\n                    <div>\n                      <Label htmlFor=\"pet_details\" className=\"font-fredoka\">Pet Details</Label>\n                      <Textarea\n                        id=\"pet_details\"\n                        placeholder=\"1 friendly golden retriever, 2 cats (usually hide during visits)\"\n                        value={formData.pet_details}\n                        onChange={(e) => handleChange('pet_details', e.target.value)}\n                        className=\"mt-1\"\n                        rows={2}\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"pet_temperament\" className=\"font-fredoka\">Pet Temperament & Behavior</Label>\n                      <Textarea\n                        id=\"pet_temperament\"\n                        placeholder=\"Dog is very friendly and loves people. Cats might hiss but won't scratch. Keep bedroom door closed.\"\n                        value={formData.pet_temperament}\n                        onChange={(e) => handleChange('pet_temperament', e.target.value)}\n                        className=\"mt-1\"\n                        rows={3}\n                      />\n                      <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                        Help cleaners know what to expect and how to interact safely\n                      </p>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* STEP 4: Preferences */}\n        {step === 4 && (\n          <motion.div\n            key=\"step4\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <Calendar className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Scheduling Preferences</CardTitle>\n                    <CardDescription className=\"font-verdana\">When works best for you?</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div>\n                  <Label className=\"font-fredoka mb-3 block\">Preferred Days</Label>\n                  <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2\">\n                    {days.map(day => (\n                      <button\n                        key={day}\n                        onClick={() => handleDayToggle(day)}\n                        className={`px-3 py-2 rounded-lg font-fredoka text-sm transition-all ${\n                          formData.preferred_days.includes(day)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        {day.slice(0, 3)}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-2 block\">Preferred Time of Day</Label>\n                  <RadioGroup value={formData.preferred_time_of_day} onValueChange={(value) => handleChange('preferred_time_of_day', value)}>\n                    <div className=\"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg\">\n                      <RadioGroupItem value=\"morning\" id=\"morning\" />\n                      <Label htmlFor=\"morning\" className=\"font-verdana cursor-pointer flex-1\">\n                        Morning (8am - 12pm)\n                      </Label>\n                    </div>\n                    <div className=\"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg\">\n                      <RadioGroupItem value=\"afternoon\" id=\"afternoon\" />\n                      <Label htmlFor=\"afternoon\" className=\"font-verdana cursor-pointer flex-1\">\n                        Afternoon (12pm - 5pm)\n                      </Label>\n                    </div>\n                    <div className=\"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg\">\n                      <RadioGroupItem value=\"evening\" id=\"evening\" />\n                      <Label htmlFor=\"evening\" className=\"font-verdana cursor-pointer flex-1\">\n                        Evening (5pm - 8pm)\n                      </Label>\n                    </div>\n                    <div className=\"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg\">\n                      <RadioGroupItem value=\"flexible\" id=\"flexible\" />\n                      <Label htmlFor=\"flexible\" className=\"font-verdana cursor-pointer flex-1\">\n                        Flexible - any time works!\n                      </Label>\n                    </div>\n                  </RadioGroup>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-2 block\">How Often Do You Plan to Book?</Label>\n                  <Select value={formData.preferred_frequency} onValueChange={(value) => handleChange('preferred_frequency', value)}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select frequency\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"weekly\">Weekly</SelectItem>\n                      <SelectItem value=\"biweekly\">Every 2 weeks</SelectItem>\n                      <SelectItem value=\"monthly\">Monthly</SelectItem>\n                      <SelectItem value=\"as_needed\">As needed</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* STEP 5: Detailed Cleaning Preferences */}\n        {step === 5 && (\n          <motion.div\n            key=\"step5\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <Shield className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Cleaning Preferences</CardTitle>\n                    <CardDescription className=\"font-verdana\">Help us deliver exactly what you need</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div>\n                  <Label htmlFor=\"focus_areas\" className=\"font-fredoka\">Areas That Need Extra Attention</Label>\n                  <Textarea\n                    id=\"focus_areas\"\n                    placeholder=\"Please focus on kitchen tiles and grout, bathroom fixtures, and living room baseboards. Kitchen counters need deep scrubbing.\"\n                    value={formData.focus_areas}\n                    onChange={(e) => handleChange('focus_areas', e.target.value)}\n                    className=\"mt-1\"\n                    rows={4}\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                    Be specific - this helps cleaners prioritize their time\n                  </p>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"avoid_areas\" className=\"font-fredoka\">Areas to Avoid or Skip</Label>\n                  <Textarea\n                    id=\"avoid_areas\"\n                    placeholder=\"Please don't touch my home office desk or the craft room shelves. Guest bedroom doesn't need attention.\"\n                    value={formData.avoid_areas}\n                    onChange={(e) => handleChange('avoid_areas', e.target.value)}\n                    className=\"mt-1\"\n                    rows={3}\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                    Let cleaners know what's off-limits\n                  </p>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-3 block\">Cleaning Priorities</Label>\n                  <p className=\"text-sm text-gray-600 font-verdana mb-3\">\n                    What matters most to you?\n                  </p>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {[\n                      { value: 'deep_clean', label: 'Deep Cleaning' },\n                      { value: 'speed', label: 'Speed/Efficiency' },\n                      { value: 'eco_products', label: 'Eco-Friendly Products' },\n                      { value: 'attention_detail', label: 'Attention to Detail' },\n                      { value: 'organization', label: 'Organization' },\n                      { value: 'sanitization', label: 'Sanitization' }\n                    ].map(priority => (\n                      <button\n                        key={priority.value}\n                        onClick={() => handlePriorityToggle(priority.value)}\n                        className={`px-3 py-2 rounded-lg font-verdana text-sm transition-all text-left ${\n                          formData.cleaning_priorities.includes(priority.value)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        {priority.label}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"products\" className=\"font-fredoka\">Product Preferences</Label>\n                  <Input\n                    id=\"products\"\n                    placeholder=\"Eco-friendly, unscented products only\"\n                    value={formData.product_preferences}\n                    onChange={(e) => handleChange('product_preferences', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"allergies\" className=\"font-fredoka\">Product Allergies or Sensitivities</Label>\n                  <Input\n                    id=\"allergies\"\n                    placeholder=\"Allergic to lavender, sensitive to bleach\"\n                    value={formData.product_allergies}\n                    onChange={(e) => handleChange('product_allergies', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* STEP 6: Cleaner Matching Preferences */}\n        {step === 6 && (\n          <motion.div\n            key=\"step6\"\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n          >\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                    <Heart className=\"w-6 h-6 text-white\" />\n                  </div>\n                  <div>\n                    <CardTitle className=\"font-fredoka text-2xl\">Cleaner Matching</CardTitle>\n                    <CardDescription className=\"font-verdana\">Help us find your perfect match</CardDescription>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div>\n                  <Label className=\"font-fredoka mb-3 block\">Preferred Cleaner Specialties</Label>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {specialties.map(tag => (\n                      <button\n                        key={tag}\n                        onClick={() => handleSpecialtyToggle(tag)}\n                        className={`px-3 py-2 rounded-lg font-verdana text-sm transition-all text-left ${\n                          formData.preferred_specialty_tags.includes(tag)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        {tag}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka mb-3 block\">Additional Services You Might Need</Label>\n                  <p className=\"text-sm text-gray-600 font-verdana mb-3\">\n                    Select services you typically add to your cleanings (these can be added per booking)\n                  </p>\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {additionalServices.map(service => (\n                      <button\n                        key={service.value}\n                        onClick={() => handleServiceToggle(service.value)}\n                        className={`px-3 py-2 rounded-lg font-verdana text-sm transition-all text-left flex items-center gap-2 ${\n                          formData.preferred_additional_services.includes(service.value)\n                            ? 'bg-green-500 text-white'\n                            : 'bg-gray-100 text-graphite hover:bg-gray-200'\n                        }`}\n                      >\n                        <span>{service.icon}</span>\n                        <span>{service.label}</span>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"special\" className=\"font-fredoka\">Any Special Requests or Notes?</Label>\n                  <Textarea\n                    id=\"special\"\n                    placeholder=\"Please focus on the kitchen and bathrooms. Living room doesn't need much attention.\"\n                    value={formData.special_requests}\n                    onChange={(e) => handleChange('special_requests', e.target.value)}\n                    className=\"mt-1\"\n                    rows={4}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Navigation Buttons */}\n      <div className=\"flex justify-between items-center mt-8\">\n        <div>\n          {step > 1 && (\n            <Button variant=\"outline\" onClick={prevStep} className=\"rounded-full\">\n              Previous\n            </Button>\n          )}\n        </div>\n\n        <div className=\"flex gap-3\">\n          {onSkip && (\n            <Button variant=\"ghost\" onClick={onSkip} className=\"text-gray-500\">\n              Skip for now\n            </Button>\n          )}\n          \n          {step < totalSteps ? (\n            <Button onClick={nextStep} className=\"brand-gradient text-white rounded-full font-fredoka font-semibold px-8\">\n              Next Step\n            </Button>\n          ) : (\n            <Button onClick={handleSubmit} className=\"brand-gradient text-white rounded-full font-fredoka font-semibold px-8\">\n              <CheckCircle className=\"w-4 h-4 mr-2\" />\n              Complete Profile\n            </Button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\onboarding\\OnboardingAIAssistant.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":23,"fix":{"range":[337,352],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[338,352],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":8,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[441,458],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[441,458],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { base44 } from '@/api/base44Client';\nimport { MessageSquare, Send, X, Sparkles, Loader2, HelpCircle, Lightbulb } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport MessageBubble from '../messaging/MessageBubble';\n\nexport default function OnboardingAIAssistant({ currentStep, stepName }) {\n  const [isOpen, setIsOpen] = useState(true);\n  const [conversation, setConversation] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [suggestedQuestions, setSuggestedQuestions] = useState([]);\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  useEffect(() => {\n    if (isOpen && !conversation) {\n      initConversation();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    // Update suggested questions based on current step\n    updateSuggestedQuestions(stepName);\n  }, [stepName]);\n\n  useEffect(() => {\n    if (!conversation?.id) return;\n\n    const unsubscribe = base44.agents.subscribeToConversation(conversation.id, (data) => {\n      setMessages(data.messages || []);\n    });\n\n    return () => unsubscribe();\n  }, [conversation?.id]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const updateSuggestedQuestions = (step) => {\n    const questionsByStep = {\n      'basic-info': [\n        'What should I include in my bio?',\n        'How much experience do I need?',\n        'What are specialty tags?'\n      ],\n      'services': [\n        'What services should I offer?',\n        'How do I price my services?',\n        'What are additional services?'\n      ],\n      'pricing': [\n        'How does the payout percentage work?',\n        'What is a competitive rate?',\n        'When do I get paid?'\n      ],\n      'availability': [\n        'How do I set my availability?',\n        'What is instant booking?',\n        'Can I change my schedule later?'\n      ],\n      'photos': [\n        'Why do I need photos?',\n        'What photos should I upload?',\n        'How do I take good before/after photos?'\n      ],\n      'policies': [\n        'What are the cancellation policies?',\n        'How does the reliability score work?',\n        'What happens if I miss a booking?'\n      ]\n    };\n\n    setSuggestedQuestions(questionsByStep[step] || [\n      'How do I get started?',\n      'What do I need to know?',\n      'Tell me about the reliability score'\n    ]);\n  };\n\n  const initConversation = async () => {\n    try {\n      setLoading(true);\n      \n      const newConv = await base44.agents.createConversation({\n        agent_name: 'cleanerOnboardingAssistant',\n        metadata: {\n          name: 'Onboarding Assistant',\n          description: 'Help with cleaner onboarding',\n          current_step: currentStep,\n          step_name: stepName\n        }\n      });\n      \n      setConversation(newConv);\n      setMessages(newConv.messages || []);\n      \n      // Send initial greeting with context\n      await base44.agents.addMessage(newConv, {\n        role: 'user',\n        content: `I'm on step ${currentStep} of onboarding: ${stepName}. Please greet me and let me know how you can help.`\n      });\n    } catch (err) {\n      console.error('Error initializing conversation:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const sendMessage = async (messageText = input) => {\n    if (!messageText.trim() || !conversation) return;\n\n    const userMessage = messageText.trim();\n    setInput('');\n    setLoading(true);\n\n    try {\n      await base44.agents.addMessage(conversation, {\n        role: 'user',\n        content: userMessage\n      });\n    } catch (err) {\n      console.error('Error sending message:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  if (!isOpen) {\n    return (\n      <motion.button\n        initial={{ scale: 0 }}\n        animate={{ scale: 1 }}\n        onClick={() => setIsOpen(true)}\n        className=\"fixed bottom-6 right-6 z-50 w-16 h-16 rounded-full shadow-lg bg-gradient-to-r from-purple-500 to-blue-500 hover:opacity-90 flex items-center justify-center\"\n      >\n        <HelpCircle className=\"w-8 h-8 text-white\" />\n        <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white flex items-center justify-center\">\n          <Sparkles className=\"w-3 h-3 text-white\" />\n        </div>\n      </motion.button>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, x: 20 }}\n      animate={{ opacity: 1, x: 0 }}\n      className=\"fixed bottom-6 right-6 z-50 w-96 h-[600px]\"\n    >\n      <Card className=\"border-2 shadow-2xl flex flex-col h-full\">\n        <CardHeader className=\"bg-gradient-to-r from-purple-500 to-blue-500 text-white p-4 flex-shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-5 h-5\" />\n              <CardTitle className=\"font-fredoka text-lg\">Onboarding Assistant</CardTitle>\n              <Badge className=\"bg-green-500 text-white border-0 text-xs\">AI</Badge>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setIsOpen(false)}\n              className=\"text-white hover:bg-white/20 h-8 w-8\"\n            >\n              <X className=\"w-4 h-4\" />\n            </Button>\n          </div>\n          <p className=\"text-xs mt-1 opacity-90\">Step {currentStep}: {stepName}</p>\n        </CardHeader>\n\n        <CardContent className=\"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50\">\n          {messages.length === 0 && loading ? (\n            <div className=\"flex items-center justify-center h-full\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-purple-500\" />\n            </div>\n          ) : (\n            <>\n              {messages.map((msg, idx) => (\n                <MessageBubble key={idx} message={msg} />\n              ))}\n              \n              {/* Suggested Questions */}\n              {suggestedQuestions.length > 0 && !loading && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-xs text-gray-500 font-verdana flex items-center gap-1\">\n                    <Lightbulb className=\"w-3 h-3\" />\n                    Suggested questions:\n                  </p>\n                  {suggestedQuestions.map((question, idx) => (\n                    <button\n                      key={idx}\n                      onClick={() => sendMessage(question)}\n                      className=\"w-full text-left px-3 py-2 bg-white border border-purple-200 rounded-lg text-sm text-gray-700 hover:bg-purple-50 hover:border-purple-300 transition-all font-verdana\"\n                    >\n                      {question}\n                    </button>\n                  ))}\n                </div>\n              )}\n              \n              <div ref={messagesEndRef} />\n            </>\n          )}\n        </CardContent>\n\n        <div className=\"p-4 border-t bg-white flex-shrink-0\">\n          <div className=\"flex gap-2\">\n            <Input\n              value={input}\n              onChange={(e) => setInput(e.target.value)}\n              onKeyPress={handleKeyPress}\n              placeholder=\"Ask me anything...\"\n              disabled={loading}\n              className=\"flex-1\"\n            />\n            <Button\n              onClick={() => sendMessage()}\n              disabled={!input.trim() || loading}\n              className=\"bg-gradient-to-r from-purple-500 to-blue-500\"\n            >\n              {loading ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Send className=\"w-4 h-4\" />\n              )}\n            </Button>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2 font-verdana\">\n            AI assistant ‚Ä¢ Real-time help\n          </p>\n        </div>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\onboarding\\WaitingTasksList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payments\\StripeService.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'usdToCredits' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":22,"fix":{"range":[429,443],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"usdToCredits"},"fix":{"range":[430,443],"text":""},"desc":"Remove unused variable 'usdToCredits'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CREDITS_PER_USD' is defined but never used.","line":13,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":39,"fix":{"range":[442,459],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CREDITS_PER_USD"},"fix":{"range":[442,459],"text":""},"desc":"Remove unused variable 'CREDITS_PER_USD'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"/**\n * Stripe Payment Service - Section 5\n * Handles credit purchases, payment processing, and payout transfers\n * \n * IMPORTANT: This is a placeholder implementation. In production:\n * 1. Install @stripe/stripe-js\n * 2. Set up Stripe API keys in environment\n * 3. Create backend endpoints for secure payment processing\n * 4. Implement Stripe Connect for cleaner payouts\n */\n\nimport { base44 } from '@/api/base44Client';\nimport { usdToCredits, CREDITS_PER_USD } from '../credits/CreditCalculator';\n\n/**\n * Credit Package Definitions\n */\nexport const CREDIT_PACKAGES = [\n  {\n    id: 'starter',\n    name: 'Starter Pack',\n    usd: 50,\n    credits: 500,\n    bonus: 0,\n    popular: false,\n    description: 'Perfect for trying out the service'\n  },\n  {\n    id: 'popular',\n    name: 'Popular Pack',\n    usd: 100,\n    credits: 1000,\n    bonus: 50,\n    popular: true,\n    description: 'Best value for regular cleanings'\n  },\n  {\n    id: 'value',\n    name: 'Value Pack',\n    usd: 200,\n    credits: 2000,\n    bonus: 150,\n    popular: false,\n    description: 'Great savings for frequent users'\n  },\n  {\n    id: 'premium',\n    name: 'Premium Pack',\n    usd: 500,\n    credits: 5000,\n    bonus: 500,\n    popular: false,\n    description: 'Ultimate value for power users'\n  }\n];\n\n/**\n * Initialize Stripe (placeholder)\n * In production: const stripe = await loadStripe(process.env.STRIPE_PUBLISHABLE_KEY)\n */\nexport const initializeStripe = async () => {\n  console.log('[Stripe] Initialize Stripe SDK');\n  // In production: return await loadStripe(process.env.STRIPE_PUBLISHABLE_KEY);\n  return { mock: true };\n};\n\n/**\n * Create payment intent for credit purchase\n * In production: This should call your backend API\n */\nexport const createCreditPaymentIntent = async (packageData, userEmail) => {\n  console.log('[Stripe] Creating payment intent', { packageData, userEmail });\n  \n  // In production:\n  // const response = await fetch('/api/create-payment-intent', {\n  //   method: 'POST',\n  //   headers: { 'Content-Type': 'application/json' },\n  //   body: JSON.stringify({\n  //     package_id: packageData.id,\n  //     amount: packageData.usd,\n  //     user_email: userEmail\n  //   })\n  // });\n  // return await response.json();\n  \n  return {\n    clientSecret: 'mock_client_secret_' + Date.now(),\n    paymentIntentId: 'pi_mock_' + Date.now()\n  };\n};\n\n/**\n * Initiate credit purchase flow\n * This is a simplified version for demo. In production, use actual Stripe flow.\n */\nexport const initiateCreditPurchase = async (packageData, user) => {\n  try {\n    console.log('[Stripe] Initiating purchase', packageData);\n    \n    // In production, you would:\n    // 1. Create Stripe payment intent\n    // 2. Show Stripe checkout UI\n    // 3. Wait for payment confirmation\n    // 4. Process on backend webhook\n    \n    // For demo, we simulate immediate success\n    const totalCredits = packageData.credits + packageData.bonus;\n    const currentBalance = user.wallet_credits_balance || 0;\n    const newBalance = currentBalance + totalCredits;\n    \n    // Create purchase transaction\n    await base44.entities.CreditTransaction.create({\n      client_email: user.email,\n      transaction_type: 'purchase',\n      amount_credits: totalCredits,\n      note: `Purchased ${packageData.credits} credits${packageData.bonus > 0 ? ` + ${packageData.bonus} bonus` : ''} for $${packageData.usd}`,\n      balance_after: newBalance\n    });\n    \n    // Update user balance\n    await base44.auth.updateMe({\n      wallet_credits_balance: newBalance\n    });\n    \n    return {\n      success: true,\n      credits: totalCredits,\n      newBalance: newBalance,\n      paymentIntentId: 'pi_mock_' + Date.now()\n    };\n    \n  } catch (error) {\n    console.error('[Stripe] Purchase error:', error);\n    throw new Error('Payment processing failed: ' + error.message);\n  }\n};\n\n/**\n * Process cleaner payout via Stripe Connect\n * In production: Transfer funds to cleaner's connected Stripe account\n */\nexport const processCleanerPayout = async (cleanerEmail, amountUSD, earningIds) => {\n  console.log('[Stripe] Processing payout', { cleanerEmail, amountUSD, earningIds });\n  \n  try {\n    // In production:\n    // 1. Get cleaner's stripe_connect_id from database\n    // 2. Create Stripe transfer\n    // const transfer = await stripe.transfers.create({\n    //   amount: Math.round(amountUSD * 100), // Convert to cents\n    //   currency: 'usd',\n    //   destination: cleanerStripeAccountId,\n    //   description: `Payout for ${earningIds.length} completed jobs`\n    // });\n    \n    // For demo, simulate success\n    const transferId = 'tr_mock_' + Date.now();\n    \n    // Create payout record\n    const payout = await base44.entities.Payout.create({\n      cleaner_email: cleanerEmail,\n      amount: amountUSD,\n      status: 'completed',\n      payout_type: 'weekly',\n      stripe_transfer_id: transferId,\n      booking_ids: earningIds,\n      processed_at: new Date().toISOString()\n    });\n    \n    // Mark earnings as paid\n    for (const earningId of earningIds) {\n      await base44.entities.CleanerEarning.update(earningId, {\n        status: 'paid',\n        payout_id: payout.id\n      });\n    }\n    \n    return {\n      success: true,\n      transferId: transferId,\n      payoutId: payout.id,\n      amount: amountUSD\n    };\n    \n  } catch (error) {\n    console.error('[Stripe] Payout error:', error);\n    throw new Error('Payout processing failed: ' + error.message);\n  }\n};\n\n/**\n * Create Stripe Connect onboarding link for cleaners\n * Required for cleaners to receive payouts\n */\nexport const createConnectOnboardingLink = async (cleanerEmail) => {\n  console.log('[Stripe] Creating Connect onboarding link', cleanerEmail);\n  \n  // In production:\n  // const account = await stripe.accounts.create({\n  //   type: 'express',\n  //   email: cleanerEmail,\n  //   capabilities: {\n  //     transfers: { requested: true }\n  //   }\n  // });\n  //\n  // const accountLink = await stripe.accountLinks.create({\n  //   account: account.id,\n  //   refresh_url: `${window.location.origin}/cleaner/payout-setup?refresh=true`,\n  //   return_url: `${window.location.origin}/cleaner/payout-setup?success=true`,\n  //   type: 'account_onboarding'\n  // });\n  //\n  // return accountLink.url;\n  \n  return 'https://connect.stripe.com/express/oauth/mock_onboarding';\n};\n\n/**\n * Verify cleaner's Stripe Connect status\n */\nexport const verifyConnectStatus = async (cleanerEmail) => {\n  console.log('[Stripe] Verifying Connect status', cleanerEmail);\n  \n  // In production: Check if cleaner has completed Stripe Connect onboarding\n  // const account = await stripe.accounts.retrieve(cleanerStripeAccountId);\n  // return account.charges_enabled && account.payouts_enabled;\n  \n  return {\n    connected: false,\n    charges_enabled: false,\n    payouts_enabled: false,\n    requirements: []\n  };\n};\n\n/**\n * Handle failed payment - cleanup\n */\nexport const handleFailedPayment = async (paymentIntentId, userEmail) => {\n  console.log('[Stripe] Handling failed payment', { paymentIntentId, userEmail });\n  \n  // Log the failure\n  await base44.entities.Event.create({\n    event_type: 'payment_failed',\n    user_email: userEmail,\n    details: `Payment failed: ${paymentIntentId}`,\n    timestamp: new Date().toISOString()\n  });\n  \n  // You might want to:\n  // 1. Send notification to user\n  // 2. Log to analytics\n  // 3. Retry logic\n};\n\n/**\n * Refund a payment\n */\nexport const processRefund = async (paymentIntentId, amount, reason) => {\n  console.log('[Stripe] Processing refund', { paymentIntentId, amount, reason });\n  \n  // In production:\n  // const refund = await stripe.refunds.create({\n  //   payment_intent: paymentIntentId,\n  //   amount: Math.round(amount * 100),\n  //   reason: reason\n  // });\n  \n  return {\n    success: true,\n    refundId: 'rf_mock_' + Date.now(),\n    amount: amount\n  };\n};\n\nexport default {\n  CREDIT_PACKAGES,\n  initializeStripe,\n  createCreditPaymentIntent,\n  initiateCreditPurchase,\n  processCleanerPayout,\n  createConnectOnboardingLink,\n  verifyConnectStatus,\n  handleFailedPayment,\n  processRefund\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payouts\\EarningsBreakdown.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payouts\\InstantPayoutButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payouts\\PayoutExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payouts\\PayoutHistoryTable.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CreditCard' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":39,"fix":{"range":[252,264],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CreditCard"},"fix":{"range":[251,263],"text":""},"desc":"Remove unused variable 'CreditCard'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, Calendar, CreditCard, Zap, Clock } from 'lucide-react';\nimport { getPayoutStatusInfo } from './PayoutService';\nimport { format } from 'date-fns';\n\nexport default function PayoutHistoryTable({ cleanerEmail }) {\n  const [payouts, setPayouts] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadPayouts();\n  }, [cleanerEmail]);\n\n  const loadPayouts = async () => {\n    setLoading(true);\n    try {\n      const data = await base44.entities.Payout.filter(\n        { cleaner_email: cleanerEmail },\n        '-created_date',\n        50\n      );\n      setPayouts(data);\n    } catch (error) {\n      console.error('Error loading payouts:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  if (payouts.length === 0) {\n    return (\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardContent className=\"p-8 text-center\">\n          <Clock className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n          <p className=\"text-gray-500 font-verdana\">No payout history yet</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"rounded-3xl border-0 shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-fredoka text-2xl\">Payout History</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {payouts.map((payout) => {\n          const statusInfo = getPayoutStatusInfo(payout.status);\n          const isInstant = payout.payout_type === 'instant';\n          \n          return (\n            <div\n              key={payout.id}\n              className=\"flex items-center justify-between p-4 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors\"\n            >\n              <div className=\"flex items-center gap-4\">\n                <div className={`p-2 rounded-full ${isInstant ? 'bg-purple-100' : 'bg-blue-100'}`}>\n                  {isInstant ? (\n                    <Zap className=\"w-5 h-5 text-purple-600\" />\n                  ) : (\n                    <Calendar className=\"w-5 h-5 text-blue-600\" />\n                  )}\n                </div>\n                <div>\n                  <div className=\"flex items-center gap-2\">\n                    <p className=\"font-fredoka font-semibold text-graphite\">\n                      {isInstant ? 'Instant Payout' : 'Weekly Payout'}\n                    </p>\n                    <Badge className={statusInfo.color}>\n                      {statusInfo.label}\n                    </Badge>\n                  </div>\n                  <p className=\"text-sm text-gray-600 font-verdana\">\n                    {format(new Date(payout.created_date), 'MMM d, yyyy h:mm a')}\n                  </p>\n                  {payout.booking_ids && (\n                    <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                      {payout.booking_ids.length} job{payout.booking_ids.length !== 1 ? 's' : ''}\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"text-right\">\n                <p className=\"font-fredoka font-bold text-2xl text-green-600\">\n                  ${payout.amount.toFixed(2)}\n                </p>\n                {payout.fee > 0 && (\n                  <p className=\"text-sm text-gray-500 font-verdana\">\n                    Fee: ${payout.fee.toFixed(2)}\n                  </p>\n                )}\n                {payout.stripe_transfer_id && (\n                  <p className=\"text-xs text-gray-400 font-mono mt-1\">\n                    {payout.stripe_transfer_id.slice(-8)}\n                  </p>\n                )}\n              </div>\n            </div>\n          );\n        })}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\payouts\\PayoutService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\photos\\PhotoGallery.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":2,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33,"fix":{"range":[56,73],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[56,73],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Dialog, DialogContent } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { X, ChevronLeft, ChevronRight, ImageIcon } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\n\nexport default function PhotoGallery({ photoPairs }) {\n  const [selectedPair, setSelectedPair] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n\n  const openGallery = (pair, index) => {\n    setSelectedPair(pair);\n    setCurrentIndex(index);\n  };\n\n  const closeGallery = () => {\n    setSelectedPair(null);\n  };\n\n  const nextPair = () => {\n    setCurrentIndex((prev) => (prev + 1) % photoPairs.length);\n    setSelectedPair(photoPairs[(currentIndex + 1) % photoPairs.length]);\n  };\n\n  const prevPair = () => {\n    setCurrentIndex((prev) => (prev - 1 + photoPairs.length) % photoPairs.length);\n    setSelectedPair(photoPairs[(currentIndex - 1 + photoPairs.length) % photoPairs.length]);\n  };\n\n  if (!photoPairs || photoPairs.length === 0) {\n    return (\n      <div className=\"text-center py-12 bg-slate-50 rounded-xl\">\n        <ImageIcon className=\"w-12 h-12 mx-auto text-slate-300 mb-3\" />\n        <p className=\"text-slate-500\">No photos available yet</p>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n        {photoPairs.map((pair, index) => (\n          <motion.div\n            key={pair.id}\n            \n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: index * 0.05 }}\n            \n            className=\"relative group cursor-pointer\"\n            onClick={() => openGallery(pair, index)}\n          >\n            <div className=\"aspect-square rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-shadow duration-300\">\n              <img\n                src={pair.after_photo_url}\n                alt={`${pair.area} after`}\n                className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"\n              />\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-3\">\n                <Badge className=\"bg-white text-slate-900\">{pair.area}</Badge>\n              </div>\n            </div>\n          </motion.div>\n        ))}\n      </div>\n\n      <Dialog open={!!selectedPair} onOpenChange={closeGallery}>\n        <DialogContent className=\"max-w-5xl p-0 bg-black\">\n          <div className=\"relative\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"absolute top-4 right-4 z-10 text-white hover:bg-white/20\"\n              onClick={closeGallery}\n            >\n              <X className=\"w-6 h-6\" />\n            </Button>\n\n            {selectedPair && (\n              <div className=\"p-8\">\n                <div className=\"mb-6 text-center\">\n                  <Badge className=\"bg-white text-slate-900 text-lg px-4 py-2\">\n                    {selectedPair.area}\n                  </Badge>\n                  <p className=\"text-white/80 text-sm mt-2\">\n                    {currentIndex + 1} of {photoPairs.length}\n                  </p>\n                </div>\n\n                <div className=\"grid md:grid-cols-2 gap-6\">\n                  <div>\n                    <p className=\"text-white font-semibold mb-3\">Before</p>\n                    <img\n                      src={selectedPair.before_photo_url}\n                      alt=\"Before\"\n                      className=\"w-full h-96 object-cover rounded-lg\"\n                    />\n                  </div>\n                  <div>\n                    <p className=\"text-white font-semibold mb-3\">After</p>\n                    <img\n                      src={selectedPair.after_photo_url}\n                      alt=\"After\"\n                      className=\"w-full h-96 object-cover rounded-lg\"\n                    />\n                  </div>\n                </div>\n\n                <div className=\"flex justify-between mt-8\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={prevPair}\n                    className=\"bg-white/10 text-white hover:bg-white/20\"\n                  >\n                    <ChevronLeft className=\"w-5 h-5 mr-2\" />\n                    Previous\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    onClick={nextPair}\n                    className=\"bg-white/10 text-white hover:bg-white/20\"\n                  >\n                    Next\n                    <ChevronRight className=\"w-5 h-5 ml-2\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\photos\\PhotoUploader.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"fix":{"range":[217,264],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[217,263],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ImageIcon' is defined but never used.","line":9,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":82,"fix":{"range":[717,737],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ImageIcon"},"fix":{"range":[717,737],"text":""},"desc":"Remove unused variable 'ImageIcon'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":33,"fix":{"range":[776,793],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[776,793],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge'; // Badge is still used in the original component but removed from the outline's CardHeader. I will remove it from the CardHeader but keep the import in case other parts of the original code were using it, but since it's not present in the new outline's JSX, I'll remove it.\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Progress } from '@/components/ui/progress';\nimport { Camera, Upload, X, CheckCircle, AlertCircle, Loader2, Image as ImageIcon } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion'; // AnimatePresence was used for message, which is removed. I'll keep motion for photo grid.\nimport { analytics } from '../analytics/AnalyticsService';\nimport { toast } from 'sonner'; // Added for toast notifications\n\nconst MIN_PHOTOS_REQUIRED = 3;\n// MAX_PHOTOS_ALLOWED is removed as per the outline\n\nexport default function PhotoUploader({ \n  bookingId, \n  onPhotosUploaded, \n  existingPhotos = [] \n}) {\n  const [photos, setPhotos] = useState(existingPhotos);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState({}); // Changed to object for per-file progress\n  const [error, setError] = useState(''); // New state for error messages\n\n  const photoCount = photos.length;\n  const meetsMinimum = photoCount >= MIN_PHOTOS_REQUIRED;\n\n  const handleFileSelect = async (e) => {\n    const files = Array.from(e.target.files);\n    \n    if (files.length === 0) return;\n\n    // Validate file types\n    const validFiles = files.filter(file => {\n      const isValid = file.type.startsWith('image/');\n      if (!isValid) {\n        toast.error(`${file.name} is not an image file`);\n      }\n      return isValid;\n    });\n\n    if (validFiles.length === 0) {\n      setError('No valid image files selected for upload.');\n      return;\n    }\n\n    setUploading(true);\n    setError(''); // Clear previous errors\n    setUploadProgress({}); // Clear previous progress\n\n    try {\n      const uploadedUrls = [];\n\n      for (let i = 0; i < validFiles.length; i++) {\n        const file = validFiles[i];\n        \n        // Update progress for this specific file\n        setUploadProgress(prev => ({\n          ...prev,\n          [file.name]: 0\n        }));\n\n        // Upload file\n        const { file_url } = await base44.integrations.Core.UploadFile({ file });\n        \n        uploadedUrls.push(file_url);\n\n        // Mark as 100% complete for this specific file\n        setUploadProgress(prev => ({\n          ...prev,\n          [file.name]: 100\n        }));\n      }\n\n      // Update photos state with newly uploaded URLs\n      const newPhotos = [...photos, ...uploadedUrls];\n      setPhotos(newPhotos);\n\n      // Create photo pair records if booking provided\n      if (bookingId) {\n        for (const url of uploadedUrls) {\n          await base44.entities.PhotoPair.create({\n            booking_id: bookingId,\n            cleaner_email: 'unknown', // The outline mentioned photos.cleaner_email, which is incorrect as 'photos' is an array of URLs. Assuming it should be 'unknown' or a prop.\n            area: 'general',\n            before_photo_url: '', // Keeping this as per original logic, but outline puts 'url'\n            after_photo_url: url, // Set uploaded URL as after_photo_url\n            upload_timestamp: new Date().toISOString()\n          });\n        }\n\n        // Update booking photo count and compliance status\n        await base44.entities.Booking.update(bookingId, {\n          after_photos: newPhotos, // Update the array of all after photos\n          photo_proof_submitted: newPhotos.length >= MIN_PHOTOS_REQUIRED\n        });\n      }\n\n      // Track analytics\n      analytics.cleaner('photos_uploaded', {\n        booking_id: bookingId,\n        photo_count: validFiles.length // Number of files successfully processed in this batch\n      });\n\n      toast.success(`Uploaded ${validFiles.length} photo(s) successfully!`);\n\n      if (onPhotosUploaded) {\n        onPhotosUploaded(newPhotos); // Pass the updated list of all photos\n      }\n\n    } catch (err) {\n      console.error('Upload error:', err);\n      setError('Failed to upload photos. Please try again.');\n      toast.error('Failed to upload photos');\n    }\n\n    setUploading(false);\n    setUploadProgress({}); // Clear progress indicators\n  };\n\n  const handleRemovePhoto = async (photoUrlToRemove) => {\n    // Filter out the photo to be removed\n    const newPhotos = photos.filter(url => url !== photoUrlToRemove);\n    setPhotos(newPhotos); // Update state immediately\n\n    if (bookingId) {\n      try {\n        // Update booking's after_photos array\n        await base44.entities.Booking.update(bookingId, {\n          after_photos: newPhotos,\n          photo_proof_submitted: newPhotos.length >= MIN_PHOTOS_REQUIRED\n        });\n        // Optionally, remove the PhotoPair entity for this URL if desired\n        // This would require querying for the PhotoPair by bookingId and photoUrl\n      } catch (error) {\n        console.error('Error updating booking after photo removal:', error);\n        toast.error('Failed to update booking status after photo removal.');\n        // Revert photos state if update fails, or handle appropriately\n      }\n    }\n\n    toast.success('Photo removed');\n  };\n\n  // handleSubmit function is removed as per outline, saving logic moved to handleFileSelect\n\n  return (\n    <Card className=\"border-0 shadow-xl\">\n      <CardHeader className={`bg-gradient-to-r ${meetsMinimum ? 'from-green-50 to-emerald-50' : 'from-amber-50 to-yellow-50'}`}>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Camera className={`w-6 h-6 ${meetsMinimum ? 'text-green-600' : 'text-amber-600'}`} />\n          Photo Proof ({photoCount}/{MIN_PHOTOS_REQUIRED} minimum)\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-4\">\n        {/* Requirement Status */}\n        <Alert className={`border-${meetsMinimum ? 'green' : 'amber'}-200 bg-${meetsMinimum ? 'green' : 'amber'}-50`}>\n          <AlertDescription className={`text-${meetsMinimum ? 'green' : 'amber'}-900`}>\n            <div className=\"flex items-start gap-2\">\n              {meetsMinimum ? (\n                <CheckCircle className=\"w-5 h-5 text-green-600 mt-0.5\" />\n              ) : (\n                <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5\" />\n              )}\n              <div>\n                {meetsMinimum ? (\n                  <p className=\"font-semibold\">Minimum photos uploaded! ‚úì</p>\n                ) : (\n                  <>\n                    <p className=\"font-semibold\">\n                      {MIN_PHOTOS_REQUIRED - photoCount} more photo(s) required\n                    </p>\n                    <p className=\"text-sm mt-1\">\n                      Upload at least {MIN_PHOTOS_REQUIRED} photos to complete the job\n                    </p>\n                  </>\n                )}\n              </div>\n            </div>\n          </AlertDescription>\n        </Alert>\n\n        {/* Upload Button */}\n        <div>\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            multiple\n            onChange={handleFileSelect}\n            disabled={uploading}\n            className=\"hidden\"\n            id=\"photo-upload\"\n          />\n          <label htmlFor=\"photo-upload\">\n            <Button\n              asChild // This keeps the button styling but renders the span child\n              disabled={uploading}\n              className=\"w-full\"\n              size=\"lg\"\n            >\n              <span>\n                {uploading ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Uploading...\n                  </>\n                ) : (\n                  <>\n                    <Upload className=\"w-5 h-5 mr-2\" />\n                    Upload Photos\n                  </>\n                )}\n              </span>\n            </Button>\n          </label>\n        </div>\n\n        {/* Upload Progress for individual files */}\n        {Object.keys(uploadProgress).length > 0 && (\n          <div className=\"space-y-2\">\n            {Object.entries(uploadProgress).map(([fileName, progress]) => (\n              <div key={fileName}>\n                <div className=\"flex justify-between text-sm mb-1\">\n                  <span className=\"text-slate-600 truncate\">{fileName}</span>\n                  <span className=\"text-slate-900 font-medium\">{Math.round(progress)}%</span>\n                </div>\n                <Progress value={progress} className=\"h-2\" />\n              </div>\n            ))}\n          </div>\n        )}\n\n        {/* Photo Grid */}\n        {photos.length > 0 && (\n          <div className=\"grid grid-cols-2 gap-4 pt-4\">\n            {photos.map((url, idx) => (\n              <motion.div\n                key={url} // Using url as key for uniqueness\n                initial={{ opacity: 0, scale: 0.9 }}\n                animate={{ opacity: 1, scale: 1 }}\n                className=\"relative group\"\n              >\n                <img\n                  src={url}\n                  alt={`Uploaded photo ${idx + 1}`}\n                  className=\"w-full h-32 object-cover rounded-lg border-2 border-slate-200\"\n                />\n                <Button\n                  size=\"icon\"\n                  variant=\"destructive\"\n                  className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\"\n                  onClick={() => handleRemovePhoto(url)}\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </motion.div>\n            ))}\n          </div>\n        )}\n\n        {/* Error Display */}\n        {error && (\n          <Alert className=\"border-red-200 bg-red-50\">\n            <AlertDescription className=\"text-red-900\">\n              {error}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Guidelines */}\n        <div className=\"pt-4 border-t\">\n          <p className=\"text-sm text-slate-600 mb-2\">Photo Guidelines:</p>\n          <ul className=\"text-sm text-slate-600 space-y-1 pl-4 list-disc\">\n            <li>Upload at least {MIN_PHOTOS_REQUIRED} clear photos</li>\n            <li>Show different areas of the cleaned space</li>\n            <li>Good lighting helps showcase your work</li>\n            <li>Before/after shots are recommended</li>\n          </ul>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\photos\\PhotoValidationService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\pricing\\DynamicPricing.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'date' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":8,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"date"},"fix":{"range":[209,219],"text":""},"desc":"Remove unused variable 'date'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'start_time' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":9,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"start_time"},"fix":{"range":[219,235],"text":""},"desc":"Remove unused variable 'start_time'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'distance_miles' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"distance_miles"},"fix":{"range":[246,270],"text":""},"desc":"Remove unused variable 'distance_miles'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":151,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":151,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { base44 } from '@/api/base44Client';\nimport { DEFAULT_PRICING_RULES } from './PricingRules';\n\nexport async function calculateDynamicPrice(bookingDetails) {\n  const {\n    cleaner_email,\n    client_email,\n    date,\n    start_time,\n    hours,\n    distance_miles = 0,\n    tasks,\n    task_quantities\n  } = bookingDetails;\n\n  // Get cleaner's base rate\n  const [cleanerProfile] = await base44.entities.CleanerProfile.filter({\n    user_email: cleaner_email\n  });\n  \n  if (!cleanerProfile) {\n    throw new Error('Cleaner profile not found');\n  }\n  \n  let basePrice = hours * cleanerProfile.hourly_rate;\n  \n  // Apply new cleaner discount if applicable\n  const isNewCleaner = cleanerProfile.total_jobs < 5 && cleanerProfile.is_active;\n  if (isNewCleaner) {\n    basePrice = basePrice * 0.85;\n  }\n  \n  // Get pricing rules\n  let pricingRules = await base44.entities.PricingRule.filter({ is_active: true });\n  if (pricingRules.length === 0) {\n    pricingRules = DEFAULT_PRICING_RULES.filter(r => r.is_active);\n  }\n  \n  // Sort by priority\n  pricingRules.sort((a, b) => b.priority - a.priority);\n  \n  // Track which multipliers apply\n  const appliedMultipliers = [];\n  \n  // Apply each rule\n  for (const rule of pricingRules) {\n    const applies = await checkRuleApplies(rule, bookingDetails, client_email);\n    \n    if (applies) {\n      appliedMultipliers.push({\n        label: rule.display_label,\n        multiplier: rule.multiplier,\n        change: ((rule.multiplier - 1) * 100).toFixed(0)\n      });\n    }\n  }\n  \n  // Calculate final multiplier (multiplicative)\n  const finalMultiplier = appliedMultipliers.reduce(\n    (total, m) => total * m.multiplier,\n    1.0\n  );\n  \n  // Apply extra service fees\n  let extraServicesFee = 0;\n  if (tasks.includes('oven') || tasks.includes('inside_oven')) {\n    extraServicesFee += 30;\n  }\n  if (tasks.includes('refrigerator') || tasks.includes('inside_fridge')) {\n    extraServicesFee += 30;\n  }\n  if (tasks.includes('windows')) {\n    const windowCount = task_quantities?.windows || 1;\n    extraServicesFee += windowCount * 6;\n  }\n  if (tasks.includes('deep_clean')) {\n    extraServicesFee += 80;\n  }\n  if (tasks.includes('laundry')) {\n    extraServicesFee += 20;\n  }\n  if (tasks.includes('interior_walls')) {\n    extraServicesFee += 40;\n  }\n  \n  const subtotal = basePrice * finalMultiplier;\n  const total = subtotal + extraServicesFee;\n  \n  return {\n    base_price: basePrice,\n    final_multiplier: finalMultiplier,\n    applied_multipliers: appliedMultipliers,\n    extra_services_fee: extraServicesFee,\n    subtotal,\n    total,\n    breakdown: {\n      base: basePrice,\n      multipliers: appliedMultipliers,\n      extras: extraServicesFee,\n      final: total\n    }\n  };\n}\n\nasync function checkRuleApplies(rule, bookingDetails, clientEmail) {\n  const { date, start_time, distance_miles } = bookingDetails;\n  \n  switch (rule.rule_type) {\n    case 'day_of_week': {\n      const bookingDate = new Date(date);\n      const dayOfWeek = bookingDate.toLocaleDateString('en-US', { weekday: 'long' });\n      return rule.conditions.days.includes(dayOfWeek);\n    }\n    \n    case 'time_of_day': {\n      const hour = parseInt(start_time.split(':')[0]);\n      return hour >= rule.conditions.start_hour && hour < rule.conditions.end_hour;\n    }\n    \n    case 'last_minute': {\n      const bookingDate = new Date(date);\n      const now = new Date();\n      const hoursUntilBooking = (bookingDate - now) / (1000 * 60 * 60);\n      return hoursUntilBooking < rule.conditions.hours_notice;\n    }\n    \n    case 'distance': {\n      return distance_miles >= rule.conditions.min_miles;\n    }\n    \n    case 'holiday': {\n      return rule.conditions.holidays.includes(date);\n    }\n    \n    case 'first_booking_discount': {\n      const isFirst = await isFirstBooking(clientEmail);\n      return isFirst;\n    }\n    \n    default:\n      return false;\n  }\n}\n\nexport async function isFirstBooking(clientEmail) {\n  try {\n    const bookings = await base44.entities.Booking.filter({\n      client_email: clientEmail\n    });\n    return bookings.length === 0;\n  } catch (error) {\n    return false;\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\pricing\\LivePriceCalculator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\pricing\\PriceBreakdown.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\pricing\\PricingEngine.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'date' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":9,"suggestions":[{"messageId":"removeVar","data":{"varName":"date"},"fix":{"range":[705,715],"text":""},"desc":"Remove unused variable 'date'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'start_time' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":38,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"start_time"},"fix":{"range":[715,731],"text":""},"desc":"Remove unused variable 'start_time'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'recurring_booking_id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":39,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"recurring_booking_id"},"fix":{"range":[731,757],"text":""},"desc":"Remove unused variable 'recurring_booking_id'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'latitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":41,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"latitude"},"fix":{"range":[792,806],"text":""},"desc":"Remove unused variable 'latitude'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'longitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":42,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"longitude"},"fix":{"range":[806,821],"text":""},"desc":"Remove unused variable 'longitude'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleaner' is defined but never used. Allowed unused args must match /^_/u.","line":232,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":232,"endColumn":73,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleaner"},"fix":{"range":[7057,7066],"text":""},"desc":"Remove unused variable 'cleaner'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'latitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":234,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"latitude"},"fix":{"range":[7140,7150],"text":""},"desc":"Remove unused variable 'latitude'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'longitude' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":234,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":234,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"longitude"},"fix":{"range":[7150,7161],"text":""},"desc":"Remove unused variable 'longitude'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * MODULE 4 - Pricing Engine\n * Calculates job pricing with all discounts and multipliers\n */\n\nimport { base44 } from '@/api/base44Client';\n\n// Policy configuration\nexport const CREDITS_PER_USD = 10;\n\n// Tier multipliers\nconst TIER_MULTIPLIERS = {\n  'Developing': 0.90,\n  'Semi Pro': 1.00,\n  'Pro': 1.10,\n  'Elite': 1.20\n};\n\n// Recurring discount percentages\nconst RECURRING_DISCOUNTS = {\n  'weekly': 15,\n  'biweekly': 10,\n  'monthly': 5\n};\n\n/**\n * Main pricing pipeline - Steps 1-9 from Module 4 spec\n */\nexport async function calculateBookingPrice(bookingData) {\n  const {\n    client_email,\n    cleaner_email,\n    cleaning_type = 'basic',\n    estimated_hours,\n    hours,\n    additional_services = {},\n    date,\n    start_time,\n    recurring_booking_id,\n    recurrence_frequency = 'none',\n    latitude,\n    longitude\n  } = bookingData;\n\n  // STEP 1: Load context\n  const cleanerProfile = await base44.entities.CleanerProfile.filter({\n    user_email: cleaner_email\n  });\n\n  if (cleanerProfile.length === 0) {\n    throw new Error('Cleaner profile not found');\n  }\n\n  const cleaner = cleanerProfile[0];\n\n  const clientProfile = await base44.entities.ClientProfile.filter({\n    user_email: client_email\n  });\n\n  const client = clientProfile.length > 0 ? clientProfile[0] : null;\n\n  const clientMembership = await base44.entities.ClientMembership.filter({\n    client_email: client_email,\n    status: 'active'\n  });\n\n  const membership = clientMembership.length > 0 ? clientMembership[0] : null;\n\n  const jobHours = estimated_hours || hours;\n\n  // STEP 2: Base hourly rate per cleaning type\n  const baseRate = cleaner.base_rate_credits_per_hour || 300;\n  const deepAddon = cleaner.deep_addon_credits_per_hour || 50;\n  const moveoutAddon = cleaner.moveout_addon_credits_per_hour || 50;\n\n  let coreRateCPH = baseRate;\n  let selectedAddon = 0;\n\n  if (cleaning_type === 'deep') {\n    coreRateCPH = baseRate + deepAddon;\n    selectedAddon = deepAddon;\n  } else if (cleaning_type === 'moveout') {\n    coreRateCPH = baseRate + moveoutAddon;\n    selectedAddon = moveoutAddon;\n  }\n\n  const baseHoursCredits = coreRateCPH * jobHours;\n\n  // STEP 3: Additional services pricing\n  const additionalServicePricing = cleaner.additional_service_pricing || {};\n  let totalExtrasCredits = 0;\n\n  const services = ['windows', 'blinds', 'oven', 'refrigerator', 'light_fixtures', 'inside_cabinets', 'baseboards', 'laundry'];\n  \n  services.forEach(service => {\n    const count = additional_services[service] || 0;\n    const price = additionalServicePricing[service] || 0;\n    totalExtrasCredits += count * price;\n  });\n\n  const basePriceCredits = baseHoursCredits + totalExtrasCredits;\n\n  // STEP 4: Tier multiplier\n  const tierMultiplier = TIER_MULTIPLIERS[cleaner.tier] || 1.0;\n  const priceAfterTier = basePriceCredits * tierMultiplier;\n\n  // STEP 5: Dynamic PricingRules\n  const { dynamicMultiplier, appliedRuleLabels } = await evaluatePricingRules(\n    bookingData,\n    client,\n    cleaner\n  );\n\n  const priceAfterPRRules = priceAfterTier * dynamicMultiplier;\n\n  // STEP 6: Membership discount\n  let membershipDiscountPct = 0;\n  let membershipDiscountCredits = 0;\n  let priceAfterMembership = priceAfterPRRules;\n\n  if (membership && membership.benefits?.discount_percentage) {\n    membershipDiscountPct = membership.benefits.discount_percentage;\n    membershipDiscountCredits = priceAfterPRRules * (membershipDiscountPct / 100);\n    priceAfterMembership = priceAfterPRRules - membershipDiscountCredits;\n\n    appliedRuleLabels.push(`${membership.tier} Member - ${membershipDiscountPct}% Off`);\n  }\n\n  // STEP 7: Recurring booking discount\n  let recurrenceDiscountPct = 0;\n  let recurrenceDiscountCredits = 0;\n  let priceAfterRecurrence = priceAfterMembership;\n\n  if (recurrence_frequency !== 'none' && RECURRING_DISCOUNTS[recurrence_frequency]) {\n    recurrenceDiscountPct = RECURRING_DISCOUNTS[recurrence_frequency];\n    recurrenceDiscountCredits = priceAfterMembership * (recurrenceDiscountPct / 100);\n    priceAfterRecurrence = priceAfterMembership - recurrenceDiscountCredits;\n\n    appliedRuleLabels.push(`${recurrence_frequency} Service - ${recurrenceDiscountPct}% Off`);\n  }\n\n  // STEP 8: BundleOffers\n  const { bundleDiscountCredits, bundleLabels } = await evaluateBundleOffers(\n    bookingData,\n    priceAfterRecurrence,\n    totalExtrasCredits\n  );\n\n  appliedRuleLabels.push(...bundleLabels);\n\n  const priceAfterBundles = Math.max(0, priceAfterRecurrence - bundleDiscountCredits);\n\n  // STEP 9: Final price & snapshots\n  const finalEstimatedCredits = Math.round(priceAfterBundles);\n  const finalEstimatedUSD = finalEstimatedCredits / CREDITS_PER_USD;\n\n  const pricingBreakdown = {\n    base_hours_credits: Math.round(baseHoursCredits),\n    extras_credits: Math.round(totalExtrasCredits),\n    tier_multiplier: tierMultiplier,\n    dynamic_multiplier: dynamicMultiplier,\n    membership_discount_credits: Math.round(membershipDiscountCredits),\n    recurrence_discount_credits: Math.round(recurrenceDiscountCredits),\n    bundle_discount_credits: Math.round(bundleDiscountCredits),\n    final_estimated_credits: finalEstimatedCredits\n  };\n\n  return {\n    estimated_price_credits: finalEstimatedCredits,\n    estimated_price_usd: finalEstimatedUSD,\n    applied_pricing_labels: appliedRuleLabels,\n    pricing_breakdown: pricingBreakdown,\n    \n    // Snapshot fields\n    snapshot_base_rate_cph: baseRate,\n    snapshot_deep_addon_cph: deepAddon,\n    snapshot_moveout_addon_cph: moveoutAddon,\n    snapshot_selected_addon_cph: selectedAddon,\n    snapshot_total_rate_cph: coreRateCPH,\n    snapshot_additional_service_prices: additionalServicePricing,\n    snapshot_membership_discount_pct: membershipDiscountPct,\n    snapshot_dynamic_pricing_multiplier: dynamicMultiplier,\n    snapshot_tier_multiplier: tierMultiplier,\n    \n    additional_services_cost_credits: totalExtrasCredits,\n    payout_percentage_at_accept: cleaner.payout_percentage || 0.8\n  };\n}\n\n/**\n * Evaluate all active pricing rules and return combined multiplier\n */\nasync function evaluatePricingRules(bookingData, client, cleaner) {\n  const allRules = await base44.entities.PricingRule.filter({\n    is_active: true\n  });\n\n  const matchedRules = [];\n\n  for (const rule of allRules) {\n    if (await evaluateRuleConditions(rule, bookingData, client, cleaner)) {\n      matchedRules.push(rule);\n    }\n  }\n\n  // Group by rule_type and pick highest priority per type\n  const rulesByType = {};\n  matchedRules.forEach(rule => {\n    const type = rule.rule_type;\n    if (!rulesByType[type] || rule.priority > rulesByType[type].priority) {\n      rulesByType[type] = rule;\n    }\n  });\n\n  // Apply multipliers\n  let dynamicMultiplier = 1.0;\n  const appliedLabels = [];\n\n  Object.values(rulesByType).forEach(rule => {\n    dynamicMultiplier *= rule.multiplier || 1.0;\n    if (rule.display_label) {\n      appliedLabels.push(rule.display_label);\n    }\n  });\n\n  return { dynamicMultiplier, appliedRuleLabels: appliedLabels };\n}\n\n/**\n * Evaluate a single rule's conditions\n */\nasync function evaluateRuleConditions(rule, bookingData, client, cleaner) {\n  const conditions = rule.conditions || {};\n  const { date, start_time, latitude, longitude } = bookingData;\n\n  // time_of_day\n  if (rule.rule_type === 'time_of_day') {\n    const bookingHour = parseInt(start_time?.split(':')[0] || '0');\n    const startHour = conditions.start_hour || 0;\n    const endHour = conditions.end_hour || 23;\n    if (bookingHour < startHour || bookingHour > endHour) {\n      return false;\n    }\n  }\n\n  // day_of_week\n  if (rule.rule_type === 'day_of_week') {\n    const bookingDate = new Date(date);\n    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    const bookingDay = dayNames[bookingDate.getDay()];\n    if (conditions.days && !conditions.days.includes(bookingDay)) {\n      return false;\n    }\n  }\n\n  // distance\n  if (rule.rule_type === 'distance') {\n    // Simple distance check (would need actual calculation in production)\n    const distance = bookingData.distance_miles || 0;\n    if (conditions.min_distance && distance < conditions.min_distance) return false;\n    if (conditions.max_distance && distance > conditions.max_distance) return false;\n  }\n\n  // last_minute\n  if (rule.rule_type === 'last_minute') {\n    const bookingDateTime = new Date(`${date}T${start_time}`);\n    const hoursUntilStart = (bookingDateTime - new Date()) / (1000 * 60 * 60);\n    const maxHours = conditions.max_hours_before_start || 24;\n    if (hoursUntilStart > maxHours) {\n      return false;\n    }\n  }\n\n  // holiday\n  if (rule.rule_type === 'holiday') {\n    const holidayList = conditions.holiday_list || [];\n    if (!holidayList.includes(date)) {\n      return false;\n    }\n  }\n\n  // first_booking_discount\n  if (rule.rule_type === 'first_booking_discount') {\n    if (!client || (client.total_bookings || 0) > 0) {\n      return false;\n    }\n  }\n\n  // surge (would check demand levels in production)\n  if (rule.rule_type === 'surge') {\n    // Placeholder - in production would check booking density\n  }\n\n  return true;\n}\n\n/**\n * Evaluate bundle offers\n */\nasync function evaluateBundleOffers(bookingData, currentPriceCredits, totalExtrasCredits) {\n  const allBundles = await base44.entities.BundleOffer.filter({\n    is_active: true\n  });\n\n  let totalBundleDiscount = 0;\n  const bundleLabels = [];\n\n  for (const bundle of allBundles) {\n    if (await evaluateBundleConditions(bundle, bookingData)) {\n      let thisDiscount = 0;\n\n      if (bundle.discount_percentage) {\n        // Determine base to apply percentage on\n        const targetBase = bundle.offer_type === 'multi_service' \n          ? totalExtrasCredits \n          : currentPriceCredits;\n        thisDiscount = targetBase * (bundle.discount_percentage / 100);\n      }\n\n      if (bundle.discount_amount) {\n        // Convert USD to credits\n        thisDiscount += bundle.discount_amount * CREDITS_PER_USD;\n      }\n\n      totalBundleDiscount += thisDiscount;\n\n      if (bundle.display_message) {\n        bundleLabels.push(bundle.display_message);\n      }\n    }\n  }\n\n  return {\n    bundleDiscountCredits: totalBundleDiscount,\n    bundleLabels\n  };\n}\n\n/**\n * Evaluate bundle conditions\n */\nasync function evaluateBundleConditions(bundle, bookingData) {\n  const conditions = bundle.conditions || {};\n  const { additional_services = {}, cleaning_type } = bookingData;\n\n  // multi_service: check if multiple additional services selected\n  if (bundle.offer_type === 'multi_service') {\n    const selectedServices = Object.values(additional_services).filter(count => count > 0);\n    const minServices = conditions.min_services || 2;\n    if (selectedServices.length < minServices) {\n      return false;\n    }\n  }\n\n  // upgrade_upsell: check if upgrading to deep or moveout\n  if (bundle.offer_type === 'upgrade_upsell') {\n    const requiredType = conditions.required_cleaning_type;\n    if (requiredType && cleaning_type !== requiredType) {\n      return false;\n    }\n  }\n\n  // multi_booking: would check cart size in production\n  if (bundle.offer_type === 'multi_booking') {\n    // Placeholder - would need cart context\n  }\n\n  return true;\n}\n\n/**\n * Format pricing for display\n */\nexport function formatPricingDisplay(pricingResult) {\n  const { pricing_breakdown, applied_pricing_labels } = pricingResult;\n\n  if (!pricing_breakdown) {\n    return {\n      total: `$${pricingResult.estimated_price_usd?.toFixed(2) || '0.00'}`,\n      items: []\n    };\n  }\n\n  const items = [];\n\n  // Base cleaning\n  items.push({\n    label: 'Base Cleaning',\n    amount: pricing_breakdown.base_hours_credits,\n    isPositive: false\n  });\n\n  // Additional services\n  if (pricing_breakdown.extras_credits > 0) {\n    items.push({\n      label: 'Additional Services',\n      amount: pricing_breakdown.extras_credits,\n      isPositive: false\n    });\n  }\n\n  // Tier adjustment\n  if (pricing_breakdown.tier_multiplier !== 1.0) {\n    const tierLabel = pricing_breakdown.tier_multiplier > 1.0 ? 'Premium Tier' : 'New Cleaner';\n    items.push({\n      label: tierLabel,\n      amount: (pricing_breakdown.base_hours_credits + pricing_breakdown.extras_credits) * \n             (pricing_breakdown.tier_multiplier - 1.0),\n      isPositive: pricing_breakdown.tier_multiplier < 1.0\n    });\n  }\n\n  // Dynamic pricing\n  if (pricing_breakdown.dynamic_multiplier !== 1.0) {\n    items.push({\n      label: 'Time/Day Adjustment',\n      amount: 'varies',\n      isPositive: pricing_breakdown.dynamic_multiplier < 1.0\n    });\n  }\n\n  // Membership discount\n  if (pricing_breakdown.membership_discount_credits > 0) {\n    items.push({\n      label: 'Membership Discount',\n      amount: pricing_breakdown.membership_discount_credits,\n      isPositive: true\n    });\n  }\n\n  // Recurring discount\n  if (pricing_breakdown.recurrence_discount_credits > 0) {\n    items.push({\n      label: 'Recurring Service Discount',\n      amount: pricing_breakdown.recurrence_discount_credits,\n      isPositive: true\n    });\n  }\n\n  // Bundle discount\n  if (pricing_breakdown.bundle_discount_credits > 0) {\n    items.push({\n      label: 'Bundle Savings',\n      amount: pricing_breakdown.bundle_discount_credits,\n      isPositive: true\n    });\n  }\n\n  return {\n    total: `$${pricingResult.estimated_price_usd?.toFixed(2) || '0.00'}`,\n    totalCredits: pricing_breakdown.final_estimated_credits,\n    items,\n    labels: applied_pricing_labels || []\n  };\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\pricing\\PricingRules.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\receipts\\ReceiptModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\recurring\\RecurringBookingConverter.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[135,182],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[135,181],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":15,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":39,"fix":{"range":[559,569],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[558,568],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":15,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":51,"fix":{"range":[569,581],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[568,580],"text":""},"desc":"Remove unused variable 'DollarSign'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { RefreshCw, Sparkles, Calendar, DollarSign, CheckCircle } from 'lucide-react';\nimport { addWeeks, addMonths } from 'date-fns';\nimport { toast } from 'sonner';\n\nexport default function RecurringBookingConverter({ booking, onConvert }) {\n  const [showDialog, setShowDialog] = useState(false);\n  const [frequency, setFrequency] = useState('weekly');\n  const [dayOfWeek, setDayOfWeek] = useState('');\n  const [converting, setConverting] = useState(false);\n\n  const DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n\n  const handleConvert = async () => {\n    if (!dayOfWeek) {\n      toast.error('Please select a day of the week');\n      return;\n    }\n\n    setConverting(true);\n    try {\n      // Calculate next booking date based on frequency\n      let nextDate = new Date();\n      if (frequency === 'weekly') {\n        nextDate = addWeeks(nextDate, 1);\n      } else if (frequency === 'biweekly') {\n        nextDate = addWeeks(nextDate, 2);\n      } else if (frequency === 'monthly') {\n        nextDate = addMonths(nextDate, 1);\n      }\n\n      const recurringBooking = await base44.entities.RecurringBooking.create({\n        client_email: booking.client_email,\n        cleaner_email: booking.cleaner_email,\n        frequency,\n        day_of_week: dayOfWeek,\n        start_time: booking.start_time,\n        hours: booking.hours,\n        tasks: booking.tasks || [],\n        task_quantities: booking.task_quantities || {},\n        address: booking.address,\n        latitude: booking.latitude,\n        longitude: booking.longitude,\n        total_price: booking.total_price,\n        is_active: true,\n        next_booking_date: nextDate.toISOString().split('T')[0]\n      });\n\n      toast.success('Converted to recurring booking!');\n      setShowDialog(false);\n      if (onConvert) onConvert(recurringBooking);\n    } catch (error) {\n      console.error('Error converting to recurring:', error);\n      toast.error('Failed to create recurring booking');\n    }\n    setConverting(false);\n  };\n\n  // Calculate savings\n  const monthlySavings = frequency === 'weekly' ? booking.total_price * 4 * 0.1 : \n                        frequency === 'biweekly' ? booking.total_price * 2 * 0.1 : \n                        booking.total_price * 0.1;\n\n  return (\n    <>\n      <Button\n        onClick={() => setShowDialog(true)}\n        variant=\"outline\"\n        className=\"rounded-full font-fredoka border-2 border-purple-500 text-purple-700 hover:bg-purple-50\"\n      >\n        <RefreshCw className=\"w-4 h-4 mr-2\" />\n        Convert to Recurring\n      </Button>\n\n      <Dialog open={showDialog} onOpenChange={setShowDialog}>\n        <DialogContent className=\"max-w-2xl rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n              <Sparkles className=\"w-6 h-6 text-purple-600\" />\n              Convert to Recurring Booking\n            </DialogTitle>\n            <DialogDescription className=\"font-verdana\">\n              Set up automatic cleanings and save 10% on every visit!\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-6\">\n            {/* Current Booking Summary */}\n            <Card className=\"border-2 border-blue-200 bg-blue-50 rounded-2xl\">\n              <CardContent className=\"p-4\">\n                <p className=\"text-sm font-fredoka font-semibold text-graphite mb-3\">Your Current Booking:</p>\n                <div className=\"grid grid-cols-2 gap-3 text-sm font-verdana\">\n                  <div>\n                    <span className=\"text-gray-600\">Cleaner:</span>\n                    <p className=\"font-semibold text-graphite\">{booking.cleaner_email}</p>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-600\">Time:</span>\n                    <p className=\"font-semibold text-graphite\">{booking.start_time}</p>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-600\">Duration:</span>\n                    <p className=\"font-semibold text-graphite\">{booking.hours} hours</p>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-600\">Price:</span>\n                    <p className=\"font-semibold text-graphite\">{Math.round(booking.total_price * 10)} credits</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Frequency Selection */}\n            <div>\n              <label className=\"text-sm font-fredoka font-medium mb-2 block text-graphite\">\n                Cleaning Frequency *\n              </label>\n              <Select value={frequency} onValueChange={setFrequency}>\n                <SelectTrigger className=\"rounded-full font-verdana\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"weekly\">Weekly (Every week)</SelectItem>\n                  <SelectItem value=\"biweekly\">Bi-Weekly (Every 2 weeks)</SelectItem>\n                  <SelectItem value=\"monthly\">Monthly (Once a month)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Day Selection */}\n            <div>\n              <label className=\"text-sm font-fredoka font-medium mb-2 block text-graphite\">\n                Preferred Day of Week *\n              </label>\n              <Select value={dayOfWeek} onValueChange={setDayOfWeek}>\n                <SelectTrigger className=\"rounded-full font-verdana\">\n                  <SelectValue placeholder=\"Select a day\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {DAYS.map(day => (\n                    <SelectItem key={day} value={day}>{day}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Savings Calculator */}\n            <Card className=\"border-2 border-green-300 bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <div>\n                    <p className=\"font-fredoka font-bold text-graphite text-lg mb-1\">Your Savings</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">10% off every visit</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                      {Math.round(monthlySavings * 10)}\n                    </p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">credits/month saved</p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2 text-sm font-verdana\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-600\">Regular price per visit:</span>\n                    <span className=\"font-semibold text-graphite\">{Math.round(booking.total_price * 10)} credits</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-gray-600\">Recurring price per visit:</span>\n                    <span className=\"font-semibold text-fresh-mint\">{Math.round(booking.total_price * 10 * 0.9)} credits</span>\n                  </div>\n                  <div className=\"flex justify-between pt-2 border-t border-green-200\">\n                    <span className=\"font-fredoka font-bold text-graphite\">Monthly savings:</span>\n                    <span className=\"font-fredoka font-bold text-fresh-mint\">\n                      {Math.round(monthlySavings * 10)} credits\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Info Alert */}\n            <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n              <AlertDescription className=\"text-sm text-blue-900 font-verdana\">\n                <div className=\"space-y-2\">\n                  <p className=\"flex items-center gap-2\">\n                    <CheckCircle className=\"w-4 h-4 text-puretask-blue\" />\n                    Your cleaner will be automatically scheduled\n                  </p>\n                  <p className=\"flex items-center gap-2\">\n                    <CheckCircle className=\"w-4 h-4 text-puretask-blue\" />\n                    You can pause or cancel anytime\n                  </p>\n                  <p className=\"flex items-center gap-2\">\n                    <CheckCircle className=\"w-4 h-4 text-puretask-blue\" />\n                    Credits will be charged 24 hours before each visit\n                  </p>\n                </div>\n              </AlertDescription>\n            </Alert>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3\">\n              <Button\n                onClick={handleConvert}\n                disabled={converting || !dayOfWeek}\n                className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-semibold\"\n              >\n                {converting ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                    Creating...\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"w-4 h-4 mr-2\" />\n                    Create Recurring Booking\n                  </>\n                )}\n              </Button>\n              <Button\n                onClick={() => setShowDialog(false)}\n                variant=\"outline\"\n                disabled={converting}\n                className=\"rounded-full font-fredoka\"\n              >\n                Cancel\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\recurring\\RecurringBookingCreator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\recurring\\RecurringBookingSetup.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"fix":{"range":[351,398],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[351,397],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17,"fix":{"range":[521,530],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[522,530],"text":""},"desc":"Remove unused variable 'addDays'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Repeat, Calendar, DollarSign, Loader2 } from 'lucide-react';\nimport { base44 } from '@/api/base44Client';\nimport { addDays, addWeeks, addMonths, format } from 'date-fns';\n\nexport default function RecurringBookingSetup({ booking, open, onClose, onCreated }) {\n  const [frequency, setFrequency] = useState('weekly');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const getNextBookingDate = () => {\n    const bookingDate = new Date(booking.date);\n    \n    switch (frequency) {\n      case 'weekly':\n        return addWeeks(bookingDate, 1);\n      case 'biweekly':\n        return addWeeks(bookingDate, 2);\n      case 'monthly':\n        return addMonths(bookingDate, 1);\n      default:\n        return addWeeks(bookingDate, 1);\n    }\n  };\n\n  const handleCreate = async () => {\n    setLoading(true);\n    setError('');\n\n    try {\n      const bookingDate = new Date(booking.date);\n      const dayOfWeek = format(bookingDate, 'EEEE');\n\n      // Create the recurring booking record\n      const recurringBooking = await base44.entities.RecurringBooking.create({\n        client_email: booking.client_email,\n        cleaner_email: booking.cleaner_email,\n        frequency,\n        day_of_week: dayOfWeek,\n        start_time: booking.start_time,\n        hours: booking.hours,\n        tasks: booking.tasks,\n        task_quantities: booking.task_quantities || {},\n        address: booking.address,\n        latitude: booking.latitude,\n        longitude: booking.longitude,\n        total_price: booking.total_price,\n        is_active: true,\n        next_booking_date: getNextBookingDate().toISOString().split('T')[0]\n      });\n\n      // Update the current booking to link it\n      await base44.entities.Booking.update(booking.id, {\n        recurring_booking_id: recurringBooking.id\n      });\n\n      // Log event\n      await base44.entities.Event.create({\n        booking_id: booking.id,\n        event_type: 'recurring_booking_created',\n        user_email: booking.client_email,\n        details: `Recurring ${frequency} booking created`,\n        timestamp: new Date().toISOString()\n      });\n\n      if (onCreated) onCreated();\n      onClose();\n    } catch (err) {\n      console.error('Error creating recurring booking:', err);\n      setError('Failed to set up recurring booking. Please try again.');\n    }\n    setLoading(false);\n  };\n\n  const nextDate = getNextBookingDate();\n  const estimatedMonthlyCharge = frequency === 'weekly' ? booking.total_price * 4 :\n                                 frequency === 'biweekly' ? booking.total_price * 2 :\n                                 booking.total_price;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-lg\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Repeat className=\"w-6 h-6 text-purple-500\" />\n            Set Up Recurring Booking\n          </DialogTitle>\n          <DialogDescription>\n            Automatically schedule this cleaning on a regular basis\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6 py-4\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-red-800 text-sm\">\n              {error}\n            </div>\n          )}\n\n          <div>\n            <Label className=\"mb-2 block\">Frequency</Label>\n            <Select value={frequency} onValueChange={setFrequency}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"weekly\">\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4\" />\n                    <span>Weekly</span>\n                  </div>\n                </SelectItem>\n                <SelectItem value=\"biweekly\">\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4\" />\n                    <span>Every 2 Weeks</span>\n                  </div>\n                </SelectItem>\n                <SelectItem value=\"monthly\">\n                  <div className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-4 h-4\" />\n                    <span>Monthly</span>\n                  </div>\n                </SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"bg-emerald-50 p-4 rounded-lg space-y-2\">\n            <h4 className=\"font-semibold text-emerald-900\">Recurring Details</h4>\n            <div className=\"space-y-1 text-sm text-emerald-800\">\n              <p><strong>Day:</strong> {format(new Date(booking.date), 'EEEE')}s</p>\n              <p><strong>Time:</strong> {booking.start_time}</p>\n              <p><strong>Duration:</strong> {booking.hours} hours</p>\n              <p><strong>Next booking:</strong> {format(nextDate, 'MMMM d, yyyy')}</p>\n            </div>\n          </div>\n\n          <div className=\"bg-blue-50 p-4 rounded-lg\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium text-blue-900\">Estimated Monthly Charge:</span>\n              <div className=\"flex items-center gap-1 text-blue-900\">\n                <DollarSign className=\"w-4 h-4\" />\n                <span className=\"text-xl font-bold\">{estimatedMonthlyCharge.toFixed(2)}</span>\n              </div>\n            </div>\n            <p className=\"text-xs text-blue-800\">\n              Based on {frequency === 'weekly' ? '4' : frequency === 'biweekly' ? '2' : '1'} cleaning{frequency !== 'monthly' && 's'} per month\n            </p>\n          </div>\n\n          <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-3\">\n            <p className=\"text-sm text-amber-900\">\n              <strong>Note:</strong> You can pause or cancel your recurring booking anytime from your dashboard. \n              You will be charged after each cleaning is completed.\n            </p>\n          </div>\n\n          <div className=\"flex gap-3\">\n            <Button variant=\"outline\" onClick={onClose} className=\"flex-1\" disabled={loading}>\n              Cancel\n            </Button>\n            <Button \n              onClick={handleCreate} \n              className=\"flex-1 bg-purple-600 hover:bg-purple-700\"\n              disabled={loading}\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Setting Up...\n                </>\n              ) : (\n                <>\n                  <Repeat className=\"w-4 h-4 mr-2\" />\n                  Confirm Recurring\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\referral\\ReferralSystem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\referral\\ReferralWidget.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[315,362],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[315,361],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Gift, Copy, Check, Users, Mail, Share2 } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { generateReferralCode } from './ReferralSystem';\nimport { motion } from 'framer-motion';\n\nexport default function ReferralWidget({ userEmail }) {\n  const [referralCode, setReferralCode] = useState('');\n  const [copied, setCopied] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState({ pending: 0, completed: 0, totalEarned: 0 });\n\n  useEffect(() => {\n    loadReferralData();\n  }, []);\n\n  const loadReferralData = async () => {\n    try {\n      // Get or create referral code\n      const referrals = await base44.entities.Referral.filter({\n        referrer_email: userEmail\n      });\n      \n      if (referrals.length === 0) {\n        const code = await generateReferralCode(userEmail);\n        setReferralCode(code);\n      } else {\n        // Get the most recent active referral code\n        const activeReferral = referrals.find(r => r.status === 'pending' || r.status === 'completed');\n        setReferralCode(activeReferral?.referral_code || referrals[0].referral_code);\n      }\n      \n      // Calculate stats\n      const pending = referrals.filter(r => r.status === 'pending' && r.referee_email).length;\n      const completed = referrals.filter(r => r.status === 'completed').length;\n      const totalEarned = completed * 20; // $20 per completed referral\n      \n      setStats({ pending, completed, totalEarned });\n    } catch (error) {\n      console.error('Error loading referral data:', error);\n    }\n    setLoading(false);\n  };\n\n  const getReferralLink = () => {\n    const baseUrl = typeof window !== 'undefined' ? window.location.origin : '';\n    return `${baseUrl}${createPageUrl('ClientSignup')}?ref=${referralCode}`;\n  };\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText(getReferralLink());\n    setCopied(true);\n    toast.success('Referral link copied!');\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  const shareViaEmail = () => {\n    const referralLink = getReferralLink();\n    const subject = encodeURIComponent('Get $20 off your first cleaning with PureTask!');\n    const body = encodeURIComponent(`I've been using PureTask for professional cleaning and thought you might like it too!\n\nUse my referral link to get $20 off your first booking:\n${referralLink}\n\nPureTask connects you with verified, highly-rated cleaners with GPS tracking and photo proof. It's been a game-changer for me!`);\n    \n    window.location.href = `mailto:?subject=${subject}&body=${body}`;\n  };\n\n  const shareOnTwitter = () => {\n    const text = encodeURIComponent(`Get $20 off your first cleaning with PureTask! ${getReferralLink()}`);\n    window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-center\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500\"></div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.3 }}\n    >\n      <Card className=\"border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Gift className=\"w-6 h-6 text-emerald-600\" />\n            Give $20, Get $20\n          </CardTitle>\n          <p className=\"text-sm text-slate-600 mt-2\">\n            Refer friends and you'll both get $20 in credits!\n          </p>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {/* Stats */}\n          <div className=\"grid grid-cols-3 gap-3\">\n            <div className=\"text-center p-4 bg-white rounded-lg border-2 border-emerald-200 shadow-sm\">\n              <p className=\"text-3xl font-bold text-emerald-600\">{stats.completed}</p>\n              <p className=\"text-xs text-slate-600 mt-1\">Completed</p>\n            </div>\n            <div className=\"text-center p-4 bg-white rounded-lg border-2 border-amber-200 shadow-sm\">\n              <p className=\"text-3xl font-bold text-amber-600\">{stats.pending}</p>\n              <p className=\"text-xs text-slate-600 mt-1\">Pending</p>\n            </div>\n            <div className=\"text-center p-4 bg-white rounded-lg border-2 border-blue-200 shadow-sm\">\n              <p className=\"text-3xl font-bold text-blue-600\">${stats.totalEarned}</p>\n              <p className=\"text-xs text-slate-600 mt-1\">Earned</p>\n            </div>\n          </div>\n\n          {/* Referral Link */}\n          <div>\n            <label className=\"text-sm font-semibold text-slate-700 mb-2 block\">\n              Your Referral Link\n            </label>\n            <div className=\"flex gap-2\">\n              <Input\n                value={getReferralLink()}\n                readOnly\n                className=\"flex-1 bg-white border-2 border-slate-200\"\n                onClick={(e) => e.target.select()}\n              />\n              <Button\n                onClick={handleCopy}\n                variant=\"outline\"\n                className=\"border-2 border-emerald-500 text-emerald-600 hover:bg-emerald-50\"\n              >\n                {copied ? (\n                  <>\n                    <Check className=\"w-4 h-4 mr-2\" />\n                    Copied!\n                  </>\n                ) : (\n                  <>\n                    <Copy className=\"w-4 h-4 mr-2\" />\n                    Copy\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n\n          {/* Share Buttons */}\n          <div className=\"grid grid-cols-2 gap-3\">\n            <Button\n              onClick={shareViaEmail}\n              className=\"bg-emerald-500 hover:bg-emerald-600 text-white\"\n            >\n              <Mail className=\"w-4 h-4 mr-2\" />\n              Share via Email\n            </Button>\n            <Button\n              onClick={shareOnTwitter}\n              variant=\"outline\"\n              className=\"border-2 border-slate-300 hover:bg-slate-50\"\n            >\n              <Share2 className=\"w-4 h-4 mr-2\" />\n              Share on ùïè\n            </Button>\n          </div>\n\n          {/* How it works */}\n          <div className=\"p-4 bg-white rounded-lg border-2 border-emerald-200\">\n            <p className=\"font-semibold text-slate-900 mb-3 flex items-center gap-2\">\n              <Users className=\"w-4 h-4 text-emerald-600\" />\n              How it works:\n            </p>\n            <ol className=\"text-sm text-slate-600 space-y-2 list-decimal list-inside\">\n              <li>Share your unique referral link with friends</li>\n              <li>They sign up and book their first cleaning</li>\n              <li>You both get $20 in credits automatically!</li>\n            </ol>\n            <div className=\"mt-3 pt-3 border-t border-emerald-200\">\n              <p className=\"text-xs text-slate-500\">\n                üí° Tip: The more you share, the more you save on future cleanings!\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\BadgeDisplay.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":4,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":8,"fix":{"range":[82,92],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[86,92],"text":""},"desc":"Remove unused variable 'Award'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Award, Shield, Clock, Camera, Star, Heart, \n  Zap, CheckCircle, TrendingUp, Crown\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n/**\n * Badge Display - Section 4.5\n * Shows earned reliability badges and achievements\n */\n\n// Badge definitions\nconst BADGE_TYPES = {\n  always_on_time: {\n    name: 'Always On Time',\n    icon: Clock,\n    description: '100% punctuality for 30+ days',\n    color: 'bg-blue-100 text-blue-700 border-blue-300',\n    requirement: 'GPS check-in within 15 mins for 30 consecutive days'\n  },\n  documented_pro: {\n    name: 'Documented Pro',\n    icon: Camera,\n    description: 'Photo proof on every job',\n    color: 'bg-purple-100 text-purple-700 border-purple-300',\n    requirement: '3+ photos uploaded for last 50 jobs'\n  },\n  '30_day_streak': {\n    name: '30-Day Streak',\n    icon: Zap,\n    description: 'Perfect attendance for a month',\n    color: 'bg-amber-100 text-amber-700 border-amber-300',\n    requirement: 'No cancellations or no-shows for 30 days'\n  },\n  great_communicator: {\n    name: 'Great Communicator',\n    icon: Star,\n    description: 'Fast response time',\n    color: 'bg-green-100 text-green-700 border-green-300',\n    requirement: 'Average response time < 2 hours'\n  },\n  trusted_professional: {\n    name: 'Trusted Professional',\n    icon: Shield,\n    description: 'Elite tier performance',\n    color: 'bg-red-100 text-red-700 border-red-300',\n    requirement: 'Maintain Elite tier (90+ score) for 60 days'\n  },\n  client_favorite: {\n    name: 'Client Favorite',\n    icon: Heart,\n    description: 'High rebooking rate',\n    color: 'bg-pink-100 text-pink-700 border-pink-300',\n    requirement: '75%+ client rebooking rate'\n  },\n  rising_star: {\n    name: 'Rising Star',\n    icon: TrendingUp,\n    description: 'Rapid improvement',\n    color: 'bg-cyan-100 text-cyan-700 border-cyan-300',\n    requirement: '+20 point score increase in 30 days'\n  },\n  elite_performer: {\n    name: 'Elite Performer',\n    icon: Crown,\n    description: 'Top 5% of all cleaners',\n    color: 'bg-gradient-to-r from-amber-400 to-orange-500 text-white border-amber-400',\n    requirement: '95+ reliability score'\n  }\n};\n\nexport default function BadgeDisplay({ badges = [], size = 'default', showTooltip = true }) {\n  if (!badges || badges.length === 0) {\n    return null;\n  }\n\n  const badgeSize = size === 'small' ? 'w-6 h-6' : size === 'large' ? 'w-10 h-10' : 'w-8 h-8';\n\n  return (\n    <div className=\"flex flex-wrap gap-2\">\n      {badges.map((badgeKey, index) => {\n        const badge = BADGE_TYPES[badgeKey];\n        if (!badge) return null;\n\n        const Icon = badge.icon;\n\n        return (\n          <motion.div\n            key={badgeKey}\n            initial={{ scale: 0, rotate: -180 }}\n            animate={{ scale: 1, rotate: 0 }}\n            transition={{ \n              delay: index * 0.1,\n              type: \"spring\",\n              stiffness: 200\n            }}\n          >\n            <Badge\n              className={`${badge.color} border rounded-full font-fredoka font-semibold px-3 py-1 cursor-help`}\n              title={showTooltip ? `${badge.name}: ${badge.description}` : undefined}\n            >\n              <Icon className={`${badgeSize} mr-1`} />\n              {size !== 'small' && badge.name}\n            </Badge>\n          </motion.div>\n        );\n      })}\n    </div>\n  );\n}\n\n/**\n * Badge Card - Detailed view of a single badge\n */\nexport function BadgeCard({ badgeKey, earned = false }) {\n  const badge = BADGE_TYPES[badgeKey];\n  if (!badge) return null;\n\n  const Icon = badge.icon;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className={`p-6 rounded-2xl border-2 ${\n        earned \n          ? `${badge.color} shadow-lg` \n          : 'bg-gray-50 border-gray-200 opacity-60'\n      }`}\n    >\n      <div className=\"flex items-start gap-4\">\n        <div className={`p-3 rounded-2xl ${earned ? 'bg-white/30' : 'bg-gray-200'}`}>\n          <Icon className=\"w-8 h-8\" />\n        </div>\n        <div className=\"flex-1\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h3 className=\"font-fredoka font-bold text-graphite\">{badge.name}</h3>\n            {earned && (\n              <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n            )}\n          </div>\n          <p className=\"text-sm text-gray-600 font-verdana mb-2\">{badge.description}</p>\n          <p className=\"text-xs text-gray-500 font-verdana italic\">\n            {badge.requirement}\n          </p>\n          {!earned && (\n            <p className=\"text-xs text-gray-400 font-verdana mt-2\">\n              üîí Keep up the great work to unlock!\n            </p>\n          )}\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\n/**\n * Badge Gallery - Shows all available badges\n */\nexport function BadgeGallery({ earnedBadges = [] }) {\n  const allBadges = Object.keys(BADGE_TYPES);\n\n  return (\n    <div className=\"grid md:grid-cols-2 gap-4\">\n      {allBadges.map(badgeKey => (\n        <BadgeCard \n          key={badgeKey}\n          badgeKey={badgeKey}\n          earned={earnedBadges.includes(badgeKey)}\n        />\n      ))}\n    </div>\n  );\n}\n\nexport { BADGE_TYPES };","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\MilestoneTracker.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[426,433],"text":""},"desc":"Remove unused variable 'loading'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Award, Gift, Zap, Trophy, CheckCircle, Camera } from 'lucide-react';\n\nexport default function MilestoneTracker({ cleanerEmail }) {\n  const [milestones, setMilestones] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadMilestones();\n  }, [cleanerEmail]);\n\n  const loadMilestones = async () => {\n    setLoading(true);\n    try {\n      const results = await base44.entities.CleanerMilestone.filter({\n        cleaner_email: cleanerEmail\n      }, '-earned_date', 20);\n      setMilestones(results);\n    } catch (error) {\n      console.error('Error loading milestones:', error);\n    }\n    setLoading(false);\n  };\n\n  const milestoneInfo = {\n    'first_10_jobs': { icon: Award, label: 'First 10 Jobs', color: 'bg-blue-100 text-blue-800' },\n    'first_50_jobs': { icon: Trophy, label: 'First 50 Jobs', color: 'bg-purple-100 text-purple-800' },\n    'first_100_jobs': { icon: Trophy, label: '100 Jobs Milestone', color: 'bg-yellow-100 text-yellow-800' },\n    'perfect_month': { icon: Zap, label: 'Perfect Month', color: 'bg-orange-100 text-orange-800' },\n    'reliability_elite': { icon: Award, label: 'Reliability Elite', color: 'bg-green-100 text-green-800' },\n    'zero_dispute_month': { icon: CheckCircle, label: 'Zero Disputes', color: 'bg-teal-100 text-teal-800' },\n    'photo_compliance_perfect': { icon: Camera, label: '100% Photo Compliance', color: 'bg-pink-100 text-pink-800' }\n  };\n\n  if (milestones.length === 0) {\n    return (\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n            <Gift className=\"w-5 h-5\" />\n            Achievements\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8\">\n            <Trophy className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n            <p className=\"text-gray-500 font-verdana\">\n              Complete jobs to unlock achievements!\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"rounded-3xl border-0 shadow-xl\">\n      <CardHeader>\n        <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n          <Gift className=\"w-5 h-5\" />\n          Achievements Unlocked\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {milestones.map((milestone) => {\n          const info = milestoneInfo[milestone.milestone_type] || {\n            icon: Award,\n            label: milestone.milestone_type,\n            color: 'bg-gray-100 text-gray-800'\n          };\n          const Icon = info.icon;\n\n          return (\n            <div\n              key={milestone.id}\n              className=\"flex items-center justify-between p-4 bg-white rounded-2xl hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className={`p-2 rounded-full ${info.color.replace('text-', 'bg-').replace('800', '200')}`}>\n                  <Icon className={`w-5 h-5 ${info.color}`} />\n                </div>\n                <div>\n                  <div className=\"font-fredoka font-semibold text-graphite\">\n                    {info.label}\n                  </div>\n                  <div className=\"text-xs text-gray-500 font-verdana\">\n                    Earned {new Date(milestone.earned_date).toLocaleDateString()}\n                  </div>\n                </div>\n              </div>\n              <Badge className={info.color}>\n                {milestone.reward_type === 'bonus_payout' && `+${milestone.reward_value}%`}\n                {milestone.reward_type === 'profile_boost' && `+${milestone.reward_value} visibility`}\n                {milestone.reward_type === 'instant_book_enabled' && 'Instant Book ‚ö°'}\n              </Badge>\n            </div>\n          );\n        })}\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"fix":{"range":[133,182],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[133,181],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":7,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":13,"fix":{"range":[302,317],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[306,317],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ChevronRight' is defined but never used.","line":7,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47,"fix":{"range":[337,351],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ChevronRight"},"fix":{"range":[336,350],"text":""},"desc":"Remove unused variable 'ChevronRight'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  TrendingUp, Award, Target, Zap, ChevronRight, \n  CheckCircle, Clock, Camera, Star, DollarSign, Info\n} from 'lucide-react';\nimport ReliabilityMeterV2 from './ReliabilityMeterV2';\nimport { calculateReliabilityScore, getTierDetails, getRecommendedBaseRate } from './ReliabilityScoreCalculatorV2';\nimport { motion } from 'framer-motion';\n\n/**\n * Reliability Dashboard - Section 4.3\n * Complete dashboard for cleaners to track and improve their score\n */\nexport default function ReliabilityDashboard({ cleanerEmail }) {\n  const [scoreData, setScoreData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    loadScoreData();\n  }, [cleanerEmail]);\n\n  const loadScoreData = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const data = await calculateReliabilityScore(cleanerEmail);\n      setScoreData(data);\n    } catch (err) {\n      console.error('Error loading score:', err);\n      setError(err.message);\n    }\n    \n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"border-0 shadow-lg rounded-2xl\">\n        <CardContent className=\"p-12 text-center\">\n          <div className=\"animate-spin w-12 h-12 border-4 border-puretask-blue border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 font-verdana\">Calculating your score...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Alert className=\"border-red-200 bg-red-50 rounded-2xl\">\n        <AlertDescription className=\"text-red-900 font-verdana\">\n          Error loading score: {error}\n        </AlertDescription>\n      </Alert>\n    );\n  }\n\n  const { total_score, tier, components, total_jobs } = scoreData;\n  const tierDetails = getTierDetails(tier);\n  const recommendedRate = getRecommendedBaseRate(tier, total_score);\n  const nextTier = getNextTier(tier);\n  const pointsToNextTier = nextTier ? tierDetails.max + 1 - total_score : 0;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Main Score Display */}\n      <ReliabilityMeterV2 \n        score={total_score} \n        tier={tier} \n        components={components}\n        showDetails={true}\n      />\n\n      {/* Tier Progress */}\n      {nextTier && (\n        <Card className=\"border-0 shadow-lg rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n            <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n              <Target className=\"w-6 h-6 text-puretask-blue\" />\n              Progress to {nextTier}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm font-verdana text-gray-600\">\n                    Current: {total_score} / {tierDetails.max + 1}\n                  </span>\n                  <span className=\"text-sm font-fredoka font-semibold text-puretask-blue\">\n                    +{pointsToNextTier} points needed\n                  </span>\n                </div>\n                <div className=\"h-3 bg-gray-100 rounded-full overflow-hidden\">\n                  <motion.div\n                    className=\"h-full brand-gradient\"\n                    initial={{ width: 0 }}\n                    animate={{ width: `${(total_score / (tierDetails.max + 1)) * 100}%` }}\n                    transition={{ duration: 1, ease: \"easeOut\" }}\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"p-4 bg-blue-50 rounded-2xl\">\n                  <p className=\"text-sm text-gray-600 font-verdana mb-1\">Current Rate Range</p>\n                  <p className=\"text-xl font-fredoka font-bold text-puretask-blue\">\n                    {tierDetails.base_rate_min}-{tierDetails.base_rate_max} credits/hr\n                  </p>\n                </div>\n\n                {nextTier && (\n                  <div className=\"p-4 bg-green-50 rounded-2xl\">\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Next Tier Range</p>\n                    <p className=\"text-xl font-fredoka font-bold text-fresh-mint\">\n                      {getTierDetails(nextTier).base_rate_min}-{getTierDetails(nextTier).base_rate_max} credits/hr\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Quick Wins */}\n      <Card className=\"border-0 shadow-lg rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <Zap className=\"w-6 h-6 text-fresh-mint\" />\n            Quick Wins to Boost Your Score\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"space-y-3\">\n            {components.photo_proof < 90 && (\n              <QuickWinCard\n                icon={Camera}\n                title=\"Upload More Photos\"\n                description=\"Always upload 3+ before/after photos for +15 points\"\n                impact=\"+15 pts\"\n                color=\"bg-purple-50 border-purple-200 text-purple-700\"\n              />\n            )}\n            {components.punctuality < 90 && (\n              <QuickWinCard\n                icon={Clock}\n                title=\"Arrive On Time\"\n                description=\"GPS check-in within 15 minutes of scheduled start\"\n                impact=\"+20 pts\"\n                color=\"bg-blue-50 border-blue-200 text-blue-700\"\n              />\n            )}\n            {components.completion_confirmation < 90 && (\n              <QuickWinCard\n                icon={CheckCircle}\n                title=\"Complete Check-Out\"\n                description=\"Always GPS check-out + upload photos when done\"\n                impact=\"+10 pts\"\n                color=\"bg-green-50 border-green-200 text-fresh-mint\"\n              />\n            )}\n            {components.attendance < 90 && (\n              <QuickWinCard\n                icon={CheckCircle}\n                title=\"Maintain Attendance\"\n                description=\"Show up for every accepted job\"\n                impact=\"+25 pts\"\n                color=\"bg-amber-50 border-amber-200 text-amber-700\"\n              />\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tier Benefits */}\n      <Card className=\"border-0 shadow-lg rounded-2xl\">\n        <CardHeader className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-t-2xl\">\n          <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n            <Award className=\"w-6 h-6 text-amber-600\" />\n            Your {tier} Tier Benefits\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"p-6\">\n          <div className=\"space-y-3\">\n            <BenefitItem \n              icon={DollarSign}\n              text={`Charge ${tierDetails.base_rate_min}-${tierDetails.base_rate_max} credits/hour`}\n            />\n            <BenefitItem \n              icon={Star}\n              text=\"Featured in search results\"\n            />\n            <BenefitItem \n              icon={CheckCircle}\n              text=\"Verified professional badge\"\n            />\n            {tier === 'Elite' && (\n              <>\n                <BenefitItem \n                  icon={Zap}\n                  text=\"Priority support & dispute resolution\"\n                  highlight\n                />\n                <BenefitItem \n                  icon={DollarSign}\n                  text=\"85% payout rate (vs 80% standard)\"\n                  highlight\n                />\n              </>\n            )}\n          </div>\n\n          {total_jobs < 10 && (\n            <Alert className=\"mt-4 border-blue-200 bg-blue-50 rounded-2xl\">\n              <Info className=\"w-4 h-4 text-puretask-blue\" />\n              <AlertDescription className=\"text-blue-900 font-verdana\">\n                Complete {10 - total_jobs} more job{(10 - total_jobs) !== 1 ? 's' : ''} to unlock full tier features and visibility\n              </AlertDescription>\n            </Alert>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Recommended Rate */}\n      <Card className=\"border-0 shadow-lg rounded-2xl bg-gradient-to-r from-blue-50 to-cyan-50\">\n        <CardContent className=\"p-6 text-center\">\n          <DollarSign className=\"w-12 h-12 text-puretask-blue mx-auto mb-3\" />\n          <h3 className=\"font-fredoka font-bold text-graphite text-xl mb-2\">\n            Recommended Rate\n          </h3>\n          <p className=\"text-4xl font-fredoka font-bold text-puretask-blue mb-2\">\n            {recommendedRate} credits/hr\n          </p>\n          <p className=\"text-sm text-gray-600 font-verdana\">\n            Based on your {tier} tier and {total_score} reliability score\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nconst QuickWinCard = ({ icon: Icon, title, description, impact, color }) => (\n  <motion.div\n    initial={{ opacity: 0, x: -20 }}\n    animate={{ opacity: 1, x: 0 }}\n    className={`p-4 rounded-2xl border ${color} flex items-start gap-3`}\n  >\n    <Icon className=\"w-5 h-5 mt-0.5 flex-shrink-0\" />\n    <div className=\"flex-1\">\n      <div className=\"flex items-center justify-between mb-1\">\n        <h4 className=\"font-fredoka font-semibold text-graphite\">{title}</h4>\n        <Badge className=\"bg-fresh-mint text-white rounded-full font-fredoka\">\n          {impact}\n        </Badge>\n      </div>\n      <p className=\"text-sm text-gray-600 font-verdana\">{description}</p>\n    </div>\n  </motion.div>\n);\n\nconst BenefitItem = ({ icon: Icon, text, highlight = false }) => (\n  <div className={`flex items-center gap-3 p-3 rounded-2xl ${\n    highlight ? 'bg-amber-50 border border-amber-200' : 'bg-soft-cloud'\n  }`}>\n    <Icon className={`w-5 h-5 ${highlight ? 'text-amber-600' : 'text-puretask-blue'}`} />\n    <span className={`font-verdana ${highlight ? 'font-semibold text-amber-900' : 'text-gray-700'}`}>\n      {text}\n    </span>\n    {highlight && <Badge className=\"ml-auto bg-amber-600 text-white rounded-full font-fredoka\">Elite</Badge>}\n  </div>\n);\n\nconst getNextTier = (currentTier) => {\n  const tiers = ['Developing', 'Semi Pro', 'Pro', 'Elite'];\n  const currentIndex = tiers.indexOf(currentTier);\n  return currentIndex < tiers.length - 1 ? tiers[currentIndex + 1] : null;\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityDashboardV2.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":20,"fix":{"range":[296,308],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[295,307],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { \n  Award, TrendingUp, CheckCircle, Clock, XCircle, \n  Camera, MessageSquare, Star, Target, Zap \n} from 'lucide-react';\nimport ReliabilityScoreExplainer from './ReliabilityScoreExplainer';\nimport TierProgressExplainer from '../tier/TierProgressExplainer';\n\nexport default function ReliabilityDashboardV2({ cleanerEmail }) {\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadProfile();\n  }, [cleanerEmail]);\n\n  const loadProfile = async () => {\n    setLoading(true);\n    try {\n      const profiles = await base44.entities.CleanerProfile.filter({\n        user_email: cleanerEmail\n      });\n      if (profiles.length > 0) {\n        setProfile(profiles[0]);\n      }\n    } catch (error) {\n      console.error('Error loading profile:', error);\n    }\n    setLoading(false);\n  };\n\n  if (loading || !profile) {\n    return <div className=\"text-center py-8 font-verdana\">Loading metrics...</div>;\n  }\n\n  const reliabilityDisplay = getReliabilityDisplay(profile.reliability_score || 75);\n  const tierDisplay = getTierDisplay(profile.tier || 'Developing');\n\n  const metrics = [\n    { label: 'Attendance', value: profile.attendance_rate || 100, icon: CheckCircle, color: 'text-green-600' },\n    { label: 'Punctuality', value: profile.punctuality_rate || 100, icon: Clock, color: 'text-blue-600' },\n    { label: 'Photo Proof', value: profile.photo_proof_rate || 100, icon: Camera, color: 'text-purple-600' },\n    { label: 'Communication', value: profile.communication_rate || 85, icon: MessageSquare, color: 'text-indigo-600' }\n  ];\n\n  const negativeMetrics = [\n    { label: 'Cancellation Rate', value: profile.cancellation_rate || 0, icon: XCircle },\n    { label: 'No-Show Rate', value: profile.no_show_rate || 0, icon: XCircle },\n    { label: 'Dispute Rate', value: profile.dispute_rate || 0, icon: XCircle }\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Explainers */}\n      <ReliabilityScoreExplainer />\n      <TierProgressExplainer \n        currentTier={profile.tier || 'Developing'}\n        score={profile.reliability_score || 75}\n        totalJobs={profile.total_jobs || 0}\n      />\n\n      {/* Overall Reliability Score */}\n      <Card className=\"rounded-3xl border-0 shadow-xl bg-gradient-to-br from-blue-50 to-indigo-50\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-2xl\">Reliability Score</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <div className=\"text-5xl font-fredoka font-bold text-puretask-blue\">\n                {profile.reliability_score || 75}\n              </div>\n              <Badge className={`${reliabilityDisplay.bgColor} ${reliabilityDisplay.color} mt-2`}>\n                {reliabilityDisplay.label}\n              </Badge>\n            </div>\n            <Award className=\"w-20 h-20 text-puretask-blue opacity-30\" />\n          </div>\n          <Progress value={profile.reliability_score || 75} className=\"h-3\" />\n        </CardContent>\n      </Card>\n\n      {/* Tier & Progress */}\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n            <Target className=\"w-5 h-5\" />\n            Current Tier\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"text-4xl\">{tierDisplay.icon}</div>\n              <div>\n                <div className=\"text-2xl font-fredoka font-bold text-graphite\">\n                  {profile.tier || 'Developing'}\n                </div>\n                <div className=\"text-sm text-gray-600 font-verdana\">\n                  {profile.total_jobs || 0} jobs completed\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {profile.tier_progress && profile.tier !== 'Elite' && (\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-2xl\">\n              <p className=\"text-sm font-verdana text-gray-700 mb-2\">\n                Progress to next tier:\n              </p>\n              <div className=\"space-y-2\">\n                {profile.tier_progress.jobs_to_next_tier > 0 && (\n                  <div className=\"text-sm font-verdana\">\n                    <span className=\"font-semibold\">{profile.tier_progress.jobs_to_next_tier}</span> more jobs needed\n                  </div>\n                )}\n                {profile.tier_progress.score_to_next_tier > 0 && (\n                  <div className=\"text-sm font-verdana\">\n                    <span className=\"font-semibold\">+{profile.tier_progress.score_to_next_tier}</span> reliability points needed\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Performance Metrics */}\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl\">Performance Metrics</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {metrics.map((metric, index) => (\n            <div key={index} className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <metric.icon className={`w-5 h-5 ${metric.color}`} />\n                <span className=\"font-verdana text-gray-700\">{metric.label}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Progress value={metric.value} className=\"w-24 h-2\" />\n                <span className=\"font-fredoka font-semibold text-graphite min-w-[50px] text-right\">\n                  {metric.value.toFixed(1)}%\n                </span>\n              </div>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n\n      {/* Negative Metrics (Lower is Better) */}\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl\">Quality Indicators</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {negativeMetrics.map((metric, index) => (\n            <div key={index} className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <metric.icon className=\"w-5 h-5 text-gray-600\" />\n                <span className=\"font-verdana text-gray-700\">{metric.label}</span>\n              </div>\n              <Badge variant={metric.value === 0 ? 'success' : 'secondary'}>\n                {metric.value.toFixed(1)}%\n              </Badge>\n            </div>\n          ))}\n        </CardContent>\n      </Card>\n\n      {/* Streaks */}\n      {(profile.current_streak_days > 0 || profile.best_streak_days > 0) && (\n        <Card className=\"rounded-3xl border-0 shadow-xl bg-gradient-to-br from-yellow-50 to-orange-50\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n              <Zap className=\"w-5 h-5 text-orange-600\" />\n              Success Streaks\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"font-verdana text-gray-700\">Current Streak</span>\n              <span className=\"text-2xl font-fredoka font-bold text-orange-600\">\n                {profile.current_streak_days || 0} days üî•\n              </span>\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <span className=\"font-verdana text-gray-700\">Best Streak</span>\n              <span className=\"text-xl font-fredoka font-semibold text-gray-700\">\n                {profile.best_streak_days || 0} days\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Ratings */}\n      <Card className=\"rounded-3xl border-0 shadow-xl\">\n        <CardHeader>\n          <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n            <Star className=\"w-5 h-5 text-yellow-600\" />\n            Client Reviews\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <div className=\"text-4xl font-fredoka font-bold text-graphite\">\n                {profile.average_rating?.toFixed(1) || '5.0'}\n              </div>\n              <div className=\"text-sm text-gray-600 font-verdana mt-1\">\n                {profile.total_reviews || 0} reviews\n              </div>\n            </div>\n            <div className=\"flex gap-1\">\n              {[1, 2, 3, 4, 5].map((star) => (\n                <Star\n                  key={star}\n                  className={`w-6 h-6 ${\n                    star <= (profile.average_rating || 5) \n                      ? 'text-yellow-500 fill-yellow-500' \n                      : 'text-gray-300'\n                  }`}\n                />\n              ))}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nfunction getReliabilityDisplay(reliabilityScore) {\n  if (reliabilityScore >= 90) {\n    return { label: 'Excellent', color: 'text-green-600', bgColor: 'bg-green-100' };\n  } else if (reliabilityScore >= 80) {\n    return { label: 'Great', color: 'text-blue-600', bgColor: 'bg-blue-100' };\n  } else if (reliabilityScore >= 70) {\n    return { label: 'Good', color: 'text-yellow-600', bgColor: 'bg-yellow-100' };\n  } else {\n    return { label: 'Needs Improvement', color: 'text-red-600', bgColor: 'bg-red-100' };\n  }\n}\n\nfunction getTierDisplay(tier) {\n  const displays = {\n    'Elite': { color: 'text-purple-600', bgColor: 'bg-purple-100', icon: 'üëë' },\n    'Pro': { color: 'text-blue-600', bgColor: 'bg-blue-100', icon: '‚≠ê' },\n    'Semi Pro': { color: 'text-green-600', bgColor: 'bg-green-100', icon: '‚úì' },\n    'Developing': { color: 'text-gray-600', bgColor: 'bg-gray-100', icon: 'üå±' }\n  };\n  return displays[tier] || displays['Developing'];\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityEngine.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityMeter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityMeterV2.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityScoreBreakdown.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":14,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// ReliabilityScoreBreakdown - Detailed reliability analysis\r\n// Shows exactly how the score is calculated and how to improve\r\n\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport {\r\n  Award, CheckCircle, Clock, Star, TrendingUp, AlertTriangle,\r\n  Target, Zap, Trophy\r\n} from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface ReliabilityBreakdownProps {\r\n  score: number;\r\n  breakdown: {\r\n    acceptanceRate: { score: number; weight: 20; actual: number };\r\n    onTimeRate: { score: number; weight: 30; actual: number };\r\n    completionRate: { score: number; weight: 30; actual: number };\r\n    clientRatings: { score: number; weight: 20; actual: number };\r\n  };\r\n  tier: 'bronze' | 'silver' | 'gold' | 'platinum';\r\n  jobsCompleted: number;\r\n}\r\n\r\nexport default function ReliabilityScoreBreakdown({\r\n  score,\r\n  breakdown,\r\n  tier,\r\n  jobsCompleted\r\n}: ReliabilityBreakdownProps) {\r\n  \r\n  const getTierInfo = () => {\r\n    const tiers = {\r\n      bronze: {\r\n        name: 'Bronze',\r\n        min: 0,\r\n        max: 69,\r\n        color: '#CD7F32',\r\n        icon: Award,\r\n        benefits: ['Basic job access', 'Standard payout: 80%']\r\n      },\r\n      silver: {\r\n        name: 'Silver',\r\n        min: 70,\r\n        max: 84,\r\n        color: '#C0C0C0',\r\n        icon: Award,\r\n        benefits: ['Priority job offers', 'Standard payout: 80%', '+5% bonus on weekends']\r\n      },\r\n      gold: {\r\n        name: 'Gold',\r\n        min: 85,\r\n        max: 94,\r\n        color: '#FFD700',\r\n        icon: Trophy,\r\n        benefits: ['First access to high-paying jobs', 'Enhanced payout: 82%', '+10% bonus on weekends', 'Featured cleaner badge']\r\n      },\r\n      platinum: {\r\n        name: 'Platinum',\r\n        min: 95,\r\n        max: 100,\r\n        color: '#E5E4E2',\r\n        icon: Trophy,\r\n        benefits: ['Exclusive VIP job access', 'Premium payout: 85%', '+15% bonus weekends', 'Priority support', 'Custom scheduling']\r\n      }\r\n    };\r\n    \r\n    return tiers[tier];\r\n  };\r\n  \r\n  const tierInfo = getTierInfo();\r\n  const Icon = tierInfo.icon;\r\n  \r\n  const nextTier = tier === 'bronze' ? 'silver' : tier === 'silver' ? 'gold' : tier === 'gold' ? 'platinum' : null;\r\n  const pointsToNextTier = nextTier ? getTierInfo()[nextTier].min - score : 0;\r\n  \r\n  const factors = [\r\n    {\r\n      name: 'Job Acceptance',\r\n      icon: CheckCircle,\r\n      weight: breakdown.acceptanceRate.weight,\r\n      score: breakdown.acceptanceRate.score,\r\n      actual: breakdown.acceptanceRate.actual,\r\n      color: '#22C55E',\r\n      description: 'Accept jobs you can complete',\r\n      tips: [\r\n        'Accept 90%+ of job offers',\r\n        'Only decline if truly necessary',\r\n        'Fast responses improve score'\r\n      ]\r\n    },\r\n    {\r\n      name: 'On-Time Arrival',\r\n      icon: Clock,\r\n      weight: breakdown.onTimeRate.weight,\r\n      score: breakdown.onTimeRate.score,\r\n      actual: breakdown.onTimeRate.actual,\r\n      color: '#06B6D4',\r\n      description: 'Arrive on time or early',\r\n      tips: [\r\n        'Plan for traffic delays',\r\n        'Leave 10 minutes early',\r\n        'Update client if running late'\r\n      ]\r\n    },\r\n    {\r\n      name: 'Job Completion',\r\n      icon: Target,\r\n      weight: breakdown.completionRate.weight,\r\n      score: breakdown.completionRate.score,\r\n      actual: breakdown.completionRate.actual,\r\n      color: '#06B6D4',\r\n      description: 'Complete accepted jobs',\r\n      tips: [\r\n        'Avoid last-minute cancellations',\r\n        'Complete 95%+ of jobs',\r\n        'Request extra time if needed'\r\n      ]\r\n    },\r\n    {\r\n      name: 'Client Ratings',\r\n      icon: Star,\r\n      weight: breakdown.clientRatings.weight,\r\n      score: breakdown.clientRatings.score,\r\n      actual: breakdown.clientRatings.actual,\r\n      color: '#F59E0B',\r\n      description: 'Maintain high client satisfaction',\r\n      tips: [\r\n        'Take quality before/after photos',\r\n        'Communicate with clients',\r\n        'Go above and beyond'\r\n      ]\r\n    }\r\n  ];\r\n  \r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header Card */}\r\n      <Card className=\"border-2\" style={{ borderColor: tierInfo.color }}>\r\n        <CardHeader className=\"bg-gradient-to-r from-gray-50 to-white\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"w-16 h-16 rounded-full flex items-center justify-center\" style={{ backgroundColor: `${tierInfo.color}20` }}>\r\n                <Icon className=\"w-8 h-8\" style={{ color: tierInfo.color }} />\r\n              </div>\r\n              <div>\r\n                <CardTitle className=\"font-heading text-2xl flex items-center gap-2\">\r\n                  {tierInfo.name} Tier\r\n                  <Badge variant=\"system\" className=\"font-heading\">{score}%</Badge>\r\n                </CardTitle>\r\n                <p className=\"text-sm font-body text-gray-600 mt-1\">\r\n                  Based on {jobsCompleted} completed jobs\r\n                </p>\r\n              </div>\r\n            </div>\r\n            \r\n            {nextTier && (\r\n              <div className=\"text-right\">\r\n                <p className=\"text-sm font-body text-gray-600\">Next Tier</p>\r\n                <p className=\"text-2xl font-heading font-bold\" style={{ color: tierInfo.color }}>\r\n                  {pointsToNextTier}pts\r\n                </p>\r\n                <p className=\"text-xs font-body text-gray-500\">to {nextTier}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardHeader>\r\n        \r\n        <CardContent className=\"p-6\">\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <span className=\"font-heading font-semibold\">Current Benefits:</span>\r\n              </div>\r\n              <ul className=\"space-y-2\">\r\n                {tierInfo.benefits.map((benefit, index) => (\r\n                  <li key={index} className=\"flex items-center gap-2 font-body text-sm\">\r\n                    <CheckCircle className=\"w-4 h-4 text-success\" />\r\n                    {benefit}\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n            \r\n            {nextTier && (\r\n              <div className=\"pt-4 border-t\">\r\n                <p className=\"font-heading font-semibold mb-2\">Unlock at {getTierInfo()[nextTier].min}%:</p>\r\n                <ul className=\"space-y-2\">\r\n                  {getTierInfo()[nextTier].benefits.slice(0, 2).map((benefit, index) => (\r\n                    <li key={index} className=\"flex items-center gap-2 font-body text-sm text-gray-600\">\r\n                      <Zap className=\"w-4 h-4 text-warning\" />\r\n                      {benefit}\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Score Breakdown */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"font-heading flex items-center gap-2\">\r\n            <TrendingUp className=\"w-5 h-5 text-info\" />\r\n            Score Breakdown\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {factors.map((factor, index) => {\r\n            const FIcon = factor.icon;\r\n            const percentage = (factor.score / 100) * factor.weight;\r\n            const maxPossible = factor.weight;\r\n            \r\n            return (\r\n              <motion.div\r\n                key={factor.name}\r\n                initial={{ opacity: 0, x: -20 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                transition={{ delay: index * 0.1 }}\r\n                className=\"space-y-3\"\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-full flex items-center justify-center\" style={{ backgroundColor: `${factor.color}20` }}>\r\n                      <FIcon className=\"w-5 h-5\" style={{ color: factor.color }} />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-heading font-semibold\">{factor.name}</p>\r\n                      <p className=\"text-xs font-body text-gray-600\">{factor.description}</p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-2xl font-heading font-bold\" style={{ color: factor.color }}>\r\n                      {percentage.toFixed(1)}\r\n                    </p>\r\n                    <p className=\"text-xs font-body text-gray-500\">of {maxPossible} pts</p>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"space-y-1\">\r\n                  <div className=\"flex items-center justify-between text-xs font-body text-gray-600\">\r\n                    <span>Performance: {factor.actual}%</span>\r\n                    <span>Weight: {factor.weight}%</span>\r\n                  </div>\r\n                  <Progress value={(percentage / maxPossible) * 100} className=\"h-2\" />\r\n                </div>\r\n                \r\n                {/* Tips */}\r\n                <details className=\"group\">\r\n                  <summary className=\"cursor-pointer text-sm font-body text-info hover:text-info/80 flex items-center gap-1\">\r\n                    <Zap className=\"w-4 h-4\" />\r\n                    How to improve\r\n                  </summary>\r\n                  <ul className=\"mt-2 ml-5 space-y-1\">\r\n                    {factor.tips.map((tip, i) => (\r\n                      <li key={i} className=\"text-xs font-body text-gray-600\">‚Ä¢ {tip}</li>\r\n                    ))}\r\n                  </ul>\r\n                </details>\r\n              </motion.div>\r\n            );\r\n          })}\r\n        </CardContent>\r\n      </Card>\r\n      \r\n      {/* Quick Improvement Actions */}\r\n      <Card className=\"border-success-border\">\r\n        <CardHeader className=\"bg-gradient-to-r from-success-soft to-white\">\r\n          <CardTitle className=\"font-heading flex items-center gap-2\">\r\n            <Target className=\"w-5 h-5 text-success\" />\r\n            Quick Wins to Boost Score\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            {[\r\n              { action: 'Accept next 5 jobs', impact: '+2-3 pts', icon: CheckCircle },\r\n              { action: 'Arrive early this week', impact: '+3-4 pts', icon: Clock },\r\n              { action: 'Get 3 five-star ratings', impact: '+1-2 pts', icon: Star },\r\n              { action: 'Complete 10 jobs in a row', impact: '+4-5 pts', icon: Trophy }\r\n            ].map((item, index) => {\r\n              const ItemIcon = item.icon;\r\n              return (\r\n                <motion.div\r\n                  key={index}\r\n                  initial={{ opacity: 0, scale: 0.9 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  transition={{ delay: index * 0.1 }}\r\n                  className=\"p-4 border-2 border-success-border rounded-lg bg-success-soft hover:shadow-md transition-shadow cursor-pointer\"\r\n                >\r\n                  <ItemIcon className=\"w-6 h-6 text-success mb-2\" />\r\n                  <p className=\"font-heading font-semibold text-sm mb-1\">{item.action}</p>\r\n                  <p className=\"text-xs font-body text-success\">{item.impact}</p>\r\n                </motion.div>\r\n              );\r\n            })}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityScoreCalculator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityScoreCalculatorV2.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'completedBookings' is defined but never used. Allowed unused args must match /^_/u.","line":254,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":254,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"completedBookings"},"fix":{"range":[8083,8100],"text":""},"desc":"Remove unused variable 'completedBookings'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Reliability Score Calculator V2 - Section 4.1\n * \n * SCORING FORMULA (0-100 scale):\n * =====================================\n * 1. Attendance Rate (25 points)\n * 2. Punctuality Rate (20 points)\n * 3. Photo Proof Compliance (15 points)\n * 4. Communication Rate (10 points)\n * 5. Completion Confirmation (10 points)\n * 6. Average Rating (10 points)\n * 7. Cancellation Rate (penalty -20 points)\n * 8. Dispute Rate (penalty -10 points)\n * 9. No-Show Rate (penalty -15 points)\n * \n * TIER SYSTEM:\n * - Developing: 0-59 (150-350 credits/hr base rate) - NEW CLEANERS START HERE\n * - Semi Pro: 60-74 (350-450 credits/hr base rate)\n * - Pro: 75-89 (450-600 credits/hr base rate)\n * - Elite: 90-100 (600-850 credits/hr base rate)\n */\n\nimport { base44 } from '@/api/base44Client';\n\n// Scoring weights (must sum to 100)\nconst WEIGHTS = {\n  attendance: 25,\n  punctuality: 20,\n  photo_proof: 15,\n  communication: 10,\n  completion_confirmation: 10,\n  average_rating: 10,\n  cancellation_penalty: -20,\n  dispute_penalty: -10,\n  no_show_penalty: -15\n};\n\n// Tier thresholds\nconst TIERS = {\n  'Developing': { min: 0, max: 59, base_rate_min: 150, base_rate_max: 350 },\n  'Semi Pro': { min: 60, max: 74, base_rate_min: 350, base_rate_max: 450 },\n  'Pro': { min: 75, max: 89, base_rate_min: 450, base_rate_max: 600 },\n  'Elite': { min: 90, max: 100, base_rate_min: 600, base_rate_max: 850 }\n};\n\n/**\n * Calculate reliability score for a cleaner\n */\nexport const calculateReliabilityScore = async (cleanerEmail) => {\n  try {\n    // Get cleaner profile\n    const profiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n    if (profiles.length === 0) {\n      throw new Error('Cleaner profile not found');\n    }\n    const profile = profiles[0];\n\n    // Get all completed bookings for this cleaner\n    const completedBookings = await base44.entities.Booking.filter({\n      cleaner_email: cleanerEmail,\n      status: { $in: ['completed', 'approved'] }\n    });\n\n    // Get all bookings (including cancelled) for rates\n    const allBookings = await base44.entities.Booking.filter({\n      cleaner_email: cleanerEmail\n    });\n\n    // NEW CLEANERS START AT BOTTOM TIER (0-5 jobs)\n    if (allBookings.length === 0 || allBookings.length < 5) {\n      return {\n        total_score: 30, // Start at bottom of Developing tier\n        tier: 'Developing',\n        components: getNewCleanerComponents(),\n        total_jobs: allBookings.length,\n        message: 'New cleaner - starting at Developing tier'\n      };\n    }\n\n    // Calculate each component\n    const components = {\n      attendance: calculateAttendanceScore(allBookings),\n      punctuality: calculatePunctualityScore(completedBookings),\n      photo_proof: calculatePhotoProofScore(completedBookings),\n      communication: calculateCommunicationScore(profile),\n      completion_confirmation: calculateCompletionConfirmationScore(completedBookings),\n      average_rating: calculateAverageRatingScore(profile),\n      cancellation_penalty: calculateCancellationPenalty(allBookings),\n      dispute_penalty: calculateDisputePenalty(completedBookings),\n      no_show_penalty: calculateNoShowPenalty(allBookings)\n    };\n\n    // Calculate total score\n    const totalScore = Math.max(0, Math.min(100,\n      (components.attendance * WEIGHTS.attendance / 100) +\n      (components.punctuality * WEIGHTS.punctuality / 100) +\n      (components.photo_proof * WEIGHTS.photo_proof / 100) +\n      (components.communication * WEIGHTS.communication / 100) +\n      (components.completion_confirmation * WEIGHTS.completion_confirmation / 100) +\n      (components.average_rating * WEIGHTS.average_rating / 100) +\n      components.cancellation_penalty +\n      components.dispute_penalty +\n      components.no_show_penalty\n    ));\n\n    // Determine tier\n    const tier = getTierFromScore(totalScore);\n\n    return {\n      total_score: Math.round(totalScore),\n      tier,\n      components,\n      total_jobs: completedBookings.length,\n      raw_calculation: components\n    };\n  } catch (error) {\n    console.error('Error calculating reliability score:', error);\n    throw error;\n  }\n};\n\n/**\n * 1. Attendance Rate (25 points)\n * Shows up for accepted jobs vs. no-shows\n */\nconst calculateAttendanceScore = (allBookings) => {\n  const acceptedJobs = allBookings.filter(b => \n    ['scheduled', 'completed', 'approved', 'in_progress'].includes(b.status)\n  );\n  \n  if (acceptedJobs.length === 0) return 100;\n\n  const noShows = allBookings.filter(b => \n    b.status === 'cancelled' && b.cancelled_by === 'system' && !b.check_in_time\n  ).length;\n\n  const attendanceRate = ((acceptedJobs.length - noShows) / acceptedJobs.length) * 100;\n  return Math.round(attendanceRate);\n};\n\n/**\n * 2. Punctuality Rate (20 points)\n * GPS check-in within 15 minutes of scheduled start\n */\nconst calculatePunctualityScore = (completedBookings) => {\n  if (completedBookings.length === 0) return 100;\n\n  let onTimeCount = 0;\n  completedBookings.forEach(booking => {\n    if (!booking.check_in_time) return;\n\n    const scheduledTime = new Date(`${booking.date}T${booking.start_time}`);\n    const checkInTime = new Date(booking.check_in_time);\n    const minutesLate = (checkInTime - scheduledTime) / (1000 * 60);\n\n    if (minutesLate <= 15) {\n      onTimeCount++;\n    }\n  });\n\n  const punctualityRate = (onTimeCount / completedBookings.length) * 100;\n  return Math.round(punctualityRate);\n};\n\n/**\n * 3. Photo Proof Compliance (15 points)\n * Uploads minimum 3 photos (before + after combined)\n */\nconst calculatePhotoProofScore = (completedBookings) => {\n  if (completedBookings.length === 0) return 100;\n\n  let compliantCount = 0;\n  completedBookings.forEach(booking => {\n    const beforePhotos = booking.before_photos?.length || 0;\n    const afterPhotos = booking.after_photos?.length || 0;\n    const totalPhotos = beforePhotos + afterPhotos;\n\n    if (totalPhotos >= 3) {\n      compliantCount++;\n    }\n  });\n\n  const complianceRate = (compliantCount / completedBookings.length) * 100;\n  return Math.round(complianceRate);\n};\n\n/**\n * 4. Communication Rate (10 points)\n * Based on response time and messaging activity\n */\nconst calculateCommunicationScore = (profile) => {\n  // Use stored communication_rate or default to 100\n  return profile.communication_rate || 100;\n};\n\n/**\n * 5. Completion Confirmation (10 points)\n * Checks out via GPS + uploads photos\n */\nconst calculateCompletionConfirmationScore = (completedBookings) => {\n  if (completedBookings.length === 0) return 100;\n\n  let confirmedCount = 0;\n  completedBookings.forEach(booking => {\n    const hasCheckOut = !!booking.check_out_time;\n    const hasPhotos = (booking.before_photos?.length || 0) + (booking.after_photos?.length || 0) >= 3;\n\n    if (hasCheckOut && hasPhotos) {\n      confirmedCount++;\n    }\n  });\n\n  const confirmationRate = (confirmedCount / completedBookings.length) * 100;\n  return Math.round(confirmationRate);\n};\n\n/**\n * 6. Average Rating (10 points)\n * Client star ratings (1-5 stars, normalized to 0-100)\n */\nconst calculateAverageRatingScore = (profile) => {\n  const avgRating = profile.average_rating || 5.0;\n  // Convert 1-5 scale to 0-100 scale\n  return Math.round(((avgRating - 1) / 4) * 100);\n};\n\n/**\n * 7. Cancellation Penalty (-20 points max)\n * Cleaner-initiated cancellations within 24h of job\n */\nconst calculateCancellationPenalty = (allBookings) => {\n  const cancelledByCleanerLate = allBookings.filter(b => {\n    if (b.status !== 'cancelled' || b.cancelled_by !== b.cleaner_email) return false;\n\n    const jobTime = new Date(`${b.date}T${b.start_time}`);\n    const cancelTime = new Date(b.cancellation_timestamp);\n    const hoursUntilJob = (jobTime - cancelTime) / (1000 * 60 * 60);\n\n    return hoursUntilJob < 24;\n  }).length;\n\n  if (allBookings.length === 0) return 0;\n\n  const cancellationRate = (cancelledByCleanerLate / allBookings.length) * 100;\n  const penalty = Math.min(20, (cancellationRate / 10) * 20); // Max -20 points\n\n  return -Math.round(penalty);\n};\n\n/**\n * 8. Dispute Penalty (-10 points max)\n * Disputes where cleaner was at fault\n */\nconst calculateDisputePenalty = (completedBookings) => {\n  // This would require checking Dispute entity\n  // Simplified: assume low dispute rate for now\n  return 0; // TODO: Integrate with Dispute entity\n};\n\n/**\n * 9. No-Show Penalty (-15 points max)\n * Failed to check in for accepted jobs\n */\nconst calculateNoShowPenalty = (allBookings) => {\n  const noShows = allBookings.filter(b => \n    ['scheduled', 'in_progress'].includes(b.status) && \n    !b.check_in_time &&\n    new Date(`${b.date}T${b.start_time}`) < new Date()\n  ).length;\n\n  if (allBookings.length === 0) return 0;\n\n  const noShowRate = (noShows / allBookings.length) * 100;\n  const penalty = Math.min(15, (noShowRate / 5) * 15); // Max -15 points\n\n  return -Math.round(penalty);\n};\n\n/**\n * Get components for new cleaners (start at bottom tier)\n */\nconst getNewCleanerComponents = () => ({\n  attendance: 50,\n  punctuality: 50,\n  photo_proof: 50,\n  communication: 50,\n  completion_confirmation: 50,\n  average_rating: 50,\n  cancellation_penalty: 0,\n  dispute_penalty: 0,\n  no_show_penalty: 0\n});\n\n/**\n * Determine tier from score\n */\nexport const getTierFromScore = (score) => {\n  if (score >= 90) return 'Elite';\n  if (score >= 75) return 'Pro';\n  if (score >= 60) return 'Semi Pro';\n  return 'Developing';\n};\n\n/**\n * Get tier details\n */\nexport const getTierDetails = (tier) => {\n  return TIERS[tier] || TIERS['Developing'];\n};\n\n/**\n * Get recommended base rate for tier\n */\nexport const getRecommendedBaseRate = (tier, currentScore) => {\n  const tierDetails = getTierDetails(tier);\n  \n  // Within tier, scale rate based on position in tier range\n  const tierRange = tierDetails.max - tierDetails.min;\n  const positionInTier = Math.max(0, currentScore - tierDetails.min);\n  const percentile = positionInTier / tierRange;\n\n  const rateRange = tierDetails.base_rate_max - tierDetails.base_rate_min;\n  const recommendedRate = tierDetails.base_rate_min + (rateRange * percentile);\n\n  return Math.round(recommendedRate);\n};\n\n/**\n * Update cleaner profile with new score\n */\nexport const updateCleanerScore = async (cleanerEmail) => {\n  try {\n    const scoreData = await calculateReliabilityScore(cleanerEmail);\n    \n    const profiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n    if (profiles.length === 0) {\n      throw new Error('Cleaner profile not found');\n    }\n\n    const profile = profiles[0];\n    const oldTier = profile.tier;\n    const newTier = scoreData.tier;\n\n    // Update profile\n    await base44.entities.CleanerProfile.update(profile.id, {\n      reliability_score: scoreData.total_score,\n      tier: newTier,\n      attendance_rate: scoreData.components.attendance,\n      punctuality_rate: scoreData.components.punctuality,\n      photo_compliance_rate: scoreData.components.photo_proof,\n      communication_rate: scoreData.components.communication,\n      completion_confirmation_rate: scoreData.components.completion_confirmation,\n      cancellation_rate: Math.abs(scoreData.components.cancellation_penalty),\n      no_show_rate: Math.abs(scoreData.components.no_show_penalty),\n      dispute_rate: Math.abs(scoreData.components.dispute_penalty),\n      last_score_update: new Date().toISOString(),\n      total_jobs: scoreData.total_jobs\n    });\n\n    // If tier changed, emit event\n    if (oldTier !== newTier) {\n      // Trigger reliability_changed event (Section 3 integration)\n      console.log(`Tier changed for ${cleanerEmail}: ${oldTier} ‚Üí ${newTier}`);\n      \n      // TODO: Integrate with EventBus\n      // await EventBus.emit('reliability_changed', {\n      //   cleaner_email: cleanerEmail,\n      //   old_tier: oldTier,\n      //   new_tier: newTier,\n      //   score: scoreData.total_score\n      // });\n    }\n\n    return {\n      success: true,\n      old_score: profile.reliability_score,\n      new_score: scoreData.total_score,\n      old_tier: oldTier,\n      new_tier: newTier,\n      tier_changed: oldTier !== newTier\n    };\n  } catch (error) {\n    console.error('Error updating cleaner score:', error);\n    throw error;\n  }\n};\n\nexport default {\n  calculateReliabilityScore,\n  updateCleanerScore,\n  getTierFromScore,\n  getTierDetails,\n  getRecommendedBaseRate,\n  WEIGHTS,\n  TIERS\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reliability\\ReliabilityScoreExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ChevronUp' is defined but never used.","line":2,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":74,"fix":{"range":[103,114],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ChevronUp"},"fix":{"range":[103,114],"text":""},"desc":"Remove unused variable 'ChevronUp'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Info, CheckCircle2, XCircle, AlertCircle, ChevronDown, ChevronUp } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function ReliabilityScoreExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  const positiveFactors = [\n    { label: 'Show up on time', impact: '+5 points', icon: CheckCircle2 },\n    { label: 'Upload photo proof', impact: '+3 points', icon: CheckCircle2 },\n    { label: 'Complete jobs as scheduled', impact: '+2 points', icon: CheckCircle2 },\n    { label: 'Respond to messages quickly', impact: '+1 point', icon: CheckCircle2 },\n    { label: 'Get 5-star reviews', impact: '+3 points', icon: CheckCircle2 }\n  ];\n\n  const negativeFactors = [\n    { label: 'Cancel within 24 hours', impact: '-15 points', icon: XCircle },\n    { label: 'No-show to job', impact: '-30 points', icon: XCircle },\n    { label: 'Arrive late (15+ min)', impact: '-5 points', icon: XCircle },\n    { label: 'Missing photo proof', impact: '-10 points', icon: XCircle },\n    { label: 'Receive dispute', impact: '-20 points', icon: XCircle }\n  ];\n\n  return (\n    <Card className=\"border-2 border-blue-200\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Info className=\"w-5 h-5 text-blue-600\" />\n            How Your Score Works\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              <p className=\"text-sm text-gray-700 font-verdana\">\n                Your reliability score (0-100) affects your tier, earnings, and client visibility. Here's what impacts it:\n              </p>\n\n              {/* Positive Actions */}\n              <div>\n                <h4 className=\"font-fredoka font-semibold text-green-700 mb-2 flex items-center gap-2\">\n                  <CheckCircle2 className=\"w-4 h-4\" />\n                  Positive Actions\n                </h4>\n                <div className=\"space-y-2\">\n                  {positiveFactors.map((factor, idx) => (\n                    <div key={idx} className=\"flex items-center justify-between text-sm bg-green-50 rounded-lg p-2\">\n                      <span className=\"text-gray-700 font-verdana\">{factor.label}</span>\n                      <span className=\"text-green-700 font-fredoka font-semibold\">{factor.impact}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Negative Actions */}\n              <div>\n                <h4 className=\"font-fredoka font-semibold text-red-700 mb-2 flex items-center gap-2\">\n                  <XCircle className=\"w-4 h-4\" />\n                  Actions to Avoid\n                </h4>\n                <div className=\"space-y-2\">\n                  {negativeFactors.map((factor, idx) => (\n                    <div key={idx} className=\"flex items-center justify-between text-sm bg-red-50 rounded-lg p-2\">\n                      <span className=\"text-gray-700 font-verdana\">{factor.label}</span>\n                      <span className=\"text-red-700 font-fredoka font-semibold\">{factor.impact}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Score Ranges */}\n              <div className=\"bg-gray-50 rounded-lg p-3\">\n                <h4 className=\"font-fredoka font-semibold text-gray-800 mb-2 text-sm\">Score Ranges:</h4>\n                <div className=\"space-y-1 text-xs font-verdana\">\n                  <div className=\"flex justify-between\">\n                    <span>90-100:</span>\n                    <span className=\"text-green-600 font-semibold\">Excellent (Elite tier eligible)</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>80-89:</span>\n                    <span className=\"text-blue-600 font-semibold\">Great (Pro tier eligible)</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>70-79:</span>\n                    <span className=\"text-yellow-600 font-semibold\">Good (Semi Pro eligible)</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Below 70:</span>\n                    <span className=\"text-gray-600 font-semibold\">Needs improvement</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-xs text-blue-800 font-verdana\">\n                <AlertCircle className=\"w-4 h-4 inline mr-1\" />\n                <strong>Pro Tip:</strong> Maintain 90+ score for 30 days to unlock Elite tier benefits!\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\reviews\\ReviewPrompt.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\risk\\README.md.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected character ' '","line":1,"column":2}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"# Module 11 - Fraud, Trust & Safety Engine\n\n## Overview\nA comprehensive fraud prevention and safety monitoring system built entirely on Base44 to protect the PureTask marketplace from abuse, fraud, and safety issues.\n\n## Architecture\n\n### New Entities\n\n1. **RiskFlag**: Individual risk markers for clients, cleaners, bookings, or payments\n2. **RiskProfile**: Evolving risk score for every client and cleaner\n3. **SafetyIncident**: Safety reports including harassment, theft, and dangerous situations\n4. **RiskActionLog**: Audit trail of all enforcement actions\n\n### Risk Categories\n\n- **Payment Risk**: Failed payments, chargebacks, payment velocity anomalies\n- **Refund Abuse**: High dispute rates, pattern of complaints, refund-heavy clients\n- **Safety Issues**: Harassment, theft, unsafe conditions, injuries\n- **Reliability Risk**: No-shows, cancellation patterns, low reliability scores\n- **Identity Risk**: Incomplete profiles, suspicious account changes\n- **Multi-Account Abuse**: Same payment method across accounts, address sharing\n- **Subscription Abuse**: Short-term subscription gaming, promo code abuse\n- **Behavior Risk**: Suspicious activity patterns\n\n## Risk Scoring\n\n### Formula\n```\nrisk_score = payment_risk \n           + dispute_risk \n           + safety_risk \n           + reliability_risk \n           + identity_risk \n           + multi_account_risk \n           + behavior_risk\n```\n\n### Risk Tiers\n- **0-19**: Normal (full access)\n- **20-39**: Watch (monitored)\n- **40-69**: Restricted (limited access, requires verification)\n- **70-100**: Blocked (account suspended)\n\n### Risk Decay\nEvery 30 days without incidents:\n- Risk score reduced by 10-20%\n- Minor flags automatically expire\n- Severity of tags reduced\n\n## Detection Rules\n\n### Financial Rules\n- `CLIENT_PAYMENT_FAIL_SPIKE`: 3+ failed payments in 7 days\n- `CLIENT_CHARGEBACK`: Chargeback filed ‚Üí +40 risk score, restricted tier\n- `CLEANER_PAYOUT_ANOMALY`: Payouts >3√ó typical average ‚Üí manual review\n\n### Refund Abuse Rules\n- `CLIENT_DISPUTE_RATE_HIGH`: Dispute rate >30% over 90 days\n- `CLIENT_REFUND_VOLUME_HIGH`: Refunds >$500 in 60 days ‚Üí manual review required\n\n### Cleaner Risk Rules\n- `CLEANER_NO_SHOW_PATTERN`: ‚â•2 no-shows in last 10 jobs OR >5% no-show rate\n- `CLEANER_DISPUTE_PATTERN`: 3+ client-favor disputes in 60 days\n- `CLEANER_OVERLOAD_RISK`: 3+ jobs/day or <90 min gap between jobs\n\n### Safety Rules\n- `SAFETY_CRITICAL`: Auto-block on critical safety incidents\n- `SAFETY_REPEAT_OFFENDER`: >1 serious safety dispute ‚Üí blocked\n\n### Subscription Rules\n- `SUBSCRIPTION_GAMING`: 2+ short-term subs (<30 days) in 6 months\n- `PROMO_ABUSE`: Excessive promo code usage\n\n## Automations\n\n### Real-time (Event-Driven)\n`riskAutomations.js` - Triggers on:\n- Dispute created\n- Payment failed/chargeback\n- Booking cancelled/no-show\n- Subscription cancelled early\n- SafetyIncident created\n- CleanerProfile reliability drops\n\n### Nightly Batch\n`cronRisk.js` - Runs at 3:00 AM:\n1. Apply risk decay (reduce scores for good behavior)\n2. Recalculate risk scores for all flagged users\n3. Expire aged risk flags\n4. Escalate unresolved safety incidents\n5. Generate risk spike alerts\n6. Update risk dashboard cache\n\n## Enforcement Actions\n\n### Soft Locks\n- Require identity verification\n- Require payment update\n- Require profile completion\n- Request address verification\n\n### Hard Restrictions\n- Limit booking frequency\n- Prepay-only requirement\n- Disable dispute filing\n- Block subscription enrollment\n- Remove promo eligibility\n\n### Account Blocking\n- Full account suspension\n- Cancel all upcoming bookings\n- Pause disputed payouts\n- Auto-escalate to safety team\n\n## Admin Pages\n\n1. **Trust & Safety Dashboard**: Overview and quick stats\n2. **Risk Management**: User risk profiles and scores\n3. **Risk Flags**: Automated fraud detection alerts\n4. **Safety Incidents**: Critical safety reports and escalations\n\n## Integration with Other Modules\n\n- **Module 1**: Blocks high-risk users from booking\n- **Module 2**: Enforces prepay for risky clients, limits refunds\n- **Module 3**: Flags payout anomalies\n- **Module 5**: Lowers SmartMatch priority for risky cleaners\n- **Module 6**: Uses reliability scores in risk calculations\n- **Module 7**: Dispute outcomes update risk profiles\n- **Module 9**: Detects subscription abuse patterns\n- **Module 10**: Uses analytics for baseline comparisons\n\n## Usage Examples\n\n### Check if client can book\n```javascript\nimport { RiskCheckService } from '@/components/risk/RiskCheckService';\n\nconst check = await RiskCheckService.canClientBook(clientEmail);\nif (!check.allowed) {\n  alert(check.reason);\n  return;\n}\n```\n\n### Display risk badge\n```jsx\nimport RiskBadge from '@/components/risk/RiskBadge';\n\n<RiskBadge userEmail={cleaner.user_email} userType=\"cleaner\" />\n```\n\n### Report safety incident\n```jsx\nimport SafetyIncidentReporter from '@/components/safety/SafetyIncidentReporter';\n\n<SafetyIncidentReporter\n  bookingId={booking.id}\n  clientEmail={booking.client_email}\n  cleanerEmail={booking.cleaner_email}\n  reportedBy=\"client\"\n  onSuccess={() => navigate('/dashboard')}\n/>\n```\n\n## Future Enhancements (v2)\n\n- ML-based anomaly detection\n- Behavioral biometrics\n- Network analysis for multi-account detection\n- AI-powered evidence analysis\n- Risk-based dynamic pricing\n- Automated identity verification (KYC)\n- Geographic risk scoring\n- Payment fingerprinting","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\risk\\RiskBadge.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'userType' is assigned a value but never used. Allowed unused args must match /^_/u.","line":6,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":56,"suggestions":[{"messageId":"removeVar","data":{"varName":"userType"},"fix":{"range":[254,275],"text":""},"desc":"Remove unused variable 'userType'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Badge } from '@/components/ui/badge';\nimport { Shield, AlertTriangle, Eye, Ban } from 'lucide-react';\n\nexport default function RiskBadge({ userEmail, userType = 'client' }) {\n  const [riskProfile, setRiskProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadRiskProfile();\n  }, [userEmail]);\n\n  const loadRiskProfile = async () => {\n    try {\n      const profiles = await base44.entities.RiskProfile.filter({ user_email: userEmail });\n      if (profiles.length > 0) {\n        setRiskProfile(profiles[0]);\n      }\n      setLoading(false);\n    } catch (error) {\n      console.error('Error loading risk profile:', error);\n      setLoading(false);\n    }\n  };\n\n  if (loading || !riskProfile) return null;\n\n  const getTierConfig = (tier) => {\n    switch (tier) {\n      case 'normal':\n        return { color: 'bg-green-100 text-green-800', icon: Shield, label: 'Verified' };\n      case 'watch':\n        return { color: 'bg-yellow-100 text-yellow-800', icon: Eye, label: 'Watch List' };\n      case 'restricted':\n        return { color: 'bg-amber-100 text-amber-800', icon: AlertTriangle, label: 'Restricted' };\n      case 'blocked':\n        return { color: 'bg-red-100 text-red-800', icon: Ban, label: 'Blocked' };\n      default:\n        return { color: 'bg-gray-100 text-gray-800', icon: Shield, label: 'Unknown' };\n    }\n  };\n\n  const config = getTierConfig(riskProfile.risk_tier);\n  const Icon = config.icon;\n\n  if (riskProfile.risk_tier === 'normal') return null; // Don't show badge for normal users\n\n  return (\n    <Badge className={`${config.color} font-fredoka text-xs flex items-center gap-1`}>\n      <Icon className=\"w-3 h-3\" />\n      {config.label}\n    </Badge>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\risk\\RiskCheckService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\risk\\RiskScoreDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\safety\\SafetyIncidentReporter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\settings\\NotificationPreferences.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":10,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":63,"fix":{"range":[449,456],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[448,455],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'pushEnabled' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":62,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"pushEnabled"},"fix":{"range":[1961,2017],"text":""},"desc":"Remove unused variable 'pushEnabled'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"// Notification Preferences Component\r\n// Allows users to control how they receive notifications\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card } from '@/components/ui/card';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Loader2, Bell, Mail, MessageSquare, Smartphone, Clock, Moon } from 'lucide-react';\r\nimport { pushNotificationService } from '@/services/pushNotificationService';\r\nimport { smsService } from '@/services/smsService';\r\n\r\nexport default function NotificationPreferences() {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [preferences, setPreferences] = useState({\r\n    in_app: true,\r\n    email: true,\r\n    sms: true,\r\n    push: true,\r\n    quiet_hours_enabled: false,\r\n    quiet_hours_start: '22:00',\r\n    quiet_hours_end: '08:00'\r\n  });\r\n\r\n  const [capabilities, setCapabilities] = useState({\r\n    push: false,\r\n    sms: false\r\n  });\r\n\r\n  useEffect(() => {\r\n    loadPreferences();\r\n    checkCapabilities();\r\n  }, []);\r\n\r\n  const loadPreferences = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const currentUser = await base44.auth.me();\r\n      setUser(currentUser);\r\n\r\n      // Load preferences from database\r\n      const prefs = await base44.entities.NotificationPreferences?.filter({\r\n        user_email: currentUser.email\r\n      }).catch(() => []);\r\n\r\n      if (prefs && prefs.length > 0) {\r\n        setPreferences(prefs[0]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load notification preferences:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const checkCapabilities = () => {\r\n    // Check if push notifications are supported\r\n    const pushSupported = pushNotificationService.isSupported();\r\n    const pushEnabled = pushNotificationService.isEnabled();\r\n\r\n    // Check if SMS is configured\r\n    const smsEnabled = smsService.isEnabled();\r\n\r\n    setCapabilities({\r\n      push: pushSupported,\r\n      sms: smsEnabled\r\n    });\r\n  };\r\n\r\n  const savePreferences = async () => {\r\n    try {\r\n      setSaving(true);\r\n\r\n      // Check if preferences exist\r\n      const existingPrefs = await base44.entities.NotificationPreferences?.filter({\r\n        user_email: user.email\r\n      }).catch(() => []);\r\n\r\n      if (existingPrefs && existingPrefs.length > 0) {\r\n        // Update existing\r\n        await base44.entities.NotificationPreferences.update(existingPrefs[0].id, preferences);\r\n      } else {\r\n        // Create new\r\n        await base44.entities.NotificationPreferences?.create({\r\n          user_email: user.email,\r\n          ...preferences\r\n        }).catch(() => {\r\n          console.log('NotificationPreferences entity not found, skipping');\r\n        });\r\n      }\r\n\r\n      // Show success message\r\n      alert('Notification preferences saved successfully!');\r\n    } catch (error) {\r\n      console.error('Failed to save preferences:', error);\r\n      alert('Failed to save preferences. Please try again.');\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const requestPushPermission = async () => {\r\n    const granted = await pushNotificationService.requestPermission();\r\n    \r\n    if (granted) {\r\n      setPreferences(prev => ({ ...prev, push: true }));\r\n      alert('Push notifications enabled!');\r\n    } else {\r\n      alert('Push notifications were denied. Please enable them in your browser settings.');\r\n    }\r\n\r\n    checkCapabilities();\r\n  };\r\n\r\n  const handleToggle = (key, value) => {\r\n    setPreferences(prev => ({ ...prev, [key]: value }));\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Card className=\"p-8 flex items-center justify-center\">\r\n        <Loader2 className=\"h-6 w-6 animate-spin text-system\" />\r\n        <span className=\"ml-2 text-gray-600\">Loading preferences...</span>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"p-6\">\r\n        <div className=\"flex items-center mb-6\">\r\n          <Bell className=\"h-6 w-6 text-system mr-3\" />\r\n          <div>\r\n            <h2 className=\"text-2xl font-heading font-bold text-graphite\">Notification Preferences</h2>\r\n            <p className=\"text-sm text-gray-600 font-body\">Choose how you want to be notified about job updates</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* In-App Notifications */}\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between py-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Bell className=\"h-5 w-5 text-system\" />\r\n              <div>\r\n                <Label className=\"text-base font-heading font-semibold\">In-App Notifications</Label>\r\n                <p className=\"text-sm text-gray-600 font-body\">Show notifications inside the PureTask app</p>\r\n              </div>\r\n            </div>\r\n            <Switch\r\n              checked={preferences.in_app}\r\n              onCheckedChange={(checked) => handleToggle('in_app', checked)}\r\n            />\r\n          </div>\r\n\r\n          {/* Email Notifications */}\r\n          <div className=\"flex items-center justify-between py-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Mail className=\"h-5 w-5 text-system\" />\r\n              <div>\r\n                <Label className=\"text-base font-heading font-semibold\">Email Notifications</Label>\r\n                <p className=\"text-sm text-gray-600 font-body\">Receive updates via email</p>\r\n              </div>\r\n            </div>\r\n            <Switch\r\n              checked={preferences.email}\r\n              onCheckedChange={(checked) => handleToggle('email', checked)}\r\n            />\r\n          </div>\r\n\r\n          {/* SMS Notifications */}\r\n          <div className=\"flex items-center justify-between py-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <MessageSquare className=\"h-5 w-5 text-system\" />\r\n              <div>\r\n                <Label className=\"text-base font-heading font-semibold\">SMS Notifications</Label>\r\n                <p className=\"text-sm text-gray-600 font-body\">\r\n                  Receive urgent updates via text message\r\n                  {!capabilities.sms && <span className=\"block text-xs text-amber-600 mt-1\">‚ö†Ô∏è SMS not configured yet</span>}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <Switch\r\n              checked={preferences.sms}\r\n              onCheckedChange={(checked) => handleToggle('sms', checked)}\r\n              disabled={!capabilities.sms}\r\n            />\r\n          </div>\r\n\r\n          {/* Push Notifications */}\r\n          <div className=\"flex items-center justify-between py-4 border-b\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Smartphone className=\"h-5 w-5 text-system\" />\r\n              <div>\r\n                <Label className=\"text-base font-heading font-semibold\">Push Notifications</Label>\r\n                <p className=\"text-sm text-gray-600 font-body\">\r\n                  Receive browser notifications (even when app is closed)\r\n                  {!capabilities.push && <span className=\"block text-xs text-amber-600 mt-1\">‚ö†Ô∏è Not supported in your browser</span>}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              {capabilities.push && !pushNotificationService.isEnabled() && (\r\n                <Button\r\n                  onClick={requestPushPermission}\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  className=\"mr-2\"\r\n                >\r\n                  Enable\r\n                </Button>\r\n              )}\r\n              <Switch\r\n                checked={preferences.push}\r\n                onCheckedChange={(checked) => handleToggle('push', checked)}\r\n                disabled={!capabilities.push || !pushNotificationService.isEnabled()}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quiet Hours */}\r\n          <div className=\"py-4\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <Moon className=\"h-5 w-5 text-system\" />\r\n                <div>\r\n                  <Label className=\"text-base font-heading font-semibold\">Quiet Hours</Label>\r\n                  <p className=\"text-sm text-gray-600 font-body\">Mute non-urgent notifications during specific hours</p>\r\n                </div>\r\n              </div>\r\n              <Switch\r\n                checked={preferences.quiet_hours_enabled}\r\n                onCheckedChange={(checked) => handleToggle('quiet_hours_enabled', checked)}\r\n              />\r\n            </div>\r\n\r\n            {preferences.quiet_hours_enabled && (\r\n              <div className=\"flex items-center space-x-4 ml-8 mt-3\">\r\n                <div>\r\n                  <Label className=\"text-sm font-body\">Start</Label>\r\n                  <input\r\n                    type=\"time\"\r\n                    value={preferences.quiet_hours_start}\r\n                    onChange={(e) => handleToggle('quiet_hours_start', e.target.value)}\r\n                    className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-system focus:border-system\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <Label className=\"text-sm font-body\">End</Label>\r\n                  <input\r\n                    type=\"time\"\r\n                    value={preferences.quiet_hours_end}\r\n                    onChange={(e) => handleToggle('quiet_hours_end', e.target.value)}\r\n                    className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-system focus:border-system\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Save Button */}\r\n        <div className=\"mt-6 flex justify-end\">\r\n          <Button\r\n            onClick={savePreferences}\r\n            disabled={saving}\r\n            className=\"bg-system hover:bg-system-dark text-white font-heading\"\r\n          >\r\n            {saving ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Saving...\r\n              </>\r\n            ) : (\r\n              'Save Preferences'\r\n            )}\r\n          </Button>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Notification Types Card */}\r\n      <Card className=\"p-6\">\r\n        <h3 className=\"text-lg font-heading font-bold text-graphite mb-4\">What you'll be notified about</h3>\r\n        <div className=\"space-y-2 text-sm font-body text-gray-700\">\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">üöó</span>\r\n            <span>When your cleaner is on the way</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">üìç</span>\r\n            <span>When your cleaner arrives</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">üßπ</span>\r\n            <span>When cleaning starts and completes</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">üì∏</span>\r\n            <span>When before/after photos are uploaded</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">‚è∞</span>\r\n            <span><strong>When extra time is requested</strong> (requires your approval)</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">üí≥</span>\r\n            <span>Payment confirmations</span>\r\n          </div>\r\n          <div className=\"flex items-start\">\r\n            <span className=\"mr-2\">‚≠ê</span>\r\n            <span>Reminders to review your cleaner</span>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* System Status Card */}\r\n      <Card className=\"p-6 bg-gray-50\">\r\n        <h3 className=\"text-sm font-heading font-bold text-gray-700 mb-3\">System Status</h3>\r\n        <div className=\"space-y-2 text-xs font-body text-gray-600\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>In-App Notifications:</span>\r\n            <span className=\"text-success font-semibold\">‚úÖ Active</span>\r\n          </div>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>Email Service:</span>\r\n            <span className=\"text-success font-semibold\">‚úÖ Active (Base44)</span>\r\n          </div>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>SMS Service:</span>\r\n            <span className={capabilities.sms ? 'text-success font-semibold' : 'text-amber-600'}>\r\n              {capabilities.sms ? '‚úÖ Active (Twilio)' : '‚ö†Ô∏è Not configured'}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>Push Notifications:</span>\r\n            <span className={capabilities.push ? 'text-success font-semibold' : 'text-amber-600'}>\r\n              {capabilities.push ? (pushNotificationService.isEnabled() ? '‚úÖ Enabled' : '‚ö†Ô∏è Not enabled') : '‚ùå Not supported'}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\status\\StatusFlowExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isFuture' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":120,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"isFuture"},"fix":{"range":[3544,3580],"text":""},"desc":"Remove unused variable 'isFuture'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'colorClasses' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":122,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"colorClasses"},"fix":{"range":[3600,4096],"text":""},"desc":"Remove unused variable 'colorClasses'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { GitBranch, ChevronDown, CheckCircle2, Clock, AlertCircle, Info } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function StatusFlowExplainer({ currentStatus }) {\n  const [expanded, setExpanded] = useState(false);\n\n  const statusFlow = [\n    { \n      status: 'created', \n      label: 'Created',\n      description: 'Booking created, payment processing',\n      icon: Clock,\n      color: 'gray'\n    },\n    { \n      status: 'payment_hold', \n      label: 'Payment Hold',\n      description: 'Credits held in escrow for protection',\n      icon: Clock,\n      color: 'yellow'\n    },\n    { \n      status: 'awaiting_cleaner_response', \n      label: 'Awaiting Response',\n      description: 'Waiting for cleaner to accept (24h)',\n      icon: Clock,\n      color: 'blue'\n    },\n    { \n      status: 'accepted', \n      label: 'Accepted',\n      description: 'Cleaner accepted, job confirmed',\n      icon: CheckCircle2,\n      color: 'green'\n    },\n    { \n      status: 'scheduled', \n      label: 'Scheduled',\n      description: 'Job scheduled, waiting for job day',\n      icon: Clock,\n      color: 'blue'\n    },\n    { \n      status: 'on_the_way', \n      label: 'On The Way',\n      description: 'Cleaner is traveling to location',\n      icon: Clock,\n      color: 'blue'\n    },\n    { \n      status: 'in_progress', \n      label: 'In Progress',\n      description: 'Cleaner checked in, cleaning started',\n      icon: Clock,\n      color: 'purple'\n    },\n    { \n      status: 'completed', \n      label: 'Completed',\n      description: 'Cleaner finished, awaiting your review',\n      icon: Clock,\n      color: 'orange'\n    },\n    { \n      status: 'awaiting_client', \n      label: 'Awaiting Review',\n      description: 'Review within 12h or auto-approves',\n      icon: AlertCircle,\n      color: 'orange'\n    },\n    { \n      status: 'approved', \n      label: 'Approved',\n      description: 'Job approved, payment settled',\n      icon: CheckCircle2,\n      color: 'green'\n    }\n  ];\n\n  const currentIndex = statusFlow.findIndex(s => s.status === currentStatus);\n\n  return (\n    <Card className=\"border-2 border-blue-200\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <GitBranch className=\"w-5 h-5 text-blue-600\" />\n            Booking Journey\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent>\n              <div className=\"relative\">\n                {statusFlow.map((step, idx) => {\n                  const Icon = step.icon;\n                  const isCurrent = step.status === currentStatus;\n                  const isPast = idx < currentIndex;\n                  const isFuture = idx > currentIndex;\n\n                  const colorClasses = {\n                    gray: 'bg-gray-100 text-gray-600 border-gray-300',\n                    blue: 'bg-blue-100 text-blue-600 border-blue-300',\n                    green: 'bg-green-100 text-green-600 border-green-300',\n                    yellow: 'bg-yellow-100 text-yellow-600 border-yellow-300',\n                    orange: 'bg-orange-100 text-orange-600 border-orange-300',\n                    purple: 'bg-purple-100 text-purple-600 border-purple-300'\n                  };\n\n                  return (\n                    <div key={step.status} className=\"relative\">\n                      {idx > 0 && (\n                        <div className={`absolute left-4 -top-3 w-0.5 h-6 ${\n                          isPast ? 'bg-green-400' : 'bg-gray-300'\n                        }`} />\n                      )}\n                      \n                      <div className={`flex items-start gap-3 mb-4 p-3 rounded-lg ${\n                        isCurrent \n                          ? 'bg-blue-50 border-2 border-blue-400 shadow-lg' \n                          : isPast\n                          ? 'bg-green-50 border border-green-200'\n                          : 'bg-gray-50 border border-gray-200 opacity-50'\n                      }`}>\n                        <div className={`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 border-2 ${\n                          isCurrent \n                            ? 'bg-blue-500 border-blue-600' \n                            : isPast\n                            ? 'bg-green-500 border-green-600'\n                            : 'bg-gray-300 border-gray-400'\n                        }`}>\n                          <Icon className=\"w-4 h-4 text-white\" />\n                        </div>\n                        \n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <h5 className=\"font-fredoka font-semibold text-gray-800\">{step.label}</h5>\n                            {isCurrent && (\n                              <Badge className=\"bg-blue-600 text-white font-fredoka text-xs\">Current</Badge>\n                            )}\n                            {isPast && (\n                              <Badge className=\"bg-green-600 text-white font-fredoka text-xs\">‚úì</Badge>\n                            )}\n                          </div>\n                          <p className=\"text-xs text-gray-600 font-verdana\">{step.description}</p>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n\n              <div className=\"mt-4 bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-xs text-blue-800 font-verdana\">\n                <Info className=\"w-4 h-4 inline mr-1\" />\n                <strong>Note:</strong> Some steps may be skipped based on booking type (instant book, recurring, etc.)\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\subscription\\SubscriptionExplainer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":2,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":26,"fix":{"range":[57,67],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[56,66],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":2,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":38,"fix":{"range":[67,79],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[66,78],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[223,270],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[223,269],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Repeat, Calendar, DollarSign, ChevronDown, AlertCircle, CheckCircle2 } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function SubscriptionExplainer() {\n  const [expanded, setExpanded] = useState(false);\n\n  return (\n    <Card className=\"border-2 border-purple-200 bg-purple-50\">\n      <CardHeader className=\"pb-3\">\n        <div \n          className=\"flex items-center justify-between cursor-pointer\"\n          onClick={() => setExpanded(!expanded)}\n        >\n          <CardTitle className=\"text-lg font-fredoka flex items-center gap-2\">\n            <Repeat className=\"w-5 h-5 text-purple-600\" />\n            How Subscriptions Work\n          </CardTitle>\n          <motion.div\n            animate={{ rotate: expanded ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"w-5 h-5 text-gray-500\" />\n          </motion.div>\n        </div>\n      </CardHeader>\n\n      <AnimatePresence>\n        {expanded && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"overflow-hidden\"\n          >\n            <CardContent className=\"space-y-4\">\n              {/* Benefits */}\n              <div className=\"bg-white rounded-xl p-4 border-2 border-purple-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3 flex items-center gap-2\">\n                  <CheckCircle2 className=\"w-5 h-5 text-purple-600\" />\n                  Subscription Benefits\n                </h4>\n                <div className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-600 font-bold\">‚úì</span>\n                    <p><strong>Priority Scheduling:</strong> Same day, same time, every week/month</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-600 font-bold\">‚úì</span>\n                    <p><strong>Same Cleaner:</strong> Build trust with your dedicated cleaner</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-600 font-bold\">‚úì</span>\n                    <p><strong>Auto-Booking:</strong> Jobs created automatically, no manual booking</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-600 font-bold\">‚úì</span>\n                    <p><strong>Flexible Pausing:</strong> Pause anytime for vacations or breaks</p>\n                  </div>\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-purple-600 font-bold\">‚úì</span>\n                    <p><strong>Easy Cancellation:</strong> Cancel with 24h notice, no penalty</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* How It Works */}\n              <div className=\"bg-green-50 rounded-xl p-4 border-2 border-green-300\">\n                <h4 className=\"font-fredoka font-bold text-gray-800 mb-3\">How It Works</h4>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-purple-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">1</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Choose Your Schedule</p>\n                      <p className=\"text-gray-600 font-verdana\">Weekly, bi-weekly, or monthly - your choice</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-purple-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">2</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Auto-Booking Created</p>\n                      <p className=\"text-gray-600 font-verdana\">New booking created automatically each cycle</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-purple-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">3</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Pay Per Job</p>\n                      <p className=\"text-gray-600 font-verdana\">Charged only when each cleaning happens</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"w-6 h-6 rounded-full bg-green-600 text-white flex items-center justify-center text-xs font-bold flex-shrink-0\">4</div>\n                    <div className=\"text-sm\">\n                      <p className=\"font-fredoka font-semibold text-gray-800\">Manage Anytime</p>\n                      <p className=\"text-gray-600 font-verdana\">Pause, reschedule, or cancel from dashboard</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Important Notes */}\n              <div className=\"bg-yellow-50 rounded-lg p-3 border-l-4 border-yellow-400\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-xs text-yellow-800 font-verdana space-y-1\">\n                    <p><strong>No Upfront Payment:</strong> You're only charged when each cleaning happens</p>\n                    <p><strong>Cancel Anytime:</strong> No long-term commitment or cancellation fees</p>\n                    <p><strong>Pause for Free:</strong> Going on vacation? Pause your subscription hassle-free</p>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\subscription\\SubscriptionManager.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Edit' is defined but never used.","line":6,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":40,"fix":{"range":[325,331],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Edit"},"fix":{"range":[324,330],"text":""},"desc":"Remove unused variable 'Edit'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":42,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":71,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":71,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, Pause, Play, X, Edit, DollarSign, Clock, MapPin, User } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n\nexport default function SubscriptionManager({ clientEmail }) {\n  const [subscriptions, setSubscriptions] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadSubscriptions();\n  }, [clientEmail]);\n\n  const loadSubscriptions = async () => {\n    try {\n      const subs = await base44.entities.CleaningSubscription.filter({ client_email: clientEmail });\n      setSubscriptions(subs);\n    } catch (error) {\n      console.error('Error loading subscriptions:', error);\n      console.error('Failed to load subscriptions');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const pauseSubscription = async (subId) => {\n    try {\n      const pauseDate = new Date();\n      pauseDate.setDate(pauseDate.getDate() + 30);\n      \n      await base44.entities.CleaningSubscription.update(subId, {\n        status: 'paused',\n        paused_until: pauseDate.toISOString().split('T')[0]\n      });\n      \n      alert('Subscription paused for 30 days');\n      loadSubscriptions();\n    } catch (error) {\n      alert('Failed to pause subscription');\n    }\n  };\n\n  const resumeSubscription = async (subId) => {\n    try {\n      await base44.entities.CleaningSubscription.update(subId, {\n        status: 'active',\n        paused_until: null\n      });\n      \n      alert('Subscription resumed');\n      loadSubscriptions();\n    } catch (error) {\n      alert('Failed to resume subscription');\n    }\n  };\n\n  const cancelSubscription = async (subId) => {\n    if (!confirm('Are you sure you want to cancel this subscription?')) return;\n    \n    try {\n      await base44.entities.CleaningSubscription.update(subId, {\n        status: 'cancelled'\n      });\n      \n      alert('Subscription cancelled');\n      loadSubscriptions();\n    } catch (error) {\n      alert('Failed to cancel subscription');\n    }\n  };\n\n  const frequencyLabels = {\n    weekly: 'Weekly',\n    biweekly: 'Every 2 Weeks',\n    monthly: 'Monthly'\n  };\n\n  const statusColors = {\n    active: 'bg-green-100 text-green-800',\n    paused: 'bg-yellow-100 text-yellow-800',\n    cancelled: 'bg-gray-100 text-gray-600',\n    past_due: 'bg-red-100 text-red-800'\n  };\n\n  if (loading) {\n    return <div className=\"text-center py-8\">Loading subscriptions...</div>;\n  }\n\n  if (subscriptions.length === 0) {\n    return (\n      <Card>\n        <CardContent className=\"py-8 text-center\">\n          <Calendar className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\n          <p className=\"text-gray-600 font-verdana\">No active subscriptions</p>\n          <p className=\"text-sm text-gray-500 mt-2\">Create a subscription to get regular cleanings with discounts!</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {subscriptions.map((sub) => (\n        <motion.div\n          key={sub.id}\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.3 }}\n        >\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-start justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n                    {frequencyLabels[sub.frequency]} Cleaning\n                  </CardTitle>\n                  <CardDescription className=\"mt-2\">\n                    Every {sub.day_of_week} at {sub.preferred_time}\n                  </CardDescription>\n                </div>\n                <Badge className={statusColors[sub.status]}>\n                  {sub.status}\n                </Badge>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <User className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"text-gray-700\">{sub.cleaner_email}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <Clock className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"text-gray-700\">{sub.hours} hours</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <MapPin className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"text-gray-700 truncate\">{sub.address}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <DollarSign className=\"w-4 h-4 text-gray-500\" />\n                  <span className=\"text-gray-700\">${(sub.monthly_price / 10).toFixed(2)}/month</span>\n                </div>\n              </div>\n\n              {sub.discount_percentage > 0 && (\n                <div className=\"bg-green-50 border border-green-200 rounded-lg p-3\">\n                  <p className=\"text-sm text-green-800 font-fredoka font-semibold\">\n                    üí∞ Saving {sub.discount_percentage}% with subscription\n                  </p>\n                </div>\n              )}\n\n              {sub.next_booking_date && (\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n                  <p className=\"text-sm text-blue-800 font-verdana\">\n                    <strong>Next cleaning:</strong> {new Date(sub.next_booking_date).toLocaleDateString()}\n                  </p>\n                </div>\n              )}\n\n              {sub.paused_until && (\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n                  <p className=\"text-sm text-yellow-800 font-verdana\">\n                    <strong>Paused until:</strong> {new Date(sub.paused_until).toLocaleDateString()}\n                  </p>\n                </div>\n              )}\n\n              <div className=\"flex gap-2 pt-2\">\n                {sub.status === 'active' && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => pauseSubscription(sub.id)}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <Pause className=\"w-4 h-4\" />\n                    Pause\n                  </Button>\n                )}\n                \n                {sub.status === 'paused' && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => resumeSubscription(sub.id)}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <Play className=\"w-4 h-4\" />\n                    Resume\n                  </Button>\n                )}\n\n                {(sub.status === 'active' || sub.status === 'paused') && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => cancelSubscription(sub.id)}\n                    className=\"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50\"\n                  >\n                    <X className=\"w-4 h-4\" />\n                    Cancel\n                  </Button>\n                )}\n              </div>\n\n              <div className=\"text-xs text-gray-500 pt-2 border-t\">\n                <p>Started: {new Date(sub.started_date).toLocaleDateString()}</p>\n                <p>Total cleanings completed: {sub.total_cleanings_completed}</p>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      ))}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\subscription\\SubscriptionOfferCard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":15,"fix":{"range":[171,218],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[171,217],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":5,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":31,"fix":{"range":[239,249],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[238,248],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":5,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":43,"fix":{"range":[249,261],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[248,260],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'motion' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"fix":{"range":[534,575],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[534,573],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle, Calendar, DollarSign, Sparkles } from 'lucide-react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { base44 } from '@/api/base44Client';\nimport { motion } from 'framer-motion';\n\nexport default function SubscriptionOfferCard({ booking, cleaner, onSubscribe }) {\n  const [showDialog, setShowDialog] = useState(false);\n  const [frequency, setFrequency] = useState('biweekly');\n  const [loading, setLoading] = useState(false);\n\n  const calculateSavings = (freq) => {\n    const singleBookingPrice = booking.total_price;\n    let bookingsPerMonth = 0;\n    \n    switch(freq) {\n      case 'weekly': bookingsPerMonth = 4.33; break;\n      case 'biweekly': bookingsPerMonth = 2.17; break;\n      case 'monthly': bookingsPerMonth = 1; break;\n    }\n    \n    const regularCost = singleBookingPrice * bookingsPerMonth;\n    const subscriptionCost = regularCost * 0.8; // 20% discount\n    const savings = regularCost - subscriptionCost;\n    \n    return {\n      regularCost: regularCost.toFixed(2),\n      subscriptionCost: subscriptionCost.toFixed(2),\n      savings: savings.toFixed(2),\n      savingsPercent: 20\n    };\n  };\n\n  const handleCreateSubscription = async () => {\n    setLoading(true);\n    try {\n      const pricing = calculateSavings(frequency);\n      \n      await base44.entities.CleaningSubscription.create({\n        client_email: booking.client_email,\n        cleaner_email: booking.cleaner_email,\n        frequency,\n        day_of_week: new Date(booking.date).toLocaleDateString('en-US', { weekday: 'long' }),\n        preferred_time: booking.start_time,\n        hours: booking.hours,\n        tasks: booking.tasks,\n        task_quantities: booking.task_quantities,\n        address: booking.address,\n        latitude: booking.latitude,\n        longitude: booking.longitude,\n        monthly_price: parseFloat(pricing.subscriptionCost),\n        discount_percentage: 20,\n        status: 'active',\n        next_booking_date: calculateNextDate(frequency, booking.date)\n      });\n\n      if (onSubscribe) {\n        onSubscribe();\n      }\n      \n      setShowDialog(false);\n      alert('Subscription created! Your first scheduled cleaning will be auto-booked.');\n    } catch (error) {\n      console.error('Error creating subscription:', error);\n      alert('Failed to create subscription. Please try again.');\n    }\n    setLoading(false);\n  };\n\n  const calculateNextDate = (freq, startDate) => {\n    const date = new Date(startDate);\n    switch(freq) {\n      case 'weekly': date.setDate(date.getDate() + 7); break;\n      case 'biweekly': date.setDate(date.getDate() + 14); break;\n      case 'monthly': date.setMonth(date.getMonth() + 1); break;\n    }\n    return date.toISOString().split('T')[0];\n  };\n\n  const pricing = calculateSavings(frequency);\n\n  return (\n    <>\n      <Card className=\"border-2 border-purple-300 bg-gradient-to-br from-purple-50 to-pink-50\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Sparkles className=\"w-6 h-6 text-purple-600\" />\n            Love {cleaner.full_name}'s Work?\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-start gap-3\">\n            <CheckCircle className=\"w-5 h-5 text-purple-600 mt-1 flex-shrink-0\" />\n            <div>\n              <p className=\"font-semibold text-slate-900\">Subscribe & Save 20%</p>\n              <p className=\"text-sm text-slate-600\">Lock in your schedule and save on every cleaning</p>\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg p-4 border border-purple-200\">\n            <div className=\"flex justify-between mb-2\">\n              <span className=\"text-slate-600\">Regular price:</span>\n              <span className=\"line-through text-slate-400\">${booking.total_price}/cleaning</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span className=\"font-semibold text-slate-900\">Subscription price:</span>\n              <span className=\"text-2xl font-bold text-purple-600\">${(booking.total_price * 0.8).toFixed(2)}/cleaning</span>\n            </div>\n          </div>\n\n          <Button\n            onClick={() => setShowDialog(true)}\n            className=\"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600\"\n            size=\"lg\"\n          >\n            Set Up Subscription\n          </Button>\n        </CardContent>\n      </Card>\n\n      <Dialog open={showDialog} onOpenChange={setShowDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Create Cleaning Subscription</DialogTitle>\n          </DialogHeader>\n\n          <div className=\"space-y-6 py-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">How often?</label>\n              <Select value={frequency} onValueChange={setFrequency}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"weekly\">Weekly</SelectItem>\n                  <SelectItem value=\"biweekly\">Every 2 Weeks</SelectItem>\n                  <SelectItem value=\"monthly\">Monthly</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"bg-purple-50 rounded-lg p-4 border border-purple-200\">\n              <p className=\"text-sm font-semibold text-purple-900 mb-3\">Your Subscription:</p>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-slate-600\">Frequency:</span>\n                  <span className=\"font-medium\">{frequency === 'biweekly' ? 'Every 2 weeks' : frequency}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-slate-600\">Per cleaning:</span>\n                  <span className=\"font-medium\">${(booking.total_price * 0.8).toFixed(2)}</span>\n                </div>\n                <div className=\"flex justify-between border-t border-purple-200 pt-2\">\n                  <span className=\"text-slate-900 font-semibold\">Monthly cost:</span>\n                  <span className=\"font-bold text-purple-600\">${pricing.subscriptionCost}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-emerald-600 font-medium\">Monthly savings:</span>\n                  <span className=\"font-bold text-emerald-600\">${pricing.savings}</span>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-purple-600\" />\n                <span className=\"text-sm\">Same cleaner every time</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-purple-600\" />\n                <span className=\"text-sm\">Priority scheduling</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-purple-600\" />\n                <span className=\"text-sm\">Pause or cancel anytime</span>\n              </div>\n            </div>\n\n            <div className=\"flex gap-3\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDialog(false)}\n                className=\"flex-1\"\n                disabled={loading}\n              >\n                Maybe Later\n              </Button>\n              <Button\n                onClick={handleCreateSubscription}\n                disabled={loading}\n                className=\"flex-1 bg-gradient-to-r from-purple-500 to-pink-500\"\n              >\n                {loading ? 'Creating...' : 'Subscribe Now'}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\subscription\\SubscriptionPlans.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\subscription\\SubscriptionService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\BookingConfirmedEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\CleanerOnTheWayEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\CleaningCompletedEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\InvoiceReceiptEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\PaymentFailedEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\TemplateSeeder.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\templates\\WelcomeEmail.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\terms\\TermsOfService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\tier\\TierProgressExplainer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\tips\\TipIntegration.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'React' is defined but never used.","line":1,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":13,"fix":{"range":[0,27],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[7,18],"text":""},"desc":"Remove unused variable 'React'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { base44 } from '@/api/base44Client';\n\n/**\n * Process a tip after review submission\n */\nexport async function processTipAfterReview(bookingId, tipData) {\n  try {\n    const booking = await base44.entities.Booking.get(bookingId);\n    \n    if (!booking) {\n      throw new Error('Booking not found');\n    }\n\n    // Create tip record\n    const tip = await base44.entities.Tip.create({\n      booking_id: bookingId,\n      client_email: booking.client_email,\n      cleaner_email: booking.cleaner_email,\n      amount: tipData.amount,\n      percentage: tipData.percentage || null,\n      status: 'pending'\n    });\n\n    // TODO: Process payment for tip via Stripe\n    // For now, mark as paid immediately\n    await base44.entities.Tip.update(tip.id, {\n      status: 'paid'\n    });\n\n    // Send notification to cleaner\n    await base44.integrations.Core.SendEmail({\n      to: booking.cleaner_email,\n      subject: 'üéâ You received a tip!',\n      body: `Great news! Your client tipped you $${tipData.amount} for the cleaning at ${booking.address}.\n\nThis will be included in your next payout.\n\nKeep up the excellent work!\n\n- The PureTask Team`\n    });\n\n    return tip;\n  } catch (error) {\n    console.error('Error processing tip:', error);\n    throw error;\n  }\n}\n\n/**\n * Calculate total tips for a cleaner\n */\nexport async function calculateCleanerTips(cleanerEmail, startDate, endDate) {\n  const tips = await base44.entities.Tip.filter({\n    cleaner_email: cleanerEmail,\n    status: 'paid'\n  });\n\n  let total = 0;\n  let count = 0;\n\n  for (const tip of tips) {\n    const tipDate = new Date(tip.created_date);\n    if (tipDate >= new Date(startDate) && tipDate <= new Date(endDate)) {\n      total += tip.amount;\n      count++;\n    }\n  }\n\n  return {\n    total,\n    count,\n    average: count > 0 ? total / count : 0\n  };\n}\n\n/**\n * Get tip statistics for display on cleaner dashboard\n */\nexport async function getCleanerTipStats(cleanerEmail) {\n  const tips = await base44.entities.Tip.filter({\n    cleaner_email: cleanerEmail,\n    status: 'paid'\n  });\n\n  const now = new Date();\n  const thisMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n  const lastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n\n  let thisMonthTotal = 0;\n  let lastMonthTotal = 0;\n  let allTimeTotal = 0;\n\n  for (const tip of tips) {\n    const tipDate = new Date(tip.created_date);\n    allTimeTotal += tip.amount;\n\n    if (tipDate >= thisMonth) {\n      thisMonthTotal += tip.amount;\n    } else if (tipDate >= lastMonth && tipDate < thisMonth) {\n      lastMonthTotal += tip.amount;\n    }\n  }\n\n  return {\n    thisMonth: thisMonthTotal,\n    lastMonth: lastMonthTotal,\n    allTime: allTimeTotal,\n    totalTips: tips.length,\n    averageTip: tips.length > 0 ? allTimeTotal / tips.length : 0\n  };\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\tips\\TipPrompt.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\tips\\TipSelector.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\AnimatedButton.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Button } from '@/components/ui/button';\n\nexport const AnimatedButton = React.forwardRef(({ children, className, ...props }, ref) => {\n  return (\n    <motion.div\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n      transition={{ type: \"spring\", stiffness: 400, damping: 10 }}\n      className=\"inline-block\"\n    >\n      <Button ref={ref} className={className} {...props}>\n        {children}\n      </Button>\n    </motion.div>\n  );\n});\n\nAnimatedButton.displayName = 'AnimatedButton';","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\AnimatedInput.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Input } from '@/components/ui/input';\n\nexport function AnimatedInput({ error, ...props }) {\n  return (\n    <motion.div\n      key={error ? \"error-shake\" : \"no-error\"}\n      animate={error ? { x: [0, -5, 5, -5, 5, 0] } : {}}\n      transition={{ type: \"spring\", stiffness: 1000, damping: 10 }}\n    >\n      <Input {...props} className={error ? \"border-red-500\" : props.className} />\n    </motion.div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\accordion (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item ref={ref} className={cn(\"border-b\", className)} {...props} />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}>\n      {children}\n      <ChevronDown\n        className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}>\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\accordion.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item ref={ref} className={cn(\"border-b\", className)} {...props} />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}>\n      {children}\n      <ChevronDown\n        className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}>\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\alert (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":22,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-2xl border px-4 py-3 text-sm [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-graphite\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-white text-graphite border-gray-200\",\n        destructive:\n          \"border-red-200 bg-red-50 text-red-900 [&>svg]:text-red-600\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-fredoka font-bold leading-none tracking-tight text-graphite\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm font-verdana [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\alert-dialog (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref} />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props} />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)}\n    {...props} />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)}\n    {...props} />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title ref={ref} className={cn(\"text-lg font-semibold\", className)} {...props} />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(buttonVariants({ variant: \"outline\" }), \"mt-2 sm:mt-0\", className)}\n    {...props} />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\alert-dialog.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref} />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props} />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)}\n    {...props} />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)}\n    {...props} />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title ref={ref} className={cn(\"text-lg font-semibold\", className)} {...props} />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(buttonVariants({ variant: \"outline\" }), \"mt-2 sm:mt-0\", className)}\n    {...props} />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\alert.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":22,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-2xl border px-4 py-3 text-sm [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-graphite\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-white text-graphite border-gray-200\",\n        destructive:\n          \"border-red-200 bg-red-50 text-red-900 [&>svg]:text-red-600\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-fredoka font-bold leading-none tracking-tight text-graphite\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm font-verdana [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\aspect-ratio (2).jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\aspect-ratio.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\avatar (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\", className)}\n    {...props} />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props} />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props} />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\avatar.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\", className)}\n    {...props} />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props} />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props} />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\badge (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":31,"column":11}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  ...props\n}) {\n  return (<div className={cn(badgeVariants({ variant }), className)} {...props} />);\n}\n\nexport { Badge, badgeVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\badge.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":53,"column":11}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-heading font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n        // PureTask Design System Semantic Variants\n        success:\n          \"border-transparent bg-success text-white shadow hover:bg-success/90\",\n        system:\n          \"border-transparent bg-system text-white shadow hover:bg-system/90\",\n        warning:\n          \"border-transparent bg-warning text-white shadow hover:bg-warning/90\",\n        error:\n          \"border-transparent bg-error text-white shadow hover:bg-error/90\",\n        info:\n          \"border-transparent bg-info text-white shadow hover:bg-info/90\",\n        // Soft variants (light backgrounds)\n        successSoft:\n          \"border-success-border bg-success-soft text-success-text hover:bg-success-soft/80\",\n        systemSoft:\n          \"border-system-border bg-system-soft text-system-text hover:bg-system-soft/80\",\n        warningSoft:\n          \"border-warning-border bg-warning-soft text-warning-text hover:bg-warning-soft/80\",\n        errorSoft:\n          \"border-error-border bg-error-soft text-error-text hover:bg-error-soft/80\",\n        infoSoft:\n          \"border-info-border bg-info-soft text-info-text hover:bg-info-soft/80\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  ...props\n}) {\n  return (<div className={cn(badgeVariants({ variant }), className)} {...props} />);\n}\n\nexport { Badge, badgeVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\breadcrumb (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef(\n  ({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />\n)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props} />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props} />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    (<Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props} />)\n  );\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props} />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}>\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}>\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\breadcrumb.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef(\n  ({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />\n)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props} />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props} />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    (<Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props} />)\n  );\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props} />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}>\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}>\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\button (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":40,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2\",\n        sm: \"h-8 rounded-md px-3 text-xs\",\n        lg: \"h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n  return (\n    (<Comp\n      className={cn(buttonVariants({ variant, size, className }))}\n      ref={ref}\n      {...props} />)\n  );\n})\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\button.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":40,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2\",\n        sm: \"h-8 rounded-md px-3 text-xs\",\n        lg: \"h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n  return (\n    (<Comp\n      className={cn(buttonVariants({ variant, size, className }))}\n      ref={ref}\n      {...props} />)\n  );\n})\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\calendar (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":15,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}) {\n  return (\n    (<DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: cn(\n          \"relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md\",\n          props.mode === \"range\"\n            ? \"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md\"\n            : \"[&:has([aria-selected])]:rounded-md\"\n        ),\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-8 w-8 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_start: \"day-range-start\",\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props} />)\n  );\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\calendar.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":15,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}) {\n  return (\n    (<DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: cn(\n          \"relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md\",\n          props.mode === \"range\"\n            ? \"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md\"\n            : \"[&:has([aria-selected])]:rounded-md\"\n        ),\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-8 w-8 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_start: \"day-range-start\",\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props} />)\n  );\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\card (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"rounded-xl border bg-card text-card-foreground shadow\", className)}\n    {...props} />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props} />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props} />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\card.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"rounded-xl border bg-card text-card-foreground shadow\", className)}\n    {...props} />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props} />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props} />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\carousel (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":89,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport useEmblaCarousel from \"embla-carousel-react\";\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\nconst CarouselContext = React.createContext(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef((\n  {\n    orientation = \"horizontal\",\n    opts,\n    setApi,\n    plugins,\n    className,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const [carouselRef, api] = useEmblaCarousel({\n    ...opts,\n    axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n  }, plugins)\n  const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n  const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n  const onSelect = React.useCallback((api) => {\n    if (!api) {\n      return\n    }\n\n    setCanScrollPrev(api.canScrollPrev())\n    setCanScrollNext(api.canScrollNext())\n  }, [])\n\n  const scrollPrev = React.useCallback(() => {\n    api?.scrollPrev()\n  }, [api])\n\n  const scrollNext = React.useCallback(() => {\n    api?.scrollNext()\n  }, [api])\n\n  const handleKeyDown = React.useCallback((event) => {\n    if (event.key === \"ArrowLeft\") {\n      event.preventDefault()\n      scrollPrev()\n    } else if (event.key === \"ArrowRight\") {\n      event.preventDefault()\n      scrollNext()\n    }\n  }, [scrollPrev, scrollNext])\n\n  React.useEffect(() => {\n    if (!api || !setApi) {\n      return\n    }\n\n    setApi(api)\n  }, [api, setApi])\n\n  React.useEffect(() => {\n    if (!api) {\n      return\n    }\n\n    onSelect(api)\n    api.on(\"reInit\", onSelect)\n    api.on(\"select\", onSelect)\n\n    return () => {\n      api?.off(\"select\", onSelect)\n    };\n  }, [api, onSelect])\n\n  return (\n    (<CarouselContext.Provider\n      value={{\n        carouselRef,\n        api: api,\n        opts,\n        orientation:\n          orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n        scrollPrev,\n        scrollNext,\n        canScrollPrev,\n        canScrollNext,\n      }}>\n      <div\n        ref={ref}\n        onKeyDownCapture={handleKeyDown}\n        className={cn(\"relative\", className)}\n        role=\"region\"\n        aria-roledescription=\"carousel\"\n        {...props}>\n        {children}\n      </div>\n    </CarouselContext.Provider>)\n  );\n})\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    (<div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props} />\n    </div>)\n  );\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    (<div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props} />)\n  );\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    (<Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\"absolute  h-8 w-8 rounded-full\", orientation === \"horizontal\"\n        ? \"-left-12 top-1/2 -translate-y-1/2\"\n        : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\", className)}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}>\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>)\n  );\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    (<Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\"absolute h-8 w-8 rounded-full\", orientation === \"horizontal\"\n        ? \"-right-12 top-1/2 -translate-y-1/2\"\n        : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\", className)}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}>\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>)\n  );\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport { Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\carousel.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":89,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport useEmblaCarousel from \"embla-carousel-react\";\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\nconst CarouselContext = React.createContext(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef((\n  {\n    orientation = \"horizontal\",\n    opts,\n    setApi,\n    plugins,\n    className,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const [carouselRef, api] = useEmblaCarousel({\n    ...opts,\n    axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n  }, plugins)\n  const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n  const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n  const onSelect = React.useCallback((api) => {\n    if (!api) {\n      return\n    }\n\n    setCanScrollPrev(api.canScrollPrev())\n    setCanScrollNext(api.canScrollNext())\n  }, [])\n\n  const scrollPrev = React.useCallback(() => {\n    api?.scrollPrev()\n  }, [api])\n\n  const scrollNext = React.useCallback(() => {\n    api?.scrollNext()\n  }, [api])\n\n  const handleKeyDown = React.useCallback((event) => {\n    if (event.key === \"ArrowLeft\") {\n      event.preventDefault()\n      scrollPrev()\n    } else if (event.key === \"ArrowRight\") {\n      event.preventDefault()\n      scrollNext()\n    }\n  }, [scrollPrev, scrollNext])\n\n  React.useEffect(() => {\n    if (!api || !setApi) {\n      return\n    }\n\n    setApi(api)\n  }, [api, setApi])\n\n  React.useEffect(() => {\n    if (!api) {\n      return\n    }\n\n    onSelect(api)\n    api.on(\"reInit\", onSelect)\n    api.on(\"select\", onSelect)\n\n    return () => {\n      api?.off(\"select\", onSelect)\n    };\n  }, [api, onSelect])\n\n  return (\n    (<CarouselContext.Provider\n      value={{\n        carouselRef,\n        api: api,\n        opts,\n        orientation:\n          orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n        scrollPrev,\n        scrollNext,\n        canScrollPrev,\n        canScrollNext,\n      }}>\n      <div\n        ref={ref}\n        onKeyDownCapture={handleKeyDown}\n        className={cn(\"relative\", className)}\n        role=\"region\"\n        aria-roledescription=\"carousel\"\n        {...props}>\n        {children}\n      </div>\n    </CarouselContext.Provider>)\n  );\n})\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    (<div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props} />\n    </div>)\n  );\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    (<div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props} />)\n  );\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    (<Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\"absolute  h-8 w-8 rounded-full\", orientation === \"horizontal\"\n        ? \"-left-12 top-1/2 -translate-y-1/2\"\n        : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\", className)}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}>\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>)\n  );\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    (<Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\"absolute h-8 w-8 rounded-full\", orientation === \"horizontal\"\n        ? \"-right-12 top-1/2 -translate-y-1/2\"\n        : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\", className)}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}>\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>)\n  );\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport { Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\chart (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":30,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = {\n  light: \"\",\n  dark: \".dark\"\n}\n\nconst ChartContext = React.createContext(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    (<ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}>\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>)\n  );\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({\n  id,\n  config\n}) => {\n  const colorConfig = Object.entries(config).filter(([, config]) => config.theme || config.color)\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    (<style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n.map(([key, itemConfig]) => {\nconst color =\n  itemConfig.theme?.[theme] ||\n  itemConfig.color\nreturn color ? `  --color-${key}: ${color};` : null\n})\n.join(\"\\n\")}\n}\n`)\n          .join(\"\\n\"),\n      }} />)\n  );\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef((\n  {\n    active,\n    payload,\n    className,\n    indicator = \"dot\",\n    hideLabel = false,\n    hideIndicator = false,\n    label,\n    labelFormatter,\n    labelClassName,\n    formatter,\n    color,\n    nameKey,\n    labelKey,\n  },\n  ref\n) => {\n  const { config } = useChart()\n\n  const tooltipLabel = React.useMemo(() => {\n    if (hideLabel || !payload?.length) {\n      return null\n    }\n\n    const [item] = payload\n    const key = `${labelKey || item.dataKey || item.name || \"value\"}`\n    const itemConfig = getPayloadConfigFromPayload(config, item, key)\n    const value =\n      !labelKey && typeof label === \"string\"\n        ? config[label]?.label || label\n        : itemConfig?.label\n\n    if (labelFormatter) {\n      return (\n        (<div className={cn(\"font-medium\", labelClassName)}>\n          {labelFormatter(value, payload)}\n        </div>)\n      );\n    }\n\n    if (!value) {\n      return null\n    }\n\n    return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>;\n  }, [\n    label,\n    labelFormatter,\n    payload,\n    hideLabel,\n    labelClassName,\n    config,\n    labelKey,\n  ])\n\n  if (!active || !payload?.length) {\n    return null\n  }\n\n  const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n        className\n      )}>\n      {!nestLabel ? tooltipLabel : null}\n      <div className=\"grid gap-1.5\">\n        {payload.map((item, index) => {\n          const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n          const indicatorColor = color || item.payload.fill || item.color\n\n          return (\n            (<div\n              key={item.dataKey}\n              className={cn(\n                \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                indicator === \"dot\" && \"items-center\"\n              )}>\n              {formatter && item?.value !== undefined && item.name ? (\n                formatter(item.value, item.name, item, index, item.payload)\n              ) : (\n                <>\n                  {itemConfig?.icon ? (\n                    <itemConfig.icon />\n                  ) : (\n                    !hideIndicator && (\n                      <div\n                        className={cn(\"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\", {\n                          \"h-2.5 w-2.5\": indicator === \"dot\",\n                          \"w-1\": indicator === \"line\",\n                          \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                            indicator === \"dashed\",\n                          \"my-0.5\": nestLabel && indicator === \"dashed\",\n                        })}\n                        style={\n                          {\n                            \"--color-bg\": indicatorColor,\n                            \"--color-border\": indicatorColor\n                          }\n                        } />\n                    )\n                  )}\n                  <div\n                    className={cn(\n                      \"flex flex-1 justify-between leading-none\",\n                      nestLabel ? \"items-end\" : \"items-center\"\n                    )}>\n                    <div className=\"grid gap-1.5\">\n                      {nestLabel ? tooltipLabel : null}\n                      <span className=\"text-muted-foreground\">\n                        {itemConfig?.label || item.name}\n                      </span>\n                    </div>\n                    {item.value && (\n                      <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                        {item.value.toLocaleString()}\n                      </span>\n                    )}\n                  </div>\n                </>\n              )}\n            </div>)\n          );\n        })}\n      </div>\n    </div>)\n  );\n})\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef((\n  { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n  ref\n) => {\n  const { config } = useChart()\n\n  if (!payload?.length) {\n    return null\n  }\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"flex items-center justify-center gap-4\",\n        verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n        className\n      )}>\n      {payload.map((item) => {\n        const key = `${nameKey || item.dataKey || \"value\"}`\n        const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n        return (\n          (<div\n            key={item.value}\n            className={cn(\n              \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n            )}>\n            {itemConfig?.icon && !hideIcon ? (\n              <itemConfig.icon />\n            ) : (\n              <div\n                className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                style={{\n                  backgroundColor: item.color,\n                }} />\n            )}\n            {itemConfig?.label}\n          </div>)\n        );\n      })}\n    </div>)\n  );\n})\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config,\n  payload,\n  key\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey = key\n\n  if (\n    key in payload &&\n    typeof payload[key] === \"string\"\n  ) {\n    configLabelKey = payload[key]\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[key]\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key];\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\chart.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":30,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = {\n  light: \"\",\n  dark: \".dark\"\n}\n\nconst ChartContext = React.createContext(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    (<ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}>\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>)\n  );\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({\n  id,\n  config\n}) => {\n  const colorConfig = Object.entries(config).filter(([, config]) => config.theme || config.color)\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    (<style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n.map(([key, itemConfig]) => {\nconst color =\n  itemConfig.theme?.[theme] ||\n  itemConfig.color\nreturn color ? `  --color-${key}: ${color};` : null\n})\n.join(\"\\n\")}\n}\n`)\n          .join(\"\\n\"),\n      }} />)\n  );\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef((\n  {\n    active,\n    payload,\n    className,\n    indicator = \"dot\",\n    hideLabel = false,\n    hideIndicator = false,\n    label,\n    labelFormatter,\n    labelClassName,\n    formatter,\n    color,\n    nameKey,\n    labelKey,\n  },\n  ref\n) => {\n  const { config } = useChart()\n\n  const tooltipLabel = React.useMemo(() => {\n    if (hideLabel || !payload?.length) {\n      return null\n    }\n\n    const [item] = payload\n    const key = `${labelKey || item.dataKey || item.name || \"value\"}`\n    const itemConfig = getPayloadConfigFromPayload(config, item, key)\n    const value =\n      !labelKey && typeof label === \"string\"\n        ? config[label]?.label || label\n        : itemConfig?.label\n\n    if (labelFormatter) {\n      return (\n        (<div className={cn(\"font-medium\", labelClassName)}>\n          {labelFormatter(value, payload)}\n        </div>)\n      );\n    }\n\n    if (!value) {\n      return null\n    }\n\n    return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>;\n  }, [\n    label,\n    labelFormatter,\n    payload,\n    hideLabel,\n    labelClassName,\n    config,\n    labelKey,\n  ])\n\n  if (!active || !payload?.length) {\n    return null\n  }\n\n  const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n        className\n      )}>\n      {!nestLabel ? tooltipLabel : null}\n      <div className=\"grid gap-1.5\">\n        {payload.map((item, index) => {\n          const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n          const indicatorColor = color || item.payload.fill || item.color\n\n          return (\n            (<div\n              key={item.dataKey}\n              className={cn(\n                \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                indicator === \"dot\" && \"items-center\"\n              )}>\n              {formatter && item?.value !== undefined && item.name ? (\n                formatter(item.value, item.name, item, index, item.payload)\n              ) : (\n                <>\n                  {itemConfig?.icon ? (\n                    <itemConfig.icon />\n                  ) : (\n                    !hideIndicator && (\n                      <div\n                        className={cn(\"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\", {\n                          \"h-2.5 w-2.5\": indicator === \"dot\",\n                          \"w-1\": indicator === \"line\",\n                          \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                            indicator === \"dashed\",\n                          \"my-0.5\": nestLabel && indicator === \"dashed\",\n                        })}\n                        style={\n                          {\n                            \"--color-bg\": indicatorColor,\n                            \"--color-border\": indicatorColor\n                          }\n                        } />\n                    )\n                  )}\n                  <div\n                    className={cn(\n                      \"flex flex-1 justify-between leading-none\",\n                      nestLabel ? \"items-end\" : \"items-center\"\n                    )}>\n                    <div className=\"grid gap-1.5\">\n                      {nestLabel ? tooltipLabel : null}\n                      <span className=\"text-muted-foreground\">\n                        {itemConfig?.label || item.name}\n                      </span>\n                    </div>\n                    {item.value && (\n                      <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                        {item.value.toLocaleString()}\n                      </span>\n                    )}\n                  </div>\n                </>\n              )}\n            </div>)\n          );\n        })}\n      </div>\n    </div>)\n  );\n})\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef((\n  { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n  ref\n) => {\n  const { config } = useChart()\n\n  if (!payload?.length) {\n    return null\n  }\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"flex items-center justify-center gap-4\",\n        verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n        className\n      )}>\n      {payload.map((item) => {\n        const key = `${nameKey || item.dataKey || \"value\"}`\n        const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n        return (\n          (<div\n            key={item.value}\n            className={cn(\n              \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n            )}>\n            {itemConfig?.icon && !hideIcon ? (\n              <itemConfig.icon />\n            ) : (\n              <div\n                className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                style={{\n                  backgroundColor: item.color,\n                }} />\n            )}\n            {itemConfig?.label}\n          </div>)\n        );\n      })}\n    </div>)\n  );\n})\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config,\n  payload,\n  key\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey = key\n\n  if (\n    key in payload &&\n    typeof payload[key] === \"string\"\n  ) {\n    configLabelKey = payload[key]\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[key]\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key];\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\checkbox (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-5 w-5 shrink-0 rounded border-2 border-gray-300 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-puretask-blue data-[state=checked]:border-puretask-blue data-[state=checked]:text-white\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\checkbox.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-5 w-5 shrink-0 rounded border-2 border-gray-300 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-puretask-blue data-[state=checked]:border-puretask-blue data-[state=checked]:text-white\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\collapsible (2).jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\collapsible.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\command (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props} />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({\n  children,\n  ...props\n}) => {\n  return (\n    (<Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command\n          className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>)\n  );\n}\n\nconst CommandInput = React.forwardRef(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props} />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props} />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef((props, ref) => (\n  <CommandPrimitive.Empty ref={ref} className=\"py-6 text-center text-sm\" {...props} />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props} />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator ref={ref} className={cn(\"-mx-1 h-px bg-border\", className)} {...props} />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props} />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\command.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props} />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({\n  children,\n  ...props\n}) => {\n  return (\n    (<Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0\">\n        <Command\n          className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>)\n  );\n}\n\nconst CommandInput = React.forwardRef(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props} />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props} />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef((props, ref) => (\n  <CommandPrimitive.Empty ref={ref} className=\"py-6 text-center text-sm\" {...props} />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props} />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator ref={ref} className={cn(\"-mx-1 h-px bg-border\", className)} {...props} />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props} />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\context-menu (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":20,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}>\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props} />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\context-menu.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":20,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}>\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props} />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\dialog (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":16,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { CircleX } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-2xl\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <CircleX className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-fredoka font-semibold leading-none tracking-tight text-graphite\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-gray-600 font-verdana\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\dialog.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":16,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { CircleX } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-xl duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-2xl\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <CircleX className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-fredoka font-semibold leading-none tracking-tight text-graphite\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-gray-600 font-verdana\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\drawer (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}) => (\n  <DrawerPrimitive.Root shouldScaleBackground={shouldScaleBackground} {...props} />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props} />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}>\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props} />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}) => (\n  <div className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)} {...props} />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\drawer.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}) => (\n  <DrawerPrimitive.Root shouldScaleBackground={shouldScaleBackground} {...props} />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props} />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}>\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props} />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}) => (\n  <div className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)} {...props} />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)}\n    {...props} />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\dropdown-menu (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":21,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-lg px-2 py-1.5 text-sm font-verdana outline-none focus:bg-blue-50 data-[state=open]:bg-blue-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-2xl border border-gray-200 bg-white p-1 text-graphite shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-2xl border border-gray-200 bg-white p-1 text-graphite shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg px-2 py-1.5 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg py-1.5 pl-8 pr-2 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg py-1.5 pl-8 pr-2 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-fredoka font-semibold text-graphite\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-gray-200\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\dropdown-menu.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":21,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-lg px-2 py-1.5 text-sm font-verdana outline-none focus:bg-blue-50 data-[state=open]:bg-blue-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-2xl border border-gray-200 bg-white p-1 text-graphite shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-2xl border border-gray-200 bg-white p-1 text-graphite shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg px-2 py-1.5 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg py-1.5 pl-8 pr-2 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-lg py-1.5 pl-8 pr-2 text-sm font-verdana outline-none transition-colors focus:bg-blue-50 focus:text-puretask-blue data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-fredoka font-semibold text-graphite\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-gray-200\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\form (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":19,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { Controller, FormProvider, useFormContext } from \"react-hook-form\";\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\nconst FormFieldContext = React.createContext({})\n\nconst FormField = (\n  {\n    ...props\n  }\n) => {\n  return (\n    (<FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>)\n  );\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\nconst FormItemContext = React.createContext({})\n\nconst FormItem = React.forwardRef(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    (<FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>)\n  );\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    (<Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props} />)\n  );\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    (<Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props} />)\n  );\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    (<p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props} />)\n  );\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message) : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    (<p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}>\n      {body}\n    </p>)\n  );\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\form.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":19,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { Controller, FormProvider, useFormContext } from \"react-hook-form\";\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\nconst FormFieldContext = React.createContext({})\n\nconst FormField = (\n  {\n    ...props\n  }\n) => {\n  return (\n    (<FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>)\n  );\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\nconst FormItemContext = React.createContext({})\n\nconst FormItem = React.forwardRef(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    (<FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>)\n  );\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    (<Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props} />)\n  );\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    (<Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props} />)\n  );\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    (<p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-[0.8rem] text-muted-foreground\", className)}\n      {...props} />)\n  );\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message) : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    (<p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-[0.8rem] font-medium text-destructive\", className)}\n      {...props}>\n      {body}\n    </p>)\n  );\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\hover-card (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\hover-card.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\input (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":7}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-full border border-puretask-blue bg-white px-4 py-2 text-sm font-verdana text-graphite ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-puretask-blue focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\input-otp (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\"flex items-center gap-2 has-[:disabled]:opacity-50\", containerClassName)}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props} />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}>\n      {char}\n      {hasFakeCaret && (\n        <div\n          className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>)\n  );\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\input-otp.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Minus } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\"flex items-center gap-2 has-[:disabled]:opacity-50\", containerClassName)}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props} />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    (<div\n      ref={ref}\n      className={cn(\n        \"relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-1 ring-ring\",\n        className\n      )}\n      {...props}>\n      {char}\n      {hasFakeCaret && (\n        <div\n          className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>)\n  );\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Minus />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\input.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":7}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-full border border-puretask-blue bg-white px-4 py-2 text-sm font-verdana text-graphite ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-puretask-blue focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\label (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Label = React.forwardRef(({ className, ...props }, ref) => (\n  <label\n    ref={ref}\n    className={cn(\n      \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\",\n      className\n    )}\n    {...props}\n  />\n))\nLabel.displayName = \"Label\"\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\label.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Label = React.forwardRef(({ className, ...props }, ref) => (\n  <label\n    ref={ref}\n    className={cn(\n      \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\",\n      className\n    )}\n    {...props}\n  />\n))\nLabel.displayName = \"Label\"\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\menubar (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":10}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}) {\n  return <MenubarPrimitive.Menu {...props} />;\n}\n\nfunction MenubarGroup({\n  ...props\n}) {\n  return <MenubarPrimitive.Group {...props} />;\n}\n\nfunction MenubarPortal({\n  ...props\n}) {\n  return <MenubarPrimitive.Portal {...props} />;\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}) {\n  return <MenubarPrimitive.RadioGroup {...props} />;\n}\n\nfunction MenubarSub({\n  ...props\n}) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />;\n}\n\nconst Menubar = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props} />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props} />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}>\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef((\n  { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n  ref\n) => (\n  <MenubarPrimitive.Portal>\n    <MenubarPrimitive.Content\n      ref={ref}\n      align={align}\n      alignOffset={alignOffset}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </MenubarPrimitive.Portal>\n))\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", inset && \"pl-8\", className)}\n    {...props} />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props} />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\menubar.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":10}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}) {\n  return <MenubarPrimitive.Menu {...props} />;\n}\n\nfunction MenubarGroup({\n  ...props\n}) {\n  return <MenubarPrimitive.Group {...props} />;\n}\n\nfunction MenubarPortal({\n  ...props\n}) {\n  return <MenubarPrimitive.Portal {...props} />;\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}) {\n  return <MenubarPrimitive.RadioGroup {...props} />;\n}\n\nfunction MenubarSub({\n  ...props\n}) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />;\n}\n\nconst Menubar = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-9 items-center space-x-1 rounded-md border bg-background p-1 shadow-sm\",\n      className\n    )}\n    {...props} />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props} />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}>\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef((\n  { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n  ref\n) => (\n  <MenubarPrimitive.Portal>\n    <MenubarPrimitive.Content\n      ref={ref}\n      align={align}\n      alignOffset={alignOffset}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </MenubarPrimitive.Portal>\n))\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-4 w-4 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", inset && \"pl-8\", className)}\n    {...props} />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props} />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)}\n      {...props} />)\n  );\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\navigation-menu (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}>\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props} />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}>\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\" />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props} />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props} />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}>\n    <div\n      className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\navigation-menu.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}>\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props} />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-9 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}>\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-300 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\" />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props} />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props} />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}>\n    <div\n      className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\pagination (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":11,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\";\n\nconst Pagination = ({\n  className,\n  ...props\n}) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props} />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props} />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(buttonVariants({\n      variant: isActive ? \"outline\" : \"ghost\",\n      size,\n    }), className)}\n    {...props} />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}>\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}>\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}>\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\pagination.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":11,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\";\n\nconst Pagination = ({\n  className,\n  ...props\n}) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props} />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props} />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(buttonVariants({\n      variant: isActive ? \"outline\" : \"ghost\",\n      size,\n    }), className)}\n    {...props} />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}>\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}>\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}>\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationLink,\n  PaginationItem,\n  PaginationPrevious,\n  PaginationNext,\n  PaginationEllipsis,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\popover (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\popover.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverAnchor = PopoverPrimitive.Anchor\n\nconst PopoverContent = React.forwardRef(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\progress (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef(({ className, value, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-gray-200\",\n      className\n    )}\n    {...props}\n  >\n    <div\n      className=\"h-full bg-gradient-to-r from-puretask-blue to-blue-500 transition-all duration-300\"\n      style={{ width: `${Math.min(100, Math.max(0, value || 0))}%` }}\n    />\n  </div>\n))\nProgress.displayName = \"Progress\"\n\nexport { Progress }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\progress.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef(({ className, value, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"relative h-2 w-full overflow-hidden rounded-full bg-gray-200\",\n      className\n    )}\n    {...props}\n  >\n    <div\n      className=\"h-full bg-gradient-to-r from-puretask-blue to-blue-500 transition-all duration-300\"\n      style={{ width: `${Math.min(100, Math.max(0, value || 0))}%` }}\n    />\n  </div>\n))\nProgress.displayName = \"Progress\"\n\nexport { Progress }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\radio-group (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":11}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef(({ className, ...props }, ref) => {\n  return (<RadioGroupPrimitive.Root className={cn(\"grid gap-2\", className)} {...props} ref={ref} />);\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}>\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>)\n  );\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\radio-group.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":11}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef(({ className, ...props }, ref) => {\n  return (<RadioGroupPrimitive.Root className={cn(\"grid gap-2\", className)} {...props} ref={ref} />);\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}>\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-3.5 w-3.5 fill-primary\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>)\n  );\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\resizable (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props} />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}>\n    {withHandle && (\n      <div\n        className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\resizable.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":12,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props} />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}>\n    {withHandle && (\n      <div\n        className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\scroll-area (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}>\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}>\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\scroll-area.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}>\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}>\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\select (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\select.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\separator (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef((\n  { className, orientation = \"horizontal\", decorative = true, ...props },\n  ref\n) => (\n  <SeparatorPrimitive.Root\n    ref={ref}\n    decorative={decorative}\n    orientation={orientation}\n    className={cn(\n      \"shrink-0 bg-border\",\n      orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n      className\n    )}\n    {...props} />\n))\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\separator.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef((\n  { className, orientation = \"horizontal\", decorative = true, ...props },\n  ref\n) => (\n  <SeparatorPrimitive.Root\n    ref={ref}\n    decorative={decorative}\n    orientation={orientation}\n    className={cn(\n      \"shrink-0 bg-border\",\n      orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n      className\n    )}\n    {...props} />\n))\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sheet (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":18,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva } from \"class-variance-authority\";\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref} />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\nconst SheetContent = React.forwardRef(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>\n      <SheetPrimitive.Close\n        className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)}\n    {...props} />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)}\n    {...props} />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props} />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sheet.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":18,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva } from \"class-variance-authority\";\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref} />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\nconst SheetContent = React.forwardRef(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>\n      <SheetPrimitive.Close\n        className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n      {children}\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)}\n    {...props} />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)}\n    {...props} />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props} />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sidebar (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":107,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\";\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\nconst SidebarContext = React.createContext(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef((\n  {\n    defaultOpen = true,\n    open: openProp,\n    onOpenChange: setOpenProp,\n    className,\n    style,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback((value) => {\n    const openState = typeof value === \"function\" ? value(open) : value\n    if (setOpenProp) {\n      setOpenProp(openState)\n    } else {\n      _setOpen(openState)\n    }\n\n    // This sets the cookie to keep the sidebar state.\n    document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n  }, [setOpenProp, open])\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile\n      ? setOpenMobile((open) => !open)\n      : setOpen((open) => !open);\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo(() => ({\n    state,\n    open,\n    setOpen,\n    isMobile,\n    openMobile,\n    setOpenMobile,\n    toggleSidebar,\n  }), [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar])\n\n  return (\n    (<SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style\n            }\n          }\n          className={cn(\n            \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n            className\n          )}\n          ref={ref}\n          {...props}>\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>)\n  );\n})\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef((\n  {\n    side = \"left\",\n    variant = \"sidebar\",\n    collapsible = \"offcanvas\",\n    className,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      (<div\n        className={cn(\n          \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n          className\n        )}\n        ref={ref}\n        {...props}>\n        {children}\n      </div>)\n    );\n  }\n\n  if (isMobile) {\n    return (\n      (<Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE\n            }\n          }\n          side={side}>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>)\n    );\n  }\n\n  return (\n    (<div\n      ref={ref}\n      className=\"group peer hidden text-sidebar-foreground md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}>\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        className={cn(\n          \"relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n        )} />\n      <div\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}>\n        <div\n          data-sidebar=\"sidebar\"\n          className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\">\n          {children}\n        </div>\n      </div>\n    </div>)\n  );\n})\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    (<Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}>\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>)\n  );\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    (<button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props} />)\n  );\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props} />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props} />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props} />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef((\n  {\n    asChild = false,\n    isActive = false,\n    variant = \"default\",\n    size = \"default\",\n    tooltip,\n    className,\n    ...props\n  },\n  ref\n) => {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props} />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    (<Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip} />\n    </Tooltip>)\n  );\n})\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props} />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`;\n  }, [])\n\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}>\n      {showIcon && (\n        <Skeleton className=\"size-4 rounded-md\" data-sidebar=\"menu-skeleton-icon\" />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width\n          }\n        } />\n    </div>)\n  );\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props} />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef(\n  ({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"a\"\n\n    return (\n      (<Comp\n        ref={ref}\n        data-sidebar=\"menu-sub-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(\n          \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n          \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n          size === \"sm\" && \"text-xs\",\n          size === \"md\" && \"text-sm\",\n          \"group-data-[collapsible=icon]:hidden\",\n          className\n        )}\n        {...props} />)\n    );\n  }\n)\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sidebar.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":107,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\";\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\nconst SidebarContext = React.createContext(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef((\n  {\n    defaultOpen = true,\n    open: openProp,\n    onOpenChange: setOpenProp,\n    className,\n    style,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback((value) => {\n    const openState = typeof value === \"function\" ? value(open) : value\n    if (setOpenProp) {\n      setOpenProp(openState)\n    } else {\n      _setOpen(openState)\n    }\n\n    // This sets the cookie to keep the sidebar state.\n    document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n  }, [setOpenProp, open])\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile\n      ? setOpenMobile((open) => !open)\n      : setOpen((open) => !open);\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo(() => ({\n    state,\n    open,\n    setOpen,\n    isMobile,\n    openMobile,\n    setOpenMobile,\n    toggleSidebar,\n  }), [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar])\n\n  return (\n    (<SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style\n            }\n          }\n          className={cn(\n            \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n            className\n          )}\n          ref={ref}\n          {...props}>\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>)\n  );\n})\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef((\n  {\n    side = \"left\",\n    variant = \"sidebar\",\n    collapsible = \"offcanvas\",\n    className,\n    children,\n    ...props\n  },\n  ref\n) => {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      (<div\n        className={cn(\n          \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n          className\n        )}\n        ref={ref}\n        {...props}>\n        {children}\n      </div>)\n    );\n  }\n\n  if (isMobile) {\n    return (\n      (<Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE\n            }\n          }\n          side={side}>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>)\n    );\n  }\n\n  return (\n    (<div\n      ref={ref}\n      className=\"group peer hidden text-sidebar-foreground md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}>\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        className={cn(\n          \"relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n        )} />\n      <div\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}>\n        <div\n          data-sidebar=\"sidebar\"\n          className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\">\n          {children}\n        </div>\n      </div>\n    </div>)\n  );\n})\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    (<Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}>\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>)\n  );\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    (<button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props} />)\n  );\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef(({ className, ...props }, ref) => {\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props} />)\n  );\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props} />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props} />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props} />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef((\n  {\n    asChild = false,\n    isActive = false,\n    variant = \"default\",\n    size = \"default\",\n    tooltip,\n    className,\n    ...props\n  },\n  ref\n) => {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props} />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    (<Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip} />\n    </Tooltip>)\n  );\n})\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    (<Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props} />)\n  );\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props} />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`;\n  }, [])\n\n  return (\n    (<div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}>\n      {showIcon && (\n        <Skeleton className=\"size-4 rounded-md\" data-sidebar=\"menu-skeleton-icon\" />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width\n          }\n        } />\n    </div>)\n  );\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props} />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef(\n  ({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"a\"\n\n    return (\n      (<Comp\n        ref={ref}\n        data-sidebar=\"menu-sub-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(\n          \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n          \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n          size === \"sm\" && \"text-xs\",\n          size === \"md\" && \"text-sm\",\n          \"group-data-[collapsible=icon]:hidden\",\n          className\n        )}\n        {...props} />)\n    );\n  }\n)\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\skeleton (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}) {\n  return (\n    (<div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props} />)\n  );\n}\n\nexport { Skeleton }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\skeleton-card.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":5,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\n\nexport function SkeletonCleanerCard() {\n  return (\n    <div className=\"rounded-xl shadow-lg border-0 h-full flex flex-col animate-pulse bg-gray-100 p-6\">\n      <div className=\"h-2 bg-gray-200 rounded-full mb-4 w-1/3\"></div>\n      <div className=\"flex items-start gap-3 mb-4\">\n        <div className=\"w-20 h-20 bg-gray-300 rounded-xl\"></div>\n        <div className=\"flex-1 space-y-2\">\n          <div className=\"h-4 bg-gray-300 rounded w-3/4\"></div>\n          <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n        </div>\n      </div>\n      <div className=\"h-16 bg-gray-200 rounded-xl mb-4\"></div>\n      <div className=\"h-24 bg-gray-200 rounded-xl mb-4\"></div>\n      <div className=\"grid grid-cols-2 gap-3 mb-4\">\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n      </div>\n      <div className=\"h-10 bg-gray-300 rounded-lg w-full\"></div>\n    </div>\n  );\n}\n\nexport function SkeletonJobCard() {\n  return (\n    <div className=\"rounded-xl shadow-lg border-0 animate-pulse bg-gray-100 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"space-y-2 flex-1\">\n          <div className=\"h-4 bg-gray-300 rounded w-1/2\"></div>\n          <div className=\"h-3 bg-gray-200 rounded w-1/3\"></div>\n        </div>\n        <div className=\"h-8 w-20 bg-gray-300 rounded\"></div>\n      </div>\n      <div className=\"h-3 bg-gray-200 rounded mb-4\"></div>\n      <div className=\"grid grid-cols-4 gap-2 mb-4\">\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n        <div className=\"h-12 bg-gray-200 rounded\"></div>\n      </div>\n      <div className=\"flex gap-2\">\n        <div className=\"h-10 bg-gray-200 rounded flex-1\"></div>\n        <div className=\"h-10 bg-gray-300 rounded flex-1\"></div>\n      </div>\n    </div>\n  );\n}\n\nexport function SkeletonMessageThread() {\n  return (\n    <div className=\"p-4 border-b border-slate-200 hover:bg-slate-50 animate-pulse\">\n      <div className=\"flex items-start gap-3\">\n        <div className=\"w-12 h-12 rounded-full bg-gray-300\"></div>\n        <div className=\"flex-1\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"h-4 bg-gray-300 rounded w-1/3\"></div>\n            <div className=\"h-3 bg-gray-200 rounded w-16\"></div>\n          </div>\n          <div className=\"h-3 bg-gray-200 rounded w-3/4 mb-2\"></div>\n          <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\skeleton.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}) {\n  return (\n    (<div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props} />)\n  );\n}\n\nexport { Skeleton }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\slider (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\n\"use client\"\n\nimport * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-200\">\n      <SliderPrimitive.Range className=\"absolute h-full\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }} />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-white shadow-lg transition-transform focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:scale-110 active:scale-95\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }} />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\slider.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":10,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\n\"use client\"\n\nimport * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-gray-200\">\n      <SliderPrimitive.Range className=\"absolute h-full\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }} />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-white shadow-lg transition-transform focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:scale-110 active:scale-95\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }} />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sonner (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":11,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\nconst Toaster = ({\n  ...props\n}) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    (<Sonner\n      theme={theme}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props} />)\n  );\n}\n\nexport { Toaster }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\sonner.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":11,"column":6}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner } from \"sonner\"\n\nconst Toaster = ({\n  ...props\n}) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    (<Sonner\n      theme={theme}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props} />)\n  );\n}\n\nexport { Toaster }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\switch (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}>\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )} />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\switch.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}>\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0\"\n      )} />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\table (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props} />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props} />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\", className)}\n    {...props} />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props} />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props} />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props} />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\table.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":6,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props} />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props} />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\", className)}\n    {...props} />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props} />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props} />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      \"p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\n      className\n    )}\n    {...props} />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props} />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\tabs (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-12 items-center justify-center rounded-2xl bg-gray-100 p-1 text-gray-600\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-xl px-4 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-puretask-blue data-[state=active]:shadow-md\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\tabs.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":9,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-12 items-center justify-center rounded-2xl bg-gray-100 p-1 text-gray-600\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-xl px-4 py-2 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-puretask-blue data-[state=active]:shadow-md\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\textarea (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":7}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-2xl border-2 border-gray-300 bg-white px-4 py-3 text-sm font-verdana placeholder:text-gray-400 focus:border-puretask-blue focus:outline-none focus:ring-2 focus:ring-blue-100 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\textarea.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":8,"column":7}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-2xl border-2 border-gray-300 bg-white px-4 py-3 text-sm font-verdana placeholder:text-gray-400 focus:border-puretask-blue focus:outline-none focus:ring-2 focus:ring-blue-100 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toast (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { cva } from \"class-variance-authority\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nconst ToastProvider = React.forwardRef(({ ...props }, ref) => (\n  <div\n    ref={ref}\n    className=\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\"\n    {...props}\n  />\n));\nToastProvider.displayName = \"ToastProvider\";\n\nconst ToastViewport = React.forwardRef(({ ...props }, ref) => (\n  <div\n    ref={ref}\n    className=\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\"\n    {...props}\n  />\n));\nToastViewport.displayName = \"ToastViewport\";\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nconst Toast = React.forwardRef(({ className, variant, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  );\n});\nToast.displayName = \"Toast\";\n\nconst ToastAction = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n));\nToastAction.displayName = \"ToastAction\";\n\nconst ToastClose = React.forwardRef(({ className, ...props }, ref) => (\n  <button\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </button>\n));\nToastClose.displayName = \"ToastClose\";\n\nconst ToastTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n));\nToastTitle.displayName = \"ToastTitle\";\n\nconst ToastDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n));\nToastDescription.displayName = \"ToastDescription\";\n\nexport {\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}; ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toast.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { cva } from \"class-variance-authority\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nconst ToastProvider = React.forwardRef(({ ...props }, ref) => (\n  <div\n    ref={ref}\n    className=\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\"\n    {...props}\n  />\n));\nToastProvider.displayName = \"ToastProvider\";\n\nconst ToastViewport = React.forwardRef(({ ...props }, ref) => (\n  <div\n    ref={ref}\n    className=\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\"\n    {...props}\n  />\n));\nToastViewport.displayName = \"ToastViewport\";\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nconst Toast = React.forwardRef(({ className, variant, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  );\n});\nToast.displayName = \"Toast\";\n\nconst ToastAction = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n));\nToastAction.displayName = \"ToastAction\";\n\nconst ToastClose = React.forwardRef(({ className, ...props }, ref) => (\n  <button\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </button>\n));\nToastClose.displayName = \"ToastClose\";\n\nconst ToastTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n));\nToastTitle.displayName = \"ToastTitle\";\n\nconst ToastDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n));\nToastDescription.displayName = \"ToastDescription\";\n\nexport {\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}; ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toaster (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":15,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useToast } from \"@/components/ui/use-toast\";\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\";\n\nexport function Toaster() {\n  const { toasts } = useToast();\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        );\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  );\n} ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toaster.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":15,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useToast } from \"@/components/ui/use-toast\";\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\";\n\nexport function Toaster() {\n  const { toasts } = useToast();\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        );\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  );\n} ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toggle (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":30,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props} />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toggle-group (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}>\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    (<ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(toggleVariants({\n        variant: context.variant || variant,\n        size: context.size || size,\n      }), className)}\n      {...props}>\n      {children}\n    </ToggleGroupPrimitive.Item>)\n  );\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toggle-group.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":14,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}>\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    (<ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(toggleVariants({\n        variant: context.variant || variant,\n        size: context.size || size,\n      }), className)}\n      {...props}>\n      {children}\n    </ToggleGroupPrimitive.Item>)\n  );\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\toggle.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":30,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-9 px-2 min-w-9\",\n        sm: \"h-8 px-1.5 min-w-8\",\n        lg: \"h-10 px-2.5 min-w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props} />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\tooltip (2).jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\tooltip.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":13,"column":3}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\use-toast (2).jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\ui\\use-toast.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\ErrorBoundary.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":12,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[391,396],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { AlertCircle, RefreshCw } from 'lucide-react';\n\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null, errorInfo: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('Error caught by boundary:', error, errorInfo);\n    this.setState({ error, errorInfo });\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center p-6 bg-slate-50\">\n          <div className=\"max-w-md w-full\">\n            <Alert className=\"border-red-200 bg-red-50\">\n              <AlertCircle className=\"h-5 w-5 text-red-600\" />\n              <AlertDescription className=\"text-red-900\">\n                <h3 className=\"font-semibold text-lg mb-2\">Something went wrong</h3>\n                <p className=\"text-sm mb-4\">\n                  We've encountered an unexpected error. Our team has been notified.\n                </p>\n                <Button \n                  onClick={() => window.location.reload()}\n                  className=\"w-full\"\n                >\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\n                  Reload Page\n                </Button>\n              </AlertDescription>\n            </Alert>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\RateLimitHandler.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onRetry' is defined but never used. Allowed unused args must match /^_/u.","line":5,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"onRetry"},"fix":{"range":[183,194],"text":""},"desc":"Remove unused variable 'onRetry'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { AlertCircle, Clock } from 'lucide-react';\n\nexport default function RateLimitError({ onRetry }) {\n  return (\n    <Alert className=\"border-amber-500 bg-amber-50\">\n      <AlertCircle className=\"h-4 w-4 text-amber-600\" />\n      <AlertDescription className=\"text-amber-900\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <p className=\"font-semibold mb-1\">Too many requests</p>\n            <p className=\"text-sm\">Please wait a moment before trying again. The system is processing your previous requests.</p>\n          </div>\n          <Clock className=\"w-5 h-5 text-amber-500 ml-4\" />\n        </div>\n      </AlertDescription>\n    </Alert>\n  );\n}\n\nexport function handleRateLimitError(error, setError) {\n  if (error.response?.status === 429) {\n    setError('Too many requests. Please wait a moment and try again.');\n    return true;\n  }\n  return false;\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\colorSystem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\dateHelpers.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":1,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":44,"fix":{"range":[35,44],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[34,43],"text":""},"desc":"Remove unused variable 'addDays'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":69,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":69,"endColumn":17},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":84,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":84,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { format, parseISO, isValid, addDays, differenceInHours, differenceInMinutes } from 'date-fns';\n\n/**\n * Safely format a booking date\n */\nexport function formatBookingDate(date) {\n  if (!date) return 'Date not set';\n  \n  try {\n    const parsedDate = typeof date === 'string' ? parseISO(date) : new Date(date);\n    if (isValid(parsedDate)) {\n      return format(parsedDate, 'EEEE, MMMM d, yyyy');\n    }\n  } catch (error) {\n    console.error('Error formatting date:', error);\n  }\n  return String(date);\n}\n\n/**\n * Safely format a short date\n */\nexport function formatShortDate(date) {\n  if (!date) return '';\n  \n  try {\n    const parsedDate = typeof date === 'string' ? parseISO(date) : new Date(date);\n    if (isValid(parsedDate)) {\n      return format(parsedDate, 'MMM d, yyyy');\n    }\n  } catch (error) {\n    console.error('Error formatting date:', error);\n  }\n  return String(date);\n}\n\n/**\n * Calculate cancellation fee based on time until booking\n */\nexport function calculateCancellationFee(bookingDate, bookingTime, totalPrice) {\n  try {\n    const bookingDateTime = new Date(`${bookingDate}T${bookingTime}`);\n    const now = new Date();\n    const hoursUntil = differenceInHours(bookingDateTime, now);\n    \n    if (hoursUntil > 24) {\n      return 0; // Free cancellation\n    } else if (hoursUntil > 12) {\n      return totalPrice * 0.5; // 50% fee\n    } else {\n      return totalPrice; // 100% fee\n    }\n  } catch (error) {\n    console.error('Error calculating cancellation fee:', error);\n    return totalPrice; // Default to full fee on error\n  }\n}\n\n/**\n * Check if booking can be rescheduled for free\n */\nexport function canRescheduleForFree(bookingDate, bookingTime) {\n  try {\n    const bookingDateTime = new Date(`${bookingDate}T${bookingTime}`);\n    const now = new Date();\n    const hoursUntil = differenceInHours(bookingDateTime, now);\n    \n    return hoursUntil > 24;\n  } catch (error) {\n    return false;\n  }\n}\n\n/**\n * Check if cleaner is within grace period for check-in\n */\nexport function isWithinGracePeriod(scheduledDateTime, actualDateTime, gracePeriodMinutes = 15) {\n  try {\n    const scheduled = new Date(scheduledDateTime);\n    const actual = new Date(actualDateTime);\n    const diffMinutes = Math.abs(differenceInMinutes(actual, scheduled));\n    \n    return diffMinutes <= gracePeriodMinutes;\n  } catch (error) {\n    return false;\n  }\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\errorBoundary (2).jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used. Allowed unused args must match /^_/u.","line":12,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[391,396],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { AlertCircle, RefreshCw } from 'lucide-react';\n\nclass ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null, errorInfo: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('Error caught by boundary:', error, errorInfo);\n    this.setState({ error, errorInfo });\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"min-h-screen flex items-center justify-center p-6 bg-slate-50\">\n          <div className=\"max-w-md w-full\">\n            <Alert className=\"border-red-200 bg-red-50\">\n              <AlertCircle className=\"h-5 w-5 text-red-600\" />\n              <AlertDescription className=\"text-red-900\">\n                <h3 className=\"font-semibold text-lg mb-2\">Something went wrong</h3>\n                <p className=\"text-sm mb-4\">\n                  We've encountered an unexpected error. Our team has been notified.\n                </p>\n                <Button \n                  onClick={() => window.location.reload()}\n                  className=\"w-full\"\n                >\n                  <RefreshCw className=\"w-4 h-4 mr-2\" />\n                  Reload Page\n                </Button>\n              </AlertDescription>\n            </Alert>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\priceCalculator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\serviceIcons.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\tierColors.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\timeUtils.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\utils\\validation.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\validation\\GPSValidationService.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":155,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":155,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * GPS Validation Service\n * Implements anti-spoof measures and distance validation per Section 2.3\n * \n * Key Rules:\n * - Require device location services enabled\n * - Enforce ‚â§ 250m radius from job address\n * - Log validation attempts for audit\n */\n\nconst VALID_RADIUS_METERS = 250;\n\nexport const validateGPSLocation = (checkInLocation, jobAddress) => {\n  if (!checkInLocation || !checkInLocation.latitude || !checkInLocation.longitude) {\n    return {\n      valid: false,\n      error: 'Location services not enabled. Please enable GPS on your device.',\n      code: 'GPS_DISABLED'\n    };\n  }\n\n  if (!jobAddress || !jobAddress.latitude || !jobAddress.longitude) {\n    return {\n      valid: false,\n      error: 'Job address coordinates not found. Contact support.',\n      code: 'INVALID_ADDRESS'\n    };\n  }\n\n  const distance = calculateDistance(\n    checkInLocation.latitude,\n    checkInLocation.longitude,\n    jobAddress.latitude,\n    jobAddress.longitude\n  );\n\n  if (distance > VALID_RADIUS_METERS) {\n    return {\n      valid: false,\n      error: `You are ${Math.round(distance)}m from the job location. Please move closer (within 250m) to check in.`,\n      distance,\n      code: 'OUT_OF_RANGE'\n    };\n  }\n\n  return {\n    valid: true,\n    distance,\n    message: `GPS verified: ${Math.round(distance)}m from job location`\n  };\n};\n\n/**\n * Calculate distance between two GPS coordinates using Haversine formula\n * Returns distance in meters\n */\nexport const calculateDistance = (lat1, lon1, lat2, lon2) => {\n  const R = 6371000; // Earth's radius in meters\n  const dLat = toRadians(lat2 - lat1);\n  const dLon = toRadians(lon2 - lon1);\n\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRadians(lat1)) *\n      Math.cos(toRadians(lat2)) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c;\n\n  return distance;\n};\n\nconst toRadians = (degrees) => {\n  return degrees * (Math.PI / 180);\n};\n\n/**\n * Request device location with high accuracy\n */\nexport const requestDeviceLocation = () => {\n  return new Promise((resolve, reject) => {\n    if (!navigator.geolocation) {\n      reject({\n        valid: false,\n        error: 'GPS not supported on this device',\n        code: 'GPS_NOT_SUPPORTED'\n      });\n      return;\n    }\n\n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        resolve({\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude,\n          accuracy: position.coords.accuracy,\n          timestamp: new Date(position.timestamp).toISOString()\n        });\n      },\n      (error) => {\n        let errorMessage = 'Failed to get location';\n        let errorCode = 'GPS_ERROR';\n\n        switch (error.code) {\n          case error.PERMISSION_DENIED:\n            errorMessage = 'Location permission denied. Please enable GPS in your device settings.';\n            errorCode = 'GPS_PERMISSION_DENIED';\n            break;\n          case error.POSITION_UNAVAILABLE:\n            errorMessage = 'Location unavailable. Please check your GPS signal.';\n            errorCode = 'GPS_UNAVAILABLE';\n            break;\n          case error.TIMEOUT:\n            errorMessage = 'Location request timed out. Please try again.';\n            errorCode = 'GPS_TIMEOUT';\n            break;\n        }\n\n        reject({\n          valid: false,\n          error: errorMessage,\n          code: errorCode\n        });\n      },\n      {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0\n      }\n    );\n  });\n};\n\n/**\n * Format location data for storage\n */\nexport const formatLocationForStorage = (location, distanceFromJob) => {\n  return JSON.stringify({\n    latitude: location.latitude,\n    longitude: location.longitude,\n    accuracy: location.accuracy,\n    timestamp: location.timestamp,\n    distance_from_job: distanceFromJob\n  });\n};\n\n/**\n * Parse stored location data\n */\nexport const parseStoredLocation = (locationString) => {\n  try {\n    return JSON.parse(locationString);\n  } catch (error) {\n    return null;\n  }\n};\n\nexport default {\n  validateGPSLocation,\n  calculateDistance,\n  requestDeviceLocation,\n  formatLocationForStorage,\n  parseStoredLocation,\n  VALID_RADIUS_METERS\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\validation\\PhotoValidationService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\verification\\EnhancedVerificationUpload.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ImageIcon' is defined but never used.","line":8,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":55,"fix":{"range":[373,393],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ImageIcon"},"fix":{"range":[372,392],"text":""},"desc":"Remove unused variable 'ImageIcon'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'RefreshCw' is defined but never used.","line":9,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":47,"fix":{"range":[430,441],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"RefreshCw"},"fix":{"range":[430,441],"text":""},"desc":"Remove unused variable 'RefreshCw'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Upload, CheckCircle, AlertCircle, Image as ImageIcon, \n  FileText, Camera, Loader2, Eye, X, RefreshCw\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\n\nexport default function EnhancedVerificationUpload({ user, onUploadComplete }) {\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState({});\n  const [previewUrls, setPreviewUrls] = useState({\n    id_front: user?.kyc_documents?.id_front || null,\n    id_back: user?.kyc_documents?.id_back || null,\n    selfie: user?.kyc_documents?.selfie || null\n  });\n  const [selectedPreview, setSelectedPreview] = useState(null);\n  const [error, setError] = useState('');\n\n  const documentTypes = [\n    {\n      key: 'id_front',\n      label: 'ID Front',\n      description: 'Front of government-issued ID',\n      icon: FileText,\n      requirements: [\n        'Clear, readable text',\n        'All corners visible',\n        'No glare or shadows',\n        'Valid government ID'\n      ]\n    },\n    {\n      key: 'id_back',\n      label: 'ID Back',\n      description: 'Back of government-issued ID',\n      icon: FileText,\n      requirements: [\n        'Clear, readable text',\n        'All corners visible',\n        'Barcode visible (if present)',\n        'No obstructions'\n      ]\n    },\n    {\n      key: 'selfie',\n      label: 'Selfie with ID',\n      description: 'Photo of you holding your ID',\n      icon: Camera,\n      requirements: [\n        'Your face clearly visible',\n        'ID visible and readable',\n        'Good lighting',\n        'No filters or edits'\n      ]\n    }\n  ];\n\n  const validateFile = (file) => {\n    // File size check (5MB max)\n    if (file.size > 5 * 1024 * 1024) {\n      return 'File size must be less than 5MB';\n    }\n\n    // File type check\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'];\n    if (!validTypes.includes(file.type)) {\n      return 'File must be JPEG, PNG, or WebP';\n    }\n\n    return null;\n  };\n\n  const handleFileUpload = async (docType, file) => {\n    const validationError = validateFile(file);\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    setError('');\n    setUploading(true);\n    setUploadProgress(prev => ({ ...prev, [docType]: 0 }));\n\n    try {\n      // Create preview\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        setPreviewUrls(prev => ({ ...prev, [docType]: e.target.result }));\n      };\n      reader.readAsDataURL(file);\n\n      // Upload to Base44\n      setUploadProgress(prev => ({ ...prev, [docType]: 50 }));\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      \n      setUploadProgress(prev => ({ ...prev, [docType]: 75 }));\n\n      // Update user record\n      const currentDocs = user.kyc_documents || {};\n      const updatedDocs = { ...currentDocs, [docType]: file_url };\n\n      await base44.auth.updateMe({\n        kyc_documents: updatedDocs,\n        kyc_documents_submitted: true,\n        kyc_status: 'pending' // Set to pending review\n      });\n\n      setUploadProgress(prev => ({ ...prev, [docType]: 100 }));\n      \n      // Success - trigger callback\n      setTimeout(() => {\n        setUploadProgress(prev => {\n          const updated = { ...prev };\n          delete updated[docType];\n          return updated;\n        });\n        if (onUploadComplete) onUploadComplete();\n      }, 1000);\n\n    } catch (error) {\n      console.error('Upload error:', error);\n      setError(`Failed to upload ${docType}: ${error.message}`);\n      setUploadProgress(prev => {\n        const updated = { ...prev };\n        delete updated[docType];\n        return updated;\n      });\n    }\n\n    setUploading(false);\n  };\n\n  const handleRemoveDocument = async (docType) => {\n    try {\n      const currentDocs = user.kyc_documents || {};\n      const updatedDocs = { ...currentDocs };\n      delete updatedDocs[docType];\n\n      await base44.auth.updateMe({\n        kyc_documents: updatedDocs,\n        kyc_documents_submitted: Object.keys(updatedDocs).length === 3\n      });\n\n      setPreviewUrls(prev => ({ ...prev, [docType]: null }));\n      if (onUploadComplete) onUploadComplete();\n    } catch (error) {\n      console.error('Remove error:', error);\n      setError('Failed to remove document');\n    }\n  };\n\n  const allDocsUploaded = Object.values(previewUrls).every(url => url !== null);\n  const kycStatus = user?.kyc_status || 'not_submitted';\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status Banner */}\n      <Card className={`border-2 ${\n        kycStatus === 'approved' ? 'bg-green-50 border-green-300' :\n        kycStatus === 'pending' ? 'bg-blue-50 border-blue-300' :\n        kycStatus === 'rejected' ? 'bg-red-50 border-red-300' :\n        'bg-amber-50 border-amber-300'\n      }`}>\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center gap-3\">\n            {kycStatus === 'approved' && <CheckCircle className=\"w-6 h-6 text-green-600\" />}\n            {kycStatus === 'pending' && <Loader2 className=\"w-6 h-6 text-blue-600 animate-spin\" />}\n            {kycStatus === 'rejected' && <AlertCircle className=\"w-6 h-6 text-red-600\" />}\n            {kycStatus === 'not_submitted' && <Upload className=\"w-6 h-6 text-amber-600\" />}\n            \n            <div className=\"flex-1\">\n              <p className=\"font-semibold text-slate-900\">\n                {kycStatus === 'approved' && 'Verification Approved'}\n                {kycStatus === 'pending' && 'Verification Under Review'}\n                {kycStatus === 'rejected' && 'Verification Rejected - Please Resubmit'}\n                {kycStatus === 'not_submitted' && 'Verification Required'}\n              </p>\n              <p className=\"text-sm text-slate-600\">\n                {kycStatus === 'approved' && 'Your identity has been verified. You can now accept bookings.'}\n                {kycStatus === 'pending' && 'Our team is reviewing your documents. This typically takes 24-48 hours.'}\n                {kycStatus === 'rejected' && 'Please upload new, clear documents that meet the requirements.'}\n                {kycStatus === 'not_submitted' && 'Upload your ID documents to start accepting cleaning jobs.'}\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Error Alert */}\n      <AnimatePresence>\n        {error && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n          >\n            <Alert className=\"border-red-200 bg-red-50\">\n              <AlertCircle className=\"w-4 h-4 text-red-600\" />\n              <AlertDescription className=\"text-red-900\">\n                {error}\n              </AlertDescription>\n            </Alert>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Upload Cards */}\n      <div className=\"grid md:grid-cols-3 gap-6\">\n        {documentTypes.map((docType) => {\n          const Icon = docType.icon;\n          const isUploaded = !!previewUrls[docType.key];\n          const progress = uploadProgress[docType.key];\n\n          return (\n            <Card\n              key={docType.key}\n              className={`border-2 transition-all ${\n                isUploaded \n                  ? 'border-green-300 bg-green-50' \n                  : 'border-slate-200 hover:border-emerald-300 hover:shadow-lg'\n              }`}\n            >\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <Icon className={`w-5 h-5 ${isUploaded ? 'text-green-600' : 'text-slate-600'}`} />\n                  {docType.label}\n                  {isUploaded && <CheckCircle className=\"w-5 h-5 text-green-600 ml-auto\" />}\n                </CardTitle>\n                <p className=\"text-sm text-slate-600\">{docType.description}</p>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {/* Preview or Upload Area */}\n                {isUploaded ? (\n                  <div className=\"relative\">\n                    <img\n                      src={previewUrls[docType.key]}\n                      alt={docType.label}\n                      className=\"w-full h-40 object-cover rounded-lg border-2 border-green-300 cursor-pointer hover:opacity-90 transition-opacity\"\n                      onClick={() => setSelectedPreview({ type: docType.key, url: previewUrls[docType.key] })}\n                    />\n                    <div className=\"absolute top-2 right-2 flex gap-2\">\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        className=\"bg-white/90 hover:bg-white\"\n                        onClick={() => setSelectedPreview({ type: docType.key, url: previewUrls[docType.key] })}\n                      >\n                        <Eye className=\"w-4 h-4\" />\n                      </Button>\n                      {kycStatus !== 'approved' && (\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"bg-white/90 hover:bg-white\"\n                          onClick={() => handleRemoveDocument(docType.key)}\n                        >\n                          <X className=\"w-4 h-4 text-red-600\" />\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <label className=\"cursor-pointer\">\n                    <div className=\"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:border-emerald-500 hover:bg-emerald-50 transition-all\">\n                      <Upload className=\"w-8 h-8 text-slate-400 mx-auto mb-2\" />\n                      <p className=\"text-sm text-slate-600 mb-1\">Click to upload</p>\n                      <p className=\"text-xs text-slate-500\">JPEG, PNG, WebP (max 5MB)</p>\n                    </div>\n                    <input\n                      type=\"file\"\n                      accept=\"image/jpeg,image/jpg,image/png,image/webp\"\n                      className=\"hidden\"\n                      onChange={(e) => {\n                        const file = e.target.files[0];\n                        if (file) handleFileUpload(docType.key, file);\n                      }}\n                      disabled={uploading || kycStatus === 'approved'}\n                    />\n                  </label>\n                )}\n\n                {/* Upload Progress */}\n                {progress !== undefined && (\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"text-slate-600\">Uploading...</span>\n                      <span className=\"font-semibold text-emerald-600\">{progress}%</span>\n                    </div>\n                    <div className=\"w-full bg-slate-200 rounded-full h-2 overflow-hidden\">\n                      <motion.div\n                        className=\"bg-emerald-500 h-full\"\n                        initial={{ width: 0 }}\n                        animate={{ width: `${progress}%` }}\n                        transition={{ duration: 0.3 }}\n                      />\n                    </div>\n                  </div>\n                )}\n\n                {/* Requirements */}\n                <div className=\"space-y-1\">\n                  <p className=\"text-xs font-semibold text-slate-700\">Requirements:</p>\n                  <ul className=\"text-xs text-slate-600 space-y-0.5\">\n                    {docType.requirements.map((req, idx) => (\n                      <li key={idx} className=\"flex items-start gap-1\">\n                        <span className=\"text-emerald-600 mt-0.5\">‚Ä¢</span>\n                        <span>{req}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      {/* Submission Status */}\n      {allDocsUploaded && kycStatus === 'pending' && (\n        <Card className=\"bg-blue-50 border-2 border-blue-300\">\n          <CardContent className=\"p-6 text-center\">\n            <Loader2 className=\"w-12 h-12 text-blue-600 animate-spin mx-auto mb-4\" />\n            <h3 className=\"text-xl font-bold text-slate-900 mb-2\">Under Review</h3>\n            <p className=\"text-slate-600 mb-4\">\n              Your documents have been submitted and are being reviewed by our team.\n              You'll receive an email notification once verification is complete.\n            </p>\n            <Badge className=\"bg-blue-600 text-white\">\n              Expected review time: 24-48 hours\n            </Badge>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Image Preview Modal */}\n      {selectedPreview && (\n        <Dialog open={!!selectedPreview} onOpenChange={() => setSelectedPreview(null)}>\n          <DialogContent className=\"max-w-3xl\">\n            <DialogHeader>\n              <DialogTitle>\n                {documentTypes.find(d => d.key === selectedPreview.type)?.label}\n              </DialogTitle>\n            </DialogHeader>\n            <img\n              src={selectedPreview.url}\n              alt=\"Document preview\"\n              className=\"w-full h-auto rounded-lg\"\n            />\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\verification\\VerificationPipeline.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'base44' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"fix":{"range":[52,97],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"base44"},"fix":{"range":[52,96],"text":""},"desc":"Remove unused variable 'base44'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Loader2' is defined but never used.","line":6,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":69,"fix":{"range":[349,358],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Loader2"},"fix":{"range":[349,358],"text":""},"desc":"Remove unused variable 'Loader2'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'onVerificationComplete' is defined but never used. Allowed unused args must match /^_/u.","line":8,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":76,"suggestions":[{"messageId":"removeVar","data":{"varName":"onVerificationComplete"},"fix":{"range":[434,458],"text":""},"desc":"Remove unused variable 'onVerificationComplete'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[587,594],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setLoading' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"setLoading"},"fix":{"range":[594,606],"text":""},"desc":"Remove unused variable 'setLoading'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setError' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":12,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"setError"},"fix":{"range":[641,651],"text":""},"desc":"Remove unused variable 'setError'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Shield, CheckCircle, Clock, XCircle, AlertTriangle, Loader2 } from 'lucide-react';\n\nexport default function VerificationPipeline({ user, onVerificationComplete }) {\n  const [kycStatus, setKycStatus] = useState('pending');\n  const [bgcStatus, setBgcStatus] = useState('pending');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (user) {\n      setKycStatus(user.kyc_status || 'pending');\n      setBgcStatus(user.background_check_status || 'pending');\n    }\n  }, [user]);\n\n  const getStatusIcon = (status) => {\n    switch (status) {\n      case 'approved':\n        return <CheckCircle className=\"w-5 h-5 text-emerald-500\" />;\n      case 'rejected':\n        return <XCircle className=\"w-5 h-5 text-red-500\" />;\n      case 'consider':\n        return <AlertTriangle className=\"w-5 h-5 text-amber-500\" />;\n      case 'pending':\n        return <Clock className=\"w-5 h-5 text-blue-500\" />;\n      default:\n        return <Clock className=\"w-5 h-5 text-slate-400\" />;\n    }\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'approved':\n        return 'bg-emerald-500';\n      case 'rejected':\n        return 'bg-red-500';\n      case 'consider':\n        return 'bg-amber-500';\n      case 'pending':\n        return 'bg-blue-500';\n      default:\n        return 'bg-slate-400';\n    }\n  };\n\n  const getStatusText = (status) => {\n    switch (status) {\n      case 'approved':\n        return 'Approved';\n      case 'rejected':\n        return 'Rejected';\n      case 'consider':\n        return 'Under Review';\n      case 'pending':\n        return 'Pending Review';\n      default:\n        return 'Unknown';\n    }\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-r from-blue-50 to-purple-50\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <Shield className=\"w-6 h-6 text-blue-600\" />\n          Verification Status\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6 space-y-6\">\n        {error && (\n          <Alert variant=\"destructive\">\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        )}\n\n        {/* KYC Status */}\n        <div className=\"flex items-center justify-between p-4 bg-slate-50 rounded-lg\">\n          <div className=\"flex items-center gap-3\">\n            {getStatusIcon(kycStatus)}\n            <div>\n              <p className=\"font-semibold text-slate-900\">Identity Verification (KYC)</p>\n              <p className=\"text-sm text-slate-600\">ID document and liveness check</p>\n            </div>\n          </div>\n          <Badge className={`${getStatusColor(kycStatus)} text-white`}>\n            {getStatusText(kycStatus)}\n          </Badge>\n        </div>\n\n        {/* Background Check Status */}\n        <div className=\"flex items-center justify-between p-4 bg-slate-50 rounded-lg\">\n          <div className=\"flex items-center gap-3\">\n            {getStatusIcon(bgcStatus)}\n            <div>\n              <p className=\"font-semibold text-slate-900\">Background Check</p>\n              <p className=\"text-sm text-slate-600\">Criminal record and employment verification</p>\n            </div>\n          </div>\n          <Badge className={`${getStatusColor(bgcStatus)} text-white`}>\n            {getStatusText(bgcStatus)}\n          </Badge>\n        </div>\n\n        {/* Overall Status Message */}\n        {kycStatus === 'pending' || bgcStatus === 'pending' ? (\n          <Alert className=\"border-blue-200 bg-blue-50\">\n            <Clock className=\"h-4 w-4 text-blue-600\" />\n            <AlertDescription className=\"text-blue-900\">\n              <strong>Verification in Progress</strong>\n              <p className=\"text-sm mt-1\">\n                Your documents are being reviewed. This typically takes 24-48 hours. \n                You'll receive an email once the verification is complete.\n              </p>\n            </AlertDescription>\n          </Alert>\n        ) : kycStatus === 'approved' && bgcStatus === 'approved' ? (\n          <Alert className=\"border-emerald-200 bg-emerald-50\">\n            <CheckCircle className=\"h-4 w-4 text-emerald-600\" />\n            <AlertDescription className=\"text-emerald-900\">\n              <strong>Verification Complete!</strong>\n              <p className=\"text-sm mt-1\">\n                You're all set to start accepting bookings on PureTask.\n              </p>\n            </AlertDescription>\n          </Alert>\n        ) : (kycStatus === 'rejected' || bgcStatus === 'rejected') ? (\n          <Alert variant=\"destructive\">\n            <XCircle className=\"h-4 w-4\" />\n            <AlertDescription>\n              <strong>Verification Failed</strong>\n              <p className=\"text-sm mt-1\">\n                Unfortunately, we couldn't verify your account. Please contact support for more information.\n              </p>\n            </AlertDescription>\n          </Alert>\n        ) : (\n          <Alert className=\"border-amber-200 bg-amber-50\">\n            <AlertTriangle className=\"h-4 w-4 text-amber-600\" />\n            <AlertDescription className=\"text-amber-900\">\n              <strong>Additional Review Required</strong>\n              <p className=\"text-sm mt-1\">\n                Your application is under additional review. We'll contact you within 48 hours.\n              </p>\n            </AlertDescription>\n          </Alert>\n        )}\n\n        {/* Timeline */}\n        <div className=\"border-t pt-4\">\n          <h4 className=\"font-semibold text-slate-900 mb-3\">Verification Process</h4>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start gap-3\">\n              <div className={`w-2 h-2 rounded-full mt-2 ${kycStatus !== 'pending' ? 'bg-emerald-500' : 'bg-slate-300'}`}></div>\n              <div>\n                <p className=\"text-sm font-medium text-slate-900\">Step 1: Identity Verification</p>\n                <p className=\"text-xs text-slate-600\">ID scan and liveness detection (5-15 minutes)</p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <div className={`w-2 h-2 rounded-full mt-2 ${bgcStatus !== 'pending' ? 'bg-emerald-500' : 'bg-slate-300'}`}></div>\n              <div>\n                <p className=\"text-sm font-medium text-slate-900\">Step 2: Background Check</p>\n                <p className=\"text-xs text-slate-600\">Criminal records and employment verification (24-48 hours)</p>\n              </div>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <div className={`w-2 h-2 rounded-full mt-2 ${(kycStatus === 'approved' && bgcStatus === 'approved') ? 'bg-emerald-500' : 'bg-slate-300'}`}></div>\n              <div>\n                <p className=\"text-sm font-medium text-slate-900\">Step 3: Approval & Activation</p>\n                <p className=\"text-xs text-slate-600\">Account activated and ready to accept bookings</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\verification\\VerificationService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\components\\verification\\VerificationTimeline.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\hooks\\use-mobile.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\hooks\\useAuth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\hooks\\useData.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\AuthContext.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":132,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { appParams } from '@/lib/app-params';\r\nimport { createAxiosClient } from '@base44/sdk/dist/utils/axios-client';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isLoadingAuth, setIsLoadingAuth] = useState(true);\r\n  const [isLoadingPublicSettings, setIsLoadingPublicSettings] = useState(true);\r\n  const [authError, setAuthError] = useState(null);\r\n  const [appPublicSettings, setAppPublicSettings] = useState(null); // Contains only { id, public_settings }\r\n\r\n  useEffect(() => {\r\n    checkAppState();\r\n  }, []);\r\n\r\n  const checkAppState = async () => {\r\n    try {\r\n      setIsLoadingPublicSettings(true);\r\n      setAuthError(null);\r\n      \r\n      // First, check app public settings (with token if available)\r\n      // This will tell us if auth is required, user not registered, etc.\r\n      const appClient = createAxiosClient({\r\n        baseURL: `/api/apps/public`,\r\n        headers: {\r\n          'X-App-Id': appParams.appId\r\n        },\r\n        token: appParams.token, // Include token if available\r\n        interceptResponses: true\r\n      });\r\n      \r\n      try {\r\n        const publicSettings = await appClient.get(`/prod/public-settings/by-id/${appParams.appId}`);\r\n        setAppPublicSettings(publicSettings);\r\n        \r\n        // If we got the app public settings successfully, check if user is authenticated\r\n        if (appParams.token) {\r\n          await checkUserAuth();\r\n        } else {\r\n          setIsLoadingAuth(false);\r\n          setIsAuthenticated(false);\r\n        }\r\n        setIsLoadingPublicSettings(false);\r\n      } catch (appError) {\r\n        console.error('App state check failed:', appError);\r\n        \r\n        // Handle app-level errors\r\n        if (appError.status === 403 && appError.data?.extra_data?.reason) {\r\n          const reason = appError.data.extra_data.reason;\r\n          if (reason === 'auth_required') {\r\n            setAuthError({\r\n              type: 'auth_required',\r\n              message: 'Authentication required'\r\n            });\r\n          } else if (reason === 'user_not_registered') {\r\n            setAuthError({\r\n              type: 'user_not_registered',\r\n              message: 'User not registered for this app'\r\n            });\r\n          } else {\r\n            setAuthError({\r\n              type: reason,\r\n              message: appError.message\r\n            });\r\n          }\r\n        } else {\r\n          setAuthError({\r\n            type: 'unknown',\r\n            message: appError.message || 'Failed to load app'\r\n          });\r\n        }\r\n        setIsLoadingPublicSettings(false);\r\n        setIsLoadingAuth(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Unexpected error:', error);\r\n      setAuthError({\r\n        type: 'unknown',\r\n        message: error.message || 'An unexpected error occurred'\r\n      });\r\n      setIsLoadingPublicSettings(false);\r\n      setIsLoadingAuth(false);\r\n    }\r\n  };\r\n\r\n  const checkUserAuth = async () => {\r\n    try {\r\n      // Now check if the user is authenticated\r\n      setIsLoadingAuth(true);\r\n      const currentUser = await base44.auth.me();\r\n      setUser(currentUser);\r\n      setIsAuthenticated(true);\r\n      setIsLoadingAuth(false);\r\n    } catch (error) {\r\n      console.error('User auth check failed:', error);\r\n      setIsLoadingAuth(false);\r\n      setIsAuthenticated(false);\r\n      \r\n      // If user auth fails, it might be an expired token\r\n      if (error.status === 401 || error.status === 403) {\r\n        setAuthError({\r\n          type: 'auth_required',\r\n          message: 'Authentication required'\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const logout = (shouldRedirect = true) => {\r\n    setUser(null);\r\n    setIsAuthenticated(false);\r\n    \r\n    if (shouldRedirect) {\r\n      // Use the SDK's logout method which handles token cleanup and redirect\r\n      base44.auth.logout(window.location.href);\r\n    } else {\r\n      // Just remove the token without redirect\r\n      base44.auth.logout();\r\n    }\r\n  };\r\n\r\n  const navigateToLogin = () => {\r\n    // Use the SDK's redirectToLogin method\r\n    base44.auth.redirectToLogin(window.location.href);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ \r\n      user, \r\n      isAuthenticated, \r\n      isLoadingAuth,\r\n      isLoadingPublicSettings,\r\n      authError,\r\n      appPublicSettings,\r\n      logout,\r\n      navigateToLogin,\r\n      checkAppState\r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\NavigationTracker.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\PageNotFound.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":23,"column":9}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useLocation } from 'react-router-dom';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { useQuery } from '@tanstack/react-query';\r\n\r\n\r\nexport default function PageNotFound({}) {\r\n    const location = useLocation();\r\n    const pageName = location.pathname.substring(1);\r\n\r\n    const { data: authData, isFetched } = useQuery({\r\n        queryKey: ['user'],\r\n        queryFn: async () => {\r\n            try {\r\n                const user = await base44.auth.me();\r\n                return { user, isAuthenticated: true };\r\n            } catch (error) {\r\n                return { user: null, isAuthenticated: false };\r\n            }\r\n        }\r\n    });\r\n    \r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center p-6 bg-slate-50\">\r\n            <div className=\"max-w-md w-full\">\r\n                <div className=\"text-center space-y-6\">\r\n                    {/* 404 Error Code */}\r\n                    <div className=\"space-y-2\">\r\n                        <h1 className=\"text-7xl font-light text-slate-300\">404</h1>\r\n                        <div className=\"h-0.5 w-16 bg-slate-200 mx-auto\"></div>\r\n                    </div>\r\n                    \r\n                    {/* Main Message */}\r\n                    <div className=\"space-y-3\">\r\n                        <h2 className=\"text-2xl font-medium text-slate-800\">\r\n                            Page Not Found\r\n                        </h2>\r\n                        <p className=\"text-slate-600 leading-relaxed\">\r\n                            The page <span className=\"font-medium text-slate-700\">\"{pageName}\"</span> could not be found in this application.\r\n                        </p>\r\n                    </div>\r\n                    \r\n                    {/* Admin Note */}\r\n                    {isFetched && authData.isAuthenticated && authData.user?.role === 'admin' && (\r\n                        <div className=\"mt-8 p-4 bg-slate-100 rounded-lg border border-slate-200\">\r\n                            <div className=\"flex items-start space-x-3\">\r\n                                <div className=\"flex-shrink-0 w-5 h-5 rounded-full bg-orange-100 flex items-center justify-center mt-0.5\">\r\n                                    <div className=\"w-2 h-2 rounded-full bg-orange-400\"></div>\r\n                                </div>\r\n                                <div className=\"text-left space-y-1\">\r\n                                    <p className=\"text-sm font-medium text-slate-700\">Admin Note</p>\r\n                                    <p className=\"text-sm text-slate-600 leading-relaxed\">\r\n                                        This could mean that the AI hasn't implemented this page yet. Ask it to implement it in the chat.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {/* Action Button */}\r\n                    <div className=\"pt-6\">\r\n                        <button \r\n                            onClick={() => window.location.href = '/'} \r\n                            className=\"inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500\"\r\n                        >\r\n                            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\" />\r\n                            </svg>\r\n                            Go Home\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\__tests__\\cacheManager.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\__tests__\\errorHandler.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\__tests__\\rateLimiter.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\app-params.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\cacheManager.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\errorHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\query-client.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\rateLimiter.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\lib\\utils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\main.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":7,"column":5}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from '@/App.jsx'\nimport '@/index.css'\n\nReactDOM.createRoot(document.getElementById('root')).render(\n    <App />\n) ","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AIActivityDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AIAssistant.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AIAssistantSettings.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[471,518],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[471,517],"text":""},"desc":"Remove unused variable 'Input'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AIAssistantOnboardingWizard' is defined but never used.","line":15,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":35,"fix":{"range":[814,902],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AIAssistantOnboardingWizard"},"fix":{"range":[821,854],"text":""},"desc":"Remove unused variable 'AIAssistantOnboardingWizard'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AISettingTooltip' is defined but never used.","line":18,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":24,"fix":{"range":[1052,1118],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AISettingTooltip"},"fix":{"range":[1059,1081],"text":""},"desc":"Remove unused variable 'AISettingTooltip'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[2685,2689],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleSchedulingChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":106,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":106,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleSchedulingChange"},"fix":{"range":[5921,6086],"text":""},"desc":"Remove unused variable 'handleSchedulingChange'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleMatchingChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":114,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleMatchingChange"},"fix":{"range":[6090,6251],"text":""},"desc":"Remove unused variable 'handleMatchingChange'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Input } from '@/components/ui/input';\nimport { Loader2, Save, Sparkles, ArrowLeft, MessageSquare, Calendar, Users, Bell } from 'lucide-react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { toast } from 'sonner';\nimport { analytics } from '../components/analytics/AnalyticsService';\nimport AIAssistantOnboardingWizard from '../components/ai/AIAssistantOnboardingWizard';\nimport MessageSettingCard from '../components/ai/MessageSettingCard';\nimport ReliabilityImpactWidget from '../components/ai/ReliabilityImpactWidget';\nimport AISettingTooltip from '../components/ai/AISettingTooltip';\nimport AISchedulingSettings from '../components/ai/AISchedulingSettings';\nimport SmartMatchingSettings from '../components/ai/SmartMatchingSettings';\n\n// Default message templates\nconst DEFAULT_TEMPLATES = {\n  booking_confirmation: \"Hi {client_name}! Your cleaning is confirmed for {date} at {time}. Looking forward to making your space sparkle! - {cleaner_name}\",\n  pre_cleaning_reminder: \"Hi {client_name}! Just a reminder that I'll be cleaning your place tomorrow at {time}. Please ensure access is available. Thanks! - {cleaner_name}\",\n  on_my_way: \"Hi {client_name}! I'm on my way to your place. ETA: {eta} minutes. See you soon! - {cleaner_name}\",\n  post_cleaning_summary: \"Hi {client_name}! Your cleaning is complete. Thank you for trusting me with your space! I hope you love the results. - {cleaner_name}\",\n  review_request: \"Hi {client_name}! I hope you're enjoying your clean space! If you have a moment, I'd really appreciate your feedback. It helps me improve my service. - {cleaner_name}\",\n  tip_request: \"Hi {client_name}! I'm so glad I could help make your space shine! If you were happy with the service, I'd be grateful for a tip. It really helps support my work. - {cleaner_name}\",\n  reengagement: \"Hi {client_name}! I noticed it's been a while since your last cleaning. I'd love to help you get your space refreshed again! {discount_text} - {cleaner_name}\"\n};\n\nexport default function AIAssistantSettings() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [user, setUser] = useState(null);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n  \n  // State for all settings\n  const [communicationSettings, setCommunicationSettings] = useState({});\n  const [schedulingSettings, setSchedulingSettings] = useState({});\n  const [matchingSettings, setMatchingSettings] = useState({});\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        const profile = profiles[0];\n        setCleanerProfile(profile);\n        \n        // Initialize communication settings\n        setCommunicationSettings(profile.communication_settings || {\n          booking_confirmation: { enabled: true, channels: ['email', 'in_app'], custom_template: DEFAULT_TEMPLATES.booking_confirmation },\n          pre_cleaning_reminder: { enabled: true, days_before: 1, channels: ['sms', 'in_app'], custom_template: DEFAULT_TEMPLATES.pre_cleaning_reminder },\n          on_my_way: { enabled: true, channels: ['sms', 'in_app'], include_eta: true, custom_template: DEFAULT_TEMPLATES.on_my_way },\n          post_cleaning_summary: { enabled: true, channels: ['in_app', 'email'], custom_template: DEFAULT_TEMPLATES.post_cleaning_summary },\n          review_request: { enabled: true, hours_after_completion: 24, channels: ['in_app', 'email'], custom_template: DEFAULT_TEMPLATES.review_request },\n          tip_request: { enabled: false, hours_after_completion: 48, channels: ['in_app', 'email'], custom_template: DEFAULT_TEMPLATES.tip_request },\n          reengagement: { enabled: false, inactive_weeks: 8, target_few_bookings: 1, discount_percentage: 0, channels: ['email', 'in_app'], custom_template: DEFAULT_TEMPLATES.reengagement },\n          ai_scheduling_enabled: false,\n          prioritize_gap_filling: true,\n          suggest_days_in_advance: 14,\n          notify_client_not_interested: true\n        });\n\n        // Initialize scheduling settings\n        setSchedulingSettings({\n          ai_scheduling_enabled: profile.communication_settings?.ai_scheduling_enabled || false,\n          prioritize_gap_filling: profile.communication_settings?.prioritize_gap_filling !== false,\n          suggest_days_in_advance: profile.communication_settings?.suggest_days_in_advance || 14\n        });\n\n        // Initialize matching settings\n        setMatchingSettings({\n          specialty_tags: profile.specialty_tags || [],\n          offers_additional_services: profile.offers_additional_services || [],\n          service_locations: profile.service_locations || []\n        });\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Failed to load cleaner profile:', showToast: false });\n      toast.error('Failed to load your settings');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCommunicationChange = (key, value) => {\n    setCommunicationSettings(prev => ({\n      ...prev,\n      [key]: value\n    }));\n    setHasUnsavedChanges(true);\n  };\n\n  const handleSchedulingChange = (key, value) => {\n    setSchedulingSettings(prev => ({\n      ...prev,\n      [key]: value\n    }));\n    setHasUnsavedChanges(true);\n  };\n\n  const handleMatchingChange = (key, value) => {\n    setMatchingSettings(prev => ({\n      ...prev,\n      [key]: value\n    }));\n    setHasUnsavedChanges(true);\n  };\n\n  const handleSave = async () => {\n    if (!cleanerProfile) {\n      toast.error('Profile not found');\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      \n      // Merge communication and scheduling settings\n      const mergedCommunicationSettings = {\n        ...communicationSettings,\n        ...schedulingSettings\n      };\n\n      await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n        communication_settings: mergedCommunicationSettings,\n        specialty_tags: matchingSettings.specialty_tags,\n        offers_additional_services: matchingSettings.offers_additional_services,\n        service_locations: matchingSettings.service_locations\n      });\n\n      toast.success('AI Assistant settings saved successfully!');\n      setHasUnsavedChanges(false);\n      \n      // Track analytics\n      analytics.track('ai_settings_saved', {\n        ai_scheduling_enabled: schedulingSettings.ai_scheduling_enabled,\n        communication_messages_enabled: Object.keys(communicationSettings).filter(k => communicationSettings[k]?.enabled).length,\n        specialties_count: matchingSettings.specialty_tags?.length || 0\n      });\n      \n      // Reload data\n      await loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Failed to save settings:', showToast: false });\n      toast.error('Failed to save settings. Please try again.');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud py-8\">\n      <div className=\"container mx-auto px-4 max-w-6xl\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div>\n            <Button\n              variant=\"ghost\"\n              onClick={() => navigate(createPageUrl('Profile'))}\n              className=\"mb-4\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Profile\n            </Button>\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 brand-gradient rounded-2xl flex items-center justify-center\">\n                <Sparkles className=\"w-7 h-7 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-3xl font-fredoka font-bold text-graphite\">AI Assistant Settings</h1>\n                <p className=\"text-gray-600 font-verdana\">Configure how your AI Assistant helps manage your business</p>\n              </div>\n            </div>\n          </div>\n          \n          <Button\n            onClick={handleSave}\n            disabled={!hasUnsavedChanges || saving}\n            className=\"brand-gradient text-white\"\n          >\n            {saving ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n            Save Changes\n          </Button>\n        </div>\n\n        {/* Reliability Impact Widget */}\n        <div className=\"mb-6\">\n          <ReliabilityImpactWidget cleanerProfile={cleanerProfile} />\n        </div>\n\n        {/* Main Content */}\n        <Tabs defaultValue=\"communication\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-4 bg-white shadow-sm\">\n            <TabsTrigger value=\"communication\" className=\"flex items-center gap-2\">\n              <MessageSquare className=\"w-4 h-4\" />\n              Communication\n            </TabsTrigger>\n            <TabsTrigger value=\"scheduling\" className=\"flex items-center gap-2\">\n              <Calendar className=\"w-4 h-4\" />\n              Scheduling\n            </TabsTrigger>\n            <TabsTrigger value=\"matching\" className=\"flex items-center gap-2\">\n              <Users className=\"w-4 h-4\" />\n              Matching\n            </TabsTrigger>\n            <TabsTrigger value=\"notifications\" className=\"flex items-center gap-2\">\n              <Bell className=\"w-4 h-4\" />\n              Notifications\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Communication Tab */}\n          <TabsContent value=\"communication\" className=\"space-y-4\">\n            <MessageSettingCard\n              title=\"Booking Confirmation\"\n              description=\"Automatically confirm bookings with clients\"\n              settings={communicationSettings.booking_confirmation}\n              onChange={(value) => handleCommunicationChange('booking_confirmation', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.booking_confirmation}\n              tooltipContent={{\n                description: \"Send automatic confirmation messages when a booking is accepted\",\n                benefits: [\"Reduces client anxiety\", \"Looks professional\", \"Decreases no-shows\"],\n                considerations: [\"Requires accurate schedule management\"]\n              }}\n            />\n\n            <MessageSettingCard\n              title=\"Pre-Cleaning Reminder\"\n              description=\"Remind clients about upcoming cleanings\"\n              settings={communicationSettings.pre_cleaning_reminder}\n              onChange={(value) => handleCommunicationChange('pre_cleaning_reminder', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.pre_cleaning_reminder}\n              tooltipContent={{\n                description: \"Send reminders before scheduled cleanings\",\n                benefits: [\"Reduces no-shows by 40%\", \"Ensures access is ready\", \"Professional touch\"],\n                considerations: [\"May be seen as unnecessary by some clients\"]\n              }}\n              timingConfig={{ type: 'days_before', label: 'Send reminder how many days before?' }}\n            />\n\n            <MessageSettingCard\n              title=\"On My Way\"\n              description=\"Notify clients when you're heading to their location\"\n              settings={communicationSettings.on_my_way}\n              onChange={(value) => handleCommunicationChange('on_my_way', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.on_my_way}\n              tooltipContent={{\n                description: \"Let clients know you're en route with estimated arrival time\",\n                benefits: [\"Improves client communication\", \"Reduces anxiety\", \"Shows professionalism\"],\n                considerations: [\"Requires manual triggering or GPS integration\"]\n              }}\n              additionalToggles={[\n                { key: 'include_eta', label: 'Include ETA', description: 'Show estimated time of arrival' }\n              ]}\n            />\n\n            <MessageSettingCard\n              title=\"Post-Cleaning Summary\"\n              description=\"Send a completion message after finishing\"\n              settings={communicationSettings.post_cleaning_summary}\n              onChange={(value) => handleCommunicationChange('post_cleaning_summary', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.post_cleaning_summary}\n              tooltipContent={{\n                description: \"Notify clients when cleaning is complete\",\n                benefits: [\"Professional closure\", \"Prompts reviews\", \"Client satisfaction\"],\n                considerations: [\"Should be sent after photos are uploaded\"]\n              }}\n            />\n\n            <MessageSettingCard\n              title=\"Review Request\"\n              description=\"Ask satisfied clients for reviews\"\n              settings={communicationSettings.review_request}\n              onChange={(value) => handleCommunicationChange('review_request', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.review_request}\n              tooltipContent={{\n                description: \"Request feedback after successful cleanings\",\n                benefits: [\"Increases review count\", \"Improves rating visibility\", \"Shows you care\"],\n                considerations: [\"Don't request too soon after completion\"]\n              }}\n              timingConfig={{ type: 'hours_after', label: 'Send request how many hours after completion?' }}\n            />\n\n            <MessageSettingCard\n              title=\"Tip Request\"\n              description=\"Politely request tips from satisfied clients\"\n              settings={communicationSettings.tip_request}\n              onChange={(value) => handleCommunicationChange('tip_request', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.tip_request}\n              tooltipContent={{\n                description: \"Ask for tips after excellent service\",\n                benefits: [\"Can increase earnings\", \"Shows value of your work\"],\n                considerations: [\"Use sparingly\", \"Only after great reviews\", \"May feel pushy\"]\n              }}\n              timingConfig={{ type: 'hours_after', label: 'Send request how many hours after completion?' }}\n            />\n\n            <MessageSettingCard\n              title=\"Re-engagement Campaign\"\n              description=\"Win back inactive clients with personalized messages\"\n              settings={communicationSettings.reengagement}\n              onChange={(value) => handleCommunicationChange('reengagement', value)}\n              defaultTemplate={DEFAULT_TEMPLATES.reengagement}\n              tooltipContent={{\n                description: \"Automatically reach out to clients who haven't booked in a while\",\n                benefits: [\"Recovers lost clients\", \"Increases booking rate\", \"Shows you care\"],\n                considerations: [\"Can seem automated if overused\", \"May annoy some clients\"]\n              }}\n              additionalToggles={[\n                { key: 'discount_percentage', label: 'Offer Discount (%)', description: 'Optional discount to incentivize rebooking' }\n              ]}\n            />\n          </TabsContent>\n\n          {/* Scheduling Tab */}\n          <TabsContent value=\"scheduling\">\n            <AISchedulingSettings\n              settings={schedulingSettings}\n              onChange={(newSettings) => {\n                setSchedulingSettings(newSettings);\n                setHasUnsavedChanges(true);\n              }}\n              cleanerProfile={cleanerProfile}\n            />\n          </TabsContent>\n\n          {/* Matching Tab */}\n          <TabsContent value=\"matching\">\n            <SmartMatchingSettings\n              settings={matchingSettings}\n              onChange={(newSettings) => {\n                setMatchingSettings(newSettings);\n                setHasUnsavedChanges(true);\n              }}\n            />\n          </TabsContent>\n\n          {/* Notifications Tab */}\n          <TabsContent value=\"notifications\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka\">Notification Preferences</CardTitle>\n                <CardDescription>Manage how and when you receive notifications</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex items-start justify-between p-4 bg-gray-50 rounded-lg\">\n                  <div className=\"flex-1\">\n                    <Label htmlFor=\"not-interested\" className=\"font-fredoka cursor-pointer\">\n                      Client \"Not Interested\" Alerts\n                    </Label>\n                    <p className=\"text-sm text-gray-600 font-verdana mt-1\">\n                      Receive notifications when clients decline AI scheduling suggestions\n                    </p>\n                  </div>\n                  <Switch\n                    id=\"not-interested\"\n                    checked={communicationSettings?.notify_client_not_interested !== false}\n                    onCheckedChange={(checked) => {\n                      setCommunicationSettings(prev => ({\n                        ...prev,\n                        notify_client_not_interested: checked\n                      }));\n                      setHasUnsavedChanges(true);\n                    }}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Sticky Save Button (Mobile) */}\n      {hasUnsavedChanges && (\n        <div className=\"fixed bottom-0 left-0 right-0 p-4 bg-white border-t shadow-lg md:hidden\">\n          <Button\n            onClick={handleSave}\n            disabled={saving}\n            className=\"w-full brand-gradient text-white\"\n          >\n            {saving ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n            Save All Changes\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AIAssistantTestGuide.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Tabs' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14,"fix":{"range":[226,232],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Tabs"},"fix":{"range":[227,232],"text":""},"desc":"Remove unused variable 'Tabs'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsContent' is defined but never used.","line":5,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":27,"fix":{"range":[232,245],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsContent"},"fix":{"range":[231,244],"text":""},"desc":"Remove unused variable 'TabsContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsList' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":37,"fix":{"range":[245,255],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsList"},"fix":{"range":[244,254],"text":""},"desc":"Remove unused variable 'TabsList'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsTrigger' is defined but never used.","line":5,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":50,"fix":{"range":[254,267],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsTrigger"},"fix":{"range":[254,267],"text":""},"desc":"Remove unused variable 'TabsTrigger'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":7,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47,"fix":{"range":[341,356],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[340,355],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":7,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":57,"fix":{"range":[356,366],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[355,365],"text":""},"desc":"Remove unused variable 'Calendar'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  CheckCircle, Circle, Sparkles, MessageSquare, Calendar, \n  Target, Bell, Code, Users, Settings \n} from 'lucide-react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\n\nexport default function AIAssistantTestGuide() {\n  const navigate = useNavigate();\n  const [completedTests, setCompletedTests] = useState({});\n\n  const toggleTest = (testId) => {\n    setCompletedTests(prev => ({ ...prev, [testId]: !prev[testId] }));\n  };\n\n  const testSections = [\n    {\n      id: 'onboarding',\n      title: '1. Onboarding Flow',\n      icon: Sparkles,\n      color: 'text-purple-600',\n      tests: [\n        {\n          id: 'onboarding-1',\n          title: 'First-Time Cleaner Experience',\n          steps: [\n            'Clear browser localStorage for your app (DevTools ‚Üí Application ‚Üí Local Storage)',\n            'Logout and login as a NEW cleaner account (or one that hasn\\'t seen AI setup)',\n            'Navigate to Cleaner Dashboard',\n            'Verify \"Meet Your AI Assistant\" guide appears automatically',\n            'Review the 4 feature cards (Communication, Scheduling, Matching, Insights)',\n            'Check the stats banner shows \"+30% Earnings\", \"5 hrs/wk\", \"4.8‚òÖ\"',\n            'Click \"Start Setup\" to launch the wizard'\n          ]\n        },\n        {\n          id: 'onboarding-2',\n          title: '6-Step Wizard Flow',\n          steps: [\n            'Step 0: See AI Feature Showcase with 4 tabs',\n            'Step 1: Welcome screen with AI capabilities list',\n            'Step 2: Schedule optimization settings (enable AI scheduling, gap filling)',\n            'Step 3: Communication settings (confirmations, reminders, channels)',\n            'Step 4: Specialties & services selection',\n            'Step 5: Completion summary with settings review',\n            'Verify \"Complete Setup\" saves settings and closes wizard',\n            'Confirm wizard doesn\\'t reappear on page refresh'\n          ]\n        },\n        {\n          id: 'onboarding-3',\n          title: 'Re-Launch Capability',\n          steps: [\n            'Go to AI Assistant Settings page',\n            'Click \"View AI Guide\" button in header',\n            'Verify onboarding wizard re-launches',\n            'Test \"Maybe Later\" skip button',\n            'Confirm wizard closes without saving'\n          ]\n        }\n      ]\n    },\n    {\n      id: 'settings',\n      title: '2. Settings Page',\n      icon: Settings,\n      color: 'text-blue-600',\n      tests: [\n        {\n          id: 'settings-1',\n          title: 'Communication Tab',\n          steps: [\n            'Navigate to AI Assistant Settings',\n            'Verify 7 message types visible (Booking Confirmation, Pre-Cleaning Reminder, On My Way, Post-Cleaning Summary, Review Request, Tip Request, Re-engagement)',\n            'Each message card shows: enable toggle, channels selection, custom template field',\n            'Look for AIImpactExplainer badges next to titles',\n            'Edit a template and watch live preview update',\n            'Verify preview shows example with {client_name}, {date}, {time} replaced',\n            'Test timing controls (days_before, hours_after_completion)',\n            'Save changes and reload page to confirm persistence'\n          ]\n        },\n        {\n          id: 'settings-2',\n          title: 'Scheduling Tab',\n          steps: [\n            'Switch to Scheduling tab',\n            'Test \"Enable AI Scheduling\" toggle',\n            'Verify \"Prioritize Gap Filling\" option appears when enabled',\n            'Check \"Suggest Days in Advance\" slider (1-30 days)',\n            'Look for tooltips explaining each setting',\n            'Save and verify settings persist'\n          ]\n        },\n        {\n          id: 'settings-3',\n          title: 'Matching Tab',\n          steps: [\n            'Go to Matching tab',\n            'Review specialty tags selection',\n            'Test additional services checkboxes',\n            'Verify settings save correctly'\n          ]\n        },\n        {\n          id: 'settings-4',\n          title: 'Notifications Tab',\n          steps: [\n            'Navigate to Notifications tab',\n            'Test notification preference toggles',\n            'Verify \"Notify on client not interested\" setting',\n            'Save and confirm persistence'\n          ]\n        }\n      ]\n    },\n    {\n      id: 'dashboard',\n      title: '3. Dashboard Widgets',\n      icon: Users,\n      color: 'text-green-600',\n      tests: [\n        {\n          id: 'dashboard-1',\n          title: 'AI Insights Widget',\n          steps: [\n            'Go to Cleaner Dashboard',\n            'Locate \"AI Insights\" widget',\n            'Verify it shows: Next Best Action, Schedule Optimization Alert, Performance Snapshot',\n            'Check Recent AI Activity section',\n            'Click \"View Full Dashboard\" button ‚Üí navigates to AIActivityDashboard',\n            'Click \"AI Settings\" button ‚Üí navigates to AIAssistantSettings'\n          ]\n        },\n        {\n          id: 'dashboard-2',\n          title: 'AI Todo List Widget',\n          steps: [\n            'Find \"AI To-Do List\" widget on dashboard',\n            'Verify it shows personalized tasks',\n            'Test checkbox to mark tasks complete',\n            'Click action buttons to navigate to relevant pages',\n            'If no tasks, verify \"All caught up!\" message appears'\n          ]\n        }\n      ]\n    },\n    {\n      id: 'suggestions',\n      title: '4. AI Suggestion Flags',\n      icon: Target,\n      color: 'text-amber-600',\n      tests: [\n        {\n          id: 'suggestions-1',\n          title: 'Schedule Page Flags',\n          steps: [\n            'Navigate to Cleaner Schedule page',\n            'Look for AI badges or tooltips on job cards',\n            'Check for \"AI Suggested\" indicators on optimal time slots',\n            'Verify gap-filling suggestions appear between bookings'\n          ]\n        },\n        {\n          id: 'suggestions-2',\n          title: 'Inbox AI Features',\n          steps: [\n            'Go to Inbox page',\n            'Check for AI-generated message summaries',\n            'Look for AI response suggestions',\n            'Verify conversation insights appear'\n          ]\n        }\n      ]\n    },\n    {\n      id: 'backend',\n      title: '5. Backend Automations',\n      icon: Code,\n      color: 'text-red-600',\n      tests: [\n        {\n          id: 'backend-1',\n          title: 'Automated Messages',\n          steps: [\n            'Create a test booking as a client',\n            'Accept booking as cleaner',\n            'Verify booking confirmation message sent (check email/SMS/in-app)',\n            'Wait for pre-cleaning reminder (or manually trigger cronPreCleaningReminders)',\n            'Complete a booking',\n            'Check for post-cleaning summary',\n            'Wait 24 hours for review request (or manually trigger cronReviewRequests)',\n            'Wait 48 hours for tip request if enabled (or manually trigger cronTipRequests)'\n          ]\n        },\n        {\n          id: 'backend-2',\n          title: 'SMS Integration',\n          steps: [\n            'Ensure Twilio credentials are set (TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, TWILIO_PHONE_NUMBER)',\n            'Enable SMS channel in communication settings',\n            'Trigger an automated message',\n            'Verify SMS received on client\\'s phone number',\n            'Check MessageDeliveryLog entity for delivery status'\n          ]\n        },\n        {\n          id: 'backend-3',\n          title: 'Cron Functions',\n          steps: [\n            'Check scheduled tasks are running: cronPreCleaningReminders, cronReviewRequests, cronTipRequests',\n            'Verify they run at correct intervals',\n            'Check logs for successful executions',\n            'Test edge cases: bookings with missing data, invalid phone numbers'\n          ]\n        }\n      ]\n    },\n    {\n      id: 'analytics',\n      title: '6. Analytics Tracking',\n      icon: Bell,\n      color: 'text-indigo-600',\n      tests: [\n        {\n          id: 'analytics-1',\n          title: 'Event Tracking',\n          steps: [\n            'Complete AI onboarding ‚Üí verify \"ai_onboarding_completed\" event tracked',\n            'Change AI settings ‚Üí verify \"ai_settings_updated\" event tracked',\n            'Accept AI-suggested booking ‚Üí verify \"ai_booking_accepted\" event tracked',\n            'Check AnalyticsEvent entity for all tracked events',\n            'Verify events include proper metadata (user_email, timestamp, details)'\n          ]\n        }\n      ]\n    }\n  ];\n\n  const clearLocalStorage = () => {\n    if (confirm('This will clear all localStorage for testing. Continue?')) {\n      localStorage.clear();\n      alert('localStorage cleared! Please logout and login again.');\n    }\n  };\n\n  const totalTests = testSections.reduce((sum, section) => sum + section.tests.length, 0);\n  const completedCount = Object.values(completedTests).filter(Boolean).length;\n  const progressPercent = (completedCount / totalTests) * 100;\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-5xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2 flex items-center gap-3\">\n                <Sparkles className=\"w-10 h-10 text-purple-600\" />\n                AI Assistant Testing Guide\n              </h1>\n              <p className=\"text-gray-600 font-verdana\">\n                Complete step-by-step testing checklist for all AI features\n              </p>\n            </div>\n            <Button onClick={() => navigate(createPageUrl('CleanerDashboard'))} variant=\"outline\">\n              Back to Dashboard\n            </Button>\n          </div>\n\n          {/* Progress */}\n          <Card className=\"border-2 border-purple-200 bg-gradient-to-r from-purple-50 to-blue-50\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"font-fredoka font-semibold text-graphite\">Testing Progress</span>\n                <span className=\"font-fredoka text-purple-600 font-bold\">{completedCount}/{totalTests} Tests</span>\n              </div>\n              <div className=\"w-full bg-gray-200 rounded-full h-3\">\n                <div \n                  className=\"bg-gradient-to-r from-purple-500 to-blue-500 h-3 rounded-full transition-all duration-500\"\n                  style={{ width: `${progressPercent}%` }}\n                />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Quick Actions */}\n        <div className=\"grid md:grid-cols-3 gap-4 mb-8\">\n          <Button\n            onClick={clearLocalStorage}\n            variant=\"outline\"\n            className=\"h-auto py-4 flex-col\"\n          >\n            <Code className=\"w-6 h-6 mb-2\" />\n            <span className=\"font-fredoka\">Clear localStorage</span>\n            <span className=\"text-xs text-gray-500\">Reset onboarding state</span>\n          </Button>\n          <Button\n            onClick={() => navigate(createPageUrl('AIAssistantSettings'))}\n            variant=\"outline\"\n            className=\"h-auto py-4 flex-col\"\n          >\n            <Settings className=\"w-6 h-6 mb-2\" />\n            <span className=\"font-fredoka\">AI Settings</span>\n            <span className=\"text-xs text-gray-500\">Test settings page</span>\n          </Button>\n          <Button\n            onClick={() => navigate(createPageUrl('CleanerDashboard'))}\n            variant=\"outline\"\n            className=\"h-auto py-4 flex-col\"\n          >\n            <Users className=\"w-6 h-6 mb-2\" />\n            <span className=\"font-fredoka\">Dashboard</span>\n            <span className=\"text-xs text-gray-500\">Test widgets</span>\n          </Button>\n        </div>\n\n        {/* Test Sections */}\n        <div className=\"space-y-6\">\n          {testSections.map((section) => {\n            const Icon = section.icon;\n            return (\n              <Card key={section.id} className=\"border-2\">\n                <CardHeader className=\"bg-gradient-to-r from-gray-50 to-gray-100\">\n                  <CardTitle className=\"flex items-center gap-3 font-fredoka\">\n                    <Icon className={`w-6 h-6 ${section.color}`} />\n                    {section.title}\n                    <Badge variant=\"outline\" className=\"ml-auto\">\n                      {section.tests.filter(t => completedTests[t.id]).length}/{section.tests.length}\n                    </Badge>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"pt-6\">\n                  <div className=\"space-y-6\">\n                    {section.tests.map((test) => (\n                      <div key={test.id} className=\"border-l-4 border-gray-200 pl-4\">\n                        <div className=\"flex items-start gap-3 mb-3\">\n                          <button\n                            onClick={() => toggleTest(test.id)}\n                            className=\"mt-1\"\n                          >\n                            {completedTests[test.id] ? (\n                              <CheckCircle className=\"w-6 h-6 text-green-600\" />\n                            ) : (\n                              <Circle className=\"w-6 h-6 text-gray-400\" />\n                            )}\n                          </button>\n                          <div className=\"flex-1\">\n                            <h3 className=\"font-fredoka font-semibold text-graphite mb-2\">\n                              {test.title}\n                            </h3>\n                            <ol className=\"space-y-2 text-sm font-verdana text-gray-700\">\n                              {test.steps.map((step, idx) => (\n                                <li key={idx} className=\"flex gap-2\">\n                                  <span className=\"font-semibold text-purple-600 min-w-[24px]\">\n                                    {idx + 1}.\n                                  </span>\n                                  <span>{step}</span>\n                                </li>\n                              ))}\n                            </ol>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        {/* Footer */}\n        <Card className=\"mt-8 border-2 border-green-200 bg-green-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <CheckCircle className=\"w-6 h-6 text-green-600 mt-1\" />\n              <div>\n                <p className=\"font-fredoka font-semibold text-graphite mb-2\">\n                  Testing Complete?\n                </p>\n                <p className=\"text-sm font-verdana text-gray-700 mb-3\">\n                  Once all tests pass, the AI Assistant is production-ready! Report any issues or unexpected behavior.\n                </p>\n                <div className=\"flex gap-2\">\n                  <Badge className=\"bg-green-600 text-white\">All Features Implemented</Badge>\n                  <Badge className=\"bg-blue-600 text-white\">SMS Integrated</Badge>\n                  <Badge className=\"bg-purple-600 text-white\">Analytics Tracked</Badge>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AICommunicationSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AboutUs.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdditionalServices.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[385,392],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[386,392],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":8,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[392,410],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[391,409],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertTitle' is defined but never used.","line":8,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"fix":{"range":[409,421],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertTitle"},"fix":{"range":[409,421],"text":""},"desc":"Remove unused variable 'AlertTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":13,"fix":{"range":[570,584],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[569,583],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":22,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":7,"fix":{"range":[666,674],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[665,673],"text":""},"desc":"Remove unused variable 'Info'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ArrowLeft' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":12,"fix":{"range":[705,718],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ArrowLeft"},"fix":{"range":[704,717],"text":""},"desc":"Remove unused variable 'ArrowLeft'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookingData' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":177,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":177,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookingData"},"fix":{"range":[4781,4792],"text":""},"desc":"Remove unused variable 'bookingData'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport {\n  Sparkles,\n  DollarSign,\n  Home,\n  Zap,\n  Wind,\n  ChefHat,\n  Grid,\n  Refrigerator,\n  Lightbulb,\n  Package,\n  Info,\n  Plus,\n  Minus,\n  ArrowRight,\n  ArrowLeft,\n  ShoppingCart\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nconst ADDITIONAL_SERVICES = [\n  {\n    key: 'windows',\n    icon: Wind,\n    name: 'Windows',\n    description: 'Interior and exterior window cleaning',\n    priceRange: '$3-7',\n    unit: 'per window',\n    credits: '30-70 credits',\n    notes: 'Price varies by window size and accessibility',\n    tips: [\n      'Charge more for exterior windows (higher floors)',\n      'Large picture windows warrant higher rates',\n      'Include screens in your pricing'\n    ],\n    color: '#66B3FF',\n    bgColor: '#EFF6FF'\n  },\n  {\n    key: 'blinds',\n    icon: Grid,\n    name: 'Blinds',\n    description: 'Dusting and cleaning window blinds',\n    priceRange: '$10',\n    unit: 'per set (2 blinds)',\n    credits: '100 credits',\n    notes: 'Set = 2 individual blinds',\n    tips: [\n      'Deep cleaning may cost more',\n      'Consider time for venetian vs. vertical blinds',\n      'Charge extra for removal/reinstallation'\n    ],\n    color: '#00D4FF',\n    bgColor: '#ECFEFF'\n  },\n  {\n    key: 'oven',\n    icon: ChefHat,\n    name: 'Oven',\n    description: 'Deep cleaning of oven interior and racks',\n    priceRange: '$20-40',\n    unit: 'per oven',\n    credits: '200-400 credits',\n    notes: 'Depends on level of buildup and oven size',\n    tips: [\n      'Heavily soiled ovens = higher end of range',\n      'Include stovetop for complete service',\n      'Self-cleaning ovens may take less time'\n    ],\n    color: '#F59E0B',\n    bgColor: '#FFFBEB'\n  },\n  {\n    key: 'refrigerator',\n    icon: Refrigerator,\n    name: 'Refrigerator',\n    description: 'Interior cleaning, shelves, and drawers',\n    priceRange: '$15-30',\n    unit: 'per refrigerator',\n    credits: '150-300 credits',\n    notes: 'Full interior and exterior cleaning',\n    tips: [\n      'Charge more for deep organization',\n      'Consider if client empties fridge first',\n      'Include freezer for complete service'\n    ],\n    color: '#28C76F',\n    bgColor: '#F0FDF4'\n  },\n  {\n    key: 'light_fixtures',\n    icon: Lightbulb,\n    name: 'Light Fixtures',\n    description: 'Dusting and cleaning light fixtures and ceiling fans',\n    priceRange: '$5-15',\n    unit: 'per fixture',\n    credits: '50-150 credits',\n    notes: 'Varies by fixture complexity',\n    tips: [\n      'Chandeliers = higher rate',\n      'Ceiling fans require ladder work',\n      'Consider accessibility and height'\n    ],\n    color: '#A855F7',\n    bgColor: '#FAF5FF'\n  },\n  {\n    key: 'inside_cabinets',\n    icon: Package,\n    name: 'Inside Cabinets',\n    description: 'Cleaning inside kitchen or bathroom cabinets',\n    priceRange: '$10-20',\n    unit: 'per cabinet section',\n    credits: '100-200 credits',\n    notes: 'Client should empty cabinets first',\n    tips: [\n      'Charge more if organizing included',\n      'Kitchen vs. bathroom pricing',\n      'Set expectations about emptying'\n    ],\n    color: '#EC4899',\n    bgColor: '#FDF2F8'\n  },\n  {\n    key: 'baseboards',\n    icon: Home,\n    name: 'Baseboards',\n    description: 'Detailed baseboard cleaning throughout home',\n    priceRange: '$20-40',\n    unit: 'per home',\n    credits: '200-400 credits',\n    notes: 'Full home baseboard service',\n    tips: [\n      'Price by square footage',\n      'Include in deep clean packages',\n      'Charge per room for spot cleaning'\n    ],\n    color: '#14B8A6',\n    bgColor: '#F0FDFA'\n  },\n  {\n    key: 'laundry',\n    icon: Zap,\n    name: 'Laundry',\n    description: 'Wash, dry, fold client laundry',\n    priceRange: '$15-25',\n    unit: 'per load',\n    credits: '150-250 credits',\n    notes: 'Time-based service add-on',\n    tips: [\n      'Consider machine availability',\n      'Set expectations for timing',\n      'Charge more for ironing'\n    ],\n    color: '#F43F5E',\n    bgColor: '#FFF1F2'\n  }\n];\n\nexport default function AdditionalServices() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const cleanerEmail = searchParams.get('cleaner');\n  \n  const [cleaner, setCleaner] = useState(null);\n  const [bookingData, setBookingData] = useState(null);\n  const [selections, setSelections] = useState({});\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const savedBooking = localStorage.getItem('bookingDraft');\n      if (!savedBooking || !cleanerEmail) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setBookingData(JSON.parse(savedBooking));\n\n      // Load cleaner's pricing\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n      if (cleanerProfiles.length > 0) {\n        setCleaner(cleanerProfiles[0]);\n      }\n\n      // Load existing selections if any\n      const savedAddOns = localStorage.getItem('bookingAddOns');\n      if (savedAddOns) {\n        setSelections(JSON.parse(savedAddOns));\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const updateQuantity = (serviceKey, change) => {\n    setSelections(prev => {\n      const current = prev[serviceKey] || 0;\n      const newValue = Math.max(0, current + change);\n      if (newValue === 0) {\n        const { [serviceKey]: _, ...rest } = prev;\n        return rest;\n      }\n      return { ...prev, [serviceKey]: newValue };\n    });\n  };\n\n  const getServicePrice = (serviceKey) => {\n    if (!cleaner?.additional_service_pricing) return 0;\n    return cleaner.additional_service_pricing[serviceKey] || 0;\n  };\n\n  const calculateTotal = () => {\n    let total = 0;\n    Object.keys(selections).forEach(key => {\n      total += getServicePrice(key) * selections[key];\n    });\n    return total;\n  };\n\n  const handleContinue = () => {\n    localStorage.setItem('bookingAddOns', JSON.stringify(selections));\n    navigate(createPageUrl(`MatchedCleaners?cleaner=${cleanerEmail}`));\n  };\n\n  const handleSkip = () => {\n    localStorage.removeItem('bookingAddOns');\n    navigate(createPageUrl(`MatchedCleaners?cleaner=${cleanerEmail}`));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 brand-gradient rounded-full mx-auto mb-4 flex items-center justify-center animate-pulse\">\n            <Sparkles className=\"w-8 h-8 text-white\" />\n          </div>\n          <p className=\"font-fredoka text-gray-600\">Loading services...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const totalCredits = calculateTotal();\n  const selectedCount = Object.keys(selections).length;\n\n  return (\n    <div className=\"min-h-screen p-4 md:p-6\" style={{ background: 'linear-gradient(to bottom, #66B3FF 0%, #F7F9FC 100%)' }}>\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center mb-8\"\n        >\n          <Badge className=\"mb-4 px-6 py-2 text-lg rounded-full font-fredoka shadow-lg\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)', color: 'white' }}>\n            <ShoppingCart className=\"w-5 h-5 mr-2\" />\n            Add-On Services\n          </Badge>\n          <h1 className=\"text-3xl md:text-4xl font-fredoka font-bold text-white mb-3\">\n            Enhance Your Cleaning\n          </h1>\n          <p className=\"text-lg text-white font-verdana\" style={{ opacity: 0.9 }}>\n            Select any additional services you'd like to add\n          </p>\n        </motion.div>\n\n        {/* Summary Card */}\n        {selectedCount > 0 && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            className=\"mb-6\"\n          >\n            <Card className=\"border-0 shadow-xl rounded-2xl bg-gradient-to-r from-purple-500 to-blue-500 text-white\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"font-fredoka font-bold text-2xl\">{totalCredits} credits</p>\n                    <p className=\"text-sm opacity-90\">‚âà ${(totalCredits / 10).toFixed(2)} ‚Ä¢ {selectedCount} add-on{selectedCount > 1 ? 's' : ''} selected</p>\n                  </div>\n                  <ShoppingCart className=\"w-10 h-10 opacity-80\" />\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Services Grid */}\n        <div className=\"grid sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 mb-8\">\n          {ADDITIONAL_SERVICES.map((service, idx) => {\n            const quantity = selections[service.key] || 0;\n            const servicePrice = getServicePrice(service.key);\n            const isSelected = quantity > 0;\n\n            return (\n              <motion.div\n                key={service.key}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card\n                  className={`h-full border-2 shadow-xl hover:shadow-2xl transition-all duration-300 rounded-2xl ${isSelected ? 'ring-4 ring-opacity-50' : ''}`}\n                  style={{ \n                    backgroundColor: service.bgColor,\n                    borderColor: isSelected ? service.color : 'transparent',\n                    ringColor: service.color\n                  }}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between mb-3\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center shadow-md\" style={{ backgroundColor: service.color }}>\n                        <service.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      {isSelected && (\n                        <Badge className=\"rounded-full font-fredoka font-bold animate-pulse\" style={{ backgroundColor: service.color, color: 'white' }}>\n                          {quantity}√ó\n                        </Badge>\n                      )}\n                    </div>\n                    <CardTitle className=\"font-fredoka text-xl mb-1\" style={{ color: '#1D2533' }}>\n                      {service.name}\n                    </CardTitle>\n                    <p className=\"text-xs text-gray-600 font-verdana\">\n                      {service.description}\n                    </p>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-3\">\n                      <div className=\"p-3 rounded-lg bg-white bg-opacity-60\">\n                        <div className=\"flex items-center justify-between mb-1\">\n                          <span className=\"text-xs font-verdana text-gray-600\">Price per {service.unit.toLowerCase()}</span>\n                        </div>\n                        <p className=\"font-fredoka font-bold text-lg\" style={{ color: service.color }}>\n                          {servicePrice} credits\n                        </p>\n                        <p className=\"text-xs text-gray-500\">‚âà ${(servicePrice / 10).toFixed(2)}</p>\n                      </div>\n\n                      {/* Quantity Selector */}\n                      <div className=\"flex items-center gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => updateQuantity(service.key, -1)}\n                          disabled={quantity === 0}\n                          className=\"h-10 w-10 rounded-full p-0 border-2\"\n                          style={{ borderColor: service.color, color: service.color }}\n                        >\n                          <Minus className=\"w-4 h-4\" />\n                        </Button>\n                        \n                        <div className=\"flex-1 text-center\">\n                          <Input\n                            type=\"number\"\n                            min=\"0\"\n                            value={quantity}\n                            onChange={(e) => {\n                              const val = parseInt(e.target.value) || 0;\n                              setSelections(prev => val === 0 ? { ...prev, [service.key]: undefined } : { ...prev, [service.key]: val });\n                            }}\n                            className=\"text-center font-fredoka font-bold text-lg h-10 rounded-full\"\n                            style={{ borderColor: service.color }}\n                          />\n                        </div>\n\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => updateQuantity(service.key, 1)}\n                          className=\"h-10 w-10 rounded-full p-0 border-2\"\n                          style={{ borderColor: service.color, color: service.color, backgroundColor: isSelected ? service.color : 'white' }}\n                        >\n                          <Plus className={`w-4 h-4 ${isSelected ? 'text-white' : ''}`} />\n                        </Button>\n                      </div>\n\n                      {quantity > 0 && (\n                        <motion.div\n                          initial={{ opacity: 0, scale: 0.9 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          className=\"p-3 rounded-lg text-center\" style={{ backgroundColor: service.color }}\n                        >\n                          <p className=\"font-fredoka font-bold text-white\">\n                            = {servicePrice * quantity} credits\n                          </p>\n                          <p className=\"text-xs text-white opacity-90\">\n                            ‚âà ${((servicePrice * quantity) / 10).toFixed(2)}\n                          </p>\n                        </motion.div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </div>\n\n        {/* Action Buttons */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n          className=\"sticky bottom-6 z-10\"\n        >\n          <Card className=\"border-0 shadow-2xl rounded-2xl bg-white\">\n            <CardContent className=\"p-4 md:p-6\">\n              <div className=\"flex flex-col sm:flex-row gap-3\">\n                <Button\n                  onClick={handleSkip}\n                  variant=\"outline\"\n                  size=\"lg\"\n                  className=\"flex-1 rounded-full font-fredoka font-semibold border-2\"\n                >\n                  Skip Add-Ons\n                  <ArrowRight className=\"w-5 h-5 ml-2\" />\n                </Button>\n\n                <Button\n                  onClick={handleContinue}\n                  size=\"lg\"\n                  className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-bold shadow-xl\"\n                >\n                  {selectedCount > 0 ? `Continue with ${selectedCount} Add-On${selectedCount > 1 ? 's' : ''}` : 'Continue'}\n                  <ArrowRight className=\"w-5 h-5 ml-2\" />\n                </Button>\n              </div>\n\n              {selectedCount > 0 && (\n                <div className=\"mt-4 pt-4 border-t-2 border-gray-100\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"font-verdana text-gray-600\">Add-ons Total:</span>\n                    <div className=\"text-right\">\n                      <p className=\"font-fredoka font-bold text-xl text-puretask-blue\">{totalCredits} credits</p>\n                      <p className=\"text-sm text-gray-500\">‚âà ${(totalCredits / 10).toFixed(2)}</p>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AddressVerification.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":14,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":30,"fix":{"range":[672,678],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[672,678],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'googleMapsStaticImage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":130,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":130,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"googleMapsStaticImage"},"fix":{"range":[4570,4824],"text":""},"desc":"Remove unused variable 'googleMapsStaticImage'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { \n  MapPin, Shield, ExternalLink, AlertTriangle, CheckCircle, \n  Eye, Lock, Navigation, Home\n} from 'lucide-react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\n// Fix for default marker icon in react-leaflet\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\nexport default function AddressVerification() {\n  const navigate = useNavigate();\n  const [bookingData, setBookingData] = useState(null);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [confirmed, setConfirmed] = useState({\n    addressCorrect: false,\n    accessInstructions: false,\n    parkingAcknowledged: false,\n    homeSecure: false\n  });\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      // Get booking data from session storage (passed from BookingFlow)\n      const storedData = sessionStorage.getItem('pendingBooking');\n      if (!storedData) {\n        navigate(createPageUrl('BrowseCleaners'));\n        return;\n      }\n\n      const data = JSON.parse(storedData);\n      setBookingData(data);\n\n      // Validate coordinates exist\n      if (!data.latitude || !data.longitude) {\n        setError('Address coordinates are missing. Please go back and re-enter your address.');\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading verification page:', showToast: false });\n      navigate(createPageUrl('BrowseCleaners'));\n    }\n    setLoading(false);\n  };\n\n  const allConfirmed = Object.values(confirmed).every(v => v === true);\n\n  const handleProceed = async () => {\n    if (!allConfirmed) {\n      setError('Please confirm all security checkpoints before proceeding.');\n      return;\n    }\n\n    setError('');\n\n    try {\n      // Create the booking\n      const newBooking = await base44.entities.Booking.create({\n        client_email: user.email,\n        cleaner_email: bookingData.cleanerEmail,\n        date: bookingData.date,\n        start_time: bookingData.time,\n        hours: bookingData.hours,\n        tasks: bookingData.tasks,\n        task_quantities: bookingData.taskQuantities || {},\n        address: bookingData.address,\n        latitude: bookingData.latitude,\n        longitude: bookingData.longitude,\n        product_allergies: bookingData.product_allergies || '',\n        product_preferences: bookingData.product_preferences || '',\n        total_price: bookingData.totalPrice,\n        status: 'available',\n        parking_instructions: bookingData.parkingInstructions || '',\n        entry_instructions: bookingData.entryInstructions || ''\n      });\n\n      // Clear session storage\n      sessionStorage.removeItem('pendingBooking');\n\n      // If recurring booking was requested\n      if (bookingData.wantsRecurring) {\n        sessionStorage.setItem('setupRecurring', JSON.stringify({\n          bookingId: newBooking.id,\n          ...bookingData\n        }));\n      }\n\n      // Proceed to payment\n      navigate(createPageUrl(`PaymentCheckout?bookingId=${newBooking.id}`));\n    } catch (err) {\n      console.error('Error creating booking:', err);\n      setError('Failed to create booking. Please try again.');\n    }\n  };\n\n  if (loading || !bookingData) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-xl text-slate-700\">Loading verification...</p>\n      </div>\n    );\n  }\n\n  const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${bookingData.latitude},${bookingData.longitude}`;\n  const googleMapsStaticImage = `https://maps.googleapis.com/maps/api/staticmap?center=${bookingData.latitude},${bookingData.longitude}&zoom=16&size=600x400&markers=color:red%7C${bookingData.latitude},${bookingData.longitude}&key=YOUR_GOOGLE_MAPS_API_KEY`;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-10\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8 text-center\">\n          <div className=\"flex items-center justify-center gap-3 mb-4\">\n            <Shield className=\"w-12 h-12 text-emerald-500\" />\n            <h1 className=\"text-4xl font-bold text-slate-900\">Address Verification</h1>\n          </div>\n          <p className=\"text-lg text-slate-600\">\n            Please confirm your cleaning location for security purposes\n          </p>\n          <Badge className=\"mt-2 bg-blue-100 text-blue-800 border-blue-200\">\n            <Lock className=\"w-3 h-3 mr-1\" />\n            Secure Verification Step\n          </Badge>\n        </div>\n\n        {error && (\n          <Alert variant=\"destructive\" className=\"mb-6\">\n            <AlertTriangle className=\"w-4 h-4\" />\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        )}\n\n        {/* Address Display */}\n        <Card className=\"mb-6 border-2 border-emerald-200 shadow-xl\">\n          <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <MapPin className=\"w-6 h-6 text-emerald-600\" />\n              Cleaning Location\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div className=\"bg-white p-4 rounded-lg border-2 border-slate-200\">\n                <p className=\"text-sm text-slate-600 mb-1\">Address</p>\n                <p className=\"text-xl font-semibold text-slate-900\">{bookingData.address}</p>\n              </div>\n\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"bg-slate-50 p-3 rounded-lg\">\n                  <p className=\"text-xs text-slate-600 mb-1\">Latitude</p>\n                  <p className=\"font-mono text-sm text-slate-900\">{bookingData.latitude.toFixed(6)}</p>\n                </div>\n                <div className=\"bg-slate-50 p-3 rounded-lg\">\n                  <p className=\"text-xs text-slate-600 mb-1\">Longitude</p>\n                  <p className=\"font-mono text-sm text-slate-900\">{bookingData.longitude.toFixed(6)}</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Interactive Map */}\n        <Card className=\"mb-6 border-0 shadow-xl overflow-hidden\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <Navigation className=\"w-6 h-6 text-blue-600\" />\n                Location Map\n              </CardTitle>\n              <a\n                href={googleMapsUrl}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"flex items-center gap-2 text-blue-600 hover:text-blue-800 transition-colors\"\n              >\n                <span className=\"text-sm font-medium\">Open in Google Maps</span>\n                <ExternalLink className=\"w-4 h-4\" />\n              </a>\n            </div>\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            <div style={{ height: '400px', width: '100%' }}>\n              <MapContainer\n                center={[bookingData.latitude, bookingData.longitude]}\n                zoom={17}\n                style={{ height: '100%', width: '100%' }}\n                scrollWheelZoom={true}\n              >\n                <TileLayer\n                  attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n                  url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                />\n                <Marker position={[bookingData.latitude, bookingData.longitude]}>\n                  <Popup>\n                    <div className=\"text-center p-2\">\n                      <p className=\"font-semibold mb-1\">Cleaning Location</p>\n                      <p className=\"text-xs text-slate-600\">{bookingData.address}</p>\n                    </div>\n                  </Popup>\n                </Marker>\n              </MapContainer>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Street View Link */}\n        <Card className=\"mb-6 bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center gap-4\">\n              <Eye className=\"w-8 h-8 text-purple-600 flex-shrink-0\" />\n              <div className=\"flex-1\">\n                <h3 className=\"font-semibold text-purple-900 mb-1\">View Street Level</h3>\n                <p className=\"text-sm text-purple-700 mb-3\">\n                  See what your property looks like from the street to help your cleaner find it easily\n                </p>\n                <a\n                  href={`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${bookingData.latitude},${bookingData.longitude}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"inline-flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium\"\n                >\n                  <Eye className=\"w-4 h-4\" />\n                  Open Street View\n                  <ExternalLink className=\"w-4 h-4\" />\n                </a>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Security Checkpoints */}\n        <Card className=\"mb-6 border-2 border-amber-200 shadow-xl\">\n          <CardHeader className=\"bg-gradient-to-r from-amber-50 to-yellow-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Shield className=\"w-6 h-6 text-amber-600\" />\n              Security Verification Checklist\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-4\">\n            <Alert className=\"bg-blue-50 border-blue-200\">\n              <AlertDescription className=\"text-blue-900\">\n                <strong>Why we verify:</strong> Address confirmation helps prevent fraud, ensures cleaners arrive at the correct location, and protects both parties.\n              </AlertDescription>\n            </Alert>\n\n            <div className=\"space-y-4\">\n              {/* Checkpoint 1 */}\n              <div className=\"flex items-start gap-3 p-4 rounded-lg border-2 border-slate-200 hover:border-emerald-300 transition-colors\">\n                <Checkbox\n                  id=\"addressCorrect\"\n                  checked={confirmed.addressCorrect}\n                  onCheckedChange={(checked) => setConfirmed({ ...confirmed, addressCorrect: checked })}\n                  className=\"mt-1\"\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"addressCorrect\" className=\"text-base font-semibold cursor-pointer text-slate-900\">\n                    ‚úì I confirm this is the correct address for cleaning\n                  </Label>\n                  <p className=\"text-sm text-slate-600 mt-1\">\n                    The map above accurately shows the property that needs cleaning\n                  </p>\n                </div>\n              </div>\n\n              {/* Checkpoint 2 */}\n              <div className=\"flex items-start gap-3 p-4 rounded-lg border-2 border-slate-200 hover:border-emerald-300 transition-colors\">\n                <Checkbox\n                  id=\"accessInstructions\"\n                  checked={confirmed.accessInstructions}\n                  onCheckedChange={(checked) => setConfirmed({ ...confirmed, accessInstructions: checked })}\n                  className=\"mt-1\"\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"accessInstructions\" className=\"text-base font-semibold cursor-pointer text-slate-900\">\n                    ‚úì I will provide clear access instructions\n                  </Label>\n                  <p className=\"text-sm text-slate-600 mt-1\">\n                    Including building codes, lockbox information, or entry procedures\n                  </p>\n                </div>\n              </div>\n\n              {/* Checkpoint 3 */}\n              <div className=\"flex items-start gap-3 p-4 rounded-lg border-2 border-slate-200 hover:border-emerald-300 transition-colors\">\n                <Checkbox\n                  id=\"parkingAcknowledged\"\n                  checked={confirmed.parkingAcknowledged}\n                  onCheckedChange={(checked) => setConfirmed({ ...confirmed, parkingAcknowledged: checked })}\n                  className=\"mt-1\"\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"parkingAcknowledged\" className=\"text-base font-semibold cursor-pointer text-slate-900\">\n                    ‚úì I acknowledge parking availability\n                  </Label>\n                  <p className=\"text-sm text-slate-600 mt-1\">\n                    If parking is limited or requires payment, I will inform the cleaner in advance\n                  </p>\n                </div>\n              </div>\n\n              {/* Checkpoint 4 */}\n              <div className=\"flex items-start gap-3 p-4 rounded-lg border-2 border-slate-200 hover:border-emerald-300 transition-colors\">\n                <Checkbox\n                  id=\"homeSecure\"\n                  checked={confirmed.homeSecure}\n                  onCheckedChange={(checked) => setConfirmed({ ...confirmed, homeSecure: checked })}\n                  className=\"mt-1\"\n                />\n                <div className=\"flex-1\">\n                  <Label htmlFor=\"homeSecure\" className=\"text-base font-semibold cursor-pointer text-slate-900\">\n                    ‚úì My home is secure and accessible\n                  </Label>\n                  <p className=\"text-sm text-slate-600 mt-1\">\n                    The property is safe to enter and there are no hazards or access issues\n                  </p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Buttons */}\n        <div className=\"flex gap-4\">\n          <Button\n            variant=\"outline\"\n            onClick={() => navigate(-1)}\n            className=\"flex-1\"\n          >\n            Go Back\n          </Button>\n          <Button\n            onClick={handleProceed}\n            disabled={!allConfirmed}\n            className={`flex-1 ${\n              allConfirmed\n                ? 'bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700'\n                : 'bg-slate-300 cursor-not-allowed'\n            }`}\n          >\n            {allConfirmed ? (\n              <>\n                <CheckCircle className=\"w-5 h-5 mr-2\" />\n                Confirm & Proceed to Payment\n              </>\n            ) : (\n              <>\n                <Lock className=\"w-5 h-5 mr-2\" />\n                Complete All Checkpoints\n              </>\n            )}\n          </Button>\n        </div>\n\n        {/* Security Notice */}\n        <Alert className=\"mt-6 bg-slate-50 border-slate-200\">\n          <Shield className=\"w-4 h-4\" />\n          <AlertDescription className=\"text-slate-700\">\n            <strong>Security Notice:</strong> This verification step helps protect both clients and cleaners. Your address information is encrypted and only shared with your assigned cleaner after booking confirmation.\n          </AlertDescription>\n        </Alert>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminAIMonitoring.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":9,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":56,"fix":{"range":[461,470],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[460,469],"text":""},"desc":"Remove unused variable 'XCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":8,"fix":{"range":[470,479],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[469,478],"text":""},"desc":"Remove unused variable 'Clock'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport {\n  Bot, TrendingUp, MessageSquare, CheckCircle2, XCircle,\n  Clock, Users, Calendar, Loader2, RefreshCw, Mail, Smartphone, Bell\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport ReengagementAnalytics from '../components/campaigns/ReengagementAnalytics';\nimport AutomationPerformance from '../components/campaigns/AutomationPerformance';\n\nexport default function AdminAIMonitoring() {\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [metrics, setMetrics] = useState({\n    totalAISuggestions: 0,\n    acceptedSlots: 0,\n    declinedSlots: 0,\n    conversionRate: 0,\n    averageSlotsPerSuggestion: 0\n  });\n  const [deliveryLogs, setDeliveryLogs] = useState([]);\n  const [aiEnabledCleaners, setAiEnabledCleaners] = useState([]);\n  const [recentBookings, setRecentBookings] = useState([]);\n\n  useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const loadDashboardData = async () => {\n    try {\n      setLoading(true);\n\n      // Get all AI-enabled cleaners\n      const allCleaners = await base44.asServiceRole.entities.CleanerProfile.list();\n      const aiEnabled = allCleaners.filter(c => \n        c.communication_settings?.ai_scheduling_enabled === true\n      );\n      setAiEnabledCleaners(aiEnabled);\n\n      // Get message delivery logs\n      const logs = await base44.asServiceRole.entities.MessageDeliveryLog.list('-sent_at', 50);\n      setDeliveryLogs(logs);\n\n      // Get recent bookings created via AI\n      const bookings = await base44.asServiceRole.entities.Booking.filter({\n        matched_via_smart_algorithm: true\n      });\n      setRecentBookings(bookings.slice(0, 20));\n\n      // Calculate metrics\n      const accepted = bookings.filter(b => b.status === 'scheduled' || b.status === 'accepted').length;\n      const declined = bookings.filter(b => b.status === 'cleaner_declined' || b.status === 'cancelled').length;\n      const total = bookings.length;\n\n      setMetrics({\n        totalAISuggestions: total,\n        acceptedSlots: accepted,\n        declinedSlots: declined,\n        conversionRate: total > 0 ? ((accepted / total) * 100).toFixed(1) : 0,\n        averageSlotsPerSuggestion: 3.2 // This would come from actual tracking\n      });\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading dashboard:', showToast: false });\n      toast.error('Failed to load dashboard data');\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  const handleRefresh = () => {\n    setRefreshing(true);\n    loadDashboardData();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center\">\n              <Bot className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-3xl font-fredoka font-bold text-graphite\">AI Monitoring Dashboard</h1>\n              <p className=\"text-gray-600 font-verdana\">Track AI-driven bookings and automated communications</p>\n            </div>\n          </div>\n          <Button\n            onClick={handleRefresh}\n            disabled={refreshing}\n            variant=\"outline\"\n            className=\"gap-2\"\n          >\n            <RefreshCw className={`w-4 h-4 ${refreshing ? 'animate-spin' : ''}`} />\n            Refresh\n          </Button>\n        </div>\n\n        {/* Key Metrics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <Calendar className=\"w-8 h-8 text-blue-500\" />\n                <Badge className=\"bg-blue-100 text-blue-800\">Total</Badge>\n              </div>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                {metrics.totalAISuggestions}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">AI Suggestions</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <CheckCircle2 className=\"w-8 h-8 text-green-500\" />\n                <Badge className=\"bg-green-100 text-green-800\">Accepted</Badge>\n              </div>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                {metrics.acceptedSlots}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Bookings Created</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <TrendingUp className=\"w-8 h-8 text-purple-500\" />\n                <Badge className=\"bg-purple-100 text-purple-800\">Rate</Badge>\n              </div>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                {metrics.conversionRate}%\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Conversion Rate</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <Users className=\"w-8 h-8 text-indigo-500\" />\n                <Badge className=\"bg-indigo-100 text-indigo-800\">Active</Badge>\n              </div>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                {aiEnabledCleaners.length}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">AI-Enabled Cleaners</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Automation Performance */}\n        <AutomationPerformance />\n\n        {/* Tabs */}\n        <Tabs defaultValue=\"bookings\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"bookings\">AI Bookings</TabsTrigger>\n            <TabsTrigger value=\"messages\">Message Delivery</TabsTrigger>\n            <TabsTrigger value=\"cleaners\">AI-Enabled Cleaners</TabsTrigger>\n            <TabsTrigger value=\"campaigns\">Re-engagement</TabsTrigger>\n          </TabsList>\n\n          {/* AI Bookings Tab */}\n          <TabsContent value=\"bookings\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka\">Recent AI-Driven Bookings</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {recentBookings.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <Bot className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                    <p className=\"text-gray-500 font-verdana\">No AI-driven bookings yet</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {recentBookings.map((booking) => (\n                      <div key={booking.id} className=\"border rounded-lg p-4 hover:bg-gray-50 transition\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-400 flex items-center justify-center text-white font-bold\">\n                              {booking.client_email?.[0]?.toUpperCase()}\n                            </div>\n                            <div>\n                              <p className=\"font-fredoka font-bold\">{booking.client_email}</p>\n                              <p className=\"text-sm text-gray-600 font-verdana\">\n                                {new Date(booking.date).toLocaleDateString()} at {booking.start_time}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge className={\n                            booking.status === 'scheduled' || booking.status === 'accepted' \n                              ? 'bg-green-100 text-green-800'\n                              : booking.status === 'cleaner_declined' || booking.status === 'cancelled'\n                              ? 'bg-red-100 text-red-800'\n                              : 'bg-yellow-100 text-yellow-800'\n                          }>\n                            {booking.status}\n                          </Badge>\n                        </div>\n                        <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n                          <span>Cleaner: {booking.cleaner_email}</span>\n                          <span>‚Ä¢</span>\n                          <span>${booking.total_price?.toFixed(2)}</span>\n                          <span>‚Ä¢</span>\n                          <span>{booking.hours}h {booking.cleaning_type}</span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Message Delivery Tab */}\n          <TabsContent value=\"messages\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka\">Message Delivery Logs</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {deliveryLogs.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <MessageSquare className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                    <p className=\"text-gray-500 font-verdana\">No message logs yet</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {deliveryLogs.map((log) => (\n                      <div key={log.id} className=\"border rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div>\n                            <p className=\"font-fredoka font-bold text-lg capitalize\">\n                              {log.message_type?.replace(/_/g, ' ')}\n                            </p>\n                            <p className=\"text-sm text-gray-600 font-verdana\">\n                              {log.cleaner_email} ‚Üí {log.client_email}\n                            </p>\n                            <p className=\"text-xs text-gray-500 mt-1\">\n                              {new Date(log.sent_at).toLocaleString()}\n                            </p>\n                          </div>\n                        </div>\n\n                        <div className=\"flex gap-2\">\n                          {log.channels?.map((channel, idx) => {\n                            const result = log.delivery_results?.[idx];\n                            const icon = channel === 'sms' ? Smartphone : channel === 'email' ? Mail : Bell;\n                            const Icon = icon;\n                            \n                            return (\n                              <Badge \n                                key={idx}\n                                className={\n                                  result?.success \n                                    ? 'bg-green-100 text-green-800'\n                                    : 'bg-red-100 text-red-800'\n                                }\n                              >\n                                <Icon className=\"w-3 h-3 mr-1\" />\n                                {channel}\n                                {result?.success ? ' ‚úì' : ' ‚úó'}\n                              </Badge>\n                            );\n                          })}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Re-engagement Campaign Tab */}\n          <TabsContent value=\"campaigns\">\n            <div className=\"space-y-6\">\n              <ReengagementAnalytics />\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka\">How Re-engagement Works</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"bg-blue-50 border-2 border-blue-200 rounded-lg p-4\">\n                    <p className=\"font-fredoka font-bold text-blue-900 mb-2\">Automated Client Outreach</p>\n                    <p className=\"text-sm text-blue-800 font-verdana\">\n                      The system automatically identifies clients who haven't booked in a while and sends personalized re-engagement messages based on each cleaner's settings.\n                    </p>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div className=\"border rounded-lg p-4\">\n                      <p className=\"font-fredoka font-bold mb-2\">üìß Multi-Channel Delivery</p>\n                      <p className=\"text-sm text-gray-600\">Campaigns are sent via email, SMS, and in-app notifications based on cleaner preferences.</p>\n                    </div>\n\n                    <div className=\"border rounded-lg p-4\">\n                      <p className=\"font-fredoka font-bold mb-2\">üí∞ Optional Discounts</p>\n                      <p className=\"text-sm text-gray-600\">Cleaners can offer special discounts to win back inactive clients.</p>\n                    </div>\n\n                    <div className=\"border rounded-lg p-4\">\n                      <p className=\"font-fredoka font-bold mb-2\">‚è∞ Smart Timing</p>\n                      <p className=\"text-sm text-gray-600\">Messages are sent at optimal times and never spam clients (max once per month).</p>\n                    </div>\n\n                    <div className=\"border rounded-lg p-4\">\n                      <p className=\"font-fredoka font-bold mb-2\">üìä Performance Tracking</p>\n                      <p className=\"text-sm text-gray-600\">Track which campaigns lead to actual bookings and measure ROI.</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* AI-Enabled Cleaners Tab */}\n          <TabsContent value=\"cleaners\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka\">Cleaners Using AI Scheduling</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {aiEnabledCleaners.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <Users className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                    <p className=\"text-gray-500 font-verdana\">No cleaners have enabled AI scheduling yet</p>\n                  </div>\n                ) : (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {aiEnabledCleaners.map((cleaner) => (\n                      <div key={cleaner.id} className=\"border rounded-lg p-4 hover:shadow-md transition\">\n                        <div className=\"flex items-center gap-3 mb-3\">\n                          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white font-fredoka font-bold text-lg\">\n                            {cleaner.full_name?.[0] || 'C'}\n                          </div>\n                          <div>\n                            <p className=\"font-fredoka font-bold\">{cleaner.full_name}</p>\n                            <p className=\"text-sm text-gray-600 font-verdana\">{cleaner.user_email}</p>\n                          </div>\n                        </div>\n\n                        <div className=\"space-y-2 text-sm\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-gray-600\">Gap Filling Priority:</span>\n                            <Badge variant=\"outline\">\n                              {cleaner.communication_settings?.prioritize_gap_filling ? 'Enabled' : 'Disabled'}\n                            </Badge>\n                          </div>\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-gray-600\">Suggest Days Ahead:</span>\n                            <Badge variant=\"outline\">\n                              {cleaner.communication_settings?.suggest_days_in_advance || 14} days\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminAnalytics.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'bookings' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"bookings"},"fix":{"range":[838,846],"text":""},"desc":"Remove unused variable 'bookings'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'total' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":95,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"total"},"fix":{"range":[4082,4107],"text":""},"desc":"Remove unused variable 'total'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Button } from '@/components/ui/button';\nimport { BarChart, Bar, LineChart, Line, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { TrendingUp, Users, Briefcase, RefreshCw, Calendar, Download } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminAnalytics() {\n  const [events, setEvents] = useState([]);\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [timeRange, setTimeRange] = useState('7d');\n  const [funnelData, setFunnelData] = useState([]);\n  const [userGrowth, setUserGrowth] = useState([]);\n  const [bookingFunnel, setBookingFunnel] = useState([]);\n\n  useEffect(() => {\n    loadAnalytics();\n  }, [timeRange]);\n\n  const loadAnalytics = async () => {\n    setLoading(true);\n    try {\n      const [allEvents, allBookings] = await Promise.all([\n        base44.entities.AnalyticsEvent.list('-timestamp', 5000),\n        base44.entities.Booking.list('-created_date', 1000)\n      ]);\n\n      // Filter by time range\n      const now = new Date();\n      const daysAgo = parseInt(timeRange.replace('d', ''));\n      const cutoffDate = new Date(now.getTime() - (daysAgo * 24 * 60 * 60 * 1000));\n      \n      const filteredEvents = allEvents.filter(e => \n        new Date(e.timestamp) >= cutoffDate\n      );\n\n      setEvents(filteredEvents);\n      setBookings(allBookings);\n\n      // Calculate funnel data\n      calculateFunnelData(filteredEvents);\n      calculateUserGrowth(filteredEvents);\n      calculateBookingFunnel(filteredEvents, allBookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading analytics:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const calculateFunnelData = (events) => {\n    const pageViews = events.filter(e => e.event_type === 'page_view').length;\n    const bookingStarted = events.filter(e => e.event_type === 'booking_started').length;\n    const bookingSubmitted = events.filter(e => e.event_type === 'booking_submitted').length;\n    \n    setFunnelData([\n      { name: 'Page Views', value: pageViews, percentage: 100 },\n      { name: 'Booking Started', value: bookingStarted, percentage: ((bookingStarted / pageViews) * 100).toFixed(1) },\n      { name: 'Booking Submitted', value: bookingSubmitted, percentage: ((bookingSubmitted / pageViews) * 100).toFixed(1) }\n    ]);\n  };\n\n  const calculateUserGrowth = (events) => {\n    const signupEvents = events.filter(e => \n      e.event_type === 'client_signup_success' || e.event_type === 'cleaner_signup_success'\n    );\n\n    const dailyData = {};\n    signupEvents.forEach(event => {\n      const date = new Date(event.timestamp).toLocaleDateString();\n      if (!dailyData[date]) {\n        dailyData[date] = { date, clients: 0, cleaners: 0 };\n      }\n      if (event.user_type === 'client') {\n        dailyData[date].clients++;\n      } else if (event.user_type === 'cleaner') {\n        dailyData[date].cleaners++;\n      }\n    });\n\n    setUserGrowth(Object.values(dailyData).sort((a, b) => new Date(a.date) - new Date(b.date)));\n  };\n\n  const calculateBookingFunnel = (events, bookings) => {\n    const step1 = events.filter(e => e.event_type === 'booking_step_completed' && e.metadata?.step === 1).length;\n    const step2 = events.filter(e => e.event_type === 'booking_step_completed' && e.metadata?.step === 2).length;\n    const step3 = events.filter(e => e.event_type === 'booking_step_completed' && e.metadata?.step === 3).length;\n    const submitted = events.filter(e => e.event_type === 'booking_submitted').length;\n    const paid = bookings.filter(b => b.payment_captured).length;\n\n    const total = step1 || 1;\n    \n    setBookingFunnel([\n      { step: 'Step 1: Date/Time', count: step1, dropoff: 0 },\n      { step: 'Step 2: Details', count: step2, dropoff: step1 - step2 },\n      { step: 'Step 3: Summary', count: step3, dropoff: step2 - step3 },\n      { step: 'Submitted', count: submitted, dropoff: step3 - submitted },\n      { step: 'Paid', count: paid, dropoff: submitted - paid }\n    ]);\n  };\n\n  const exportData = () => {\n    const dataStr = JSON.stringify(events, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `analytics-${new Date().toISOString()}.json`;\n    link.click();\n  };\n\n  const COLORS = ['#10b981', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6'];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen p-10 flex items-center justify-center\">\n        <RefreshCw className=\"w-12 h-12 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 p-6 lg:p-10\">\n      <div className=\"max-w-[1600px] mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Analytics Dashboard</h1>\n            <p className=\"text-lg text-slate-600\">Platform performance and user behavior insights</p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Select value={timeRange} onValueChange={setTimeRange}>\n              <SelectTrigger className=\"w-32\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"1d\">Last 24h</SelectItem>\n                <SelectItem value=\"7d\">Last 7 days</SelectItem>\n                <SelectItem value=\"30d\">Last 30 days</SelectItem>\n                <SelectItem value=\"90d\">Last 90 days</SelectItem>\n              </SelectContent>\n            </Select>\n            <Button onClick={loadAnalytics} variant=\"outline\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n            <Button onClick={exportData} variant=\"outline\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export\n            </Button>\n          </div>\n        </div>\n\n        {/* Key Metrics Cards */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>\n            <Card className=\"border-0 shadow-lg\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-slate-600\">Total Events</span>\n                  <TrendingUp className=\"w-5 h-5 text-emerald-500\" />\n                </div>\n                <p className=\"text-3xl font-bold text-slate-900\">{events.length}</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }}>\n            <Card className=\"border-0 shadow-lg\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-slate-600\">Unique Sessions</span>\n                  <Users className=\"w-5 h-5 text-blue-500\" />\n                </div>\n                <p className=\"text-3xl font-bold text-slate-900\">\n                  {new Set(events.map(e => e.session_id)).size}\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }}>\n            <Card className=\"border-0 shadow-lg\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-slate-600\">Bookings Started</span>\n                  <Briefcase className=\"w-5 h-5 text-purple-500\" />\n                </div>\n                <p className=\"text-3xl font-bold text-slate-900\">\n                  {events.filter(e => e.event_type === 'booking_started').length}\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}>\n            <Card className=\"border-0 shadow-lg\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm text-slate-600\">Conversion Rate</span>\n                  <Calendar className=\"w-5 h-5 text-amber-500\" />\n                </div>\n                <p className=\"text-3xl font-bold text-slate-900\">\n                  {events.filter(e => e.event_type === 'booking_started').length > 0\n                    ? ((events.filter(e => e.event_type === 'booking_submitted').length / \n                        events.filter(e => e.event_type === 'booking_started').length) * 100).toFixed(1)\n                    : 0}%\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Charts */}\n        <Tabs defaultValue=\"funnel\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"funnel\">Booking Funnel</TabsTrigger>\n            <TabsTrigger value=\"growth\">User Growth</TabsTrigger>\n            <TabsTrigger value=\"events\">Event Distribution</TabsTrigger>\n            <TabsTrigger value=\"dropoff\">Drop-off Analysis</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"funnel\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Booking Funnel - Step by Step</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={400}>\n                  <BarChart data={bookingFunnel}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"step\" />\n                    <YAxis />\n                    <Tooltip />\n                    <Legend />\n                    <Bar dataKey=\"count\" fill=\"#10b981\" name=\"Users\" />\n                    <Bar dataKey=\"dropoff\" fill=\"#ef4444\" name=\"Drop-off\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"growth\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>User Sign-ups Over Time</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={400}>\n                  <LineChart data={userGrowth}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"date\" />\n                    <YAxis />\n                    <Tooltip />\n                    <Legend />\n                    <Line type=\"monotone\" dataKey=\"clients\" stroke=\"#3b82f6\" name=\"Clients\" strokeWidth={2} />\n                    <Line type=\"monotone\" dataKey=\"cleaners\" stroke=\"#10b981\" name=\"Cleaners\" strokeWidth={2} />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"events\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Event Type Distribution</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={400}>\n                  <PieChart>\n                    <Pie\n                      data={Object.entries(\n                        events.reduce((acc, e) => {\n                          acc[e.event_type] = (acc[e.event_type] || 0) + 1;\n                          return acc;\n                        }, {})\n                      ).map(([name, value]) => ({ name, value }))}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      labelLine={false}\n                      label={({ name, percent }) => `${name} (${(percent * 100).toFixed(0)}%)`}\n                      outerRadius={150}\n                      fill=\"#8884d8\"\n                      dataKey=\"value\"\n                    >\n                      {Object.keys(events.reduce((acc, e) => {\n                        acc[e.event_type] = true;\n                        return acc;\n                      }, {})).map((entry, index) => (\n                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                      ))}\n                    </Pie>\n                    <Tooltip />\n                  </PieChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"dropoff\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Conversion Funnel with Percentages</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {funnelData.map((step, index) => (\n                    <div key={index} className=\"relative\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <span className=\"font-medium text-slate-900\">{step.name}</span>\n                        <span className=\"text-slate-600\">{step.value} users ({step.percentage}%)</span>\n                      </div>\n                      <div className=\"w-full bg-slate-200 rounded-full h-8 overflow-hidden\">\n                        <div\n                          className=\"h-full bg-gradient-to-r from-emerald-500 to-green-600 flex items-center justify-center text-white text-sm font-medium\"\n                          style={{ width: `${step.percentage}%` }}\n                        >\n                          {step.percentage}%\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n\n        {/* Recent Events Table */}\n        <Card className=\"border-0 shadow-lg mt-8\">\n          <CardHeader>\n            <CardTitle>Recent Events</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead>\n                  <tr className=\"border-b\">\n                    <th className=\"text-left p-3 text-sm font-medium text-slate-600\">Timestamp</th>\n                    <th className=\"text-left p-3 text-sm font-medium text-slate-600\">Event Type</th>\n                    <th className=\"text-left p-3 text-sm font-medium text-slate-600\">User</th>\n                    <th className=\"text-left p-3 text-sm font-medium text-slate-600\">User Type</th>\n                    <th className=\"text-left p-3 text-sm font-medium text-slate-600\">Page</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {events.slice(0, 50).map((event, idx) => (\n                    <tr key={idx} className=\"border-b hover:bg-slate-50\">\n                      <td className=\"p-3 text-sm text-slate-700\">\n                        {new Date(event.timestamp).toLocaleString()}\n                      </td>\n                      <td className=\"p-3 text-sm text-slate-700\">{event.event_type}</td>\n                      <td className=\"p-3 text-sm text-slate-700\">{event.user_email || 'Guest'}</td>\n                      <td className=\"p-3 text-sm text-slate-700\">{event.user_type}</td>\n                      <td className=\"p-3 text-sm text-slate-700 truncate max-w-xs\">\n                        {event.page_url}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminAnalyticsDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[359,406],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[359,405],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart3' is defined but never used.","line":9,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":31,"fix":{"range":[426,437],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart3"},"fix":{"range":[425,436],"text":""},"desc":"Remove unused variable 'BarChart3'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, BarChart3, DollarSign, Users, Activity, AlertCircle, Loader2, ArrowRight } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminAnalyticsDashboard() {\n  const [loading, setLoading] = useState(true);\n  const [latestDaily, setLatestDaily] = useState(null);\n  const [alerts, setAlerts] = useState([]);\n  const [subData, setSubData] = useState(null);\n  const [memData, setMemData] = useState(null);\n\n  useEffect(() => {\n    loadOverview();\n  }, []);\n\n  const loadOverview = async () => {\n    try {\n      const [daily, activeAlerts, subs, mems] = await Promise.all([\n        base44.entities.PlatformAnalyticsDaily.list('-created_date', 1),\n        base44.entities.SystemAlert.filter({ is_resolved: false }),\n        base44.entities.SubscriptionAnalytics.filter({ id: 'global_subscription_stats' }),\n        base44.entities.MembershipAnalytics.filter({ id: 'global_membership_stats' })\n      ]);\n      \n      setLatestDaily(daily[0] || {});\n      setAlerts(activeAlerts);\n      setSubData(subs[0] || {});\n      setMemData(mems[0] || {});\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading analytics overview:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const dashboards = [\n    {\n      title: 'CEO Dashboard',\n      description: 'High-level business metrics, GMV, revenue, and growth trends',\n      icon: TrendingUp,\n      color: '#66B3FF',\n      path: 'CEODashboard',\n      stats: [\n        { label: 'GMV (30d)', value: `$${(latestDaily?.gmv_usd || 0).toLocaleString()}` },\n        { label: 'Revenue', value: `$${(latestDaily?.platform_revenue_usd || 0).toLocaleString()}` }\n      ]\n    },\n    {\n      title: 'Operations Dashboard',\n      description: 'Booking status, cancellations, disputes, and cleaner performance',\n      icon: Activity,\n      color: '#28C76F',\n      path: 'OpsDashboard',\n      stats: [\n        { label: 'Total Bookings', value: latestDaily?.total_bookings || 0 },\n        { label: 'Cancel Rate', value: `${latestDaily?.cancel_rate?.toFixed(1) || 0}%` }\n      ]\n    },\n    {\n      title: 'Finance Dashboard',\n      description: 'Detailed financial breakdown, payouts, refunds, and margins',\n      icon: DollarSign,\n      color: '#9C27B0',\n      path: 'FinanceDashboard',\n      stats: [\n        { label: 'Platform Revenue', value: `$${(latestDaily?.platform_revenue_usd || 0).toLocaleString()}` },\n        { label: 'Refunds', value: `$${(latestDaily?.refunds_usd || 0).toLocaleString()}` }\n      ]\n    },\n    {\n      title: 'Growth Dashboard',\n      description: 'User acquisition, funnel metrics, subscription & membership growth',\n      icon: Users,\n      color: '#FF9F43',\n      path: 'GrowthDashboard',\n      stats: [\n        { label: 'New Clients', value: latestDaily?.new_clients || 0 },\n        { label: 'Subscriptions', value: subData?.active_subscriptions || 0 }\n      ]\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Analytics Hub</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">Choose a dashboard to view detailed metrics</p>\n        </div>\n\n        {/* Active Alerts Summary */}\n        {alerts.length > 0 && (\n          <Card className=\"border-2 border-red-500 bg-red-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <AlertCircle className=\"w-8 h-8 text-red-600\" />\n                  <div>\n                    <p className=\"font-fredoka font-bold text-lg text-graphite\">\n                      {alerts.length} Active Alert{alerts.length > 1 ? 's' : ''}\n                    </p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      {alerts.filter(a => a.severity === 'critical').length} critical, \n                      {' '}{alerts.filter(a => a.severity === 'high').length} high priority\n                    </p>\n                  </div>\n                </div>\n                <Link to={createPageUrl('SystemAlerts')}>\n                  <Button className=\"bg-red-600 hover:bg-red-700 text-white font-fredoka\">\n                    View Alerts\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Dashboard Cards */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          {dashboards.map((dashboard, idx) => (\n            <motion.div\n              key={dashboard.path}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.1 }}\n            >\n              <Link to={createPageUrl(dashboard.path)}>\n                <Card className=\"border-2 hover:shadow-xl transition-all cursor-pointer h-full\" style={{ borderColor: dashboard.color }}>\n                  <CardHeader className=\"pb-4\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center\" style={{ backgroundColor: dashboard.color }}>\n                        <dashboard.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      <div>\n                        <CardTitle className=\"font-fredoka text-xl text-graphite\">{dashboard.title}</CardTitle>\n                      </div>\n                    </div>\n                    <p className=\"text-sm text-gray-600 font-verdana\">{dashboard.description}</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-2 gap-4 mb-4\">\n                      {dashboard.stats.map((stat, i) => (\n                        <div key={i} className=\"p-3 bg-gray-50 rounded-lg\">\n                          <p className=\"text-xs text-gray-500 font-verdana mb-1\">{stat.label}</p>\n                          <p className=\"text-lg font-fredoka font-bold text-graphite\">{stat.value}</p>\n                        </div>\n                      ))}\n                    </div>\n                    <Button className=\"w-full font-fredoka\" style={{ backgroundColor: dashboard.color }}>\n                      Open Dashboard\n                      <ArrowRight className=\"w-4 h-4 ml-2\" />\n                    </Button>\n                  </CardContent>\n                </Card>\n              </Link>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* Quick Stats */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">Platform Health Summary</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-4 gap-6\">\n              <div className=\"text-center p-4 bg-blue-50 rounded-xl\">\n                <p className=\"text-3xl font-fredoka font-bold text-puretask-blue\">\n                  {latestDaily?.total_bookings || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Today's Bookings</p>\n              </div>\n              <div className=\"text-center p-4 bg-green-50 rounded-xl\">\n                <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                  {latestDaily?.avg_rating?.toFixed(1) || '5.0'}‚≠ê\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Average Rating</p>\n              </div>\n              <div className=\"text-center p-4 bg-purple-50 rounded-xl\">\n                <p className=\"text-3xl font-fredoka font-bold text-purple-600\">\n                  {latestDaily?.active_cleaners || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Active Cleaners</p>\n              </div>\n              <div className=\"text-center p-4 bg-amber-50 rounded-xl\">\n                <p className=\"text-3xl font-fredoka font-bold text-amber-600\">\n                  ${((subData?.subscription_mrr_usd || 0) + (memData?.membership_mrr_usd || 0)).toLocaleString()}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Total MRR</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminAnalyticsViewer.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[366,413],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[366,412],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":12,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":41,"fix":{"range":[604,614],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[603,613],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Filter' is defined but never used.","line":12,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":68,"fix":{"range":[633,641],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[632,640],"text":""},"desc":"Remove unused variable 'Filter'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'endOfDay' is defined but never used.","line":16,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":47,"fix":{"range":[800,810],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"endOfDay"},"fix":{"range":[800,810],"text":""},"desc":"Remove unused variable 'endOfDay'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[923,927],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport {\n  BarChart3, TrendingUp, Users, Calendar, Loader2, Download, Filter,\n  Eye, MousePointer, UserPlus, ShoppingCart, Star, XCircle\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format, subDays, startOfDay, endOfDay } from 'date-fns';\n\nexport default function AdminAnalyticsViewer() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [events, setEvents] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [dateRange, setDateRange] = useState('7');\n  const [eventTypeFilter, setEventTypeFilter] = useState('all');\n  const [userTypeFilter, setUserTypeFilter] = useState('all');\n  const [searchQuery, setSearchQuery] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, [dateRange]);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.role !== 'admin') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Calculate date range\n      const days = parseInt(dateRange);\n      const startDate = startOfDay(subDays(new Date(), days));\n\n      // Load events\n      const analyticsEvents = await base44.entities.AnalyticsEvent.filter({\n        timestamp: { $gte: startDate.toISOString() }\n      }, '-timestamp', 1000);\n\n      setEvents(analyticsEvents);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading analytics:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  // Calculate metrics\n  const calculateMetrics = () => {\n    const filteredEvents = events.filter(event => {\n      const typeMatch = eventTypeFilter === 'all' || event.event_type === eventTypeFilter;\n      const userMatch = userTypeFilter === 'all' || event.user_type === userTypeFilter;\n      const searchMatch = !searchQuery || \n        event.user_email?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        event.event_type?.toLowerCase().includes(searchQuery.toLowerCase());\n      return typeMatch && userMatch && searchMatch;\n    });\n\n    const pageViews = filteredEvents.filter(e => e.event_type === 'page_view').length;\n    const bookingStarted = filteredEvents.filter(e => e.event_type === 'booking_started').length;\n    const bookingSubmitted = filteredEvents.filter(e => e.event_type === 'booking_submitted').length;\n    const conversionRate = bookingStarted > 0 ? ((bookingSubmitted / bookingStarted) * 100).toFixed(1) : 0;\n    \n    const uniqueUsers = new Set(filteredEvents.map(e => e.user_email).filter(Boolean)).size;\n\n    const eventsByType = {};\n    filteredEvents.forEach(event => {\n      eventsByType[event.event_type] = (eventsByType[event.event_type] || 0) + 1;\n    });\n\n    const eventsByUserType = {};\n    filteredEvents.forEach(event => {\n      eventsByUserType[event.user_type] = (eventsByUserType[event.user_type] || 0) + 1;\n    });\n\n    return {\n      total: filteredEvents.length,\n      pageViews,\n      bookingStarted,\n      bookingSubmitted,\n      conversionRate,\n      uniqueUsers,\n      eventsByType,\n      eventsByUserType,\n      recentEvents: filteredEvents.slice(0, 50)\n    };\n  };\n\n  const metrics = calculateMetrics();\n\n  const exportData = () => {\n    const csv = [\n      ['Timestamp', 'Event Type', 'User Email', 'User Type', 'Page URL', 'Session ID'],\n      ...metrics.recentEvents.map(e => [\n        e.timestamp,\n        e.event_type,\n        e.user_email || 'guest',\n        e.user_type || 'guest',\n        e.page_url || '',\n        e.session_id || ''\n      ])\n    ].map(row => row.join(',')).join('\\n');\n\n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `analytics-${format(new Date(), 'yyyy-MM-dd')}.csv`;\n    a.click();\n  };\n\n  const getEventIcon = (eventType) => {\n    const icons = {\n      page_view: Eye,\n      booking_started: ShoppingCart,\n      booking_submitted: Star,\n      client_signup_success: UserPlus,\n      cleaner_signup_success: UserPlus,\n      booking_abandoned: XCircle\n    };\n    return icons[eventType] || MousePointer;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2 flex items-center gap-3\">\n            <BarChart3 className=\"w-10 h-10 text-puretask-blue\" />\n            Analytics Dashboard\n          </h1>\n          <p className=\"text-lg text-gray-600 font-verdana\">\n            Platform usage and user behavior insights\n          </p>\n        </div>\n\n        {/* Filters */}\n        <Card className=\"mb-6 border-0 shadow-lg rounded-2xl\">\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-4 gap-4\">\n              <div>\n                <label className=\"text-sm font-fredoka font-medium text-graphite mb-2 block\">\n                  Date Range\n                </label>\n                <Select value={dateRange} onValueChange={setDateRange}>\n                  <SelectTrigger className=\"rounded-full font-verdana\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"1\">Last 24 hours</SelectItem>\n                    <SelectItem value=\"7\">Last 7 days</SelectItem>\n                    <SelectItem value=\"30\">Last 30 days</SelectItem>\n                    <SelectItem value=\"90\">Last 90 days</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-fredoka font-medium text-graphite mb-2 block\">\n                  Event Type\n                </label>\n                <Select value={eventTypeFilter} onValueChange={setEventTypeFilter}>\n                  <SelectTrigger className=\"rounded-full font-verdana\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Events</SelectItem>\n                    <SelectItem value=\"page_view\">Page Views</SelectItem>\n                    <SelectItem value=\"booking_started\">Booking Started</SelectItem>\n                    <SelectItem value=\"booking_submitted\">Booking Submitted</SelectItem>\n                    <SelectItem value=\"booking_abandoned\">Booking Abandoned</SelectItem>\n                    <SelectItem value=\"client_signup_success\">Client Signup</SelectItem>\n                    <SelectItem value=\"cleaner_signup_success\">Cleaner Signup</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-fredoka font-medium text-graphite mb-2 block\">\n                  User Type\n                </label>\n                <Select value={userTypeFilter} onValueChange={setUserTypeFilter}>\n                  <SelectTrigger className=\"rounded-full font-verdana\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Users</SelectItem>\n                    <SelectItem value=\"client\">Clients</SelectItem>\n                    <SelectItem value=\"cleaner\">Cleaners</SelectItem>\n                    <SelectItem value=\"guest\">Guests</SelectItem>\n                    <SelectItem value=\"admin\">Admins</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-fredoka font-medium text-graphite mb-2 block\">\n                  Search\n                </label>\n                <Input\n                  placeholder=\"User email or event...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"font-verdana\"\n                />\n              </div>\n            </div>\n\n            <div className=\"mt-4 flex justify-end\">\n              <Button\n                onClick={exportData}\n                variant=\"outline\"\n                className=\"rounded-full font-fredoka\"\n              >\n                <Download className=\"w-4 h-4 mr-2\" />\n                Export CSV\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Key Metrics */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Eye className=\"w-10 h-10 text-puretask-blue mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{metrics.pageViews.toLocaleString()}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Page Views</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Users className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{metrics.uniqueUsers.toLocaleString()}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Unique Users</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <ShoppingCart className=\"w-10 h-10 text-amber-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{metrics.bookingSubmitted.toLocaleString()}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Bookings</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <TrendingUp className=\"w-10 h-10 text-fresh-mint mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{metrics.conversionRate}%</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Conversion Rate</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Event Breakdown */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg rounded-2xl\">\n            <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n              <CardTitle className=\"font-fredoka text-graphite\">Events by Type</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-3\">\n                {Object.entries(metrics.eventsByType)\n                  .sort((a, b) => b[1] - a[1])\n                  .slice(0, 10)\n                  .map(([type, count]) => {\n                    const Icon = getEventIcon(type);\n                    const percentage = ((count / metrics.total) * 100).toFixed(1);\n                    \n                    return (\n                      <div key={type} className=\"flex items-center justify-between p-3 bg-soft-cloud rounded-2xl\">\n                        <div className=\"flex items-center gap-3\">\n                          <Icon className=\"w-5 h-5 text-puretask-blue\" />\n                          <span className=\"font-verdana text-sm text-graphite capitalize\">\n                            {type.replace(/_/g, ' ')}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                            <div\n                              className=\"bg-puretask-blue h-2 rounded-full\"\n                              style={{ width: `${percentage}%` }}\n                            />\n                          </div>\n                          <span className=\"font-fredoka font-bold text-graphite text-base min-w-[40px] text-right\">\n                            {count}\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg rounded-2xl\">\n            <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n              <CardTitle className=\"font-fredoka text-graphite\">Users by Type</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-3\">\n                {Object.entries(metrics.eventsByUserType)\n                  .sort((a, b) => b[1] - a[1])\n                  .map(([type, count]) => {\n                    const percentage = ((count / metrics.total) * 100).toFixed(1);\n                    \n                    return (\n                      <div key={type} className=\"flex items-center justify-between p-3 bg-soft-cloud rounded-2xl\">\n                        <div className=\"flex items-center gap-3\">\n                          <Users className=\"w-5 h-5 text-purple-600\" />\n                          <span className=\"font-verdana text-sm text-graphite capitalize\">\n                            {type || 'Unknown'}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-24 bg-gray-200 rounded-full h-2\">\n                            <div\n                              className=\"bg-purple-600 h-2 rounded-full\"\n                              style={{ width: `${percentage}%` }}\n                            />\n                          </div>\n                          <span className=\"font-fredoka font-bold text-graphite text-base min-w-[40px] text-right\">\n                            {count}\n                          </span>\n                        </div>\n                      </div>\n                    );\n                  })}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Events */}\n        <Card className=\"border-0 shadow-lg rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n            <CardTitle className=\"font-fredoka text-graphite\">Recent Events</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n              {metrics.recentEvents.map((event, idx) => {\n                const Icon = getEventIcon(event.event_type);\n                \n                return (\n                  <motion.div\n                    key={event.id}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: idx * 0.02 }}\n                    className=\"flex items-center justify-between p-3 bg-soft-cloud rounded-2xl hover:bg-gray-100 transition-colors\"\n                  >\n                    <div className=\"flex items-center gap-3 flex-1\">\n                      <Icon className=\"w-5 h-5 text-puretask-blue\" />\n                      <div className=\"flex-1\">\n                        <p className=\"font-fredoka font-semibold text-graphite text-sm\">\n                          {event.event_type.replace(/_/g, ' ')}\n                        </p>\n                        <p className=\"text-xs text-gray-600 font-verdana\">\n                          {event.user_email || 'Guest'} ‚Ä¢ {event.user_type || 'unknown'}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-xs text-gray-500 font-verdana\">\n                        {format(new Date(event.timestamp), 'MMM d, h:mm a')}\n                      </p>\n                    </div>\n                  </motion.div>\n                );\n              })}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminAuditLog.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":39,"fix":{"range":[263,275],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[262,274],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":6,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"fix":{"range":[274,285],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[274,285],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Button' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"fix":{"range":[317,366],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Button"},"fix":{"range":[317,365],"text":""},"desc":"Remove unused variable 'Button'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":11,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":26,"fix":{"range":[550,558],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[549,557],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[724,728],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { FileText, Search, Loader2, Shield } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminAuditLog() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [logs, setLogs] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [actionFilter, setActionFilter] = useState('all');\n\n  useEffect(() => {\n    checkAdminAndLoad();\n  }, []);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n      await loadLogs();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadLogs = async () => {\n    setLoading(true);\n    try {\n      const allLogs = await base44.entities.AdminAuditLog.list('-created_date', 200);\n      setLogs(allLogs);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading logs:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const getActionColor = (actionType) => {\n    if (actionType.includes('BLOCK') || actionType.includes('CANCEL')) {\n      return 'bg-red-100 text-red-800';\n    }\n    if (actionType.includes('REFUND') || actionType.includes('ADJUST')) {\n      return 'bg-amber-100 text-amber-800';\n    }\n    if (actionType.includes('APPROVE') || actionType.includes('RESOLVE')) {\n      return 'bg-green-100 text-green-800';\n    }\n    return 'bg-blue-100 text-blue-800';\n  };\n\n  const filteredLogs = logs.filter(log => {\n    const matchesSearch = !searchTerm || \n      log.admin_email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      log.target_id.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesAction = actionFilter === 'all' || log.action_type === actionFilter;\n    \n    return matchesSearch && matchesAction;\n  });\n\n  const actionTypes = [...new Set(logs.map(l => l.action_type))];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Audit Log</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">Complete history of all admin actions</p>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex gap-4 flex-wrap\">\n              <div className=\"flex-1 min-w-[250px]\">\n                <Input\n                  placeholder=\"Search by admin email or target ID...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"font-verdana\"\n                />\n              </div>\n              <select\n                value={actionFilter}\n                onChange={(e) => setActionFilter(e.target.value)}\n                className=\"p-2 border rounded-lg font-verdana\"\n              >\n                <option value=\"all\">All Actions</option>\n                {actionTypes.map(type => (\n                  <option key={type} value={type}>{type.replace(/_/g, ' ')}</option>\n                ))}\n              </select>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Logs List */}\n        <div className=\"space-y-3\">\n          {filteredLogs.map((log, idx) => (\n            <motion.div\n              key={log.id}\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.02 }}\n            >\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start gap-4\">\n                    <Shield className=\"w-5 h-5 text-puretask-blue mt-1\" />\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <Badge className={`font-fredoka ${getActionColor(log.action_type)}`}>\n                          {log.action_type.replace(/_/g, ' ')}\n                        </Badge>\n                        <p className=\"text-sm text-gray-600 font-verdana\">\n                          by {log.admin_email}\n                        </p>\n                      </div>\n                      <div className=\"grid md:grid-cols-2 gap-3 text-sm font-verdana\">\n                        <p><span className=\"text-gray-500\">Target:</span> {log.target_type} - {log.target_id}</p>\n                        <p><span className=\"text-gray-500\">Time:</span> {new Date(log.created_date).toLocaleString()}</p>\n                      </div>\n                      {log.metadata && Object.keys(log.metadata).length > 0 && (\n                        <div className=\"mt-3 p-3 bg-gray-50 rounded-lg\">\n                          <p className=\"text-xs text-gray-500 font-verdana mb-1\">Metadata:</p>\n                          <pre className=\"text-xs font-verdana\">\n                            {JSON.stringify(log.metadata, null, 2)}\n                          </pre>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n\n        {filteredLogs.length === 0 && (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <FileText className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">No audit logs found</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminBookingsConsole.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":12,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":26,"fix":{"range":[622,630],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[621,629],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Filter' is defined but never used.","line":12,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":34,"fix":{"range":[630,638],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[629,637],"text":""},"desc":"Remove unused variable 'Filter'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Edit' is defined but never used.","line":12,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":54,"fix":{"range":[652,658],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Edit"},"fix":{"range":[651,657],"text":""},"desc":"Remove unused variable 'Edit'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { AdminAuditLogger } from '@/components/admin/AdminAuditLogger';\nimport { Calendar, Search, Filter, Loader2, Eye, Edit, XCircle, AlertTriangle } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminBookingsConsole() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [bookings, setBookings] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [selectedBooking, setSelectedBooking] = useState(null);\n\n  useEffect(() => {\n    checkAdminAndLoad();\n  }, []);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n      await loadBookings();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadBookings = async () => {\n    setLoading(true);\n    try {\n      const allBookings = await base44.entities.Booking.list('-created_date', 200);\n      setBookings(allBookings);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading bookings:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const handleCancelBooking = async (booking) => {\n    if (!confirm('Cancel this booking? Client will be refunded.')) return;\n    \n    const hasPermission = await AdminPermissions.hasCapability(user.email, 'can_edit_bookings');\n    if (!hasPermission) {\n      alert('You do not have permission to cancel bookings');\n      return;\n    }\n\n    try {\n      const reason = prompt('Reason for cancellation:');\n      if (!reason) return;\n\n      // Log audit trail\n      await AdminAuditLogger.log({\n        adminEmail: user.email,\n        actionType: 'CANCEL_BOOKING',\n        targetType: 'booking',\n        targetId: booking.id,\n        beforeState: { status: booking.status },\n        afterState: { status: 'cancelled' },\n        metadata: { reason, cancelled_by: 'admin' }\n      });\n\n      // Update booking\n      await base44.entities.Booking.update(booking.id, {\n        status: 'cancelled',\n        cancelled_by: 'admin',\n        cancellation_reason: reason,\n        cancellation_timestamp: new Date().toISOString()\n      });\n\n      // Issue refund if payment was made\n      if (booking.escrow_credits_reserved > 0) {\n        await base44.entities.CreditTransaction.create({\n          client_email: booking.client_email,\n          transaction_type: 'refund',\n          amount_credits: booking.escrow_credits_reserved,\n          booking_id: booking.id,\n          note: `Admin cancellation: ${reason}`\n        });\n      }\n\n      alert('Booking cancelled and refund issued');\n      loadBookings();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error cancelling booking:', showToast: false });\n      alert('Failed to cancel booking');\n    }\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      completed: 'bg-green-100 text-green-800',\n      approved: 'bg-green-100 text-green-800',\n      in_progress: 'bg-blue-100 text-blue-800',\n      scheduled: 'bg-blue-100 text-blue-800',\n      accepted: 'bg-cyan-100 text-cyan-800',\n      cancelled: 'bg-red-100 text-red-800',\n      disputed: 'bg-red-100 text-red-800',\n      payment_hold: 'bg-amber-100 text-amber-800',\n      awaiting_cleaner_response: 'bg-yellow-100 text-yellow-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const filteredBookings = bookings.filter(b => {\n    const matchesSearch = !searchTerm || \n      b.client_email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      b.cleaner_email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      b.id.includes(searchTerm);\n    \n    const matchesStatus = statusFilter === 'all' || b.status === statusFilter;\n    \n    return matchesSearch && matchesStatus;\n  });\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Bookings Console</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">Manage all platform bookings</p>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex gap-4 flex-wrap\">\n              <div className=\"flex-1 min-w-[250px]\">\n                <Input\n                  placeholder=\"Search by ID, client, or cleaner email...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"font-verdana\"\n                />\n              </div>\n              <div className=\"flex gap-2 flex-wrap\">\n                <Button\n                  variant={statusFilter === 'all' ? 'default' : 'outline'}\n                  onClick={() => setStatusFilter('all')}\n                  className=\"font-fredoka\"\n                >\n                  All\n                </Button>\n                <Button\n                  variant={statusFilter === 'scheduled' ? 'default' : 'outline'}\n                  onClick={() => setStatusFilter('scheduled')}\n                  className=\"font-fredoka\"\n                >\n                  Scheduled\n                </Button>\n                <Button\n                  variant={statusFilter === 'in_progress' ? 'default' : 'outline'}\n                  onClick={() => setStatusFilter('in_progress')}\n                  className=\"font-fredoka\"\n                >\n                  In Progress\n                </Button>\n                <Button\n                  variant={statusFilter === 'disputed' ? 'default' : 'outline'}\n                  onClick={() => setStatusFilter('disputed')}\n                  className=\"font-fredoka\"\n                >\n                  Disputed\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Summary Stats */}\n        <div className=\"grid md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-gray-600 font-verdana\">Total Bookings</p>\n              <p className=\"text-2xl font-fredoka font-bold text-graphite\">{bookings.length}</p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-gray-600 font-verdana\">Disputed</p>\n              <p className=\"text-2xl font-fredoka font-bold text-red-600\">\n                {bookings.filter(b => b.status === 'disputed').length}\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-gray-600 font-verdana\">In Progress</p>\n              <p className=\"text-2xl font-fredoka font-bold text-blue-600\">\n                {bookings.filter(b => b.status === 'in_progress').length}\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4\">\n              <p className=\"text-sm text-gray-600 font-verdana\">Completed</p>\n              <p className=\"text-2xl font-fredoka font-bold text-green-600\">\n                {bookings.filter(b => b.status === 'completed' || b.status === 'approved').length}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Bookings List */}\n        <div className=\"space-y-3\">\n          {filteredBookings.map((booking, idx) => (\n            <motion.div\n              key={booking.id}\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.02 }}\n            >\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-3\">\n                        <Badge className={`font-fredoka ${getStatusColor(booking.status)}`}>\n                          {booking.status.replace(/_/g, ' ')}\n                        </Badge>\n                        <p className=\"text-xs text-gray-500 font-verdana\">ID: {booking.id}</p>\n                        {booking.status === 'disputed' && (\n                          <Badge className=\"bg-red-600 text-white font-fredoka\">\n                            <AlertTriangle className=\"w-3 h-3 mr-1\" />\n                            Needs Attention\n                          </Badge>\n                        )}\n                      </div>\n                      \n                      <div className=\"grid md:grid-cols-3 gap-4\">\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Client</p>\n                          <p className=\"font-verdana text-sm font-semibold\">{booking.client_email}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Cleaner</p>\n                          <p className=\"font-verdana text-sm\">{booking.cleaner_email || 'Not assigned'}</p>\n                        </div>\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Date & Time</p>\n                          <p className=\"font-verdana text-sm font-semibold\">\n                            {new Date(booking.date).toLocaleDateString()} at {booking.start_time}\n                          </p>\n                        </div>\n                      </div>\n\n                      <div className=\"mt-3 flex gap-4\">\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Duration</p>\n                          <p className=\"font-verdana text-sm\">{booking.hours}h</p>\n                        </div>\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Total</p>\n                          <p className=\"font-verdana text-sm font-semibold\">\n                            {booking.total_price?.toFixed(0)} credits\n                          </p>\n                        </div>\n                        <div>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Created</p>\n                          <p className=\"font-verdana text-sm\">\n                            {new Date(booking.created_date).toLocaleDateString()}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"flex flex-col gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setSelectedBooking(booking)}\n                        className=\"font-fredoka\"\n                      >\n                        <Eye className=\"w-4 h-4 mr-1\" />\n                        View\n                      </Button>\n                      {booking.status !== 'cancelled' && booking.status !== 'completed' && (\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleCancelBooking(booking)}\n                          className=\"font-fredoka text-red-600 border-red-600\"\n                        >\n                          <XCircle className=\"w-4 h-4 mr-1\" />\n                          Cancel\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n\n        {filteredBookings.length === 0 && (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <Calendar className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">No bookings found</p>\n              <p className=\"text-gray-600 font-verdana mt-2\">Try adjusting your filters</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Booking Details Modal */}\n      {selectedBooking && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={() => setSelectedBooking(null)}>\n          <Card className=\"max-w-3xl w-full max-h-[90vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-2xl\">Booking Details</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Booking ID</p>\n                  <p className=\"font-verdana font-semibold\">{selectedBooking.id}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Status</p>\n                  <Badge className={getStatusColor(selectedBooking.status)}>\n                    {selectedBooking.status}\n                  </Badge>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Client</p>\n                  <p className=\"font-verdana\">{selectedBooking.client_email}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Cleaner</p>\n                  <p className=\"font-verdana\">{selectedBooking.cleaner_email || 'Not assigned'}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Date & Time</p>\n                  <p className=\"font-verdana font-semibold\">\n                    {new Date(selectedBooking.date).toLocaleDateString()} at {selectedBooking.start_time}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Duration</p>\n                  <p className=\"font-verdana\">{selectedBooking.hours} hours</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Address</p>\n                  <p className=\"font-verdana text-sm\">{selectedBooking.address}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-500 font-verdana\">Total Price</p>\n                  <p className=\"font-verdana font-semibold\">{selectedBooking.total_price?.toFixed(0)} credits</p>\n                </div>\n              </div>\n\n              {selectedBooking.check_in_time && (\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-verdana font-semibold mb-2\">GPS Tracking</p>\n                  <div className=\"grid md:grid-cols-2 gap-3\">\n                    <div>\n                      <p className=\"text-xs text-gray-600\">Check-in</p>\n                      <p className=\"text-sm\">{new Date(selectedBooking.check_in_time).toLocaleString()}</p>\n                    </div>\n                    {selectedBooking.check_out_time && (\n                      <div>\n                        <p className=\"text-xs text-gray-600\">Check-out</p>\n                        <p className=\"text-sm\">{new Date(selectedBooking.check_out_time).toLocaleString()}</p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"flex gap-2 pt-4\">\n                <Button onClick={() => setSelectedBooking(null)} className=\"font-fredoka\">\n                  Close\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminBookingsConsoleV2.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":10,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":69,"fix":{"range":[570,583],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[570,583],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Calendar, User, Clock, DollarSign, AlertCircle, CheckCircle } from 'lucide-react';\nimport { format } from 'date-fns';\n\nexport default function AdminBookingsConsoleV2() {\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedBooking, setSelectedBooking] = useState(null);\n  const [actionModal, setActionModal] = useState(null);\n  const [actionData, setActionData] = useState({});\n\n  useEffect(() => {\n    loadBookings();\n  }, []);\n\n  const loadBookings = async () => {\n    setLoading(true);\n    try {\n      const allBookings = await base44.entities.Booking.list('-created_date', 100);\n      setBookings(allBookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading bookings:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const filteredBookings = bookings.filter(b => \n    b.id.includes(searchTerm) ||\n    b.client_email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    b.cleaner_email?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const handleAction = async (action) => {\n    try {\n      const response = await base44.functions.invoke('adminWorkflows', {\n        action,\n        ...actionData,\n        booking_id: selectedBooking.id\n      });\n      \n      if (response.data.success) {\n        alert(response.data.message);\n        setActionModal(null);\n        setActionData({});\n        loadBookings();\n      } else {\n        alert('Error: ' + (response.data.error || 'Unknown error'));\n      }\n    } catch (error) {\n      alert('Error: ' + error.message);\n    }\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      completed: 'bg-green-100 text-green-800',\n      in_progress: 'bg-blue-100 text-blue-800',\n      scheduled: 'bg-purple-100 text-purple-800',\n      cancelled: 'bg-red-100 text-red-800',\n      disputed: 'bg-orange-100 text-orange-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-puretask-blue mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 font-verdana\">Loading bookings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"mb-6\">\n          <h1 className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">Bookings Console</h1>\n          <p className=\"text-gray-600 font-verdana\">Manage all platform bookings</p>\n        </div>\n\n        {/* Search */}\n        <Card className=\"mb-6\">\n          <CardContent className=\"pt-6\">\n            <Input\n              placeholder=\"Search by booking ID, client email, or cleaner email...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"text-lg\"\n            />\n          </CardContent>\n        </Card>\n\n        {/* Bookings List */}\n        <div className=\"space-y-4\">\n          {filteredBookings.map((booking) => (\n            <Card key={booking.id} className=\"hover:shadow-lg transition-shadow\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start justify-between mb-4\">\n                  <div>\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <h3 className=\"text-lg font-fredoka font-bold text-graphite\">\n                        Booking #{booking.id.slice(0, 8)}\n                      </h3>\n                      <Badge className={getStatusColor(booking.status)}>\n                        {booking.status}\n                      </Badge>\n                      {booking.dispute_status && (\n                        <Badge className=\"bg-red-100 text-red-800\">\n                          <AlertCircle className=\"w-3 h-3 mr-1\" />\n                          Disputed\n                        </Badge>\n                      )}\n                    </div>\n                    \n                    <div className=\"grid grid-cols-2 gap-4 text-sm text-gray-600 font-verdana\">\n                      <div className=\"flex items-center gap-2\">\n                        <Calendar className=\"w-4 h-4\" />\n                        {format(new Date(booking.date), 'MMM dd, yyyy')} at {booking.start_time}\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Clock className=\"w-4 h-4\" />\n                        {booking.hours} hours\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <User className=\"w-4 h-4\" />\n                        Client: {booking.client_email}\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <User className=\"w-4 h-4\" />\n                        Cleaner: {booking.cleaner_email || 'Unassigned'}\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <DollarSign className=\"w-4 h-4\" />\n                        {booking.total_price} credits\n                      </div>\n                    </div>\n                  </div>\n\n                  <Button\n                    onClick={() => setSelectedBooking(booking)}\n                    variant=\"outline\"\n                    className=\"font-fredoka\"\n                  >\n                    Manage\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Booking Actions Dialog */}\n        {selectedBooking && !actionModal && (\n          <Dialog open={!!selectedBooking} onOpenChange={() => setSelectedBooking(null)}>\n            <DialogContent className=\"max-w-2xl\">\n              <DialogHeader>\n                <DialogTitle className=\"font-fredoka\">Manage Booking</DialogTitle>\n              </DialogHeader>\n              \n              <div className=\"space-y-4 py-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <Button\n                    onClick={() => setActionModal('reschedule')}\n                    variant=\"outline\"\n                    className=\"font-fredoka\"\n                  >\n                    Reschedule\n                  </Button>\n                  <Button\n                    onClick={() => setActionModal('reassign')}\n                    variant=\"outline\"\n                    className=\"font-fredoka\"\n                  >\n                    Reassign Cleaner\n                  </Button>\n                  <Button\n                    onClick={() => setActionModal('cancel')}\n                    variant=\"outline\"\n                    className=\"font-fredoka text-red-600 border-red-200 hover:bg-red-50\"\n                  >\n                    Cancel Booking\n                  </Button>\n                  <Button\n                    onClick={() => setActionModal('refund')}\n                    variant=\"outline\"\n                    className=\"font-fredoka\"\n                  >\n                    Issue Refund\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {/* Action Modals */}\n        {actionModal === 'reschedule' && (\n          <Dialog open={true} onOpenChange={() => { setActionModal(null); setActionData({}); }}>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle className=\"font-fredoka\">Reschedule Booking</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <Input\n                  type=\"date\"\n                  value={actionData.new_date || ''}\n                  onChange={(e) => setActionData({...actionData, new_date: e.target.value})}\n                  placeholder=\"New Date\"\n                />\n                <Input\n                  type=\"time\"\n                  value={actionData.new_time || ''}\n                  onChange={(e) => setActionData({...actionData, new_time: e.target.value})}\n                  placeholder=\"New Time\"\n                />\n                <Textarea\n                  value={actionData.reason || ''}\n                  onChange={(e) => setActionData({...actionData, reason: e.target.value})}\n                  placeholder=\"Reason for rescheduling\"\n                />\n                <Button onClick={() => handleAction('reschedule_booking')} className=\"w-full font-fredoka\">\n                  Reschedule\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {actionModal === 'reassign' && (\n          <Dialog open={true} onOpenChange={() => { setActionModal(null); setActionData({}); }}>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle className=\"font-fredoka\">Reassign Cleaner</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <Input\n                  value={actionData.new_cleaner_email || ''}\n                  onChange={(e) => setActionData({...actionData, new_cleaner_email: e.target.value})}\n                  placeholder=\"New Cleaner Email\"\n                />\n                <Textarea\n                  value={actionData.reason || ''}\n                  onChange={(e) => setActionData({...actionData, reason: e.target.value})}\n                  placeholder=\"Reason for reassignment\"\n                />\n                <Button onClick={() => handleAction('reassign_cleaner')} className=\"w-full font-fredoka\">\n                  Reassign\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {actionModal === 'cancel' && (\n          <Dialog open={true} onOpenChange={() => { setActionModal(null); setActionData({}); }}>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle className=\"font-fredoka\">Cancel Booking</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <Textarea\n                  value={actionData.reason || ''}\n                  onChange={(e) => setActionData({...actionData, reason: e.target.value})}\n                  placeholder=\"Cancellation reason\"\n                />\n                <Input\n                  type=\"number\"\n                  value={actionData.refund_amount || ''}\n                  onChange={(e) => setActionData({...actionData, refund_amount: parseFloat(e.target.value)})}\n                  placeholder=\"Refund amount (credits)\"\n                />\n                <Button\n                  onClick={() => handleAction('cancel_booking')}\n                  className=\"w-full font-fredoka bg-red-600 hover:bg-red-700\"\n                >\n                  Cancel Booking\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {actionModal === 'refund' && (\n          <Dialog open={true} onOpenChange={() => { setActionModal(null); setActionData({}); }}>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle className=\"font-fredoka\">Issue Refund</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4 py-4\">\n                <Input\n                  type=\"number\"\n                  value={actionData.amount_credits || ''}\n                  onChange={(e) => setActionData({...actionData, amount_credits: parseFloat(e.target.value), client_email: selectedBooking.client_email})}\n                  placeholder=\"Refund amount (credits)\"\n                />\n                <Textarea\n                  value={actionData.reason || ''}\n                  onChange={(e) => setActionData({...actionData, reason: e.target.value})}\n                  placeholder=\"Reason for refund\"\n                />\n                <Button onClick={() => handleAction('issue_refund')} className=\"w-full font-fredoka\">\n                  Issue Refund\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminBundleOffers.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminCleanerManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":16,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":53,"fix":{"range":[855,867],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[854,866],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Mail' is defined but never used.","line":16,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":59,"fix":{"range":[867,873],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Mail"},"fix":{"range":[866,872],"text":""},"desc":"Remove unused variable 'Mail'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":16,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":69,"fix":{"range":[873,883],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[872,882],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13,"fix":{"range":[883,897],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[882,896],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertTriangle' is defined but never used.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":28,"fix":{"range":[897,912],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertTriangle"},"fix":{"range":[896,911],"text":""},"desc":"Remove unused variable 'AlertTriangle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ChevronDown' is defined but never used.","line":17,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":64,"fix":{"range":[935,948],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ChevronDown"},"fix":{"range":[934,947],"text":""},"desc":"Remove unused variable 'ChevronDown'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingDown' is defined but never used.","line":19,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":49,"fix":{"range":[1050,1064],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[1049,1063],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Legend' is defined but never used.","line":22,"column":122,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":128,"fix":{"range":[1306,1314],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Legend"},"fix":{"range":[1306,1314],"text":""},"desc":"Remove unused variable 'Legend'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { AdminAuditLogger } from '@/components/admin/AdminAuditLogger';\nimport RiskScoreDisplay from '@/components/risk/RiskScoreDisplay';\nimport {\n  Users, Star, Loader2, Ban, CheckCircle, TrendingUp, Mail, Calendar,\n  DollarSign, AlertTriangle, Filter, X, Grid, List, ChevronDown,\n  Edit, MessageSquare, Award, Clock, MapPin, Briefcase, Activity,\n  CheckSquare, Download, BarChart3, TrendingDown, Shield, BookmarkCheck, ChevronRight, Hash\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { BarChart, Bar, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, Legend } from 'recharts';\nimport { getTierBadgeColor, getTierCardClasses, getTierChartColor, getTierSolidColor } from '../components/utils/tierColors';\n\nexport default function AdminCleanerManagement() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [cleaners, setCleaners] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedCleaner, setSelectedCleaner] = useState(null);\n  const [cleanerDetails, setCleanerDetails] = useState(null);\n  const [viewMode, setViewMode] = useState('cards'); // 'cards' or 'table'\n  const [selectedCleaners, setSelectedCleaners] = useState([]);\n  const [showFilters, setShowFilters] = useState(false);\n  const [detailsTab, setDetailsTab] = useState('overview');\n  const [editMode, setEditMode] = useState(false);\n  const [editData, setEditData] = useState({});\n  const [loadingDetails, setLoadingDetails] = useState(false);\n  const [currentPage, setCurrentPage] = useState(1);\n  const itemsPerPage = 20;\n  const [expandedTiers, setExpandedTiers] = useState({\n    'Elite': true,\n    'Pro': true,\n    'Semi Pro': true,\n    'Developing': true\n  });\n  \n  // Filters\n  const [filters, setFilters] = useState({\n    tier: [],\n    status: [],\n    minRating: 0,\n    serviceTags: [],\n    minJobs: 0\n  });\n\n  // Saved views\n  const [savedViews, setSavedViews] = useState([]);\n  const [currentView, setCurrentView] = useState('default');\n\n  useEffect(() => {\n    checkAdminAndLoad();\n    loadSavedViews();\n  }, []);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n      await loadCleaners();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadCleaners = async () => {\n    setLoading(true);\n    try {\n      const profiles = await base44.entities.CleanerProfile.list('-created_date', 300);\n      setCleaners(profiles);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading cleaners:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const loadSavedViews = async () => {\n    try {\n      const views = await base44.entities.AdminSavedView.filter({\n        target: 'cleaners'\n      });\n      setSavedViews(views);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading saved views:', showToast: false });\n    }\n  };\n\n  const loadCleanerDetails = async (cleaner) => {\n    setLoadingDetails(true);\n    try {\n      const [bookings, disputes, earnings, riskProfiles, analytics, auditLogs] = await Promise.all([\n        base44.entities.Booking.filter({ cleaner_email: cleaner.user_email }),\n        base44.entities.Dispute.filter({ filed_by_email: cleaner.user_email }),\n        base44.entities.CleanerEarning.filter({ cleaner_email: cleaner.user_email }),\n        base44.entities.RiskProfile.filter({ user_email: cleaner.user_email, user_type: 'cleaner' }),\n        base44.entities.CleanerAnalytics.filter({ cleaner_email: cleaner.user_email }),\n        base44.entities.AdminAuditLog.filter({ target_type: 'cleaner', target_id: cleaner.user_email })\n      ]);\n\n      const completedJobs = bookings.filter(b => b.status === 'completed' || b.status === 'approved').length;\n      const totalEarnings = earnings\n        .filter(e => e.status === 'paid')\n        .reduce((sum, e) => sum + (e.credits_earned || 0), 0);\n\n      // Calculate monthly stats for charts\n      const monthlyData = calculateMonthlyStats(bookings, earnings);\n\n      // Calculate onboarding progress\n      const onboardingProgress = calculateOnboardingProgress(cleaner, bookings);\n\n      setCleanerDetails({\n        ...cleaner,\n        totalBookings: bookings.length,\n        completedJobs,\n        disputes: disputes.length,\n        totalEarnings,\n        bookings,\n        earnings,\n        monthlyData,\n        riskProfile: riskProfiles.length > 0 ? riskProfiles[0] : null,\n        analytics: analytics.length > 0 ? analytics[0] : null,\n        auditLogs: auditLogs.sort((a, b) => new Date(b.created_date) - new Date(a.created_date)),\n        onboardingProgress\n      });\n      \n      setSelectedCleaner(cleaner);\n      setEditData({\n        tier: cleaner.tier,\n        payout_percentage: cleaner.payout_percentage,\n        base_rate_credits_per_hour: cleaner.base_rate_credits_per_hour,\n        is_active: cleaner.is_active\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading cleaner details:', showToast: false });\n    } finally {\n      setLoadingDetails(false);\n    }\n  };\n\n  const calculateMonthlyStats = (bookings, earnings) => {\n    const monthlyMap = {};\n    const now = new Date();\n    \n    // Last 6 months\n    for (let i = 5; i >= 0; i--) {\n      const date = new Date(now.getFullYear(), now.getMonth() - i, 1);\n      const key = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n      monthlyMap[key] = { month: key, jobs: 0, earnings: 0 };\n    }\n\n    bookings.forEach(b => {\n      const date = new Date(b.created_date);\n      const key = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n      if (monthlyMap[key]) {\n        monthlyMap[key].jobs++;\n      }\n    });\n\n    earnings.forEach(e => {\n      if (e.status === 'paid' && e.created_date) {\n        const date = new Date(e.created_date);\n        const key = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n        if (monthlyMap[key]) {\n          monthlyMap[key].earnings += (e.credits_earned || 0) / 10;\n        }\n      }\n    });\n\n    return Object.values(monthlyMap);\n  };\n\n  const calculateOnboardingProgress = (cleaner, bookings) => {\n    const steps = [\n      { id: 'profile_photo', label: 'Profile Photo', completed: !!cleaner.profile_photo_url },\n      { id: 'bio', label: 'Bio Written', completed: !!cleaner.bio },\n      { id: 'availability', label: 'Availability Set', completed: cleaner.availability && cleaner.availability.length > 0 },\n      { id: 'pricing', label: 'Pricing Configured', completed: !!cleaner.base_rate_credits_per_hour },\n      { id: 'first_job', label: 'First Job Completed', completed: bookings.some(b => b.status === 'completed' || b.status === 'approved') },\n      { id: 'stripe', label: 'Stripe Connected', completed: !!cleaner.stripe_account_id }\n    ];\n\n    const completedSteps = steps.filter(s => s.completed).length;\n    const progress = (completedSteps / steps.length) * 100;\n\n    return { steps, completedSteps, totalSteps: steps.length, progress };\n  };\n\n  const handleSuspendCleaner = async () => {\n    if (!cleanerDetails) return;\n    \n    const hasPermission = await AdminPermissions.hasCapability(user.email, 'can_block_users');\n    if (!hasPermission) {\n      alert('You do not have permission to suspend cleaners');\n      return;\n    }\n\n    const reason = prompt('Reason for suspension:');\n    if (!reason) return;\n\n    try {\n      await AdminAuditLogger.log({\n        adminEmail: user.email,\n        actionType: 'SUSPEND_CLEANER',\n        targetType: 'cleaner',\n        targetId: cleanerDetails.user_email,\n        beforeState: { is_active: cleanerDetails.is_active },\n        afterState: { is_active: false },\n        metadata: { reason }\n      });\n\n      await base44.entities.CleanerProfile.update(cleanerDetails.id, {\n        is_active: false\n      });\n\n      alert('Cleaner suspended');\n      setSelectedCleaner(null);\n      loadCleaners();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error suspending cleaner:', showToast: false });\n      alert('Failed to suspend cleaner');\n    }\n  };\n\n  const handleReactivateCleaner = async () => {\n    if (!cleanerDetails) return;\n\n    try {\n      await AdminAuditLogger.log({\n        adminEmail: user.email,\n        actionType: 'REACTIVATE_CLEANER',\n        targetType: 'cleaner',\n        targetId: cleanerDetails.user_email,\n        beforeState: { is_active: cleanerDetails.is_active },\n        afterState: { is_active: true },\n        metadata: {}\n      });\n\n      await base44.entities.CleanerProfile.update(cleanerDetails.id, {\n        is_active: true\n      });\n\n      alert('Cleaner reactivated');\n      setSelectedCleaner(null);\n      loadCleaners();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error reactivating cleaner:', showToast: false });\n      alert('Failed to reactivate cleaner');\n    }\n  };\n\n  const handleSaveEdit = async () => {\n    if (!cleanerDetails) return;\n\n    try {\n      await AdminAuditLogger.log({\n        adminEmail: user.email,\n        actionType: 'UPDATE_CLEANER_PROFILE',\n        targetType: 'cleaner',\n        targetId: cleanerDetails.user_email,\n        beforeState: {\n          tier: cleanerDetails.tier,\n          payout_percentage: cleanerDetails.payout_percentage,\n          base_rate_credits_per_hour: cleanerDetails.base_rate_credits_per_hour,\n          is_active: cleanerDetails.is_active\n        },\n        afterState: editData,\n        metadata: {}\n      });\n\n      await base44.entities.CleanerProfile.update(cleanerDetails.id, editData);\n\n      alert('Cleaner profile updated');\n      setEditMode(false);\n      loadCleanerDetails(cleanerDetails);\n      loadCleaners();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error updating cleaner:', showToast: false });\n      alert('Failed to update cleaner');\n    }\n  };\n\n  const handleBulkAction = async (action) => {\n    if (selectedCleaners.length === 0) {\n      alert('Please select cleaners first');\n      return;\n    }\n\n    const confirmed = confirm(`Are you sure you want to ${action} ${selectedCleaners.length} cleaners?`);\n    if (!confirmed) return;\n\n    try {\n      for (const cleanerId of selectedCleaners) {\n        const cleaner = cleaners.find(c => c.id === cleanerId);\n        if (!cleaner) continue;\n\n        if (action === 'suspend') {\n          await base44.entities.CleanerProfile.update(cleanerId, { is_active: false });\n          await AdminAuditLogger.log({\n            adminEmail: user.email,\n            actionType: 'BULK_SUSPEND_CLEANER',\n            targetType: 'cleaner',\n            targetId: cleaner.user_email,\n            metadata: { bulk: true }\n          });\n        } else if (action === 'reactivate') {\n          await base44.entities.CleanerProfile.update(cleanerId, { is_active: true });\n          await AdminAuditLogger.log({\n            adminEmail: user.email,\n            actionType: 'BULK_REACTIVATE_CLEANER',\n            targetType: 'cleaner',\n            targetId: cleaner.user_email,\n            metadata: { bulk: true }\n          });\n        }\n      }\n\n      alert(`Bulk action completed for ${selectedCleaners.length} cleaners`);\n      setSelectedCleaners([]);\n      loadCleaners();\n    } catch (error) {\n      handleError(error, { userMessage: 'Bulk action error:', showToast: false });\n      alert('Failed to complete bulk action');\n    }\n  };\n\n  const handleSaveView = async () => {\n    const viewName = prompt('Enter a name for this view:');\n    if (!viewName) return;\n\n    try {\n      await base44.entities.AdminSavedView.create({\n        admin_email: user.email,\n        name: viewName,\n        target: 'cleaners',\n        filters: filters,\n        sort: {},\n        is_shared: false\n      });\n\n      alert('View saved');\n      loadSavedViews();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving view:', showToast: false });\n      alert('Failed to save view');\n    }\n  };\n\n  const handleLoadView = (view) => {\n    setFilters(view.filters);\n    setCurrentView(view.name);\n  };\n\n\n\n  const toggleTier = (tier) => {\n    setExpandedTiers(prev => ({\n      ...prev,\n      [tier]: !prev[tier]\n    }));\n  };\n\n  const getActivityStatus = (cleaner) => {\n    // Check for banned status (not active but has specific risk flags)\n    if (!cleaner.is_active) {\n      const isBanned = (cleaner.dispute_rate > 50 || cleaner.no_show_rate > 50);\n      if (isBanned) {\n        return { status: 'banned', label: 'Banned', color: 'gradient-red-orange' };\n      }\n      return { status: 'suspended', label: 'Suspended', color: 'bg-red-500' };\n    }\n    \n    // Check if cleaner is actually active (has recent activity)\n    if (cleaner.updated_date) {\n      const lastUpdate = new Date(cleaner.updated_date);\n      const daysSinceUpdate = (Date.now() - lastUpdate.getTime()) / (1000 * 60 * 60 * 24);\n      \n      if (daysSinceUpdate < 7) {\n        return { status: 'active', label: 'Active', color: 'bg-green-500' };\n      }\n    }\n    \n    // Default to inactive if no recent activity\n    return { status: 'inactive', label: 'Inactive', color: 'bg-gray-500' };\n  };\n\n  const filteredCleaners = cleaners.filter(c => {\n    // Search term\n    if (searchTerm) {\n      const search = searchTerm.toLowerCase();\n      const matchesSearch = \n        c.user_email.toLowerCase().includes(search) ||\n        (c.full_name && c.full_name.toLowerCase().includes(search));\n      if (!matchesSearch) return false;\n    }\n\n    // Tier filter\n    if (filters.tier.length > 0 && !filters.tier.includes(c.tier)) return false;\n\n    // Status filter\n    if (filters.status.length > 0) {\n      if (filters.status.includes('active') && !c.is_active) return false;\n      if (filters.status.includes('suspended') && c.is_active) return false;\n    }\n\n    // Min rating filter\n    if (filters.minRating > 0 && (c.average_rating || 0) < filters.minRating) return false;\n\n    // Min jobs filter\n    if (filters.minJobs > 0 && (c.total_jobs || 0) < filters.minJobs) return false;\n\n    // Service tags filter\n    if (filters.serviceTags.length > 0) {\n      const cleanerTags = c.service_tags || [];\n      const hasTag = filters.serviceTags.some(tag => cleanerTags.includes(tag));\n      if (!hasTag) return false;\n    }\n\n    return true;\n  });\n\n  const handleExportCleaners = () => {\n    const csvData = filteredCleaners.map(c => ({\n      Email: c.user_email,\n      Name: c.full_name || '',\n      Tier: c.tier,\n      'Reliability Score': c.reliability_score || 0,\n      'Total Jobs': c.total_jobs || 0,\n      'Average Rating': c.average_rating || 0,\n      'Total Reviews': c.total_reviews || 0,\n      Status: c.is_active ? 'Active' : 'Suspended',\n      'Service Locations': (c.service_locations || []).join('; ')\n    }));\n\n    const headers = Object.keys(csvData[0] || {});\n    const csvContent = [\n      headers.join(','),\n      ...csvData.map(row => headers.map(h => `\"${row[h]}\"`).join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `cleaners_export_${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  // Tier distribution\n  const tierDistribution = ['Elite', 'Pro', 'Semi Pro', 'Developing'].map(tier => ({\n    tier,\n    count: filteredCleaners.filter(c => c.tier === tier).length,\n    percentage: ((filteredCleaners.filter(c => c.tier === tier).length / filteredCleaners.length) * 100).toFixed(1)\n  }));\n\n  // Group cleaners by tier\n  const cleanersByTier = {\n    'Elite': filteredCleaners.filter(c => c.tier === 'Elite'),\n    'Pro': filteredCleaners.filter(c => c.tier === 'Pro'),\n    'Semi Pro': filteredCleaners.filter(c => c.tier === 'Semi Pro'),\n    'Developing': filteredCleaners.filter(c => c.tier === 'Developing')\n  };\n\n  // Pagination\n  const totalPages = Math.ceil(filteredCleaners.length / itemsPerPage);\n  const paginatedCleaners = filteredCleaners.slice(\n    (currentPage - 1) * itemsPerPage,\n    currentPage * itemsPerPage\n  );\n\n  const toggleCleanerSelection = (cleanerId) => {\n    setSelectedCleaners(prev =>\n      prev.includes(cleanerId)\n        ? prev.filter(id => id !== cleanerId)\n        : [...prev, cleanerId]\n    );\n  };\n\n  const selectAllCleaners = () => {\n    if (selectedCleaners.length === paginatedCleaners.length) {\n      setSelectedCleaners([]);\n    } else {\n      setSelectedCleaners(paginatedCleaners.map(c => c.id));\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-start justify-between mb-6\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Cleaner Management</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">\n              {filteredCleaners.length} cleaners {selectedCleaners.length > 0 && `‚Ä¢ ${selectedCleaners.length} selected`}\n            </p>\n          </div>\n          \n          {/* Status Legend */}\n          <Card className=\"border-2 border-gray-200 shadow-sm\">\n            <CardContent className=\"p-3\">\n              <p className=\"text-xs font-fredoka font-bold text-gray-700 mb-2\">Status Legend</p>\n              <div className=\"space-y-1.5\">\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 rounded-full bg-green-500\"></div>\n                  <span className=\"text-xs font-verdana text-gray-700\">Active</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 rounded-full bg-gray-500\"></div>\n                  <span className=\"text-xs font-verdana text-gray-700\">Inactive</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 rounded-full bg-red-500\"></div>\n                  <span className=\"text-xs font-verdana text-gray-700\">Suspended</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"w-3 h-3 rounded-full\" style={{ background: 'linear-gradient(90deg, #ef4444 50%, #f97316 50%)' }}></div>\n                  <span className=\"text-xs font-verdana text-gray-700\">Banned</span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"flex items-center justify-end gap-2\">\n          <Button onClick={() => setViewMode(viewMode === 'cards' ? 'table' : 'cards')} variant=\"outline\" className=\"font-fredoka\">\n            {viewMode === 'cards' ? <List className=\"w-4 h-4 mr-2\" /> : <Grid className=\"w-4 h-4 mr-2\" />}\n            {viewMode === 'cards' ? 'Table View' : 'Card View'}\n          </Button>\n          <Button onClick={() => setShowFilters(!showFilters)} variant=\"outline\" className=\"font-fredoka\">\n            <Filter className=\"w-4 h-4 mr-2\" />\n            Filters\n          </Button>\n          <Button onClick={handleExportCleaners} variant=\"outline\" className=\"font-fredoka\">\n            <Download className=\"w-4 h-4 mr-2\" />\n            Export CSV\n          </Button>\n        </div>\n\n        {/* Tier Distribution Chart */}\n        <Card className=\"border-2 border-puretask-blue\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka flex items-center gap-2\">\n              <BarChart3 className=\"w-5 h-5 text-puretask-blue\" />\n              Cleaner Tier Distribution\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <div>\n                <ResponsiveContainer width=\"100%\" height={200}>\n                  <PieChart>\n                    <Pie\n                      data={tierDistribution}\n                      dataKey=\"count\"\n                      nameKey=\"tier\"\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      outerRadius={80}\n                      label={(entry) => `${entry.tier}: ${entry.count}`}\n                    >\n                      {tierDistribution.map((entry, index) => (\n                        <Cell key={`cell-${index}`} fill={getTierChartColor(entry.tier)} />\n                      ))}\n                    </Pie>\n                    <Tooltip />\n                  </PieChart>\n                </ResponsiveContainer>\n              </div>\n              <div className=\"space-y-3\">\n                {tierDistribution.map(tier => (\n                  <div key={tier.tier} className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-4 h-4 rounded\" style={{ backgroundColor: getTierSolidColor(tier.tier) }}></div>\n                      <span className=\"font-fredoka font-semibold\">{tier.tier}</span>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"font-verdana text-gray-600\">{tier.count} cleaners</span>\n                      <Badge className={getTierBadgeColor(tier.tier)}>{tier.percentage}%</Badge>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Filters Panel */}\n        <AnimatePresence>\n          {showFilters && (\n            <motion.div initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: 'auto' }} exit={{ opacity: 0, height: 0 }}>\n              <Card className=\"border-2 border-puretask-blue\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center justify-between font-fredoka\">\n                    <span>Advanced Filters</span>\n                    <Button onClick={() => setFilters({ tier: [], status: [], minRating: 0, serviceTags: [], minJobs: 0 })} variant=\"ghost\" size=\"sm\">\n                      Clear All\n                    </Button>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"grid md:grid-cols-3 gap-4\">\n                    {/* Tier Filter */}\n                    <div>\n                      <label className=\"block text-sm font-fredoka font-semibold mb-2\">Tier</label>\n                      <div className=\"space-y-2\">\n                        {['Elite', 'Pro', 'Semi Pro', 'Developing'].map(tier => (\n                          <label key={tier} className=\"flex items-center gap-2\">\n                            <Checkbox\n                              checked={filters.tier.includes(tier)}\n                              onCheckedChange={(checked) => {\n                                setFilters(prev => ({\n                                  ...prev,\n                                  tier: checked ? [...prev.tier, tier] : prev.tier.filter(t => t !== tier)\n                                }));\n                              }}\n                            />\n                            <span className=\"text-sm font-verdana\">{tier}</span>\n                          </label>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Status Filter */}\n                    <div>\n                      <label className=\"block text-sm font-fredoka font-semibold mb-2\">Status</label>\n                      <div className=\"space-y-2\">\n                        {['active', 'suspended'].map(status => (\n                          <label key={status} className=\"flex items-center gap-2\">\n                            <Checkbox\n                              checked={filters.status.includes(status)}\n                              onCheckedChange={(checked) => {\n                                setFilters(prev => ({\n                                  ...prev,\n                                  status: checked ? [...prev.status, status] : prev.status.filter(s => s !== status)\n                                }));\n                              }}\n                            />\n                            <span className=\"text-sm font-verdana capitalize\">{status}</span>\n                          </label>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Min Jobs Filter */}\n                    <div>\n                      <label className=\"block text-sm font-fredoka font-semibold mb-2\">Min Jobs Completed</label>\n                      <Input\n                        type=\"number\"\n                        value={filters.minJobs}\n                        onChange={(e) => setFilters(prev => ({ ...prev, minJobs: parseInt(e.target.value) || 0 }))}\n                        className=\"font-verdana\"\n                      />\n                    </div>\n                  </div>\n\n                  {/* Service Tags Filter */}\n                  <div className=\"pt-4 border-t\">\n                    <label className=\"block text-sm font-fredoka font-semibold mb-2\">Service Tags</label>\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\n                      {['Pet-Friendly', 'Eco-Warrior', 'Deep Clean Expert', 'Move-Out Specialist', 'Same-Day Available', 'Senior-Friendly'].map(tag => (\n                        <label key={tag} className=\"flex items-center gap-2\">\n                          <Checkbox\n                            checked={filters.serviceTags.includes(tag)}\n                            onCheckedChange={(checked) => {\n                              setFilters(prev => ({\n                                ...prev,\n                                serviceTags: checked ? [...prev.serviceTags, tag] : prev.serviceTags.filter(t => t !== tag)\n                              }));\n                            }}\n                          />\n                          <span className=\"text-xs font-verdana\">{tag}</span>\n                        </label>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* Saved Views */}\n                  <div className=\"pt-4 border-t\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <label className=\"text-sm font-fredoka font-semibold\">Saved Views</label>\n                      <Button onClick={handleSaveView} size=\"sm\" variant=\"outline\" className=\"font-fredoka\">\n                        <BookmarkCheck className=\"w-4 h-4 mr-1\" />\n                        Save Current View\n                      </Button>\n                    </div>\n                    <div className=\"flex gap-2 flex-wrap\">\n                      {savedViews.map(view => (\n                        <Button\n                          key={view.id}\n                          onClick={() => handleLoadView(view)}\n                          size=\"sm\"\n                          variant={currentView === view.name ? \"default\" : \"outline\"}\n                          className=\"font-fredoka\"\n                        >\n                          {view.name}\n                        </Button>\n                      ))}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Bulk Actions Bar */}\n        {selectedCleaners.length > 0 && (\n          <Card className=\"border-2 border-puretask-blue bg-blue-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"font-fredoka font-semibold text-graphite\">\n                  {selectedCleaners.length} cleaner{selectedCleaners.length !== 1 ? 's' : ''} selected\n                </span>\n                <div className=\"flex gap-2\">\n                  <Button onClick={() => handleBulkAction('suspend')} variant=\"outline\" size=\"sm\" className=\"font-fredoka\">\n                    <Ban className=\"w-4 h-4 mr-2\" />\n                    Suspend Selected\n                  </Button>\n                  <Button onClick={() => handleBulkAction('reactivate')} variant=\"outline\" size=\"sm\" className=\"font-fredoka\">\n                    <CheckCircle className=\"w-4 h-4 mr-2\" />\n                    Reactivate Selected\n                  </Button>\n                  <Button onClick={() => setSelectedCleaners([])} variant=\"ghost\" size=\"sm\" className=\"font-fredoka\">\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Search Bar */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center gap-4\">\n              <Checkbox\n                checked={selectedCleaners.length === paginatedCleaners.length && paginatedCleaners.length > 0}\n                onCheckedChange={selectAllCleaners}\n              />\n              <Input\n                placeholder=\"Search by email or name...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"font-verdana flex-1\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Cleaners List - Grouped by Tier */}\n        {viewMode === 'cards' ? (\n          <div className=\"space-y-6\">\n            {['Elite', 'Pro', 'Semi Pro', 'Developing'].map(tierName => {\n              const tieredCleaners = cleanersByTier[tierName];\n              if (tieredCleaners.length === 0) return null;\n\n              return (\n                <div key={tierName}>\n                  <Card \n                    className={`cursor-pointer hover:shadow-md transition-all ${getTierCardClasses(tierName)}`}\n                    onClick={() => toggleTier(tierName)}\n                  >\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-3\">\n                          <motion.div\n                            animate={{ rotate: expandedTiers[tierName] ? 90 : 0 }}\n                            transition={{ duration: 0.2 }}\n                          >\n                            <ChevronRight className=\"w-5 h-5 text-gray-600\" />\n                          </motion.div>\n                          <Award className=\"w-6 h-6\" style={{ color: getTierSolidColor(tierName) }} />\n                          <h3 className=\"text-xl font-fredoka font-bold text-graphite\">{tierName} Tier</h3>\n                          <Badge className={`${getTierBadgeColor(tierName)} border font-fredoka`}>\n                            {tieredCleaners.length} cleaners\n                          </Badge>\n                        </div>\n                        <Button variant=\"ghost\" size=\"sm\" onClick={(e) => { e.stopPropagation(); toggleTier(tierName); }}>\n                          {expandedTiers[tierName] ? 'Collapse' : 'Expand'}\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <AnimatePresence>\n                    {expandedTiers[tierName] && (\n                      <motion.div\n                        initial={{ opacity: 0, height: 0 }}\n                        animate={{ opacity: 1, height: 'auto' }}\n                        exit={{ opacity: 0, height: 0 }}\n                        transition={{ duration: 0.3 }}\n                        className=\"space-y-3 mt-3\"\n                      >\n                        {tieredCleaners.map((cleaner, idx) => {\n            const activityStatus = getActivityStatus(cleaner);\n            const isSelected = selectedCleaners.includes(cleaner.id);\n\n            return (\n              <motion.div\n                key={cleaner.id}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.02 }}\n              >\n                <Card className={`hover:shadow-lg transition-all cursor-pointer ${isSelected ? 'border-2 border-puretask-blue bg-blue-50' : ''}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <Checkbox\n                        checked={isSelected}\n                        onCheckedChange={() => toggleCleanerSelection(cleaner.id)}\n                        onClick={(e) => e.stopPropagation()}\n                      />\n\n                      <div className=\"relative\">\n                        <div className=\"w-14 h-14 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold text-xl\">\n                          {cleaner.user_email[0].toUpperCase()}\n                        </div>\n                        {activityStatus.color === 'gradient-red-orange' ? (\n                          <div className=\"absolute -bottom-1 -right-1 w-4 h-4 rounded-full border-2 border-white\" style={{ background: 'linear-gradient(90deg, #ef4444 50%, #f97316 50%)' }}></div>\n                        ) : (\n                          <div className={`absolute -bottom-1 -right-1 w-4 h-4 rounded-full border-2 border-white ${activityStatus.color}`}></div>\n                        )}\n                      </div>\n\n                      <div className=\"flex-1\" onClick={() => loadCleanerDetails(cleaner)}>\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <p className=\"font-fredoka font-bold text-lg text-graphite\">{cleaner.full_name || cleaner.user_email}</p>\n                          {cleaner.cleaner_id && (\n                            <Badge variant=\"outline\" className=\"font-mono text-xs font-semibold flex items-center gap-1\">\n                              <Hash className=\"w-3 h-3\" />\n                              {cleaner.cleaner_id}\n                            </Badge>\n                          )}\n                          <Badge className={`${getTierBadgeColor(cleaner.tier)} border font-fredoka`}>\n                            {cleaner.tier}\n                          </Badge>\n                          {!cleaner.is_active && (\n                            <Badge className=\"bg-red-100 text-red-800 border-red-300 border font-fredoka\">Suspended</Badge>\n                          )}\n                        </div>\n\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm\">\n                          <div className=\"flex items-center gap-1 text-gray-700\">\n                            <Star className=\"w-4 h-4 text-yellow-500\" />\n                            <span className=\"font-verdana font-semibold\">{cleaner.average_rating?.toFixed(1) || '5.0'}</span>\n                            <span className=\"text-gray-500 font-verdana\">({cleaner.total_reviews || 0})</span>\n                          </div>\n\n                          <div className=\"flex items-center gap-1 text-gray-700\">\n                            <Briefcase className=\"w-4 h-4 text-puretask-blue\" />\n                            <span className=\"font-verdana\">{cleaner.total_jobs || 0} jobs</span>\n                          </div>\n\n                          <div className=\"flex items-center gap-1 text-gray-700\">\n                            <Activity className=\"w-4 h-4 text-green-500\" />\n                            <span className=\"font-verdana\">{cleaner.reliability_score || 75}%</span>\n                          </div>\n\n                          <div className=\"flex items-center gap-1 text-gray-700\">\n                            <MapPin className=\"w-4 h-4 text-gray-500\" />\n                            <span className=\"font-verdana\">{cleaner.service_locations?.[0] || 'N/A'}</span>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex gap-2\" onClick={(e) => e.stopPropagation()}>\n                        <Button onClick={() => loadCleanerDetails(cleaner)} size=\"sm\" variant=\"outline\" className=\"font-fredoka\">\n                          View Details\n                        </Button>\n                        <Button size=\"sm\" variant=\"ghost\" className=\"font-fredoka\">\n                          <MessageSquare className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n            })}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n            );\n            })}\n            </div>\n        ) : (\n          /* Table View */\n          <Card>\n            <CardContent className=\"p-0\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50 border-b\">\n                    <tr>\n                      <th className=\"px-4 py-3 text-left\">\n                        <Checkbox\n                          checked={selectedCleaners.length === paginatedCleaners.length && paginatedCleaners.length > 0}\n                          onCheckedChange={selectAllCleaners}\n                        />\n                      </th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Cleaner</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Tier</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Rating</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Jobs</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Reliability</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Status</th>\n                      <th className=\"px-4 py-3 text-left font-fredoka text-sm\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {paginatedCleaners.map((cleaner) => {\n                      const isSelected = selectedCleaners.includes(cleaner.id);\n                      return (\n                        <tr key={cleaner.id} className={`border-b hover:bg-gray-50 ${isSelected ? 'bg-blue-50' : ''}`}>\n                          <td className=\"px-4 py-3\">\n                            <Checkbox\n                              checked={isSelected}\n                              onCheckedChange={() => toggleCleanerSelection(cleaner.id)}\n                            />\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"w-10 h-10 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold\">\n                                {cleaner.user_email[0].toUpperCase()}\n                              </div>\n                              <div>\n                                <div className=\"flex items-center gap-2\">\n                                  <p className=\"font-fredoka font-semibold text-graphite\">{cleaner.full_name || cleaner.user_email}</p>\n                                  {cleaner.cleaner_id && (\n                                    <Badge variant=\"outline\" className=\"font-mono text-xs font-semibold\">\n                                      {cleaner.cleaner_id}\n                                    </Badge>\n                                  )}\n                                </div>\n                                <p className=\"text-xs text-gray-500 font-verdana\">{cleaner.user_email}</p>\n                              </div>\n                            </div>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                           <Badge className={`${getTierBadgeColor(cleaner.tier)} border font-fredoka text-xs`}>\n                             {cleaner.tier}\n                           </Badge>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <div className=\"flex items-center gap-1\">\n                              <Star className=\"w-4 h-4 text-yellow-500\" />\n                              <span className=\"font-verdana text-sm\">{cleaner.average_rating?.toFixed(1) || '5.0'}</span>\n                            </div>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <span className=\"font-verdana text-sm\">{cleaner.total_jobs || 0}</span>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <span className=\"font-verdana text-sm\">{cleaner.reliability_score || 75}%</span>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <Badge className={cleaner.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}>\n                              {cleaner.is_active ? 'Active' : 'Suspended'}\n                            </Badge>\n                          </td>\n                          <td className=\"px-4 py-3\">\n                            <Button onClick={() => loadCleanerDetails(cleaner)} size=\"sm\" variant=\"outline\" className=\"font-fredoka text-xs\">\n                              View\n                            </Button>\n                          </td>\n                        </tr>\n                      );\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Pagination */}\n        {totalPages > 1 && (\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <p className=\"text-sm text-gray-600 font-verdana\">\n                  Showing {(currentPage - 1) * itemsPerPage + 1} to {Math.min(currentPage * itemsPerPage, filteredCleaners.length)} of {filteredCleaners.length}\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                    disabled={currentPage === 1}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"font-fredoka\"\n                  >\n                    Previous\n                  </Button>\n                  {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                    let pageNum;\n                    if (totalPages <= 5) {\n                      pageNum = i + 1;\n                    } else if (currentPage <= 3) {\n                      pageNum = i + 1;\n                    } else if (currentPage >= totalPages - 2) {\n                      pageNum = totalPages - 4 + i;\n                    } else {\n                      pageNum = currentPage - 2 + i;\n                    }\n                    \n                    return (\n                      <Button\n                        key={pageNum}\n                        onClick={() => setCurrentPage(pageNum)}\n                        variant={currentPage === pageNum ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        className=\"font-fredoka\"\n                      >\n                        {pageNum}\n                      </Button>\n                    );\n                  })}\n                  <Button\n                    onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                    disabled={currentPage === totalPages}\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"font-fredoka\"\n                  >\n                    Next\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Enhanced Cleaner Details Modal */}\n      {selectedCleaner && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={() => setSelectedCleaner(null)}>\n          {loadingDetails ? (\n            <Card className=\"max-w-md w-full\" onClick={(e) => e.stopPropagation()}>\n              <CardContent className=\"p-12 text-center\">\n                <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue mx-auto mb-4\" />\n                <p className=\"text-gray-600 font-verdana\">Loading cleaner details...</p>\n              </CardContent>\n            </Card>\n          ) : cleanerDetails ? (\n          <Card className=\"max-w-6xl w-full max-h-[90vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n            <CardHeader className=\"border-b\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                  <Users className=\"w-6 h-6 text-puretask-blue\" />\n                  {cleanerDetails.full_name || cleanerDetails.user_email}\n                  {cleanerDetails.cleaner_id && (\n                    <Badge variant=\"outline\" className=\"font-mono text-sm font-bold flex items-center gap-1\">\n                      <Hash className=\"w-4 h-4\" />\n                      {cleanerDetails.cleaner_id}\n                    </Badge>\n                  )}\n                </CardTitle>\n                <div className=\"flex gap-2\">\n                  <Button onClick={() => setEditMode(!editMode)} size=\"sm\" variant=\"outline\" className=\"font-fredoka\">\n                    <Edit className=\"w-4 h-4 mr-2\" />\n                    {editMode ? 'Cancel Edit' : 'Edit'}\n                  </Button>\n                  <Button onClick={() => setSelectedCleaner(null)} variant=\"ghost\" size=\"sm\">\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n\n            <CardContent className=\"p-6\">\n              <Tabs value={detailsTab} onValueChange={setDetailsTab}>\n                <TabsList className=\"grid w-full grid-cols-6 mb-6\">\n                  <TabsTrigger value=\"overview\" className=\"font-fredoka\">Overview</TabsTrigger>\n                  <TabsTrigger value=\"bookings\" className=\"font-fredoka\">Bookings</TabsTrigger>\n                  <TabsTrigger value=\"performance\" className=\"font-fredoka\">Performance</TabsTrigger>\n                  <TabsTrigger value=\"payouts\" className=\"font-fredoka\">Payouts</TabsTrigger>\n                  <TabsTrigger value=\"risk\" className=\"font-fredoka\">Risk</TabsTrigger>\n                  <TabsTrigger value=\"audit\" className=\"font-fredoka\">Audit Log</TabsTrigger>\n                </TabsList>\n\n                {/* Overview Tab */}\n                <TabsContent value=\"overview\" className=\"space-y-6\">\n                  <div className=\"grid md:grid-cols-4 gap-4\">\n                    <div className=\"p-4 bg-blue-50 rounded-xl border-2 border-blue-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Reliability Score</p>\n                      <p className=\"text-3xl font-fredoka font-bold text-graphite\">{cleanerDetails.reliability_score || 0}%</p>\n                    </div>\n                    <div className=\"p-4 bg-green-50 rounded-xl border-2 border-green-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Completed Jobs</p>\n                      <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">{cleanerDetails.completedJobs}</p>\n                    </div>\n                    <div className=\"p-4 bg-purple-50 rounded-xl border-2 border-purple-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Total Earnings</p>\n                      <p className=\"text-3xl font-fredoka font-bold text-purple-600\">{cleanerDetails.totalEarnings} credits</p>\n                    </div>\n                    <div className=\"p-4 bg-amber-50 rounded-xl border-2 border-amber-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Tier</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-amber-600\">{cleanerDetails.tier}</p>\n                    </div>\n                  </div>\n\n                  {/* Onboarding Progress */}\n                  {cleanerDetails.onboardingProgress && (\n                    <Card className=\"border-2 border-indigo-200 bg-indigo-50\">\n                      <CardHeader>\n                        <CardTitle className=\"font-fredoka text-lg flex items-center gap-2\">\n                          <CheckSquare className=\"w-5 h-5 text-indigo-600\" />\n                          Onboarding Progress ({cleanerDetails.onboardingProgress.completedSteps}/{cleanerDetails.onboardingProgress.totalSteps})\n                        </CardTitle>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"space-y-3\">\n                          {cleanerDetails.onboardingProgress.steps.map(step => (\n                            <div key={step.id} className=\"flex items-center gap-3\">\n                              <div className={`w-6 h-6 rounded-full flex items-center justify-center ${step.completed ? 'bg-green-500' : 'bg-gray-300'}`}>\n                                {step.completed && <CheckCircle className=\"w-4 h-4 text-white\" />}\n                              </div>\n                              <span className={`font-verdana ${step.completed ? 'text-gray-700' : 'text-gray-400'}`}>\n                                {step.label}\n                              </span>\n                            </div>\n                          ))}\n                        </div>\n                        <div className=\"mt-4 bg-gray-200 rounded-full h-3 overflow-hidden\">\n                          <div\n                            className=\"bg-gradient-to-r from-puretask-blue to-cyan-500 h-full transition-all\"\n                            style={{ width: `${cleanerDetails.onboardingProgress.progress}%` }}\n                          ></div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  )}\n\n                  {/* Edit Form */}\n                  {editMode && (\n                    <Card className=\"border-2 border-yellow-300 bg-yellow-50\">\n                      <CardHeader>\n                        <CardTitle className=\"font-fredoka\">Edit Profile</CardTitle>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-semibold mb-2\">Tier</label>\n                          <select\n                            value={editData.tier}\n                            onChange={(e) => setEditData({ ...editData, tier: e.target.value })}\n                            className=\"w-full rounded-xl border-2 p-2 font-verdana\"\n                          >\n                            <option value=\"Developing\">Developing</option>\n                            <option value=\"Semi Pro\">Semi Pro</option>\n                            <option value=\"Pro\">Pro</option>\n                            <option value=\"Elite\">Elite</option>\n                          </select>\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-semibold mb-2\">Payout Percentage</label>\n                          <Input\n                            type=\"number\"\n                            step=\"0.01\"\n                            value={editData.payout_percentage}\n                            onChange={(e) => setEditData({ ...editData, payout_percentage: parseFloat(e.target.value) })}\n                            className=\"font-verdana\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-semibold mb-2\">Base Rate (Credits/Hour)</label>\n                          <Input\n                            type=\"number\"\n                            value={editData.base_rate_credits_per_hour}\n                            onChange={(e) => setEditData({ ...editData, base_rate_credits_per_hour: parseInt(e.target.value) })}\n                            className=\"font-verdana\"\n                          />\n                        </div>\n                        <Button onClick={handleSaveEdit} className=\"w-full brand-gradient text-white font-fredoka\">\n                          Save Changes\n                        </Button>\n                      </CardContent>\n                    </Card>\n                  )}\n                </TabsContent>\n\n                {/* Bookings Tab */}\n                <TabsContent value=\"bookings\" className=\"space-y-4\">\n                  <div className=\"text-center py-4\">\n                    <p className=\"text-2xl font-fredoka font-bold text-graphite\">{cleanerDetails.bookings?.length || 0}</p>\n                    <p className=\"text-gray-600 font-verdana\">Total Bookings</p>\n                  </div>\n                  <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                    {cleanerDetails.bookings?.slice(0, 10).map(booking => (\n                      <Card key={booking.id} className=\"border\">\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex justify-between items-center\">\n                            <div>\n                              <p className=\"font-fredoka font-semibold text-graphite\">{booking.address}</p>\n                              <p className=\"text-sm text-gray-600 font-verdana\">\n                                {new Date(booking.date).toLocaleDateString()} ‚Ä¢ {booking.start_time}\n                              </p>\n                            </div>\n                            <Badge className={\n                              booking.status === 'completed' || booking.status === 'approved' ? 'bg-green-100 text-green-800' :\n                              booking.status === 'cancelled' ? 'bg-red-100 text-red-800' :\n                              'bg-blue-100 text-blue-800'\n                            }>\n                              {booking.status}\n                            </Badge>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                </TabsContent>\n\n                {/* Performance Tab */}\n                <TabsContent value=\"performance\" className=\"space-y-6\">\n                  <div>\n                    <h3 className=\"font-fredoka font-bold text-lg mb-4\">Monthly Jobs</h3>\n                    <ResponsiveContainer width=\"100%\" height={250}>\n                      <BarChart data={cleanerDetails.monthlyData}>\n                        <CartesianGrid strokeDasharray=\"3 3\" />\n                        <XAxis dataKey=\"month\" />\n                        <YAxis />\n                        <Tooltip />\n                        <Bar dataKey=\"jobs\" fill=\"#66B3FF\" />\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-fredoka font-bold text-lg mb-4\">Monthly Earnings</h3>\n                    <ResponsiveContainer width=\"100%\" height={250}>\n                      <LineChart data={cleanerDetails.monthlyData}>\n                        <CartesianGrid strokeDasharray=\"3 3\" />\n                        <XAxis dataKey=\"month\" />\n                        <YAxis />\n                        <Tooltip />\n                        <Line type=\"monotone\" dataKey=\"earnings\" stroke=\"#00D4FF\" strokeWidth={2} />\n                      </LineChart>\n                    </ResponsiveContainer>\n                  </div>\n                </TabsContent>\n\n                {/* Payouts Tab */}\n                <TabsContent value=\"payouts\" className=\"space-y-4\">\n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div className=\"p-4 bg-green-50 rounded-xl text-center\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Paid</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-green-600\">\n                        {cleanerDetails.earnings?.filter(e => e.status === 'paid').length || 0}\n                      </p>\n                    </div>\n                    <div className=\"p-4 bg-yellow-50 rounded-xl text-center\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Pending</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-yellow-600\">\n                        {cleanerDetails.earnings?.filter(e => e.status === 'pending').length || 0}\n                      </p>\n                    </div>\n                    <div className=\"p-4 bg-purple-50 rounded-xl text-center\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">Total Earnings</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-purple-600\">\n                        {cleanerDetails.totalEarnings}\n                      </p>\n                    </div>\n                  </div>\n                </TabsContent>\n\n                {/* Risk Tab */}\n                <TabsContent value=\"risk\">\n                  {cleanerDetails.riskProfile ? (\n                    <RiskScoreDisplay riskProfile={cleanerDetails.riskProfile} />\n                  ) : (\n                    <div className=\"text-center py-12\">\n                      <Shield className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                      <p className=\"text-gray-600 font-verdana\">No risk profile data available</p>\n                    </div>\n                  )}\n                </TabsContent>\n\n                {/* Audit Log Tab */}\n                <TabsContent value=\"audit\" className=\"space-y-3\">\n                  {cleanerDetails.auditLogs && cleanerDetails.auditLogs.length > 0 ? (\n                    <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                      {cleanerDetails.auditLogs.map(log => (\n                        <Card key={log.id} className=\"border\">\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-start gap-3\">\n                              <div className=\"w-8 h-8 bg-puretask-blue rounded-full flex items-center justify-center flex-shrink-0\">\n                                <Activity className=\"w-4 h-4 text-white\" />\n                              </div>\n                              <div className=\"flex-1\">\n                                <p className=\"font-fredoka font-semibold text-graphite\">{log.action_type}</p>\n                                <p className=\"text-sm text-gray-600 font-verdana\">\n                                  by {log.admin_email}\n                                </p>\n                                <p className=\"text-xs text-gray-500 font-verdana\">\n                                  {new Date(log.created_date).toLocaleString()}\n                                </p>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-12\">\n                      <Clock className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                      <p className=\"text-gray-600 font-verdana\">No audit log entries</p>\n                    </div>\n                  )}\n                </TabsContent>\n              </Tabs>\n\n              {/* Action Buttons */}\n              <div className=\"flex gap-3 pt-6 border-t mt-6\">\n                {cleanerDetails.is_active ? (\n                  <Button onClick={handleSuspendCleaner} variant=\"outline\" className=\"font-fredoka text-red-600 border-red-600\">\n                    <Ban className=\"w-4 h-4 mr-2\" />\n                    Suspend Cleaner\n                  </Button>\n                ) : (\n                  <Button onClick={handleReactivateCleaner} className=\"font-fredoka bg-green-600\">\n                    <CheckCircle className=\"w-4 h-4 mr-2\" />\n                    Reactivate\n                  </Button>\n                )}\n                <Button onClick={() => navigate(createPageUrl(`CleanerProfile?email=${cleanerDetails.user_email}`))} variant=\"outline\" className=\"font-fredoka\">\n                  View Public Profile\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n          ) : null}\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminClientJobs.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminClientManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsContent' is defined but never used.","line":10,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":27,"fix":{"range":[474,487],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsContent"},"fix":{"range":[473,486],"text":""},"desc":"Remove unused variable 'TabsContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":14,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":23,"fix":{"range":[767,775],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[766,774],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Gift' is defined but never used.","line":14,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":69,"fix":{"range":[815,821],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Gift"},"fix":{"range":[814,820],"text":""},"desc":"Remove unused variable 'Gift'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { AdminAuditLogger } from '@/components/admin/AdminAuditLogger';\nimport RiskScoreDisplay from '@/components/risk/RiskScoreDisplay';\nimport { Users, Search, Loader2, Wallet, AlertTriangle, Shield, Gift, Award, ChevronRight, Clock, Star, TrendingUp, Hash } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { PieChart, Pie, Cell, Tooltip, ResponsiveContainer } from 'recharts';\n\nexport default function AdminClientManagement() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [clients, setClients] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [clientDetails, setClientDetails] = useState(null);\n  const [expandedCategories, setExpandedCategories] = useState({\n    'high-risk': true,\n    'watch': true,\n    'normal': true,\n    'platinum': true,\n    'plus': true,\n    'standard': true,\n    'high-balance': true,\n    'medium-balance': true,\n    'low-balance': true,\n    'active': true,\n    'inactive': true\n  });\n  const [groupBy, setGroupBy] = useState('risk'); // 'risk', 'membership', 'balance', 'activity'\n\n  useEffect(() => {\n    checkAdminAndLoad();\n  }, []);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n      await loadClients();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadClients = async () => {\n    setLoading(true);\n    try {\n      const [profiles, riskProfiles] = await Promise.all([\n        base44.entities.ClientProfile.list('-created_date', 200),\n        base44.entities.RiskProfile.filter({ user_type: 'client' })\n      ]);\n      \n      // Attach risk profiles to clients\n      const clientsWithRisk = profiles.map(client => {\n        const riskProfile = riskProfiles.find(r => r.user_email === client.user_email);\n        return { ...client, riskProfile };\n      });\n      \n      setClients(clientsWithRisk);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading clients:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const loadClientDetails = async (client) => {\n    try {\n      const [bookings, disputes, credits, riskProfiles, subscriptions, memberships] = await Promise.all([\n        base44.entities.Booking.filter({ client_email: client.user_email }),\n        base44.entities.Dispute.filter({ filed_by_email: client.user_email }),\n        base44.entities.Credit.filter({ user_email: client.user_email }),\n        base44.entities.RiskProfile.filter({ user_email: client.user_email, user_type: 'client' }),\n        base44.entities.CleaningSubscription.filter({ client_email: client.user_email }),\n        base44.entities.ClientMembership.filter({ client_email: client.user_email })\n      ]);\n\n      const creditBalance = credits.length > 0 ? credits[0].balance : 0;\n      const disputeRate = bookings.length > 0 ? (disputes.length / bookings.length) * 100 : 0;\n\n      setClientDetails({\n        ...client,\n        totalBookings: bookings.length,\n        disputes: disputes.length,\n        disputeRate,\n        creditBalance,\n        riskProfile: riskProfiles.length > 0 ? riskProfiles[0] : null,\n        activeSubscriptions: subscriptions.filter(s => s.status === 'active').length,\n        activeMemberships: memberships.filter(m => m.status === 'active').length\n      });\n      \n      setSelectedClient(client);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading client details:', showToast: false });\n    }\n  };\n\n  const handleAdjustCredits = async () => {\n    if (!clientDetails) return;\n    \n    const hasPermission = await AdminPermissions.hasCapability(user.email, 'can_issue_refunds');\n    if (!hasPermission) {\n      alert('You do not have permission to adjust credits');\n      return;\n    }\n\n    const amount = prompt('Enter credit amount (positive to add, negative to deduct):');\n    if (!amount) return;\n    \n    const reason = prompt('Reason for adjustment:');\n    if (!reason) return;\n\n    try {\n      const amountNum = parseFloat(amount);\n      \n      await AdminAuditLogger.log({\n        adminEmail: user.email,\n        actionType: 'ADJUST_CREDITS',\n        targetType: 'client',\n        targetId: clientDetails.user_email,\n        metadata: { amount: amountNum, reason }\n      });\n\n      await base44.entities.CreditTransaction.create({\n        client_email: clientDetails.user_email,\n        transaction_type: amountNum > 0 ? 'adjustment' : 'charge',\n        amount_credits: amountNum,\n        note: `Admin adjustment: ${reason}`\n      });\n\n      alert('Credits adjusted successfully');\n      loadClientDetails(clientDetails);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error adjusting credits:', showToast: false });\n      alert('Failed to adjust credits');\n    }\n  };\n\n  const toggleCategory = (category) => {\n    setExpandedCategories(prev => ({\n      ...prev,\n      [category]: !prev[category]\n    }));\n  };\n\n  const getActivityStatus = (client) => {\n    if (client.updated_date) {\n      const lastUpdate = new Date(client.updated_date);\n      const daysSinceUpdate = (Date.now() - lastUpdate.getTime()) / (1000 * 60 * 60 * 24);\n      return daysSinceUpdate < 30 ? 'active' : 'inactive';\n    }\n    return 'inactive';\n  };\n\n  const getCreditBalanceCategory = (balance) => {\n    if (balance >= 1000) return 'high-balance';\n    if (balance >= 500) return 'medium-balance';\n    return 'low-balance';\n  };\n\n  const getRiskCategory = (client) => {\n    if (!client.riskProfile) return 'normal';\n    const tier = client.riskProfile.risk_tier;\n    if (tier === 'Blocked' || tier === 'Restricted') return 'high-risk';\n    if (tier === 'Watch') return 'watch';\n    return 'normal';\n  };\n\n  const filteredClients = clients.filter(c =>\n    !searchTerm || \n    c.user_email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    (c.client_id && c.client_id.toLowerCase().includes(searchTerm.toLowerCase()))\n  );\n\n  // Group clients based on selected grouping\n  const groupedClients = {};\n  \n  if (groupBy === 'risk') {\n    groupedClients['high-risk'] = filteredClients.filter(c => getRiskCategory(c) === 'high-risk');\n    groupedClients['watch'] = filteredClients.filter(c => getRiskCategory(c) === 'watch');\n    groupedClients['normal'] = filteredClients.filter(c => getRiskCategory(c) === 'normal');\n  } else if (groupBy === 'membership') {\n    groupedClients['platinum'] = filteredClients.filter(c => c.membership_tier === 'Platinum');\n    groupedClients['plus'] = filteredClients.filter(c => c.membership_tier === 'Plus');\n    groupedClients['standard'] = filteredClients.filter(c => c.membership_tier === 'Standard');\n  } else if (groupBy === 'balance') {\n    groupedClients['high-balance'] = filteredClients.filter(c => getCreditBalanceCategory(c.credits_balance || 0) === 'high-balance');\n    groupedClients['medium-balance'] = filteredClients.filter(c => getCreditBalanceCategory(c.credits_balance || 0) === 'medium-balance');\n    groupedClients['low-balance'] = filteredClients.filter(c => getCreditBalanceCategory(c.credits_balance || 0) === 'low-balance');\n  } else if (groupBy === 'activity') {\n    groupedClients['active'] = filteredClients.filter(c => getActivityStatus(c) === 'active');\n    groupedClients['inactive'] = filteredClients.filter(c => getActivityStatus(c) === 'inactive');\n  }\n\n  // Category configurations\n  const categoryConfig = {\n    'high-risk': { label: 'High Risk', color: 'bg-red-500', borderColor: 'border-red-300', bgColor: 'bg-red-50', icon: AlertTriangle },\n    'watch': { label: 'Watch List', color: 'bg-yellow-500', borderColor: 'border-yellow-300', bgColor: 'bg-yellow-50', icon: Shield },\n    'normal': { label: 'Normal Risk', color: 'bg-green-500', borderColor: 'border-green-300', bgColor: 'bg-green-50', icon: Shield },\n    'platinum': { label: 'Platinum Members', color: 'bg-purple-500', borderColor: 'border-purple-300', bgColor: 'bg-purple-50', icon: Award },\n    'plus': { label: 'Plus Members', color: 'bg-blue-500', borderColor: 'border-blue-300', bgColor: 'bg-blue-50', icon: Award },\n    'standard': { label: 'Standard Members', color: 'bg-gray-500', borderColor: 'border-gray-300', bgColor: 'bg-gray-50', icon: Award },\n    'high-balance': { label: 'High Balance (1000+ credits)', color: 'bg-green-500', borderColor: 'border-green-300', bgColor: 'bg-green-50', icon: Wallet },\n    'medium-balance': { label: 'Medium Balance (500-999 credits)', color: 'bg-yellow-500', borderColor: 'border-yellow-300', bgColor: 'bg-yellow-50', icon: Wallet },\n    'low-balance': { label: 'Low Balance (<500 credits)', color: 'bg-red-500', borderColor: 'border-red-300', bgColor: 'bg-red-50', icon: Wallet },\n    'active': { label: 'Active (Last 30 days)', color: 'bg-green-500', borderColor: 'border-green-300', bgColor: 'bg-green-50', icon: TrendingUp },\n    'inactive': { label: 'Inactive (30+ days)', color: 'bg-gray-500', borderColor: 'border-gray-300', bgColor: 'bg-gray-50', icon: Clock }\n  };\n\n  // Distribution data for pie chart\n  const getDistributionData = () => {\n    const data = Object.entries(groupedClients).map(([key, clients]) => ({\n      name: categoryConfig[key]?.label || key,\n      value: clients.length,\n      color: categoryConfig[key]?.color || 'bg-gray-500'\n    }));\n    return data.filter(d => d.value > 0);\n  };\n\n  const distributionData = getDistributionData();\n\n  const getColorFromClass = (colorClass) => {\n    const colorMap = {\n      'bg-red-500': '#ef4444',\n      'bg-yellow-500': '#eab308',\n      'bg-green-500': '#22c55e',\n      'bg-purple-500': '#a855f7',\n      'bg-blue-500': '#3b82f6',\n      'bg-gray-500': '#6b7280'\n    };\n    return colorMap[colorClass] || '#6b7280';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Client Management</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">{filteredClients.length} clients</p>\n        </div>\n\n        {/* Distribution Chart */}\n        <Card className=\"border-2 border-puretask-blue\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka flex items-center gap-2\">\n              <Users className=\"w-5 h-5 text-puretask-blue\" />\n              Client Distribution\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <div>\n                <ResponsiveContainer width=\"100%\" height={200}>\n                  <PieChart>\n                    <Pie\n                      data={distributionData}\n                      dataKey=\"value\"\n                      nameKey=\"name\"\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      outerRadius={80}\n                      label={(entry) => `${entry.name}: ${entry.value}`}\n                    >\n                      {distributionData.map((entry, index) => (\n                        <Cell key={`cell-${index}`} fill={getColorFromClass(entry.color)} />\n                      ))}\n                    </Pie>\n                    <Tooltip />\n                  </PieChart>\n                </ResponsiveContainer>\n              </div>\n              <div className=\"space-y-3\">\n                {distributionData.map(item => (\n                  <div key={item.name} className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className={`w-4 h-4 rounded ${item.color}`}></div>\n                      <span className=\"font-fredoka font-semibold\">{item.name}</span>\n                    </div>\n                    <span className=\"font-verdana text-gray-600\">{item.value} clients</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Group By Tabs */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <Tabs value={groupBy} onValueChange={setGroupBy}>\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"risk\" className=\"font-fredoka\">Risk Assessment</TabsTrigger>\n                <TabsTrigger value=\"membership\" className=\"font-fredoka\">Membership Tier</TabsTrigger>\n                <TabsTrigger value=\"balance\" className=\"font-fredoka\">Credit Balance</TabsTrigger>\n                <TabsTrigger value=\"activity\" className=\"font-fredoka\">Recent Activity</TabsTrigger>\n              </TabsList>\n            </Tabs>\n          </CardContent>\n        </Card>\n\n        {/* Search Bar */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <Input\n              placeholder=\"Search by email or client ID...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"font-verdana\"\n            />\n          </CardContent>\n        </Card>\n\n        {/* Grouped Clients */}\n        <div className=\"space-y-6\">\n          {Object.entries(groupedClients).map(([categoryKey, categoryClients]) => {\n            if (categoryClients.length === 0) return null;\n            const config = categoryConfig[categoryKey];\n\n            return (\n              <div key={categoryKey}>\n                <Card \n                  className={`cursor-pointer hover:shadow-md transition-all border-2 ${config.borderColor}`}\n                  onClick={() => toggleCategory(categoryKey)}\n                >\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <motion.div\n                          animate={{ rotate: expandedCategories[categoryKey] ? 90 : 0 }}\n                          transition={{ duration: 0.2 }}\n                        >\n                          <ChevronRight className=\"w-5 h-5 text-gray-600\" />\n                        </motion.div>\n                        <config.icon className={`w-6 h-6 text-white p-1 rounded ${config.color}`} />\n                        <h3 className=\"text-xl font-fredoka font-bold text-graphite\">{config.label}</h3>\n                        <Badge className={`${config.bgColor} ${config.borderColor} border font-fredoka`}>\n                          {categoryClients.length} clients\n                        </Badge>\n                      </div>\n                      <Button variant=\"ghost\" size=\"sm\" onClick={(e) => { e.stopPropagation(); toggleCategory(categoryKey); }}>\n                        {expandedCategories[categoryKey] ? 'Collapse' : 'Expand'}\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <AnimatePresence>\n                  {expandedCategories[categoryKey] && (\n                    <motion.div\n                      initial={{ opacity: 0, height: 0 }}\n                      animate={{ opacity: 1, height: 'auto' }}\n                      exit={{ opacity: 0, height: 0 }}\n                      transition={{ duration: 0.3 }}\n                      className=\"space-y-3 mt-3\"\n                    >\n                      {categoryClients.map((client, idx) => (\n                        <motion.div\n                          key={client.id}\n                          initial={{ opacity: 0, y: 10 }}\n                          animate={{ opacity: 1, y: 0 }}\n                          transition={{ delay: idx * 0.02 }}\n                        >\n                          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\" onClick={() => loadClientDetails(client)}>\n                            <CardContent className=\"p-6\">\n                              <div className=\"flex items-center gap-4\">\n                                <div className=\"w-14 h-14 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold text-xl\">\n                                  {client.user_email[0].toUpperCase()}\n                                </div>\n                                <div className=\"flex-1\">\n                                  <div className=\"flex items-center gap-2 mb-2\">\n                                    <p className=\"font-fredoka font-bold text-lg text-graphite\">{client.user_email}</p>\n                                    {client.client_id && (\n                                      <Badge variant=\"outline\" className=\"font-mono text-xs font-semibold flex items-center gap-1\">\n                                        <Hash className=\"w-3 h-3\" />\n                                        {client.client_id}\n                                      </Badge>\n                                    )}\n                                    {client.membership_tier && client.membership_tier !== 'Standard' && (\n                                      <Badge className=\"bg-purple-100 text-purple-800 border-purple-300 border font-fredoka\">\n                                        {client.membership_tier}\n                                      </Badge>\n                                    )}\n                                  </div>\n                                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm\">\n                                    <div className=\"flex items-center gap-1 text-gray-700\">\n                                      <Wallet className=\"w-4 h-4 text-green-500\" />\n                                      <span className=\"font-verdana\">{client.credits_balance || 0} credits</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1 text-gray-700\">\n                                      <Star className=\"w-4 h-4 text-yellow-500\" />\n                                      <span className=\"font-verdana\">{client.total_bookings || 0} bookings</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-1 text-gray-700\">\n                                      <Clock className=\"w-4 h-4 text-gray-500\" />\n                                      <span className=\"font-verdana\">{getActivityStatus(client) === 'active' ? 'Active' : 'Inactive'}</span>\n                                    </div>\n                                  </div>\n                                </div>\n                                <Button variant=\"outline\" size=\"sm\" className=\"font-fredoka\">\n                                  View Details\n                                </Button>\n                              </div>\n                            </CardContent>\n                          </Card>\n                        </motion.div>\n                      ))}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Client Details Modal */}\n      {selectedClient && clientDetails && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\" onClick={() => setSelectedClient(null)}>\n          <Card className=\"max-w-4xl w-full max-h-[90vh] overflow-y-auto\" onClick={(e) => e.stopPropagation()}>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                <Users className=\"w-6 h-6 text-puretask-blue\" />\n                {clientDetails.user_email}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              {/* Stats Grid */}\n              <div className=\"grid md:grid-cols-4 gap-4\">\n                <div className=\"p-4 bg-blue-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 font-verdana\">Total Bookings</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-graphite\">{clientDetails.totalBookings}</p>\n                </div>\n                <div className=\"p-4 bg-red-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 font-verdana\">Dispute Rate</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-red-600\">{clientDetails.disputeRate.toFixed(1)}%</p>\n                </div>\n                <div className=\"p-4 bg-green-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 font-verdana\">Credit Balance</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-fresh-mint\">{clientDetails.creditBalance}</p>\n                </div>\n                <div className=\"p-4 bg-purple-50 rounded-lg\">\n                  <p className=\"text-sm text-gray-600 font-verdana\">Active Plans</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-purple-600\">\n                    {clientDetails.activeSubscriptions + clientDetails.activeMemberships}\n                  </p>\n                </div>\n              </div>\n\n              {/* Risk Profile */}\n              {clientDetails.riskProfile && (\n                <RiskScoreDisplay riskProfile={clientDetails.riskProfile} />\n              )}\n\n              {/* Admin Actions */}\n              <div className=\"flex gap-3 pt-4 border-t\">\n                <Button onClick={handleAdjustCredits} className=\"font-fredoka\">\n                  <Wallet className=\"w-4 h-4 mr-2\" />\n                  Adjust Credits\n                </Button>\n                <Button onClick={() => setSelectedClient(null)} variant=\"outline\" className=\"font-fredoka\">\n                  Close\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminCreditManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":39,"fix":{"range":[263,275],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[262,274],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":6,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"fix":{"range":[274,285],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[274,285],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":11,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":40,"fix":{"range":[531,544],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[530,543],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BookOpen' is defined but never used.","line":12,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":80,"fix":{"range":[632,642],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BookOpen"},"fix":{"range":[632,642],"text":""},"desc":"Remove unused variable 'BookOpen'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'usdToCredits' is defined but never used.","line":14,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":36,"fix":{"range":[688,702],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"usdToCredits"},"fix":{"range":[688,702],"text":""},"desc":"Remove unused variable 'usdToCredits'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AdvancedClientFilters' is defined but never used.","line":21,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":29,"fix":{"range":[1204,1283],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AdvancedClientFilters"},"fix":{"range":[1211,1238],"text":""},"desc":"Remove unused variable 'AdvancedClientFilters'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[1646,1650],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":56,"endColumn":19}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  Wallet, DollarSign, Gift, AlertCircle, ArrowLeft, Home, \n  TrendingUp, Users, Loader2, Search, MinusCircle, Megaphone, History, BookOpen \n} from 'lucide-react';\nimport { creditsToUSD, usdToCredits } from '../components/credits/CreditCalculator';\nimport PayoutBatchProcessor from '../components/admin/PayoutBatchProcessor';\nimport TransactionHistoryAdvanced from '../components/admin/TransactionHistoryAdvanced';\nimport CreditGrantTool from '../components/admin/CreditGrantTool';\nimport ClientSearchSelector from '../components/admin/ClientSearchSelector';\nimport ClientCreditHistory from '../components/admin/ClientCreditHistory';\nimport CreditDebitTool from '../components/admin/CreditDebitTool';\nimport AdvancedClientFilters from '../components/admin/AdvancedClientFilters';\nimport PendingPayoutsDetails from '../components/admin/PendingPayoutsDetails';\nimport CreditCampaignManager from '../components/admin/CreditCampaignManager';\nimport CreditManagementGuide from '../components/admin/CreditManagementGuide';\nimport { toast } from 'sonner';\n\nexport default function AdminCreditManagement() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [activeTab, setActiveTab] = useState('grant');\n  \n  // Stats\n  const [stats, setStats] = useState({\n    totalClientsWithCredits: 0,\n    totalCreditsInCirculation: 0,\n    totalUSDValue: 0,\n    pendingEarnings: 0,\n    pendingPayouts: 0\n  });\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser.role !== 'admin') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n      loadStats();\n    } catch (error) {\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadStats = async () => {\n    setLoading(true);\n    try {\n      const [clientProfiles, earnings] = await Promise.all([\n        base44.entities.ClientProfile.list(),\n        base44.entities.CleanerEarning.filter({ status: 'pending' })\n      ]);\n      \n      const clientsWithCredits = clientProfiles.filter(p => (p.credits_balance || 0) > 0);\n      \n      const totalCredits = clientProfiles.reduce((sum, p) => \n        sum + (p.credits_balance || 0), 0\n      );\n      \n      const pendingUSD = earnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n      \n      setStats({\n        totalClientsWithCredits: clientsWithCredits.length,\n        totalCreditsInCirculation: totalCredits,\n        totalUSDValue: creditsToUSD(totalCredits),\n        pendingEarnings: earnings.length,\n        pendingPayouts: pendingUSD\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading stats:', showToast: false });\n      toast.error('Failed to load statistics');\n    }\n    setLoading(false);\n  };\n\n  const handleClientSelect = (client) => {\n    setSelectedClient(client);\n  };\n\n  const handleToolSuccess = () => {\n    loadStats();\n    setSelectedClient(null);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-4\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => navigate(createPageUrl('AdminDashboard'))}\n              className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Dashboard\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => navigate(createPageUrl('Home'))}\n              className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\"\n            >\n              <Home className=\"w-4 h-4 mr-2\" />\n              Home\n            </Button>\n          </div>\n\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2 flex items-center gap-3\">\n            <Wallet className=\"w-10 h-10 text-puretask-blue\" />\n            Credit System Management\n          </h1>\n          <p className=\"text-lg text-gray-600 font-verdana\">Monitor credit economy and grant goodwill credits</p>\n        </div>\n\n        {/* Stats Grid */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl hover:shadow-xl transition-shadow cursor-pointer\">\n            <CardContent className=\"p-6\">\n              <Users className=\"w-8 h-8 text-fresh-mint mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalClientsWithCredits}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Clients with Credits</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl hover:shadow-xl transition-shadow cursor-pointer\">\n            <CardContent className=\"p-6\">\n              <Wallet className=\"w-8 h-8 text-puretask-blue mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalCreditsInCirculation.toLocaleString()}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Total Credits in Circulation</p>\n              <p className=\"text-xs text-gray-500 font-verdana mt-1\">‚âà ${stats.totalUSDValue.toFixed(2)}</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl hover:shadow-xl transition-shadow cursor-pointer\">\n            <CardContent className=\"p-6\">\n              <TrendingUp className=\"w-8 h-8 text-purple-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.pendingEarnings}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Pending Earnings</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl hover:shadow-xl transition-shadow cursor-pointer\" onClick={() => setActiveTab('payouts')}>\n            <CardContent className=\"p-6\">\n              <DollarSign className=\"w-8 h-8 text-amber-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">${stats.pendingPayouts.toFixed(2)}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Pending Payouts (USD)</p>\n              <Badge className=\"mt-2 bg-amber-600 text-white font-fredoka text-xs\">Click for details</Badge>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Client Search */}\n        <div className=\"mb-8\">\n          <ClientSearchSelector \n            onSelectClient={handleClientSelect}\n            selectedEmail={selectedClient?.user_email}\n          />\n        </div>\n\n        {/* Main Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"mb-8\">\n          <TabsList className=\"grid w-full grid-cols-6 mb-8 bg-white rounded-full p-1 shadow-lg\">\n            <TabsTrigger value=\"grant\" className=\"rounded-full font-fredoka data-[state=active]:bg-green-100 data-[state=active]:text-green-800\">\n              <Gift className=\"w-4 h-4 mr-2\" />\n              Grant Credits\n            </TabsTrigger>\n            <TabsTrigger value=\"debit\" className=\"rounded-full font-fredoka data-[state=active]:bg-red-100 data-[state=active]:text-red-800\">\n              <MinusCircle className=\"w-4 h-4 mr-2\" />\n              Debit/Refund\n            </TabsTrigger>\n            <TabsTrigger value=\"history\" className=\"rounded-full font-fredoka data-[state=active]:bg-purple-100 data-[state=active]:text-purple-800\">\n              <History className=\"w-4 h-4 mr-2\" />\n              History\n            </TabsTrigger>\n            <TabsTrigger value=\"campaign\" className=\"rounded-full font-fredoka data-[state=active]:bg-pink-100 data-[state=active]:text-pink-800\">\n              <Megaphone className=\"w-4 h-4 mr-2\" />\n              Campaigns\n            </TabsTrigger>\n            <TabsTrigger value=\"payouts\" className=\"rounded-full font-fredoka data-[state=active]:bg-amber-100 data-[state=active]:text-amber-800\">\n              <DollarSign className=\"w-4 h-4 mr-2\" />\n              Payouts\n            </TabsTrigger>\n            <TabsTrigger value=\"guide\" className=\"rounded-full font-fredoka data-[state=active]:bg-indigo-100 data-[state=active]:text-indigo-800\">\n              <Search className=\"w-4 h-4 mr-2\" />\n              Guide\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"grant\" className=\"space-y-6\">\n            {selectedClient ? (\n              <CreditGrantTool \n                clientEmail={selectedClient.user_email} \n                onSuccess={handleToolSuccess}\n              />\n            ) : (\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardContent className=\"p-12 text-center\">\n                  <Search className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <p className=\"text-lg text-gray-500 font-verdana\">Search and select a client above to grant credits</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"debit\" className=\"space-y-6\">\n            {selectedClient ? (\n              <CreditDebitTool \n                clientEmail={selectedClient.user_email} \n                onSuccess={handleToolSuccess}\n              />\n            ) : (\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardContent className=\"p-12 text-center\">\n                  <Search className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <p className=\"text-lg text-gray-500 font-verdana\">Search and select a client above to debit credits</p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"history\" className=\"space-y-6\">\n            <ClientCreditHistory clientEmail={selectedClient?.user_email} />\n          </TabsContent>\n\n          <TabsContent value=\"campaign\" className=\"space-y-6\">\n            <CreditCampaignManager />\n          </TabsContent>\n\n          <TabsContent value=\"payouts\" className=\"space-y-6\">\n            <PendingPayoutsDetails />\n          </TabsContent>\n\n          <TabsContent value=\"guide\" className=\"space-y-6\">\n            <CreditManagementGuide />\n          </TabsContent>\n        </Tabs>\n\n        {/* Payout Batch Processor */}\n        <div className=\"mb-8\">\n          <PayoutBatchProcessor />\n        </div>\n\n        {/* Enhanced Transaction History - Replace old TransactionHistory */}\n        <TransactionHistoryAdvanced />\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":5,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":39,"fix":{"range":[213,225],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[212,224],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":5,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":50,"fix":{"range":[224,235],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[224,235],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Gift' is defined but never used.","line":10,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":64,"fix":{"range":[496,502],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Gift"},"fix":{"range":[495,501],"text":""},"desc":"Remove unused variable 'Gift'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":11,"fix":{"range":[502,514],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[501,513],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isAdmin' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":19,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"isAdmin"},"fix":{"range":[812,851],"text":""},"desc":"Remove unused variable 'isAdmin'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[861,865],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":48,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":48,"endColumn":23}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Shield, Users, Briefcase, DollarSign, BarChart3, MessageSquare,\n  Mail, Tag, AlertTriangle, Package, Sparkles, TrendingUp, Gift,\n  Calendar, ChevronRight, Loader2, Eye, Settings, FileText, Wallet\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { usePermission } from '@/hooks/useAuth';\nimport { handleError } from '@/lib/errorHandler';\n\nexport default function AdminDashboard() {\n  const navigate = useNavigate();\n  const isAdmin = usePermission('admin');\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState({\n    totalBookings: 0,\n    activeCleaners: 0,\n    activeClients: 0,\n    totalRevenue: 0,\n    pendingDisputes: 0,\n    unprocessedMessages: 0\n  });\n\n  useEffect(() => {\n    loadAdminData();\n  }, []);\n\n  const loadAdminData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      \n      // Check if user is admin via built-in role OR AdminUser table\n      let isAdminUser = currentUser?.role === 'admin';\n      if (!isAdminUser) {\n        try {\n          const adminUsers = await base44.entities.AdminUser.filter({ \n            email: currentUser?.email,\n            is_active: true\n          });\n          isAdminUser = adminUsers.length > 0;\n        } catch (error) {\n          // AdminUser table not accessible, rely on role check\n        }\n      }\n      \n      if (!currentUser || !isAdminUser) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load basic stats\n      const [bookings, cleaners, clients, disputes] = await Promise.all([\n        base44.entities.Booking.list(),\n        base44.entities.CleanerProfile.filter({ is_active: true }),\n        base44.entities.ClientProfile.list(),\n        base44.entities.Dispute.filter({ status: { $in: ['open', 'investigating'] } })\n      ]);\n\n      const revenue = bookings\n        .filter(b => b.status === 'approved')\n        .reduce((sum, b) => sum + (b.total_price * 0.15), 0);\n\n      setStats({\n        totalBookings: bookings.length,\n        activeCleaners: cleaners.length,\n        activeClients: clients.length,\n        totalRevenue: revenue,\n        pendingDisputes: disputes.length,\n        unprocessedMessages: 0\n      });\n    } catch (error) {\n      handleError(error, {\n        userMessage: 'Failed to load admin dashboard',\n        context: { page: 'AdminDashboard' }\n      });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const adminPages = [\n    {\n      category: 'Operations & Management',\n      pages: [\n        { \n          title: 'Bookings Console', \n          icon: Briefcase, \n          description: 'Advanced booking management & actions',\n          path: 'AdminBookingsConsole',\n          color: 'from-blue-50 to-cyan-50',\n          iconColor: 'text-puretask-blue',\n          badge: stats.totalBookings > 0 ? stats.totalBookings : null\n        },\n        { \n          title: 'Client Management', \n          icon: Users, \n          description: 'Client profiles, credits & risk',\n          path: 'AdminClientManagement',\n          color: 'from-purple-50 to-indigo-50',\n          iconColor: 'text-purple-600'\n        },\n        { \n          title: 'Cleaner Management', \n          icon: Users, \n          description: 'Cleaner profiles, tiers & performance',\n          path: 'AdminCleanerManagement',\n          color: 'from-green-50 to-emerald-50',\n          iconColor: 'text-fresh-mint'\n        },\n        { \n          title: 'Support Tickets', \n          icon: MessageSquare, \n          description: 'Customer support queue',\n          path: 'AdminSupportTickets',\n          color: 'from-cyan-50 to-teal-50',\n          iconColor: 'text-cyan-600'\n        }\n      ]\n    },\n    {\n      category: 'Trust & Safety',\n      pages: [\n        { \n          title: 'Trust & Safety Hub', \n          icon: Shield, \n          description: 'Fraud prevention and safety monitoring',\n          path: 'TrustSafetyDashboard',\n          color: 'from-red-50 to-pink-50',\n          iconColor: 'text-red-600',\n          badge: stats.pendingDisputes > 0 ? `${stats.pendingDisputes}` : null\n        },\n        { \n          title: 'Dispute Resolution', \n          icon: FileText, \n          description: 'Handle disputes and refunds',\n          path: 'AdminDisputeManagement',\n          color: 'from-amber-50 to-orange-50',\n          iconColor: 'text-amber-600'\n        }\n      ]\n    },\n    {\n      category: 'Financial Management',\n      pages: [\n        { \n          title: 'Finance Center', \n          icon: DollarSign, \n          description: 'Payouts, revenue & financial KPIs',\n          path: 'AdminFinanceCenter',\n          color: 'from-green-50 to-emerald-50',\n          iconColor: 'text-fresh-mint'\n        },\n        { \n          title: 'Credit Management', \n          icon: Wallet, \n          description: 'Grant credits and manage balances',\n          path: 'AdminCreditManagement',\n          color: 'from-blue-50 to-cyan-50',\n          iconColor: 'text-puretask-blue'\n        },\n        { \n          title: 'Pricing Rules', \n          icon: TrendingUp, \n          description: 'Configure dynamic pricing multipliers',\n          path: 'AdminPricingRules',\n          color: 'from-amber-50 to-yellow-50',\n          iconColor: 'text-amber-600'\n        },\n        { \n          title: 'Bundle Offers', \n          icon: Tag, \n          description: 'Create upsell and bundle deals',\n          path: 'AdminBundleOffers',\n          color: 'from-pink-50 to-rose-50',\n          iconColor: 'text-pink-600'\n        }\n      ]\n    },\n    {\n      category: 'Analytics & Insights',\n      pages: [\n        { \n          title: 'Analytics Dashboard', \n          icon: BarChart3, \n          description: 'Platform metrics and insights',\n          path: 'AdminAnalyticsDashboard',\n          color: 'from-purple-50 to-indigo-50',\n          iconColor: 'text-purple-600'\n        },\n        { \n          title: 'Analytics Viewer', \n          icon: Eye, \n          description: 'View tracked user events',\n          path: 'AdminAnalyticsViewer',\n          color: 'from-cyan-50 to-teal-50',\n          iconColor: 'text-cyan-600'\n        }\n      ]\n    },\n    {\n      category: 'System & Audit',\n      pages: [\n        { \n          title: 'System Configuration', \n          icon: Settings, \n          description: 'Platform settings and thresholds',\n          path: 'AdminSystemConfig',\n          color: 'from-slate-50 to-gray-50',\n          iconColor: 'text-slate-600'\n        },\n        { \n          title: 'Audit Log', \n          icon: FileText, \n          description: 'Complete history of admin actions',\n          path: 'AdminAuditLog',\n          color: 'from-indigo-50 to-violet-50',\n          iconColor: 'text-indigo-600'\n        }\n      ]\n    },\n    {\n      category: 'Communications',\n      pages: [\n        { \n          title: 'Message Delivery Logs', \n          icon: MessageSquare, \n          description: 'Track all platform messages',\n          path: 'AdminMessages',\n          color: 'from-blue-50 to-indigo-50',\n          iconColor: 'text-blue-600'\n        },\n        { \n          title: 'Email Templates', \n          icon: Mail, \n          description: 'Manage notification templates',\n          path: 'AdminEmailTemplates',\n          color: 'from-purple-50 to-pink-50',\n          iconColor: 'text-purple-600'\n        }\n      ]\n    },\n    {\n      category: 'Platform Resources',\n      pages: [\n        { \n          title: 'Allergy Management', \n          icon: AlertTriangle, \n          description: 'Common allergies database',\n          path: 'AllergyManagement',\n          color: 'from-red-50 to-orange-50',\n          iconColor: 'text-red-600'\n        },\n        { \n          title: 'Seasonal Tips', \n          icon: Sparkles, \n          description: 'Manage seasonal cleaning tips',\n          path: 'SeasonalTipsManagement',\n          color: 'from-green-50 to-teal-50',\n          iconColor: 'text-green-600'\n        },\n        { \n          title: 'Partner Discounts', \n          icon: Tag, \n          description: 'Cleaner supply discounts',\n          path: 'PartnerDiscounts',\n          color: 'from-indigo-50 to-violet-50',\n          iconColor: 'text-indigo-600'\n        },\n        { \n          title: 'Materials List', \n          icon: Package, \n          description: 'Recommended cleaning supplies',\n          path: 'MaterialsList',\n          color: 'from-cyan-50 to-blue-50',\n          iconColor: 'text-cyan-600'\n        }\n      ]\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Welcome Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-4 mb-4\">\n            <div className=\"w-12 h-12 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <Shield className=\"w-7 h-7 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">\n                Admin Dashboard\n              </h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">\n                Platform management and oversight\n              </p>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Quick Stats Cards */}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <Briefcase className=\"w-8 h-8 text-puretask-blue mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalBookings}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Total Bookings</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <Users className=\"w-8 h-8 text-fresh-mint mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.activeCleaners}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Active Cleaners</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <Users className=\"w-8 h-8 text-purple-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.activeClients}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Active Clients</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-yellow-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <DollarSign className=\"w-8 h-8 text-amber-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">${stats.totalRevenue.toFixed(0)}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Platform Revenue</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* All Admin Tools by Category */}\n        <div className=\"space-y-10\">\n          {adminPages.map((category, catIdx) => (\n            <motion.div\n              key={category.category}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: catIdx * 0.1 }}\n            >\n              <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-6\">\n                {category.category}\n              </h2>\n              \n              <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {category.pages.map((page, pageIdx) => (\n                  <motion.div\n                    key={page.path}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: (catIdx * 0.1) + (pageIdx * 0.05) }}\n                  >\n                    <Card \n                      className={`border-0 shadow-lg hover:shadow-xl transition-all rounded-2xl cursor-pointer bg-gradient-to-br ${page.color}`}\n                      onClick={() => navigate(createPageUrl(page.path))}\n                    >\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <page.icon className={`w-10 h-10 ${page.iconColor}`} />\n                          {page.badge && (\n                            <Badge className=\"bg-puretask-blue text-white rounded-full font-fredoka\">\n                              {page.badge}\n                            </Badge>\n                          )}\n                        </div>\n                        <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">{page.title}</h3>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-4\">{page.description}</p>\n                        <div className=\"flex items-center text-puretask-blue font-fredoka font-medium text-sm\">\n                          Manage <ChevronRight className=\"w-4 h-4 ml-1\" />\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* System Health Alert */}\n        {stats.pendingDisputes > 0 && (\n          <Card className=\"mt-8 border-2 border-red-300 bg-red-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-3\">\n                <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n                <div>\n                  <p className=\"font-fredoka font-bold text-red-900 mb-1\">\n                    {stats.pendingDisputes} Pending Dispute{stats.pendingDisputes !== 1 ? 's' : ''}\n                  </p>\n                  <p className=\"text-sm text-red-700 font-verdana\">Action required - review and resolve disputes</p>\n                </div>\n                <Button\n                  onClick={() => navigate(createPageUrl('AdminClientJobs'))}\n                  className=\"ml-auto bg-red-600 text-white rounded-full font-fredoka\"\n                >\n                  Review Now\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminDisputeManagement.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminEmailTemplates.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":19,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":18,"fix":{"range":[976,982],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[975,981],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Code' is defined but never used.","line":19,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":33,"fix":{"range":[991,997],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Code"},"fix":{"range":[990,996],"text":""},"desc":"Remove unused variable 'Code'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":19,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":38,"fix":{"range":[997,1002],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[996,1001],"text":""},"desc":"Remove unused variable 'Zap'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Mail, Plus, Edit2, Trash2, Eye, Send, Copy, Check,\n  ArrowLeft, Home, Loader2, Code, Zap, MessageSquare\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminEmailTemplates() {\n  const navigate = useNavigate();\n  const [templates, setTemplates] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editing, setEditing] = useState(null);\n  const [previewing, setPreviewing] = useState(null);\n  const [testDialog, setTestDialog] = useState(null);\n  const [copiedId, setCopiedId] = useState(null);\n  const [message, setMessage] = useState('');\n\n  const [formData, setFormData] = useState({\n    template_id: '',\n    category: 'client',\n    subject: '',\n    html_body: '',\n    sms_body: '',\n    push_title: '',\n    push_body: '',\n    deep_link: '',\n    variables: [],\n    send_email: true,\n    send_sms: false,\n    send_push: false,\n    is_active: true\n  });\n\n  const [testData, setTestData] = useState({\n    recipient_email: '',\n    test_variables: '{}'\n  });\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const user = await base44.auth.me();\n      if (user.role !== 'admin') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      loadTemplates();\n    } catch (error) {\n      handleError(error, { userMessage: 'Auth error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadTemplates = async () => {\n    setLoading(true);\n    try {\n      const allTemplates = await base44.entities.EmailTemplate.list('-created_date');\n      setTemplates(allTemplates);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading templates:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      if (editing) {\n        await base44.entities.EmailTemplate.update(editing.id, formData);\n        setMessage('Template updated successfully!');\n      } else {\n        await base44.entities.EmailTemplate.create(formData);\n        setMessage('Template created successfully!');\n      }\n      resetForm();\n      loadTemplates();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving template:', showToast: false });\n      setMessage('Failed to save template');\n    }\n  };\n\n  const handleEdit = (template) => {\n    setEditing(template);\n    setFormData({\n      template_id: template.template_id,\n      category: template.category,\n      subject: template.subject,\n      html_body: template.html_body,\n      sms_body: template.sms_body || '',\n      push_title: template.push_title || '',\n      push_body: template.push_body || '',\n      deep_link: template.deep_link || '',\n      variables: template.variables || [],\n      send_email: template.send_email,\n      send_sms: template.send_sms,\n      send_push: template.send_push,\n      is_active: template.is_active\n    });\n  };\n\n  const handleDelete = async (template) => {\n    if (!confirm(`Delete template \"${template.template_id}\"?`)) return;\n    \n    try {\n      await base44.entities.EmailTemplate.update(template.id, { is_active: false });\n      setMessage('Template deactivated');\n      loadTemplates();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error deleting template:', showToast: false });\n    }\n  };\n\n  const handleTestSend = async () => {\n    try {\n      const template = testDialog;\n      let vars = {};\n      try {\n        vars = JSON.parse(testData.test_variables);\n      } catch {\n        alert('Invalid JSON for test variables');\n        return;\n      }\n\n      // Replace variables in subject and body\n      let subject = template.subject;\n      let body = template.html_body;\n      \n      Object.keys(vars).forEach(key => {\n        const regex = new RegExp(`{{${key}}}`, 'g');\n        subject = subject.replace(regex, vars[key]);\n        body = body.replace(regex, vars[key]);\n      });\n\n      // Send test email\n      await base44.integrations.Core.SendEmail({\n        to: testData.recipient_email,\n        subject: subject,\n        body: body\n      });\n\n      // Log it\n      await base44.entities.MessageDeliveryLog.create({\n        delivery_id: `test_${Date.now()}`,\n        event_name: 'test_email',\n        channel: 'email',\n        status: 'sent',\n        template_id: template.template_id,\n        recipient_email: testData.recipient_email,\n        subject: subject,\n        body: body,\n        metadata: { test: true, variables: vars },\n        sent_at: new Date().toISOString(),\n        can_retry: false\n      });\n\n      alert('Test email sent successfully!');\n      setTestDialog(null);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error sending test:', showToast: false });\n      alert('Failed to send test email');\n    }\n  };\n\n  const resetForm = () => {\n    setEditing(null);\n    setFormData({\n      template_id: '',\n      category: 'client',\n      subject: '',\n      html_body: '',\n      sms_body: '',\n      push_title: '',\n      push_body: '',\n      deep_link: '',\n      variables: [],\n      send_email: true,\n      send_sms: false,\n      send_push: false,\n      is_active: true\n    });\n  };\n\n  const copyTemplateId = (id) => {\n    navigator.clipboard.writeText(id);\n    setCopiedId(id);\n    setTimeout(() => setCopiedId(null), 2000);\n  };\n\n  const addVariable = () => {\n    const varName = prompt('Enter variable name (e.g., first_name):');\n    if (varName && !formData.variables.includes(varName)) {\n      setFormData({\n        ...formData,\n        variables: [...formData.variables, varName]\n      });\n    }\n  };\n\n  const removeVariable = (varName) => {\n    setFormData({\n      ...formData,\n      variables: formData.variables.filter(v => v !== varName)\n    });\n  };\n\n  const categoryColors = {\n    client: 'bg-blue-100 text-blue-800',\n    cleaner: 'bg-emerald-100 text-emerald-800',\n    marketing: 'bg-purple-100 text-purple-800',\n    system: 'bg-slate-100 text-slate-800'\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-[#66B3FF] to-white p-10 flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-white\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-[#66B3FF] to-white p-6 lg:p-10\">\n      <div className=\"max-w-[1800px] mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-4\">\n            <Button variant=\"outline\" size=\"sm\" onClick={() => navigate(createPageUrl('AdminDashboard'))} className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\">\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Admin Dashboard\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={() => navigate(createPageUrl('AdminMessages'))} className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\">\n              <MessageSquare className=\"w-4 h-4 mr-2\" />\n              Message Logs\n            </Button>\n          </div>\n\n          <h1 className=\"text-4xl font-fredoka font-bold text-white mb-2 flex items-center gap-3\">\n            <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center shadow-lg\">\n              <Mail className=\"w-7 h-7 text-white\" />\n            </div>\n            Email Template Manager\n          </h1>\n          <p className=\"text-lg text-white font-verdana\" style={{ opacity: 0.9 }}>Manage all notification templates (Email, SMS, Push)</p>\n        </div>\n\n        {message && (\n          <Alert className=\"mb-6\">\n            <AlertDescription>{message}</AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"grid lg:grid-cols-3 gap-6\">\n          {/* Form */}\n          <Card className=\"lg:col-span-1 border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>{editing ? 'Edit Template' : 'Create New Template'}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <Label>Template ID *</Label>\n                  <Input\n                    value={formData.template_id}\n                    onChange={(e) => setFormData({...formData, template_id: e.target.value})}\n                    placeholder=\"email.client.welcome\"\n                    required\n                    disabled={!!editing}\n                  />\n                  <p className=\"text-xs text-slate-500 mt-1\">Use dot notation: email.category.name</p>\n                </div>\n\n                <div>\n                  <Label>Category *</Label>\n                  <Select value={formData.category} onValueChange={(value) => setFormData({...formData, category: value})}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"client\">Client</SelectItem>\n                      <SelectItem value=\"cleaner\">Cleaner</SelectItem>\n                      <SelectItem value=\"marketing\">Marketing</SelectItem>\n                      <SelectItem value=\"system\">System</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label>Subject Line *</Label>\n                  <Input\n                    value={formData.subject}\n                    onChange={(e) => setFormData({...formData, subject: e.target.value})}\n                    placeholder=\"Welcome to PureTask ‚ú®\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <Label>HTML Body *</Label>\n                  <Textarea\n                    value={formData.html_body}\n                    onChange={(e) => setFormData({...formData, html_body: e.target.value})}\n                    rows={8}\n                    placeholder=\"<h2>Hi {{first_name}},</h2>...\"\n                    required\n                    className=\"font-mono text-xs\"\n                  />\n                </div>\n\n                <div>\n                  <Label>SMS Body (optional)</Label>\n                  <Textarea\n                    value={formData.sms_body}\n                    onChange={(e) => setFormData({...formData, sms_body: e.target.value})}\n                    rows={3}\n                    placeholder=\"Short SMS version with {{variables}}\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Push Title (optional)</Label>\n                  <Input\n                    value={formData.push_title}\n                    onChange={(e) => setFormData({...formData, push_title: e.target.value})}\n                    placeholder=\"You're booked ‚úÖ\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Push Body (optional)</Label>\n                  <Input\n                    value={formData.push_body}\n                    onChange={(e) => setFormData({...formData, push_body: e.target.value})}\n                    placeholder=\"Cleaning tomorrow at {{time}}\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Deep Link (optional)</Label>\n                  <Input\n                    value={formData.deep_link}\n                    onChange={(e) => setFormData({...formData, deep_link: e.target.value})}\n                    placeholder=\"app://booking/{{booking_id}}\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Variables</Label>\n                  <div className=\"flex flex-wrap gap-2 mb-2\">\n                    {formData.variables.map(v => (\n                      <Badge key={v} variant=\"outline\" className=\"cursor-pointer\" onClick={() => removeVariable(v)}>\n                        {v} √ó\n                      </Badge>\n                    ))}\n                  </div>\n                  <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addVariable}>\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Add Variable\n                  </Button>\n                </div>\n\n                <div className=\"grid grid-cols-3 gap-2\">\n                  <label className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.send_email}\n                      onChange={(e) => setFormData({...formData, send_email: e.target.checked})}\n                    />\n                    <span className=\"text-sm\">Email</span>\n                  </label>\n                  <label className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.send_sms}\n                      onChange={(e) => setFormData({...formData, send_sms: e.target.checked})}\n                    />\n                    <span className=\"text-sm\">SMS</span>\n                  </label>\n                  <label className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.send_push}\n                      onChange={(e) => setFormData({...formData, send_push: e.target.checked})}\n                    />\n                    <span className=\"text-sm\">Push</span>\n                  </label>\n                </div>\n\n                <div className=\"flex gap-2 pt-4\">\n                  {editing && (\n                    <Button type=\"button\" variant=\"outline\" onClick={resetForm} className=\"flex-1\">\n                      Cancel\n                    </Button>\n                  )}\n                  <Button type=\"submit\" className=\"flex-1 bg-blue-500 hover:bg-blue-600\">\n                    {editing ? 'Update' : 'Create'} Template\n                  </Button>\n                </div>\n              </form>\n            </CardContent>\n          </Card>\n\n          {/* Templates List */}\n          <Card className=\"lg:col-span-2 border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>Active Templates ({templates.filter(t => t.is_active).length})</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <Tabs defaultValue=\"all\">\n                <TabsList className=\"mb-4\">\n                  <TabsTrigger value=\"all\">All</TabsTrigger>\n                  <TabsTrigger value=\"client\">Client</TabsTrigger>\n                  <TabsTrigger value=\"cleaner\">Cleaner</TabsTrigger>\n                  <TabsTrigger value=\"marketing\">Marketing</TabsTrigger>\n                  <TabsTrigger value=\"system\">System</TabsTrigger>\n                </TabsList>\n\n                {['all', 'client', 'cleaner', 'marketing', 'system'].map(cat => (\n                  <TabsContent key={cat} value={cat} className=\"space-y-3\">\n                    {templates\n                      .filter(t => t.is_active && (cat === 'all' || t.category === cat))\n                      .map((template, idx) => (\n                        <motion.div\n                          key={template.id}\n                          initial={{ opacity: 0, y: 10 }}\n                          animate={{ opacity: 1, y: 0 }}\n                          transition={{ delay: idx * 0.05 }}\n                        >\n                          <Card className=\"border-2 hover:border-blue-300 transition-all\">\n                            <CardContent className=\"p-4\">\n                              <div className=\"flex items-start justify-between mb-3\">\n                                <div className=\"flex-1\">\n                                  <div className=\"flex items-center gap-2 mb-2\">\n                                    <button\n                                      onClick={() => copyTemplateId(template.template_id)}\n                                      className=\"font-mono text-sm font-semibold text-blue-600 hover:text-blue-800 flex items-center gap-1\"\n                                    >\n                                      {template.template_id}\n                                      {copiedId === template.template_id ? (\n                                        <Check className=\"w-4 h-4 text-green-500\" />\n                                      ) : (\n                                        <Copy className=\"w-4 h-4\" />\n                                      )}\n                                    </button>\n                                    <Badge className={categoryColors[template.category]}>\n                                      {template.category}\n                                    </Badge>\n                                  </div>\n                                  <p className=\"text-sm text-slate-600 mb-2\">{template.subject}</p>\n                                  <div className=\"flex gap-2\">\n                                    {template.send_email && <Badge variant=\"outline\">Email</Badge>}\n                                    {template.send_sms && <Badge variant=\"outline\">SMS</Badge>}\n                                    {template.send_push && <Badge variant=\"outline\">Push</Badge>}\n                                  </div>\n                                </div>\n                                <div className=\"flex gap-1\">\n                                  <Button size=\"sm\" variant=\"ghost\" onClick={() => setPreviewing(template)}>\n                                    <Eye className=\"w-4 h-4\" />\n                                  </Button>\n                                  <Button size=\"sm\" variant=\"ghost\" onClick={() => setTestDialog(template)}>\n                                    <Send className=\"w-4 h-4\" />\n                                  </Button>\n                                  <Button size=\"sm\" variant=\"ghost\" onClick={() => handleEdit(template)}>\n                                    <Edit2 className=\"w-4 h-4\" />\n                                  </Button>\n                                  <Button size=\"sm\" variant=\"ghost\" onClick={() => handleDelete(template)} className=\"text-red-600\">\n                                    <Trash2 className=\"w-4 h-4\" />\n                                  </Button>\n                                </div>\n                              </div>\n\n                              {template.variables && template.variables.length > 0 && (\n                                <div className=\"flex flex-wrap gap-1 mt-2\">\n                                  <span className=\"text-xs text-slate-500\">Variables:</span>\n                                  {template.variables.map(v => (\n                                    <code key={v} className=\"text-xs bg-slate-100 px-1 py-0.5 rounded\">{v}</code>\n                                  ))}\n                                </div>\n                              )}\n                            </CardContent>\n                          </Card>\n                        </motion.div>\n                      ))}\n                  </TabsContent>\n                ))}\n              </Tabs>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Preview Dialog */}\n        {previewing && (\n          <Dialog open={!!previewing} onOpenChange={() => setPreviewing(null)}>\n            <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Template Preview: {previewing.template_id}</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label className=\"text-xs text-slate-500\">Subject</Label>\n                  <p className=\"font-semibold\">{previewing.subject}</p>\n                </div>\n\n                {previewing.html_body && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Email HTML</Label>\n                    <div className=\"border rounded-lg p-4 bg-white\">\n                      <div dangerouslySetInnerHTML={{ __html: previewing.html_body }} />\n                    </div>\n                    <details className=\"mt-2\">\n                      <summary className=\"text-xs text-slate-500 cursor-pointer\">View HTML Source</summary>\n                      <pre className=\"text-xs bg-slate-50 p-4 rounded mt-2 overflow-x-auto\">\n                        {previewing.html_body}\n                      </pre>\n                    </details>\n                  </div>\n                )}\n\n                {previewing.sms_body && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">SMS Version</Label>\n                    <div className=\"bg-slate-50 p-4 rounded-lg border\">\n                      <p className=\"text-sm\">{previewing.sms_body}</p>\n                    </div>\n                  </div>\n                )}\n\n                {previewing.push_title && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Push Notification</Label>\n                    <div className=\"bg-slate-50 p-4 rounded-lg border\">\n                      <p className=\"font-semibold text-sm mb-1\">{previewing.push_title}</p>\n                      <p className=\"text-sm text-slate-600\">{previewing.push_body}</p>\n                      {previewing.deep_link && (\n                        <p className=\"text-xs text-slate-500 mt-2\">Deep Link: {previewing.deep_link}</p>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {/* Test Send Dialog */}\n        {testDialog && (\n          <Dialog open={!!testDialog} onOpenChange={() => setTestDialog(null)}>\n            <DialogContent>\n              <DialogHeader>\n                <DialogTitle>Test Send: {testDialog.template_id}</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label>Recipient Email</Label>\n                  <Input\n                    type=\"email\"\n                    value={testData.recipient_email}\n                    onChange={(e) => setTestData({...testData, recipient_email: e.target.value})}\n                    placeholder=\"test@example.com\"\n                  />\n                </div>\n\n                <div>\n                  <Label>Test Variables (JSON)</Label>\n                  <Textarea\n                    value={testData.test_variables}\n                    onChange={(e) => setTestData({...testData, test_variables: e.target.value})}\n                    rows={6}\n                    placeholder='{\"first_name\": \"John\", \"cleaner_name\": \"Sarah\"}'\n                    className=\"font-mono text-xs\"\n                  />\n                  <p className=\"text-xs text-slate-500 mt-1\">\n                    Required: {testDialog.variables?.join(', ') || 'none'}\n                  </p>\n                </div>\n\n                <Button onClick={handleTestSend} className=\"w-full\">\n                  <Send className=\"w-4 h-4 mr-2\" />\n                  Send Test Email\n                </Button>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminFinanceCenter.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":19,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":32,"fix":{"range":[716,723],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[715,722],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingDown' is defined but never used.","line":20,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":78,"fix":{"range":[834,848],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[833,847],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'PieChartIcon' is defined but never used.","line":21,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":27,"fix":{"range":[848,876],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"PieChartIcon"},"fix":{"range":[847,875],"text":""},"desc":"Remove unused variable 'PieChartIcon'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'payments' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":72,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"payments"},"fix":{"range":[2584,2592],"text":""},"desc":"Remove unused variable 'payments'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'earnings' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":72,"column":90,"nodeType":"Identifier","messageId":"unusedVar","endLine":72,"endColumn":98,"suggestions":[{"messageId":"removeVar","data":{"varName":"earnings"},"fix":{"range":[2630,2640],"text":""},"desc":"Remove unused variable 'earnings'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'COLORS' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":203,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":203,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"COLORS"},"fix":{"range":[8280,8351],"text":""},"desc":"Remove unused variable 'COLORS'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { \n  DollarSign, TrendingUp, Users, Wallet, Loader2, CheckCircle, Clock, XCircle,\n  Download, Calendar, ArrowUpRight, CreditCard, Gift, RefreshCw, TrendingDown,\n  PieChart as PieChartIcon, BarChart3, Activity\n} from 'lucide-react';\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell } from 'recharts';\nimport { motion } from 'framer-motion';\nimport { creditsToUSD } from '../components/credits/CreditCalculator';\nimport PendingPayoutsDetails from '../components/admin/PendingPayoutsDetails';\n\nexport default function AdminFinanceCenter() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [payouts, setPayouts] = useState([]);\n  const [analytics, setAnalytics] = useState([]);\n  const [summary, setSummary] = useState({});\n  const [creditMetrics, setCreditMetrics] = useState({});\n  const [dateRange, setDateRange] = useState('30');\n  const [revenueBreakdown, setRevenueBreakdown] = useState([]);\n  const [payoutBreakdown, setPayoutBreakdown] = useState([]);\n\n  useEffect(() => {\n    checkAdminAndLoad();\n  }, []);\n\n  useEffect(() => {\n    if (user) {\n      loadFinanceData();\n    }\n  }, [dateRange]);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n      await loadFinanceData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadFinanceData = async () => {\n    setLoading(true);\n    try {\n      const daysToFetch = parseInt(dateRange);\n      const [allPayouts, dailyAnalytics, payments, creditTxns, bookings, clientProfiles, earnings] = await Promise.all([\n        base44.entities.Payout.list('-created_date', 500),\n        base44.entities.PlatformAnalyticsDaily.list('-date', daysToFetch),\n        base44.entities.Payment.list('-created_date', 500),\n        base44.entities.CreditTransaction.list('-created_date', 1000),\n        base44.entities.Booking.list('-created_date', 500),\n        base44.entities.ClientProfile.list('', 1000),\n        base44.entities.CleanerEarning.list('-created_date', 500)\n      ]);\n\n      setPayouts(allPayouts);\n      setAnalytics(dailyAnalytics);\n\n      // Filter data by date range\n      const cutoffDate = new Date();\n      cutoffDate.setDate(cutoffDate.getDate() - daysToFetch);\n\n      const recentPayouts = allPayouts.filter(p => new Date(p.created_date) >= cutoffDate);\n      const recentTxns = creditTxns.filter(t => new Date(t.created_date) >= cutoffDate);\n      const recentBookings = bookings.filter(b => new Date(b.created_date) >= cutoffDate);\n\n      // Calculate summary\n      const totalGMV = dailyAnalytics.reduce((sum, d) => sum + (d.gmv_usd || 0), 0);\n      const platformRevenue = dailyAnalytics.reduce((sum, d) => sum + (d.platform_revenue_usd || 0), 0);\n      const totalPayouts = recentPayouts\n        .filter(p => p.status === 'completed')\n        .reduce((sum, p) => sum + p.amount, 0);\n      const refunds = dailyAnalytics.reduce((sum, d) => sum + (d.refunds_usd || 0), 0);\n\n      // Credit metrics\n      const totalCreditsInCirculation = clientProfiles.reduce((sum, c) => sum + (c.credits_balance || 0), 0);\n      const creditsPurchased = recentTxns\n        .filter(t => t.transaction_type === 'purchase' && t.amount_credits > 0)\n        .reduce((sum, t) => sum + t.amount_credits, 0);\n      const creditsGranted = recentTxns\n        .filter(t => ['promo', 'adjustment'].includes(t.transaction_type) && t.amount_credits > 0)\n        .reduce((sum, t) => sum + t.amount_credits, 0);\n      const creditsCharged = recentTxns\n        .filter(t => t.transaction_type === 'charge')\n        .reduce((sum, t) => sum + Math.abs(t.amount_credits), 0);\n\n      setCreditMetrics({\n        totalCreditsInCirculation,\n        creditsPurchased,\n        creditsPurchasedUSD: creditsToUSD(creditsPurchased),\n        creditsGranted,\n        creditsGrantedUSD: creditsToUSD(creditsGranted),\n        creditsCharged,\n        creditsChargedUSD: creditsToUSD(creditsCharged)\n      });\n\n      // Revenue breakdown\n      const serviceFees = recentBookings\n        .filter(b => b.status === 'approved' || b.status === 'completed')\n        .reduce((sum, b) => {\n          const cleanerPayout = (b.payout_percentage_at_accept || 0.8) * (b.final_charge_credits || b.total_price || 0);\n          const platformFee = (b.final_charge_credits || b.total_price || 0) - cleanerPayout;\n          return sum + creditsToUSD(platformFee);\n        }, 0);\n\n      const subscriptionRevenue = 0; // Placeholder\n\n      setRevenueBreakdown([\n        { name: 'Service Fees', value: serviceFees, color: '#66B3FF' },\n        { name: 'Credit Purchases', value: creditsToUSD(creditsPurchased), color: '#28C76F' },\n        { name: 'Subscriptions', value: subscriptionRevenue, color: '#FFA726' }\n      ]);\n\n      // Payout breakdown\n      const completedPayouts = recentPayouts.filter(p => p.status === 'completed');\n      const failedPayouts = recentPayouts.filter(p => p.status === 'failed');\n      const pendingPayoutsFiltered = recentPayouts.filter(p => p.status === 'pending');\n\n      setPayoutBreakdown([\n        { name: 'Completed', value: completedPayouts.reduce((s, p) => s + p.amount, 0), count: completedPayouts.length, color: '#28C76F' },\n        { name: 'Pending', value: pendingPayoutsFiltered.reduce((s, p) => s + p.amount, 0), count: pendingPayoutsFiltered.length, color: '#FFA726' },\n        { name: 'Failed', value: failedPayouts.reduce((s, p) => s + p.amount, 0), count: failedPayouts.length, color: '#EA5455' }\n      ]);\n\n      setSummary({\n        totalGMV,\n        platformRevenue,\n        totalPayouts,\n        refunds,\n        pendingPayouts: recentPayouts.filter(p => p.status === 'pending').length,\n        completedPayouts: recentPayouts.filter(p => p.status === 'completed').length,\n        failedPayouts: recentPayouts.filter(p => p.status === 'failed').length,\n        pendingPayoutsAmount: recentPayouts.filter(p => p.status === 'pending').reduce((s, p) => s + p.amount, 0)\n      });\n\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading finance data:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const getPayoutStatusColor = (status) => {\n    const colors = {\n      completed: 'bg-green-100 text-green-800',\n      pending: 'bg-yellow-100 text-yellow-800',\n      processing: 'bg-blue-100 text-blue-800',\n      failed: 'bg-red-100 text-red-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const exportPayoutsToCSV = () => {\n    const headers = ['Date', 'Cleaner Email', 'Amount', 'Status', 'Type', 'Provider'];\n    const rows = payouts.map(p => [\n      new Date(p.created_date).toISOString(),\n      p.cleaner_email,\n      p.amount.toFixed(2),\n      p.status,\n      p.payout_type || '',\n      p.provider || 'stripe'\n    ]);\n\n    const csvContent = [\n      headers.join(','),\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `payouts_${dateRange}days_${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n  };\n\n  const COLORS = ['#66B3FF', '#28C76F', '#FFA726', '#EA5455', '#9C27B0'];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Finance Center</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Comprehensive financial oversight and analytics</p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Select value={dateRange} onValueChange={setDateRange}>\n              <SelectTrigger className=\"w-48\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"7\">Last 7 Days</SelectItem>\n                <SelectItem value=\"30\">Last 30 Days</SelectItem>\n                <SelectItem value=\"90\">Last 90 Days</SelectItem>\n              </SelectContent>\n            </Select>\n            <Button variant=\"outline\" onClick={loadFinanceData}>\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n\n        {/* KPI Cards - Row 1: Financial Metrics */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n            <Card \n              className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 cursor-pointer\"\n              onClick={() => window.scrollTo({ top: document.getElementById('revenue-section')?.offsetTop - 100, behavior: 'smooth' })}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <DollarSign className=\"w-8 h-8 text-puretask-blue\" />\n                  <ArrowUpRight className=\"w-5 h-5 text-puretask-blue\" />\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  ${summary.totalGMV?.toFixed(0) || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">GMV ({dateRange} days)</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n            <Card \n              className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 cursor-pointer\"\n              onClick={() => window.scrollTo({ top: document.getElementById('revenue-section')?.offsetTop - 100, behavior: 'smooth' })}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <TrendingUp className=\"w-8 h-8 text-fresh-mint\" />\n                  <ArrowUpRight className=\"w-5 h-5 text-fresh-mint\" />\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  ${summary.platformRevenue?.toFixed(0) || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Platform Revenue</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n            <Card \n              className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-indigo-50 cursor-pointer\"\n              onClick={() => window.scrollTo({ top: document.getElementById('payouts-section')?.offsetTop - 100, behavior: 'smooth' })}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <Wallet className=\"w-8 h-8 text-purple-600\" />\n                  <ArrowUpRight className=\"w-5 h-5 text-purple-600\" />\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  ${summary.totalPayouts?.toFixed(0) || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Total Payouts</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n            <Card \n              className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-yellow-50 cursor-pointer\"\n              onClick={() => window.scrollTo({ top: document.getElementById('pending-section')?.offsetTop - 100, behavior: 'smooth' })}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <Clock className=\"w-8 h-8 text-amber-600\" />\n                  <ArrowUpRight className=\"w-5 h-5 text-amber-600\" />\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {summary.pendingPayouts || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Pending Payouts</p>\n                <p className=\"text-xs text-amber-600 font-verdana mt-1\">\n                  ${summary.pendingPayoutsAmount?.toFixed(2) || 0}\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* KPI Cards - Row 2: Credit Metrics */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n            <Card \n              className=\"border-0 shadow-lg bg-gradient-to-br from-indigo-50 to-purple-50 cursor-pointer\"\n              onClick={() => navigate(createPageUrl('AdminCreditManagement'))}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <CreditCard className=\"w-8 h-8 text-indigo-600\" />\n                  <ArrowUpRight className=\"w-5 h-5 text-indigo-600\" />\n                </div>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {creditMetrics.totalCreditsInCirculation?.toLocaleString() || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Credits in Circulation</p>\n                <p className=\"text-xs text-indigo-600 font-verdana mt-1\">\n                  ‚âà ${creditsToUSD(creditMetrics.totalCreditsInCirculation || 0).toFixed(2)}\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-teal-50\">\n            <CardContent className=\"p-6\">\n              <DollarSign className=\"w-8 h-8 text-green-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                {creditMetrics.creditsPurchased?.toLocaleString() || 0}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Credits Purchased</p>\n              <p className=\"text-xs text-green-600 font-verdana mt-1\">\n                ${creditMetrics.creditsPurchasedUSD?.toFixed(2) || 0}\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-pink-50 to-rose-50\">\n            <CardContent className=\"p-6\">\n              <Gift className=\"w-8 h-8 text-pink-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                {creditMetrics.creditsGranted?.toLocaleString() || 0}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Credits Granted</p>\n              <p className=\"text-xs text-pink-600 font-verdana mt-1\">\n                ${creditMetrics.creditsGrantedUSD?.toFixed(2) || 0}\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-orange-50 to-amber-50\">\n            <CardContent className=\"p-6\">\n              <Activity className=\"w-8 h-8 text-orange-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                {creditMetrics.creditsCharged?.toLocaleString() || 0}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Credits Charged</p>\n              <p className=\"text-xs text-orange-600 font-verdana mt-1\">\n                ${creditMetrics.creditsChargedUSD?.toFixed(2) || 0}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Content Tabs */}\n        <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-4 bg-white rounded-full p-1 shadow-lg\">\n            <TabsTrigger value=\"overview\" className=\"rounded-full font-fredoka\">\n              <BarChart3 className=\"w-4 h-4 mr-2\" />\n              Overview\n            </TabsTrigger>\n            <TabsTrigger value=\"revenue\" className=\"rounded-full font-fredoka\">\n              <TrendingUp className=\"w-4 h-4 mr-2\" />\n              Revenue\n            </TabsTrigger>\n            <TabsTrigger value=\"payouts\" className=\"rounded-full font-fredoka\">\n              <Wallet className=\"w-4 h-4 mr-2\" />\n              Payouts\n            </TabsTrigger>\n            <TabsTrigger value=\"pending\" className=\"rounded-full font-fredoka\">\n              <Clock className=\"w-4 h-4 mr-2\" />\n              Pending\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Overview Tab */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            {/* Revenue Trend Chart */}\n            <Card id=\"revenue-section\">\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl flex items-center justify-between\">\n                  <span>Revenue Trends</span>\n                  <Badge className=\"bg-blue-100 text-blue-800 font-fredoka\">{dateRange} Days</Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <LineChart data={analytics}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                    <YAxis tick={{ fontSize: 12 }} />\n                    <Tooltip />\n                    <Legend />\n                    <Line type=\"monotone\" dataKey=\"gmv_usd\" stroke=\"#66B3FF\" name=\"GMV\" strokeWidth={2} />\n                    <Line type=\"monotone\" dataKey=\"platform_revenue_usd\" stroke=\"#28C76F\" name=\"Revenue\" strokeWidth={2} />\n                    <Line type=\"monotone\" dataKey=\"refunds_usd\" stroke=\"#EA5455\" name=\"Refunds\" strokeWidth={2} />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n\n            {/* Recent Payouts */}\n            <Card id=\"payouts-section\">\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl flex items-center justify-between\">\n                  <span>Recent Payouts</span>\n                  <Button onClick={exportPayoutsToCSV} variant=\"outline\" size=\"sm\">\n                    <Download className=\"w-4 h-4 mr-2\" />\n                    Export CSV\n                  </Button>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {payouts.slice(0, 10).map((payout) => (\n                    <div key={payout.id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors\">\n                      <div className=\"flex-1\">\n                        <p className=\"font-verdana font-semibold\">{payout.cleaner_email}</p>\n                        <p className=\"text-sm text-gray-600 font-verdana\">\n                          {new Date(payout.created_date).toLocaleDateString()}\n                        </p>\n                      </div>\n                      <div className=\"text-right mr-4\">\n                        <p className=\"font-fredoka font-bold text-lg text-graphite\">${payout.amount.toFixed(2)}</p>\n                        <p className=\"text-xs text-gray-600 font-verdana\">{payout.payout_type}</p>\n                      </div>\n                      <Badge className={`font-fredoka ${getPayoutStatusColor(payout.status)}`}>\n                        {payout.status}\n                      </Badge>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Revenue Tab */}\n          <TabsContent value=\"revenue\" className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {/* Revenue Breakdown Pie Chart */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Revenue Breakdown</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <PieChart>\n                      <Pie\n                        data={revenueBreakdown}\n                        cx=\"50%\"\n                        cy=\"50%\"\n                        labelLine={false}\n                        label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}\n                        outerRadius={80}\n                        fill=\"#8884d8\"\n                        dataKey=\"value\"\n                      >\n                        {revenueBreakdown.map((entry, index) => (\n                          <Cell key={`cell-${index}`} fill={entry.color} />\n                        ))}\n                      </Pie>\n                      <Tooltip />\n                    </PieChart>\n                  </ResponsiveContainer>\n                  <div className=\"mt-4 space-y-2\">\n                    {revenueBreakdown.map((item, idx) => (\n                      <div key={idx} className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-3 h-3 rounded\" style={{ backgroundColor: item.color }}></div>\n                          <span className=\"text-sm font-verdana\">{item.name}</span>\n                        </div>\n                        <span className=\"text-sm font-fredoka font-bold\">${item.value.toFixed(2)}</span>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Revenue Trend Bar Chart */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Daily Revenue</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <BarChart data={analytics.slice(-7)}>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                      <YAxis tick={{ fontSize: 12 }} />\n                      <Tooltip />\n                      <Legend />\n                      <Bar dataKey=\"platform_revenue_usd\" fill=\"#28C76F\" name=\"Revenue\" />\n                    </BarChart>\n                  </ResponsiveContainer>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Payouts Tab */}\n          <TabsContent value=\"payouts\" className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {/* Payout Breakdown */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Payout Status Breakdown</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <PieChart>\n                      <Pie\n                        data={payoutBreakdown}\n                        cx=\"50%\"\n                        cy=\"50%\"\n                        labelLine={false}\n                        label={({ name, count }) => `${name} (${count})`}\n                        outerRadius={80}\n                        fill=\"#8884d8\"\n                        dataKey=\"value\"\n                      >\n                        {payoutBreakdown.map((entry, index) => (\n                          <Cell key={`cell-${index}`} fill={entry.color} />\n                        ))}\n                      </Pie>\n                      <Tooltip />\n                    </PieChart>\n                  </ResponsiveContainer>\n                  <div className=\"mt-4 space-y-2\">\n                    {payoutBreakdown.map((item, idx) => (\n                      <div key={idx} className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"w-3 h-3 rounded\" style={{ backgroundColor: item.color }}></div>\n                          <span className=\"text-sm font-verdana\">{item.name} ({item.count})</span>\n                        </div>\n                        <span className=\"text-sm font-fredoka font-bold\">${item.value.toFixed(2)}</span>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Payout Stats */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Payout Statistics</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"text-sm text-green-700 font-verdana\">Completed</span>\n                      <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                    </div>\n                    <p className=\"text-2xl font-fredoka font-bold text-green-700\">\n                      {summary.completedPayouts || 0}\n                    </p>\n                    <p className=\"text-xs text-green-600 font-verdana mt-1\">\n                      ${summary.totalPayouts?.toFixed(2) || 0}\n                    </p>\n                  </div>\n\n                  <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"text-sm text-amber-700 font-verdana\">Pending</span>\n                      <Clock className=\"w-5 h-5 text-amber-600\" />\n                    </div>\n                    <p className=\"text-2xl font-fredoka font-bold text-amber-700\">\n                      {summary.pendingPayouts || 0}\n                    </p>\n                    <p className=\"text-xs text-amber-600 font-verdana mt-1\">\n                      ${summary.pendingPayoutsAmount?.toFixed(2) || 0}\n                    </p>\n                  </div>\n\n                  <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"text-sm text-red-700 font-verdana\">Failed</span>\n                      <XCircle className=\"w-5 h-5 text-red-600\" />\n                    </div>\n                    <p className=\"text-2xl font-fredoka font-bold text-red-700\">\n                      {summary.failedPayouts || 0}\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Pending Payouts Tab */}\n          <TabsContent value=\"pending\" className=\"space-y-6\" id=\"pending-section\">\n            <PendingPayoutsDetails />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminMessageLog.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminMessages.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":23,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":15,"fix":{"range":[835,843],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[834,842],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":24,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":57,"fix":{"range":[942,952],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[942,952],"text":""},"desc":"Remove unused variable 'Calendar'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Label } from '@/components/ui/label';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport {\n  Mail, Search, Filter, Eye, RefreshCw, Loader2, Send, CheckCircle,\n  XCircle, Clock, AlertCircle, ArrowLeft, Home, Calendar\n} from 'lucide-react';\nimport { formatDistanceToNow } from 'date-fns';\n\nexport default function AdminMessages() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [filteredMessages, setFilteredMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedMessage, setSelectedMessage] = useState(null);\n  const [resending, setResending] = useState(false);\n  \n  // Filter states\n  const [filters, setFilters] = useState({\n    delivery_id: '',\n    event_name: 'all',\n    channel: 'all',\n    status: 'all',\n    template_id: '',\n    date_from: '',\n    date_to: ''\n  });\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  useEffect(() => {\n    if (user) {\n      loadMessages();\n    }\n  }, [user]);\n\n  useEffect(() => {\n    applyFilters();\n  }, [filters, messages]);\n\n  const checkAuth = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser.role !== 'admin') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n    } catch (error) {\n      handleError(error, { userMessage: 'Auth error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadMessages = async () => {\n    setLoading(true);\n    try {\n      const allMessages = await base44.entities.MessageDeliveryLog.list('-created_date', 500);\n      setMessages(allMessages);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading messages:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const applyFilters = () => {\n    let filtered = [...messages];\n\n    // Delivery ID filter\n    if (filters.delivery_id.trim()) {\n      filtered = filtered.filter(msg => \n        msg.delivery_id?.toLowerCase().includes(filters.delivery_id.toLowerCase())\n      );\n    }\n\n    // Event name filter\n    if (filters.event_name !== 'all') {\n      filtered = filtered.filter(msg => msg.event_name === filters.event_name);\n    }\n\n    // Channel filter\n    if (filters.channel !== 'all') {\n      filtered = filtered.filter(msg => msg.channel === filters.channel);\n    }\n\n    // Status filter\n    if (filters.status !== 'all') {\n      filtered = filtered.filter(msg => msg.status === filters.status);\n    }\n\n    // Template ID filter\n    if (filters.template_id.trim()) {\n      filtered = filtered.filter(msg => \n        msg.template_id?.toLowerCase().includes(filters.template_id.toLowerCase())\n      );\n    }\n\n    // Date range filter\n    if (filters.date_from) {\n      const fromDate = new Date(filters.date_from);\n      filtered = filtered.filter(msg => \n        new Date(msg.created_date) >= fromDate\n      );\n    }\n\n    if (filters.date_to) {\n      const toDate = new Date(filters.date_to);\n      toDate.setHours(23, 59, 59, 999);\n      filtered = filtered.filter(msg => \n        new Date(msg.created_date) <= toDate\n      );\n    }\n\n    setFilteredMessages(filtered);\n  };\n\n  const handleResend = async (message) => {\n    if (!message.can_retry) {\n      alert('This message cannot be resent');\n      return;\n    }\n\n    const confirmed = confirm('Are you sure you want to resend this message?');\n    if (!confirmed) return;\n\n    setResending(true);\n    try {\n      // Create a new delivery log entry for the resend\n      await base44.entities.MessageDeliveryLog.create({\n        delivery_id: `${message.delivery_id}-resend-${Date.now()}`,\n        event_name: message.event_name,\n        channel: message.channel,\n        status: 'pending',\n        template_id: message.template_id,\n        recipient_email: message.recipient_email,\n        recipient_phone: message.recipient_phone,\n        subject: message.subject,\n        body: message.body,\n        metadata: message.metadata,\n        provider: message.provider,\n        retry_count: (message.retry_count || 0) + 1,\n        can_retry: true\n      });\n\n      // If email, attempt to send\n      if (message.channel === 'email') {\n        try {\n          await base44.integrations.Core.SendEmail({\n            to: message.recipient_email,\n            subject: message.subject || 'Message from PureTask',\n            body: message.body || 'No content available'\n          });\n        } catch (emailError) {\n          console.error('Error sending email:', emailError);\n        }\n      }\n\n      alert('Message resend initiated successfully');\n      loadMessages();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resending message:', showToast: false });\n      alert('Failed to resend message');\n    }\n    setResending(false);\n  };\n\n  const getStatusColor = (status) => {\n    const colors = {\n      pending: 'bg-amber-100 text-amber-800',\n      sent: 'bg-blue-100 text-blue-800',\n      delivered: 'bg-green-100 text-green-800',\n      failed: 'bg-red-100 text-red-800',\n      bounced: 'bg-red-100 text-red-800',\n      opened: 'bg-purple-100 text-purple-800',\n      clicked: 'bg-emerald-100 text-emerald-800'\n    };\n    return colors[status] || 'bg-slate-100 text-slate-800';\n  };\n\n  const getStatusIcon = (status) => {\n    switch (status) {\n      case 'sent':\n      case 'delivered':\n        return <CheckCircle className=\"w-4 h-4\" />;\n      case 'failed':\n      case 'bounced':\n        return <XCircle className=\"w-4 h-4\" />;\n      case 'pending':\n        return <Clock className=\"w-4 h-4\" />;\n      case 'opened':\n      case 'clicked':\n        return <Eye className=\"w-4 h-4\" />;\n      default:\n        return <AlertCircle className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getChannelIcon = (channel) => {\n    switch (channel) {\n      case 'email':\n        return <Mail className=\"w-4 h-4\" />;\n      case 'sms':\n        return <Send className=\"w-4 h-4\" />;\n      default:\n        return <Mail className=\"w-4 h-4\" />;\n    }\n  };\n\n  const clearFilters = () => {\n    setFilters({\n      delivery_id: '',\n      event_name: 'all',\n      channel: 'all',\n      status: 'all',\n      template_id: '',\n      date_from: '',\n      date_to: ''\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-[#66B3FF] to-white p-10 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-white mx-auto mb-4\" />\n          <p className=\"text-lg text-white font-verdana\">Loading message delivery logs...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-[#66B3FF] to-white p-6 lg:p-10\">\n      <div className=\"max-w-[1800px] mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-4\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => navigate(createPageUrl('AdminDashboard'))}\n              className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Dashboard\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => navigate(createPageUrl('Home'))}\n              className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\"\n            >\n              <Home className=\"w-4 h-4 mr-2\" />\n              Home\n            </Button>\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-white mb-2 flex items-center gap-3\">\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center shadow-lg\">\n                  <Mail className=\"w-7 h-7 text-white\" />\n                </div>\n                Message Delivery Logs\n              </h1>\n              <p className=\"text-lg text-white font-verdana\" style={{ opacity: 0.9 }}>\n                Monitor and manage all system message deliveries\n              </p>\n            </div>\n\n            <Button onClick={loadMessages} variant=\"outline\" className=\"bg-white hover:bg-gray-50 rounded-full font-fredoka\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n          </div>\n        </div>\n\n        {/* Stats Summary */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\n          <Card className=\"border-0 shadow-md\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-slate-600\">Total Messages</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{messages.length}</p>\n                </div>\n                <Mail className=\"w-10 h-10 text-blue-500\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-md\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-slate-600\">Delivered</p>\n                  <p className=\"text-3xl font-bold text-green-600\">\n                    {messages.filter(m => m.status === 'delivered').length}\n                  </p>\n                </div>\n                <CheckCircle className=\"w-10 h-10 text-green-500\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-md\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-slate-600\">Failed</p>\n                  <p className=\"text-3xl font-bold text-red-600\">\n                    {messages.filter(m => m.status === 'failed' || m.status === 'bounced').length}\n                  </p>\n                </div>\n                <XCircle className=\"w-10 h-10 text-red-500\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-md\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-slate-600\">Opened</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">\n                    {messages.filter(m => m.status === 'opened' || m.status === 'clicked').length}\n                  </p>\n                </div>\n                <Eye className=\"w-10 h-10 text-purple-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card className=\"mb-6 border-0 shadow-lg\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Filter className=\"w-5 h-5\" />\n              Filters\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n              <div>\n                <Label>Delivery ID</Label>\n                <Input\n                  placeholder=\"Search by ID...\"\n                  value={filters.delivery_id}\n                  onChange={(e) => setFilters({...filters, delivery_id: e.target.value})}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              <div>\n                <Label>Event Type</Label>\n                <Select value={filters.event_name} onValueChange={(value) => setFilters({...filters, event_name: value})}>\n                  <SelectTrigger className=\"mt-2\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Events</SelectItem>\n                    <SelectItem value=\"booking_confirmation\">Booking Confirmation</SelectItem>\n                    <SelectItem value=\"booking_reminder\">Booking Reminder</SelectItem>\n                    <SelectItem value=\"job_start_reminder\">Job Start Reminder</SelectItem>\n                    <SelectItem value=\"payment_success\">Payment Success</SelectItem>\n                    <SelectItem value=\"review_request\">Review Request</SelectItem>\n                    <SelectItem value=\"cleaner_notification\">Cleaner Notification</SelectItem>\n                    <SelectItem value=\"dispute_opened\">Dispute Opened</SelectItem>\n                    <SelectItem value=\"welcome_email\">Welcome Email</SelectItem>\n                    <SelectItem value=\"referral_reward\">Referral Reward</SelectItem>\n                    <SelectItem value=\"subscription_reminder\">Subscription Reminder</SelectItem>\n                    <SelectItem value=\"other\">Other</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Channel</Label>\n                <Select value={filters.channel} onValueChange={(value) => setFilters({...filters, channel: value})}>\n                  <SelectTrigger className=\"mt-2\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Channels</SelectItem>\n                    <SelectItem value=\"email\">Email</SelectItem>\n                    <SelectItem value=\"sms\">SMS</SelectItem>\n                    <SelectItem value=\"push\">Push</SelectItem>\n                    <SelectItem value=\"in_app\">In-App</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Status</Label>\n                <Select value={filters.status} onValueChange={(value) => setFilters({...filters, status: value})}>\n                  <SelectTrigger className=\"mt-2\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Statuses</SelectItem>\n                    <SelectItem value=\"pending\">Pending</SelectItem>\n                    <SelectItem value=\"sent\">Sent</SelectItem>\n                    <SelectItem value=\"delivered\">Delivered</SelectItem>\n                    <SelectItem value=\"failed\">Failed</SelectItem>\n                    <SelectItem value=\"bounced\">Bounced</SelectItem>\n                    <SelectItem value=\"opened\">Opened</SelectItem>\n                    <SelectItem value=\"clicked\">Clicked</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Template ID</Label>\n                <Input\n                  placeholder=\"Search by template...\"\n                  value={filters.template_id}\n                  onChange={(e) => setFilters({...filters, template_id: e.target.value})}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              <div>\n                <Label>Date From</Label>\n                <Input\n                  type=\"date\"\n                  value={filters.date_from}\n                  onChange={(e) => setFilters({...filters, date_from: e.target.value})}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              <div>\n                <Label>Date To</Label>\n                <Input\n                  type=\"date\"\n                  value={filters.date_to}\n                  onChange={(e) => setFilters({...filters, date_to: e.target.value})}\n                  className=\"mt-2\"\n                />\n              </div>\n\n              <div className=\"flex items-end\">\n                <Button variant=\"outline\" onClick={clearFilters} className=\"w-full\">\n                  Clear Filters\n                </Button>\n              </div>\n            </div>\n\n            <div className=\"mt-4 text-sm text-slate-600\">\n              Showing {filteredMessages.length} of {messages.length} messages\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Messages Table */}\n        <Card className=\"border-0 shadow-lg\">\n          <CardContent className=\"p-6\">\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Delivery ID</TableHead>\n                    <TableHead>Event</TableHead>\n                    <TableHead>Channel</TableHead>\n                    <TableHead>Recipient</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Template</TableHead>\n                    <TableHead>Sent At</TableHead>\n                    <TableHead>Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredMessages.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={8} className=\"text-center py-12\">\n                        <Mail className=\"w-12 h-12 text-slate-300 mx-auto mb-3\" />\n                        <p className=\"text-slate-500\">No messages found</p>\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    filteredMessages.map((message) => (\n                      <TableRow key={message.id}>\n                        <TableCell className=\"font-mono text-xs\">\n                          {message.delivery_id?.substring(0, 12)}...\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant=\"outline\">\n                            {message.event_name?.replace(/_/g, ' ')}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            {getChannelIcon(message.channel)}\n                            <span className=\"capitalize\">{message.channel}</span>\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"text-sm\">\n                          {message.recipient_email || message.recipient_phone}\n                        </TableCell>\n                        <TableCell>\n                          <Badge className={getStatusColor(message.status)}>\n                            <span className=\"flex items-center gap-1\">\n                              {getStatusIcon(message.status)}\n                              <span className=\"capitalize\">{message.status}</span>\n                            </span>\n                          </Badge>\n                        </TableCell>\n                        <TableCell className=\"text-xs text-slate-600\">\n                          {message.template_id || '-'}\n                        </TableCell>\n                        <TableCell className=\"text-sm text-slate-600\">\n                          {message.sent_at \n                            ? formatDistanceToNow(new Date(message.sent_at), { addSuffix: true })\n                            : '-'}\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex gap-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => setSelectedMessage(message)}\n                            >\n                              <Eye className=\"w-4 h-4\" />\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => handleResend(message)}\n                              disabled={!message.can_retry || resending}\n                            >\n                              <RefreshCw className={`w-4 h-4 ${resending ? 'animate-spin' : ''}`} />\n                            </Button>\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* View Message Dialog */}\n        {selectedMessage && (\n          <Dialog open={!!selectedMessage} onOpenChange={() => setSelectedMessage(null)}>\n            <DialogContent className=\"max-w-3xl max-h-[80vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle>Message Delivery Details</DialogTitle>\n              </DialogHeader>\n              <div className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Delivery ID</Label>\n                    <p className=\"font-mono text-sm\">{selectedMessage.delivery_id}</p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Event Type</Label>\n                    <p className=\"text-sm capitalize\">{selectedMessage.event_name?.replace(/_/g, ' ')}</p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Channel</Label>\n                    <p className=\"text-sm capitalize\">{selectedMessage.channel}</p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Status</Label>\n                    <Badge className={getStatusColor(selectedMessage.status)}>\n                      {selectedMessage.status}\n                    </Badge>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Recipient</Label>\n                    <p className=\"text-sm\">{selectedMessage.recipient_email || selectedMessage.recipient_phone}</p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Provider</Label>\n                    <p className=\"text-sm capitalize\">{selectedMessage.provider || 'Internal'}</p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Sent At</Label>\n                    <p className=\"text-sm\">\n                      {selectedMessage.sent_at \n                        ? new Date(selectedMessage.sent_at).toLocaleString()\n                        : 'Not sent yet'}\n                    </p>\n                  </div>\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Retry Count</Label>\n                    <p className=\"text-sm\">{selectedMessage.retry_count || 0}</p>\n                  </div>\n                </div>\n\n                {selectedMessage.subject && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Subject</Label>\n                    <p className=\"text-sm font-medium mt-1\">{selectedMessage.subject}</p>\n                  </div>\n                )}\n\n                {selectedMessage.body && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Message Body</Label>\n                    <div className=\"mt-1 p-4 bg-slate-50 rounded-lg border border-slate-200\">\n                      <p className=\"text-sm whitespace-pre-wrap\">{selectedMessage.body}</p>\n                    </div>\n                  </div>\n                )}\n\n                {selectedMessage.error_message && (\n                  <div>\n                    <Label className=\"text-xs text-red-500\">Error Message</Label>\n                    <div className=\"mt-1 p-4 bg-red-50 rounded-lg border border-red-200\">\n                      <p className=\"text-sm text-red-900\">{selectedMessage.error_message}</p>\n                    </div>\n                  </div>\n                )}\n\n                {selectedMessage.metadata && (\n                  <div>\n                    <Label className=\"text-xs text-slate-500\">Metadata</Label>\n                    <pre className=\"mt-1 p-4 bg-slate-50 rounded-lg border border-slate-200 text-xs overflow-x-auto\">\n                      {JSON.stringify(selectedMessage.metadata, null, 2)}\n                    </pre>\n                  </div>\n                )}\n\n                <div className=\"flex gap-3 pt-4\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setSelectedMessage(null)}\n                    className=\"flex-1\"\n                  >\n                    Close\n                  </Button>\n                  {selectedMessage.can_retry && (\n                    <Button\n                      onClick={() => {\n                        handleResend(selectedMessage);\n                        setSelectedMessage(null);\n                      }}\n                      disabled={resending}\n                      className=\"flex-1\"\n                    >\n                      <RefreshCw className={`w-4 h-4 mr-2 ${resending ? 'animate-spin' : ''}`} />\n                      Resend Message\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminNotifications.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":7,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":36,"fix":{"range":[347,360],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[346,359],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":7,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":49,"fix":{"range":[360,373],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[359,372],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, Bell, CheckCircle, AlertCircle, RefreshCw } from 'lucide-react';\nimport { seedNotificationTemplates } from '../components/notifications/TemplateSeeder';\n\nexport default function AdminNotifications() {\n  const [templates, setTemplates] = useState([]);\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [seeding, setSeeding] = useState(false);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const [templatesData, logsData] = await Promise.all([\n        base44.entities.NotificationTemplate.filter({}, 'code', 100),\n        base44.entities.NotificationsLog.filter({}, '-sent_at', 50)\n      ]);\n      setTemplates(templatesData);\n      setLogs(logsData);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading notification data:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const handleSeedTemplates = async () => {\n    setSeeding(true);\n    try {\n      const result = await seedNotificationTemplates(base44);\n      alert(`Templates seeded: ${result.created} created, ${result.updated} updated`);\n      await loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error seeding templates:', showToast: false });\n      alert('Failed to seed templates');\n    }\n    setSeeding(false);\n  };\n\n  const toggleTemplate = async (template) => {\n    try {\n      await base44.entities.NotificationTemplate.update(template.id, {\n        is_active: !template.is_active\n      });\n      await loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error toggling template:', showToast: false });\n    }\n  };\n\n  const categoryColors = {\n    booking: 'bg-blue-100 text-blue-800',\n    payment: 'bg-green-100 text-green-800',\n    payout: 'bg-purple-100 text-purple-800',\n    reliability: 'bg-yellow-100 text-yellow-800',\n    dispute: 'bg-red-100 text-red-800',\n    admin: 'bg-gray-100 text-gray-800'\n  };\n\n  const statusColors = {\n    success: 'bg-green-100 text-green-800',\n    failed: 'bg-red-100 text-red-800',\n    retrying: 'bg-yellow-100 text-yellow-800',\n    pending: 'bg-blue-100 text-blue-800'\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-soft-cloud\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n              Notification System\n            </h1>\n            <p className=\"text-gray-600 font-verdana\">\n              Manage notification templates and delivery logs\n            </p>\n          </div>\n          <Button\n            onClick={handleSeedTemplates}\n            disabled={seeding}\n            className=\"brand-gradient text-white rounded-full font-fredoka\"\n          >\n            {seeding ? <Loader2 className=\"w-4 h-4 animate-spin mr-2\" /> : <RefreshCw className=\"w-4 h-4 mr-2\" />}\n            Seed Templates\n          </Button>\n        </div>\n\n        <div className=\"grid lg:grid-cols-2 gap-6\">\n          {/* Templates */}\n          <Card className=\"rounded-3xl border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n                <Bell className=\"w-6 h-6\" />\n                Templates ({templates.length})\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n              {templates.map((template) => (\n                <div key={template.id} className=\"p-4 bg-gray-50 rounded-2xl\">\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <code className=\"text-sm font-mono text-puretask-blue\">\n                          {template.code}\n                        </code>\n                        <Badge className={categoryColors[template.category]}>\n                          {template.category}\n                        </Badge>\n                      </div>\n                      <p className=\"text-xs text-gray-600 font-verdana mb-2\">\n                        {template.body_template?.substring(0, 100)}...\n                      </p>\n                      <div className=\"flex gap-1\">\n                        {template.channels?.map(ch => (\n                          <Badge key={ch} variant=\"outline\" className=\"text-xs\">\n                            {ch}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n                    <Button\n                      onClick={() => toggleTemplate(template)}\n                      variant={template.is_active ? 'default' : 'outline'}\n                      size=\"sm\"\n                      className=\"rounded-full\"\n                    >\n                      {template.is_active ? 'Active' : 'Inactive'}\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n\n          {/* Delivery Logs */}\n          <Card className=\"rounded-3xl border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-2xl\">Recent Deliveries</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3 max-h-[600px] overflow-y-auto\">\n              {logs.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500 font-verdana\">\n                  No notifications sent yet\n                </div>\n              ) : (\n                logs.map((log) => (\n                  <div key={log.id} className=\"p-3 bg-gray-50 rounded-2xl\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <code className=\"text-xs font-mono text-gray-700\">\n                        {log.template_code}\n                      </code>\n                      <Badge className={statusColors[log.delivery_status]}>\n                        {log.delivery_status}\n                      </Badge>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-xs text-gray-600 font-verdana\">\n                      <span>{log.user_email}</span>\n                      <span>‚Ä¢</span>\n                      <span>{new Date(log.sent_at).toLocaleString()}</span>\n                    </div>\n                    {log.channels_used && (\n                      <div className=\"flex gap-1 mt-2\">\n                        {log.channels_used.map(ch => (\n                          <Badge key={ch} variant=\"secondary\" className=\"text-xs\">\n                            {ch}\n                          </Badge>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                ))\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminPricingManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[324,371],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[324,370],"text":""},"desc":"Remove unused variable 'Input'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Edit' is defined but never used.","line":8,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":47,"fix":{"range":[412,418],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Edit"},"fix":{"range":[411,417],"text":""},"desc":"Remove unused variable 'Edit'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Dialog' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"fix":{"range":[474,482],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Dialog"},"fix":{"range":[475,482],"text":""},"desc":"Remove unused variable 'Dialog'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogContent' is defined but never used.","line":9,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":31,"fix":{"range":[482,497],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogContent"},"fix":{"range":[481,496],"text":""},"desc":"Remove unused variable 'DialogContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogHeader' is defined but never used.","line":9,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":45,"fix":{"range":[497,511],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogHeader"},"fix":{"range":[496,510],"text":""},"desc":"Remove unused variable 'DialogHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogTitle' is defined but never used.","line":9,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":58,"fix":{"range":[510,523],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogTitle"},"fix":{"range":[510,523],"text":""},"desc":"Remove unused variable 'DialogTitle'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'editingRule' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"editingRule"},"fix":{"range":[778,789],"text":""},"desc":"Remove unused variable 'editingRule'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setEditingRule' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":15,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"setEditingRule"},"fix":{"range":[789,805],"text":""},"desc":"Remove unused variable 'setEditingRule'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'showRuleDialog' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"showRuleDialog"},"fix":{"range":[834,848],"text":""},"desc":"Remove unused variable 'showRuleDialog'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setShowRuleDialog' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":16,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"setShowRuleDialog"},"fix":{"range":[848,867],"text":""},"desc":"Remove unused variable 'setShowRuleDialog'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Loader2, Plus, Settings, Trash2, Edit, ToggleLeft, ToggleRight } from 'lucide-react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\n\nexport default function AdminPricingManagement() {\n  const [pricingRules, setPricingRules] = useState([]);\n  const [bundleOffers, setBundleOffers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingRule, setEditingRule] = useState(null);\n  const [showRuleDialog, setShowRuleDialog] = useState(false);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const rules = await base44.entities.PricingRule.filter({}, '-priority', 100);\n      const bundles = await base44.entities.BundleOffer.filter({}, '-created_date', 100);\n      setPricingRules(rules);\n      setBundleOffers(bundles);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading pricing data:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const toggleRule = async (rule) => {\n    try {\n      await base44.entities.PricingRule.update(rule.id, {\n        is_active: !rule.is_active\n      });\n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error toggling rule:', showToast: false });\n    }\n  };\n\n  const deleteRule = async (ruleId) => {\n    if (confirm('Delete this pricing rule?')) {\n      try {\n        await base44.entities.PricingRule.delete(ruleId);\n        loadData();\n      } catch (error) {\n        handleError(error, { userMessage: 'Error deleting rule:', showToast: false });\n      }\n    }\n  };\n\n  const ruleTypeColors = {\n    time_of_day: 'bg-blue-100 text-blue-800',\n    day_of_week: 'bg-purple-100 text-purple-800',\n    distance: 'bg-green-100 text-green-800',\n    surge: 'bg-red-100 text-red-800',\n    last_minute: 'bg-yellow-100 text-yellow-800',\n    holiday: 'bg-pink-100 text-pink-800',\n    first_booking_discount: 'bg-indigo-100 text-indigo-800'\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-soft-cloud\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Pricing Management</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Manage dynamic pricing rules and bundle offers</p>\n          </div>\n          <Button className=\"brand-gradient text-white rounded-full font-fredoka\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            New Rule\n          </Button>\n        </div>\n\n        {/* Pricing Rules */}\n        <Card className=\"rounded-3xl border-0 shadow-xl mb-8\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-2xl\">Active Pricing Rules</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {pricingRules.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Settings className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                <p className=\"text-gray-500 font-verdana\">No pricing rules configured</p>\n              </div>\n            ) : (\n              pricingRules.map((rule) => (\n                <div\n                  key={rule.id}\n                  className=\"flex items-center justify-between p-4 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors\"\n                >\n                  <div className=\"flex items-center gap-4\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => toggleRule(rule)}\n                      className=\"rounded-full\"\n                    >\n                      {rule.is_active ? (\n                        <ToggleRight className=\"w-6 h-6 text-green-600\" />\n                      ) : (\n                        <ToggleLeft className=\"w-6 h-6 text-gray-400\" />\n                      )}\n                    </Button>\n                    <div>\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <Badge className={ruleTypeColors[rule.rule_type] || 'bg-gray-100 text-gray-800'}>\n                          {rule.rule_type?.replace('_', ' ')}\n                        </Badge>\n                        <span className=\"font-fredoka font-semibold text-graphite\">\n                          {rule.display_label || 'Unnamed Rule'}\n                        </span>\n                      </div>\n                      <p className=\"text-sm text-gray-600 font-verdana\">\n                        Multiplier: {((rule.multiplier || 1) * 100).toFixed(0)}% ‚Ä¢ Priority: {rule.priority || 0}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => deleteRule(rule.id)}\n                      className=\"text-red-600 hover:bg-red-50 rounded-full\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Bundle Offers */}\n        <Card className=\"rounded-3xl border-0 shadow-xl\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-2xl\">Bundle Offers</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {bundleOffers.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Settings className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                <p className=\"text-gray-500 font-verdana\">No bundle offers configured</p>\n              </div>\n            ) : (\n              bundleOffers.map((bundle) => (\n                <div\n                  key={bundle.id}\n                  className=\"flex items-center justify-between p-4 bg-gray-50 rounded-2xl\"\n                >\n                  <div>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <Badge variant=\"secondary\">\n                        {bundle.offer_type?.replace('_', ' ')}\n                      </Badge>\n                      <span className=\"font-fredoka font-semibold text-graphite\">\n                        {bundle.display_message || 'Bundle Offer'}\n                      </span>\n                    </div>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      {bundle.discount_percentage && `${bundle.discount_percentage}% off`}\n                      {bundle.discount_amount && `$${bundle.discount_amount} off`}\n                    </p>\n                  </div>\n\n                  <Badge className={bundle.is_active ? 'bg-green-500' : 'bg-gray-400'}>\n                    {bundle.is_active ? 'Active' : 'Inactive'}\n                  </Badge>\n                </div>\n              ))\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminPricingRules.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogTrigger' is defined but never used.","line":13,"column":93,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":106,"fix":{"range":[772,787],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogTrigger"},"fix":{"range":[772,787],"text":""},"desc":"Remove unused variable 'DialogTrigger'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, DollarSign, Plus, Edit, Trash2, CheckCircle, XCircle, AlertCircle } from 'lucide-react';\nimport { DEFAULT_PRICING_RULES } from '../components/pricing/PricingRules';\nimport { toast } from 'sonner';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter, DialogTrigger } from '@/components/ui/dialog';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Textarea } from '@/components/ui/textarea';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\n\nexport default function AdminPricingRules() {\n  const [rules, setRules] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingRule, setEditingRule] = useState(null);\n  const [expandedConditions, setExpandedConditions] = useState({});\n\n  useEffect(() => {\n    loadRules();\n  }, []);\n\n  const loadRules = async () => {\n    try {\n      let dbRules = await base44.entities.PricingRule.list();\n      \n      // If no rules in DB, create defaults\n      if (dbRules.length === 0) {\n        for (const rule of DEFAULT_PRICING_RULES) {\n          await base44.entities.PricingRule.create(rule);\n        }\n        dbRules = await base44.entities.PricingRule.list();\n      }\n      \n      setRules(dbRules);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading rules:', showToast: false });\n      toast.error('Failed to load pricing rules');\n    }\n    setLoading(false);\n  };\n\n  const toggleRule = async (ruleId, currentStatus) => {\n    try {\n      await base44.entities.PricingRule.update(ruleId, {\n        is_active: !currentStatus\n      });\n      toast.success(`Rule ${!currentStatus ? 'enabled' : 'disabled'}`);\n      loadRules();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error toggling rule:', showToast: false });\n      toast.error('Failed to update rule');\n    }\n  };\n\n  const updateMultiplier = async (ruleId, newMultiplier) => {\n    try {\n      await base44.entities.PricingRule.update(ruleId, {\n        multiplier: parseFloat(newMultiplier)\n      });\n      toast.success('Multiplier updated');\n      loadRules();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error updating multiplier:', showToast: false });\n      toast.error('Failed to update multiplier');\n    }\n  };\n\n  const deleteRule = async (ruleId) => {\n    try {\n      await base44.entities.PricingRule.delete(ruleId);\n      toast.success('Rule deleted successfully');\n      loadRules();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error deleting rule:', showToast: false });\n      toast.error('Failed to delete rule');\n    }\n  };\n\n  const pricingRuleSchema = z.object({\n    rule_name: z.string().min(1, \"Rule Name is required\"),\n    rule_type: z.enum([\"time_of_day\", \"day_of_week\", \"distance\", \"surge\", \"last_minute\", \"holiday\", \"first_booking_discount\"]),\n    multiplier: z.coerce.number().min(0, \"Multiplier cannot be negative\"),\n    conditions: z.string().refine((val) => {\n      try {\n        JSON.parse(val);\n        return true;\n      } catch {\n        return false;\n      }\n    }, { message: \"Must be valid JSON\" }),\n    is_active: z.boolean().default(true),\n    display_label: z.string().optional(),\n    priority: z.coerce.number().int().min(0).default(0),\n  });\n\n  const form = useForm({\n    resolver: zodResolver(pricingRuleSchema),\n    defaultValues: {\n      rule_name: \"\",\n      rule_type: \"time_of_day\",\n      multiplier: 1.0,\n      conditions: \"{}\",\n      is_active: true,\n      display_label: \"\",\n      priority: 0,\n    },\n  });\n\n  const onSubmit = async (data) => {\n    try {\n      const ruleData = { ...data };\n      ruleData.conditions = JSON.parse(ruleData.conditions);\n\n      if (editingRule) {\n        await base44.entities.PricingRule.update(editingRule.id, ruleData);\n        toast.success('Rule updated successfully');\n      } else {\n        await base44.entities.PricingRule.create(ruleData);\n        toast.success('Rule created successfully');\n      }\n      setIsDialogOpen(false);\n      setEditingRule(null);\n      form.reset();\n      loadRules();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving rule:', showToast: false });\n      toast.error(`Failed to save rule: ${error.message}`);\n    }\n  };\n\n  const handleEditClick = (rule) => {\n    setEditingRule(rule);\n    form.reset({\n      rule_name: rule.rule_name,\n      rule_type: rule.rule_type,\n      multiplier: rule.multiplier,\n      conditions: JSON.stringify(rule.conditions, null, 2),\n      is_active: rule.is_active,\n      display_label: rule.display_label || \"\",\n      priority: rule.priority || 0,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const handleAddClick = () => {\n    setEditingRule(null);\n    form.reset({\n      rule_name: \"\",\n      rule_type: \"time_of_day\",\n      multiplier: 1.0,\n      conditions: \"{}\",\n      is_active: true,\n      display_label: \"\",\n      priority: 0,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const toggleConditionsExpanded = (ruleId) => {\n    setExpandedConditions(prev => ({ ...prev, [ruleId]: !prev[ruleId] }));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-5xl mx-auto\">\n        <div className=\"mb-8 flex items-start justify-between gap-4\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2 flex items-center gap-3\">\n              <DollarSign className=\"w-10 h-10 text-puretask-blue\" />\n              Pricing Rules Manager\n            </h1>\n            <p className=\"text-lg text-gray-600 font-verdana\">\n              Configure dynamic pricing multipliers for different scenarios\n            </p>\n          </div>\n          <Button onClick={handleAddClick} className=\"brand-gradient text-white rounded-full font-fredoka font-semibold shadow-lg\">\n            <Plus className=\"w-4 h-4 mr-2\" /> Add New Rule\n          </Button>\n        </div>\n\n        <Alert className=\"mb-6 bg-blue-50 border-blue-200\">\n          <AlertCircle className=\"h-4 w-4 text-blue-600\" />\n          <AlertDescription className=\"text-blue-800 font-verdana\">\n            Rules are applied based on priority order (higher priority first). Multiple rules can be combined for complex pricing strategies.\n          </AlertDescription>\n        </Alert>\n\n        <div className=\"space-y-4\">\n          {rules.map(rule => (\n            <Card \n              key={rule.id} \n              className={`border-0 shadow-lg rounded-2xl transition-all ${\n                rule.is_active \n                  ? 'bg-gradient-to-br from-green-50 to-emerald-50' \n                  : 'opacity-60 bg-white'\n              }`}\n            >\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-start justify-between mb-4\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-2 flex-wrap\">\n                      <h3 className=\"text-xl font-fredoka font-bold text-graphite\">{rule.rule_name}</h3>\n                      <Badge variant=\"outline\" className=\"text-xs font-fredoka capitalize\">\n                        {rule.rule_type.replace(/_/g, ' ')}\n                      </Badge>\n                      {rule.is_active ? (\n                        <Badge className=\"bg-green-500 text-white font-fredoka text-xs\">\n                          <CheckCircle className=\"w-3 h-3 mr-1\" /> Active\n                        </Badge>\n                      ) : (\n                        <Badge className=\"bg-red-500 text-white font-fredoka text-xs\">\n                          <XCircle className=\"w-3 h-3 mr-1\" /> Inactive\n                        </Badge>\n                      )}\n                    </div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">{rule.display_label}</p>\n                    <p className=\"text-xs text-gray-500 font-verdana\">Priority: {rule.priority}</p>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => handleEditClick(rule)} className=\"h-9\">\n                      <Edit className=\"w-4 h-4\" />\n                    </Button>\n                    <AlertDialog>\n                      <AlertDialogTrigger asChild>\n                        <Button variant=\"destructive\" size=\"sm\" className=\"h-9\">\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </AlertDialogTrigger>\n                      <AlertDialogContent>\n                        <AlertDialogHeader>\n                          <AlertDialogTitle>Delete Pricing Rule?</AlertDialogTitle>\n                          <AlertDialogDescription>\n                            This action cannot be undone. This will permanently delete the pricing rule \"{rule.rule_name}\".\n                          </AlertDialogDescription>\n                        </AlertDialogHeader>\n                        <AlertDialogFooter>\n                          <AlertDialogCancel>Cancel</AlertDialogCancel>\n                          <AlertDialogAction onClick={() => deleteRule(rule.id)} className=\"bg-red-600 hover:bg-red-700\">\n                            Delete\n                          </AlertDialogAction>\n                        </AlertDialogFooter>\n                      </AlertDialogContent>\n                    </AlertDialog>\n                    <Switch\n                      checked={rule.is_active}\n                      onCheckedChange={() => toggleRule(rule.id, rule.is_active)}\n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label className=\"text-sm font-fredoka font-semibold mb-2 block text-graphite\">Multiplier</Label>\n                    <Input\n                      type=\"number\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      value={rule.multiplier}\n                      onChange={(e) => updateMultiplier(rule.id, e.target.value)}\n                      disabled={!rule.is_active}\n                      className=\"text-lg font-fredoka font-bold\"\n                    />\n                    <p className={`text-xs mt-1 font-verdana ${\n                      rule.multiplier > 1 ? 'text-amber-600' : 'text-fresh-mint'\n                    }`}>\n                      {rule.multiplier > 1 \n                        ? `+${((rule.multiplier - 1) * 100).toFixed(0)}% increase`\n                        : `-${((1 - rule.multiplier) * 100).toFixed(0)}% discount`\n                      }\n                    </p>\n                  </div>\n                  <div>\n                    <Label className=\"text-sm font-fredoka font-semibold mb-2 block text-graphite\">Example Impact</Label>\n                    <div className=\"p-3 bg-white rounded-2xl border border-gray-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana\">$100 booking becomes</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-fresh-mint\">\n                        ${(100 * rule.multiplier).toFixed(2)}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"mt-4 p-3 bg-gray-50 rounded-2xl border border-gray-200\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <p className=\"text-xs font-fredoka font-semibold text-graphite\">Conditions:</p>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      onClick={() => toggleConditionsExpanded(rule.id)}\n                      className=\"h-6 text-xs\"\n                    >\n                      {expandedConditions[rule.id] ? 'Hide' : 'Show'} JSON\n                    </Button>\n                  </div>\n                  {expandedConditions[rule.id] ? (\n                    <pre className=\"text-xs text-gray-600 font-mono whitespace-pre-wrap\">\n                      {JSON.stringify(rule.conditions, null, 2)}\n                    </pre>\n                  ) : (\n                    <p className=\"text-xs text-gray-500 font-verdana italic\">\n                      {Object.keys(rule.conditions || {}).length} condition(s) defined\n                    </p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Create/Edit Dialog */}\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka text-2xl\">\n                {editingRule ? 'Edit Pricing Rule' : 'Create New Pricing Rule'}\n              </DialogTitle>\n              <DialogDescription className=\"font-verdana\">\n                {editingRule ? 'Update the details of the pricing rule.' : 'Add a new pricing rule to your system.'}\n              </DialogDescription>\n            </DialogHeader>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"grid gap-4 py-4\">\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"rule_name\" className=\"font-fredoka font-semibold\">Rule Name *</Label>\n                <Input \n                  id=\"rule_name\" \n                  {...form.register('rule_name')} \n                  placeholder=\"e.g., Weekend Premium\"\n                />\n                {form.formState.errors.rule_name && (\n                  <p className=\"text-red-500 text-sm font-verdana\">{form.formState.errors.rule_name.message}</p>\n                )}\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"rule_type\" className=\"font-fredoka font-semibold\">Rule Type *</Label>\n                <Select \n                  onValueChange={(value) => form.setValue('rule_type', value)} \n                  value={form.watch('rule_type')}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select a rule type\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"time_of_day\">Time of Day</SelectItem>\n                    <SelectItem value=\"day_of_week\">Day of Week</SelectItem>\n                    <SelectItem value=\"distance\">Distance</SelectItem>\n                    <SelectItem value=\"surge\">Surge</SelectItem>\n                    <SelectItem value=\"last_minute\">Last Minute</SelectItem>\n                    <SelectItem value=\"holiday\">Holiday</SelectItem>\n                    <SelectItem value=\"first_booking_discount\">First Booking Discount</SelectItem>\n                  </SelectContent>\n                </Select>\n                {form.formState.errors.rule_type && (\n                  <p className=\"text-red-500 text-sm font-verdana\">{form.formState.errors.rule_type.message}</p>\n                )}\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"grid gap-2\">\n                  <Label htmlFor=\"multiplier\" className=\"font-fredoka font-semibold\">Multiplier *</Label>\n                  <Input \n                    id=\"multiplier\" \n                    type=\"number\" \n                    step=\"0.01\" \n                    {...form.register('multiplier')}\n                    placeholder=\"1.0\"\n                  />\n                  {form.formState.errors.multiplier && (\n                    <p className=\"text-red-500 text-sm font-verdana\">{form.formState.errors.multiplier.message}</p>\n                  )}\n                  <p className=\"text-xs text-gray-500 font-verdana\">\n                    1.0 = no change, 1.2 = +20%, 0.8 = -20%\n                  </p>\n                </div>\n\n                <div className=\"grid gap-2\">\n                  <Label htmlFor=\"priority\" className=\"font-fredoka font-semibold\">Priority</Label>\n                  <Input \n                    id=\"priority\" \n                    type=\"number\" \n                    {...form.register('priority')}\n                    placeholder=\"0\"\n                  />\n                  {form.formState.errors.priority && (\n                    <p className=\"text-red-500 text-sm font-verdana\">{form.formState.errors.priority.message}</p>\n                  )}\n                  <p className=\"text-xs text-gray-500 font-verdana\">Higher = applies first</p>\n                </div>\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"display_label\" className=\"font-fredoka font-semibold\">Display Label</Label>\n                <Input \n                  id=\"display_label\" \n                  {...form.register('display_label')}\n                  placeholder=\"e.g., 20% weekend surcharge\"\n                />\n                <p className=\"text-xs text-gray-500 font-verdana\">Shown to users when rule applies</p>\n              </div>\n\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"conditions\" className=\"font-fredoka font-semibold\">Conditions (JSON) *</Label>\n                <Textarea \n                  id=\"conditions\" \n                  {...form.register('conditions')} \n                  className=\"min-h-[100px] font-mono text-xs\"\n                  placeholder='{\"day_of_week\": [\"Saturday\", \"Sunday\"]}'\n                />\n                {form.formState.errors.conditions && (\n                  <p className=\"text-red-500 text-sm font-verdana\">{form.formState.errors.conditions.message}</p>\n                )}\n                <p className=\"text-xs text-gray-500 font-verdana\">Define when this rule applies (valid JSON object)</p>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <Switch \n                  id=\"is_active\" \n                  checked={form.watch('is_active')} \n                  onCheckedChange={(checked) => form.setValue('is_active', checked)}\n                />\n                <Label htmlFor=\"is_active\" className=\"font-fredoka\">Active</Label>\n              </div>\n\n              <DialogFooter className=\"gap-2\">\n                <Button \n                  type=\"button\" \n                  variant=\"outline\" \n                  onClick={() => {\n                    setIsDialogOpen(false);\n                    setEditingRule(null);\n                    form.reset();\n                  }}\n                >\n                  Cancel\n                </Button>\n                <Button \n                  type=\"submit\" \n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\" \n                  disabled={form.formState.isSubmitting}\n                >\n                  {form.formState.isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                  {editingRule ? 'Save Changes' : 'Create Rule'}\n                </Button>\n              </DialogFooter>\n            </form>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminRiskFlags.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bell' is defined but never used.","line":9,"column":80,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":84,"fix":{"range":[508,514],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bell"},"fix":{"range":[507,513],"text":""},"desc":"Remove unused variable 'Bell'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Flag, CheckCircle, XCircle, Loader2, AlertTriangle, Calendar, Shield, Bell, Lock, Ban, UserX } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\n\nexport default function AdminRiskFlags() {\n  const [loading, setLoading] = useState(true);\n  const [flags, setFlags] = useState([]);\n  const [filter, setFilter] = useState('open');\n  const [selectedFlag, setSelectedFlag] = useState(null);\n  const [resolutionNotes, setResolutionNotes] = useState('');\n  const [selectedFlags, setSelectedFlags] = useState([]);\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [riskProfiles, setRiskProfiles] = useState({});\n  const [currentUser, setCurrentUser] = useState(null);\n  const [actionDialogOpen, setActionDialogOpen] = useState(false);\n  const [actionTarget, setActionTarget] = useState(null);\n  const [actionType, setActionType] = useState(null);\n\n  useEffect(() => {\n    loadCurrentUser();\n  }, []);\n\n  useEffect(() => {\n    loadFlags();\n  }, [filter, startDate, endDate]);\n\n  const loadCurrentUser = async () => {\n    try {\n      const user = await base44.auth.me();\n      setCurrentUser(user);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading user:', showToast: false });\n    }\n  };\n\n  const loadFlags = async () => {\n    setLoading(true);\n    try {\n      let flagList;\n      if (filter === 'all') {\n        flagList = await base44.entities.RiskFlag.list('-created_date', 200);\n      } else {\n        flagList = await base44.entities.RiskFlag.filter({ status: filter });\n      }\n      \n      // Apply date range filtering\n      if (startDate || endDate) {\n        flagList = flagList.filter(flag => {\n          const flagDate = new Date(flag.created_date);\n          if (startDate && flagDate < new Date(startDate)) return false;\n          if (endDate && flagDate > new Date(endDate + 'T23:59:59')) return false;\n          return true;\n        });\n      }\n\n      setFlags(flagList);\n\n      // Load risk profiles for each unique subject\n      const uniqueSubjects = [...new Set(flagList.map(f => f.subject_id))];\n      await loadRiskProfiles(uniqueSubjects);\n\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading flags:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const loadRiskProfiles = async (subjectIds) => {\n    try {\n      const profiles = {};\n      for (const subjectId of subjectIds) {\n        const profile = await base44.entities.RiskProfile.filter({ user_email: subjectId });\n        if (profile.length > 0) {\n          profiles[subjectId] = profile[0];\n        }\n      }\n      setRiskProfiles(profiles);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading risk profiles:', showToast: false });\n    }\n  };\n\n  const logAuditAction = async (actionType, targetId, metadata) => {\n    if (!currentUser) return;\n    \n    try {\n      await base44.entities.AdminAuditLog.create({\n        admin_email: currentUser.email,\n        action_type: actionType,\n        target_type: 'risk_flag',\n        target_id: targetId,\n        metadata: metadata\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error logging audit action:', showToast: false });\n    }\n  };\n\n  const sendNotification = async (recipientEmail, type, title, message) => {\n    try {\n      await base44.entities.Notification.create({\n        recipient_email: recipientEmail,\n        type: type,\n        title: title,\n        message: message,\n        priority: 'high'\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error sending notification:', showToast: false });\n    }\n  };\n\n  const handleResolve = async (flagId) => {\n    try {\n      const flag = flags.find(f => f.id === flagId);\n      \n      await base44.entities.RiskFlag.update(flagId, {\n        status: 'resolved',\n        notes: resolutionNotes || 'Resolved by admin'\n      });\n\n      // Log audit trail\n      await logAuditAction('RESOLVE_RISK_FLAG', flagId, {\n        flag_rule: flag?.triggered_rule,\n        resolution_notes: resolutionNotes || 'Resolved by admin',\n        subject_id: flag?.subject_id\n      });\n      \n      toast.success('Risk flag resolved');\n      setResolutionNotes('');\n      setSelectedFlag(null);\n      loadFlags();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving flag:', showToast: false });\n      toast.error('Failed to resolve flag');\n    }\n  };\n\n  const handleDismiss = async (flagId) => {\n    try {\n      const flag = flags.find(f => f.id === flagId);\n      \n      await base44.entities.RiskFlag.update(flagId, {\n        status: 'dismissed',\n        notes: 'Dismissed by admin - false positive'\n      });\n\n      // Log audit trail\n      await logAuditAction('DISMISS_RISK_FLAG', flagId, {\n        flag_rule: flag?.triggered_rule,\n        reason: 'false positive',\n        subject_id: flag?.subject_id\n      });\n      \n      toast.success('Risk flag dismissed');\n      loadFlags();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error dismissing flag:', showToast: false });\n      toast.error('Failed to dismiss flag');\n    }\n  };\n\n  const handleBulkResolve = async () => {\n    if (selectedFlags.length === 0) return;\n    \n    try {\n      for (const flagId of selectedFlags) {\n        const flag = flags.find(f => f.id === flagId);\n        await base44.entities.RiskFlag.update(flagId, {\n          status: 'resolved',\n          notes: 'Bulk resolved by admin'\n        });\n        await logAuditAction('BULK_RESOLVE_RISK_FLAG', flagId, {\n          flag_rule: flag?.triggered_rule,\n          bulk_action: true\n        });\n      }\n      \n      toast.success(`${selectedFlags.length} flags resolved`);\n      setSelectedFlags([]);\n      loadFlags();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error bulk resolving:', showToast: false });\n      toast.error('Failed to resolve flags');\n    }\n  };\n\n  const handleBulkDismiss = async () => {\n    if (selectedFlags.length === 0) return;\n    \n    try {\n      for (const flagId of selectedFlags) {\n        const flag = flags.find(f => f.id === flagId);\n        await base44.entities.RiskFlag.update(flagId, {\n          status: 'dismissed',\n          notes: 'Bulk dismissed by admin'\n        });\n        await logAuditAction('BULK_DISMISS_RISK_FLAG', flagId, {\n          flag_rule: flag?.triggered_rule,\n          bulk_action: true\n        });\n      }\n      \n      toast.success(`${selectedFlags.length} flags dismissed`);\n      setSelectedFlags([]);\n      loadFlags();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error bulk dismissing:', showToast: false });\n      toast.error('Failed to dismiss flags');\n    }\n  };\n\n  const handleAutomatedAction = async (flag, action) => {\n    setActionTarget(flag);\n    setActionType(action);\n    setActionDialogOpen(true);\n  };\n\n  const executeAutomatedAction = async () => {\n    if (!actionTarget || !actionType) return;\n\n    try {\n      const actionData = {\n        user_type: actionTarget.subject_type === 'client' ? 'client' : 'cleaner',\n        user_email: actionTarget.subject_id,\n        action_type: actionType,\n        action_direction: 'apply',\n        reason_code: actionTarget.category,\n        severity: actionTarget.severity,\n        performed_by: 'admin',\n        performed_by_email: currentUser?.email,\n        target_type: 'account',\n        target_id: actionTarget.subject_id,\n        metadata: {\n          triggered_by_flag: actionTarget.id,\n          triggered_rule: actionTarget.triggered_rule,\n          confidence: actionTarget.confidence\n        }\n      };\n\n      await base44.entities.RiskActionLog.create(actionData);\n\n      // Send notification to user\n      await sendNotification(\n        actionTarget.subject_id,\n        'system_alert',\n        'Account Action Taken',\n        `An automated action has been applied to your account due to security reasons. Please contact support if you have questions.`\n      );\n\n      // Log audit trail\n      await logAuditAction('APPLY_AUTOMATED_ACTION', actionTarget.id, {\n        action_type: actionType,\n        subject_id: actionTarget.subject_id,\n        triggered_by_flag: actionTarget.id\n      });\n\n      toast.success(`Action \"${actionType}\" applied successfully`);\n      setActionDialogOpen(false);\n      setActionTarget(null);\n      setActionType(null);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error executing automated action:', showToast: false });\n      toast.error('Failed to apply action');\n    }\n  };\n\n  const toggleFlagSelection = (flagId) => {\n    setSelectedFlags(prev => \n      prev.includes(flagId) \n        ? prev.filter(id => id !== flagId)\n        : [...prev, flagId]\n    );\n  };\n\n  const toggleSelectAll = () => {\n    if (selectedFlags.length === flags.length) {\n      setSelectedFlags([]);\n    } else {\n      setSelectedFlags(flags.map(f => f.id));\n    }\n  };\n\n  const getSeverityColor = (severity) => {\n    switch (severity) {\n      case 'critical': return 'bg-red-600 text-white';\n      case 'high': return 'bg-amber-600 text-white';\n      case 'medium': return 'bg-yellow-600 text-white';\n      case 'low': return 'bg-blue-600 text-white';\n      default: return 'bg-gray-600 text-white';\n    }\n  };\n\n  const getCategoryColor = (category) => {\n    switch (category) {\n      case 'safety_issue': return 'bg-red-100 text-red-800';\n      case 'payment_risk': return 'bg-purple-100 text-purple-800';\n      case 'refund_abuse': return 'bg-amber-100 text-amber-800';\n      case 'reliability_risk': return 'bg-yellow-100 text-yellow-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Risk Flags</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Review and manage automated risk detections</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant={filter === 'open' ? 'default' : 'outline'}\n              onClick={() => setFilter('open')}\n              className=\"font-fredoka\"\n            >\n              Open ({flags.filter(f => f.status === 'open').length})\n            </Button>\n            <Button\n              variant={filter === 'under_review' ? 'default' : 'outline'}\n              onClick={() => setFilter('under_review')}\n              className=\"font-fredoka\"\n            >\n              Under Review\n            </Button>\n            <Button\n              variant={filter === 'resolved' ? 'default' : 'outline'}\n              onClick={() => setFilter('resolved')}\n              className=\"font-fredoka\"\n            >\n              Resolved\n            </Button>\n            <Button\n              variant={filter === 'all' ? 'default' : 'outline'}\n              onClick={() => setFilter('all')}\n              className=\"font-fredoka\"\n            >\n              All\n            </Button>\n          </div>\n        </div>\n\n        {/* Date Range Filter */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-end gap-4\">\n              <div className=\"flex-1\">\n                <Label htmlFor=\"startDate\" className=\"font-fredoka font-semibold mb-2 flex items-center gap-2\">\n                  <Calendar className=\"w-4 h-4\" />\n                  Start Date\n                </Label>\n                <Input\n                  id=\"startDate\"\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => setStartDate(e.target.value)}\n                  className=\"rounded-lg\"\n                />\n              </div>\n              <div className=\"flex-1\">\n                <Label htmlFor=\"endDate\" className=\"font-fredoka font-semibold mb-2\">\n                  End Date\n                </Label>\n                <Input\n                  id=\"endDate\"\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => setEndDate(e.target.value)}\n                  className=\"rounded-lg\"\n                />\n              </div>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setStartDate('');\n                  setEndDate('');\n                }}\n                className=\"font-fredoka\"\n              >\n                Clear Dates\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Bulk Actions Bar */}\n        {selectedFlags.length > 0 && (\n          <Card className=\"border-2 border-blue-500 bg-blue-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <p className=\"font-fredoka font-bold text-graphite\">\n                  {selectedFlags.length} flag{selectedFlags.length !== 1 ? 's' : ''} selected\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={handleBulkResolve}\n                    className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                  >\n                    <CheckCircle className=\"w-4 h-4 mr-2\" />\n                    Resolve Selected\n                  </Button>\n                  <Button\n                    onClick={handleBulkDismiss}\n                    variant=\"outline\"\n                    className=\"font-fredoka\"\n                  >\n                    <XCircle className=\"w-4 h-4 mr-2\" />\n                    Dismiss Selected\n                  </Button>\n                  <Button\n                    onClick={() => setSelectedFlags([])}\n                    variant=\"ghost\"\n                    className=\"font-fredoka\"\n                  >\n                    Clear Selection\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Summary Stats */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Total Open</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                {flags.filter(f => f.status === 'open').length}\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Critical</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-red-600\">\n                {flags.filter(f => f.severity === 'critical' && f.status === 'open').length}\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">High Priority</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-amber-600\">\n                {flags.filter(f => f.severity === 'high' && f.status === 'open').length}\n              </p>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Auto-Detected</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-puretask-blue\">\n                {flags.filter(f => f.detected_by === 'automation').length}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Flags List */}\n        {loading ? (\n          <div className=\"flex justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n          </div>\n        ) : flags.length > 0 ? (\n          <div className=\"space-y-4\">\n            {/* Select All */}\n            {flags.length > 0 && (\n              <div className=\"flex items-center gap-2 px-2\">\n                <Checkbox\n                  checked={selectedFlags.length === flags.length}\n                  onCheckedChange={toggleSelectAll}\n                />\n                <Label className=\"font-fredoka text-sm text-gray-600 cursor-pointer\" onClick={toggleSelectAll}>\n                  Select All ({flags.length})\n                </Label>\n              </div>\n            )}\n\n            {flags.map((flag, idx) => (\n              <motion.div\n                key={flag.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card className={`border-2 ${\n                  flag.severity === 'critical' ? 'border-red-500' :\n                  flag.severity === 'high' ? 'border-amber-500' :\n                  'border-gray-300'\n                }`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <Checkbox\n                        checked={selectedFlags.includes(flag.id)}\n                        onCheckedChange={() => toggleFlagSelection(flag.id)}\n                        className=\"mt-1\"\n                      />\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-3 flex-wrap\">\n                          <Flag className=\"w-5 h-5 text-red-600\" />\n                          <h3 className=\"font-fredoka font-bold text-lg text-graphite\">\n                            {flag.triggered_rule.replace(/_/g, ' ')}\n                          </h3>\n                          <Badge className={`font-fredoka ${getSeverityColor(flag.severity)}`}>\n                            {flag.severity}\n                          </Badge>\n                          <Badge className={`font-fredoka ${getCategoryColor(flag.category)}`}>\n                            {flag.category.replace(/_/g, ' ')}\n                          </Badge>\n                          {riskProfiles[flag.subject_id] && (\n                            <Badge className=\"bg-purple-100 text-purple-800 font-fredoka flex items-center gap-1\">\n                              <Shield className=\"w-3 h-3\" />\n                              Risk Score: {riskProfiles[flag.subject_id].risk_score}\n                            </Badge>\n                          )}\n                        </div>\n                        \n                        <div className=\"grid md:grid-cols-3 gap-4 mb-3 bg-gray-50 p-4 rounded-lg\">\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Subject</p>\n                            <p className=\"font-verdana text-sm font-semibold\">\n                              {flag.subject_type}: {flag.subject_id}\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Confidence</p>\n                            <p className=\"font-fredoka text-lg font-bold text-graphite\">\n                              {flag.confidence}%\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Detected By</p>\n                            <p className=\"font-verdana text-sm capitalize\">{flag.detected_by}</p>\n                          </div>\n                        </div>\n                        \n                        {flag.metadata && (\n                          <div className=\"bg-blue-50 rounded-lg p-3 text-xs font-verdana mb-3\">\n                            <p className=\"font-semibold mb-2\">Metadata:</p>\n                            <pre className=\"text-gray-700\">{JSON.stringify(flag.metadata, null, 2)}</pre>\n                          </div>\n                        )}\n                        \n                        <p className=\"text-xs text-gray-500 font-verdana\">\n                          Created: {new Date(flag.created_date).toLocaleString()}\n                        </p>\n                      </div>\n                      \n                      {flag.status === 'open' && (\n                        <div className=\"flex flex-col gap-2\">\n                          <Button\n                            onClick={() => setSelectedFlag(flag.id)}\n                            className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                          >\n                            <CheckCircle className=\"w-4 h-4 mr-2\" />\n                            Resolve\n                          </Button>\n                          <Button\n                            onClick={() => handleDismiss(flag.id)}\n                            variant=\"outline\"\n                            className=\"font-fredoka text-gray-600\"\n                          >\n                            <XCircle className=\"w-4 h-4 mr-2\" />\n                            Dismiss\n                          </Button>\n                          <DropdownMenu>\n                            <DropdownMenuTrigger asChild>\n                              <Button variant=\"outline\" className=\"font-fredoka\">\n                                <AlertTriangle className=\"w-4 h-4 mr-2\" />\n                                Actions\n                              </Button>\n                            </DropdownMenuTrigger>\n                            <DropdownMenuContent>\n                              <DropdownMenuItem onClick={() => handleAutomatedAction(flag, 'restricted_account')}>\n                                <Lock className=\"w-4 h-4 mr-2\" />\n                                Restrict Account\n                              </DropdownMenuItem>\n                              <DropdownMenuItem onClick={() => handleAutomatedAction(flag, 'blocked_account')}>\n                                <Ban className=\"w-4 h-4 mr-2\" />\n                                Block Account\n                              </DropdownMenuItem>\n                              <DropdownMenuItem onClick={() => handleAutomatedAction(flag, 'soft_lock_payment')}>\n                                <Shield className=\"w-4 h-4 mr-2\" />\n                                Soft Lock Payment\n                              </DropdownMenuItem>\n                              <DropdownMenuItem onClick={() => handleAutomatedAction(flag, 'require_verification')}>\n                                <UserX className=\"w-4 h-4 mr-2\" />\n                                Require Verification\n                              </DropdownMenuItem>\n                            </DropdownMenuContent>\n                          </DropdownMenu>\n                        </div>\n                      )}\n                    </div>\n                    \n                    {/* Resolution Form */}\n                    {selectedFlag === flag.id && (\n                      <div className=\"mt-4 pt-4 border-t border-gray-200\">\n                        <Textarea\n                          placeholder=\"Add resolution notes...\"\n                          value={resolutionNotes}\n                          onChange={(e) => setResolutionNotes(e.target.value)}\n                          className=\"mb-3 font-verdana\"\n                        />\n                        <div className=\"flex gap-2\">\n                          <Button\n                            onClick={() => handleResolve(flag.id)}\n                            className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                          >\n                            Confirm Resolution\n                          </Button>\n                          <Button\n                            onClick={() => {\n                              setSelectedFlag(null);\n                              setResolutionNotes('');\n                            }}\n                            variant=\"outline\"\n                            className=\"font-fredoka\"\n                          >\n                            Cancel\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <CheckCircle className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">No {filter} flags</p>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Automated Action Confirmation Dialog */}\n        <AlertDialog open={actionDialogOpen} onOpenChange={setActionDialogOpen}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle className=\"font-fredoka\">Confirm Automated Action</AlertDialogTitle>\n              <AlertDialogDescription className=\"font-verdana\">\n                Are you sure you want to apply \"{actionType?.replace(/_/g, ' ')}\" to user <strong>{actionTarget?.subject_id}</strong>?\n                <br /><br />\n                This action will:\n                <ul className=\"list-disc list-inside mt-2 space-y-1\">\n                  <li>Create a RiskActionLog entry</li>\n                  <li>Send a notification to the user</li>\n                  <li>Log an audit trail</li>\n                  <li>May restrict user access based on action type</li>\n                </ul>\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel onClick={() => {\n                setActionDialogOpen(false);\n                setActionTarget(null);\n                setActionType(null);\n              }}>\n                Cancel\n              </AlertDialogCancel>\n              <AlertDialogAction\n                onClick={executeAutomatedAction}\n                className=\"bg-red-600 hover:bg-red-700\"\n              >\n                Confirm Action\n              </AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminRiskManagement.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":8,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":52,"fix":{"range":[415,423],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[414,422],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":8,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":67,"fix":{"range":[432,438],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[431,437],"text":""},"desc":"Remove unused variable 'User'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Activity' is defined but never used.","line":8,"column":131,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":139,"fix":{"range":[500,510],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Activity"},"fix":{"range":[499,509],"text":""},"desc":"Remove unused variable 'Activity'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'FileText' is defined but never used.","line":8,"column":167,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":175,"fix":{"range":[535,545],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[535,545],"text":""},"desc":"Remove unused variable 'FileText'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart' is defined but never used.","line":15,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":35,"fix":{"range":[971,981],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart"},"fix":{"range":[970,980],"text":""},"desc":"Remove unused variable 'BarChart'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bar' is defined but never used.","line":15,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":40,"fix":{"range":[981,986],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bar"},"fix":{"range":[980,985],"text":""},"desc":"Remove unused variable 'Bar'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleResolveFlag' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":91,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleResolveFlag"},"fix":{"range":[3823,4147],"text":""},"desc":"Remove unused variable 'handleResolveFlag'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Shield, AlertTriangle, CheckCircle, Search, Loader2, User, XCircle, Eye, Lock, Ban, UserX, Clock, TrendingUp, BarChart3, Activity, Bell, ExternalLink, Flag, FileText } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { LineChart, Line, BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { createPageUrl } from '@/utils';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function AdminRiskManagement() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [riskProfiles, setRiskProfiles] = useState([]);\n  const [flags, setFlags] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterTier, setFilterTier] = useState('all');\n  const [selectedProfile, setSelectedProfile] = useState(null);\n  const [detailsModalOpen, setDetailsModalOpen] = useState(false);\n  const [tierModalOpen, setTierModalOpen] = useState(false);\n  const [selectedTier, setSelectedTier] = useState('');\n  const [tierNotes, setTierNotes] = useState('');\n  const [profileFlags, setProfileFlags] = useState([]);\n  const [profileActions, setProfileActions] = useState([]);\n  const [profileIncidents, setProfileIncidents] = useState([]);\n  const [systemAlerts, setSystemAlerts] = useState([]);\n  const [currentUser, setCurrentUser] = useState(null);\n\n  useEffect(() => {\n    loadCurrentUser();\n    loadRiskData();\n  }, []);\n\n  const loadCurrentUser = async () => {\n    try {\n      const user = await base44.auth.me();\n      setCurrentUser(user);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading user:', showToast: false });\n    }\n  };\n\n  const loadRiskData = async () => {\n    try {\n      const [profiles, riskFlags, alerts] = await Promise.all([\n        base44.entities.RiskProfile.list('-risk_score', 100),\n        base44.entities.RiskFlag.filter({ status: 'open' }),\n        base44.entities.SystemAlert.filter({ is_resolved: false }).catch(() => [])\n      ]);\n      \n      setRiskProfiles(profiles);\n      setFlags(riskFlags);\n      setSystemAlerts(alerts);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading risk data:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const loadProfileDetails = async (profile) => {\n    try {\n      const [userFlags, actionLogs, incidents] = await Promise.all([\n        base44.entities.RiskFlag.filter({ subject_id: profile.user_email }),\n        base44.entities.RiskActionLog.filter({ user_email: profile.user_email }),\n        base44.entities.SafetyIncident.filter({ \n          $or: [\n            { client_email: profile.user_email },\n            { cleaner_email: profile.user_email }\n          ]\n        }).catch(() => [])\n      ]);\n      \n      setProfileFlags(userFlags);\n      setProfileActions(actionLogs);\n      setProfileIncidents(incidents);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading profile details:', showToast: false });\n      toast.error('Failed to load profile details');\n    }\n  };\n\n  const handleResolveFlag = async (flagId) => {\n    try {\n      await base44.entities.RiskFlag.update(flagId, { \n        status: 'resolved',\n        notes: 'Resolved by admin'\n      });\n      loadRiskData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving flag:', showToast: false });\n    }\n  };\n\n  const handleOpenDetails = async (profile) => {\n    setSelectedProfile(profile);\n    await loadProfileDetails(profile);\n    setDetailsModalOpen(true);\n  };\n\n  const handleOpenTierChange = (profile, tier) => {\n    setSelectedProfile(profile);\n    setSelectedTier(tier);\n    setTierNotes('');\n    setTierModalOpen(true);\n  };\n\n  const handleUpdateTier = async () => {\n    if (!selectedProfile || !selectedTier) return;\n    \n    try {\n      await base44.entities.RiskProfile.update(selectedProfile.id, { \n        risk_tier: selectedTier,\n        last_reviewed_at: new Date().toISOString(),\n        notes: tierNotes || undefined\n      });\n\n      // Log audit trail\n      if (currentUser) {\n        await base44.entities.AdminAuditLog.create({\n          admin_email: currentUser.email,\n          action_type: 'UPDATE_RISK_TIER',\n          target_type: 'risk_profile',\n          target_id: selectedProfile.id,\n          metadata: {\n            user_email: selectedProfile.user_email,\n            old_tier: selectedProfile.risk_tier,\n            new_tier: selectedTier,\n            notes: tierNotes\n          }\n        });\n      }\n      \n      toast.success(`Risk tier updated to ${selectedTier}`);\n      setTierModalOpen(false);\n      loadRiskData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error updating tier:', showToast: false });\n      toast.error('Failed to update tier');\n    }\n  };\n\n  const handleApplyAction = async (action) => {\n    if (!selectedProfile) return;\n\n    try {\n      const actionData = {\n        user_type: selectedProfile.user_type,\n        user_email: selectedProfile.user_email,\n        action_type: action,\n        action_direction: 'apply',\n        reason_code: 'admin_review',\n        severity: 'medium',\n        performed_by: 'admin',\n        performed_by_email: currentUser?.email,\n        target_type: 'account',\n        target_id: selectedProfile.user_email,\n        metadata: {\n          applied_from: 'risk_management_page',\n          risk_score: selectedProfile.risk_score,\n          risk_tier: selectedProfile.risk_tier\n        }\n      };\n\n      await base44.entities.RiskActionLog.create(actionData);\n\n      // Send notification\n      await base44.entities.Notification.create({\n        recipient_email: selectedProfile.user_email,\n        type: 'system_alert',\n        title: 'Account Action Applied',\n        message: `An action has been applied to your account for security reasons. Please contact support if you have questions.`,\n        priority: 'high'\n      });\n\n      // Log audit\n      if (currentUser) {\n        await base44.entities.AdminAuditLog.create({\n          admin_email: currentUser.email,\n          action_type: 'APPLY_RISK_ACTION',\n          target_type: 'risk_profile',\n          target_id: selectedProfile.id,\n          metadata: {\n            action_type: action,\n            user_email: selectedProfile.user_email\n          }\n        });\n      }\n\n      toast.success(`Action \"${action}\" applied successfully`);\n      await loadProfileDetails(selectedProfile);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error applying action:', showToast: false });\n      toast.error('Failed to apply action');\n    }\n  };\n\n  const getTierColor = (tier) => {\n    switch (tier) {\n      case 'normal': return 'bg-green-100 text-green-800';\n      case 'watch': return 'bg-yellow-100 text-yellow-800';\n      case 'restricted': return 'bg-amber-100 text-amber-800';\n      case 'blocked': return 'bg-red-100 text-red-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getSeverityColor = (severity) => {\n    switch (severity) {\n      case 'critical': return 'bg-red-600 text-white';\n      case 'high': return 'bg-amber-500 text-white';\n      case 'medium': return 'bg-yellow-500 text-white';\n      case 'low': return 'bg-blue-500 text-white';\n      default: return 'bg-gray-500 text-white';\n    }\n  };\n\n  const filteredProfiles = riskProfiles.filter(p => {\n    const matchesSearch = !searchTerm || \n      p.user_email.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesTier = filterTier === 'all' || p.risk_tier === filterTier;\n    return matchesSearch && matchesTier;\n  });\n\n  // Analytics data\n  const riskTrendData = [\n    { name: 'Week 1', critical: 2, high: 5, medium: 8 },\n    { name: 'Week 2', critical: 3, high: 7, medium: 10 },\n    { name: 'Week 3', critical: 1, high: 4, medium: 6 },\n    { name: 'Week 4', critical: flags.filter(f => f.severity === 'critical').length, \n      high: flags.filter(f => f.severity === 'high').length,\n      medium: flags.filter(f => f.severity === 'medium').length }\n  ];\n\n  const tierDistributionData = [\n    { name: 'Normal', value: riskProfiles.filter(p => p.risk_tier === 'normal').length, color: '#10B981' },\n    { name: 'Watch', value: riskProfiles.filter(p => p.risk_tier === 'watch').length, color: '#F59E0B' },\n    { name: 'Restricted', value: riskProfiles.filter(p => p.risk_tier === 'restricted').length, color: '#F97316' },\n    { name: 'Blocked', value: riskProfiles.filter(p => p.risk_tier === 'blocked').length, color: '#EF4444' }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Risk Management</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">Monitor and manage fraud, trust & safety</p>\n        </div>\n\n        {/* Summary Cards */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <Card className=\"border-2 border-green-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Normal</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                {riskProfiles.filter(p => p.risk_tier === 'normal').length}\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-yellow-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Watch List</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-yellow-600\">\n                {riskProfiles.filter(p => p.risk_tier === 'watch').length}\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-amber-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Restricted</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-amber-600\">\n                {riskProfiles.filter(p => p.risk_tier === 'restricted').length}\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-red-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Blocked</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-3xl font-fredoka font-bold text-red-600\">\n                {riskProfiles.filter(p => p.risk_tier === 'blocked').length}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Analytics Dashboard */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                <TrendingUp className=\"w-5 h-5 text-puretask-blue\" />\n                Risk Trend (Last 4 Weeks)\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <LineChart data={riskTrendData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"name\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"critical\" stroke=\"#EF4444\" strokeWidth={2} />\n                  <Line type=\"monotone\" dataKey=\"high\" stroke=\"#F59E0B\" strokeWidth={2} />\n                  <Line type=\"monotone\" dataKey=\"medium\" stroke=\"#FBBF24\" strokeWidth={2} />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                <BarChart3 className=\"w-5 h-5 text-puretask-blue\" />\n                Risk Tier Distribution\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <PieChart>\n                  <Pie\n                    data={tierDistributionData}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    labelLine={false}\n                    label={({ name, value }) => `${name}: ${value}`}\n                    outerRadius={80}\n                    fill=\"#8884d8\"\n                    dataKey=\"value\"\n                  >\n                    {tierDistributionData.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={entry.color} />\n                    ))}\n                  </Pie>\n                  <Tooltip />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Active Flags & Alerts */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                <Flag className=\"w-5 h-5 text-red-600\" />\n                Active Risk Flags\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-3 gap-4\">\n                <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n                  <p className=\"text-sm font-verdana text-gray-600 mb-1\">Safety Issues</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-red-700\">\n                    {flags.filter(f => f.category === 'safety_issue').length}\n                  </p>\n                </div>\n                <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                  <p className=\"text-sm font-verdana text-gray-600 mb-1\">Payment Risk</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-amber-700\">\n                    {flags.filter(f => f.category === 'payment_risk').length}\n                  </p>\n                </div>\n                <div className=\"p-4 bg-yellow-50 rounded-lg border border-yellow-200\">\n                  <p className=\"text-sm font-verdana text-gray-600 mb-1\">Refund Abuse</p>\n                  <p className=\"text-2xl font-fredoka font-bold text-yellow-700\">\n                    {flags.filter(f => f.category === 'refund_abuse').length}\n                  </p>\n                </div>\n              </div>\n              <Button\n                variant=\"outline\"\n                className=\"w-full mt-4 font-fredoka\"\n                onClick={() => navigate(createPageUrl('AdminRiskFlags'))}\n              >\n                <ExternalLink className=\"w-4 h-4 mr-2\" />\n                View All Flags\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                <Bell className=\"w-5 h-5 text-amber-600\" />\n                System Alerts\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {systemAlerts.length > 0 ? (\n                <div className=\"space-y-2 max-h-[200px] overflow-y-auto\">\n                  {systemAlerts.slice(0, 5).map(alert => (\n                    <div key={alert.id} className=\"p-3 bg-amber-50 rounded-lg border border-amber-200\">\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"flex-1\">\n                          <Badge className={`${getSeverityColor(alert.severity)} mb-1`}>\n                            {alert.type.replace(/_/g, ' ')}\n                          </Badge>\n                          <p className=\"text-xs font-verdana text-gray-700\">{alert.message}</p>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-center text-gray-500 font-verdana py-8\">No active alerts</p>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex gap-4 flex-wrap\">\n              <div className=\"flex-1 min-w-[200px]\">\n                <Input\n                  placeholder=\"Search by email...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"font-verdana\"\n                />\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  variant={filterTier === 'all' ? 'default' : 'outline'}\n                  onClick={() => setFilterTier('all')}\n                  className=\"font-fredoka\"\n                >\n                  All\n                </Button>\n                <Button\n                  variant={filterTier === 'watch' ? 'default' : 'outline'}\n                  onClick={() => setFilterTier('watch')}\n                  className=\"font-fredoka\"\n                >\n                  Watch\n                </Button>\n                <Button\n                  variant={filterTier === 'restricted' ? 'default' : 'outline'}\n                  onClick={() => setFilterTier('restricted')}\n                  className=\"font-fredoka\"\n                >\n                  Restricted\n                </Button>\n                <Button\n                  variant={filterTier === 'blocked' ? 'default' : 'outline'}\n                  onClick={() => setFilterTier('blocked')}\n                  className=\"font-fredoka\"\n                >\n                  Blocked\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Risk Profiles List */}\n        <div className=\"space-y-4\">\n          {filteredProfiles.map((profile, idx) => (\n            <motion.div\n              key={profile.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.05 }}\n            >\n              <Card className={`border-2 ${\n                profile.risk_tier === 'blocked' ? 'border-red-500' :\n                profile.risk_tier === 'restricted' ? 'border-amber-500' :\n                profile.risk_tier === 'watch' ? 'border-yellow-500' :\n                'border-gray-200'\n              }`}>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex items-start gap-4 flex-1\">\n                      <div className=\"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold text-lg\">\n                        {profile.user_email[0].toUpperCase()}\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <h3 className=\"font-fredoka font-bold text-lg text-graphite\">\n                            {profile.user_email}\n                          </h3>\n                          <Badge className={`font-fredoka text-xs capitalize ${getTierColor(profile.risk_tier)}`}>\n                            {profile.risk_tier}\n                          </Badge>\n                          <Badge className=\"bg-blue-100 text-blue-800 font-fredoka text-xs capitalize\">\n                            {profile.user_type}\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-3\">\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Risk Score</p>\n                            <p className=\"text-lg font-fredoka font-bold text-graphite\">\n                              {profile.risk_score || 0}/100\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Open Flags</p>\n                            <p className=\"text-lg font-fredoka font-bold text-amber-600\">\n                              {profile.open_flags || 0}\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Total Bookings</p>\n                            <p className=\"text-lg font-fredoka font-bold text-graphite\">\n                              {profile.lifetime_booking_count || 0}\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Recent (30d)</p>\n                            <p className=\"text-lg font-fredoka font-bold text-graphite\">\n                              {profile.recent_booking_count || 0}\n                            </p>\n                          </div>\n                        </div>\n                        {profile.tags && profile.tags.length > 0 && (\n                          <div className=\"flex gap-2 mt-3 flex-wrap\">\n                            {profile.tags.map(tag => (\n                              <Badge key={tag} variant=\"outline\" className=\"font-verdana text-xs\">\n                                {tag}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex flex-col gap-2\">\n                      <Button\n                        onClick={() => handleOpenDetails(profile)}\n                        variant=\"default\"\n                        className=\"font-fredoka text-xs\"\n                      >\n                        <Eye className=\"w-3 h-3 mr-1\" />\n                        Details\n                      </Button>\n                      <Button\n                        onClick={() => handleOpenTierChange(profile, 'normal')}\n                        disabled={profile.risk_tier === 'normal'}\n                        variant=\"outline\"\n                        className=\"font-fredoka text-xs\"\n                      >\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Clear\n                      </Button>\n                      <Button\n                        onClick={() => handleOpenTierChange(profile, 'watch')}\n                        disabled={profile.risk_tier === 'watch'}\n                        variant=\"outline\"\n                        className=\"font-fredoka text-xs\"\n                      >\n                        <Clock className=\"w-3 h-3 mr-1\" />\n                        Watch\n                      </Button>\n                      <Button\n                        onClick={() => handleOpenTierChange(profile, 'restricted')}\n                        disabled={profile.risk_tier === 'restricted'}\n                        variant=\"outline\"\n                        className=\"font-fredoka text-xs text-amber-600\"\n                      >\n                        <AlertTriangle className=\"w-3 h-3 mr-1\" />\n                        Restrict\n                      </Button>\n                      <Button\n                        onClick={() => handleOpenTierChange(profile, 'blocked')}\n                        disabled={profile.risk_tier === 'blocked'}\n                        variant=\"outline\"\n                        className=\"font-fredoka text-xs text-red-600 border-red-600\"\n                      >\n                        <XCircle className=\"w-3 h-3 mr-1\" />\n                        Block\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n          {filteredProfiles.length === 0 && (\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <Shield className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n                <p className=\"text-xl font-fredoka font-bold text-graphite\">No risk profiles found</p>\n                <p className=\"text-gray-600 font-verdana mt-2\">Try adjusting your filters</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        {/* Tier Change Modal */}\n        <Dialog open={tierModalOpen} onOpenChange={setTierModalOpen}>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka\">Update Risk Tier</DialogTitle>\n              <DialogDescription className=\"font-verdana\">\n                Change risk tier for <strong>{selectedProfile?.user_email}</strong> to{' '}\n                <Badge className={getTierColor(selectedTier)}>{selectedTier}</Badge>\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div>\n                <Label className=\"font-fredoka font-semibold\">Notes (Optional)</Label>\n                <Textarea\n                  value={tierNotes}\n                  onChange={(e) => setTierNotes(e.target.value)}\n                  placeholder=\"Add reason for tier change...\"\n                  className=\"font-verdana mt-2\"\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setTierModalOpen(false)} className=\"font-fredoka\">\n                Cancel\n              </Button>\n              <Button onClick={handleUpdateTier} className=\"font-fredoka brand-gradient text-white\">\n                Update Tier\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Detailed Profile Modal */}\n        <Dialog open={detailsModalOpen} onOpenChange={setDetailsModalOpen}>\n          <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                <div className=\"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold\">\n                  {selectedProfile?.user_email[0].toUpperCase()}\n                </div>\n                {selectedProfile?.user_email}\n              </DialogTitle>\n              <DialogDescription className=\"font-verdana flex items-center gap-2\">\n                <Badge className={getTierColor(selectedProfile?.risk_tier)}>{selectedProfile?.risk_tier}</Badge>\n                <Badge className=\"bg-blue-100 text-blue-800\">{selectedProfile?.user_type}</Badge>\n                <span className=\"text-gray-600\">Risk Score: {selectedProfile?.risk_score}/100</span>\n              </DialogDescription>\n            </DialogHeader>\n\n            <Tabs defaultValue=\"overview\" className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"overview\" className=\"font-fredoka\">Overview</TabsTrigger>\n                <TabsTrigger value=\"flags\" className=\"font-fredoka\">Risk Flags ({profileFlags.length})</TabsTrigger>\n                <TabsTrigger value=\"actions\" className=\"font-fredoka\">Actions ({profileActions.length})</TabsTrigger>\n                <TabsTrigger value=\"incidents\" className=\"font-fredoka\">Incidents ({profileIncidents.length})</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"overview\" className=\"space-y-4\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"font-fredoka\">Quick Actions</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      <Button variant=\"outline\" onClick={() => handleApplyAction('restricted_account')} className=\"font-fredoka\">\n                        <Lock className=\"w-4 h-4 mr-2\" />\n                        Restrict Account\n                      </Button>\n                      <Button variant=\"outline\" onClick={() => handleApplyAction('blocked_account')} className=\"font-fredoka\">\n                        <Ban className=\"w-4 h-4 mr-2\" />\n                        Block Account\n                      </Button>\n                      <Button variant=\"outline\" onClick={() => handleApplyAction('soft_lock_payment')} className=\"font-fredoka\">\n                        <Shield className=\"w-4 h-4 mr-2\" />\n                        Soft Lock Payment\n                      </Button>\n                      <Button variant=\"outline\" onClick={() => handleApplyAction('require_verification')} className=\"font-fredoka\">\n                        <UserX className=\"w-4 h-4 mr-2\" />\n                        Require Verification\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader>\n                    <CardTitle className=\"font-fredoka\">Profile Summary</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-3 gap-4\">\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana\">Open Flags</p>\n                        <p className=\"text-2xl font-fredoka font-bold text-amber-600\">{selectedProfile?.open_flags || 0}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana\">Total Bookings</p>\n                        <p className=\"text-2xl font-fredoka font-bold\">{selectedProfile?.lifetime_booking_count || 0}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana\">Recent (30d)</p>\n                        <p className=\"text-2xl font-fredoka font-bold\">{selectedProfile?.recent_booking_count || 0}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"flags\" className=\"space-y-3\">\n                {profileFlags.length > 0 ? (\n                  profileFlags.map(flag => (\n                    <Card key={flag.id} className=\"border-l-4 border-l-red-500\">\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <Badge className={getSeverityColor(flag.severity)}>{flag.severity}</Badge>\n                              <Badge variant=\"outline\">{flag.category?.replace(/_/g, ' ')}</Badge>\n                              <Badge variant=\"outline\">{flag.status}</Badge>\n                            </div>\n                            <p className=\"font-fredoka font-semibold\">{flag.triggered_rule?.replace(/_/g, ' ')}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                              Created: {new Date(flag.created_date).toLocaleString()}\n                            </p>\n                          </div>\n                          <Badge className=\"font-fredoka\">Confidence: {flag.confidence}%</Badge>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 font-verdana py-8\">No risk flags</p>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"actions\" className=\"space-y-3\">\n                {profileActions.length > 0 ? (\n                  profileActions.map(action => (\n                    <Card key={action.id}>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between\">\n                          <div>\n                            <Badge className=\"mb-2\">{action.action_type?.replace(/_/g, ' ')}</Badge>\n                            <p className=\"text-sm font-verdana text-gray-600\">\n                              {action.action_direction === 'apply' ? 'Applied' : 'Removed'} by {action.performed_by}\n                            </p>\n                            <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                              {new Date(action.created_date).toLocaleString()}\n                            </p>\n                          </div>\n                          <Badge className={getSeverityColor(action.severity)}>{action.severity}</Badge>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 font-verdana py-8\">No actions taken</p>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"incidents\" className=\"space-y-3\">\n                {profileIncidents.length > 0 ? (\n                  profileIncidents.map(incident => (\n                    <Card key={incident.id} className=\"border-l-4 border-l-red-600\">\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <Badge className={getSeverityColor(incident.severity)}>{incident.severity}</Badge>\n                              <Badge variant=\"outline\">{incident.category?.replace(/_/g, ' ')}</Badge>\n                              <Badge variant=\"outline\">{incident.status}</Badge>\n                            </div>\n                            <p className=\"text-sm font-verdana\">{incident.description}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                              Reported by {incident.reported_by} ‚Ä¢ {new Date(incident.created_date).toLocaleString()}\n                            </p>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 font-verdana py-8\">No safety incidents</p>\n                )}\n              </TabsContent>\n            </Tabs>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setDetailsModalOpen(false)} className=\"font-fredoka\">\n                Close\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminSafetyIncidents.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[385,392],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[386,392],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":8,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[391,409],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[391,409],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":9,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":53,"fix":{"range":[486,495],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[485,494],"text":""},"desc":"Remove unused variable 'XCircle'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":5,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { AlertTriangle, Shield, CheckCircle, XCircle, Loader2, FileText } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminSafetyIncidents() {\n  const [loading, setLoading] = useState(true);\n  const [incidents, setIncidents] = useState([]);\n  const [filter, setFilter] = useState('open');\n  const [selectedIncident, setSelectedIncident] = useState(null);\n  const [actionNote, setActionNote] = useState('');\n\n  useEffect(() => {\n    loadIncidents();\n  }, [filter]);\n\n  const loadIncidents = async () => {\n    setLoading(true);\n    try {\n      let incidentList;\n      if (filter === 'all') {\n        incidentList = await base44.entities.SafetyIncident.list('-created_date', 100);\n      } else {\n        incidentList = await base44.entities.SafetyIncident.filter({ status: filter });\n      }\n      \n      setIncidents(incidentList);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading incidents:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const handleResolve = async (incidentId) => {\n    try {\n      const incident = incidents.find(i => i.id === incidentId);\n      const actions = [...(incident.actions_taken || []), actionNote || 'Resolved by admin'];\n      \n      await base44.entities.SafetyIncident.update(incidentId, {\n        status: 'resolved',\n        actions_taken: actions\n      });\n      \n      setActionNote('');\n      setSelectedIncident(null);\n      loadIncidents();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving incident:', showToast: false });\n    }\n  };\n\n  const handleEscalate = async (incidentId) => {\n    try {\n      const incident = incidents.find(i => i.id === incidentId);\n      \n      await base44.entities.SafetyIncident.update(incidentId, {\n        status: 'escalated',\n        escalation_level: Math.min(3, (incident.escalation_level || 1) + 1),\n        requires_escalation: true\n      });\n      \n      // Send email notification\n      await base44.integrations.Core.SendEmail({\n        to: 'safety@puretask.com',\n        subject: `üö® Safety Incident Escalated - Level ${incident.escalation_level + 1}`,\n        body: `Incident ${incidentId} has been escalated.\\n\\nCategory: ${incident.category}\\nSeverity: ${incident.severity}\\nReported by: ${incident.reported_by}\\n\\nPlease review immediately.`\n      });\n      \n      loadIncidents();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error escalating incident:', showToast: false });\n    }\n  };\n\n  const getSeverityColor = (severity) => {\n    switch (severity) {\n      case 'critical': return 'bg-red-600 text-white';\n      case 'high': return 'bg-amber-600 text-white';\n      case 'medium': return 'bg-yellow-600 text-white';\n      default: return 'bg-blue-600 text-white';\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Safety Incidents</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Monitor and resolve safety concerns</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant={filter === 'open' ? 'default' : 'outline'}\n              onClick={() => setFilter('open')}\n              className=\"font-fredoka\"\n            >\n              Open ({incidents.filter(i => i.status === 'open').length})\n            </Button>\n            <Button\n              variant={filter === 'investigating' ? 'default' : 'outline'}\n              onClick={() => setFilter('investigating')}\n              className=\"font-fredoka\"\n            >\n              Investigating\n            </Button>\n            <Button\n              variant={filter === 'resolved' ? 'default' : 'outline'}\n              onClick={() => setFilter('resolved')}\n              className=\"font-fredoka\"\n            >\n              Resolved\n            </Button>\n            <Button\n              variant={filter === 'all' ? 'default' : 'outline'}\n              onClick={() => setFilter('all')}\n              className=\"font-fredoka\"\n            >\n              All\n            </Button>\n          </div>\n        </div>\n\n        {/* Incidents List */}\n        {loading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n          </div>\n        ) : incidents.length > 0 ? (\n          <div className=\"space-y-4\">\n            {incidents.map((incident, idx) => (\n              <motion.div\n                key={incident.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card className=\"border-2 border-red-200\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-3\">\n                          <AlertTriangle className=\"w-6 h-6 text-red-600\" />\n                          <h3 className=\"font-fredoka font-bold text-xl text-graphite\">\n                            {incident.category.replace(/_/g, ' ').toUpperCase()}\n                          </h3>\n                          <Badge className={`font-fredoka ${getSeverityColor(incident.severity)}`}>\n                            {incident.severity}\n                          </Badge>\n                          {incident.injuries_reported && (\n                            <Badge className=\"bg-red-100 text-red-800 font-fredoka\">\n                              Injuries Reported\n                            </Badge>\n                          )}\n                        </div>\n                        \n                        <div className=\"grid md:grid-cols-3 gap-4 mb-4 bg-gray-50 p-4 rounded-lg\">\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Booking ID</p>\n                            <p className=\"font-verdana text-sm font-semibold\">{incident.booking_id}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Client</p>\n                            <p className=\"font-verdana text-sm\">{incident.client_email}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Cleaner</p>\n                            <p className=\"font-verdana text-sm\">{incident.cleaner_email}</p>\n                          </div>\n                        </div>\n                        \n                        <p className=\"font-verdana text-gray-700 mb-3\">{incident.description}</p>\n                        \n                        {incident.evidence_urls && incident.evidence_urls.length > 0 && (\n                          <div className=\"mb-3\">\n                            <p className=\"text-xs text-gray-500 font-verdana mb-2\">Evidence:</p>\n                            <div className=\"flex gap-2\">\n                              {incident.evidence_urls.map((url, i) => (\n                                <a key={i} href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n                                  <Badge variant=\"outline\" className=\"font-verdana\">\n                                    <FileText className=\"w-3 h-3 mr-1\" />\n                                    Evidence {i + 1}\n                                  </Badge>\n                                </a>\n                              ))}\n                            </div>\n                          </div>\n                        )}\n                        \n                        <p className=\"text-xs text-gray-500 font-verdana\">\n                          Reported by: {incident.reported_by} ‚Ä¢ {new Date(incident.created_date).toLocaleString()}\n                        </p>\n                      </div>\n                      \n                      {incident.status === 'open' && (\n                        <div className=\"flex flex-col gap-2\">\n                          <Button\n                            onClick={() => setSelectedIncident(incident.id)}\n                            className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                          >\n                            <CheckCircle className=\"w-4 h-4 mr-2\" />\n                            Resolve\n                          </Button>\n                          <Button\n                            onClick={() => handleEscalate(incident.id)}\n                            variant=\"outline\"\n                            className=\"font-fredoka\"\n                          >\n                            <AlertTriangle className=\"w-4 h-4 mr-2\" />\n                            Escalate\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                    \n                    {/* Resolution Form */}\n                    {selectedIncident === incident.id && (\n                      <div className=\"mt-4 pt-4 border-t border-gray-200\">\n                        <Textarea\n                          placeholder=\"Add resolution notes...\"\n                          value={actionNote}\n                          onChange={(e) => setActionNote(e.target.value)}\n                          className=\"mb-3 font-verdana\"\n                        />\n                        <div className=\"flex gap-2\">\n                          <Button\n                            onClick={() => handleResolve(incident.id)}\n                            className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                          >\n                            Confirm Resolution\n                          </Button>\n                          <Button\n                            onClick={() => {\n                              setSelectedIncident(null);\n                              setActionNote('');\n                            }}\n                            variant=\"outline\"\n                            className=\"font-fredoka\"\n                          >\n                            Cancel\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <Shield className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">No {filter} incidents</p>\n              <p className=\"text-gray-600 font-verdana mt-2\">Platform is safe!</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminSetup.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminSimpleDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":5,"column":81,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":86,"fix":{"range":[306,313],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[306,313],"text":""},"desc":"Remove unused variable 'Users'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { TrendingUp, Calendar, XCircle, AlertTriangle, DollarSign, CheckCircle, Users } from 'lucide-react';\n\nexport default function AdminSimpleDashboard() {\n  const [stats, setStats] = useState({\n    today: {},\n    last7Days: {}\n  });\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadStats();\n  }, []);\n\n  const loadStats = async () => {\n    try {\n      const now = new Date();\n      const today = now.toISOString().split('T')[0];\n      const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n\n      // Get all bookings for last 7 days\n      const allBookings = await base44.entities.Booking.list('-created_date', 500);\n      const todayBookings = allBookings.filter(b => b.created_date?.startsWith(today));\n      const last7DaysBookings = allBookings.filter(b => \n        b.created_date >= sevenDaysAgo\n      );\n\n      // Get disputes\n      const allDisputes = await base44.entities.Dispute.list('-created_date', 100);\n      const todayDisputes = allDisputes.filter(d => d.created_date?.startsWith(today));\n      const last7DaysDisputes = allDisputes.filter(d => \n        d.created_date >= sevenDaysAgo\n      );\n\n      // Calculate stats\n      const todayStats = {\n        created: todayBookings.length,\n        completed: todayBookings.filter(b => b.status === 'completed').length,\n        cancelled: todayBookings.filter(b => b.status === 'cancelled').length,\n        disputes: todayDisputes.filter(d => d.status === 'open').length,\n        gmv: todayBookings.reduce((sum, b) => sum + (b.total_price || 0), 0)\n      };\n\n      const last7Stats = {\n        created: last7DaysBookings.length,\n        completed: last7DaysBookings.filter(b => b.status === 'completed').length,\n        cancelled: last7DaysBookings.filter(b => b.status === 'cancelled').length,\n        disputes: last7DaysDisputes.filter(d => d.status === 'open').length,\n        gmv: last7DaysBookings.reduce((sum, b) => sum + (b.total_price || 0), 0)\n      };\n\n      // Calculate percentages\n      todayStats.completionRate = todayStats.created > 0 \n        ? ((todayStats.completed / todayStats.created) * 100).toFixed(1)\n        : 0;\n      todayStats.cancellationRate = todayStats.created > 0\n        ? ((todayStats.cancelled / todayStats.created) * 100).toFixed(1)\n        : 0;\n\n      last7Stats.completionRate = last7Stats.created > 0\n        ? ((last7Stats.completed / last7Stats.created) * 100).toFixed(1)\n        : 0;\n      last7Stats.cancellationRate = last7Stats.created > 0\n        ? ((last7Stats.cancelled / last7Stats.created) * 100).toFixed(1)\n        : 0;\n\n      setStats({\n        today: todayStats,\n        last7Days: last7Stats\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading stats:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-puretask-blue mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 font-verdana\">Loading dashboard...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const StatCard = ({ title, value, subtitle, icon: Icon, color = 'text-puretask-blue' }) => (\n    <Card>\n      <CardContent className=\"pt-6\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <p className=\"text-sm text-gray-600 font-verdana mb-1\">{title}</p>\n            <p className=\"text-3xl font-fredoka font-bold text-graphite\">{value}</p>\n            {subtitle && <p className=\"text-xs text-gray-500 font-verdana mt-1\">{subtitle}</p>}\n          </div>\n          <Icon className={`w-8 h-8 ${color}`} />\n        </div>\n      </CardContent>\n    </Card>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">Admin Dashboard</h1>\n          <p className=\"text-gray-600 font-verdana\">Platform KPIs at a glance</p>\n        </div>\n\n        {/* Today's Stats */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-fredoka font-bold text-graphite mb-4\">Today</h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            <StatCard\n              title=\"Bookings Created\"\n              value={stats.today.created}\n              icon={Calendar}\n              color=\"text-blue-600\"\n            />\n            <StatCard\n              title=\"Completed\"\n              value={stats.today.completed}\n              subtitle={`${stats.today.completionRate}% completion rate`}\n              icon={CheckCircle}\n              color=\"text-green-600\"\n            />\n            <StatCard\n              title=\"Cancelled\"\n              value={stats.today.cancelled}\n              subtitle={`${stats.today.cancellationRate}% cancellation rate`}\n              icon={XCircle}\n              color=\"text-red-600\"\n            />\n            <StatCard\n              title=\"Open Disputes\"\n              value={stats.today.disputes}\n              icon={AlertTriangle}\n              color=\"text-orange-600\"\n            />\n          </div>\n          <div className=\"mt-4\">\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Today's GMV</p>\n                    <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                      {Math.round(stats.today.gmv).toLocaleString()} credits\n                    </p>\n                  </div>\n                  <DollarSign className=\"w-8 h-8 text-green-600\" />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        {/* Last 7 Days Stats */}\n        <div>\n          <h2 className=\"text-xl font-fredoka font-bold text-graphite mb-4\">Last 7 Days</h2>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n            <StatCard\n              title=\"Bookings Created\"\n              value={stats.last7Days.created}\n              icon={Calendar}\n              color=\"text-blue-600\"\n            />\n            <StatCard\n              title=\"Completed\"\n              value={stats.last7Days.completed}\n              subtitle={`${stats.last7Days.completionRate}% completion rate`}\n              icon={CheckCircle}\n              color=\"text-green-600\"\n            />\n            <StatCard\n              title=\"Cancelled\"\n              value={stats.last7Days.cancelled}\n              subtitle={`${stats.last7Days.cancellationRate}% cancellation rate`}\n              icon={XCircle}\n              color=\"text-red-600\"\n            />\n            <StatCard\n              title=\"Open Disputes\"\n              value={stats.last7Days.disputes}\n              icon={AlertTriangle}\n              color=\"text-orange-600\"\n            />\n          </div>\n          <div className=\"mt-4\">\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">7-Day GMV</p>\n                    <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                      {Math.round(stats.last7Days.gmv).toLocaleString()} credits\n                    </p>\n                  </div>\n                  <TrendingUp className=\"w-8 h-8 text-puretask-blue\" />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminSupportTickets.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":39,"fix":{"range":[263,275],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[262,274],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":6,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"fix":{"range":[274,285],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[274,285],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":11,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":49,"fix":{"range":[580,587],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[579,586],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":11,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":62,"fix":{"range":[586,599],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[586,599],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Textarea } from '@/components/ui/textarea';\nimport { AdminPermissions } from '@/components/admin/AdminPermissions';\nimport { HelpCircle, Loader2, CheckCircle, Clock, AlertCircle } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AdminSupportTickets() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [tickets, setTickets] = useState([]);\n  const [filter, setFilter] = useState('open');\n  const [selectedTicket, setSelectedTicket] = useState(null);\n  const [resolutionNote, setResolutionNote] = useState('');\n\n  useEffect(() => {\n    checkAdminAndLoad();\n  }, []);\n\n  useEffect(() => {\n    if (user) loadTickets();\n  }, [filter]);\n\n  const checkAdminAndLoad = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      const isAdmin = await AdminPermissions.isAdmin(currentUser);\n      \n      if (!isAdmin) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      \n      setUser(currentUser);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n  };\n\n  const loadTickets = async () => {\n    setLoading(true);\n    try {\n      let ticketList;\n      if (filter === 'all') {\n        ticketList = await base44.entities.SupportTicket.list('-created_date', 100);\n      } else {\n        ticketList = await base44.entities.SupportTicket.filter({ status: filter });\n      }\n      \n      setTickets(ticketList);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading tickets:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const handleResolve = async (ticketId) => {\n    try {\n      const notes = [...(selectedTicket.internal_notes || []), resolutionNote];\n      \n      await base44.entities.SupportTicket.update(ticketId, {\n        status: 'resolved',\n        internal_notes: notes\n      });\n\n      setResolutionNote('');\n      setSelectedTicket(null);\n      loadTickets();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving ticket:', showToast: false });\n    }\n  };\n\n  const getPriorityColor = (priority) => {\n    const colors = {\n      urgent: 'bg-red-600 text-white',\n      high: 'bg-amber-600 text-white',\n      medium: 'bg-yellow-600 text-white',\n      low: 'bg-blue-600 text-white'\n    };\n    return colors[priority] || 'bg-gray-600 text-white';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Support Tickets</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Manage customer support requests</p>\n          </div>\n          <div className=\"flex gap-2\">\n            {['open', 'in_progress', 'resolved', 'all'].map(status => (\n              <Button\n                key={status}\n                variant={filter === status ? 'default' : 'outline'}\n                onClick={() => setFilter(status)}\n                className=\"font-fredoka capitalize\"\n              >\n                {status.replace('_', ' ')}\n              </Button>\n            ))}\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"flex justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n          </div>\n        ) : tickets.length > 0 ? (\n          <div className=\"space-y-3\">\n            {tickets.map((ticket, idx) => (\n              <motion.div\n                key={ticket.id}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.02 }}\n              >\n                <Card className=\"hover:shadow-lg transition-shadow\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <h3 className=\"font-fredoka font-bold text-lg text-graphite\">\n                            {ticket.subject}\n                          </h3>\n                          <Badge className={getPriorityColor(ticket.priority)}>\n                            {ticket.priority}\n                          </Badge>\n                        </div>\n                        <p className=\"text-sm text-gray-700 font-verdana mb-3\">{ticket.description}</p>\n                        <div className=\"flex gap-4 text-xs text-gray-500 font-verdana\">\n                          <span>Type: {ticket.type}</span>\n                          {ticket.client_email && <span>Client: {ticket.client_email}</span>}\n                          {ticket.assigned_to && <span>Assigned to: {ticket.assigned_to}</span>}\n                        </div>\n                      </div>\n                      {ticket.status === 'open' && (\n                        <Button\n                          onClick={() => setSelectedTicket(ticket)}\n                          className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                        >\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\n                          Resolve\n                        </Button>\n                      )}\n                    </div>\n\n                    {selectedTicket?.id === ticket.id && (\n                      <div className=\"mt-4 pt-4 border-t border-gray-200\">\n                        <Textarea\n                          placeholder=\"Add resolution notes...\"\n                          value={resolutionNote}\n                          onChange={(e) => setResolutionNote(e.target.value)}\n                          className=\"mb-3 font-verdana\"\n                        />\n                        <div className=\"flex gap-2\">\n                          <Button\n                            onClick={() => handleResolve(ticket.id)}\n                            className=\"bg-green-600 hover:bg-green-700 font-fredoka\"\n                          >\n                            Confirm Resolution\n                          </Button>\n                          <Button\n                            onClick={() => setSelectedTicket(null)}\n                            variant=\"outline\"\n                            className=\"font-fredoka\"\n                          >\n                            Cancel\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <HelpCircle className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">No {filter} tickets</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminSystemConfig.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardDescription' is defined but never used.","line":9,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":44,"fix":{"range":[476,493],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardDescription"},"fix":{"range":[475,492],"text":""},"desc":"Remove unused variable 'CardDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle2' is defined but never used.","line":13,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":45,"fix":{"range":[734,748],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle2"},"fix":{"range":[733,747],"text":""},"desc":"Remove unused variable 'CheckCircle2'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'History' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":10,"fix":{"range":[748,760],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"History"},"fix":{"range":[747,759],"text":""},"desc":"Remove unused variable 'History'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Switch } from '@/components/ui/switch';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  Search, Save, X, AlertCircle, CheckCircle2, \n  History, Clock, Settings as SettingsIcon, Loader2\n} from 'lucide-react';\nimport { toast } from 'sonner';\n\nexport default function AdminSystemConfig() {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [settingDefinitions, setSettingDefinitions] = useState([]);\n  const [globalSetting, setGlobalSetting] = useState(null);\n  const [formData, setFormData] = useState({});\n  const [isDirty, setIsDirty] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [activeCategory, setActiveCategory] = useState('Business & Financials');\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      // Check authentication\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.role !== 'admin') {\n        window.location.href = '/';\n        return;\n      }\n      setUser(currentUser);\n\n      // Load setting definitions\n      const definitions = await base44.entities.SettingDefinition.list();\n      setSettingDefinitions(definitions);\n\n      // If no definitions exist, show a helpful message\n      if (definitions.length === 0) {\n        setError('No setting definitions found. Please run the seedSettings function first.');\n        setLoading(false);\n        return;\n      }\n\n      // Load current settings for production environment\n      const allGlobalSettings = await base44.entities.GlobalSetting.list();\n      const productionSetting = allGlobalSettings.find(s => s.id === 'production');\n\n      if (productionSetting) {\n        setGlobalSetting(productionSetting);\n        setFormData({ ...productionSetting.settings_data });\n      } else {\n        console.log('No GlobalSetting found, using defaults');\n        // Initialize with defaults from definitions\n        const defaultData = {};\n        definitions.forEach(def => {\n          try {\n            defaultData[def.setting_id] = JSON.parse(def.default_value);\n          } catch {\n            defaultData[def.setting_id] = def.default_value;\n          }\n        });\n        setFormData(defaultData);\n      }\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading config data:', showToast: false });\n      setError(error.message || 'Failed to load configuration');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleInputChange = (settingId, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [settingId]: value\n    }));\n    setIsDirty(true);\n  };\n\n  const handleSave = async () => {\n    try {\n      setSaving(true);\n\n      // Create audit log entries for changed settings\n      if (globalSetting) {\n        const changedSettings = Object.keys(formData).filter(\n          key => JSON.stringify(formData[key]) !== JSON.stringify(globalSetting.settings_data[key])\n        );\n\n        for (const settingId of changedSettings) {\n          await base44.entities.SettingAuditLog.create({\n            setting_id: settingId,\n            environment: 'production',\n            old_value: JSON.stringify(globalSetting.settings_data[settingId]),\n            new_value: JSON.stringify(formData[settingId]),\n            changed_by_email: user.email,\n            changed_at: new Date().toISOString(),\n            action: 'update'\n          });\n        }\n      }\n\n      // Update or create GlobalSetting\n      if (globalSetting) {\n        await base44.entities.GlobalSetting.update('production', {\n          settings_data: formData,\n          last_updated_by: user.email,\n          last_updated_date: new Date().toISOString()\n        });\n      } else {\n        await base44.entities.GlobalSetting.create({\n          id: 'production',\n          environment: 'production',\n          settings_data: formData,\n          last_updated_by: user.email,\n          last_updated_date: new Date().toISOString()\n        });\n      }\n\n      toast.success('Configuration saved successfully');\n      setIsDirty(false);\n      await loadData(); // Reload to get updated data\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving settings:', showToast: false });\n      toast.error('Failed to save configuration: ' + error.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleDiscard = () => {\n    if (globalSetting) {\n      setFormData({ ...globalSetting.settings_data });\n    }\n    setIsDirty(false);\n    toast.info('Changes discarded');\n  };\n\n  const renderInputField = (definition) => {\n    const value = formData[definition.setting_id];\n\n    switch (definition.type) {\n      case 'boolean':\n        return (\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              checked={value || false}\n              onCheckedChange={(checked) => handleInputChange(definition.setting_id, checked)}\n            />\n            <span className=\"text-sm text-gray-600\">{value ? 'Enabled' : 'Disabled'}</span>\n          </div>\n        );\n\n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            value={value || ''}\n            onChange={(e) => handleInputChange(definition.setting_id, parseFloat(e.target.value) || 0)}\n            min={definition.validation_rules?.min}\n            max={definition.validation_rules?.max}\n            className=\"max-w-xs\"\n          />\n        );\n\n      case 'enum':\n        return (\n          <Select\n            value={value || definition.default_value}\n            onValueChange={(val) => handleInputChange(definition.setting_id, val)}\n          >\n            <SelectTrigger className=\"max-w-xs\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {definition.enum_options?.map(option => (\n                <SelectItem key={option} value={option}>{option}</SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        );\n\n      case 'string':\n        if (definition.ui_hint === 'long_text') {\n          return (\n            <Textarea\n              value={value || ''}\n              onChange={(e) => handleInputChange(definition.setting_id, e.target.value)}\n              rows={4}\n              className=\"max-w-2xl\"\n            />\n          );\n        }\n        return (\n          <Input\n            type=\"text\"\n            value={value || ''}\n            onChange={(e) => handleInputChange(definition.setting_id, e.target.value)}\n            className=\"max-w-xl\"\n          />\n        );\n\n      case 'json_array':\n        if (definition.ui_hint === 'multi_select_tag_input') {\n          return (\n            <div className=\"space-y-2\">\n              <div className=\"flex flex-wrap gap-2\">\n                {Array.isArray(value) && value.map((item, idx) => (\n                  <span key={idx} className=\"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\">\n                    {item}\n                    <button\n                      onClick={() => {\n                        const newArray = [...value];\n                        newArray.splice(idx, 1);\n                        handleInputChange(definition.setting_id, newArray);\n                      }}\n                      className=\"hover:bg-blue-200 rounded-full p-0.5\"\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </span>\n                ))}\n              </div>\n              <Input\n                type=\"text\"\n                placeholder=\"Add item and press Enter\"\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter' && e.target.value.trim()) {\n                    e.preventDefault();\n                    const newArray = Array.isArray(value) ? [...value] : [];\n                    newArray.push(e.target.value.trim());\n                    handleInputChange(definition.setting_id, newArray);\n                    e.target.value = '';\n                  }\n                }}\n                className=\"max-w-xl\"\n              />\n            </div>\n          );\n        }\n        return (\n          <Textarea\n            value={JSON.stringify(value, null, 2)}\n            onChange={(e) => {\n              try {\n                handleInputChange(definition.setting_id, JSON.parse(e.target.value));\n              } catch {}\n            }}\n            rows={6}\n            className=\"max-w-2xl font-mono text-xs\"\n          />\n        );\n\n      case 'json_object':\n        return (\n          <Textarea\n            value={JSON.stringify(value, null, 2)}\n            onChange={(e) => {\n              try {\n                handleInputChange(definition.setting_id, JSON.parse(e.target.value));\n              } catch {}\n            }}\n            rows={8}\n            className=\"max-w-2xl font-mono text-xs\"\n          />\n        );\n\n      default:\n        return <Input value={value || ''} disabled className=\"max-w-xl\" />;\n    }\n  };\n\n  const categories = [...new Set(settingDefinitions.map(d => d.category))];\n  \n  const filteredDefinitions = settingDefinitions.filter(def => {\n    const matchesSearch = !searchQuery || \n      def.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      def.description.toLowerCase().includes(searchQuery.toLowerCase());\n    return matchesSearch;\n  });\n\n  const definitionsByCategory = filteredDefinitions.reduce((acc, def) => {\n    if (!acc[def.category]) acc[def.category] = {};\n    if (!acc[def.category][def.subcategory]) acc[def.category][def.subcategory] = [];\n    acc[def.category][def.subcategory].push(def);\n    return acc;\n  }, {});\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4\" />\n          <p className=\"text-gray-600\">Loading configuration settings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-6\">\n        <Alert variant=\"destructive\" className=\"max-w-lg\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertDescription>\n            {error}\n            <Button onClick={loadData} variant=\"outline\" size=\"sm\" className=\"mt-4\">\n              Retry\n            </Button>\n          </AlertDescription>\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto p-6\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center\">\n                <SettingsIcon className=\"w-6 h-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-3xl font-bold text-gray-900\">System Configuration</h1>\n                <p className=\"text-gray-600\">Manage all platform settings from one place</p>\n              </div>\n            </div>\n          </div>\n\n          {globalSetting && (\n            <div className=\"flex items-center gap-2 text-sm text-gray-600 bg-white px-4 py-2 rounded-lg border\">\n              <Clock className=\"w-4 h-4\" />\n              <span>\n                Last updated: {new Date(globalSetting.last_updated_date).toLocaleString()} by {globalSetting.last_updated_by}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Search */}\n        <div className=\"mb-6\">\n          <div className=\"relative max-w-md\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search settings...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n        </div>\n\n        {/* Category Tabs */}\n        <Tabs value={activeCategory} onValueChange={setActiveCategory} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            {categories.map(category => (\n              <TabsTrigger key={category} value={category}>\n                {category.split(' ')[0]}\n              </TabsTrigger>\n            ))}\n          </TabsList>\n\n          {categories.map(category => (\n            <TabsContent key={category} value={category} className=\"space-y-6\">\n              {definitionsByCategory[category] && Object.entries(definitionsByCategory[category]).map(([subcategory, definitions]) => (\n                <Card key={subcategory}>\n                  <CardHeader>\n                    <CardTitle>{subcategory}</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    {definitions.map(definition => (\n                      <div key={definition.setting_id} className=\"space-y-2\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <label className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n                              {definition.name}\n                              {definition.is_sensitive && (\n                                <span className=\"px-2 py-0.5 bg-red-100 text-red-700 text-xs rounded\">\n                                  Sensitive\n                                </span>\n                              )}\n                            </label>\n                            <p className=\"text-sm text-gray-600 mt-1\">{definition.description}</p>\n                          </div>\n                        </div>\n                        <div className=\"mt-2\">\n                          {renderInputField(definition)}\n                        </div>\n                      </div>\n                    ))}\n                  </CardContent>\n                </Card>\n              ))}\n            </TabsContent>\n          ))}\n        </Tabs>\n\n        {/* Sticky Save Bar */}\n        {isDirty && (\n          <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg p-4 z-50\">\n            <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n              <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n                <AlertCircle className=\"w-5 h-5 text-amber-500\" />\n                <span>You have unsaved changes</span>\n              </div>\n              <div className=\"flex gap-3\">\n                <Button onClick={handleDiscard} variant=\"outline\" disabled={saving}>\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Discard Changes\n                </Button>\n                <Button onClick={handleSave} disabled={saving} className=\"bg-blue-600 hover:bg-blue-700\">\n                  {saving ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Saving...\n                    </>\n                  ) : (\n                    <>\n                      <Save className=\"w-4 h-4 mr-2\" />\n                      Save Changes\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminTemplateManager.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Textarea' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":18,"fix":{"range":[324,377],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Textarea"},"fix":{"range":[324,376],"text":""},"desc":"Remove unused variable 'Textarea'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[432,439],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[433,439],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":9,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[438,456],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[438,456],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Edit2' is defined but never used.","line":12,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":35,"fix":{"range":[608,615],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Edit2"},"fix":{"range":[607,614],"text":""},"desc":"Remove unused variable 'Edit2'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Save' is defined but never used.","line":12,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":41,"fix":{"range":[615,621],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Save"},"fix":{"range":[614,620],"text":""},"desc":"Remove unused variable 'Save'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'X' is defined but never used.","line":12,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":44,"fix":{"range":[621,624],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"X"},"fix":{"range":[620,623],"text":""},"desc":"Remove unused variable 'X'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14,"fix":{"range":[630,646],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[629,645],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'editing' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"editing"},"fix":{"range":[967,974],"text":""},"desc":"Remove unused variable 'editing'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleSave' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":55,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleSave"},"fix":{"range":[2033,2573],"text":""},"desc":"Remove unused variable 'handleSave'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  Mail, MessageSquare, Bell, Edit2, Save, X, Plus, \n  CheckCircle, Loader2, Search, Filter, RefreshCw \n} from 'lucide-react';\nimport { seedTemplates } from '../components/templates/TemplateSeeder';\nimport { toast } from 'sonner';\n\nexport default function AdminTemplateManager() {\n  const [templates, setTemplates] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editing, setEditing] = useState(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [categoryFilter, setCategoryFilter] = useState('all');\n  const [seeding, setSeeding] = useState(false);\n\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  const loadTemplates = async () => {\n    setLoading(true);\n    try {\n      const allTemplates = await base44.entities.EmailTemplate.list();\n      setTemplates(allTemplates);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading templates:', showToast: false });\n      toast.error('Failed to load templates');\n    }\n    setLoading(false);\n  };\n\n  const handleSeedTemplates = async () => {\n    setSeeding(true);\n    try {\n      const results = await seedTemplates();\n      toast.success(`Templates seeded: ${results.created} created, ${results.updated} updated`);\n      await loadTemplates();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error seeding templates:', showToast: false });\n      toast.error('Failed to seed templates');\n    }\n    setSeeding(false);\n  };\n\n  const handleSave = async (template) => {\n    try {\n      if (template.id) {\n        await base44.entities.EmailTemplate.update(template.id, template);\n        toast.success('Template updated');\n      } else {\n        await base44.entities.EmailTemplate.create(template);\n        toast.success('Template created');\n      }\n      setEditing(null);\n      await loadTemplates();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving template:', showToast: false });\n      toast.error('Failed to save template');\n    }\n  };\n\n  const filteredTemplates = templates.filter(t => {\n    const matchesSearch = !searchTerm || \n      t.template_id?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      t.subject?.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesCategory = categoryFilter === 'all' || t.category === categoryFilter;\n\n    return matchesSearch && matchesCategory;\n  });\n\n  const emailTemplates = filteredTemplates.filter(t => t.send_email);\n  const smsTemplates = filteredTemplates.filter(t => t.send_sms);\n  const pushTemplates = filteredTemplates.filter(t => t.send_push);\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Email & SMS Templates</h1>\n            <p className=\"text-lg text-gray-600 font-verdana\">Manage notification templates across all channels</p>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button\n              onClick={loadTemplates}\n              variant=\"outline\"\n              className=\"rounded-full font-fredoka\"\n              disabled={loading}\n            >\n              <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />\n              Refresh\n            </Button>\n            <Button\n              onClick={handleSeedTemplates}\n              disabled={seeding}\n              className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n            >\n              {seeding ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Seeding...\n                </>\n              ) : (\n                <>\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Seed Templates\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <Card className=\"mb-6 border-0 shadow-lg rounded-2xl\">\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <Input\n                  placeholder=\"Search templates...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10 rounded-full font-verdana\"\n                />\n              </div>\n              <div>\n                <select\n                  value={categoryFilter}\n                  onChange={(e) => setCategoryFilter(e.target.value)}\n                  className=\"w-full p-2 border rounded-full font-verdana\"\n                >\n                  <option value=\"all\">All Categories</option>\n                  <option value=\"client\">Client</option>\n                  <option value=\"cleaner\">Cleaner</option>\n                  <option value=\"system\">System</option>\n                  <option value=\"marketing\">Marketing</option>\n                </select>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"w-5 h-5 text-gray-400\" />\n                <span className=\"text-sm text-gray-600 font-verdana\">\n                  {filteredTemplates.length} template{filteredTemplates.length !== 1 ? 's' : ''}\n                </span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Template Tabs */}\n        <Tabs defaultValue=\"email\" className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-md p-1 rounded-full\">\n            <TabsTrigger value=\"email\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full\">\n              <Mail className=\"w-4 h-4 mr-2\" />\n              Email ({emailTemplates.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"sms\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full\">\n              <MessageSquare className=\"w-4 h-4 mr-2\" />\n              SMS ({smsTemplates.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"push\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full\">\n              <Bell className=\"w-4 h-4 mr-2\" />\n              Push ({pushTemplates.length})\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Email Templates */}\n          <TabsContent value=\"email\" className=\"space-y-4\">\n            {emailTemplates.length === 0 ? (\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-12 text-center\">\n                  <Mail className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <p className=\"text-lg font-fredoka font-semibold text-graphite mb-2\">No Email Templates</p>\n                  <p className=\"text-gray-600 font-verdana mb-6\">Click \"Seed Templates\" to create default templates</p>\n                </CardContent>\n              </Card>\n            ) : (\n              emailTemplates.map(template => (\n                <Card key={template.id} className=\"border-0 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <Mail className=\"w-5 h-5 text-puretask-blue\" />\n                        <div>\n                          <CardTitle className=\"font-fredoka text-graphite\">{template.template_id}</CardTitle>\n                          <p className=\"text-sm text-gray-600 font-verdana mt-1\">{template.subject}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Badge className={`rounded-full font-fredoka ${\n                          template.category === 'client' ? 'bg-blue-100 text-puretask-blue' :\n                          template.category === 'cleaner' ? 'bg-green-100 text-fresh-mint' :\n                          template.category === 'system' ? 'bg-purple-100 text-purple-700' :\n                          'bg-amber-100 text-amber-700'\n                        }`}>\n                          {template.category}\n                        </Badge>\n                        <Badge className={`rounded-full font-fredoka ${\n                          template.is_active ? 'bg-fresh-mint text-white' : 'bg-gray-200 text-gray-600'\n                        }`}>\n                          {template.is_active ? 'Active' : 'Inactive'}\n                        </Badge>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3\">\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-1\">Variables:</p>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {template.variables?.map((v, idx) => (\n                            <Badge key={idx} variant=\"outline\" className=\"rounded-full font-verdana\">\n                              {v}\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-1\">HTML Preview:</p>\n                        <div className=\"p-3 bg-gray-50 rounded-2xl max-h-32 overflow-y-auto\">\n                          <p className=\"text-xs text-gray-700 font-mono\">{template.html_body?.substring(0, 200)}...</p>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n\n          {/* SMS Templates */}\n          <TabsContent value=\"sms\" className=\"space-y-4\">\n            {smsTemplates.length === 0 ? (\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-12 text-center\">\n                  <MessageSquare className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <p className=\"text-lg font-fredoka font-semibold text-graphite mb-2\">No SMS Templates</p>\n                  <p className=\"text-gray-600 font-verdana mb-6\">Click \"Seed Templates\" to create default templates</p>\n                </CardContent>\n              </Card>\n            ) : (\n              smsTemplates.map(template => (\n                <Card key={template.id} className=\"border-0 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <MessageSquare className=\"w-5 h-5 text-fresh-mint\" />\n                        <CardTitle className=\"font-fredoka text-graphite\">{template.template_id}</CardTitle>\n                      </div>\n                      <Badge className={`rounded-full font-fredoka ${\n                        template.is_active ? 'bg-fresh-mint text-white' : 'bg-gray-200 text-gray-600'\n                      }`}>\n                        {template.is_active ? 'Active' : 'Inactive'}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3\">\n                      <div className=\"p-4 bg-soft-cloud rounded-2xl\">\n                        <p className=\"font-verdana text-graphite\">{template.sms_body}</p>\n                      </div>\n                      {template.variables && template.variables.length > 0 && (\n                        <div>\n                          <p className=\"text-sm text-gray-600 font-verdana mb-1\">Variables:</p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {template.variables.map((v, idx) => (\n                              <Badge key={idx} variant=\"outline\" className=\"rounded-full font-verdana\">\n                                {v}\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n\n          {/* Push Templates */}\n          <TabsContent value=\"push\" className=\"space-y-4\">\n            {pushTemplates.length === 0 ? (\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-12 text-center\">\n                  <Bell className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <p className=\"text-lg font-fredoka font-semibold text-graphite mb-2\">No Push Templates</p>\n                  <p className=\"text-gray-600 font-verdana mb-6\">Click \"Seed Templates\" to create default templates</p>\n                </CardContent>\n              </Card>\n            ) : (\n              pushTemplates.map(template => (\n                <Card key={template.id} className=\"border-0 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-t-2xl\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <Bell className=\"w-5 h-5 text-purple-600\" />\n                        <CardTitle className=\"font-fredoka text-graphite\">{template.template_id}</CardTitle>\n                      </div>\n                      <Badge className={`rounded-full font-fredoka ${\n                        template.is_active ? 'bg-purple-600 text-white' : 'bg-gray-200 text-gray-600'\n                      }`}>\n                        {template.is_active ? 'Active' : 'Inactive'}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3\">\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-1\">Title:</p>\n                        <p className=\"font-fredoka font-semibold text-graphite\">{template.push_title}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-1\">Body:</p>\n                        <p className=\"font-verdana text-gray-700\">{template.push_body}</p>\n                      </div>\n                      {template.deep_link && (\n                        <div>\n                          <p className=\"text-sm text-gray-600 font-verdana mb-1\">Deep Link:</p>\n                          <code className=\"text-xs font-mono text-puretask-blue bg-blue-50 px-2 py-1 rounded\">\n                            {template.deep_link}\n                          </code>\n                        </div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminTestBooking.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'client' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":40,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"client"},"fix":{"range":[1382,1562],"text":""},"desc":"Remove unused variable 'client'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleaner' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":47,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleaner"},"fix":{"range":[1576,1761],"text":""},"desc":"Remove unused variable 'cleaner'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ArrowLeft, Send, Loader2 } from 'lucide-react';\nimport NotificationDispatcher from '../components/notifications/NotificationDispatcher';\n\nexport default function AdminTestBooking() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  \n  const [formData, setFormData] = useState({\n    booking_id: `test_${Date.now()}`,\n    client_id: '',\n    client_first_name: 'Sarah',\n    client_email: '',\n    client_phone: '',\n    cleaner_id: '',\n    cleaner_first_name: 'Maria',\n    cleaner_email: '',\n    cleaner_phone: '',\n    address: '123 Main St, Sacramento, CA 95814',\n    start_time_iso: new Date(Date.now() + 86400000).toISOString(), // Tomorrow\n    price: 139,\n    manage_url: ''\n  });\n\n  const handleEmit = async () => {\n    setLoading(true);\n    setMessage('');\n    \n    try {\n      // Create client and cleaner objects\n      const client = {\n        id: formData.client_id,\n        first_name: formData.client_first_name,\n        email: formData.client_email,\n        phone: formData.client_phone\n      };\n      \n      const cleaner = {\n        id: formData.cleaner_id,\n        first_name: formData.cleaner_first_name,\n        email: formData.cleaner_email,\n        phone: formData.cleaner_phone\n      };\n      \n      // Mock booking object for notification\n      const booking = {\n        id: formData.booking_id,\n        client_email: formData.client_email,\n        cleaner_email: formData.cleaner_email,\n        date: formData.start_time_iso.split('T')[0],\n        start_time: new Date(formData.start_time_iso).toLocaleTimeString('en-US', {\n          hour: 'numeric',\n          minute: '2-digit'\n        }),\n        address: formData.address,\n        total_price: formData.price,\n        tasks: ['Standard Clean']\n      };\n      \n      // Send booking confirmation to client\n      const clientResult = await NotificationDispatcher.sendBookingConfirmation(\n        booking,\n        { full_name: formData.client_first_name, phone: formData.client_phone },\n        { full_name: formData.cleaner_first_name }\n      );\n      \n      // Send job invite to cleaner\n      const cleanerResult = await NotificationDispatcher.sendJobInvite(\n        booking,\n        formData.cleaner_email,\n        formData.cleaner_first_name\n      );\n      \n      setMessage(`‚úÖ Event emitted successfully!\\n- Client notification: ${clientResult.success ? 'sent' : 'failed'}\\n- Cleaner notification: ${cleanerResult.success ? 'sent' : 'failed'}`);\n    } catch (error) {\n      handleError(error, { userMessage: 'Emit error:', showToast: false });\n      setMessage(`‚ùå Error: ${error.message}`);\n    }\n    \n    setLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-10\">\n      <div className=\"max-w-4xl mx-auto\">\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={() => navigate(createPageUrl('AdminDashboard'))}\n          className=\"mb-6\"\n        >\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          Back to Dashboard\n        </Button>\n\n        <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Test Booking Events</h1>\n        <p className=\"text-lg text-slate-600 mb-8\">\n          Manually trigger booking.created event\n        </p>\n\n        {message && (\n          <Alert className=\"mb-6\">\n            <AlertDescription className=\"whitespace-pre-line\">{message}</AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"grid lg:grid-cols-2 gap-6\">\n          {/* Client Panel */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n              <CardTitle>Client Info</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6 space-y-4\">\n              <div>\n                <Label>Client ID</Label>\n                <Input\n                  value={formData.client_id}\n                  onChange={(e) => setFormData({...formData, client_id: e.target.value})}\n                  placeholder=\"client_123\"\n                />\n              </div>\n              <div>\n                <Label>First Name</Label>\n                <Input\n                  value={formData.client_first_name}\n                  onChange={(e) => setFormData({...formData, client_first_name: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label>Email *</Label>\n                <Input\n                  type=\"email\"\n                  value={formData.client_email}\n                  onChange={(e) => setFormData({...formData, client_email: e.target.value})}\n                  placeholder=\"client@example.com\"\n                />\n              </div>\n              <div>\n                <Label>Phone</Label>\n                <Input\n                  value={formData.client_phone}\n                  onChange={(e) => setFormData({...formData, client_phone: e.target.value})}\n                  placeholder=\"+15551234567\"\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Cleaner Panel */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n              <CardTitle>Cleaner Info</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6 space-y-4\">\n              <div>\n                <Label>Cleaner ID</Label>\n                <Input\n                  value={formData.cleaner_id}\n                  onChange={(e) => setFormData({...formData, cleaner_id: e.target.value})}\n                  placeholder=\"cleaner_456\"\n                />\n              </div>\n              <div>\n                <Label>First Name</Label>\n                <Input\n                  value={formData.cleaner_first_name}\n                  onChange={(e) => setFormData({...formData, cleaner_first_name: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label>Email *</Label>\n                <Input\n                  type=\"email\"\n                  value={formData.cleaner_email}\n                  onChange={(e) => setFormData({...formData, cleaner_email: e.target.value})}\n                  placeholder=\"cleaner@example.com\"\n                />\n              </div>\n              <div>\n                <Label>Phone</Label>\n                <Input\n                  value={formData.cleaner_phone}\n                  onChange={(e) => setFormData({...formData, cleaner_phone: e.target.value})}\n                  placeholder=\"+15551234567\"\n                />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Booking Details */}\n        <Card className=\"mt-6 border-0 shadow-lg\">\n          <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n            <CardTitle>Booking Details</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <Label>Booking ID</Label>\n                <Input\n                  value={formData.booking_id}\n                  onChange={(e) => setFormData({...formData, booking_id: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label>Service Address</Label>\n                <Input\n                  value={formData.address}\n                  onChange={(e) => setFormData({...formData, address: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label>Start Time (ISO)</Label>\n                <Input\n                  type=\"datetime-local\"\n                  value={formData.start_time_iso.slice(0, 16)}\n                  onChange={(e) => setFormData({...formData, start_time_iso: new Date(e.target.value).toISOString()})}\n                />\n              </div>\n              <div>\n                <Label>Price ($)</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.price}\n                  onChange={(e) => setFormData({...formData, price: parseFloat(e.target.value)})}\n                />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Button */}\n        <Card className=\"mt-6 border-0 shadow-lg\">\n          <CardHeader>\n            <CardTitle>Emit Event</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <p className=\"text-sm text-slate-600 mb-4\">\n              This will trigger <code className=\"bg-slate-100 px-2 py-1 rounded\">booking.created</code> event\n              and send confirmation emails to both client and cleaner.\n            </p>\n            <Button\n              onClick={handleEmit}\n              disabled={loading || !formData.client_email || !formData.cleaner_email}\n              className=\"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600\"\n              size=\"lg\"\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Emitting Event...\n                </>\n              ) : (\n                <>\n                  <Send className=\"w-5 h-5 mr-2\" />\n                  Emit booking.created\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminTestCleaner.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AdminTestNotifications.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'base44' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"fix":{"range":[130,175],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"base44"},"fix":{"range":[130,174],"text":""},"desc":"Remove unused variable 'base44'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Textarea' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":18,"fix":{"range":[399,452],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Textarea"},"fix":{"range":[399,451],"text":""},"desc":"Remove unused variable 'Textarea'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Send, ArrowLeft, Zap, Loader2 } from 'lucide-react';\nimport NotificationDispatcher from '../components/notifications/NotificationDispatcher';\n\nexport default function AdminTestNotifications() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [activeTab, setActiveTab] = useState('booking');\n\n  // Booking test data\n  const [bookingData, setBookingData] = useState({\n    booking_id: 'test_' + Date.now(),\n    client_email: '',\n    client_first_name: 'Test',\n    client_phone: '',\n    cleaner_email: '',\n    cleaner_first_name: 'Maria',\n    date: new Date().toISOString().split('T')[0],\n    time: '10:00',\n    address: '123 Test St, Sacramento, CA',\n    price: '139'\n  });\n\n  // Payment test data\n  const [paymentData, setPaymentData] = useState({\n    booking_id: 'test_' + Date.now(),\n    client_email: '',\n    amount: '139',\n    reason: 'Card declined'\n  });\n\n  // Cleaner test data\n  const [cleanerData, setCleanerData] = useState({\n    cleaner_email: '',\n    cleaner_first_name: 'Maria',\n    old_score: '75',\n    new_score: '82'\n  });\n\n  const testBookingConfirmation = async () => {\n    setLoading(true);\n    setMessage('');\n    \n    try {\n      const result = await NotificationDispatcher.sendNotificationFromTemplate(\n        'email.client.booking_confirmation',\n        bookingData.client_email,\n        {\n          first_name: bookingData.client_first_name,\n          cleaner_name: bookingData.cleaner_first_name,\n          date: new Date(bookingData.date).toLocaleDateString('en-US', {\n            weekday: 'long', month: 'long', day: 'numeric'\n          }),\n          time: bookingData.time,\n          address: bookingData.address,\n          price: `$${bookingData.price}`,\n          booking_id: bookingData.booking_id,\n          manage_booking_link: `${window.location.origin}${createPageUrl('BookingHistory')}`,\n          link: `${window.location.origin}${createPageUrl('BookingHistory')}`,\n          phone: bookingData.client_phone,\n          year: new Date().getFullYear()\n        }\n      );\n      \n      if (result.success) {\n        setMessage(`‚úÖ Notification sent successfully! Check ${bookingData.client_email}`);\n      } else {\n        setMessage(`‚ùå Error: ${result.error}`);\n      }\n    } catch (error) {\n      setMessage(`‚ùå Error: ${error.message}`);\n    }\n    \n    setLoading(false);\n  };\n\n  const testPaymentFailed = async () => {\n    setLoading(true);\n    setMessage('');\n    \n    try {\n      const result = await NotificationDispatcher.sendNotificationFromTemplate(\n        'email.system.payment_failed',\n        paymentData.client_email,\n        {\n          first_name: 'Test User',\n          booking_id: paymentData.booking_id,\n          reason: paymentData.reason,\n          payment_link: `${window.location.origin}${createPageUrl('Profile')}`,\n          link: `${window.location.origin}${createPageUrl('Profile')}`,\n          year: new Date().getFullYear()\n        }\n      );\n      \n      if (result.success) {\n        setMessage(`‚úÖ Payment failure notification sent to ${paymentData.client_email}`);\n      } else {\n        setMessage(`‚ùå Error: ${result.error}`);\n      }\n    } catch (error) {\n      setMessage(`‚ùå Error: ${error.message}`);\n    }\n    \n    setLoading(false);\n  };\n\n  const testReliabilityUpdate = async () => {\n    setLoading(true);\n    setMessage('');\n    \n    try {\n      const result = await NotificationDispatcher.sendReliabilityScoreUpdate(\n        cleanerData.cleaner_email,\n        cleanerData.cleaner_first_name,\n        parseInt(cleanerData.new_score),\n        parseInt(cleanerData.old_score)\n      );\n      \n      if (result.success) {\n        setMessage(`‚úÖ Score update notification sent to ${cleanerData.cleaner_email}`);\n      } else {\n        setMessage(`‚ùå Error: ${result.error}`);\n      }\n    } catch (error) {\n      setMessage(`‚ùå Error: ${error.message}`);\n    }\n    \n    setLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-10\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"mb-8\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => navigate(createPageUrl('AdminDashboard'))}\n            className=\"mb-4\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Dashboard\n          </Button>\n\n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2 flex items-center gap-3\">\n            <Zap className=\"w-10 h-10 text-purple-600\" />\n            Test Notification System\n          </h1>\n          <p className=\"text-lg text-slate-600\">\n            Manually trigger notifications to test your templates\n          </p>\n        </div>\n\n        {message && (\n          <Alert className=\"mb-6\">\n            <AlertDescription>{message}</AlertDescription>\n          </Alert>\n        )}\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"bg-white shadow-md p-1 mb-6\">\n            <TabsTrigger value=\"booking\">Booking Confirmation</TabsTrigger>\n            <TabsTrigger value=\"payment\">Payment Failed</TabsTrigger>\n            <TabsTrigger value=\"reliability\">Reliability Score</TabsTrigger>\n          </TabsList>\n\n          {/* Booking Confirmation Test */}\n          <TabsContent value=\"booking\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Test Booking Confirmation Email</CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-4\">\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label>Client Email *</Label>\n                      <Input\n                        type=\"email\"\n                        value={bookingData.client_email}\n                        onChange={(e) => setBookingData({...bookingData, client_email: e.target.value})}\n                        placeholder=\"client@example.com\"\n                      />\n                    </div>\n                    <div>\n                      <Label>Client First Name</Label>\n                      <Input\n                        value={bookingData.client_first_name}\n                        onChange={(e) => setBookingData({...bookingData, client_first_name: e.target.value})}\n                      />\n                    </div>\n                    <div>\n                      <Label>Cleaner First Name</Label>\n                      <Input\n                        value={bookingData.cleaner_first_name}\n                        onChange={(e) => setBookingData({...bookingData, cleaner_first_name: e.target.value})}\n                      />\n                    </div>\n                    <div>\n                      <Label>Date</Label>\n                      <Input\n                        type=\"date\"\n                        value={bookingData.date}\n                        onChange={(e) => setBookingData({...bookingData, date: e.target.value})}\n                      />\n                    </div>\n                    <div>\n                      <Label>Time</Label>\n                      <Input\n                        type=\"time\"\n                        value={bookingData.time}\n                        onChange={(e) => setBookingData({...bookingData, time: e.target.value})}\n                      />\n                    </div>\n                    <div>\n                      <Label>Price ($)</Label>\n                      <Input\n                        type=\"number\"\n                        value={bookingData.price}\n                        onChange={(e) => setBookingData({...bookingData, price: e.target.value})}\n                      />\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label>Address</Label>\n                    <Input\n                      value={bookingData.address}\n                      onChange={(e) => setBookingData({...bookingData, address: e.target.value})}\n                    />\n                  </div>\n\n                  <Button\n                    onClick={testBookingConfirmation}\n                    disabled={loading || !bookingData.client_email}\n                    className=\"w-full bg-blue-500 hover:bg-blue-600\"\n                  >\n                    {loading ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Sending...\n                      </>\n                    ) : (\n                      <>\n                        <Send className=\"w-4 h-4 mr-2\" />\n                        Send Test Email\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Payment Failed Test */}\n          <TabsContent value=\"payment\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Test Payment Failed Email</CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label>Client Email *</Label>\n                    <Input\n                      type=\"email\"\n                      value={paymentData.client_email}\n                      onChange={(e) => setPaymentData({...paymentData, client_email: e.target.value})}\n                      placeholder=\"client@example.com\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Booking ID</Label>\n                    <Input\n                      value={paymentData.booking_id}\n                      onChange={(e) => setPaymentData({...paymentData, booking_id: e.target.value})}\n                    />\n                  </div>\n                  <div>\n                    <Label>Amount</Label>\n                    <Input\n                      type=\"number\"\n                      value={paymentData.amount}\n                      onChange={(e) => setPaymentData({...paymentData, amount: e.target.value})}\n                    />\n                  </div>\n                  <div>\n                    <Label>Failure Reason</Label>\n                    <Input\n                      value={paymentData.reason}\n                      onChange={(e) => setPaymentData({...paymentData, reason: e.target.value})}\n                    />\n                  </div>\n\n                  <Button\n                    onClick={testPaymentFailed}\n                    disabled={loading || !paymentData.client_email}\n                    className=\"w-full bg-red-500 hover:bg-red-600\"\n                  >\n                    {loading ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Sending...\n                      </>\n                    ) : (\n                      <>\n                        <Send className=\"w-4 h-4 mr-2\" />\n                        Send Test Email\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Reliability Score Test */}\n          <TabsContent value=\"reliability\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle>Test Reliability Score Update</CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label>Cleaner Email *</Label>\n                    <Input\n                      type=\"email\"\n                      value={cleanerData.cleaner_email}\n                      onChange={(e) => setCleanerData({...cleanerData, cleaner_email: e.target.value})}\n                      placeholder=\"cleaner@example.com\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Cleaner First Name</Label>\n                    <Input\n                      value={cleanerData.cleaner_first_name}\n                      onChange={(e) => setCleanerData({...cleanerData, cleaner_first_name: e.target.value})}\n                    />\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>Old Score</Label>\n                      <Input\n                        type=\"number\"\n                        value={cleanerData.old_score}\n                        onChange={(e) => setCleanerData({...cleanerData, old_score: e.target.value})}\n                      />\n                    </div>\n                    <div>\n                      <Label>New Score</Label>\n                      <Input\n                        type=\"number\"\n                        value={cleanerData.new_score}\n                        onChange={(e) => setCleanerData({...cleanerData, new_score: e.target.value})}\n                      />\n                    </div>\n                  </div>\n\n                  <Button\n                    onClick={testReliabilityUpdate}\n                    disabled={loading || !cleanerData.cleaner_email}\n                    className=\"w-full bg-purple-500 hover:bg-purple-600\"\n                  >\n                    {loading ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                        Sending...\n                      </>\n                    ) : (\n                      <>\n                        <Send className=\"w-4 h-4 mr-2\" />\n                        Send Test Email\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n\n        {/* Quick Reference */}\n        <Card className=\"mt-6 border-0 shadow-lg\">\n          <CardHeader>\n            <CardTitle>Quick Reference</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-3 text-sm\">\n              <p><strong>Template IDs:</strong></p>\n              <ul className=\"list-disc list-inside space-y-1 text-slate-600\">\n                <li><code>email.client.booking_confirmation</code> - Booking confirmed</li>\n                <li><code>email.client.reminder_24h</code> - 24 hour reminder</li>\n                <li><code>email.client.cleaning_completed</code> - Cleaning done</li>\n                <li><code>email.client.review_request</code> - Ask for review</li>\n                <li><code>email.system.payment_failed</code> - Payment issue</li>\n                <li><code>email.cleaner.job_invited</code> - New job opportunity</li>\n                <li><code>email.cleaner.reliability_changed</code> - Score update</li>\n                <li><code>email.marketing.winback</code> - Re-engagement</li>\n              </ul>\n              \n              <p className=\"pt-4\"><strong>All sent messages are logged to:</strong></p>\n              <p className=\"text-slate-600\">Admin Dashboard ‚Üí Communications ‚Üí Message Delivery Logs</p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\AnalyticsDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[310,357],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[310,356],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart3' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":12,"fix":{"range":[414,428],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart3"},"fix":{"range":[418,428],"text":""},"desc":"Remove unused variable 'BarChart3'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":11,"fix":{"range":[472,485],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[471,484],"text":""},"desc":"Remove unused variable 'Calendar'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { \n  BarChart3, TrendingUp, DollarSign, Users, AlertCircle, \n  Calendar, ArrowRight, Loader2, Activity, Zap \n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function AnalyticsDashboard() {\n  const [loading, setLoading] = useState(true);\n  const [alerts, setAlerts] = useState([]);\n  const [latestData, setLatestData] = useState(null);\n\n  useEffect(() => {\n    loadOverview();\n  }, []);\n\n  const loadOverview = async () => {\n    try {\n      const [systemAlerts, dailyData] = await Promise.all([\n        base44.entities.SystemAlert.filter({ is_resolved: false }),\n        base44.entities.PlatformAnalyticsDaily.list('-created_date', 1)\n      ]);\n      \n      setAlerts(systemAlerts);\n      setLatestData(dailyData[0] || null);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading analytics overview:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const dashboards = [\n    {\n      id: 'ceo',\n      title: 'CEO Dashboard',\n      description: 'High-level platform health, GMV, revenue trends',\n      icon: TrendingUp,\n      color: 'bg-gradient-to-br from-blue-500 to-cyan-500',\n      url: createPageUrl('CEODashboard')\n    },\n    {\n      id: 'ops',\n      title: 'Operations Dashboard',\n      description: 'Bookings, cancellations, disputes, cleaner performance',\n      icon: Activity,\n      color: 'bg-gradient-to-br from-green-500 to-emerald-500',\n      url: createPageUrl('OpsDashboard')\n    },\n    {\n      id: 'finance',\n      title: 'Finance Dashboard',\n      description: 'Revenue, costs, margins, payouts, refunds',\n      icon: DollarSign,\n      color: 'bg-gradient-to-br from-purple-500 to-pink-500',\n      url: createPageUrl('FinanceDashboard')\n    },\n    {\n      id: 'growth',\n      title: 'Growth Dashboard',\n      description: 'User acquisition, subscriptions, retention metrics',\n      icon: Users,\n      color: 'bg-gradient-to-br from-amber-500 to-orange-500',\n      url: createPageUrl('GrowthDashboard')\n    }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Analytics Hub</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">\n              Data-driven insights for PureTask marketplace\n            </p>\n          </div>\n          <Link to={createPageUrl('SystemAlerts')}>\n            <Button className=\"brand-gradient font-fredoka\">\n              <AlertCircle className=\"w-4 h-4 mr-2\" />\n              View Alerts {alerts.length > 0 && `(${alerts.length})`}\n            </Button>\n          </Link>\n        </div>\n\n        {/* Active Alerts Banner */}\n        {alerts.length > 0 && (\n          <Card className=\"border-2 border-red-500 bg-red-50\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <AlertCircle className=\"w-6 h-6 text-red-600\" />\n                <div className=\"flex-1\">\n                  <p className=\"font-fredoka font-bold text-red-900\">\n                    {alerts.length} Active System Alert{alerts.length > 1 ? 's' : ''}\n                  </p>\n                  <p className=\"text-sm text-red-700 font-verdana\">\n                    {alerts[0]?.message}\n                  </p>\n                </div>\n                <Link to={createPageUrl('SystemAlerts')}>\n                  <Button variant=\"outline\" className=\"border-red-600 text-red-600 font-fredoka\">\n                    View All\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Quick Stats */}\n        {latestData && (\n          <div className=\"grid md:grid-cols-4 gap-6\">\n            <Card className=\"border-2 border-blue-200\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm font-verdana text-gray-600\">Today's Bookings</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {latestData.total_bookings || 0}\n                </p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                  {latestData.completed_bookings || 0} completed\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-green-200\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm font-verdana text-gray-600\">GMV (Today)</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  ${(latestData.gmv_usd || 0).toLocaleString()}\n                </p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                  ${(latestData.platform_revenue_usd || 0).toFixed(0)} revenue\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-purple-200\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm font-verdana text-gray-600\">Active Users</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {(latestData.active_clients || 0) + (latestData.active_cleaners || 0)}\n                </p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                  {latestData.active_clients || 0} clients, {latestData.active_cleaners || 0} cleaners\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-amber-200\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm font-verdana text-gray-600\">Platform Health</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {latestData.avg_rating?.toFixed(1) || '5.0'}‚≠ê\n                </p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                  {latestData.cancel_rate?.toFixed(1) || 0}% cancel rate\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Dashboard Cards */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          {dashboards.map((dashboard, idx) => (\n            <motion.div\n              key={dashboard.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.1 }}\n            >\n              <Link to={dashboard.url}>\n                <Card className=\"hover:shadow-xl transition-all duration-300 cursor-pointer border-2 border-gray-200 hover:border-puretask-blue overflow-hidden group\">\n                  <div className={`h-2 ${dashboard.color}`}></div>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <div className={`w-16 h-16 rounded-2xl ${dashboard.color} flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform`}>\n                        <dashboard.icon className=\"w-8 h-8 text-white\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-2 group-hover:text-puretask-blue transition-colors\">\n                          {dashboard.title}\n                        </h3>\n                        <p className=\"text-gray-600 font-verdana mb-4\">\n                          {dashboard.description}\n                        </p>\n                        <div className=\"flex items-center text-puretask-blue font-fredoka font-semibold group-hover:gap-3 gap-2 transition-all\">\n                          View Dashboard\n                          <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* System Info */}\n        <Card className=\"border-2 border-gray-300\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n              <Zap className=\"w-5 h-5 text-puretask-blue\" />\n              Analytics Engine Status\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Real-time Updates</p>\n                <p className=\"text-xl font-fredoka font-bold text-green-700\">Active ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Event-driven analytics</p>\n              </div>\n              <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Nightly Aggregation</p>\n                <p className=\"text-xl font-fredoka font-bold text-blue-700\">Scheduled ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Runs at 3:00 AM daily</p>\n              </div>\n              <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Alert Detection</p>\n                <p className=\"text-xl font-fredoka font-bold text-purple-700\">Monitoring ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Anomaly detection active</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingAddOns.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Lightbulb' is defined but never used.","line":10,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":57,"fix":{"range":[495,506],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Lightbulb"},"fix":{"range":[494,505],"text":""},"desc":"Remove unused variable 'Lightbulb'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":6,"fix":{"range":[521,528],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[520,527],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":11,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":62,"fix":{"range":[578,584],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[577,583],"text":""},"desc":"Remove unused variable 'Info'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":87,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":87,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[2178,2182],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":124,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":124,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Sparkles, Wind, Grid, ChefHat, Refrigerator, Lightbulb, Package, Home,\n  Zap, ArrowRight, ArrowLeft, Plus, Minus, ShoppingCart, Info, Loader2, DollarSign\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nconst ADDITIONAL_SERVICES = [\n  {\n    key: 'windows',\n    icon: Wind,\n    name: 'Windows',\n    description: 'Interior and exterior cleaning',\n    minCredits: 3,\n    maxCredits: 7,\n    unit: 'per window',\n    color: '#66B3FF',\n    bgColor: '#EFF6FF'\n  },\n  {\n    key: 'blinds',\n    icon: Grid,\n    name: 'Blinds',\n    description: 'Dusting and deep cleaning',\n    minCredits: 10,\n    maxCredits: 15,\n    unit: 'per set',\n    color: '#00D4FF',\n    bgColor: '#ECFEFF'\n  },\n  {\n    key: 'oven',\n    icon: ChefHat,\n    name: 'Oven',\n    description: 'Deep clean interior & racks',\n    minCredits: 20,\n    maxCredits: 40,\n    unit: 'per oven',\n    color: '#F59E0B',\n    bgColor: '#FFFBEB'\n  },\n  {\n    key: 'refrigerator',\n    icon: Refrigerator,\n    name: 'Refrigerator',\n    description: 'Interior shelves & drawers',\n    minCredits: 15,\n    maxCredits: 30,\n    unit: 'per fridge',\n    color: '#28C76F',\n    bgColor: '#F0FDF4'\n  },\n  {\n    key: 'inside_cabinets',\n    icon: Package,\n    name: 'Inside Cabinets',\n    description: 'Kitchen or bathroom cabinets',\n    minCredits: 10,\n    maxCredits: 20,\n    unit: 'per section',\n    color: '#EC4899',\n    bgColor: '#FDF2F8'\n  },\n  {\n    key: 'baseboards',\n    icon: Home,\n    name: 'Baseboards',\n    description: 'Full home baseboard cleaning',\n    minCredits: 20,\n    maxCredits: 40,\n    unit: 'per home',\n    color: '#14B8A6',\n    bgColor: '#F0FDFA',\n    basicOnly: true\n  }\n];\n\nexport default function BookingAddOns() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [cleaner, setCleaner] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [selectedServices, setSelectedServices] = useState({});\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('ClientSignup'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Get cleaner from URL\n      const searchParams = new URLSearchParams(window.location.search);\n      const cleanerEmail = searchParams.get('cleaner');\n      \n      if (cleanerEmail) {\n        const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n        if (cleanerProfiles.length > 0) {\n          setCleaner(cleanerProfiles[0]);\n        }\n      }\n\n      // Load saved selections from bookingDraft\n      const draftStr = localStorage.getItem('bookingDraft');\n      if (draftStr) {\n        const draft = JSON.parse(draftStr);\n        if (draft.additional_services) {\n          setSelectedServices(draft.additional_services);\n        }\n      }\n    } catch (error) {\n      navigate(createPageUrl('ClientSignup'));\n    }\n    setLoading(false);\n  };\n\n  const handleQuantityChange = (serviceKey, delta) => {\n    setSelectedServices(prev => {\n      const current = prev[serviceKey] || 0;\n      const newValue = Math.max(0, current + delta);\n      const updated = { ...prev };\n      if (newValue === 0) {\n        delete updated[serviceKey];\n      } else {\n        updated[serviceKey] = newValue;\n      }\n      return updated;\n    });\n  };\n\n  const getTotalEstimate = () => {\n    let total = 0;\n    if (!cleaner || !cleaner.additional_service_pricing) {\n      // Fallback to midpoint of range if cleaner not loaded\n      Object.keys(selectedServices).forEach(key => {\n        const service = ADDITIONAL_SERVICES.find(s => s.key === key);\n        if (service) {\n          const midpoint = Math.round((service.minCredits + service.maxCredits) / 2);\n          total += midpoint * selectedServices[key];\n        }\n      });\n    } else {\n      // Use cleaner's actual prices\n      Object.keys(selectedServices).forEach(key => {\n        const price = cleaner.additional_service_pricing[key];\n        if (price) {\n          total += price * selectedServices[key];\n        }\n      });\n    }\n    return total;\n  };\n\n  const handleContinue = () => {\n    // Update bookingDraft with additional services\n    const draftStr = localStorage.getItem('bookingDraft');\n    if (draftStr) {\n      const draft = JSON.parse(draftStr);\n      draft.additional_services = selectedServices;\n      localStorage.setItem('bookingDraft', JSON.stringify(draft));\n    }\n    \n    // Continue to next step in BookingFlow\n    const searchParams = new URLSearchParams(window.location.search);\n    const cleanerEmail = searchParams.get('cleaner');\n    if (cleanerEmail) {\n      navigate(createPageUrl(`BookingFlow?cleaner=${cleanerEmail}`));\n    } else {\n      navigate(createPageUrl('BrowseCleaners'));\n    }\n  };\n\n  const handleSkip = () => {\n    // Update bookingDraft with empty services\n    const draftStr = localStorage.getItem('bookingDraft');\n    if (draftStr) {\n      const draft = JSON.parse(draftStr);\n      draft.additional_services = {};\n      localStorage.setItem('bookingDraft', JSON.stringify(draft));\n    }\n    \n    // Continue to next step in BookingFlow\n    const searchParams = new URLSearchParams(window.location.search);\n    const cleanerEmail = searchParams.get('cleaner');\n    if (cleanerEmail) {\n      navigate(createPageUrl(`BookingFlow?cleaner=${cleanerEmail}`));\n    } else {\n      navigate(createPageUrl('BrowseCleaners'));\n    }\n  };\n\n  const totalServices = Object.keys(selectedServices).length;\n  const estimatedCredits = getTotalEstimate();\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6 pb-32\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center mb-8\"\n        >\n          <div className=\"flex items-center justify-center gap-3 mb-4\">\n            <div className=\"w-14 h-14 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <Sparkles className=\"w-7 h-7 text-white\" />\n            </div>\n          </div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n            Want to Add Anything Extra?\n          </h1>\n          <p className=\"text-lg text-gray-600 font-verdana\">\n            Optional add-on services to make your home shine ‚ú®\n          </p>\n        </motion.div>\n\n        {/* Enhanced Info Alert with 1:1 conversion explanation */}\n        <Alert className=\"mb-8 border-2 rounded-2xl shadow-lg\" style={{ borderColor: '#66B3FF', backgroundColor: '#EFF6FF' }}>\n          <DollarSign className=\"w-6 h-6 text-puretask-blue\" />\n          <AlertTitle className=\"font-fredoka font-bold text-lg text-graphite mb-2\">\n            üí∞ Additional Services Pricing\n          </AlertTitle>\n          <AlertDescription className=\"font-verdana text-gray-700 space-y-2\">\n            <p>\n              Each cleaner sets their own prices for these services based on their reliability tier. \n              {cleaner ? (\n                <span className=\"font-semibold text-puretask-blue\"> Your selected cleaner's exact prices are shown below.</span>\n              ) : (\n                <span> When you select a cleaner, their exact prices will be displayed.</span>\n              )}\n            </p>\n            {cleaner && (\n              <div className=\"mt-2 p-3 bg-white rounded-lg border border-blue-200\">\n                <p className=\"text-sm\">\n                  <strong>Your Cleaner:</strong> {cleaner.full_name} \n                  <Badge className=\"ml-2\" style={{ backgroundColor: '#FCD34D', color: '#92400E' }}>\n                    {cleaner.tier} Tier\n                  </Badge>\n                </p>\n              </div>\n            )}\n          </AlertDescription>\n        </Alert>\n\n        {/* Services Grid */}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n          {ADDITIONAL_SERVICES.filter(service => {\n            // Get cleaning type from bookingDraft\n            const draftStr = localStorage.getItem('bookingDraft');\n            if (draftStr) {\n              const draft = JSON.parse(draftStr);\n              const cleaningType = draft.cleaning_type;\n              // Only show baseboards for basic cleans\n              if (service.basicOnly && cleaningType !== 'basic') {\n                return false;\n              }\n            }\n            return true;\n          }).map((service, idx) => {\n            const quantity = selectedServices[service.key] || 0;\n            const ServiceIcon = service.icon;\n            const cleanerPrice = cleaner?.additional_service_pricing?.[service.key];\n            const subtotal = quantity > 0 ? (cleanerPrice || Math.round((service.minCredits + service.maxCredits) / 2)) * quantity : 0;\n            \n            return (\n              <motion.div\n                key={service.key}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card \n                  className={`border-2 shadow-lg rounded-2xl transition-all ${\n                    quantity > 0 ? 'ring-4 ring-offset-2' : 'hover:shadow-xl'\n                  }`}\n                  style={{ \n                    backgroundColor: service.bgColor,\n                    borderColor: service.color,\n                    ringColor: quantity > 0 ? service.color : 'transparent'\n                  }}\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-center justify-between mb-3\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center shadow-md\" style={{ backgroundColor: service.color }}>\n                        <ServiceIcon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      {quantity > 0 && (\n                        <Badge className=\"rounded-full font-fredoka text-white\" style={{ backgroundColor: service.color }}>\n                          {quantity}\n                        </Badge>\n                      )}\n                    </div>\n                    <CardTitle className=\"font-fredoka text-lg text-graphite\">\n                      {service.name}\n                    </CardTitle>\n                    <p className=\"text-xs text-gray-600 font-verdana mt-1\">\n                      {service.description}\n                    </p>\n                  </CardHeader>\n                  <CardContent>\n                    {/* Only show price when service is selected and quantity > 0 */}\n                    {quantity > 0 && cleanerPrice && (\n                      <div className=\"mb-3 p-2 rounded-lg bg-white\">\n                        <p className=\"text-xs font-verdana text-gray-600\">Price {service.unit}:</p>\n                        <p className=\"text-sm font-fredoka font-bold\" style={{ color: service.color }}>\n                          ${cleanerPrice.toFixed(2)}\n                        </p>\n                        <div className=\"mt-2 pt-2 border-t border-gray-200\">\n                          <p className=\"text-xs font-verdana text-gray-600\">Subtotal:</p>\n                          <p className=\"text-lg font-fredoka font-bold\" style={{ color: service.color }}>\n                            ${subtotal.toFixed(2)}\n                          </p>\n                        </div>\n                      </div>\n                    )}\n\n                    <div className=\"flex items-center justify-between gap-2\">\n                      <Button\n                        type=\"button\"\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => handleQuantityChange(service.key, -1)}\n                        disabled={quantity === 0}\n                        className=\"rounded-full w-10 h-10 p-0\"\n                      >\n                        <Minus className=\"w-4 h-4\" />\n                      </Button>\n                      \n                      <span className=\"font-fredoka font-bold text-xl text-graphite min-w-[2rem] text-center\">\n                        {quantity}\n                      </span>\n                      \n                      <Button\n                        type=\"button\"\n                        size=\"sm\"\n                        onClick={() => handleQuantityChange(service.key, 1)}\n                        className=\"rounded-full w-10 h-10 p-0 text-white\"\n                        style={{ background: service.color }}\n                      >\n                        <Plus className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </div>\n\n        {/* Enhanced Summary Card */}\n        {totalServices > 0 && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n          >\n            <Card className=\"border-0 shadow-2xl rounded-2xl bg-gradient-to-r from-purple-50 to-blue-50 mb-8\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n                      <ShoppingCart className=\"w-6 h-6 text-white\" />\n                    </div>\n                    <div>\n                      <p className=\"font-fredoka font-bold text-graphite text-lg\">\n                        {totalServices} Add-On Service{totalServices > 1 ? 's' : ''} Selected\n                      </p>\n                      <p className=\"text-sm text-gray-600 font-verdana\">\n                        Total: <span className=\"font-bold text-green-600 text-2xl\">${estimatedCredits.toFixed(2)}</span>\n                      </p>\n                    </div>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    onClick={() => setSelectedServices({})}\n                    className=\"text-red-600 hover:text-red-700 hover:bg-red-50 rounded-full font-fredoka\"\n                  >\n                    Clear All\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex flex-col sm:flex-row gap-4\">\n          <Button\n            onClick={() => navigate(-1)}\n            variant=\"outline\"\n            size=\"lg\"\n            className=\"rounded-full font-fredoka font-semibold border-2\"\n          >\n            <ArrowLeft className=\"w-5 h-5 mr-2\" />\n            Back\n          </Button>\n\n          <Button\n            onClick={handleSkip}\n            variant=\"outline\"\n            size=\"lg\"\n            className=\"flex-1 rounded-full font-fredoka font-semibold border-2\"\n          >\n            Skip Add-Ons\n          </Button>\n\n          <Button\n            onClick={handleContinue}\n            size=\"lg\"\n            className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-bold shadow-xl\"\n          >\n            Continue\n            <ArrowRight className=\"w-5 h-5 ml-2\" />\n          </Button>\n        </div>\n\n        {/* Enhanced Info Box */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n          className=\"mt-8\"\n        >\n          <Card className=\"border-0 shadow-lg rounded-2xl bg-gradient-to-r from-amber-50 to-orange-50\">\n            <CardContent className=\"p-6\">\n              <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-3 flex items-center gap-2\">\n                <Sparkles className=\"w-5 h-5 text-amber-600\" />\n                Good to Know\n              </h3>\n              <ul className=\"space-y-2 font-verdana text-sm text-gray-700\">\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-amber-600 mt-1\">‚Ä¢</span>\n                  <span>Final prices are set by your chosen cleaner within their tier range</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-amber-600 mt-1\">‚Ä¢</span>\n                  <span>You can discuss specific needs with your cleaner before confirming</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"text-amber-600 mt-1\">‚Ä¢</span>\n                  <span>All add-ons include before/after photo proof for quality assurance</span>\n                </li>\n              </ul>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n\n      {/* Sticky Price Summary */}\n      <div className=\"fixed bottom-0 left-0 right-0 bg-white border-t-2 border-puretask-blue shadow-2xl p-4 z-50\">\n        <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 brand-gradient rounded-xl flex items-center justify-center\">\n              <ShoppingCart className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600 font-verdana\">Add-Ons Total</p>\n              <p className=\"text-2xl font-fredoka font-bold text-graphite\">\n                ${estimatedCredits.toFixed(2)}\n              </p>\n              {totalServices > 0 && (\n                <p className=\"text-xs text-gray-500 font-verdana\">\n                  {totalServices} service{totalServices > 1 ? 's' : ''} selected\n                </p>\n              )}\n            </div>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button\n              onClick={handleSkip}\n              variant=\"outline\"\n              size=\"lg\"\n              className=\"rounded-full font-fredoka font-semibold border-2\"\n            >\n              Skip\n            </Button>\n            <Button\n              onClick={handleContinue}\n              size=\"lg\"\n              className=\"brand-gradient text-white rounded-full font-fredoka font-bold shadow-xl\"\n            >\n              Continue\n              <ArrowRight className=\"w-5 h-5 ml-2\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingApprovalPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingConfirmation.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingDataInspector.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[609,613],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":28,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":42,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[1318,1325],"text":""},"desc":"Remove unused variable 'index'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":59,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Loader2, AlertTriangle, CheckCircle } from 'lucide-react';\n\nexport default function BookingDataInspector() {\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [issues, setIssues] = useState([]);\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser.role !== 'admin') {\n        alert('Admin access required');\n        return;\n      }\n      setUser(currentUser);\n      inspectBookings();\n    } catch (error) {\n      alert('Please log in as admin');\n    }\n  };\n\n  const inspectBookings = async () => {\n    setLoading(true);\n    const foundIssues = [];\n\n    try {\n      const allBookings = await base44.entities.Booking.list('-created_date', 100);\n      setBookings(allBookings);\n\n      // Check each booking for potential issues\n      allBookings.forEach((booking, index) => {\n        // Check tasks array\n        if (booking.tasks && !Array.isArray(booking.tasks)) {\n          foundIssues.push({\n            bookingId: booking.id,\n            field: 'tasks',\n            issue: 'Not an array',\n            value: JSON.stringify(booking.tasks)\n          });\n        }\n\n        // Check task_quantities\n        if (booking.task_quantities) {\n          try {\n            if (typeof booking.task_quantities === 'string') {\n              JSON.parse(booking.task_quantities);\n            }\n          } catch (e) {\n            foundIssues.push({\n              bookingId: booking.id,\n              field: 'task_quantities',\n              issue: 'Invalid JSON',\n              value: booking.task_quantities\n            });\n          }\n        }\n\n        // Check price_multipliers\n        if (booking.price_multipliers && !Array.isArray(booking.price_multipliers)) {\n          foundIssues.push({\n            bookingId: booking.id,\n            field: 'price_multipliers',\n            issue: 'Not an array',\n            value: JSON.stringify(booking.price_multipliers)\n          });\n        }\n\n        // Check photos arrays\n        if (booking.before_photos && !Array.isArray(booking.before_photos)) {\n          foundIssues.push({\n            bookingId: booking.id,\n            field: 'before_photos',\n            issue: 'Not an array',\n            value: JSON.stringify(booking.before_photos)\n          });\n        }\n\n        if (booking.after_photos && !Array.isArray(booking.after_photos)) {\n          foundIssues.push({\n            bookingId: booking.id,\n            field: 'after_photos',\n            issue: 'Not an array',\n            value: JSON.stringify(booking.after_photos)\n          });\n        }\n\n        // Check for extremely large fields\n        const bookingSize = JSON.stringify(booking).length;\n        if (bookingSize > 50000) { // 50KB\n          foundIssues.push({\n            bookingId: booking.id,\n            field: 'overall',\n            issue: 'Record too large',\n            value: `${(bookingSize / 1024).toFixed(2)} KB`\n          });\n        }\n      });\n\n      setIssues(foundIssues);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error inspecting bookings:', showToast: false });\n      foundIssues.push({\n        bookingId: 'N/A',\n        field: 'general',\n        issue: 'Failed to load bookings',\n        value: error.message\n      });\n      setIssues(foundIssues);\n    }\n\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen p-10 flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-blue-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle>Booking Data Inspector (Admin Only)</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div className=\"grid md:grid-cols-3 gap-4\">\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <p className=\"text-sm text-slate-600\">Total Bookings</p>\n                  <p className=\"text-2xl font-bold text-blue-600\">{bookings.length}</p>\n                </div>\n                <div className={`p-4 rounded-lg ${issues.length > 0 ? 'bg-red-50' : 'bg-green-50'}`}>\n                  <p className=\"text-sm text-slate-600\">Issues Found</p>\n                  <p className={`text-2xl font-bold ${issues.length > 0 ? 'text-red-600' : 'text-green-600'}`}>\n                    {issues.length}\n                  </p>\n                </div>\n                <div className=\"bg-purple-50 p-4 rounded-lg\">\n                  <p className=\"text-sm text-slate-600\">Healthy Records</p>\n                  <p className=\"text-2xl font-bold text-purple-600\">\n                    {bookings.length - new Set(issues.map(i => i.bookingId)).size}\n                  </p>\n                </div>\n              </div>\n\n              <Button onClick={inspectBookings} className=\"w-full\">\n                Re-run Inspection\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {issues.length === 0 ? (\n          <Alert className=\"bg-green-50 border-green-200\">\n            <CheckCircle className=\"w-4 h-4 text-green-600\" />\n            <AlertDescription className=\"text-green-800\">\n              ‚úÖ All booking records appear healthy! No data issues detected.\n            </AlertDescription>\n          </Alert>\n        ) : (\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"w-5 h-5 text-red-500\" />\n                Data Issues Detected\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {issues.map((issue, idx) => (\n                  <div key={idx} className=\"bg-red-50 p-4 rounded-lg border border-red-200\">\n                    <div className=\"flex items-start justify-between mb-2\">\n                      <div>\n                        <p className=\"font-semibold text-red-900\">Booking ID: {issue.bookingId}</p>\n                        <p className=\"text-sm text-red-700\">Field: <code className=\"bg-red-100 px-2 py-1 rounded\">{issue.field}</code></p>\n                      </div>\n                      <span className=\"text-xs bg-red-200 text-red-800 px-2 py-1 rounded\">{issue.issue}</span>\n                    </div>\n                    <div className=\"bg-white p-2 rounded border border-red-200 mt-2\">\n                      <p className=\"text-xs font-mono text-slate-600 break-all\">\n                        {issue.value.substring(0, 200)}{issue.value.length > 200 && '...'}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              <Alert className=\"mt-6 bg-blue-50 border-blue-200\">\n                <AlertDescription className=\"text-blue-900\">\n                  <strong>What to do:</strong>\n                  <ol className=\"list-decimal list-inside mt-2 space-y-1\">\n                    <li>Copy the problematic Booking IDs above</li>\n                    <li>Go to Base44 Dashboard ‚Üí Data ‚Üí Booking</li>\n                    <li>Search for each booking by ID</li>\n                    <li>Either fix the malformed data or delete the record</li>\n                  </ol>\n                </AlertDescription>\n              </Alert>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingFlow.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":11,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":33,"fix":{"range":[584,591],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[583,590],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AdditionalServicesSelector' is defined but never used.","line":16,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":34,"fix":{"range":[943,1034],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AdditionalServicesSelector"},"fix":{"range":[950,982],"text":""},"desc":"Remove unused variable 'AdditionalServicesSelector'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { rateLimiter, RateLimitPresets } from '@/lib/rateLimiter';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Calendar, MapPin, Clock, DollarSign, User, CheckCircle, ArrowRight, ArrowLeft, Loader2 } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport TaskSelector from '../components/booking/TaskSelector';\nimport CalendarBooking from '../components/booking/CalendarBooking';\nimport AddressAutocomplete from '../components/address/AddressAutocomplete';\nimport AdditionalServicesSelector from '../components/booking/AdditionalServicesSelector';\nimport BundleOffers from '../components/booking/BundleOffers';\nimport InsufficientCreditsDialog from '../components/booking/InsufficientCreditsDialog';\nimport StickyPriceSummary from '../components/booking/StickyPriceSummary';\nimport AutoSaveIndicator from '../components/booking/AutoSaveIndicator';\nimport ValidationMessage from '../components/booking/ValidationMessage';\nimport CopyLastBookingButton from '../components/booking/CopyLastBookingButton';\nimport { creditsToUSD } from '../components/credits/CreditCalculator';\nimport { toast } from 'sonner';\n\nconst STEPS = ['Service', 'Date & Time', 'Details', 'Review'];\n\nexport default function BookingFlow() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const cleanerEmail = searchParams.get('cleaner');\n\n  const [currentStep, setCurrentStep] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [cleaner, setCleaner] = useState(null);\n  const [user, setUser] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [showInsufficientCredits, setShowInsufficientCredits] = useState(false);\n  const [appliedBundle, setAppliedBundle] = useState(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [lastSaved, setLastSaved] = useState(null);\n  const [validationErrors, setValidationErrors] = useState({});\n\n  const [bookingData, setBookingData] = useState({\n    cleaning_type: '',\n    date: '',\n    start_time: '',\n    hours: 3,\n    address: '',\n    latitude: null,\n    longitude: null,\n    bedrooms: 2,\n    bathrooms: 2,\n    square_feet: 1200,\n    home_type: 'apartment',\n    has_pets: false,\n    parking_instructions: '',\n    entry_instructions: '',\n    product_preferences: '',\n    product_allergies: '',\n    additional_services: {}\n  });\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  // Auto-save functionality\n  useEffect(() => {\n    const saveTimer = setTimeout(() => {\n      if (user && bookingData.cleaning_type) {\n        setIsSaving(true);\n        localStorage.setItem('bookingDraft', JSON.stringify({\n          ...bookingData,\n          cleanerEmail,\n          lastSaved: new Date().toISOString()\n        }));\n        setTimeout(() => {\n          setIsSaving(false);\n          setLastSaved(new Date());\n        }, 300);\n      }\n    }, 1000); // Auto-save 1 second after last change\n\n    return () => clearTimeout(saveTimer);\n  }, [bookingData, user, cleanerEmail]);\n\n  useEffect(() => {\n    // Load bookingDraft when component mounts or when returning to this page\n    const loadDraft = () => {\n      const draftStr = localStorage.getItem('bookingDraft');\n      if (draftStr) {\n        const draft = JSON.parse(draftStr);\n        setBookingData(prev => ({\n          ...prev,\n          ...draft,\n          cleanerEmail: undefined // Remove this field\n        }));\n        // Start at step 1 (Date & Time) after returning from add-ons\n        if (draft.cleaning_type && draft.additional_services && !draft.date) {\n          setCurrentStep(1);\n        }\n      }\n    };\n    \n    loadDraft();\n    \n    // Also reload when window gains focus (user returns from another page)\n    window.addEventListener('focus', loadDraft);\n    return () => window.removeEventListener('focus', loadDraft);\n  }, [location]);\n\n  const loadData = async () => {\n    try {\n      if (!cleanerEmail) {\n        navigate(createPageUrl('BrowseCleaners'));\n        return;\n      }\n\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'client') {\n        navigate(createPageUrl('RoleSelection'));\n        return;\n      }\n      setUser(currentUser);\n\n      const profiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        setClientProfile(profiles[0]);\n        if (profiles[0].default_address) {\n          setBookingData(prev => ({ ...prev, address: profiles[0].default_address }));\n        }\n      }\n\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n      if (cleanerProfiles.length > 0) {\n        setCleaner(cleanerProfiles[0]);\n      } else {\n        navigate(createPageUrl('BrowseCleaners'));\n        return;\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading booking data:', showToast: false });\n      toast.error('Failed to load booking data');\n    }\n    setLoading(false);\n  };\n\n  const calculateEstimate = () => {\n    if (!bookingData.cleaning_type || !bookingData.hours || !cleaner) {\n      return { credits: 0, usd: 0, baseRate: 0, addonRate: 0, totalRate: 0, additionalServicesCredits: 0, bundleDiscount: 0, finalCredits: 0, hourlyCredits: 0, finalUSD: 0 };\n    }\n\n    const baseRate = cleaner.base_rate_credits_per_hour || 25;\n    let addonRate = 0;\n\n    if (bookingData.cleaning_type === 'deep') {\n      addonRate = cleaner.deep_addon_credits_per_hour || 30;\n    } else if (bookingData.cleaning_type === 'moveout') {\n      addonRate = cleaner.moveout_addon_credits_per_hour || 50;\n    }\n\n    const totalRate = baseRate + addonRate;\n    const hourlyCredits = totalRate * bookingData.hours;\n\n    let additionalServicesCredits = 0;\n    if (bookingData.additional_services && Object.keys(bookingData.additional_services).length > 0) {\n      Object.keys(bookingData.additional_services).forEach(serviceKey => {\n        const quantity = bookingData.additional_services[serviceKey];\n        if (quantity > 0) {\n          const price = cleaner?.additional_service_pricing?.[serviceKey] || 0;\n          additionalServicesCredits += quantity * price;\n        }\n      });\n    }\n\n    const subtotalCredits = hourlyCredits + additionalServicesCredits;\n    const bundleDiscount = appliedBundle?.discountCredits || 0;\n    const finalCredits = Math.max(0, subtotalCredits - bundleDiscount);\n\n    return {\n      credits: Math.round(subtotalCredits),\n      usd: creditsToUSD(subtotalCredits),\n      baseRate,\n      addonRate,\n      totalRate,\n      hourlyCredits: Math.round(hourlyCredits),\n      additionalServicesCredits: Math.round(additionalServicesCredits),\n      bundleDiscount: Math.round(bundleDiscount),\n      finalCredits: Math.round(finalCredits),\n      finalUSD: creditsToUSD(finalCredits)\n    };\n  };\n\n  const validateStep = () => {\n    const errors = {};\n    \n    switch (currentStep) {\n      case 0:\n        if (!bookingData.cleaning_type) {\n          errors.cleaning_type = 'Please select a cleaning type';\n        }\n        break;\n      case 1:\n        if (!bookingData.date) {\n          errors.date = 'Please select a date';\n        }\n        if (!bookingData.start_time) {\n          errors.start_time = 'Please select a time';\n        }\n        break;\n      case 2:\n        if (!bookingData.address) {\n          errors.address = 'Address is required';\n        }\n        if (!bookingData.hours || bookingData.hours < 2) {\n          errors.hours = 'Minimum 2 hours required';\n        }\n        break;\n      case 3:\n        break;\n      default:\n        break;\n    }\n    \n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const canProceed = () => {\n    switch (currentStep) {\n      case 0:\n        return bookingData.cleaning_type !== '';\n      case 1:\n        return bookingData.date && bookingData.start_time;\n      case 2:\n        return bookingData.address && bookingData.hours > 0;\n      case 3:\n        return true;\n      default:\n        return false;\n    }\n  };\n\n  const handleNext = () => {\n    if (!validateStep()) {\n      toast.error('Please fill in all required fields');\n      return;\n    }\n    \n    if (canProceed()) {\n      if (currentStep === 0) {\n        // After selecting cleaning type, go to BookingAddOns page\n        localStorage.setItem('bookingDraft', JSON.stringify({\n          ...bookingData,\n          cleanerEmail\n        }));\n        navigate(createPageUrl(`BookingAddOns?cleaner=${cleanerEmail}`));\n      } else if (currentStep < STEPS.length - 1) {\n        setCurrentStep(currentStep + 1);\n        setValidationErrors({});\n        window.scrollTo({ top: 0, behavior: 'smooth' });\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 0) {\n      setCurrentStep(currentStep - 1);\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  const handleSubmit = async () => {\n    const estimate = calculateEstimate();\n    const clientBalance = clientProfile?.credits_balance || 0;\n\n    if (clientBalance < estimate.finalCredits) {\n      setShowInsufficientCredits(true);\n      return;\n    }\n\n    setSubmitting(true);\n    try {\n      // Apply rate limiting (3 attempts per minute)\n      await rateLimiter.attempt(\n        `booking:${user.email}`,\n        async () => {\n          const newBooking = await base44.entities.Booking.create({\n            client_email: user.email,\n            cleaner_email: cleanerEmail,\n            cleaning_type: bookingData.cleaning_type,\n            date: bookingData.date,\n            start_time: bookingData.start_time,\n            hours: bookingData.hours,\n            estimated_hours: bookingData.hours,\n            address: bookingData.address,\n            latitude: bookingData.latitude,\n            longitude: bookingData.longitude,\n            bedrooms: bookingData.bedrooms,\n            bathrooms: bookingData.bathrooms,\n            square_feet: bookingData.square_feet,\n            home_type: bookingData.home_type,\n            has_pets: bookingData.has_pets,\n            parking_instructions: bookingData.parking_instructions,\n            entry_instructions: bookingData.entry_instructions,\n            product_preferences: bookingData.product_preferences,\n            product_allergies: bookingData.product_allergies,\n            additional_services: bookingData.additional_services,\n            additional_services_cost_credits: estimate.additionalServicesCredits,\n            snapshot_additional_service_prices: cleaner.additional_service_pricing || {},\n            total_price: estimate.finalUSD,\n            snapshot_base_rate_cph: estimate.baseRate,\n            snapshot_selected_addon_cph: estimate.addonRate,\n            snapshot_total_rate_cph: estimate.totalRate,\n            escrow_credits_reserved: estimate.finalCredits,\n            payout_percentage_at_accept: cleaner.payout_percentage || 0.80,\n            status: 'created'\n          });\n\n          navigate(createPageUrl(`PaymentCheckout?booking=${newBooking.id}`));\n        },\n        {\n          ...RateLimitPresets.BOOKING,\n          onRateLimited: (result) => {\n            toast.error(`Too many booking attempts. Please wait ${result.retryAfter} seconds before trying again.`);\n          }\n        }\n      );\n    } catch (error) {\n      if (error.rateLimitInfo) {\n        // Already handled by onRateLimited callback\n        return;\n      }\n      handleError(error, {\n        userMessage: 'Failed to create booking',\n        context: { page: 'BookingFlow' }\n      });\n      toast.error('Failed to create booking');\n    }\n    setSubmitting(false);\n  };\n\n  const estimate = calculateEstimate();\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"lg:grid lg:grid-cols-3 lg:gap-8\">\n          {/* Main Content - Left Side */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            <div className=\"mb-8\">\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Book Your Cleaning</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">Complete your booking with {cleaner?.full_name}</p>\n            </div>\n\n            <Card className=\"mb-8 border-0 shadow-lg rounded-2xl overflow-hidden\">\n              <div className=\"bg-gradient-to-r from-blue-600 to-cyan-500 p-6\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  {STEPS.map((step, idx) => (\n                    <div key={idx} className=\"flex items-center flex-1\">\n                      <div className={`flex items-center justify-center w-10 h-10 rounded-full font-fredoka font-bold transition-all ${\n                        idx <= currentStep ? 'bg-white text-blue-600 shadow-lg' : 'bg-white/20 text-white/60'\n                      }`}>\n                        {idx < currentStep ? <CheckCircle className=\"w-6 h-6\" /> : idx + 1}\n                      </div>\n                      {idx < STEPS.length - 1 && (\n                        <div className={`flex-1 h-1 mx-2 transition-all ${\n                          idx < currentStep ? 'bg-white' : 'bg-white/20'\n                        }`} />\n                      )}\n                    </div>\n                  ))}\n                </div>\n                <div className=\"flex justify-between\">\n                  {STEPS.map((step, idx) => (\n                    <p key={idx} className={`text-sm font-fredoka transition-all ${\n                      idx <= currentStep ? 'text-white font-semibold' : 'text-white/60'\n                    }`}>\n                      {step}\n                    </p>\n                  ))}\n                </div>\n              </div>\n            </Card>\n\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={currentStep}\n                initial={{ opacity: 0, x: 20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: -20 }}\n                transition={{ duration: 0.3 }}\n              >\n                {currentStep === 0 && (\n                  <Card className=\"mb-8 border-0 shadow-lg rounded-2xl\">\n                    <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n                      <CardTitle className=\"font-fredoka text-graphite\">Select Cleaning Type</CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"p-6\">\n                      <TaskSelector\n                        selectedType={bookingData.cleaning_type}\n                        onSelectType={(type) => setBookingData(prev => ({ ...prev, cleaning_type: type }))}\n                        cleaner={cleaner}\n                      />\n                      <ValidationMessage show={validationErrors.cleaning_type} message={validationErrors.cleaning_type} />\n                    </CardContent>\n                  </Card>\n                )}\n\n                {currentStep === 1 && (\n                  <div className=\"mb-8\">\n                    <CalendarBooking\n                      cleaner={cleaner}\n                      selectedDate={bookingData.date}\n                      selectedTime={bookingData.start_time}\n                      onDateSelect={(date) => setBookingData(prev => ({ ...prev, date }))}\n                      onTimeSelect={(time) => setBookingData(prev => ({ ...prev, start_time: time }))}\n                    />\n                    <ValidationMessage show={validationErrors.date} message={validationErrors.date} />\n                    <ValidationMessage show={validationErrors.start_time} message={validationErrors.start_time} />\n                  </div>\n                )}\n\n                {currentStep === 2 && (\n                  <div className=\"space-y-6\">\n                    <Card className=\"border-0 shadow-lg rounded-2xl\">\n                      <CardHeader className=\"rounded-t-2xl bg-gradient-to-r from-blue-600 to-cyan-500\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <CardTitle className=\"font-fredoka text-white text-2xl\">Essential Details</CardTitle>\n                            <p className=\"text-white/90 font-verdana text-sm mt-1\">Property basics and timing</p>\n                          </div>\n                          {user && (\n                            <CopyLastBookingButton\n                              userEmail={user.email}\n                              onCopy={(data) => setBookingData(prev => ({ ...prev, ...data }))}\n                            />\n                          )}\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"p-6 space-y-4\">\n                        <div className=\"grid md:grid-cols-2 gap-4\">\n                          <div>\n                            <AddressAutocomplete\n                              value={bookingData.address}\n                              onChange={(address) => {\n                                setBookingData(prev => ({\n                                  ...prev,\n                                  address,\n                                  latitude: null,\n                                  longitude: null\n                                }));\n                              }}\n                              onLocationSelect={(location) => {\n                                setBookingData(prev => ({\n                                  ...prev,\n                                  address: location.address,\n                                  latitude: location.latitude,\n                                  longitude: location.longitude\n                                }));\n                              }}\n                              placeholder=\"Start typing your address...\"\n                              label=\"Address *\"\n                              required\n                            />\n                            {bookingData.latitude && bookingData.longitude && (\n                              <div className=\"flex items-center gap-2 text-sm text-green-600 font-verdana mt-2\">\n                                <CheckCircle className=\"w-4 h-4\" />\n                                Address verified ‚úì\n                              </div>\n                            )}\n                            <ValidationMessage show={validationErrors.address} message={validationErrors.address} />\n                          </div>\n\n                          <div>\n                            <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">Estimated Hours</label>\n                            <select\n                              value={bookingData.hours}\n                              onChange={(e) => setBookingData(prev => ({ ...prev, hours: parseInt(e.target.value) }))}\n                              className=\"w-full border border-gray-300 rounded-xl px-4 py-2 font-verdana focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                            >\n                              {[2, 3, 4, 5, 6, 8].map(h => (\n                                <option key={h} value={h}>{h} hours</option>\n                              ))}\n                            </select>\n                          </div>\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">Home Type</label>\n                          <select\n                            value={bookingData.home_type}\n                            onChange={(e) => setBookingData(prev => ({ ...prev, home_type: e.target.value }))}\n                            className=\"w-full border border-gray-300 rounded-xl px-4 py-2 font-verdana focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          >\n                            <option value=\"apartment\">Apartment</option>\n                            <option value=\"house\">House</option>\n                            <option value=\"condo\">Condo</option>\n                            <option value=\"townhouse\">Townhouse</option>\n                            <option value=\"office\">Office</option>\n                          </select>\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">Bedrooms</label>\n                          <div className=\"flex gap-2 flex-wrap\">\n                            {[1, 2, 3, 4, 5, 6, 7].map(n => (\n                              <button\n                                key={n}\n                                type=\"button\"\n                                onClick={() => setBookingData(prev => ({ ...prev, bedrooms: n }))}\n                                className={`px-4 py-2 rounded-full font-fredoka font-semibold transition-all ${\n                                  bookingData.bedrooms === n\n                                    ? 'bg-puretask-blue text-white shadow-lg'\n                                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                                }`}\n                              >\n                                {n}\n                              </button>\n                            ))}\n                          </div>\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">Bathrooms</label>\n                          <div className=\"flex gap-2 flex-wrap\">\n                            {[1, 2, 3, 4, 5, 6, 7].map(n => (\n                              <button\n                                key={n}\n                                type=\"button\"\n                                onClick={() => setBookingData(prev => ({ ...prev, bathrooms: n }))}\n                                className={`px-4 py-2 rounded-full font-fredoka font-semibold transition-all ${\n                                  bookingData.bathrooms === n\n                                    ? 'bg-puretask-blue text-white shadow-lg'\n                                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                                }`}\n                              >\n                                {n}\n                              </button>\n                            ))}\n                          </div>\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">Square Feet</label>\n                          <select\n                            value={bookingData.square_feet}\n                            onChange={(e) => setBookingData(prev => ({ ...prev, square_feet: parseInt(e.target.value) }))}\n                            className=\"w-full border border-gray-300 rounded-xl px-4 py-2 font-verdana focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          >\n                            <option value=\"500\">500 sq ft</option>\n                            <option value=\"750\">750 sq ft</option>\n                            <option value=\"1000\">1,000 sq ft</option>\n                            <option value=\"1200\">1,200 sq ft</option>\n                            <option value=\"1500\">1,500 sq ft</option>\n                            <option value=\"1800\">1,800 sq ft</option>\n                            <option value=\"2000\">2,000 sq ft</option>\n                            <option value=\"2500\">2,500 sq ft</option>\n                            <option value=\"3000\">3,000 sq ft</option>\n                            <option value=\"3500\">3,500 sq ft</option>\n                            <option value=\"4000\">4,000 sq ft</option>\n                            <option value=\"5000\">5,000+ sq ft</option>\n                          </select>\n                        </div>\n\n                        <div className=\"bg-blue-50 rounded-xl p-4\">\n                          <label className=\"flex items-center gap-3 cursor-pointer\">\n                            <input\n                              type=\"checkbox\"\n                              checked={bookingData.has_pets}\n                              onChange={(e) => setBookingData(prev => ({ ...prev, has_pets: e.target.checked }))}\n                              className=\"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                            />\n                            <span className=\"text-sm font-fredoka font-medium text-graphite\">üêæ I have pets</span>\n                          </label>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    {/* Optional Details - Collapsible */}\n                    <Card className=\"border-0 shadow-lg rounded-2xl\">\n                      <CardHeader \n                        className=\"rounded-t-2xl bg-gradient-to-r from-purple-50 to-pink-50 cursor-pointer hover:from-purple-100 hover:to-pink-100 transition-colors\"\n                        onClick={() => setBookingData(prev => ({ ...prev, showOptional: !prev.showOptional }))}\n                      >\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <CardTitle className=\"font-fredoka text-graphite\">Access & Preferences</CardTitle>\n                            <p className=\"text-sm text-gray-600 font-verdana mt-1\">Optional details (click to expand)</p>\n                          </div>\n                          <motion.div\n                            animate={{ rotate: bookingData.showOptional ? 180 : 0 }}\n                            transition={{ duration: 0.3 }}\n                          >\n                            <ArrowRight className=\"w-6 h-6 text-gray-400 transform rotate-90\" />\n                          </motion.div>\n                        </div>\n                      </CardHeader>\n                      <AnimatePresence>\n                        {bookingData.showOptional && (\n                          <motion.div\n                            initial={{ height: 0, opacity: 0 }}\n                            animate={{ height: 'auto', opacity: 1 }}\n                            exit={{ height: 0, opacity: 0 }}\n                            transition={{ duration: 0.3 }}\n                          >\n                            <CardContent className=\"p-6 space-y-4\">\n                              <div>\n                                <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">\n                                  üÖøÔ∏è Parking Instructions\n                                </label>\n                                <textarea\n                                  value={bookingData.parking_instructions}\n                                  onChange={(e) => setBookingData(prev => ({ ...prev, parking_instructions: e.target.value }))}\n                                  className=\"w-full border border-gray-300 rounded-xl px-4 py-3 font-verdana focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"\n                                  rows=\"2\"\n                                  placeholder=\"e.g., Street parking in front, guest parking in lot B...\"\n                                />\n                              </div>\n\n                              <div>\n                                <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">\n                                  üö™ Entry Instructions\n                                </label>\n                                <textarea\n                                  value={bookingData.entry_instructions}\n                                  onChange={(e) => setBookingData(prev => ({ ...prev, entry_instructions: e.target.value }))}\n                                  className=\"w-full border border-gray-300 rounded-xl px-4 py-3 font-verdana focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"\n                                  rows=\"2\"\n                                  placeholder=\"e.g., Key under mat, ring doorbell, lockbox code 1234...\"\n                                />\n                              </div>\n\n                              <div>\n                                <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">\n                                  üß¥ Product Preferences\n                                </label>\n                                <textarea\n                                  value={bookingData.product_preferences}\n                                  onChange={(e) => setBookingData(prev => ({ ...prev, product_preferences: e.target.value }))}\n                                  className=\"w-full border border-gray-300 rounded-xl px-4 py-3 font-verdana focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"\n                                  rows=\"2\"\n                                  placeholder=\"e.g., Please use eco-friendly products, avoid strong scents...\"\n                                />\n                              </div>\n\n                              <div>\n                                <label className=\"block text-sm font-fredoka font-medium text-graphite mb-2\">\n                                  ‚ö†Ô∏è Allergies\n                                </label>\n                                <textarea\n                                  value={bookingData.product_allergies}\n                                  onChange={(e) => setBookingData(prev => ({ ...prev, product_allergies: e.target.value }))}\n                                  className=\"w-full border border-gray-300 rounded-xl px-4 py-3 font-verdana focus:ring-2 focus:ring-purple-500 focus:border-purple-500\"\n                                  rows=\"2\"\n                                  placeholder=\"e.g., Allergic to bleach, ammonia...\"\n                                />\n                              </div>\n                            </CardContent>\n                          </motion.div>\n                        )}\n                      </AnimatePresence>\n                    </Card>\n                  </div>\n                )}\n\n                {currentStep === 3 && (\n                  <div className=\"space-y-6\">\n                <Card className=\"mb-8 border-0 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(to right, #0095FF, #00D4FF)' }}>\n                    <CardTitle className=\"font-fredoka text-white\">Review & Confirm</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6 space-y-6\">\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-start gap-3 p-5 rounded-2xl border-2 border-puretask-blue shadow-md\" style={{ background: 'linear-gradient(to right, rgba(0, 149, 255, 0.1), rgba(0, 212, 255, 0.1))' }}>\n                        <User className=\"w-6 h-6 text-puretask-blue mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite text-lg\">Cleaner</p>\n                          <p className=\"text-graphite font-verdana font-semibold text-base\">{cleaner?.full_name}</p>\n                          <Badge className={`mt-2 ${\n                            cleaner?.tier === 'Elite' ? 'bg-amber-100 text-amber-700' :\n                            cleaner?.tier === 'Pro' ? 'bg-blue-100 text-puretask-blue' :\n                            'bg-gray-100 text-gray-700'\n                          } border rounded-full font-fredoka`}>\n                            {cleaner?.tier}\n                          </Badge>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3 p-5 rounded-2xl border-2 border-puretask-blue shadow-md\" style={{ background: 'linear-gradient(to right, rgba(0, 149, 255, 0.1), rgba(0, 212, 255, 0.1))' }}>\n                        <CheckCircle className=\"w-6 h-6 text-puretask-blue mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite text-lg\">Service</p>\n                          <p className=\"text-graphite font-verdana font-semibold text-base capitalize\">{bookingData.cleaning_type} Cleaning</p>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3 p-5 rounded-2xl border-2 border-puretask-blue shadow-md\" style={{ background: 'linear-gradient(to right, rgba(0, 149, 255, 0.1), rgba(0, 212, 255, 0.1))' }}>\n                        <Calendar className=\"w-6 h-6 text-puretask-blue mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite text-lg\">Date & Time</p>\n                          <p className=\"text-graphite font-verdana font-semibold\">\n                            {new Date(bookingData.date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\n                          </p>\n                          <p className=\"text-graphite font-verdana font-semibold\">{bookingData.start_time} ‚Ä¢ {bookingData.hours} hours (estimated)</p>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3 p-6 rounded-2xl border-4 shadow-lg\" style={{ borderColor: '#0095FF', background: 'linear-gradient(to right, rgba(0, 149, 255, 0.15), rgba(0, 212, 255, 0.15))' }}>\n                        <MapPin className=\"w-7 h-7 text-puretask-blue mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite text-xl mb-1\">Address</p>\n                          <p className=\"text-graphite font-verdana font-semibold text-base\">{bookingData.address}</p>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3 p-4 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl border-2 border-purple-200\">\n                        <DollarSign className=\"w-5 h-5 text-purple-600 mt-1\" />\n                        <div className=\"flex-1\">\n                          <p className=\"font-fredoka font-semibold text-graphite mb-2\">Total Estimate</p>\n                          {estimate.bundleDiscount > 0 && (\n                            <div className=\"mb-3 p-3 bg-green-100 border border-green-300 rounded-xl\">\n                              <p className=\"text-sm font-fredoka font-semibold text-green-800 mb-1\">\n                                üéâ Bundle Discount Applied!\n                              </p>\n                              <div className=\"flex justify-between items-center text-sm\">\n                                <span className=\"text-gray-600 font-verdana\">Original:</span>\n                                <span className=\"text-gray-500 line-through font-verdana\">{estimate.credits} credits</span>\n                              </div>\n                              <div className=\"flex justify-between items-center text-sm\">\n                                <span className=\"text-gray-600 font-verdana\">Discount:</span>\n                                <span className=\"text-green-700 font-fredoka font-bold\">-{estimate.bundleDiscount} credits</span>\n                              </div>\n                            </div>\n                          )}\n                          \n                          <div className=\"flex items-baseline gap-2\">\n                            <p className=\"text-4xl font-fredoka font-bold text-purple-600\">{estimate.finalCredits}</p>\n                            <p className=\"text-gray-600 font-verdana\">credits</p>\n                          </div>\n                          <p className=\"text-sm text-gray-600 font-verdana mt-1\">‚âà ${estimate.finalUSD.toFixed(2)}</p>\n                          \n                          <div className=\"mt-3 space-y-1 text-sm font-verdana\">\n                            <div className=\"flex justify-between text-gray-600\">\n                              <span>Base rate:</span>\n                              <span>{estimate.baseRate} credits/hr</span>\n                            </div>\n                            {estimate.addonRate > 0 && (\n                              <div className=\"flex justify-between text-gray-600\">\n                                <span>Service add-on:</span>\n                                <span>+{estimate.addonRate} credits/hr</span>\n                              </div>\n                            )}\n                            <div className=\"flex justify-between text-gray-600\">\n                              <span>Hourly charges ({bookingData.hours}h):</span>\n                              <span>{estimate.hourlyCredits} credits</span>\n                            </div>\n                            \n                            {bookingData.additional_services && Object.keys(bookingData.additional_services).length > 0 && (\n                              <div className=\"mt-2 pt-2 border-t border-gray-200\">\n                                <p className=\"text-gray-700 font-semibold mb-1\">Add-On Services:</p>\n                                {Object.keys(bookingData.additional_services)\n                                  .filter(serviceKey => bookingData.additional_services[serviceKey] > 0)\n                                  .map(serviceKey => {\n                                    const quantity = bookingData.additional_services[serviceKey];\n                                    const price = cleaner?.additional_service_pricing?.[serviceKey] || 0;\n                                    const serviceNames = {\n                                      windows: 'Windows',\n                                      blinds: 'Blinds',\n                                      oven: 'Oven',\n                                      refrigerator: 'Refrigerator',\n                                      light_fixtures: 'Light Fixtures',\n                                      inside_cabinets: 'Inside Cabinets',\n                                      baseboards: 'Baseboards',\n                                      laundry: 'Laundry'\n                                    };\n                                    const lineTotal = price * quantity;\n                                    return (\n                                      <div key={serviceKey} className=\"flex justify-between text-gray-600 text-xs ml-2\">\n                                        <span>{serviceNames[serviceKey]} x{quantity} @ {price} credits</span>\n                                        <span className=\"font-semibold\">+{lineTotal} credits</span>\n                                      </div>\n                                    );\n                                  })}\n                                <div className=\"flex justify-between text-gray-700 font-semibold mt-1\">\n                                  <span>Add-ons subtotal:</span>\n                                  <span>+{estimate.additionalServicesCredits} credits</span>\n                                </div>\n                              </div>\n                            )}\n                            \n                            {estimate.bundleDiscount > 0 && (\n                              <div className=\"flex justify-between text-green-700 font-semibold\">\n                                <span>Bundle discount:</span>\n                                <span>-{estimate.bundleDiscount} credits</span>\n                              </div>\n                            )}\n                            <div className=\"flex justify-between font-fredoka font-semibold text-graphite pt-2 border-t border-gray-300\">\n                              <span>Total:</span>\n                              <span>{estimate.finalCredits} credits</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n                      <AlertDescription className=\"text-sm text-blue-900 font-verdana\">\n                        Your payment will be held in escrow until you approve the completed work. \n                        You'll be charged for actual hours worked (calculated from clock-in/out times) plus selected additional services.\n                      </AlertDescription>\n                    </Alert>\n                  </CardContent>\n                </Card>\n\n                    <BundleOffers\n                      bookingData={bookingData}\n                      totalCredits={estimate.credits}\n                      onApplyBundle={setAppliedBundle}\n                    />\n                  </div>\n                )}\n              </motion.div>\n            </AnimatePresence>\n\n            <div className=\"flex justify-between gap-4\">\n              <Button\n                onClick={handleBack}\n                disabled={currentStep === 0 || submitting}\n                variant=\"outline\"\n                size=\"lg\"\n                className=\"rounded-full font-fredoka font-semibold\"\n              >\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                Back\n              </Button>\n\n              {currentStep < STEPS.length - 1 ? (\n                <Button\n                  onClick={handleNext}\n                  disabled={!canProceed()}\n                  size=\"lg\"\n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold shadow-lg hover:shadow-xl transition-shadow\"\n                >\n                  Continue\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\n                </Button>\n              ) : (\n                <Button\n                  onClick={handleSubmit}\n                  disabled={submitting}\n                  size=\"lg\"\n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold shadow-lg hover:shadow-xl transition-shadow\"\n                >\n                  {submitting ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                      Submitting...\n                    </>\n                  ) : (\n                    <>\n                      Continue to Payment\n                      <ArrowRight className=\"w-4 h-4 ml-2\" />\n                    </>\n                  )}\n                </Button>\n              )}\n            </div>\n          </div>\n\n          {/* Sticky Price Summary - Right Side */}\n          <div className=\"hidden lg:block lg:col-span-1\">\n            <StickyPriceSummary\n              estimate={estimate}\n              bookingData={bookingData}\n              cleaner={cleaner}\n              showWarning={clientProfile && clientProfile.credits_balance < estimate.finalCredits}\n            />\n          </div>\n        </div>\n      </div>\n\n      <InsufficientCreditsDialog\n        open={showInsufficientCredits}\n        onClose={() => setShowInsufficientCredits(false)}\n        required={estimate.finalCredits}\n        current={clientProfile?.credits_balance || 0}\n      />\n\n      <AutoSaveIndicator isSaving={isSaving} lastSaved={lastSaved} />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingHistory.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Filter' is defined but never used.","line":12,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":48,"fix":{"range":[591,599],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[590,598],"text":""},"desc":"Remove unused variable 'Filter'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":13,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":19,"fix":{"range":[623,629],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[622,628],"text":""},"desc":"Remove unused variable 'User'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { \n  Calendar, Clock, MapPin, Star, Search, Filter, Loader2, \n  ArrowRight, User, Droplets, Wind, Package, CheckCircle, \n  AlertCircle, XCircle, Sparkles, TrendingUp \n} from 'lucide-react';\nimport { format, parseISO, isPast, isFuture } from 'date-fns';\nimport { convertTo12Hour } from '../components/utils/timeUtils';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport BookingDetailsModal from '../components/booking/BookingDetailsModal';\n\nexport default function BookingHistory() {\n  const navigate = useNavigate();\n  const [bookings, setBookings] = useState([]);\n  const [filteredBookings, setFilteredBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [timeFilter, setTimeFilter] = useState('all');\n  const [cleanerProfiles, setCleanerProfiles] = useState({});\n  const [reviews, setReviews] = useState({});\n  const [selectedBooking, setSelectedBooking] = useState(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n\n  useEffect(() => {\n    loadBookings();\n  }, []);\n\n  useEffect(() => {\n    applyFilters();\n  }, [searchTerm, statusFilter, timeFilter, bookings]);\n\n  const loadBookings = async () => {\n    try {\n      const user = await base44.auth.me();\n      const userBookings = await base44.entities.Booking.filter({ client_email: user.email }, '-date');\n      setBookings(userBookings);\n\n      // Load cleaner profiles\n      const cleanerEmails = [...new Set(userBookings.map(b => b.cleaner_email).filter(Boolean))];\n      const profiles = {};\n      for (const email of cleanerEmails) {\n        const cleanerProfs = await base44.entities.CleanerProfile.filter({ user_email: email });\n        if (cleanerProfs.length > 0) {\n          profiles[email] = cleanerProfs[0];\n        }\n      }\n      setCleanerProfiles(profiles);\n\n      // Load reviews\n      const reviewsMap = {};\n      for (const booking of userBookings) {\n        const bookingReviews = await base44.entities.Review.filter({ booking_id: booking.id });\n        if (bookingReviews.length > 0) {\n          reviewsMap[booking.id] = bookingReviews[0];\n        }\n      }\n      setReviews(reviewsMap);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading bookings:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const applyFilters = () => {\n    let filtered = [...bookings];\n\n    if (searchTerm) {\n      filtered = filtered.filter(b =>\n        b.address?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        b.cleaner_email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        cleanerProfiles[b.cleaner_email]?.full_name?.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    if (statusFilter !== 'all') {\n      filtered = filtered.filter(b => b.status === statusFilter);\n    }\n\n    if (timeFilter === 'upcoming') {\n      filtered = filtered.filter(b => {\n        const bookingDate = new Date(b.date);\n        return isFuture(bookingDate) || bookingDate.toDateString() === new Date().toDateString();\n      });\n    } else if (timeFilter === 'past') {\n      filtered = filtered.filter(b => {\n        const bookingDate = new Date(b.date);\n        return isPast(bookingDate) && bookingDate.toDateString() !== new Date().toDateString();\n      });\n    }\n\n    setFilteredBookings(filtered);\n  };\n\n  const handleBookingClick = (booking) => {\n    setSelectedBooking(booking);\n    setShowDetailsModal(true);\n  };\n\n  const getStatusBadge = (status) => {\n    const config = {\n      scheduled: { label: 'Scheduled', className: 'bg-blue-100 text-blue-700', icon: Calendar },\n      accepted: { label: 'Accepted', className: 'bg-blue-100 text-blue-700', icon: CheckCircle },\n      on_the_way: { label: 'On The Way', className: 'bg-cyan-100 text-cyan-700', icon: TrendingUp },\n      in_progress: { label: 'In Progress', className: 'bg-amber-100 text-amber-700', icon: Loader2 },\n      awaiting_client: { label: 'Awaiting Review', className: 'bg-purple-100 text-purple-700', icon: Star },\n      completed: { label: 'Completed', className: 'bg-green-100 text-green-700', icon: CheckCircle },\n      approved: { label: 'Approved', className: 'bg-green-100 text-green-700', icon: CheckCircle },\n      cancelled: { label: 'Cancelled', className: 'bg-gray-100 text-gray-600', icon: XCircle },\n      disputed: { label: 'Disputed', className: 'bg-red-100 text-red-700', icon: AlertCircle }\n    };\n    \n    const { label, className, icon: Icon } = config[status] || config.scheduled;\n    return (\n      <Badge className={`${className} rounded-full font-fredoka flex items-center gap-1`}>\n        <Icon className=\"w-3 h-3\" />\n        {label}\n      </Badge>\n    );\n  };\n\n  const getCleaningIcon = (type) => {\n    switch(type) {\n      case 'deep': return <Droplets className=\"w-4 h-4\" />;\n      case 'moveout': return <Package className=\"w-4 h-4\" />;\n      default: return <Wind className=\"w-4 h-4\" />;\n    }\n  };\n\n  const groupBookingsByMonth = (bookings) => {\n    const groups = {};\n    bookings.forEach(booking => {\n      const monthKey = format(parseISO(booking.date), 'MMMM yyyy');\n      if (!groups[monthKey]) {\n        groups[monthKey] = [];\n      }\n      groups[monthKey].push(booking);\n    });\n    return groups;\n  };\n\n  const groupedBookings = groupBookingsByMonth(filteredBookings);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-soft-cloud via-blue-50/30 to-soft-cloud p-4 md:p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Enhanced Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-3 mb-3\">\n            <div className=\"bg-gradient-to-br from-puretask-blue to-cyan-500 p-3 rounded-2xl shadow-lg\">\n              <Calendar className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-4xl md:text-5xl font-fredoka font-bold text-graphite\">Booking History</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">Track all your cleanings in one place</p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-4 mt-4\">\n            <Badge className=\"bg-blue-100 text-blue-700 font-fredoka px-4 py-2 text-base\">\n              {bookings.length} Total Bookings\n            </Badge>\n            <Badge className=\"bg-green-100 text-green-700 font-fredoka px-4 py-2 text-base\">\n              {bookings.filter(b => ['completed', 'approved'].includes(b.status)).length} Completed\n            </Badge>\n          </div>\n        </motion.div>\n\n        {/* Enhanced Filters */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.1 }}\n        >\n          <Card className=\"mb-8 border-0 shadow-xl rounded-3xl bg-white\">\n            <CardContent className=\"p-6\">\n              <div className=\"grid md:grid-cols-3 gap-4\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                  <Input\n                    placeholder=\"Search by address, cleaner...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-12 font-verdana rounded-2xl h-12 border-2\"\n                  />\n                </div>\n                \n                <Select value={timeFilter} onValueChange={setTimeFilter}>\n                  <SelectTrigger className=\"rounded-2xl font-verdana h-12 border-2\">\n                    <SelectValue placeholder=\"Time Period\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Time</SelectItem>\n                    <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                    <SelectItem value=\"past\">Past</SelectItem>\n                  </SelectContent>\n                </Select>\n\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\n                  <SelectTrigger className=\"rounded-2xl font-verdana h-12 border-2\">\n                    <SelectValue placeholder=\"Status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Statuses</SelectItem>\n                    <SelectItem value=\"scheduled\">Scheduled</SelectItem>\n                    <SelectItem value=\"accepted\">Accepted</SelectItem>\n                    <SelectItem value=\"on_the_way\">On The Way</SelectItem>\n                    <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                    <SelectItem value=\"awaiting_client\">Awaiting Review</SelectItem>\n                    <SelectItem value=\"completed\">Completed</SelectItem>\n                    <SelectItem value=\"approved\">Approved</SelectItem>\n                    <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                    <SelectItem value=\"disputed\">Disputed</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Grouped Bookings List */}\n        {filteredBookings.length > 0 ? (\n          <div className=\"space-y-8\">\n            {Object.entries(groupedBookings).map(([month, monthBookings], monthIdx) => (\n              <motion.div\n                key={month}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: monthIdx * 0.1 }}\n              >\n                {/* Month Header */}\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"h-px bg-gradient-to-r from-puretask-blue to-transparent flex-1\"></div>\n                  <h2 className=\"text-xl font-fredoka font-bold text-graphite px-4 py-2 bg-blue-50 rounded-2xl\">\n                    {month}\n                  </h2>\n                  <div className=\"h-px bg-gradient-to-l from-puretask-blue to-transparent flex-1\"></div>\n                </div>\n\n                {/* Month's Bookings */}\n                <div className=\"space-y-4\">\n                  <AnimatePresence>\n                    {monthBookings.map((booking, idx) => {\n                      const cleaner = cleanerProfiles[booking.cleaner_email];\n                      const review = reviews[booking.id];\n                      \n                      return (\n                        <motion.div\n                          key={booking.id}\n                          initial={{ opacity: 0, x: -20 }}\n                          animate={{ opacity: 1, x: 0 }}\n                          exit={{ opacity: 0, x: 20 }}\n                          transition={{ delay: idx * 0.05 }}\n                          whileHover={{ scale: 1.01 }}\n                          whileTap={{ scale: 0.99 }}\n                        >\n                          <Card\n                            className=\"border-0 shadow-lg hover:shadow-2xl transition-all cursor-pointer rounded-3xl overflow-hidden bg-white\"\n                            onClick={() => handleBookingClick(booking)}\n                          >\n                            <CardContent className=\"p-6\">\n                              <div className=\"flex flex-col lg:flex-row gap-6\">\n                                {/* Date Badge */}\n                                <div className=\"flex lg:flex-col items-center lg:items-start gap-4 lg:gap-2\">\n                                  <div className=\"w-20 h-20 bg-gradient-to-br from-puretask-blue to-cyan-500 rounded-2xl flex flex-col items-center justify-center text-white shadow-lg\">\n                                    <span className=\"text-sm font-verdana opacity-90\">\n                                      {format(parseISO(booking.date), 'MMM')}\n                                    </span>\n                                    <span className=\"text-3xl font-fredoka font-bold\">\n                                      {format(parseISO(booking.date), 'd')}\n                                    </span>\n                                  </div>\n                                  <div className=\"lg:hidden flex-1\">\n                                    <p className=\"font-fredoka font-bold text-graphite text-lg\">\n                                      {format(parseISO(booking.date), 'EEEE')}\n                                    </p>\n                                    <div className=\"flex items-center gap-2 text-sm text-gray-600 font-verdana\">\n                                      <Clock className=\"w-4 h-4 text-puretask-blue\" />\n                                      {convertTo12Hour(booking.start_time)}\n                                    </div>\n                                  </div>\n                                </div>\n\n                                {/* Booking Details */}\n                                <div className=\"flex-1 space-y-4\">\n                                  {/* Top Row - Time & Status */}\n                                  <div className=\"hidden lg:flex items-start justify-between\">\n                                    <div>\n                                      <h3 className=\"font-fredoka font-bold text-graphite text-xl mb-1\">\n                                        {format(parseISO(booking.date), 'EEEE, MMMM d')}\n                                      </h3>\n                                      <div className=\"flex items-center gap-3 text-gray-600 font-verdana\">\n                                        <span className=\"flex items-center gap-1\">\n                                          <Clock className=\"w-4 h-4 text-puretask-blue\" />\n                                          {convertTo12Hour(booking.start_time)}\n                                        </span>\n                                        <span>‚Ä¢</span>\n                                        <span>{booking.hours} hours</span>\n                                      </div>\n                                    </div>\n                                    {getStatusBadge(booking.status)}\n                                  </div>\n\n                                  {/* Mobile Status */}\n                                  <div className=\"lg:hidden\">\n                                    {getStatusBadge(booking.status)}\n                                  </div>\n\n                                  {/* Address */}\n                                  <div className=\"flex items-start gap-3 p-3 bg-blue-50 rounded-2xl\">\n                                    <div className=\"bg-white p-2 rounded-xl\">\n                                      <MapPin className=\"w-4 h-4 text-puretask-blue\" />\n                                    </div>\n                                    <div className=\"flex-1\">\n                                      <p className=\"text-xs text-gray-500 font-verdana uppercase mb-1\">Location</p>\n                                      <p className=\"text-sm font-verdana text-graphite font-medium\">{booking.address}</p>\n                                    </div>\n                                  </div>\n\n                                  {/* Cleaner Info */}\n                                  {cleaner && (\n                                    <div className=\"flex items-center gap-3 p-3 bg-purple-50 rounded-2xl\">\n                                      <div className=\"relative\">\n                                        {cleaner.profile_photo_url ? (\n                                          <img \n                                            src={cleaner.profile_photo_url} \n                                            alt={cleaner.full_name}\n                                            className=\"w-12 h-12 rounded-full object-cover border-2 border-white shadow\"\n                                          />\n                                        ) : (\n                                          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-fredoka font-bold text-lg shadow\">\n                                            {cleaner.full_name?.charAt(0) || 'C'}\n                                          </div>\n                                        )}\n                                        {cleaner.admin_verified && (\n                                          <div className=\"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1 border-2 border-white\">\n                                            <CheckCircle className=\"w-3 h-3 text-white\" />\n                                          </div>\n                                        )}\n                                      </div>\n                                      <div className=\"flex-1\">\n                                        <p className=\"text-xs text-gray-500 font-verdana uppercase\">Cleaner</p>\n                                        <p className=\"text-sm font-fredoka font-bold text-graphite\">{cleaner.full_name || cleaner.user_email}</p>\n                                        {cleaner.average_rating && (\n                                          <div className=\"flex items-center gap-1 mt-1\">\n                                            <Star className=\"w-3 h-3 text-amber-500 fill-current\" />\n                                            <span className=\"text-xs font-verdana text-gray-600\">{cleaner.average_rating.toFixed(1)}</span>\n                                          </div>\n                                        )}\n                                      </div>\n                                      <Badge className=\"bg-purple-200 text-purple-700 text-xs font-fredoka border-0\">\n                                        {cleaner.tier || 'Pro'}\n                                      </Badge>\n                                    </div>\n                                  )}\n\n                                  {/* Bottom Row - Tags & Price */}\n                                  <div className=\"flex flex-wrap items-center justify-between gap-3\">\n                                    <div className=\"flex flex-wrap items-center gap-2\">\n                                      <Badge className=\"bg-blue-50 text-blue-700 border border-blue-200 rounded-xl font-fredoka flex items-center gap-1\">\n                                        {getCleaningIcon(booking.cleaning_type)}\n                                        <span className=\"capitalize\">{booking.cleaning_type || 'basic'}</span>\n                                      </Badge>\n                                      {review ? (\n                                        <Badge className=\"bg-amber-50 text-amber-700 border border-amber-200 rounded-xl font-fredoka flex items-center gap-1\">\n                                          <div className=\"flex\">\n                                            {[...Array(5)].map((_, i) => (\n                                              <Star \n                                                key={i} \n                                                className={`w-3 h-3 ${i < review.rating ? 'text-amber-500 fill-current' : 'text-gray-300'}`}\n                                              />\n                                            ))}\n                                          </div>\n                                        </Badge>\n                                      ) : booking.status === 'awaiting_client' && (\n                                        <Badge className=\"bg-purple-100 text-purple-700 rounded-xl font-fredoka flex items-center gap-1 animate-pulse\">\n                                          <Star className=\"w-3 h-3\" />\n                                          Review Now\n                                        </Badge>\n                                      )}\n                                    </div>\n                                    \n                                    <div className=\"flex items-center gap-3\">\n                                      <div className=\"text-right\">\n                                        <p className=\"text-2xl font-fredoka font-bold text-graphite\">\n                                          {Math.round(booking.total_price)}\n                                        </p>\n                                        <p className=\"text-xs text-gray-500 font-verdana\">\n                                          credits (${booking.total_price.toFixed(2)})\n                                        </p>\n                                      </div>\n                                      <ArrowRight className=\"w-5 h-5 text-gray-400\" />\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </CardContent>\n                          </Card>\n                        </motion.div>\n                      );\n                    })}\n                  </AnimatePresence>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n          >\n            <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n              <CardContent className=\"p-16 text-center bg-gradient-to-br from-gray-50 via-blue-50/30 to-gray-50 relative\">\n                <div className=\"absolute inset-0 bg-gradient-to-r from-puretask-blue/5 to-cyan-500/5\"></div>\n                <motion.div\n                  animate={{ y: [0, -10, 0] }}\n                  transition={{ repeat: Infinity, duration: 3, ease: \"easeInOut\" }}\n                  className=\"relative z-10\"\n                >\n                  <Calendar className=\"w-24 h-24 text-puretask-blue mx-auto mb-6 opacity-80\" />\n                </motion.div>\n                <h3 className=\"text-3xl font-fredoka font-bold text-graphite mb-3 relative z-10\">No Bookings Found</h3>\n                <p className=\"text-gray-600 text-lg mb-8 font-verdana relative z-10\">\n                  {searchTerm || statusFilter !== 'all' || timeFilter !== 'all'\n                    ? 'Try adjusting your filters to see more results'\n                    : 'Start your journey to a cleaner home today'}\n                </p>\n                <Button\n                  onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n                  className=\"brand-gradient text-white rounded-2xl font-fredoka font-semibold px-10 h-14 text-lg shadow-xl hover:shadow-2xl transition-all relative z-10\"\n                >\n                  <Search className=\"w-5 h-5 mr-3\" />\n                  Browse Cleaners\n                  <Sparkles className=\"w-5 h-5 ml-3\" />\n                </Button>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Booking Details Modal */}\n        <BookingDetailsModal\n          booking={selectedBooking}\n          open={showDetailsModal}\n          onClose={() => {\n            setShowDetailsModal(false);\n            setSelectedBooking(null);\n          }}\n        />\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingRequest.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":12,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":48,"fix":{"range":[595,601],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[594,600],"text":""},"desc":"Remove unused variable 'User'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'clientProfile' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"clientProfile"},"fix":{"range":[1094,1107],"text":""},"desc":"Remove unused variable 'clientProfile'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sparkles, Send, MapPin, Calendar, Clock, User, DollarSign, \n  CheckCircle, ArrowLeft, Loader2, Star, Info, Home, Package, TrendingUp, Award, Briefcase\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function BookingRequest() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const cleanerEmail = searchParams.get('cleaner');\n\n  const [user, setUser] = useState(null);\n  const [cleaner, setCleaner] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [bookingData, setBookingData] = useState(null);\n  const [addOns, setAddOns] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [specialRequests, setSpecialRequests] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      // Check auth\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('ClientSignup'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load client profile\n      const profiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        setClientProfile(profiles[0]);\n      }\n\n      // Load booking data\n      const savedBooking = localStorage.getItem('bookingDraft');\n      const savedAddOns = localStorage.getItem('bookingAddOns');\n      \n      if (!savedBooking || !cleanerEmail) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n\n      setBookingData(JSON.parse(savedBooking));\n      if (savedAddOns) {\n        setAddOns(JSON.parse(savedAddOns));\n      }\n\n      // Load cleaner profile\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n      if (cleanerProfiles.length === 0) {\n        alert('Cleaner not found');\n        navigate(createPageUrl('MatchedCleaners'));\n        return;\n      }\n      setCleaner(cleanerProfiles[0]);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n    setLoading(false);\n  };\n\n  const calculateTotal = () => {\n    if (!cleaner || !bookingData) return { credits: 0, usd: 0 };\n\n    const baseRate = cleaner.base_rate_credits_per_hour || 300;\n    let addonRate = 0;\n\n    if (bookingData.serviceType === 'deep') {\n      addonRate = cleaner.deep_addon_credits_per_hour || 50;\n    } else if (bookingData.serviceType === 'moveout') {\n      addonRate = cleaner.moveout_addon_credits_per_hour || 50;\n    }\n\n    const hourlyTotal = (baseRate + addonRate) * bookingData.recommendedHours;\n    \n    // Calculate add-ons (using cleaner's pricing if available)\n    let addOnsTotal = 0;\n    if (cleaner.additional_service_pricing) {\n      Object.keys(addOns).forEach(key => {\n        const price = cleaner.additional_service_pricing[key] || 0;\n        addOnsTotal += price * addOns[key];\n      });\n    }\n\n    const totalCredits = hourlyTotal + addOnsTotal;\n    return {\n      credits: Math.round(totalCredits),\n      usd: (totalCredits / 10).toFixed(2),\n      hourlyTotal: Math.round(hourlyTotal),\n      addOnsTotal: Math.round(addOnsTotal)\n    };\n  };\n\n  const handleSubmitRequest = async () => {\n    setSubmitting(true);\n\n    try {\n      const estimate = calculateTotal();\n\n      // Create booking in \"awaiting_cleaner_response\" status\n      const newBooking = await base44.entities.Booking.create({\n        client_email: user.email,\n        cleaner_email: cleanerEmail,\n        cleaning_type: bookingData.serviceType,\n        date: bookingData.date,\n        start_time: bookingData.time,\n        hours: bookingData.recommendedHours,\n        estimated_hours: bookingData.recommendedHours,\n        address: bookingData.address,\n        latitude: bookingData.latitude,\n        longitude: bookingData.longitude,\n        bedrooms: parseInt(bookingData.bedrooms),\n        bathrooms: parseFloat(bookingData.bathrooms),\n        square_feet: bookingData.squareFeet,\n        additional_services: addOns,\n        notes: specialRequests,\n        total_price: parseFloat(estimate.usd),\n        snapshot_base_rate_cph: cleaner.base_rate_credits_per_hour || 300,\n        snapshot_selected_addon_cph: bookingData.serviceType === 'deep' ? (cleaner.deep_addon_credits_per_hour || 50) :\n                                     bookingData.serviceType === 'moveout' ? (cleaner.moveout_addon_credits_per_hour || 50) : 0,\n        snapshot_total_rate_cph: (cleaner.base_rate_credits_per_hour || 300) + \n                                 (bookingData.serviceType === 'deep' ? (cleaner.deep_addon_credits_per_hour || 50) :\n                                  bookingData.serviceType === 'moveout' ? (cleaner.moveout_addon_credits_per_hour || 50) : 0),\n        snapshot_additional_service_prices: cleaner.additional_service_pricing || {},\n        additional_services_cost_credits: estimate.addOnsTotal,\n        escrow_credits_reserved: estimate.credits,\n        payout_percentage_at_accept: cleaner.payout_percentage || 0.80,\n        status: 'awaiting_cleaner_response',\n        request_sent_at: new Date().toISOString(),\n        request_expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString() // 24 hours\n      });\n\n      // Clear localStorage\n      localStorage.removeItem('bookingDraft');\n      localStorage.removeItem('bookingAddOns');\n      localStorage.removeItem('selectedCleaner');\n\n      // Navigate to confirmation page\n      navigate(createPageUrl(`BookingRequestSent?booking=${newBooking.id}`));\n    } catch (error) {\n      handleError(error, { userMessage: 'Error submitting booking request:', showToast: false });\n      alert('Failed to send booking request. Please try again.');\n    }\n    setSubmitting(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-16 h-16 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const estimate = calculateTotal();\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <Button\n            onClick={() => navigate(-1)}\n            variant=\"ghost\"\n            className=\"mb-4 rounded-full font-fredoka\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Cleaners\n          </Button>\n\n          <div className=\"text-center\">\n            <div className=\"flex items-center justify-center gap-3 mb-4\">\n              <div className=\"w-14 h-14 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n                <Send className=\"w-7 h-7 text-white\" />\n              </div>\n            </div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n              Review & Send Request\n            </h1>\n            <p className=\"text-lg text-gray-600 font-verdana\">\n              Confirm your booking details before sending to {cleaner?.full_name}\n            </p>\n          </div>\n        </motion.div>\n\n        {/* Booking Review */}\n        <div className=\"space-y-8\">\n          {/* Cleaner Info - ENHANCED */}\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"border-4 border-puretask-blue shadow-2xl rounded-3xl overflow-hidden bg-gradient-to-br from-blue-50 to-cyan-50\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-600 to-cyan-600 text-white pb-8\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                  <Award className=\"w-8 h-8\" />\n                  Your Selected Cleaner\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-8\">\n                <div className=\"flex flex-col md:flex-row items-center md:items-start gap-6 mb-6\">\n                  {cleaner?.profile_photo_url ? (\n                    <img \n                      src={cleaner.profile_photo_url} \n                      alt={cleaner.full_name} \n                      className=\"w-32 h-32 rounded-2xl object-cover shadow-xl border-4 border-white ring-4 ring-puretask-blue\" \n                    />\n                  ) : (\n                    <div className=\"w-32 h-32 brand-gradient rounded-2xl flex items-center justify-center shadow-xl border-4 border-white ring-4 ring-puretask-blue\">\n                      <span className=\"text-5xl text-white font-fredoka font-bold\">{cleaner?.full_name?.[0] || 'C'}</span>\n                    </div>\n                  )}\n                  <div className=\"flex-1 text-center md:text-left\">\n                    <h3 className=\"font-fredoka font-bold text-3xl text-graphite mb-3\">{cleaner?.full_name}</h3>\n                    <div className=\"flex flex-wrap items-center justify-center md:justify-start gap-3 mb-4\">\n                      <Badge className=\"rounded-full font-fredoka text-base px-4 py-2 shadow-lg\" style={{\n                        background: cleaner?.tier === 'Elite' ? 'linear-gradient(135deg, #FBBF24, #F59E0B)' : \n                                   cleaner?.tier === 'Pro' ? 'linear-gradient(135deg, #66B3FF, #00D4FF)' : \n                                   'linear-gradient(135deg, #818CF8, #6366F1)',\n                        color: 'white',\n                        border: '2px solid white'\n                      }}>\n                        {cleaner?.tier === 'Elite' ? 'üëë' : cleaner?.tier === 'Pro' ? '‚≠ê' : 'üí´'} {cleaner?.tier}\n                      </Badge>\n                      <div className=\"flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-md border-2 border-amber-300\">\n                        <Star className=\"w-5 h-5 text-amber-500 fill-amber-500\" />\n                        <span className=\"font-fredoka font-bold text-xl text-graphite\">{cleaner?.average_rating?.toFixed(1) || '5.0'}</span>\n                        <span className=\"text-gray-600 font-verdana\">({cleaner?.total_reviews || 0})</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-md border-2 border-blue-300\">\n                        <Briefcase className=\"w-5 h-5 text-puretask-blue\" />\n                        <span className=\"font-fredoka font-bold text-xl text-puretask-blue\">{cleaner?.total_jobs || 0}</span>\n                        <span className=\"text-gray-600 font-verdana\">jobs</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* RELIABILITY SCORE - HIGHLIGHTED */}\n                <div className=\"bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl p-6 shadow-xl border-4 border-white\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-20 h-20 bg-white rounded-xl flex items-center justify-center shadow-lg\">\n                        <TrendingUp className=\"w-10 h-10 text-green-600\" />\n                      </div>\n                      <div>\n                        <p className=\"text-white font-verdana text-sm mb-1 opacity-90\">Reliability Score</p>\n                        <p className=\"text-6xl font-fredoka font-bold text-white drop-shadow-lg\">\n                          {cleaner?.reliability_score || 85}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"text-2xl font-fredoka font-bold text-white mb-1\">\n                        {cleaner?.reliability_score >= 90 ? 'üåü Outstanding' : \n                         cleaner?.reliability_score >= 75 ? '‚ú® Excellent' : \n                         cleaner?.reliability_score >= 60 ? 'üëç Good' : 'üìà Developing'}\n                      </p>\n                      <p className=\"text-white opacity-90 font-verdana\">Performance Rating</p>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-4 gap-3 mt-4\">\n                    <div className=\"bg-white/20 backdrop-blur rounded-lg p-3 text-center\">\n                      <p className=\"text-2xl font-fredoka font-bold text-white\">{cleaner?.attendance_rate || 100}%</p>\n                      <p className=\"text-xs text-white/90 font-verdana\">Attendance</p>\n                    </div>\n                    <div className=\"bg-white/20 backdrop-blur rounded-lg p-3 text-center\">\n                      <p className=\"text-2xl font-fredoka font-bold text-white\">{cleaner?.punctuality_rate || 100}%</p>\n                      <p className=\"text-xs text-white/90 font-verdana\">On-Time</p>\n                    </div>\n                    <div className=\"bg-white/20 backdrop-blur rounded-lg p-3 text-center\">\n                      <p className=\"text-2xl font-fredoka font-bold text-white\">{cleaner?.photo_compliance_rate || 100}%</p>\n                      <p className=\"text-xs text-white/90 font-verdana\">Photos</p>\n                    </div>\n                    <div className=\"bg-white/20 backdrop-blur rounded-lg p-3 text-center\">\n                      <p className=\"text-2xl font-fredoka font-bold text-white\">{cleaner?.communication_rate || 100}%</p>\n                      <p className=\"text-xs text-white/90 font-verdana\">Response</p>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Booking Details - ENHANCED */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.1 }}\n          >\n            <Card className=\"border-4 border-purple-300 shadow-2xl rounded-3xl overflow-hidden\">\n              <CardHeader className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                  <Sparkles className=\"w-8 h-8\" />\n                  Your Booking Details\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-8 space-y-5\">\n                {/* DATE & TIME - HIGHLIGHTED */}\n                <div className=\"bg-gradient-to-r from-amber-400 to-orange-500 rounded-2xl p-6 shadow-lg border-4 border-white\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-16 h-16 bg-white rounded-xl flex items-center justify-center shadow-md\">\n                      <Calendar className=\"w-8 h-8 text-amber-600\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-white font-verdana text-sm mb-1 opacity-90\">Scheduled For</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-white drop-shadow\">\n                        {new Date(bookingData?.date).toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}\n                      </p>\n                      <div className=\"flex items-center gap-3 mt-2\">\n                        <div className=\"flex items-center gap-2 bg-white/20 backdrop-blur rounded-lg px-3 py-1\">\n                          <Clock className=\"w-4 h-4 text-white\" />\n                          <span className=\"font-fredoka font-bold text-white\">{bookingData?.time}</span>\n                        </div>\n                        <div className=\"bg-white/20 backdrop-blur rounded-lg px-3 py-1\">\n                          <span className=\"font-fredoka font-bold text-white\">{bookingData?.recommendedHours} hours</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"grid md:grid-cols-2 gap-4\">\n                  <div className=\"flex items-start gap-3 p-5 bg-blue-50 rounded-xl border-2 border-blue-200 shadow-md\">\n                    <MapPin className=\"w-6 h-6 text-puretask-blue mt-1 flex-shrink-0\" />\n                    <div>\n                      <p className=\"font-fredoka font-bold text-graphite mb-1\">Address</p>\n                      <p className=\"text-gray-700 font-verdana leading-relaxed\">{bookingData?.address}</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-start gap-3 p-5 bg-purple-50 rounded-xl border-2 border-purple-200 shadow-md\">\n                    <Home className=\"w-6 h-6 text-purple-600 mt-1 flex-shrink-0\" />\n                    <div>\n                      <p className=\"font-fredoka font-bold text-graphite mb-1\">Home Details</p>\n                      <p className=\"text-gray-700 font-verdana\">\n                        {bookingData?.bedrooms} Bedrooms ‚Ä¢ {bookingData?.bathrooms} Baths\n                      </p>\n                      <p className=\"text-gray-700 font-verdana\">{bookingData?.squareFeet} sq ft</p>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3 p-5 bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl border-2 border-cyan-200 shadow-md\">\n                  <Sparkles className=\"w-6 h-6 text-cyan-600 mt-1 flex-shrink-0\" />\n                  <div>\n                    <p className=\"font-fredoka font-bold text-graphite mb-1\">Service Type</p>\n                    <Badge className=\"text-lg px-4 py-2 font-fredoka font-bold\" style={{\n                      background: bookingData?.serviceType === 'deep' ? 'linear-gradient(135deg, #FBBF24, #F59E0B)' :\n                                 bookingData?.serviceType === 'moveout' ? 'linear-gradient(135deg, #A855F7, #9333EA)' :\n                                 'linear-gradient(135deg, #66B3FF, #00D4FF)',\n                      color: 'white'\n                    }}>\n                      {bookingData?.serviceType === 'deep' ? '‚ú® Deep Clean' :\n                       bookingData?.serviceType === 'moveout' ? 'üì¶ Move-Out Clean' :\n                       'üßπ Basic Clean'}\n                    </Badge>\n                  </div>\n                </div>\n\n                {/* ADDITIONAL SERVICES */}\n                {Object.keys(addOns).length > 0 && (\n                  <div className=\"bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl border-2 border-pink-200 p-5 shadow-md\">\n                    <div className=\"flex items-center gap-3 mb-4\">\n                      <Package className=\"w-6 h-6 text-pink-600\" />\n                      <p className=\"font-fredoka font-bold text-xl text-graphite\">Additional Services</p>\n                    </div>\n                    <div className=\"space-y-3\">\n                      {Object.entries(addOns).map(([key, quantity]) => {\n                        const price = cleaner?.additional_service_pricing?.[key] || 0;\n                        const totalPrice = price * quantity;\n                        return (\n                          <div key={key} className=\"flex items-center justify-between bg-white rounded-lg p-4 shadow-sm border border-pink-200\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"w-10 h-10 bg-gradient-to-br from-pink-400 to-purple-400 rounded-lg flex items-center justify-center text-white font-fredoka font-bold text-lg\">\n                                {quantity}√ó\n                              </div>\n                              <span className=\"font-fredoka font-semibold text-graphite capitalize\">\n                                {key.replace(/_/g, ' ')}\n                              </span>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"text-xl font-fredoka font-bold text-pink-600\">{totalPrice} credits</p>\n                              <p className=\"text-sm text-gray-600 font-verdana\">‚âà ${(totalPrice / 10).toFixed(2)}</p>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Price Breakdown - ENHANCED */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.2 }}\n          >\n            <Card className=\"border-4 border-green-400 shadow-2xl rounded-3xl overflow-hidden bg-gradient-to-br from-green-50 to-emerald-50\">\n              <CardHeader className=\"bg-gradient-to-r from-green-600 to-emerald-600 text-white\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                  <DollarSign className=\"w-8 h-8\" />\n                  Estimated Cost Breakdown\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-8\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-4 bg-white rounded-xl border-2 border-green-200 shadow-sm\">\n                    <span className=\"text-lg font-verdana text-gray-700\">Cleaning Service ({bookingData?.recommendedHours} hrs)</span>\n                    <div className=\"text-right\">\n                      <p className=\"text-2xl font-fredoka font-bold text-green-600\">{estimate.hourlyTotal}</p>\n                      <p className=\"text-sm text-gray-600 font-verdana\">credits</p>\n                    </div>\n                  </div>\n                  \n                  {estimate.addOnsTotal > 0 && (\n                    <div className=\"flex justify-between items-center p-4 bg-white rounded-xl border-2 border-purple-200 shadow-sm\">\n                      <span className=\"text-lg font-verdana text-gray-700\">Additional Services</span>\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-fredoka font-bold text-purple-600\">+{estimate.addOnsTotal}</p>\n                        <p className=\"text-sm text-gray-600 font-verdana\">credits</p>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* TOTAL - HIGHLIGHTED */}\n                  <div className=\"bg-gradient-to-r from-amber-500 to-orange-500 rounded-2xl p-6 shadow-xl border-4 border-white mt-6\">\n                    <div className=\"flex justify-between items-center\">\n                      <div>\n                        <p className=\"text-white font-verdana text-sm mb-1 opacity-90\">Total Estimated Cost</p>\n                        <p className=\"text-5xl font-fredoka font-bold text-white drop-shadow-lg\">{estimate.credits}</p>\n                        <p className=\"text-xl text-white font-verdana mt-2\">‚âà ${estimate.usd} USD</p>\n                      </div>\n                      <div className=\"w-20 h-20 bg-white rounded-xl flex items-center justify-center shadow-lg\">\n                        <CheckCircle className=\"w-12 h-12 text-green-600\" />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <Alert className=\"mt-6 border-2 border-blue-300 bg-blue-50 rounded-xl\">\n                  <Info className=\"w-5 h-5 text-puretask-blue\" />\n                  <AlertDescription className=\"text-base font-verdana text-gray-700 leading-relaxed\">\n                    <strong>üìç Note:</strong> This is an estimate. Final payment will be based on actual hours worked (GPS tracked) + confirmed add-ons.\n                  </AlertDescription>\n                </Alert>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Special Requests - ENHANCED */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.3 }}\n          >\n            <Card className=\"border-4 border-indigo-300 shadow-2xl rounded-3xl overflow-hidden\">\n              <CardHeader className=\"bg-gradient-to-r from-indigo-600 to-purple-600 text-white\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-3\">\n                  <Sparkles className=\"w-8 h-8\" />\n                  Special Requests & Guidelines\n                </CardTitle>\n                <p className=\"text-white/90 font-verdana text-sm mt-2\">Optional: Add any specific instructions or notes for the cleaner</p>\n              </CardHeader>\n              <CardContent className=\"p-8\">\n                <Textarea\n                  value={specialRequests}\n                  onChange={(e) => setSpecialRequests(e.target.value)}\n                  placeholder=\"Examples:\n‚Ä¢ Please focus extra attention on the kitchen and bathrooms\n‚Ä¢ I have a friendly dog who loves attention\n‚Ä¢ Please use unscented products (allergies)\n‚Ä¢ The spare key is under the doormat\n‚Ä¢ Special instructions for parking...\"\n                  rows={6}\n                  className=\"rounded-xl font-verdana border-2 border-indigo-200 focus:border-indigo-400 p-4 text-base resize-none\"\n                />\n                <p className=\"text-sm text-gray-600 font-verdana mt-3 flex items-center gap-2\">\n                  <Info className=\"w-4 h-4 text-indigo-500\" />\n                  The cleaner will receive these notes before starting the job\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Action Buttons */}\n          <div className=\"flex gap-4\">\n            <Button\n              onClick={() => navigate(-1)}\n              variant=\"outline\"\n              size=\"lg\"\n              className=\"rounded-full font-fredoka font-semibold border-2\"\n            >\n              <ArrowLeft className=\"w-5 h-5 mr-2\" />\n              Back\n            </Button>\n\n            <Button\n              onClick={handleSubmitRequest}\n              disabled={submitting}\n              size=\"lg\"\n              className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-bold shadow-xl py-6 text-lg\"\n            >\n              {submitting ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Sending Request...\n                </>\n              ) : (\n                <>\n                  <Send className=\"w-5 h-5 mr-2\" />\n                  Send Booking Request to {cleaner?.full_name}\n                </>\n              )}\n            </Button>\n          </div>\n\n          {/* Info Box */}\n          <Alert className=\"border-2 border-amber-200 bg-amber-50 rounded-2xl\">\n            <Info className=\"w-5 h-5 text-amber-600\" />\n            <AlertDescription className=\"font-verdana text-gray-700\">\n              <strong>What happens next?</strong><br />\n              Your request will be sent to {cleaner?.full_name}. They have 24 hours to accept or decline. You'll receive a notification either way. If accepted, you'll proceed to payment!\n            </AlertDescription>\n          </Alert>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BookingRequestSent.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":39,"fix":{"range":[276,288],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[275,287],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":6,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50,"fix":{"range":[287,298],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[287,298],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[379,426],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[379,425],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":11,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":62,"fix":{"range":[552,562],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[551,561],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'User' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":7,"fix":{"range":[562,570],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"User"},"fix":{"range":[561,569],"text":""},"desc":"Remove unused variable 'User'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":12,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":15,"fix":{"range":[570,578],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[569,577],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":12,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":21,"fix":{"range":[578,584],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[577,583],"text":""},"desc":"Remove unused variable 'Star'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'pollingInterval' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"pollingInterval"},"fix":{"range":[1057,1072],"text":""},"desc":"Remove unused variable 'pollingInterval'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  CheckCircle, Clock, Bell, Home, Loader2, Sparkles, Calendar,\n  User, MapPin, Star, MessageSquare, AlertTriangle\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function BookingRequestSent() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const bookingId = searchParams.get('booking');\n\n  const [booking, setBooking] = useState(null);\n  const [cleaner, setCleaner] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [pollingInterval, setPollingInterval] = useState(null);\n\n  useEffect(() => {\n    if (!bookingId) {\n      navigate(createPageUrl('ClientDashboard'));\n      return;\n    }\n    loadBooking();\n\n    // Poll for updates every 10 seconds\n    const interval = setInterval(loadBooking, 10000);\n    setPollingInterval(interval);\n\n    return () => {\n      if (interval) clearInterval(interval);\n    };\n  }, [bookingId]);\n\n  const loadBooking = async () => {\n    try {\n      const bookings = await base44.entities.Booking.filter({ id: bookingId });\n      if (bookings.length === 0) {\n        navigate(createPageUrl('ClientDashboard'));\n        return;\n      }\n\n      const bookingData = bookings[0];\n      setBooking(bookingData);\n\n      // Load cleaner info\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ \n        user_email: bookingData.cleaner_email \n      });\n      if (cleanerProfiles.length > 0) {\n        setCleaner(cleanerProfiles[0]);\n      }\n\n      // If status changed to accepted, redirect to payment\n      if (bookingData.status === 'accepted' || bookingData.status === 'payment_hold') {\n        navigate(createPageUrl(`PaymentCheckout?booking=${bookingData.id}`));\n      }\n\n      // If declined, show alert\n      if (bookingData.status === 'cleaner_declined') {\n        // Will show declined state in UI\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading booking:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-16 h-16 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const isDeclined = booking?.status === 'cleaner_declined';\n  const timeLeft = booking?.request_expires_at \n    ? Math.max(0, Math.round((new Date(booking.request_expires_at) - new Date()) / 1000 / 60 / 60)) \n    : 24;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 p-6 flex items-center justify-center\">\n      <div className=\"max-w-3xl w-full\">\n        <motion.div\n          initial={{ opacity: 0, scale: 0.95 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ duration: 0.5 }}\n        >\n          {!isDeclined ? (\n            <>\n              {/* Success State */}\n              <div className=\"text-center mb-8\">\n                <motion.div\n                  initial={{ scale: 0 }}\n                  animate={{ scale: 1 }}\n                  transition={{ type: \"spring\", duration: 0.6 }}\n                  className=\"w-24 h-24 brand-gradient rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl\"\n                >\n                  <CheckCircle className=\"w-14 h-14 text-white\" />\n                </motion.div>\n                <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-3\">\n                  Request Sent Successfully! üéâ\n                </h1>\n                <p className=\"text-lg text-gray-600 font-verdana\">\n                  We've notified {cleaner?.full_name} about your booking\n                </p>\n              </div>\n\n              {/* Status Card */}\n              <Card className=\"border-0 shadow-2xl rounded-2xl mb-6 overflow-hidden\">\n                <div className=\"bg-gradient-to-r from-amber-500 to-orange-500 p-6 text-white\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <Clock className=\"w-8 h-8\" />\n                      <div>\n                        <p className=\"font-fredoka font-bold text-xl\">Awaiting Response</p>\n                        <p className=\"text-sm opacity-90 font-verdana\">{timeLeft} hours remaining</p>\n                      </div>\n                    </div>\n                    <motion.div\n                      animate={{ scale: [1, 1.1, 1] }}\n                      transition={{ repeat: Infinity, duration: 2 }}\n                    >\n                      <Bell className=\"w-8 h-8\" />\n                    </motion.div>\n                  </div>\n                </div>\n\n                <CardContent className=\"p-6\">\n                  <Alert className=\"border-blue-200 bg-blue-50 rounded-xl\">\n                    <Info className=\"w-4 h-4 text-puretask-blue\" />\n                    <AlertDescription className=\"font-verdana text-gray-700\">\n                      <strong>{cleaner?.full_name}</strong> has 24 hours to respond to your request. We'll notify you immediately via email and SMS once they accept!\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"mt-6 space-y-3\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center\">\n                        <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      </div>\n                      <span className=\"font-verdana text-gray-700\">Request sent to cleaner</span>\n                    </div>\n                    <div className=\"flex items-center gap-3 opacity-50\">\n                      <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center\">\n                        <Clock className=\"w-5 h-5 text-gray-400\" />\n                      </div>\n                      <span className=\"font-verdana text-gray-500\">Waiting for acceptance...</span>\n                    </div>\n                    <div className=\"flex items-center gap-3 opacity-30\">\n                      <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center\">\n                        <DollarSign className=\"w-5 h-5 text-gray-400\" />\n                      </div>\n                      <span className=\"font-verdana text-gray-400\">Payment processing</span>\n                    </div>\n                    <div className=\"flex items-center gap-3 opacity-30\">\n                      <div className=\"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center\">\n                        <Sparkles className=\"w-5 h-5 text-gray-400\" />\n                      </div>\n                      <span className=\"font-verdana text-gray-400\">Booking confirmed</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </>\n          ) : (\n            <>\n              {/* Declined State */}\n              <div className=\"text-center mb-8\">\n                <div className=\"w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                  <AlertTriangle className=\"w-14 h-14 text-red-600\" />\n                </div>\n                <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-3\">\n                  Request Declined\n                </h1>\n                <p className=\"text-lg text-gray-600 font-verdana\">\n                  {cleaner?.full_name} is unable to accept this booking\n                </p>\n              </div>\n\n              <Card className=\"border-0 shadow-2xl rounded-2xl mb-6\">\n                <CardContent className=\"p-8 text-center\">\n                  <p className=\"font-verdana text-gray-700 mb-6\">\n                    Don't worry! We have many other great cleaners available for your date and time.\n                  </p>\n                  <Button\n                    onClick={() => navigate(createPageUrl('MatchedCleaners'))}\n                    className=\"brand-gradient text-white rounded-full font-fredoka font-bold px-8 py-6\"\n                  >\n                    View Other Available Cleaners\n                  </Button>\n                </CardContent>\n              </Card>\n            </>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex flex-col gap-4\">\n            <Button\n              onClick={() => navigate(createPageUrl('ClientDashboard'))}\n              variant=\"outline\"\n              size=\"lg\"\n              className=\"rounded-full font-fredoka font-semibold border-2\"\n            >\n              <Home className=\"w-5 h-5 mr-2\" />\n              Go to Dashboard\n            </Button>\n\n            {booking && !isDeclined && (\n              <Button\n                onClick={() => navigate(createPageUrl(`ChatThread?booking=${booking.id}`))}\n                variant=\"outline\"\n                size=\"lg\"\n                className=\"rounded-full font-fredoka font-semibold border-2\"\n              >\n                <MessageSquare className=\"w-5 h-5 mr-2\" />\n                Message {cleaner?.full_name}\n              </Button>\n            )}\n          </div>\n\n          {/* Auto-refresh indicator */}\n          {!isDeclined && (\n            <p className=\"text-center text-sm text-gray-500 font-verdana mt-6\">\n              ‚ü≥ Checking for updates automatically...\n            </p>\n          )}\n        </motion.div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BrowseCleaners.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'createPageUrl' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23,"fix":{"range":[150,191],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"createPageUrl"},"fix":{"range":[150,190],"text":""},"desc":"Remove unused variable 'createPageUrl'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Loader2' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":17,"fix":{"range":[351,360],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Loader2"},"fix":{"range":[352,360],"text":""},"desc":"Remove unused variable 'Loader2'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'navigate' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"navigate"},"fix":{"range":[1415,1446],"text":""},"desc":"Remove unused variable 'navigate'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'currentUser' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentUser"},"fix":{"range":[1684,1695],"text":""},"desc":"Remove unused variable 'currentUser'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":91,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":91,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Loader2, AlertCircle } from 'lucide-react';\nimport EnhancedCleanerCard from '../components/cleaner/EnhancedCleanerCard';\nimport StickyFiltersBar from '@/components/cleaner/StickyFiltersBar';\nimport AdvancedFiltersPanel from '@/components/cleaner/AdvancedFiltersPanel';\nimport QuickCompareDrawer from '@/components/cleaner/QuickCompareDrawer';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst SkeletonCleanerCard = () => (\n  <div className=\"rounded-3xl shadow-xl h-full flex flex-col animate-pulse bg-gray-100\">\n    <div className=\"aspect-video bg-gray-300 rounded-t-3xl\"></div>\n    <div className=\"p-6 space-y-4\">\n      <div className=\"h-6 bg-gray-300 rounded w-2/3\"></div>\n      <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\n      <div className=\"h-4 bg-gray-200 rounded w-5/6\"></div>\n      <div className=\"grid grid-cols-2 gap-3\">\n        <div className=\"h-10 bg-gray-200 rounded-full\"></div>\n        <div className=\"h-10 bg-gray-200 rounded-full\"></div>\n      </div>\n    </div>\n  </div>\n);\n\nexport default function BrowseCleaners() {\n  const navigate = useNavigate();\n  const [allCleaners, setAllCleaners] = useState([]);\n  const [filteredCleaners, setFilteredCleaners] = useState([]);\n  const [blockedCleaners, setBlockedCleaners] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loadError, setLoadError] = useState('');\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [pinnedCleaners, setPinnedCleaners] = useState([]);\n  const [currentPage, setCurrentPage] = useState(1);\n  const cleanersPerPage = 5;\n  \n  const [selectedTier, setSelectedTier] = useState('all');\n  const [filters, setFilters] = useState({\n    search: '',\n    sortBy: 'tier_then_reliability',\n    minPrice: 0,\n    maxPrice: 100,\n    minRating: 0,\n    minReliability: 0,\n    availability: 'all',\n    cleaningType: 'all',\n    tier: 'all'\n  });\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  useEffect(() => {\n    // Auto-apply when data loads or blocked list changes\n    applyFilters();\n  }, [allCleaners, blockedCleaners, selectedTier]);\n\n  const loadData = async () => {\n    setLoading(true);\n    setLoadError('');\n    try {\n      const profiles = await base44.entities.CleanerProfile.filter(\n        { is_active: true },\n        '-reliability_score',\n        500\n      );\n      \n      if (profiles.length === 0) {\n        setLoadError('No active cleaners found. Please check back later.');\n        setLoading(false);\n        return;\n      }\n\n      setAllCleaners(profiles);\n\n      try {\n        const user = await base44.auth.me();\n        setCurrentUser(user);\n        \n        if (user.user_type === 'client') {\n          const blocked = await base44.entities.BlockedCleaner.filter({ client_email: user.email });\n          setBlockedCleaners(blocked.map(b => b.cleaner_email));\n        }\n      } catch (error) {\n        setCurrentUser(null);\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading cleaners:', showToast: false });\n      setLoadError('Failed to load cleaners. Please refresh the page.');\n    }\n    setLoading(false);\n  };\n\n  const applyFilters = () => {\n    let result = [...allCleaners];\n\n    if (blockedCleaners.length > 0) {\n      result = result.filter(c => !blockedCleaners.includes(c.user_email));\n    }\n\n    if (filters.search.trim()) {\n      const searchLower = filters.search.toLowerCase();\n      result = result.filter(c => \n        c.full_name?.toLowerCase().includes(searchLower) ||\n        c.bio?.toLowerCase().includes(searchLower) ||\n        c.service_locations?.some(loc => loc.toLowerCase().includes(searchLower))\n      );\n    }\n\n    if (filters.minRating > 0) {\n      result = result.filter(c => (c.average_rating || 0) >= filters.minRating);\n    }\n\n    if (filters.minReliability > 0) {\n      result = result.filter(c => (c.reliability_score || 75) >= filters.minReliability);\n    }\n\n    result = result.filter(c => {\n      const effectiveRate = (c.base_rate_credits_per_hour || c.hourly_rate || 300) / 10;\n      return effectiveRate >= filters.minPrice && effectiveRate <= filters.maxPrice;\n    });\n\n    if (selectedTier !== 'all') {\n      result = result.filter(c => c.tier === selectedTier);\n    } else if (filters.tier !== 'all') {\n      result = result.filter(c => c.tier === filters.tier);\n    }\n\n    // Sort based on selected option\n    switch (filters.sortBy) {\n      case 'top_rated':\n        result.sort((a, b) => (b.average_rating || 0) - (a.average_rating || 0));\n        break;\n      case 'most_reliable':\n        result.sort((a, b) => (b.reliability_score || 75) - (a.reliability_score || 75));\n        break;\n      case 'lowest_price':\n        result.sort((a, b) => {\n          const aRate = (a.base_rate_credits_per_hour || 300) / 10;\n          const bRate = (b.base_rate_credits_per_hour || 300) / 10;\n          return aRate - bRate;\n        });\n        break;\n      case 'tier_then_reliability':\n        // Sort by tier first, then reliability within each tier\n        const tierOrder = { 'Elite': 0, 'Pro': 1, 'Semi Pro': 2, 'Developing': 3 };\n        result.sort((a, b) => {\n          const aTier = tierOrder[a.tier] ?? 4;\n          const bTier = tierOrder[b.tier] ?? 4;\n          if (aTier !== bTier) return aTier - bTier;\n          return (b.reliability_score || 75) - (a.reliability_score || 75);\n        });\n        break;\n      case 'recommended':\n      default:\n        result.sort((a, b) => {\n          const aScore = ((a.reliability_score || 75) * 0.6) + ((a.average_rating || 5) * 20 * 0.4);\n          const bScore = ((b.reliability_score || 75) * 0.6) + ((b.average_rating || 5) * 20 * 0.4);\n          return bScore - aScore;\n        });\n    }\n\n    setFilteredCleaners(result);\n  };\n\n  const handleFilterChange = (key, value) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n  };\n\n  const handleSearch = () => {\n    applyFilters();\n    setCurrentPage(1);\n  };\n\n  const resetFilters = () => {\n    setFilters({\n      search: '',\n      sortBy: 'tier_then_reliability',\n      minPrice: 0,\n      maxPrice: 100,\n      minRating: 0,\n      minReliability: 0,\n      availability: 'all',\n      cleaningType: 'all',\n      tier: 'all'\n    });\n  };\n\n  const handlePinCleaner = (cleaner) => {\n    setPinnedCleaners(prev => {\n      const isAlreadyPinned = prev.some(c => c.id === cleaner.id);\n      if (isAlreadyPinned) {\n        return prev.filter(c => c.id !== cleaner.id);\n      }\n      if (prev.length >= 3) {\n        return prev;\n      }\n      return [...prev, cleaner];\n    });\n  };\n\n  const handleRemovePin = (cleanerId) => {\n    setPinnedCleaners(prev => prev.filter(c => c.id !== cleanerId));\n  };\n\n  const handleClearPins = () => {\n    setPinnedCleaners([]);\n  };\n\n  const allLocations = [...new Set(allCleaners.flatMap(c => c.service_locations || []))].sort();\n\n  const indexOfLastCleaner = currentPage * cleanersPerPage;\n  const indexOfFirstCleaner = indexOfLastCleaner - cleanersPerPage;\n  const currentCleaners = filteredCleaners.slice(indexOfFirstCleaner, indexOfLastCleaner);\n  const totalPages = Math.ceil(filteredCleaners.length / cleanersPerPage);\n\n  const goToNextPage = () => {\n    if (currentPage < totalPages) {\n      setCurrentPage(currentPage + 1);\n      window.scrollTo({ top: 200, behavior: 'smooth' });\n    }\n  };\n\n  const goToPreviousPage = () => {\n    if (currentPage > 1) {\n      setCurrentPage(currentPage - 1);\n      window.scrollTo({ top: 200, behavior: 'smooth' });\n    }\n  };\n\n\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"mb-8\">\n            <h1 className=\"text-5xl font-fredoka font-bold text-graphite mb-2\">Find Your Perfect Cleaner</h1>\n            <p className=\"text-xl text-gray-600 font-verdana\">Loading verified professionals...</p>\n          </div>\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[...Array(6)].map((_, i) => <SkeletonCleanerCard key={i} />)}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (loadError || allCleaners.length === 0) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-soft-cloud p-6\">\n        <Card className=\"max-w-md rounded-3xl bg-white shadow-2xl border-0\">\n          <CardContent className=\"p-8 text-center\">\n            <AlertCircle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\n            <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">\n              {loadError || 'No Cleaners Available'}\n            </h2>\n            <p className=\"text-gray-600 mb-6 font-verdana\">Please check back soon or try refreshing.</p>\n            <Button onClick={loadData} className=\"brand-gradient text-white rounded-full font-fredoka\">\n              Try Again\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 pb-24 sm:pb-32\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 shadow-sm py-6 sm:py-10\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-8\">\n          <motion.div initial={{ opacity: 0, y: -20 }} animate={{ opacity: 1, y: 0 }}>\n            <h1 className=\"text-3xl sm:text-4xl lg:text-5xl font-fredoka font-bold text-slate-900 mb-2\">\n              Professional Cleaners\n            </h1>\n            <p className=\"text-base sm:text-lg text-slate-600 font-verdana\">\n              {allCleaners.length} verified professionals ‚Ä¢ Sorted by tier & reliability\n            </p>\n          </motion.div>\n        </div>\n      </div>\n\n      {/* Sticky Filters Bar */}\n      <StickyFiltersBar\n        filters={filters}\n        onFilterChange={handleFilterChange}\n        onResetFilters={resetFilters}\n        onSearch={handleSearch}\n        showAdvanced={showAdvancedFilters}\n        setShowAdvanced={setShowAdvancedFilters}\n        allLocations={allLocations}\n      />\n\n      {/* Advanced Filters Panel */}\n      <AnimatePresence>\n        {showAdvancedFilters && (\n          <AdvancedFiltersPanel\n            filters={filters}\n            onFilterChange={handleFilterChange}\n            onClose={() => setShowAdvancedFilters(false)}\n            allLocations={allLocations}\n          />\n        )}\n      </AnimatePresence>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-8 py-6 sm:py-10\">\n        {/* Tier Selection */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-fredoka font-bold text-slate-900 mb-4\">Select Cleaner Tier</h2>\n          <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-3 sm:gap-4\">\n            <button\n              onClick={() => setSelectedTier('all')}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedTier === 'all'\n                  ? 'bg-slate-900 border-slate-900 text-white shadow-lg'\n                  : 'bg-white border-slate-200 hover:border-slate-300 text-slate-700'\n              }`}\n            >\n              <p className=\"font-fredoka font-bold text-base mb-1\">All Tiers</p>\n              <p className=\"text-xs opacity-80\">{allCleaners.length} cleaners</p>\n            </button>\n            \n            <button\n              onClick={() => setSelectedTier('Elite')}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedTier === 'Elite'\n                  ? 'bg-gradient-to-r from-purple-600 to-purple-700 border-purple-600 text-white shadow-lg'\n                  : 'bg-white border-purple-300 hover:bg-purple-50 text-slate-700'\n              }`}\n            >\n              <p className=\"font-fredoka font-bold text-base mb-1\">üëë Elite</p>\n              <p className=\"text-xs opacity-80\">{allCleaners.filter(c => c.tier === 'Elite').length} cleaners</p>\n            </button>\n\n            <button\n              onClick={() => setSelectedTier('Pro')}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedTier === 'Pro'\n                  ? 'bg-gradient-to-r from-blue-600 to-blue-700 border-blue-600 text-white shadow-lg'\n                  : 'bg-white border-blue-300 hover:bg-blue-50 text-slate-700'\n              }`}\n            >\n              <p className=\"font-fredoka font-bold text-base mb-1\">‚≠ê Pro</p>\n              <p className=\"text-xs opacity-80\">{allCleaners.filter(c => c.tier === 'Pro').length} cleaners</p>\n            </button>\n\n            <button\n              onClick={() => setSelectedTier('Semi Pro')}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedTier === 'Semi Pro'\n                  ? 'bg-gradient-to-r from-emerald-600 to-emerald-700 border-emerald-600 text-white shadow-lg'\n                  : 'bg-white border-emerald-300 hover:bg-emerald-50 text-slate-700'\n              }`}\n            >\n              <p className=\"font-fredoka font-bold text-base mb-1\">üí´ Semi Pro</p>\n              <p className=\"text-xs opacity-80\">{allCleaners.filter(c => c.tier === 'Semi Pro').length} cleaners</p>\n            </button>\n\n            <button\n              onClick={() => setSelectedTier('Developing')}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                selectedTier === 'Developing'\n                  ? 'bg-gradient-to-r from-slate-600 to-slate-700 border-slate-600 text-white shadow-lg'\n                  : 'bg-white border-slate-300 hover:bg-slate-50 text-slate-700'\n              }`}\n            >\n              <p className=\"font-fredoka font-bold text-base mb-1\">üåü Developing</p>\n              <p className=\"text-xs opacity-80\">{allCleaners.filter(c => c.tier === 'Developing').length} cleaners</p>\n            </button>\n          </div>\n        </div>\n\n        {/* Results Summary */}\n        <div className=\"mb-6 flex items-center justify-between flex-wrap gap-3\">\n          <p className=\"text-sm sm:text-base text-slate-700 font-verdana\">\n            <span className=\"font-fredoka font-bold text-slate-900 text-lg sm:text-xl\">\n              {filteredCleaners.length}\n            </span>\n            {' '}professional{filteredCleaners.length !== 1 ? 's' : ''} available\n            {totalPages > 1 && (\n              <span className=\"text-slate-500 ml-2 text-xs sm:text-sm\">‚Ä¢ Page {currentPage} of {totalPages}</span>\n            )}\n          </p>\n        </div>\n\n        {/* Cleaners List (Professional Grid) */}\n        {currentCleaners.length > 0 ? (\n          <>\n            <motion.div \n              className=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 sm:gap-5 mb-8\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n            >\n              {currentCleaners.map(cleaner => (\n                <EnhancedCleanerCard\n                  key={cleaner.id}\n                  cleaner={cleaner}\n                  onPin={handlePinCleaner}\n                  isPinned={pinnedCleaners.some(c => c.id === cleaner.id)}\n                />\n              ))}\n            </motion.div>\n\n            {/* Pagination */}\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-center gap-3 sm:gap-4 flex-wrap\">\n                <Button\n                  onClick={goToPreviousPage}\n                  disabled={currentPage === 1}\n                  variant=\"outline\"\n                  className=\"rounded-lg font-fredoka font-semibold px-6 sm:px-8 h-11 border border-slate-300 disabled:opacity-40 text-sm hover:bg-slate-50\"\n                >\n                  Previous\n                </Button>\n                <span className=\"font-verdana text-slate-700 font-medium text-sm bg-white px-4 py-2 rounded-lg border border-slate-200\">\n                  {currentPage} / {totalPages}\n                </span>\n                <Button\n                  onClick={goToNextPage}\n                  disabled={currentPage === totalPages}\n                  className=\"rounded-lg font-fredoka font-semibold px-6 sm:px-8 h-11 bg-slate-900 text-white hover:bg-slate-800 text-sm\"\n                >\n                  Next\n                </Button>\n              </div>\n            )}\n          </>\n        ) : (\n          <Card className=\"border-0 shadow-xl rounded-3xl\">\n            <CardContent className=\"p-12 text-center\">\n              <AlertCircle className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n              <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">\n                No cleaners match your filters\n              </h3>\n              <p className=\"text-gray-600 mb-6 font-verdana\">\n                Try adjusting your search criteria\n              </p>\n              <Button \n                onClick={resetFilters} \n                className=\"brand-gradient text-white rounded-full font-fredoka font-semibold px-8\"\n              >\n                Reset All Filters\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Quick Compare Drawer */}\n      <QuickCompareDrawer\n        pinnedCleaners={pinnedCleaners}\n        onRemove={handleRemovePin}\n        onClear={handleClearPins}\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\BuyCredits.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'createPageUrl' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":23,"fix":{"range":[150,191],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"createPageUrl"},"fix":{"range":[150,190],"text":""},"desc":"Remove unused variable 'createPageUrl'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[421,428],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[422,428],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":9,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[427,445],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[427,445],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Progress' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18,"fix":{"range":[478,531],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Progress"},"fix":{"range":[478,530],"text":""},"desc":"Remove unused variable 'Progress'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":12,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":30,"fix":{"range":[565,570],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[564,569],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":7,"fix":{"range":[603,611],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[602,610],"text":""},"desc":"Remove unused variable 'Info'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Progress } from '@/components/ui/progress';\nimport {\n  DollarSign, CreditCard, Zap, TrendingUp, CheckCircle, Shield,\n  Info, Sparkles, Loader2, ArrowLeft\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { initiateCreditPurchase, CREDIT_PACKAGES } from '../components/payments/StripeService';\nimport { analytics } from '../components/analytics/AnalyticsService';\nimport CreditSystemExplainer from '../components/credits/CreditSystemExplainer';\n\nexport default function BuyCredits() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [purchasing, setPurchasing] = useState(false);\n  const [selectedPackage, setSelectedPackage] = useState(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      const profiles = await base44.entities.ClientProfile.filter({ \n        user_email: currentUser.email \n      });\n\n      if (profiles.length > 0) {\n        setClientProfile(profiles[0]);\n      }\n\n      analytics.pageView('BuyCredits');\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n      toast.error('Failed to load data');\n    }\n    setLoading(false);\n  };\n\n  const handlePurchase = async (pkg) => {\n    if (!user || !clientProfile) {\n      toast.error('Please log in to purchase credits');\n      return;\n    }\n\n    setPurchasing(true);\n    setSelectedPackage(pkg);\n\n    try {\n      analytics.payment('initiated', {\n        package_id: pkg.id,\n        amount_usd: pkg.usd,\n        credits: pkg.credits,\n        bonus: pkg.bonus\n      });\n\n      const result = await initiateCreditPurchase(pkg, user);\n\n      if (result.success) {\n        toast.success(`Successfully purchased ${result.credits} credits!`);\n        \n        analytics.payment('success', {\n          package_id: pkg.id,\n          amount_usd: pkg.usd,\n          credits: result.credits,\n          new_balance: result.newBalance\n        });\n\n        // Reload profile data\n        await loadData();\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Purchase error:', showToast: false });\n      toast.error('Purchase failed. Please try again.');\n      \n      analytics.payment('failed', {\n        package_id: pkg.id,\n        error_message: error.message\n      });\n    }\n\n    setPurchasing(false);\n    setSelectedPackage(null);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(-1)}\n            className=\"mb-4\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back\n          </Button>\n          \n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Buy Credits</h1>\n          <p className=\"text-lg text-slate-600\">\n            Choose a package that fits your cleaning needs\n          </p>\n        </div>\n\n        {/* Current Balance */}\n        {clientProfile && (\n          <Card className=\"mb-8 border-0 shadow-xl bg-gradient-to-r from-emerald-500 to-green-600 text-white\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-emerald-100 mb-1\">Current Balance</p>\n                  <p className=\"text-4xl font-bold\">\n                    {clientProfile.credits_balance || 0} credits\n                  </p>\n                  <p className=\"text-sm text-emerald-100 mt-1\">\n                    ‚âà ${((clientProfile.credits_balance || 0) / 1).toFixed(2)} USD value\n                  </p>\n                </div>\n                <DollarSign className=\"w-16 h-16 text-emerald-100\" />\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* How Credits Work */}\n        <div className=\"mb-8\">\n          <CreditSystemExplainer />\n        </div>\n\n        {/* Credit Packages */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-8\">\n          {CREDIT_PACKAGES.map((pkg, idx) => {\n            const totalCredits = pkg.credits + pkg.bonus;\n            const savingsPercentage = pkg.bonus > 0 \n              ? Math.round((pkg.bonus / pkg.credits) * 100) \n              : 0;\n\n            return (\n              <motion.div\n                key={pkg.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.1 }}\n              >\n                <Card \n                  className={`relative border-2 transition-all hover:shadow-xl ${\n                    pkg.popular \n                      ? 'border-emerald-500 shadow-lg' \n                      : 'border-slate-200'\n                  }`}\n                >\n                  {pkg.popular && (\n                    <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2\">\n                      <Badge className=\"bg-emerald-500 text-white px-4 py-1\">\n                        <Sparkles className=\"w-3 h-3 mr-1\" />\n                        Most Popular\n                      </Badge>\n                    </div>\n                  )}\n\n                  <CardHeader className={pkg.popular ? 'bg-emerald-50' : ''}>\n                    <CardTitle className=\"flex items-center justify-between\">\n                      <span className=\"text-3xl font-bold\">${pkg.usd}</span>\n                      {savingsPercentage > 0 && (\n                        <Badge variant=\"outline\" className=\"text-emerald-600 border-emerald-300\">\n                          <TrendingUp className=\"w-3 h-3 mr-1\" />\n                          Save {savingsPercentage}%\n                        </Badge>\n                      )}\n                    </CardTitle>\n                  </CardHeader>\n\n                  <CardContent className=\"p-6\">\n                    <div className=\"mb-6\">\n                      <div className=\"flex items-baseline gap-2 mb-2\">\n                        <p className=\"text-4xl font-bold text-slate-900\">\n                          {totalCredits}\n                        </p>\n                        <p className=\"text-slate-600\">credits</p>\n                      </div>\n                      \n                      {pkg.bonus > 0 && (\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <span className=\"text-slate-600\">{pkg.credits} base</span>\n                          <span className=\"text-emerald-600 font-semibold\">\n                            + {pkg.bonus} bonus\n                          </span>\n                        </div>\n                      )}\n\n                      <p className=\"text-sm text-slate-600 mt-3\">\n                        {pkg.description}\n                      </p>\n                    </div>\n\n                    <div className=\"space-y-2 mb-6\">\n                      <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                        <CheckCircle className=\"w-4 h-4 text-emerald-500\" />\n                        <span>‚âà ${(totalCredits / 1).toFixed(0)} booking value</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                        <CheckCircle className=\"w-4 h-4 text-emerald-500\" />\n                        <span>Secure payment via Stripe</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                        <CheckCircle className=\"w-4 h-4 text-emerald-500\" />\n                        <span>Credits never expire</span>\n                      </div>\n                    </div>\n\n                    <Button\n                      onClick={() => handlePurchase(pkg)}\n                      disabled={purchasing}\n                      className={`w-full ${\n                        pkg.popular\n                          ? 'bg-emerald-500 hover:bg-emerald-600'\n                          : 'bg-slate-700 hover:bg-slate-800'\n                      }`}\n                      size=\"lg\"\n                    >\n                      {purchasing && selectedPackage?.id === pkg.id ? (\n                        <>\n                          <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                          Processing...\n                        </>\n                      ) : (\n                        <>\n                          <CreditCard className=\"w-5 h-5 mr-2\" />\n                          Purchase Now\n                        </>\n                      )}\n                    </Button>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </div>\n\n        {/* Security & Trust */}\n        <Card className=\"border-0 shadow-lg\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-start gap-4\">\n              <Shield className=\"w-8 h-8 text-emerald-500 flex-shrink-0\" />\n              <div>\n                <h3 className=\"font-semibold text-slate-900 mb-2\">\n                  Secure Payment Processing\n                </h3>\n                <p className=\"text-sm text-slate-600 mb-3\">\n                  All payments are processed securely through Stripe. We never store your credit card information.\n                </p>\n                <div className=\"flex flex-wrap gap-4 text-xs text-slate-500\">\n                  <span className=\"flex items-center gap-1\">\n                    <CheckCircle className=\"w-3 h-3 text-emerald-500\" />\n                    PCI Compliant\n                  </span>\n                  <span className=\"flex items-center gap-1\">\n                    <CheckCircle className=\"w-3 h-3 text-emerald-500\" />\n                    256-bit SSL Encryption\n                  </span>\n                  <span className=\"flex items-center gap-1\">\n                    <CheckCircle className=\"w-3 h-3 text-emerald-500\" />\n                    Fraud Protection\n                  </span>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CEODashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingDown' is defined but never used.","line":6,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":34,"fix":{"range":[295,309],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[294,308],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":6,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":84,"fix":{"range":[346,359],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[345,358],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, DollarSign, Users, Calendar, Target, AlertCircle, Loader2 } from 'lucide-react';\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts';\n\nexport default function CEODashboard() {\n  const [loading, setLoading] = useState(true);\n  const [dashboardData, setDashboardData] = useState(null);\n  const [dailyData, setDailyData] = useState([]);\n\n  useEffect(() => {\n    loadDashboard();\n  }, []);\n\n  const loadDashboard = async () => {\n    try {\n      // Load from cache first\n      const cacheRecords = await base44.entities.DashboardCache.filter({ id: 'ceo_dashboard' });\n      \n      if (cacheRecords.length > 0) {\n        setDashboardData(cacheRecords[0].payload);\n      }\n      \n      // Also load raw daily data for charts\n      const dailyAnalytics = await base44.entities.PlatformAnalyticsDaily.list('-created_date', 30);\n      setDailyData(dailyAnalytics.reverse());\n      \n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading CEO dashboard:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue mx-auto mb-4\" />\n          <p className=\"text-gray-600 font-verdana\">Loading dashboard...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const summary = dashboardData?.summary || {};\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">CEO Dashboard</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Platform health & growth metrics</p>\n          </div>\n          <Badge className=\"bg-green-100 text-green-800 font-fredoka text-sm px-4 py-2\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Last 30 Days\n          </Badge>\n        </div>\n\n        {/* KPI Cards */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <Card className=\"border-2 border-blue-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Total GMV</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"w-8 h-8 text-puretask-blue\" />\n                <div>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                    ${(summary.total_gmv_30d || 0).toLocaleString()}\n                  </p>\n                  <p className=\"text-xs text-gray-500 font-verdana\">Gross Merchandise Value</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-green-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Platform Revenue</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <TrendingUp className=\"w-8 h-8 text-fresh-mint\" />\n                <div>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                    ${(summary.total_revenue_30d || 0).toLocaleString()}\n                  </p>\n                  <p className=\"text-xs text-gray-500 font-verdana\">15% Platform Fee</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-purple-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Monthly Recurring Revenue</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <Target className=\"w-8 h-8 text-purple-600\" />\n                <div>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                    ${(summary.total_mrr || 0).toLocaleString()}\n                  </p>\n                  <p className=\"text-xs text-gray-500 font-verdana\">Subscriptions + Memberships</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-amber-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Active Users</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"w-8 h-8 text-amber-600\" />\n                <div>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                    {(summary.active_subscriptions || 0) + (summary.active_memberships || 0)}\n                  </p>\n                  <p className=\"text-xs text-gray-500 font-verdana\">Paying Customers</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Revenue Trend Chart */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">Revenue Trend (30 Days)</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {dailyData.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <LineChart data={dailyData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                  <YAxis tick={{ fontSize: 12 }} />\n                  <Tooltip />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"gmv_usd\" stroke=\"#66B3FF\" name=\"GMV ($)\" strokeWidth={2} />\n                  <Line type=\"monotone\" dataKey=\"platform_revenue_usd\" stroke=\"#28C76F\" name=\"Revenue ($)\" strokeWidth={2} />\n                </LineChart>\n              </ResponsiveContainer>\n            ) : (\n              <p className=\"text-center text-gray-500 py-12 font-verdana\">No data available yet</p>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Bookings Chart */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">Booking Volume (30 Days)</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {dailyData.length > 0 ? (\n              <ResponsiveContainer width=\"100%\" height={300}>\n                <BarChart data={dailyData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                  <YAxis tick={{ fontSize: 12 }} />\n                  <Tooltip />\n                  <Legend />\n                  <Bar dataKey=\"total_bookings\" fill=\"#66B3FF\" name=\"Total Bookings\" />\n                  <Bar dataKey=\"completed_bookings\" fill=\"#28C76F\" name=\"Completed\" />\n                </BarChart>\n              </ResponsiveContainer>\n            ) : (\n              <p className=\"text-center text-gray-500 py-12 font-verdana\">No data available yet</p>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Health Metrics */}\n        <div className=\"grid md:grid-cols-3 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-lg\">Cancellation Rate</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-4xl font-fredoka font-bold text-graphite\">\n                {dailyData.length > 0 ? \n                  (dailyData.reduce((sum, d) => sum + (d.cancel_rate || 0), 0) / dailyData.length).toFixed(1) \n                  : '0.0'}%\n              </p>\n              <p className=\"text-sm text-gray-500 font-verdana mt-2\">30-day average</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-lg\">Dispute Rate</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-4xl font-fredoka font-bold text-graphite\">\n                {dailyData.length > 0 ? \n                  (dailyData.reduce((sum, d) => sum + (d.dispute_rate || 0), 0) / dailyData.length).toFixed(1) \n                  : '0.0'}%\n              </p>\n              <p className=\"text-sm text-gray-500 font-verdana mt-2\">30-day average</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-lg\">Average Rating</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-4xl font-fredoka font-bold text-graphite\">\n                {dailyData.length > 0 ? \n                  (dailyData.reduce((sum, d) => sum + (d.avg_rating || 0), 0) / dailyData.length).toFixed(1) \n                  : '5.0'}‚≠ê\n              </p>\n              <p className=\"text-sm text-gray-500 font-verdana mt-2\">30-day average</p>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CancellationPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ChatThread.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Card' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"fix":{"range":[346,391],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Card"},"fix":{"range":[346,390],"text":""},"desc":"Remove unused variable 'Card'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ImageIcon' is defined but never used.","line":9,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":56,"fix":{"range":[427,447],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ImageIcon"},"fix":{"range":[426,446],"text":""},"desc":"Remove unused variable 'ImageIcon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card } from '@/components/ui/card';\nimport { ArrowLeft, Send, Paperclip, Image as ImageIcon, Loader2, Sparkles } from 'lucide-react';\nimport MessageBubble from '../components/messaging/MessageBubble';\nimport AIResponseGenerator from '../components/ai/AIResponseGenerator';\nimport { toast } from 'sonner';\n\nexport default function ChatThread() {\n  const navigate = useNavigate();\n  const messagesEndRef = useRef(null);\n  const [user, setUser] = useState(null);\n  const [thread, setThread] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [sending, setSending] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [showAI, setShowAI] = useState(false);\n  const [userType, setUserType] = useState(null);\n\n  const urlParams = new URLSearchParams(window.location.search);\n  const threadId = urlParams.get('thread_id');\n\n  useEffect(() => {\n    if (threadId) {\n      loadConversation();\n    }\n  }, [threadId]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const loadConversation = async () => {\n    try {\n      setLoading(true);\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n      setUserType(currentUser.user_type);\n\n      // Get thread and messages\n      const response = await base44.functions.invoke('messaging', {\n        action: 'getMessages',\n        thread_id: threadId\n      });\n\n      if (response.data.success) {\n        let threadData = response.data.thread;\n        \n        // Enrich with client profile if this is a cleaner viewing the thread\n        if (currentUser.user_type === 'cleaner' && threadData.booking_id) {\n          try {\n            const bookings = await base44.entities.Booking.filter({ id: threadData.booking_id });\n            if (bookings.length > 0) {\n              const booking = bookings[0];\n              const clientProfiles = await base44.entities.ClientProfile.filter({\n                user_email: booking.client_email\n              });\n              if (clientProfiles.length > 0) {\n                const profile = clientProfiles[0];\n                threadData.metadata = {\n                  ...threadData.metadata,\n                  booking: {\n                    ...booking,\n                    client_focus_areas: profile.focus_areas,\n                    client_avoid_areas: profile.avoid_areas,\n                    client_pet_temperament: profile.pet_temperament,\n                    client_product_allergies: profile.product_allergies\n                  }\n                };\n              }\n            }\n          } catch (e) {\n            console.log('Could not enrich with client profile:', e);\n          }\n        }\n        \n        setThread(threadData);\n        setMessages(response.data.messages);\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading conversation:', showToast: false });\n      toast.error('Failed to load conversation');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() || sending) return;\n\n    try {\n      setSending(true);\n      \n      const response = await base44.functions.invoke('messaging', {\n        action: 'addMessage',\n        thread_id: threadId,\n        content: newMessage,\n        type: 'user_message'\n      });\n\n      if (response.data.success) {\n        setMessages([...messages, response.data.message]);\n        setNewMessage('');\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error sending message:', showToast: false });\n      toast.error('Failed to send message');\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const handleFileUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    try {\n      setUploading(true);\n      \n      const uploadResponse = await base44.integrations.Core.UploadFile({ file });\n      const fileUrl = uploadResponse.file_url;\n\n      const response = await base44.functions.invoke('messaging', {\n        action: 'addMessage',\n        thread_id: threadId,\n        content: file.type.startsWith('image/') ? 'üì∑ Image' : 'üìé Attachment',\n        file_urls: [fileUrl],\n        type: 'user_message'\n      });\n\n      if (response.data.success) {\n        setMessages([...messages, response.data.message]);\n      }\n      \n      toast.success('File uploaded');\n    } catch (error) {\n      handleError(error, { userMessage: 'Error uploading file:', showToast: false });\n      toast.error('Failed to upload file');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const getOtherParticipant = () => {\n    if (!thread || !user) return 'Chat';\n    const others = thread.participants.filter(p => p !== user.email);\n    return others[0] || 'Unknown';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-puretask-blue border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-graphite font-fredoka\">Loading conversation...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud flex flex-col\">\n      {/* Header */}\n      <div className=\"bg-white border-b border-slate-200 sticky top-0 z-10\">\n        <div className=\"container mx-auto px-4 py-4 max-w-5xl\">\n          <div className=\"flex items-center gap-4\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => navigate(createPageUrl('Inbox'))}\n              className=\"rounded-full\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n            \n            <div className=\"flex-1\">\n              <h1 className=\"text-xl font-fredoka font-bold text-graphite\">\n                {thread?.subject || getOtherParticipant()}\n              </h1>\n              <p className=\"text-sm text-slate-600 font-verdana\">\n                {getOtherParticipant()}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"container mx-auto px-4 py-6 max-w-5xl\">\n          {messages.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <p className=\"text-slate-500 font-verdana\">No messages yet. Start the conversation!</p>\n            </div>\n          ) : (\n            <div className=\"space-y-1\">\n              {messages.map((message) => (\n                <MessageBubble\n                  key={message.id}\n                  message={message}\n                  currentUserEmail={user?.email}\n                />\n              ))}\n              <div ref={messagesEndRef} />\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* AI Response Generator */}\n      {showAI && userType === 'cleaner' && messages.length > 0 && (\n        <div className=\"bg-gray-50 border-t border-slate-200\">\n          <div className=\"container mx-auto px-4 py-4 max-w-5xl\">\n            <AIResponseGenerator\n              booking={thread?.metadata?.booking}\n              clientMessage={messages[messages.length - 1]?.content}\n              onSend={(aiResponse) => {\n                setNewMessage(aiResponse);\n                setShowAI(false);\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Input */}\n      <div className=\"bg-white border-t border-slate-200 sticky bottom-0\">\n        <div className=\"container mx-auto px-4 py-4 max-w-5xl\">\n          <div className=\"flex items-end gap-3\">\n            <input\n              type=\"file\"\n              id=\"file-upload\"\n              className=\"hidden\"\n              onChange={handleFileUpload}\n              accept=\"image/*,.pdf,.doc,.docx\"\n            />\n            \n            <Button\n              variant=\"outline\"\n              size=\"icon\"\n              onClick={() => document.getElementById('file-upload').click()}\n              disabled={uploading}\n              className=\"rounded-full flex-shrink-0\"\n            >\n              {uploading ? (\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\n              ) : (\n                <Paperclip className=\"w-5 h-5\" />\n              )}\n            </Button>\n\n            <Textarea\n              placeholder=\"Type your message...\"\n              value={newMessage}\n              onChange={(e) => setNewMessage(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                  e.preventDefault();\n                  handleSendMessage();\n                }\n              }}\n              className=\"flex-1 min-h-[44px] max-h-32 rounded-2xl resize-none\"\n              rows={1}\n            />\n\n            {userType === 'cleaner' && (\n              <Button\n                variant=\"outline\"\n                size=\"icon\"\n                onClick={() => setShowAI(!showAI)}\n                className=\"rounded-full flex-shrink-0\"\n                title=\"AI Response Assistant\"\n              >\n                <Sparkles className=\"w-5 h-5\" />\n              </Button>\n            )}\n\n            <Button\n              onClick={handleSendMessage}\n              disabled={!newMessage.trim() || sending}\n              className=\"brand-gradient text-white rounded-full flex-shrink-0\"\n              size=\"icon\"\n            >\n              {sending ? (\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\n              ) : (\n                <Send className=\"w-5 h-5\" />\n              )}\n            </Button>\n          </div>\n          \n          <p className=\"text-xs text-slate-500 mt-2 text-center font-verdana\">\n            Press Enter to send, Shift+Enter for new line\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerAnalytics.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[317,364],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[317,363],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":13,"fix":{"range":[453,467],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[456,467],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":10,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":41,"fix":{"range":[485,495],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[484,494],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":8,"fix":{"range":[518,527],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[517,526],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":11,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":28,"fix":{"range":[540,547],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[539,546],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart' is defined but never used.","line":15,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":28,"fix":{"range":[657,667],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart"},"fix":{"range":[656,666],"text":""},"desc":"Remove unused variable 'BarChart'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bar' is defined but never used.","line":15,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":33,"fix":{"range":[667,672],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bar"},"fix":{"range":[666,671],"text":""},"desc":"Remove unused variable 'Bar'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[870,874],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport {\n  TrendingUp, DollarSign, Star, Calendar, Clock, Camera, Target,\n  Award, CheckCircle, Users, BarChart3, Loader2\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport {\n  LineChart, Line, BarChart, Bar, PieChart, Pie, Cell,\n  XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\n} from 'recharts';\n\nexport default function CleanerAnalytics() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [profile, setProfile] = useState(null);\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'cleaner') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        setProfile(profiles[0]);\n      }\n\n      const userBookings = await base44.entities.Booking.filter({ \n        cleaner_email: currentUser.email \n      }, '-date');\n      setBookings(userBookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading analytics:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const calculateStats = () => {\n    const completed = bookings.filter(b => b.status === 'completed');\n    const totalEarnings = completed.reduce((sum, b) => sum + (b.total_price * 0.85), 0);\n    const avgRating = profile?.average_rating || 5.0;\n    \n    const earningsByMonth = {};\n    completed.forEach(b => {\n      const month = new Date(b.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' });\n      earningsByMonth[month] = (earningsByMonth[month] || 0) + (b.total_price * 0.85);\n    });\n\n    const monthlyData = Object.entries(earningsByMonth)\n      .map(([month, earnings]) => ({\n        month,\n        earnings: Math.round(earnings * 10),\n        usd: earnings\n      }))\n      .slice(-6);\n\n    const serviceTypes = {\n      basic: completed.filter(b => b.cleaning_type === 'basic').length,\n      deep: completed.filter(b => b.cleaning_type === 'deep').length,\n      moveout: completed.filter(b => b.cleaning_type === 'moveout').length\n    };\n\n    return {\n      totalJobs: completed.length,\n      totalEarnings: Math.round(totalEarnings * 10),\n      avgRating,\n      monthlyData,\n      serviceTypes,\n      reliabilityScore: profile?.reliability_score || 75\n    };\n  };\n\n  const stats = calculateStats();\n\n  const COLORS = ['#0078FF', '#00D4FF', '#28C76F', '#FFA500'];\n\n  const pieData = [\n    { name: 'Basic', value: stats.serviceTypes.basic },\n    { name: 'Deep', value: stats.serviceTypes.deep },\n    { name: 'Move-Out', value: stats.serviceTypes.moveout }\n  ].filter(d => d.value > 0);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Analytics Dashboard</h1>\n          <p className=\"text-lg text-gray-600 font-verdana\">Track your performance and earnings</p>\n        </div>\n\n        {/* Quick Stats */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }}>\n            <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all bg-gradient-to-br from-blue-50 to-white rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <BarChart3 className=\"w-10 h-10 text-puretask-blue mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalJobs}</p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Completed Jobs</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }}>\n            <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all bg-gradient-to-br from-green-50 to-white rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <DollarSign className=\"w-10 h-10 text-fresh-mint mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalEarnings}</p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Total Earnings (credits)</p>\n                <p className=\"text-xs text-gray-500 font-verdana\">‚âà ${(stats.totalEarnings / 10).toFixed(0)}</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}>\n            <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all bg-gradient-to-br from-amber-50 to-white rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <Star className=\"w-10 h-10 text-amber-500 mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.avgRating.toFixed(1)}</p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Average Rating</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}>\n            <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all bg-gradient-to-br from-purple-50 to-white rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <Target className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.reliabilityScore}</p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Reliability Score</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Charts */}\n        <Tabs defaultValue=\"earnings\" className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-md rounded-full p-1 font-fredoka\">\n            <TabsTrigger value=\"earnings\" className=\"rounded-full\">Earnings Trend</TabsTrigger>\n            <TabsTrigger value=\"services\" className=\"rounded-full\">Service Distribution</TabsTrigger>\n            <TabsTrigger value=\"performance\" className=\"rounded-full\">Performance</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"earnings\">\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-graphite\">Monthly Earnings</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <LineChart data={stats.monthlyData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#E5E7EB\" />\n                    <XAxis dataKey=\"month\" stroke=\"#6B7280\" style={{ fontFamily: 'Verdana' }} />\n                    <YAxis stroke=\"#6B7280\" style={{ fontFamily: 'Verdana' }} />\n                    <Tooltip \n                      contentStyle={{ \n                        fontFamily: 'Verdana', \n                        borderRadius: '16px',\n                        border: 'none',\n                        boxShadow: '0 4px 6px rgba(0,0,0,0.1)'\n                      }} \n                    />\n                    <Legend wrapperStyle={{ fontFamily: 'Fredoka' }} />\n                    <Line \n                      type=\"monotone\" \n                      dataKey=\"earnings\" \n                      stroke=\"#0078FF\" \n                      strokeWidth={3}\n                      dot={{ fill: '#0078FF', r: 6 }}\n                      name=\"Credits Earned\"\n                    />\n                  </LineChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"services\">\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-graphite\">Service Type Distribution</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <PieChart>\n                    <Pie\n                      data={pieData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      labelLine={false}\n                      label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}\n                      outerRadius={100}\n                      fill=\"#8884d8\"\n                      dataKey=\"value\"\n                    >\n                      {pieData.map((entry, index) => (\n                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                      ))}\n                    </Pie>\n                    <Tooltip \n                      contentStyle={{ \n                        fontFamily: 'Verdana',\n                        borderRadius: '16px',\n                        border: 'none',\n                        boxShadow: '0 4px 6px rgba(0,0,0,0.1)'\n                      }} \n                    />\n                  </PieChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"performance\">\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-6 text-center\">\n                  <Clock className=\"w-10 h-10 text-puretask-blue mx-auto mb-3\" />\n                  <p className=\"text-3xl font-fredoka font-bold text-puretask-blue mb-1\">\n                    {profile?.on_time_rate || 100}%\n                  </p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">On-Time Rate</p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-6 text-center\">\n                  <Camera className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n                  <p className=\"text-3xl font-fredoka font-bold text-purple-600 mb-1\">\n                    {profile?.photo_compliance_rate || 100}%\n                  </p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Photo Compliance</p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg rounded-2xl\">\n                <CardContent className=\"p-6 text-center\">\n                  <CheckCircle className=\"w-10 h-10 text-fresh-mint mx-auto mb-3\" />\n                  <p className=\"text-3xl font-fredoka font-bold text-fresh-mint mb-1\">98%</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Completion Rate</p>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":15,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":44,"fix":{"range":[805,810],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[804,809],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":16,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":37,"fix":{"range":[866,873],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[865,872],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingDown' is defined but never used.","line":16,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":75,"fix":{"range":[897,911],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingDown"},"fix":{"range":[896,910],"text":""},"desc":"Remove unused variable 'TrendingDown'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertTriangle' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":16,"fix":{"range":[911,928],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertTriangle"},"fix":{"range":[910,927],"text":""},"desc":"Remove unused variable 'AlertTriangle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'format' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":16,"fix":{"range":[1040,1048],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"format"},"fix":{"range":[1041,1048],"text":""},"desc":"Remove unused variable 'format'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ReliabilityMeterV2' is defined but never used.","line":21,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":26,"fix":{"range":[1091,1170],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ReliabilityMeterV2"},"fix":{"range":[1098,1122],"text":""},"desc":"Remove unused variable 'ReliabilityMeterV2'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'completedBookings' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":121,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":121,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"completedBookings"},"fix":{"range":[4979,5082],"text":""},"desc":"Remove unused variable 'completedBookings'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport AIInsightsWidget from '../components/ai/AIInsightsWidget';\nimport AITodoList from '../components/ai/AITodoList';\nimport AIAssistantOnboardingWizard from '../components/ai/AIAssistantOnboardingWizard';\nimport AIAssistantGuide from '../components/ai/AIAssistantGuide';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  TrendingUp, Briefcase, DollarSign, Calendar, Search, GraduationCap,\n  Settings, MessageSquare, Star, Award, Zap, BarChart3, ChevronRight,\n  Loader2, CheckCircle, Clock, Users, Video, Package, Target, TrendingDown,\n  AlertTriangle, Lightbulb, ArrowUp, Camera, MapPin, Bot\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format, startOfWeek, endOfWeek } from 'date-fns';\nimport ReliabilityMeterV2 from '../components/reliability/ReliabilityMeterV2';\nimport { getTierBadgeColor } from '../components/utils/tierColors';\nimport SmartSchedulingWidget from '../components/dashboard/SmartSchedulingWidget';\nimport UpcomingJobReminders from '../components/dashboard/UpcomingJobReminders';\nimport CleanerAssistantWidget from '../components/ai/CleanerAssistantWidget';\nimport FAQChatbot from '../components/chat/FAQChatbot';\n\nexport default function CleanerDashboard() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [weeklyStats, setWeeklyStats] = useState({\n    jobsThisWeek: 0,\n    hoursThisWeek: 0,\n    earningsThisWeek: 0,\n    pendingJobs: 0\n  });\n  const [unreadMessages, setUnreadMessages] = useState(0);\n  const [totalEarnings, setTotalEarnings] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [performanceMetrics, setPerformanceMetrics] = useState(null);\n  const [tierProgress, setTierProgress] = useState(null);\n  const [insights, setInsights] = useState([]);\n  const [showOnboarding, setShowOnboarding] = useState(false);\n  const [showAIGuide, setShowAIGuide] = useState(false);\n\n  useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const loadDashboardData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'cleaner') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load cleaner profile\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      if (profiles.length === 0) {\n        navigate(createPageUrl('CleanerOnboarding'));\n        return;\n      }\n      \n      const profile = profiles[0];\n      setCleanerProfile(profile);\n\n      // Check if AI guide should be shown (first time seeing dashboard)\n      const hasSeenGuide = localStorage.getItem(`ai_guide_seen_${currentUser.email}`);\n      if (!hasSeenGuide && !profile.communication_settings?.booking_confirmation?.enabled) {\n        setShowAIGuide(true);\n      }\n\n      // Load this week's bookings\n      const weekStart = startOfWeek(new Date());\n      const weekEnd = endOfWeek(new Date());\n      \n      const allBookings = await base44.entities.Booking.filter({\n        cleaner_email: currentUser.email\n      });\n\n      const thisWeekBookings = allBookings.filter(b => {\n        const bookingDate = new Date(b.date);\n        return bookingDate >= weekStart && bookingDate <= weekEnd;\n      });\n\n      const pendingJobs = allBookings.filter(b => \n        ['awaiting_cleaner_response', 'scheduled', 'accepted'].includes(b.status)\n      );\n\n      const weeklyHours = thisWeekBookings.reduce((sum, b) => sum + (b.hours || 0), 0);\n      const weeklyEarnings = thisWeekBookings\n        .filter(b => b.status === 'completed' || b.status === 'approved')\n        .reduce((sum, b) => sum + (b.total_price * (profile.payout_percentage || 0.8)), 0);\n\n      setWeeklyStats({\n        jobsThisWeek: thisWeekBookings.length,\n        hoursThisWeek: weeklyHours,\n        earningsThisWeek: weeklyEarnings,\n        pendingJobs: pendingJobs.length\n      });\n\n      // Load total earnings\n      const earnings = await base44.entities.CleanerEarning.filter({\n        cleaner_email: currentUser.email,\n        status: { $in: ['pending', 'batched', 'paid'] }\n      });\n      const total = earnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n      setTotalEarnings(total);\n\n      // Load unread messages\n      const threads = await base44.entities.ConversationThread.filter({\n        participants: { $in: [currentUser.email] }\n      });\n      const unread = threads.reduce((sum, t) => sum + (t.unread_count_cleaner || 0), 0);\n      setUnreadMessages(unread);\n\n      // Calculate performance metrics\n      const completedBookings = allBookings.filter(b => b.status === 'approved' || b.status === 'completed');\n      const metrics = {\n        totalJobs: profile.total_jobs || 0,\n        completionRate: profile.completion_confirmation_rate || 100,\n        averageRating: profile.average_rating || 5.0,\n        totalReviews: profile.total_reviews || 0,\n        onTimeRate: profile.on_time_rate || 100,\n        photoComplianceRate: profile.photo_compliance_rate || 100,\n        communicationRate: profile.communication_rate || 100,\n        attendanceRate: profile.attendance_rate || 100,\n        reliabilityScore: profile.reliability_score || 75\n      };\n      setPerformanceMetrics(metrics);\n\n      // Calculate tier progress\n      const tierThresholds = {\n        'Developing': { min: 0, max: 59, next: 'Semi Pro' },\n        'Semi Pro': { min: 60, max: 74, next: 'Pro' },\n        'Pro': { min: 75, max: 89, next: 'Elite' },\n        'Elite': { min: 90, max: 100, next: null }\n      };\n\n      const currentTierInfo = tierThresholds[profile.tier] || tierThresholds['Semi Pro'];\n      const progress = {\n        currentTier: profile.tier,\n        nextTier: currentTierInfo.next,\n        currentScore: metrics.reliabilityScore,\n        scoreNeeded: currentTierInfo.max + 1,\n        pointsToGo: Math.max(0, (currentTierInfo.max + 1) - metrics.reliabilityScore),\n        progressPercentage: ((metrics.reliabilityScore - currentTierInfo.min) / (currentTierInfo.max - currentTierInfo.min + 1)) * 100\n      };\n      setTierProgress(progress);\n\n      // Generate actionable insights\n      const generatedInsights = [];\n\n      if (metrics.onTimeRate < 95) {\n        generatedInsights.push({\n          type: 'warning',\n          icon: Clock,\n          title: 'Improve Punctuality',\n          message: `Your on-time rate is ${metrics.onTimeRate}%. Arriving late affects your score.`,\n          action: 'Set calendar reminders 30 mins before each job'\n        });\n      }\n\n      if (metrics.photoComplianceRate < 100) {\n        generatedInsights.push({\n          type: 'warning',\n          icon: Camera,\n          title: 'Upload More Photos',\n          message: `Photo compliance at ${metrics.photoComplianceRate}%. Photos build client trust.`,\n          action: 'Take 3+ before/after pairs for every job'\n        });\n      }\n\n      if (metrics.communicationRate < 90) {\n        generatedInsights.push({\n          type: 'warning',\n          icon: MessageSquare,\n          title: 'Respond Faster',\n          message: 'Quick responses lead to more bookings and better ratings.',\n          action: 'Enable push notifications for messages'\n        });\n      }\n\n      if (!profile.video_intro_url) {\n        generatedInsights.push({\n          type: 'tip',\n          icon: Video,\n          title: 'Add Video Introduction',\n          message: 'Cleaners with videos get 200% more bookings.',\n          action: 'Record a 30-second intro about yourself'\n        });\n      }\n\n      if (metrics.totalReviews < 5) {\n        generatedInsights.push({\n          type: 'tip',\n          icon: Star,\n          title: 'Build Your Reputation',\n          message: 'More reviews = higher trust. Ask satisfied clients to leave reviews.',\n          action: 'Complete more jobs to collect reviews'\n        });\n      }\n\n      if (progress.nextTier && progress.pointsToGo < 10) {\n        generatedInsights.push({\n          type: 'success',\n          icon: Target,\n          title: `Almost ${progress.nextTier}!`,\n          message: `You're ${progress.pointsToGo.toFixed(1)} points away from the next tier.`,\n          action: 'Focus on punctuality and photo quality'\n        });\n      }\n\n      if ((profile.service_locations?.length || 0) < 3) {\n        generatedInsights.push({\n          type: 'tip',\n          icon: MapPin,\n          title: 'Expand Service Areas',\n          message: 'Serving more areas increases booking opportunities.',\n          action: 'Add nearby neighborhoods to your profile'\n        });\n      }\n\n      setInsights(generatedInsights);\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading dashboard:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      {showAIGuide && (\n        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\n          <div className=\"bg-white rounded-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto\">\n            <AIAssistantGuide\n              onStartSetup={() => {\n                localStorage.setItem(`ai_guide_seen_${user.email}`, 'true');\n                setShowAIGuide(false);\n                setShowOnboarding(true);\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      {showOnboarding && cleanerProfile && (\n        <AIAssistantOnboardingWizard\n          cleanerProfile={cleanerProfile}\n          onComplete={() => {\n            setShowOnboarding(false);\n            loadDashboardData();\n          }}\n          onSkip={() => setShowOnboarding(false)}\n        />\n      )}\n      \n      <div className=\"max-w-7xl mx-auto\">\n        {/* Welcome Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n                Welcome back, {user?.full_name?.split(' ')[0] || 'there'}! üëã\n              </h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">\n                Here's your cleaning business overview\n              </p>\n            </div>\n            \n            {cleanerProfile?.tier && (\n              <Badge className={`text-lg px-6 py-2 rounded-full font-fredoka border ${getTierBadgeColor(cleanerProfile.tier)}`}>\n                <Award className=\"w-5 h-5 mr-2\" />\n                {cleanerProfile.tier}\n              </Badge>\n            )}\n          </div>\n        </motion.div>\n\n        {/* This Week Stats */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <Briefcase className=\"w-8 h-8 text-puretask-blue mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{weeklyStats.jobsThisWeek}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Jobs This Week</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <Clock className=\"w-8 h-8 text-purple-600 mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{weeklyStats.hoursThisWeek}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Hours This Week</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <DollarSign className=\"w-8 h-8 text-fresh-mint mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">${weeklyStats.earningsThisWeek.toFixed(0)}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Earned This Week</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl cursor-pointer hover:shadow-xl transition-all\"\n            onClick={() => navigate(createPageUrl('Inbox'))}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <MessageSquare className=\"w-8 h-8 text-amber-600\" />\n                {unreadMessages > 0 && (\n                  <Badge className=\"bg-red-500 text-white rounded-full font-fredoka\">\n                    {unreadMessages}\n                  </Badge>\n                )}\n              </div>\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{unreadMessages}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Unread Messages</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* AI Insights Widget - Top Priority */}\n        {cleanerProfile && (\n          <div className=\"mb-6\">\n            <AIInsightsWidget cleanerProfile={cleanerProfile} />\n          </div>\n        )}\n\n        {/* AI Personal Assistant - Priority Widget */}\n        <div className=\"mb-8\">\n          <CleanerAssistantWidget cleanerEmail={user?.email} />\n        </div>\n\n        {/* AI Widgets */}\n        <div className=\"grid lg:grid-cols-3 gap-6 mb-8\">\n          {cleanerProfile && (\n            <div>\n              <AITodoList cleanerEmail={cleanerProfile.user_email} />\n            </div>\n          )}\n          <SmartSchedulingWidget cleanerEmail={user?.email} onUpdate={loadDashboardData} />\n          <UpcomingJobReminders cleanerEmail={user?.email} />\n        </div>\n\n        {/* Performance Overview */}\n        {cleanerProfile && performanceMetrics && (\n          <div className=\"grid lg:grid-cols-3 gap-6 mb-8\">\n            {/* Reliability Score Card */}\n            <Card className=\"border-0 shadow-xl rounded-2xl overflow-hidden lg:col-span-2\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-500 to-cyan-500 text-white\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n                  <TrendingUp className=\"w-6 h-6\" />\n                  Reliability Score\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-6\">\n                  <div>\n                    <p className=\"text-6xl font-fredoka font-bold text-puretask-blue mb-2\">\n                      {performanceMetrics.reliabilityScore}\n                    </p>\n                    <p className=\"text-lg text-gray-600 font-verdana\">\n                      {performanceMetrics.reliabilityScore >= 90 ? 'Outstanding' : \n                       performanceMetrics.reliabilityScore >= 75 ? 'Excellent' : \n                       performanceMetrics.reliabilityScore >= 60 ? 'Good' : 'Developing'}\n                    </p>\n                  </div>\n                  <div className=\"w-32 h-32\">\n                    <svg viewBox=\"0 0 100 100\" className=\"transform -rotate-90\">\n                      <circle cx=\"50\" cy=\"50\" r=\"45\" fill=\"none\" stroke=\"#E5E7EB\" strokeWidth=\"10\" />\n                      <circle \n                        cx=\"50\" \n                        cy=\"50\" \n                        r=\"45\" \n                        fill=\"none\" \n                        stroke=\"url(#gradient)\" \n                        strokeWidth=\"10\"\n                        strokeDasharray={`${(performanceMetrics.reliabilityScore / 100) * 283} 283`}\n                        strokeLinecap=\"round\"\n                      />\n                      <defs>\n                        <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                          <stop offset=\"0%\" stopColor=\"#66B3FF\" />\n                          <stop offset=\"100%\" stopColor=\"#00D4FF\" />\n                        </linearGradient>\n                      </defs>\n                    </svg>\n                  </div>\n                </div>\n\n                {/* Performance Breakdown */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div className=\"bg-green-50 border-2 border-green-200 rounded-xl p-3 text-center\">\n                    <CheckCircle className=\"w-5 h-5 text-green-600 mx-auto mb-1\" />\n                    <p className=\"text-xl font-fredoka font-bold text-green-600\">{performanceMetrics.attendanceRate}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Attendance</p>\n                  </div>\n                  <div className=\"bg-blue-50 border-2 border-blue-200 rounded-xl p-3 text-center\">\n                    <Clock className=\"w-5 h-5 text-blue-600 mx-auto mb-1\" />\n                    <p className=\"text-xl font-fredoka font-bold text-blue-600\">{performanceMetrics.onTimeRate}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">On-Time</p>\n                  </div>\n                  <div className=\"bg-purple-50 border-2 border-purple-200 rounded-xl p-3 text-center\">\n                    <Camera className=\"w-5 h-5 text-purple-600 mx-auto mb-1\" />\n                    <p className=\"text-xl font-fredoka font-bold text-purple-600\">{performanceMetrics.photoComplianceRate}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Photo Quality</p>\n                  </div>\n                  <div className=\"bg-amber-50 border-2 border-amber-200 rounded-xl p-3 text-center\">\n                    <MessageSquare className=\"w-5 h-5 text-amber-600 mx-auto mb-1\" />\n                    <p className=\"text-xl font-fredoka font-bold text-amber-600\">{performanceMetrics.communicationRate}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Communication</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Career Stats */}\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader className=\"bg-gradient-to-r from-amber-500 to-orange-500 text-white\">\n                <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                  <Award className=\"w-5 h-5\" />\n                  Career Stats\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6 space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Briefcase className=\"w-5 h-5 text-puretask-blue\" />\n                    <span className=\"text-sm text-gray-600 font-verdana\">Total Jobs</span>\n                  </div>\n                  <span className=\"text-2xl font-fredoka font-bold text-graphite\">{performanceMetrics.totalJobs}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Star className=\"w-5 h-5 text-amber-400\" />\n                    <span className=\"text-sm text-gray-600 font-verdana\">Avg Rating</span>\n                  </div>\n                  <span className=\"text-2xl font-fredoka font-bold text-graphite\">{performanceMetrics.averageRating.toFixed(1)}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <DollarSign className=\"w-5 h-5 text-fresh-mint\" />\n                    <span className=\"text-sm text-gray-600 font-verdana\">Total Earned</span>\n                  </div>\n                  <span className=\"text-2xl font-fredoka font-bold text-graphite\">${totalEarnings.toFixed(0)}</span>\n                </div>\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <MessageSquare className=\"w-5 h-5 text-purple-600\" />\n                    <span className=\"text-sm text-gray-600 font-verdana\">Reviews</span>\n                  </div>\n                  <span className=\"text-2xl font-fredoka font-bold text-graphite\">{performanceMetrics.totalReviews}</span>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Tier Progress */}\n        {tierProgress && tierProgress.nextTier && (\n          <Card className=\"mb-8 border-0 shadow-xl rounded-2xl overflow-hidden\">\n            <CardHeader className=\"bg-gradient-to-r from-indigo-500 to-purple-500 text-white\">\n              <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n                <Target className=\"w-6 h-6\" />\n                Tier Progress: {tierProgress.currentTier} ‚Üí {tierProgress.nextTier}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"mb-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"text-sm font-verdana text-gray-600\">\n                    Current Score: {tierProgress.currentScore}\n                  </span>\n                  <span className=\"text-sm font-verdana text-gray-600\">\n                    Target: {tierProgress.scoreNeeded}\n                  </span>\n                </div>\n                <div className=\"h-4 bg-gray-200 rounded-full overflow-hidden\">\n                  <motion.div\n                    initial={{ width: 0 }}\n                    animate={{ width: `${Math.min(100, tierProgress.progressPercentage)}%` }}\n                    transition={{ duration: 1, ease: \"easeOut\" }}\n                    className=\"h-full bg-gradient-to-r from-indigo-500 to-purple-500\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-4\">\n                <div className=\"flex items-start gap-3\">\n                  <ArrowUp className=\"w-6 h-6 text-indigo-600 flex-shrink-0 mt-1\" />\n                  <div>\n                    <p className=\"font-fredoka font-bold text-graphite mb-1\">\n                      {tierProgress.pointsToGo.toFixed(1)} points to {tierProgress.nextTier}\n                    </p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      {tierProgress.nextTier === 'Elite' \n                        ? 'Unlock maximum earnings (85% payout) and premium client access' \n                        : `Increase your visibility and unlock higher rates`}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Insights & Tips */}\n        {insights.length > 0 && (\n          <Card className=\"mb-8 border-0 shadow-xl rounded-2xl\">\n            <CardHeader className=\"bg-gradient-to-r from-amber-500 to-yellow-500 text-white\">\n              <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n                <Lightbulb className=\"w-6 h-6\" />\n                Performance Insights\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-3\">\n                {insights.map((insight, idx) => {\n                  const Icon = insight.icon;\n                  const colorMap = {\n                    warning: { bg: 'bg-orange-50', border: 'border-orange-200', icon: 'text-orange-600' },\n                    tip: { bg: 'bg-blue-50', border: 'border-blue-200', icon: 'text-blue-600' },\n                    success: { bg: 'bg-green-50', border: 'border-green-200', icon: 'text-green-600' }\n                  };\n                  const colors = colorMap[insight.type] || colorMap.tip;\n\n                  return (\n                    <motion.div\n                      key={idx}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: idx * 0.1 }}\n                      className={`${colors.bg} border-2 ${colors.border} rounded-xl p-4`}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <Icon className={`w-6 h-6 ${colors.icon} flex-shrink-0 mt-1`} />\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-fredoka font-bold text-graphite mb-1\">{insight.title}</h3>\n                          <p className=\"text-sm text-gray-700 font-verdana mb-2\">{insight.message}</p>\n                          <p className=\"text-xs text-gray-600 font-verdana italic\">\n                            üí° {insight.action}\n                          </p>\n                        </div>\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Quick Actions */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-4\">Quick Actions</h2>\n          <div className=\"grid md:grid-cols-4 gap-4\">\n            <Button\n              onClick={() => navigate(createPageUrl('BrowseJobs'))}\n              className=\"h-auto py-6 brand-gradient text-white rounded-2xl font-fredoka font-semibold shadow-lg hover:shadow-xl flex flex-col items-center gap-2\"\n            >\n              <Search className=\"w-8 h-8\" />\n              <span>Find Jobs</span>\n            </Button>\n\n            <Button\n              onClick={() => navigate(createPageUrl('CleanerSchedule'))}\n              variant=\"outline\"\n              className=\"h-auto py-6 rounded-2xl font-fredoka font-semibold border-2 flex flex-col items-center gap-2\"\n            >\n              <Briefcase className=\"w-8 h-8\" />\n              <span>My Active Jobs</span>\n              {weeklyStats.pendingJobs > 0 && (\n                <Badge className=\"bg-puretask-blue text-white font-fredoka mt-1\">\n                  {weeklyStats.pendingJobs}\n                </Badge>\n              )}\n            </Button>\n\n            <Button\n              onClick={() => navigate(createPageUrl('CleanerCalendar'))}\n              variant=\"outline\"\n              className=\"h-auto py-6 rounded-2xl font-fredoka font-semibold border-2 flex flex-col items-center gap-2\"\n            >\n              <Calendar className=\"w-8 h-8\" />\n              <span>Job Calendar</span>\n            </Button>\n\n            <Button\n              onClick={() => navigate(createPageUrl('CleanerPayouts'))}\n              variant=\"outline\"\n              className=\"h-auto py-6 rounded-2xl font-fredoka font-semibold border-2 flex flex-col items-center gap-2\"\n            >\n              <DollarSign className=\"w-8 h-8\" />\n              <span>Earnings</span>\n            </Button>\n          </div>\n        </div>\n\n        {/* All Cleaner Pages Grid */}\n        <div className=\"mt-12\">\n          <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-6\">All Cleaner Features</h2>\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[\n              { \n                title: 'Job Marketplace', \n                icon: Search, \n                description: 'Find new cleaning opportunities',\n                path: 'BrowseJobs',\n                color: 'from-blue-50 to-cyan-50',\n                iconColor: 'text-puretask-blue'\n              },\n              { \n                title: 'My Active Jobs', \n                icon: Briefcase, \n                description: 'Manage accepted bookings',\n                path: 'CleanerSchedule',\n                color: 'from-purple-50 to-indigo-50',\n                iconColor: 'text-purple-600',\n                badge: weeklyStats.pendingJobs > 0 ? weeklyStats.pendingJobs : null\n              },\n              { \n                title: 'Job Calendar', \n                icon: Calendar, \n                description: 'View all jobs on a calendar',\n                path: 'CleanerCalendar',\n                color: 'from-indigo-50 to-blue-50',\n                iconColor: 'text-indigo-600'\n              },\n              { \n                title: 'Earnings & Payouts', \n                icon: DollarSign, \n                description: 'Track income and request payouts',\n                path: 'CleanerPayouts',\n                color: 'from-green-50 to-emerald-50',\n                iconColor: 'text-fresh-mint'\n              },\n              { \n                title: 'Analytics', \n                icon: BarChart3, \n                description: 'Performance metrics and insights',\n                path: 'CleanerAnalytics',\n                color: 'from-amber-50 to-orange-50',\n                iconColor: 'text-amber-600'\n              },\n              { \n                title: 'Resources & Education', \n                icon: GraduationCap, \n                description: 'Tips, discounts, and training',\n                path: 'CleanerResources',\n                color: 'from-pink-50 to-rose-50',\n                iconColor: 'text-pink-600'\n              },\n              { \n                title: 'Messages', \n                icon: MessageSquare, \n                description: 'Chat with clients',\n                path: 'Inbox',\n                color: 'from-blue-50 to-purple-50',\n                iconColor: 'text-puretask-blue',\n                badge: unreadMessages > 0 ? unreadMessages : null\n              },\n              { \n                title: 'Profile Settings', \n                icon: Settings, \n                description: 'Update rates, availability, services',\n                path: 'Profile',\n                color: 'from-gray-50 to-slate-50',\n                iconColor: 'text-gray-600'\n              },\n              { \n                title: 'AI Assistant Settings', \n                icon: Bot, \n                description: 'Configure AI communication & scheduling',\n                path: 'AIAssistantSettings',\n                color: 'from-blue-50 to-indigo-50',\n                iconColor: 'text-puretask-blue'\n              },\n              { \n                title: 'Reliability Score', \n                icon: TrendingUp, \n                description: 'Learn how your score is calculated',\n                path: 'ReliabilityScoreExplained',\n                color: 'from-cyan-50 to-teal-50',\n                iconColor: 'text-cyan-600'\n              },\n              { \n                title: 'Materials List', \n                icon: Package, \n                description: 'Recommended cleaning supplies',\n                path: 'MaterialsList',\n                color: 'from-indigo-50 to-violet-50',\n                iconColor: 'text-indigo-600'\n              }\n            ].map((item, idx) => (\n              <motion.div\n                key={item.path}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card \n                  className={`border-0 shadow-lg hover:shadow-xl transition-all rounded-2xl cursor-pointer bg-gradient-to-br ${item.color}`}\n                  onClick={() => navigate(createPageUrl(item.path))}\n                >\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <item.icon className={`w-10 h-10 ${item.iconColor}`} />\n                      {item.badge && (\n                        <Badge className=\"bg-puretask-blue text-white rounded-full font-fredoka\">\n                          {item.badge}\n                        </Badge>\n                      )}\n                    </div>\n                    <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">{item.title}</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-4\">{item.description}</p>\n                    <div className=\"flex items-center text-puretask-blue font-fredoka font-medium text-sm\">\n                      Open <ChevronRight className=\"w-4 h-4 ml-1\" />\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n\n        {/* Profile Completion Checklist */}\n        {cleanerProfile && (\n          <Card className=\"mt-8 border-0 shadow-xl bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n                <CheckCircle className=\"w-6 h-6 text-purple-600\" />\n                Profile Optimization\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                {[\n                  { \n                    label: 'Video Introduction', \n                    completed: !!cleanerProfile.video_intro_url,\n                    impact: '+200% bookings',\n                    action: () => navigate(createPageUrl('Profile'))\n                  },\n                  { \n                    label: 'Product Photos', \n                    completed: cleanerProfile.product_photos_verified,\n                    impact: '+34% bookings',\n                    action: () => navigate(createPageUrl('Profile'))\n                  },\n                  { \n                    label: 'Instant Book Enabled', \n                    completed: cleanerProfile.instant_book_enabled,\n                    impact: '+30% bookings',\n                    action: () => navigate(createPageUrl('Profile'))\n                  },\n                  { \n                    label: 'Bio & Specialties', \n                    completed: !!cleanerProfile.bio && (cleanerProfile.specialty_tags?.length > 0),\n                    impact: 'Better matches',\n                    action: () => navigate(createPageUrl('Profile'))\n                  }\n                ].map((item, i) => (\n                  <div\n                    key={i}\n                    className={`p-4 rounded-2xl border-2 cursor-pointer hover:shadow-md transition-all ${\n                      item.completed\n                        ? 'bg-green-100 border-fresh-mint'\n                        : 'bg-white border-gray-200'\n                    }`}\n                    onClick={item.action}\n                  >\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <span className=\"font-fredoka font-semibold text-graphite\">{item.label}</span>\n                      {item.completed ? (\n                        <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      ) : (\n                        <Clock className=\"w-5 h-5 text-gray-400\" />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-gray-600 font-verdana\">{item.impact}</p>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* FAQ Chatbot */}\n      {user && <FAQChatbot agentName=\"cleanerFAQChatbot\" title=\"Cleaner Assistant\" userType=\"cleaner\" />}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerInsights.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[625,629],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { TrendingUp, AlertCircle, CheckCircle, Target, Zap, Loader2 } from 'lucide-react';\nimport ReliabilityMeterV2 from '../components/reliability/ReliabilityMeterV2';\n\nexport default function CleanerInsights() {\n  const [user, setUser] = useState(null);\n  const [profile, setProfile] = useState(null);\n  const [insights, setInsights] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      const [cleanerProfile] = await base44.entities.CleanerProfile.filter({\n        user_email: currentUser.email\n      });\n      setProfile(cleanerProfile);\n\n      const bookings = await base44.entities.Booking.filter({\n        cleaner_email: currentUser.email\n      }, '-date', 100);\n\n      const completedBookings = bookings.filter(b => b.status === 'completed');\n      const last30Days = new Date();\n      last30Days.setDate(last30Days.getDate() - 30);\n\n      const recent = completedBookings.filter(\n        b => new Date(b.date) >= last30Days\n      );\n\n      // Earnings trend (last 8 weeks)\n      const weeklyEarnings = [];\n      for (let i = 7; i >= 0; i--) {\n        const weekStart = new Date();\n        weekStart.setDate(weekStart.getDate() - (i * 7));\n        const weekEnd = new Date(weekStart);\n        weekEnd.setDate(weekEnd.getDate() + 7);\n\n        const weekBookings = completedBookings.filter(b => {\n          const date = new Date(b.date);\n          return date >= weekStart && date < weekEnd;\n        });\n\n        weeklyEarnings.push({\n          week: `Week ${8 - i}`,\n          earnings: weekBookings.reduce((sum, b) => sum + (b.total_price * 0.85), 0),\n          bookings: weekBookings.length\n        });\n      }\n\n      // Reviews distribution\n      const reviews = await base44.entities.Review.filter({\n        cleaner_email: currentUser.email\n      });\n\n      const ratingDistribution = [1, 2, 3, 4, 5].map(rating => ({\n        rating: `${rating} ‚≠ê`,\n        count: reviews.filter(r => r.rating === rating).length\n      }));\n\n      // Task performance\n      const taskCounts = {};\n      completedBookings.forEach(b => {\n        (b.tasks || []).forEach(task => {\n          taskCounts[task] = (taskCounts[task] || 0) + 1;\n        });\n      });\n\n      const topTasks = Object.entries(taskCounts)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5)\n        .map(([task, count]) => ({\n          task: task.replace(/_/g, ' '),\n          count\n        }));\n\n      // Recommendations\n      const recommendations = [];\n      \n      if ((cleanerProfile.photo_proof_rate || 0) < 95) {\n        recommendations.push({\n          type: 'warning',\n          title: 'Photo Compliance Low',\n          description: `You're at ${cleanerProfile.photo_proof_rate || 0}%. Upload before/after photos for every booking to reach 100%.`,\n          impact: '+5 reliability points'\n        });\n      }\n\n      if ((cleanerProfile.punctuality_rate || 0) < 95) {\n        recommendations.push({\n          type: 'warning',\n          title: 'Punctuality Can Improve',\n          description: `Arrive within 15 minutes of scheduled time. Currently at ${cleanerProfile.punctuality_rate || 0}%.`,\n          impact: '+3 reliability points'\n        });\n      }\n\n      if ((cleanerProfile.total_reviews || 0) < 10) {\n        recommendations.push({\n          type: 'info',\n          title: 'Get More Reviews',\n          description: 'After each booking, politely ask clients to leave a review. More reviews = more bookings!',\n          impact: 'Increased visibility'\n        });\n      }\n\n      if (cleanerProfile.tier === 'Semi Pro' && cleanerProfile.reliability_score >= 78) {\n        recommendations.push({\n          type: 'success',\n          title: 'Ready for Pro Tier!',\n          description: `Complete ${Math.max(0, 30 - (cleanerProfile.total_jobs || 0))} more jobs to unlock Pro status and higher rates.`,\n          impact: 'Higher earnings'\n        });\n      }\n\n      setInsights({\n        weeklyEarnings,\n        ratingDistribution,\n        topTasks,\n        recommendations,\n        recentBookings: recent.length,\n        avgRating: reviews.length > 0 ? (reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length) : 0,\n        totalEarnings: completedBookings.reduce((sum, b) => sum + (b.total_price * 0.85), 0)\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading insights:', showToast: false });\n    }\n\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  if (!profile || !insights) {\n    return (\n      <div className=\"min-h-screen p-6 flex items-center justify-center\">\n        <p className=\"text-lg text-slate-600\">Unable to load insights</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-gradient-to-br from-slate-50 to-slate-100\">\n      <div className=\"max-w-7xl mx-auto\">\n        <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Performance Insights</h1>\n        <p className=\"text-lg text-slate-600 mb-8\">Track your progress and discover ways to improve</p>\n\n        {/* Key Metrics */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg\">\n            <CardContent className=\"p-6 flex items-center justify-center\">\n              <ReliabilityMeterV2\n                score={profile.reliability_score}\n                tier={profile.tier}\n                size=\"small\"\n                showLabel={true}\n              />\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg\">\n            <CardContent className=\"p-6\">\n              <TrendingUp className=\"w-8 h-8 text-emerald-500 mb-2\" />\n              <p className=\"text-3xl font-bold text-slate-900\">{insights.recentBookings}</p>\n              <p className=\"text-sm text-slate-600\">Last 30 Days</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg\">\n            <CardContent className=\"p-6\">\n              <Zap className=\"w-8 h-8 text-amber-500 mb-2\" />\n              <p className=\"text-3xl font-bold text-slate-900\">{insights.avgRating.toFixed(1)}‚≠ê</p>\n              <p className=\"text-sm text-slate-600\">Average Rating</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg\">\n            <CardContent className=\"p-6\">\n              <Target className=\"w-8 h-8 text-blue-500 mb-2\" />\n              <p className=\"text-3xl font-bold text-slate-900\">${insights.totalEarnings.toFixed(0)}</p>\n              <p className=\"text-sm text-slate-600\">Total Earnings</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recommendations */}\n        {insights.recommendations.length > 0 && (\n          <Card className=\"border-0 shadow-lg mb-8\">\n            <CardHeader>\n              <CardTitle>Ways to Improve</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {insights.recommendations.map((rec, idx) => (\n                <div\n                  key={idx}\n                  className={`p-4 rounded-lg border-2 ${\n                    rec.type === 'warning'\n                      ? 'border-amber-200 bg-amber-50'\n                      : rec.type === 'success'\n                      ? 'border-emerald-200 bg-emerald-50'\n                      : 'border-blue-200 bg-blue-50'\n                  }`}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    {rec.type === 'warning' && <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5\" />}\n                    {rec.type === 'success' && <CheckCircle className=\"w-5 h-5 text-emerald-600 mt-0.5\" />}\n                    {rec.type === 'info' && <Target className=\"w-5 h-5 text-blue-600 mt-0.5\" />}\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-semibold text-slate-900 mb-1\">{rec.title}</h4>\n                      <p className=\"text-sm text-slate-700 mb-2\">{rec.description}</p>\n                      <Badge className=\"text-xs\">{rec.impact}</Badge>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Charts */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-8\">\n          {/* Earnings Trend */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>Earnings Trend</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <LineChart data={insights.weeklyEarnings}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"week\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"earnings\" stroke=\"#10b981\" strokeWidth={2} name=\"Earnings ($)\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          {/* Rating Distribution */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>Rating Distribution</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <BarChart data={insights.ratingDistribution}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"rating\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Bar dataKey=\"count\" fill=\"#8b5cf6\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          {/* Top Tasks */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>Most Booked Services</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <BarChart data={insights.topTasks} layout=\"vertical\">\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis type=\"number\" />\n                  <YAxis dataKey=\"task\" type=\"category\" width={120} />\n                  <Tooltip />\n                  <Bar dataKey=\"count\" fill=\"#3b82f6\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n\n          {/* Booking Activity */}\n          <Card className=\"border-0 shadow-lg\">\n            <CardHeader>\n              <CardTitle>Weekly Activity</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <LineChart data={insights.weeklyEarnings}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"week\" />\n                  <YAxis />\n                  <Tooltip />\n                  <Legend />\n                  <Line type=\"monotone\" dataKey=\"bookings\" stroke=\"#f59e0b\" strokeWidth={2} name=\"Bookings\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerJobDetail.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":8,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// CleanerJobDetail - AI-Powered Job Workflow Component\r\n// Handles entire job lifecycle from acceptance to completion\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { cleanerJobsService } from '@/services/cleanerJobsService';\r\nimport type { JobRecord } from '@/types/cleanerJobTypes';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Alert, AlertDescription } from '@/components/ui/alert';\r\nimport {\r\n  MapPin, Clock, DollarSign, Camera, CheckCircle, AlertTriangle,\r\n  Navigation, PlayCircle, StopCircle, Upload, MessageSquare,\r\n  Zap, Timer, Info, ChevronRight, Loader2\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { motion } from 'framer-motion';\r\nimport { format } from 'date-fns';\r\nimport { FloatingAIAssistant } from '@/components/ai/CleanerAIChatAssistant';\r\n\r\nexport default function CleanerJobDetail() {\r\n  const { jobId } = useParams<{ jobId: string }>();\r\n  const navigate = useNavigate();\r\n  \r\n  const [user, setUser] = useState<any>(null);\r\n  const [job, setJob] = useState<JobRecord | null>(null);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [actionLoading, setActionLoading] = useState<boolean>(false);\r\n  \r\n  // GPS state\r\n  const [currentLocation, setCurrentLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n  const [locationError, setLocationError] = useState<string>('');\r\n  \r\n  // Photo state\r\n  const [beforePhotos, setBeforePhotos] = useState<File[]>([]);\r\n  const [afterPhotos, setAfterPhotos] = useState<File[]>([]);\r\n  const [uploading, setUploading] = useState<boolean>(false);\r\n  \r\n  // Extra time state\r\n  const [showExtraTimeForm, setShowExtraTimeForm] = useState<boolean>(false);\r\n  const [extraMinutes, setExtraMinutes] = useState<number>(30);\r\n  const [extraTimeReason, setExtraTimeReason] = useState<string>('');\r\n  \r\n  // Timer state\r\n  const [elapsedTime, setElapsedTime] = useState<number>(0);\r\n  \r\n  useEffect(() => {\r\n    loadJob();\r\n    getCurrentLocation();\r\n  }, [jobId]);\r\n  \r\n  // Timer effect\r\n  useEffect(() => {\r\n    if (job?.state === 'IN_PROGRESS' && job.start_at) {\r\n      const interval = setInterval(() => {\r\n        const start = new Date(job.start_at!);\r\n        const now = new Date();\r\n        const diffMs = now.getTime() - start.getTime();\r\n        const diffMinutes = Math.floor(diffMs / (1000 * 60));\r\n        setElapsedTime(diffMinutes);\r\n      }, 1000);\r\n      \r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [job?.state, job?.start_at]);\r\n  \r\n  const loadJob = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const currentUser = await base44.auth.me();\r\n      setUser(currentUser);\r\n      \r\n      const jobData = await cleanerJobsService.getJob(jobId!, currentUser.email);\r\n      if (!jobData) {\r\n        toast.error('Job not found or you are not assigned to this job');\r\n        navigate('/CleanerDashboard');\r\n        return;\r\n      }\r\n      \r\n      setJob(jobData);\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to load job');\r\n      navigate('/CleanerDashboard');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const getCurrentLocation = () => {\r\n    if ('geolocation' in navigator) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          setCurrentLocation({\r\n            lat: position.coords.latitude,\r\n            lng: position.coords.longitude\r\n          });\r\n        },\r\n        (error) => {\r\n          setLocationError('Unable to get your location. Please enable GPS.');\r\n        },\r\n        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }\r\n      );\r\n    } else {\r\n      setLocationError('GPS not supported by your device.');\r\n    }\r\n  };\r\n  \r\n  // ACTION HANDLERS\r\n  \r\n  const handleMarkEnRoute = async () => {\r\n    if (!currentLocation) {\r\n      toast.error('GPS location required');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setActionLoading(true);\r\n      const updated = await cleanerJobsService.markEnRoute(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        currentLocation\r\n      );\r\n      setJob(updated);\r\n      toast.success('‚úÖ Marked as en route - Client notified!');\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to mark en route');\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleMarkArrived = async () => {\r\n    if (!currentLocation) {\r\n      toast.error('GPS location required');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setActionLoading(true);\r\n      const updated = await cleanerJobsService.markArrived(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        currentLocation\r\n      );\r\n      setJob(updated);\r\n      toast.success('‚úÖ Checked in successfully!');\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'GPS check-in failed: ' + error.message);\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleStartJob = async () => {\r\n    if (!currentLocation) {\r\n      toast.error('GPS location required');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setActionLoading(true);\r\n      const updated = await cleanerJobsService.startJob(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        currentLocation\r\n      );\r\n      setJob(updated);\r\n      toast.success('‚úÖ Job started - Timer running!');\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to start job');\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleUploadBeforePhoto = async (file: File) => {\r\n    try {\r\n      setUploading(true);\r\n      const result = await cleanerJobsService.uploadBeforePhoto(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        file\r\n      );\r\n      setJob({ ...job!, before_photos_count: result.count });\r\n      toast.success(`Before photo ${result.count}/3 uploaded`);\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to upload photo');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n  \r\n  const handleUploadAfterPhoto = async (file: File) => {\r\n    try {\r\n      setUploading(true);\r\n      const result = await cleanerJobsService.uploadAfterPhoto(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        file\r\n      );\r\n      setJob({ ...job!, after_photos_count: result.count });\r\n      toast.success(`After photo ${result.count}/3 uploaded`);\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to upload photo');\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n  \r\n  const handleRequestExtraTime = async () => {\r\n    if (!extraTimeReason.trim()) {\r\n      toast.error('Please provide a reason for extra time');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setActionLoading(true);\r\n      const updated = await cleanerJobsService.requestExtraTime(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        extraMinutes,\r\n        extraTimeReason\r\n      );\r\n      setJob(updated);\r\n      toast.success('‚è±Ô∏è Extra time request sent to client');\r\n      setShowExtraTimeForm(false);\r\n      setExtraTimeReason('');\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to request extra time');\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  const handleCompleteJob = async () => {\r\n    if (!currentLocation) {\r\n      toast.error('GPS location required');\r\n      return;\r\n    }\r\n    \r\n    if ((job?.before_photos_count || 0) < 3) {\r\n      toast.error('Please upload 3 before photos');\r\n      return;\r\n    }\r\n    \r\n    if ((job?.after_photos_count || 0) < 3) {\r\n      toast.error('Please upload 3 after photos');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setActionLoading(true);\r\n      const updated = await cleanerJobsService.completeJob(\r\n        jobId!,\r\n        user!.email,\r\n        user!.id,\r\n        currentLocation\r\n      );\r\n      setJob(updated);\r\n      toast.success('üéâ Job completed! Waiting for client approval.');\r\n      navigate('/CleanerDashboard');\r\n    } catch (error: any) {\r\n      toast.error(error.message || 'Failed to complete job');\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  };\r\n  \r\n  // RENDERING HELPERS\r\n  \r\n  const getStateBadge = () => {\r\n    const stateConfig: Record<string, { label: string; variant: any; icon: any }> = {\r\n      ASSIGNED: { label: 'Assigned', variant: 'system', icon: CheckCircle },\r\n      EN_ROUTE: { label: 'En Route', variant: 'system', icon: Navigation },\r\n      ARRIVED: { label: 'Arrived', variant: 'system', icon: MapPin },\r\n      IN_PROGRESS: { label: 'In Progress', variant: 'system', icon: PlayCircle },\r\n      AWAITING_CLIENT_REVIEW: { label: 'Awaiting Review', variant: 'warning', icon: Clock },\r\n      COMPLETED_APPROVED: { label: 'Approved', variant: 'success', icon: CheckCircle }\r\n    };\r\n    \r\n    const config = stateConfig[job?.state || ''] || { label: job?.state, variant: 'default', icon: Info };\r\n    const Icon = config.icon;\r\n    \r\n    return (\r\n      <Badge variant={config.variant} className=\"font-heading text-base\">\r\n        <Icon className=\"w-4 h-4 mr-1\" />\r\n        {config.label}\r\n      </Badge>\r\n    );\r\n  };\r\n  \r\n  const formatTime = (minutes: number) => {\r\n    const hrs = Math.floor(minutes / 60);\r\n    const mins = minutes % 60;\r\n    return `${hrs}h ${mins}m`;\r\n  };\r\n  \r\n  // LOADING STATE\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-system\" />\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (!job) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <Alert>\r\n          <AlertTriangle className=\"w-4 h-4\" />\r\n          <AlertDescription>Job not found</AlertDescription>\r\n        </Alert>\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  // RENDER MAIN UI\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8 max-w-4xl\">\r\n      {/* Header */}\r\n      <motion.div\r\n        initial={{ opacity: 0, y: -20 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        className=\"mb-6\"\r\n      >\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h1 className=\"text-3xl font-heading font-bold text-graphite\">\r\n            Job Details\r\n          </h1>\r\n          {getStateBadge()}\r\n        </div>\r\n        \r\n        {/* Job Info Card */}\r\n        <Card className=\"border-system-border\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <p className=\"text-sm font-body text-gray-600\">Date & Time</p>\r\n                <p className=\"font-heading font-semibold\">{job.date} at {job.time}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm font-body text-gray-600\">Duration</p>\r\n                <p className=\"font-heading font-semibold\">{job.duration_hours} hours</p>\r\n              </div>\r\n              <div className=\"col-span-2\">\r\n                <p className=\"text-sm font-body text-gray-600\">Address</p>\r\n                <p className=\"font-heading font-semibold flex items-center gap-2\">\r\n                  <MapPin className=\"w-4 h-4 text-system\" />\r\n                  {job.address}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </motion.div>\r\n      \r\n      {/* GPS Status */}\r\n      {locationError && (\r\n        <Alert variant=\"destructive\" className=\"mb-4\">\r\n          <AlertTriangle className=\"w-4 h-4\" />\r\n          <AlertDescription>{locationError}</AlertDescription>\r\n        </Alert>\r\n      )}\r\n      \r\n      {/* Timer (when in progress) */}\r\n      {job.state === 'IN_PROGRESS' && (\r\n        <Card className=\"mb-6 bg-system-soft border-system-border\">\r\n          <CardContent className=\"p-6 text-center\">\r\n            <Timer className=\"w-12 h-12 text-system mx-auto mb-2\" />\r\n            <p className=\"text-3xl font-heading font-bold text-system\">\r\n              {formatTime(elapsedTime)}\r\n            </p>\r\n            <p className=\"text-sm font-body text-gray-600 mt-1\">\r\n              Max billable: {formatTime(job.max_billable_minutes || 0)}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n      \r\n      {/* Action Buttons */}\r\n      <div className=\"space-y-4\">\r\n        {job.state === 'ASSIGNED' && (\r\n          <Button\r\n            onClick={handleMarkEnRoute}\r\n            disabled={actionLoading || !currentLocation}\r\n            className=\"w-full bg-system hover:bg-system/90 text-white font-heading font-semibold\"\r\n            size=\"lg\"\r\n          >\r\n            {actionLoading ? <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" /> : <Navigation className=\"w-5 h-5 mr-2\" />}\r\n            Mark En Route\r\n          </Button>\r\n        )}\r\n        \r\n        {job.state === 'EN_ROUTE' && (\r\n          <>\r\n            <Button\r\n              onClick={handleMarkArrived}\r\n              disabled={actionLoading || !currentLocation}\r\n              className=\"w-full bg-system hover:bg-system/90 text-white font-heading font-semibold\"\r\n              size=\"lg\"\r\n            >\r\n              {actionLoading ? <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" /> : <MapPin className=\"w-5 h-5 mr-2\" />}\r\n              Check In (I've Arrived)\r\n            </Button>\r\n            <p className=\"text-sm font-body text-center text-gray-600\">\r\n              Must be within 250m of job address\r\n            </p>\r\n          </>\r\n        )}\r\n        \r\n        {(job.state === 'ARRIVED' || job.state === 'EN_ROUTE') && (\r\n          <Button\r\n            onClick={handleStartJob}\r\n            disabled={actionLoading || !currentLocation}\r\n            className=\"w-full bg-success hover:bg-success/90 text-white font-heading font-semibold\"\r\n            size=\"lg\"\r\n          >\r\n            {actionLoading ? <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" /> : <PlayCircle className=\"w-5 h-5 mr-2\" />}\r\n            Start Job\r\n          </Button>\r\n        )}\r\n        \r\n        {job.state === 'IN_PROGRESS' && (\r\n          <>\r\n            {/* Photo Upload Section */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle className=\"font-heading text-lg\">Photos Required</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div>\r\n                  <label className=\"block font-heading font-semibold mb-2\">\r\n                    Before Photos ({job.before_photos_count || 0}/3)\r\n                  </label>\r\n                  <input\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    capture=\"environment\"\r\n                    onChange={(e) => e.target.files?.[0] && handleUploadBeforePhoto(e.target.files[0])}\r\n                    disabled={uploading || (job.before_photos_count || 0) >= 3}\r\n                    className=\"w-full\"\r\n                  />\r\n                </div>\r\n                \r\n                <div>\r\n                  <label className=\"block font-heading font-semibold mb-2\">\r\n                    After Photos ({job.after_photos_count || 0}/3)\r\n                  </label>\r\n                  <input\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    capture=\"environment\"\r\n                    onChange={(e) => e.target.files?.[0] && handleUploadAfterPhoto(e.target.files[0])}\r\n                    disabled={uploading || (job.after_photos_count || 0) >= 3}\r\n                    className=\"w-full\"\r\n                  />\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            {/* Extra Time Request */}\r\n            {!showExtraTimeForm && !job.has_pending_extra_time_request && (\r\n              <Button\r\n                onClick={() => setShowExtraTimeForm(true)}\r\n                variant=\"outline\"\r\n                className=\"w-full font-heading\"\r\n              >\r\n                <Zap className=\"w-4 h-4 mr-2\" />\r\n                Request Extra Time\r\n              </Button>\r\n            )}\r\n            \r\n            {showExtraTimeForm && (\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"font-heading\">Request Extra Time</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div>\r\n                    <label className=\"block font-heading font-semibold mb-2\">Minutes Needed</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={extraMinutes}\r\n                      onChange={(e) => setExtraMinutes(Number(e.target.value))}\r\n                      className=\"w-full border rounded p-2\"\r\n                      min=\"15\"\r\n                      step=\"15\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block font-heading font-semibold mb-2\">Reason</label>\r\n                    <textarea\r\n                      value={extraTimeReason}\r\n                      onChange={(e) => setExtraTimeReason(e.target.value)}\r\n                      className=\"w-full border rounded p-2 h-24\"\r\n                      placeholder=\"Why do you need extra time?\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button onClick={handleRequestExtraTime} disabled={actionLoading} className=\"flex-1\">\r\n                      Send Request\r\n                    </Button>\r\n                    <Button onClick={() => setShowExtraTimeForm(false)} variant=\"outline\">\r\n                      Cancel\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n            \r\n            {job.has_pending_extra_time_request && (\r\n              <Alert>\r\n                <Clock className=\"w-4 h-4\" />\r\n                <AlertDescription>Extra time request pending client approval</AlertDescription>\r\n              </Alert>\r\n            )}\r\n            \r\n            {/* Complete Job Button */}\r\n            <Button\r\n              onClick={handleCompleteJob}\r\n              disabled={actionLoading || !currentLocation || (job.before_photos_count || 0) < 3 || (job.after_photos_count || 0) < 3}\r\n              className=\"w-full bg-success hover:bg-success/90 text-white font-heading font-semibold\"\r\n              size=\"lg\"\r\n            >\r\n              {actionLoading ? <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" /> : <CheckCircle className=\"w-5 h-5 mr-2\" />}\r\n              Complete Job\r\n            </Button>\r\n            \r\n            {((job.before_photos_count || 0) < 3 || (job.after_photos_count || 0) < 3) && (\r\n              <p className=\"text-sm font-body text-center text-gray-600\">\r\n                Upload all photos before completing\r\n              </p>\r\n            )}\r\n          </>\r\n        )}\r\n        \r\n        {job.state === 'AWAITING_CLIENT_REVIEW' && (\r\n          <Alert>\r\n            <CheckCircle className=\"w-4 h-4 text-success\" />\r\n            <AlertDescription>\r\n              Job completed! Waiting for client to approve and release payment.\r\n            </AlertDescription>\r\n          </Alert>\r\n        )}\r\n        \r\n        {job.state === 'COMPLETED_APPROVED' && (\r\n          <Alert>\r\n            <CheckCircle className=\"w-4 h-4 text-success\" />\r\n            <AlertDescription>\r\n              ‚úÖ Job approved! Earnings: ${((job.final_credits_charged || 0) * 0.8).toFixed(2)}\r\n            </AlertDescription>\r\n          </Alert>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Floating AI Assistant */}\r\n      <FloatingAIAssistant\r\n        currentJob={job}\r\n        cleanerId={user?.id || ''}\r\n        cleanerEmail={user?.email || ''}\r\n        stats={{\r\n          totalJobs: 0, // TODO: fetch from cleaner profile\r\n          reliabilityScore: 0,\r\n          avgRating: 0,\r\n          totalEarnings: 0\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerJobWorkspace.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Play' is defined but never used.","line":12,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":58,"fix":{"range":[609,615],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Play"},"fix":{"range":[608,614],"text":""},"desc":"Remove unused variable 'Play'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Square' is defined but never used.","line":12,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":66,"fix":{"range":[614,622],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Square"},"fix":{"range":[614,622],"text":""},"desc":"Remove unused variable 'Square'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[1344,1348],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { \n  MapPin, Clock, Sparkles, Calendar, CheckCircle2, \n  Loader2, AlertTriangle, Navigation, MessageSquare, Play, Square\n} from 'lucide-react';\nimport { format } from 'date-fns';\nimport JobStartCheckIn from '../components/jobs/JobStartCheckIn';\nimport JobPhotoUpload from '../components/jobs/JobPhotoUpload';\nimport JobTaskChecklist from '../components/jobs/JobTaskChecklist';\nimport JobEndCheckOut from '../components/jobs/JobEndCheckOut';\nimport InJobIssueReporter from '../components/jobs/InJobIssueReporter';\nimport JobSummaryModal from '../components/jobs/JobSummaryModal';\nimport PhotoProofProgress from '../components/booking/PhotoProofProgress';\n\nexport default function CleanerJobWorkspace() {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const bookingId = searchParams.get('booking');\n  \n  const [user, setUser] = useState(null);\n  const [booking, setBooking] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [currentStage, setCurrentStage] = useState('start'); // start, before_photos, in_progress, after_photos, end, complete\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [showSummary, setShowSummary] = useState(false);\n\n  useEffect(() => {\n    loadJobData();\n  }, [bookingId]);\n\n  useEffect(() => {\n    let interval;\n    if (currentStage === 'in_progress' && booking?.check_in_time) {\n      interval = setInterval(() => {\n        const start = new Date(booking.check_in_time);\n        const now = new Date();\n        setElapsedTime(Math.floor((now - start) / 1000));\n      }, 1000);\n    }\n    return () => clearInterval(interval);\n  }, [currentStage, booking]);\n\n  const loadJobData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('SignIn'));\n        return;\n      }\n      setUser(currentUser);\n\n      if (!bookingId) {\n        navigate(createPageUrl('CleanerSchedule'));\n        return;\n      }\n\n      const bookings = await base44.entities.Booking.filter({ id: bookingId });\n      if (bookings.length === 0) {\n        navigate(createPageUrl('CleanerSchedule'));\n        return;\n      }\n\n      const bookingData = bookings[0];\n      setBooking(bookingData);\n\n      // Load client profile (for first name only)\n      const profiles = await base44.entities.ClientProfile.filter({\n        user_email: bookingData.client_email\n      });\n      if (profiles.length > 0) {\n        setClientProfile(profiles[0]);\n      }\n\n      // Determine current stage based on booking status and data\n      determineStage(bookingData);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading job:', showToast: false });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const determineStage = (bookingData) => {\n    if (bookingData.check_out_time) {\n      setCurrentStage('complete');\n    } else if (bookingData.after_photos && bookingData.after_photos.length >= 3) {\n      setCurrentStage('end');\n    } else if (bookingData.before_photos && bookingData.before_photos.length >= 3) {\n      setCurrentStage('in_progress');\n    } else if (bookingData.check_in_time) {\n      setCurrentStage('before_photos');\n    } else {\n      setCurrentStage('start');\n    }\n  };\n\n  const handleJobStarted = async () => {\n    await loadJobData();\n    setCurrentStage('before_photos');\n  };\n\n  const handleBeforePhotosComplete = async () => {\n    await loadJobData();\n    setCurrentStage('in_progress');\n  };\n\n  const handleReadyToFinish = () => {\n    setCurrentStage('after_photos');\n  };\n\n  const handleAfterPhotosComplete = async () => {\n    await loadJobData();\n    setCurrentStage('end');\n  };\n\n  const handleJobEnded = async () => {\n    await loadJobData();\n    \n    // Trigger post-cleaning summary automation\n    try {\n      await base44.functions.invoke('sendPostCleaningSummary', { booking_id: booking.id });\n    } catch (e) {\n      console.log('Post-cleaning automation failed:', e);\n    }\n    \n    setCurrentStage('complete');\n    setShowSummary(true);\n  };\n\n  const formatTime = (seconds) => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const getCleaningTypeLabel = (type) => {\n    const types = {\n      basic: 'Basic Cleaning',\n      deep: 'Deep Cleaning',\n      moveout: 'Move-Out Cleaning'\n    };\n    return types[type] || type;\n  };\n\n  const openMapNavigation = () => {\n    if (booking?.latitude && booking?.longitude) {\n      const url = `https://www.google.com/maps/dir/?api=1&destination=${booking.latitude},${booking.longitude}`;\n      window.open(url, '_blank');\n    } else if (booking?.address) {\n      const url = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(booking.address)}`;\n      window.open(url, '_blank');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue mx-auto mb-4\" />\n          <p className=\"text-graphite font-verdana\">Loading job details...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!booking) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center p-4\">\n        <Card className=\"max-w-md\">\n          <CardContent className=\"py-12 text-center\">\n            <AlertTriangle className=\"w-16 h-16 text-red-500 mx-auto mb-4\" />\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">Job Not Found</h3>\n            <p className=\"text-gray-600 font-verdana mb-6\">This job could not be found.</p>\n            <Button onClick={() => navigate(createPageUrl('CleanerSchedule'))}>\n              Back to Schedule\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const clientFirstName = clientProfile?.user_email?.split('@')[0] || 'Client';\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud py-6\">\n      <div className=\"container mx-auto px-4 max-w-4xl\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <Button \n            variant=\"outline\" \n            onClick={() => navigate(createPageUrl('CleanerSchedule'))}\n            className=\"mb-4\"\n          >\n            ‚Üê Back to Schedule\n          </Button>\n          <h1 className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">Active Job</h1>\n          <p className=\"text-gray-600 font-verdana\">Manage your current cleaning appointment</p>\n        </div>\n\n        {/* Stage Indicator */}\n        <Card className=\"mb-6 bg-gradient-to-r from-blue-50 to-cyan-50\">\n          <CardContent className=\"py-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-gray-600 font-verdana mb-1\">Current Stage</p>\n                <p className=\"text-xl font-fredoka font-bold text-graphite capitalize\">\n                  {currentStage === 'start' && '1. Start Job'}\n                  {currentStage === 'before_photos' && '2. Upload Before Photos'}\n                  {currentStage === 'in_progress' && '3. Cleaning In Progress'}\n                  {currentStage === 'after_photos' && '4. Upload After Photos'}\n                  {currentStage === 'end' && '5. End Job'}\n                  {currentStage === 'complete' && '‚úì Job Complete'}\n                </p>\n              </div>\n              {currentStage === 'in_progress' && (\n                <div className=\"text-right\">\n                  <p className=\"text-sm text-gray-600 font-verdana mb-1\">Time Elapsed</p>\n                  <p className=\"text-3xl font-fredoka font-bold text-puretask-blue\">\n                    {formatTime(elapsedTime)}\n                  </p>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Job Details */}\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n              Job Details\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-1\">Client</p>\n                <p className=\"font-fredoka font-semibold text-graphite\">{clientFirstName}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-1\">Service Type</p>\n                <Badge className=\"font-fredoka\">{getCleaningTypeLabel(booking.cleaning_type)}</Badge>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-1\">Date & Time</p>\n                <div className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                  <Calendar className=\"w-4 h-4\" />\n                  <span>{format(new Date(booking.date), 'MMM dd, yyyy')}</span>\n                </div>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-1\">Duration</p>\n                <div className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                  <Clock className=\"w-4 h-4\" />\n                  <span>{booking.start_time} ({booking.hours}h estimated)</span>\n                </div>\n              </div>\n            </div>\n\n            <div>\n              <p className=\"text-sm text-gray-500 font-verdana mb-2\">Address</p>\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex items-start gap-2 text-gray-700 font-verdana flex-1\">\n                  <MapPin className=\"w-4 h-4 mt-1 flex-shrink-0 text-puretask-blue\" />\n                  <span>{booking.address}</span>\n                </div>\n                <Button variant=\"outline\" size=\"sm\" onClick={openMapNavigation}>\n                  <Navigation className=\"w-4 h-4 mr-2\" />\n                  Navigate\n                </Button>\n              </div>\n            </div>\n\n            {/* Additional Services */}\n            {booking.additional_services && Object.keys(booking.additional_services).filter(k => booking.additional_services[k] > 0).length > 0 && (\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-2\">Additional Services</p>\n                <div className=\"flex flex-wrap gap-2\">\n                  {Object.keys(booking.additional_services)\n                    .filter(key => booking.additional_services[key] > 0)\n                    .map(key => {\n                      const serviceNames = {\n                        windows: 'Windows',\n                        blinds: 'Blinds',\n                        oven: 'Oven',\n                        refrigerator: 'Refrigerator',\n                        light_fixtures: 'Light Fixtures',\n                        inside_cabinets: 'Inside Cabinets',\n                        baseboards: 'Baseboards',\n                        laundry: 'Laundry'\n                      };\n                      return (\n                        <Badge key={key} variant=\"outline\" className=\"font-verdana\">\n                          {serviceNames[key]} x{booking.additional_services[key]}\n                        </Badge>\n                      );\n                    })}\n                </div>\n              </div>\n            )}\n\n            {/* Special Instructions */}\n            {(booking.parking_instructions || booking.entry_instructions || booking.product_preferences || booking.product_allergies) && (\n              <div>\n                <p className=\"text-sm text-gray-500 font-verdana mb-2\">Special Instructions</p>\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3 space-y-2 text-sm font-verdana\">\n                  {booking.parking_instructions && (\n                    <p><span className=\"font-semibold\">Parking:</span> {booking.parking_instructions}</p>\n                  )}\n                  {booking.entry_instructions && (\n                    <p><span className=\"font-semibold\">Entry:</span> {booking.entry_instructions}</p>\n                  )}\n                  {booking.product_preferences && (\n                    <p><span className=\"font-semibold\">Product Preferences:</span> {booking.product_preferences}</p>\n                  )}\n                  {booking.product_allergies && (\n                    <p><span className=\"font-semibold\">Allergies:</span> {booking.product_allergies}</p>\n                  )}\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Stage-specific Content */}\n        {currentStage === 'start' && (\n          <JobStartCheckIn \n            booking={booking} \n            onSuccess={handleJobStarted}\n          />\n        )}\n\n        {currentStage === 'before_photos' && (\n          <>\n            <PhotoProofProgress \n              booking={booking}\n              currentCount={booking.before_photos?.length || 0}\n              requiredCount={3}\n            />\n            <JobPhotoUpload \n              booking={booking}\n              photoType=\"before\"\n              onSuccess={handleBeforePhotosComplete}\n            />\n          </>\n        )}\n\n        {currentStage === 'in_progress' && (\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Job in Progress</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <Alert>\n                  <CheckCircle2 className=\"h-4 w-4\" />\n                  <AlertDescription className=\"font-verdana\">\n                    You're doing great! Complete the tasks below and upload after photos when finished.\n                  </AlertDescription>\n                </Alert>\n\n                <div className=\"flex gap-2\">\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={() => navigate(createPageUrl('Inbox') + `?email=${booking.client_email}`)}\n                  >\n                    <MessageSquare className=\"w-4 h-4 mr-2\" />\n                    Message Client\n                  </Button>\n                  <InJobIssueReporter booking={booking} />\n                </div>\n\n                <Button \n                  onClick={handleReadyToFinish} \n                  className=\"w-full brand-gradient\"\n                  size=\"lg\"\n                >\n                  <CheckCircle2 className=\"w-5 h-5 mr-2\" />\n                  Ready to Upload After Photos\n                </Button>\n              </CardContent>\n            </Card>\n\n            <JobTaskChecklist booking={booking} />\n          </div>\n        )}\n\n        {currentStage === 'after_photos' && (\n          <>\n            <PhotoProofProgress \n              booking={booking}\n              currentCount={booking.after_photos?.length || 0}\n              requiredCount={3}\n            />\n            <JobPhotoUpload \n              booking={booking}\n              photoType=\"after\"\n              onSuccess={handleAfterPhotosComplete}\n            />\n          </>\n        )}\n\n        {currentStage === 'end' && (\n          <JobEndCheckOut \n            booking={booking}\n            onSuccess={handleJobEnded}\n          />\n        )}\n\n        {currentStage === 'complete' && (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <CheckCircle2 className=\"w-16 h-16 text-fresh-mint mx-auto mb-4\" />\n              <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">Job Complete!</h3>\n              <p className=\"text-gray-600 font-verdana mb-6\">\n                Great work! The job has been submitted for client approval.\n              </p>\n              <Button onClick={() => navigate(createPageUrl('CleanerSchedule'))}>\n                Back to Schedule\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      <JobSummaryModal\n        open={showSummary}\n        onOpenChange={setShowSummary}\n        booking={booking}\n        elapsedTime={elapsedTime}\n      />\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerOnboarding.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Select' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":16,"fix":{"range":[751,759],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Select"},"fix":{"range":[752,759],"text":""},"desc":"Remove unused variable 'Select'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectContent' is defined but never used.","line":15,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":31,"fix":{"range":[759,774],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectContent"},"fix":{"range":[758,773],"text":""},"desc":"Remove unused variable 'SelectContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectItem' is defined but never used.","line":15,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":43,"fix":{"range":[774,786],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectItem"},"fix":{"range":[773,785],"text":""},"desc":"Remove unused variable 'SelectItem'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectTrigger' is defined but never used.","line":15,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":58,"fix":{"range":[786,801],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectTrigger"},"fix":{"range":[785,800],"text":""},"desc":"Remove unused variable 'SelectTrigger'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectValue' is defined but never used.","line":15,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":71,"fix":{"range":[800,813],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectValue"},"fix":{"range":[800,813],"text":""},"desc":"Remove unused variable 'SelectValue'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'validateHourlyRate' is defined but never used.","line":20,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":43,"fix":{"range":[1184,1204],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"validateHourlyRate"},"fix":{"range":[1183,1203],"text":""},"desc":"Remove unused variable 'validateHourlyRate'."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":6,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport { Progress } from '@/components/ui/progress';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { CheckCircle, Camera, Clock, Shield, FileText } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport TermsOfService from '../components/terms/TermsOfService';\nimport { initiateKYCVerification, initiateBackgroundCheck } from '../components/verification/VerificationService';\nimport { validatePhone, validateHourlyRate, sanitizeString } from '../components/utils/validation';\nimport LocationRecommender from '../components/address/LocationRecommender';\nimport { useAnalytics } from '../components/analytics/AnalyticsTracker';\n\nconst SERVICE_TAGS = [\n  'Standard Clean', 'Deep Clean', 'Eco Supplies', 'Kitchen',\n  'Bathroom', 'Laundry', 'Windows', 'Organizing', 'Fridge',\n  'Oven', 'Carpets', 'Move In/Out'\n];\n\nconst ADDITIONAL_SERVICES = [\n  { key: 'windows', label: 'Windows', unit: 'per window', min: 20, max: 50 },\n  { key: 'blinds', label: 'Blinds', unit: 'per set', min: 15, max: 40 },\n  { key: 'oven', label: 'Oven Deep Clean', unit: 'per oven', min: 30, max: 80 },\n  { key: 'refrigerator', label: 'Refrigerator Deep Clean', unit: 'per fridge', min: 30, max: 80 },\n  { key: 'light_fixtures', label: 'Light Fixtures', unit: 'per fixture', min: 10, max: 30 },\n  { key: 'inside_cabinets', label: 'Inside Cabinets', unit: 'per section', min: 20, max: 60 },\n  { key: 'baseboards', label: 'Baseboards', unit: 'per home', min: 30, max: 80 },\n  { key: 'laundry', label: 'Laundry Service', unit: 'per load', min: 20, max: 50 }\n];\n\nconst AVAILABILITY_DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n\nconst COMMON_LOCATIONS = [\n  'Sacramento', 'Elk Grove', 'Roseville', 'Folsom', 'Davis',\n  'Rancho Cordova', 'Citrus Heights', 'Rocklin', 'West Sacramento', 'Natomas',\n  'Land Park', 'Midtown', 'Downtown', 'East Sacramento', 'Arden-Arcade',\n  'Fair Oaks', 'Carmichael', 'Orangevale', 'Granite Bay', 'Lincoln'\n];\n\nconst PRODUCT_PREFERENCES = [\n  { value: 'standard', label: 'Standard Cleaning Products', description: 'Effective, affordable cleaning supplies' },\n  { value: 'eco-friendly', label: 'Eco-Friendly Products', description: 'Environmentally conscious, natural cleaners' },\n  { value: 'professional-grade', label: 'Professional-Grade Products', description: 'Commercial-quality cleaning supplies' },\n  { value: 'premium-eco', label: 'Top-tier Eco-Luxury', description: 'Top-tier eco-friendly and specialized products' }\n];\n\nexport default function CleanerOnboarding() {\n  const navigate = useNavigate();\n  const { trackEvent } = useAnalytics();\n  const [user, setUser] = useState(null);\n  const [step, setStep] = useState(1);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [termsAccepted, setTermsAccepted] = useState(false);\n\n  const [formData, setFormData] = useState({\n    phone: '',\n    bio: '',\n    hourly_rate: '', // Stored as string from input\n    service_tags: [],\n    service_locations: [],\n    availability: [],\n    background_check_consent: false,\n    sms_consent: false,\n    product_preference: 'standard',\n    additional_services: {}, // { service_name: price_in_credits }\n    deep_addon_rate: 2, // Default addon rates in credits (1:1 with USD)\n    moveout_addon_rate: 5\n  });\n\n  const [uploads, setUploads] = useState({\n    id_front: null,\n    id_back: null,\n    selfie: null,\n    profile_photo: null,\n    insurance_certificate: null,\n    product_photos: []\n  });\n\n  useEffect(() => {\n    trackEvent('cleaner_onboarding_started', {\n      step: 1\n    });\n    loadUser();\n  }, []);\n\n  const loadUser = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      trackEvent('cleaner_onboarding_user_loaded', {\n        user_email: currentUser.email,\n        onboarding_completed: currentUser.onboarding_completed\n      });\n\n      if (currentUser.onboarding_completed) {\n        const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n        if (profiles.length > 0) {\n          trackEvent('cleaner_onboarding_already_complete', {\n            user_email: currentUser.email\n          });\n          navigate(createPageUrl('CleanerDashboard'));\n          return;\n        }\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading user:', showToast: false });\n      setError('Please log in first');\n\n      trackEvent('cleaner_onboarding_error', {\n        error_type: 'user_not_found',\n        error_message: error.message\n      });\n\n      setTimeout(() => navigate(createPageUrl('CleanerSignup')), 2000);\n    }\n  };\n\n  const handleFileUpload = async (field, file) => {\n    setLoading(true);\n    setError('');\n    try {\n      trackEvent('cleaner_file_upload_started', {\n        user_email: user?.email,\n        field,\n        file_size: file.size\n      });\n\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      setUploads(prev => ({ ...prev, [field]: file_url }));\n\n      trackEvent('cleaner_file_upload_success', {\n        user_email: user?.email,\n        field\n      });\n    } catch (err) {\n      setError('Failed to upload file. Please try again.');\n\n      trackEvent('cleaner_file_upload_error', {\n        user_email: user?.email,\n        field,\n        error_message: err.message\n      });\n    }\n    setLoading(false);\n  };\n\n  const handleProductPhotoUpload = async (file) => {\n    setLoading(true);\n    setError('');\n    try {\n      trackEvent('cleaner_product_photo_upload_started', {\n        user_email: user?.email,\n        file_name: file.name,\n        file_size: file.size\n      });\n      const { file_url } = await base44.integrations.Core.UploadFile({ file });\n      setUploads(prev => ({\n        ...prev,\n        product_photos: [...prev.product_photos, file_url]\n      }));\n      trackEvent('cleaner_product_photo_upload_success', {\n        user_email: user?.email,\n        file_url: file_url\n      });\n    } catch (err) {\n      setError('Failed to upload photo. Please try again.');\n      trackEvent('cleaner_product_photo_upload_error', {\n        user_email: user?.email,\n        error_message: err.message\n      });\n    }\n    setLoading(false);\n  };\n\n  const removeProductPhoto = (index) => {\n    setUploads(prev => ({\n      ...prev,\n      product_photos: prev.product_photos.filter((_, i) => i !== index)\n    }));\n    trackEvent('cleaner_product_photo_removed', {\n      user_email: user?.email,\n      index: index\n    });\n  };\n\n  const toggleServiceTag = (tag) => {\n    setFormData(prev => ({\n      ...prev,\n      service_tags: prev.service_tags.includes(tag)\n        ? prev.service_tags.filter(t => t !== tag)\n        : [...prev.service_tags, tag]\n    }));\n  };\n\n  const toggleLocation = (location) => {\n    setFormData(prev => ({\n      ...prev,\n      service_locations: prev.service_locations.includes(location)\n        ? prev.service_locations.filter(l => l !== location)\n        : [...prev.service_locations, location]\n    }));\n  };\n\n  const updateAvailability = (day, field, value) => {\n    setFormData(prev => {\n      const existing = prev.availability.find(a => a.day === day);\n      if (existing) {\n        return {\n          ...prev,\n          availability: prev.availability.map(a =>\n            a.day === day ? { ...a, [field]: value } : a\n          )\n        };\n      } else {\n        return {\n          ...prev,\n          availability: [\n            ...prev.availability,\n            {\n              day,\n              available: field === 'available' ? value : true,\n              start_time: field === 'start_time' ? value : '',\n              end_time: field === 'end_time' ? value : ''\n            }\n          ]\n        };\n      }\n    });\n  };\n\n  const copyToAllDays = () => {\n    const mondayAvail = formData.availability.find(a => a.day === AVAILABILITY_DAYS[0]);\n\n    if (!mondayAvail || mondayAvail.available === false || !mondayAvail.start_time || !mondayAvail.end_time) {\n      setError('Please set an available time slot (start and end time) for Monday first to copy.');\n      trackEvent('cleaner_availability_copy_failed', {\n        user_email: user?.email,\n        reason: 'monday_not_set'\n      });\n      return;\n    }\n    setError('');\n\n    const allDays = AVAILABILITY_DAYS.map(day => ({\n      day,\n      available: mondayAvail.available,\n      start_time: mondayAvail.start_time,\n      end_time: mondayAvail.end_time\n    }));\n\n    setFormData(prev => ({ ...prev, availability: allDays }));\n    trackEvent('cleaner_availability_copied_to_all_days', {\n      user_email: user?.email,\n      monday_availability: mondayAvail\n    });\n  };\n\n  const clearAllDays = () => {\n    setFormData(prev => ({ ...prev, availability: [] }));\n    trackEvent('cleaner_availability_cleared_all_days', {\n      user_email: user?.email\n    });\n  };\n\n  useEffect(() => {\n  if (step > 1) {\n    trackEvent('cleaner_onboarding_step_complete', {\n      user_email: user?.email,\n      step: step - 1,\n      total_steps: 7\n    });\n  }\n  trackEvent('cleaner_onboarding_step_entered', {\n    user_email: user?.email,\n    step: step\n  });\n  }, [step, user?.email, trackEvent]);\n\n  const handleSubmit = async () => {\n    setLoading(true);\n    setError('');\n\n    trackEvent('cleaner_onboarding_submit_started', {\n      user_email: user?.email,\n      hourly_rate: formData.hourly_rate,\n      service_tags_count: formData.service_tags.length,\n      service_locations_count: formData.service_locations.length,\n      availability_count: formData.availability.length,\n      product_preference: formData.product_preference\n    });\n\n    if (!validatePhone(formData.phone)) {\n      setError('Please enter a valid phone number');\n      trackEvent('cleaner_onboarding_validation_failed', {\n        user_email: user?.email,\n        field: 'phone',\n        value: formData.phone\n      });\n      setLoading(false);\n      return;\n    }\n\n    // Validate rate is within Developing tier range (1:1 credit system)\n    const rateCredits = parseInt(formData.hourly_rate);\n    if (isNaN(rateCredits) || rateCredits < 15 || rateCredits > 25) {\n      setError('Hourly rate must be between 15 and 25 credits per hour for Developing tier');\n      trackEvent('cleaner_onboarding_validation_failed', {\n        user_email: user?.email,\n        field: 'hourly_rate',\n        value: formData.hourly_rate\n      });\n      setLoading(false);\n      return;\n    }\n\n    const sanitizedBio = sanitizeString(formData.bio);\n    if (sanitizedBio.length < 50) {\n      setError('Bio must be at least 50 characters');\n      trackEvent('cleaner_onboarding_validation_failed', {\n        user_email: user?.email,\n        field: 'bio',\n        length: sanitizedBio.length\n      });\n      setLoading(false);\n      return;\n    }\n\n    try {\n      await base44.auth.updateMe({\n        phone: formData.phone.replace(/\\D/g, ''),\n        id_front_url: uploads.id_front,\n        id_back_url: uploads.id_back,\n        selfie_url: uploads.selfie,\n        insurance_certificate_url: uploads.insurance_certificate,\n        user_type: 'cleaner',\n        sms_consent: formData.sms_consent,\n        onboarding_completed: true\n      });\n\n      const currentUser = await base44.auth.me();\n\n      // Create cleaner profile with Developing tier and credits-based rate\n      await base44.entities.CleanerProfile.create({\n      user_email: currentUser.email,\n      full_name: currentUser.full_name,\n      bio: sanitizedBio,\n      base_rate_credits_per_hour: rateCredits,\n      hourly_rate: rateCredits, // 1:1 credit system\n      deep_addon_credits_per_hour: formData.deep_addon_rate || 2,\n      moveout_addon_credits_per_hour: formData.moveout_addon_rate || 5,\n      additional_service_pricing: formData.additional_services,\n      payout_percentage: 0.80, // Standard 80% payout for Developing tier\n      service_tags: formData.service_tags.map(tag => sanitizeString(tag)),\n      service_locations: formData.service_locations.map(loc => sanitizeString(loc)),\n      availability: formData.availability.filter(a => a.available !== false && a.start_time && a.end_time),\n      profile_photo_url: uploads.profile_photo,\n      reliability_score: 75,\n      tier: 'Developing', // All new cleaners start here\n      is_active: false,\n      product_preference: formData.product_preference,\n      product_verification_photos: uploads.product_photos\n      });\n\n      try {\n        setError('Initiating identity verification...');\n        const kycResult = await initiateKYCVerification(currentUser.email, {\n          id_front: uploads.id_front,\n          id_back: uploads.id_back,\n          selfie: uploads.selfie\n        });\n\n        await base44.auth.updateMe({\n          kyc_status: kycResult.status,\n          kyc_details: JSON.stringify(kycResult)\n        });\n        \n        trackEvent('cleaner_kyc_initiated', {\n          user_email: currentUser.email,\n          kyc_status: kycResult.status\n        });\n\n        if (kycResult.status === 'approved' || kycResult.status === 'consider') {\n          setError('Initiating background check...');\n          const bgcResult = await initiateBackgroundCheck(currentUser.email, {\n            full_name: currentUser.full_name,\n            email: currentUser.email,\n            phone: formData.phone.replace(/\\D/g, ''),\n            consent: formData.background_check_consent\n          });\n\n          await base44.auth.updateMe({\n            background_check_status: bgcResult.mapped_status,\n            background_check_details: JSON.stringify(bgcResult)\n          });\n          \n          trackEvent('cleaner_background_check_initiated', {\n            user_email: currentUser.email,\n            background_check_status: bgcResult.mapped_status\n          });\n        } else {\n          await base44.auth.updateMe({\n            background_check_status: 'rejected'\n          });\n          \n          trackEvent('cleaner_background_check_skipped', {\n            user_email: currentUser.email,\n            reason: 'kyc_not_approved'\n          });\n        }\n      } catch (verificationError) {\n        console.error('Verification pipeline error:', verificationError);\n        await base44.auth.updateMe({\n          kyc_status: 'pending',\n          background_check_status: 'pending'\n        });\n        \n        trackEvent('cleaner_verification_pipeline_error', {\n          user_email: currentUser.email,\n          error_message: verificationError.message\n        });\n      }\n\n      trackEvent('cleaner_signup_success', {\n        user_email: currentUser.email,\n        base_rate_credits_per_hour: rateCredits,\n        tier: 'Developing',\n        product_preference: formData.product_preference,\n        service_tags_count: formData.service_tags.length,\n        service_locations_count: formData.service_locations.length\n      });\n\n      navigate(createPageUrl('CleanerDashboard'));\n    } catch (err) {\n      console.error('Onboarding error:', err);\n      setError('Failed to complete onboarding. Please try again.');\n\n      trackEvent('cleaner_onboarding_submit_error', {\n        user_email: user?.email,\n        error_message: err.message\n      });\n    }\n    setLoading(false);\n  };\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-6\" style={{ backgroundColor: '#F7F9FC' }}>\n        <div className=\"text-center\">\n          <p className=\"text-lg text-gray-600 font-verdana\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const progress = (step / 7) * 100;\n  \n  // Calculate tier from current reliability score (defaults to Developing for new cleaners)\n  const currentTier = 'Developing';\n  const tierRanges = {\n    'Developing': { base: { min: 15, max: 25 }, deep: { min: 1, max: 2 }, moveout: { min: 4, max: 5 } },\n    'Semi Pro': { base: { min: 25, max: 35 }, deep: { min: 1, max: 3 }, moveout: { min: 4, max: 6 } },\n    'Pro': { base: { min: 35, max: 45 }, deep: { min: 1, max: 4 }, moveout: { min: 4, max: 7 } },\n    'Elite': { base: { min: 45, max: 65 }, deep: { min: 1, max: 5 }, moveout: { min: 4, max: 8 } }\n  };\n\n  const mondayAvail = formData.availability.find(a => a.day === AVAILABILITY_DAYS[0]);\n  const isMondayAvailableAndSet = mondayAvail && mondayAvail.available === true && mondayAvail.start_time && mondayAvail.end_time;\n\n  return (\n    <div className=\"min-h-screen p-6\" style={{ background: 'linear-gradient(to bottom, #0078FF 0%, #F7F9FC 100%)' }}>\n      <div className=\"max-w-3xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-fredoka font-bold text-white mb-2\">Cleaner Onboarding</h1>\n          <Progress value={progress} className=\"h-2\" />\n          <p className=\"text-sm text-white mt-2 font-verdana\" style={{ opacity: 0.9 }}>Step {step} of 7</p>\n        </div>\n\n        {error && (\n          <Alert variant=\"destructive\" className=\"mb-6 rounded-2xl\">\n            <AlertDescription className=\"font-verdana\">{error}</AlertDescription>\n          </Alert>\n        )}\n\n        <AnimatePresence mode=\"wait\">\n          {step === 1 && (\n            <motion.div\n              key=\"step1\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #EFF6FF 0%, #ECFEFF 100%)' }}>\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka\" style={{ color: '#1D2533' }}>\n                    <FileText className=\"w-6 h-6\" style={{ color: '#0078FF' }} />\n                    Terms of Service\n                  </CardTitle>\n                  <p className=\"text-sm text-gray-600 mt-2 font-verdana\">\n                    Please review and accept our terms before continuing\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <TermsOfService userType=\"cleaner\" />\n\n                  <div className=\"flex items-start gap-3 p-4 rounded-2xl\" style={{ backgroundColor: '#DCFCE7', border: '1px solid #86EFAC' }}>\n                    <Checkbox\n                      checked={termsAccepted}\n                      onCheckedChange={(checked) => setTermsAccepted(checked)}\n                      id=\"terms\"\n                    />\n                    <Label htmlFor=\"terms\" className=\"text-sm cursor-pointer font-verdana\" style={{ color: '#1D2533' }}>\n                      I have read and agree to the Cleaner Terms of Service and Independent Contractor Agreement. I understand that I am not an employee of PureTask and am responsible for my own taxes and insurance.\n                    </Label>\n                  </div>\n\n                  <Button\n                    className=\"w-full rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                    style={{ background: 'linear-gradient(135deg, #0078FF 0%, #00D4FF 100%)' }}\n                    onClick={() => setStep(2)}\n                    disabled={!termsAccepted}\n                  >\n                    Accept and Continue\n                  </Button>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 2 && (\n            <motion.div\n              key=\"step2\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #DCFCE7 0%, #ECFEFF 100%)' }}>\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka\" style={{ color: '#1D2533' }}>\n                    <Camera className=\"w-6 h-6\" style={{ color: '#28C76F' }} />\n                    Identity Verification\n                  </CardTitle>\n                  <p className=\"text-sm text-gray-600 mt-2 font-verdana\">\n                    Upload clear photos of your government-issued ID and a selfie for liveness verification\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  {/* Instructions Alert */}\n                  <Alert className=\"rounded-2xl\" style={{ backgroundColor: '#EFF6FF', border: '2px solid #66B3FF' }}>\n                    <Camera className=\"w-5 h-5\" style={{ color: '#66B3FF' }} />\n                    <AlertTitle className=\"font-fredoka font-bold\" style={{ color: '#1D2533' }}>\n                      üì∏ Photo Requirements\n                    </AlertTitle>\n                    <AlertDescription className=\"mt-2 space-y-2 font-verdana text-gray-700\">\n                      <p className=\"font-semibold\" style={{ color: '#1D2533' }}>\n                        Acceptable ID Types:\n                      </p>\n                      <ul className=\"list-disc list-inside space-y-1 ml-2\">\n                        <li>Driver's License</li>\n                        <li>State-issued ID Card</li>\n                        <li>Passport</li>\n                        <li>Military ID</li>\n                      </ul>\n                      \n                      <p className=\"font-semibold mt-3\" style={{ color: '#1D2533' }}>\n                        ID Photo Guidelines:\n                      </p>\n                      <ul className=\"list-disc list-inside space-y-1 ml-2\">\n                        <li>Take clear photos of <strong>both front AND back</strong> of your ID</li>\n                        <li>Ensure all text is readable and not blurry</li>\n                        <li>Photo should not be expired</li>\n                        <li>Avoid glare or shadows on the ID</li>\n                        <li>Place ID on a flat, contrasting surface</li>\n                      </ul>\n\n                      <p className=\"font-semibold mt-3\" style={{ color: '#1D2533' }}>\n                        Selfie Requirements:\n                      </p>\n                      <ul className=\"list-disc list-inside space-y-1 ml-2\">\n                        <li>Show your <strong>entire face clearly</strong></li>\n                        <li><strong>NO sunglasses</strong> - eyes must be visible</li>\n                        <li><strong>NO hats or head coverings</strong> (except for religious purposes)</li>\n                        <li><strong>NO masks</strong> or anything covering your face</li>\n                        <li>Look directly at the camera</li>\n                        <li>Good lighting - avoid shadows on your face</li>\n                        <li>Neutral expression preferred</li>\n                      </ul>\n\n                      <div className=\"mt-3 p-3 rounded-lg\" style={{ backgroundColor: '#FEF3C7', border: '1px solid #FCD34D' }}>\n                        <p className=\"text-sm font-semibold flex items-center gap-2\">\n                          <Shield className=\"w-4 h-4\" style={{ color: '#F59E0B' }} />\n                          <span style={{ color: '#92400E' }}>\n                            Why we need this: We verify your identity to ensure platform safety and trust for all users.\n                          </span>\n                        </p>\n                      </div>\n                    </AlertDescription>\n                  </Alert>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold flex items-center gap-2\" style={{ color: '#1D2533' }}>\n                      <span>ID Front</span>\n                      <span className=\"text-xs font-verdana font-normal text-gray-500\">(Required)</span>\n                    </Label>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={(e) => handleFileUpload('id_front', e.target.files[0])}\n                      className=\"mt-2 font-verdana\"\n                    />\n                    {uploads.id_front && (\n                      <Badge className=\"mt-2 rounded-full font-fredoka\" style={{ backgroundColor: '#28C76F', color: 'white' }}>\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Uploaded\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold flex items-center gap-2\" style={{ color: '#1D2533' }}>\n                      <span>ID Back</span>\n                      <span className=\"text-xs font-verdana font-normal text-gray-500\">(Required)</span>\n                    </Label>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={(e) => handleFileUpload('id_back', e.target.files[0])}\n                      className=\"mt-2 font-verdana\"\n                    />\n                    {uploads.id_back && (\n                      <Badge className=\"mt-2 rounded-full font-fredoka\" style={{ backgroundColor: '#28C76F', color: 'white' }}>\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Uploaded\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold flex items-center gap-2\" style={{ color: '#1D2533' }}>\n                      <span>Selfie for Liveness Check</span>\n                      <span className=\"text-xs font-verdana font-normal text-gray-500\">(Required)</span>\n                    </Label>\n                    <p className=\"text-xs text-gray-500 mb-2 font-verdana\">\n                      Take a clear photo of your face - no sunglasses, hats, or masks\n                    </p>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={(e) => handleFileUpload('selfie', e.target.files[0])}\n                      className=\"mt-2 font-verdana\"\n                    />\n                    {uploads.selfie && (\n                      <Badge className=\"mt-2 rounded-full font-fredoka\" style={{ backgroundColor: '#28C76F', color: 'white' }}>\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Uploaded\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button variant=\"outline\" onClick={() => setStep(1)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}\n                      onClick={() => setStep(3)}\n                      disabled={!uploads.id_front || !uploads.id_back || !uploads.selfie || loading}\n                    >\n                      Continue\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 3 && (\n            <motion.div\n              key=\"step3\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #EFF6FF 0%, #F3E8FF 100%)' }}>\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka\" style={{ color: '#1D2533' }}>\n                    <Shield className=\"w-6 h-6\" style={{ color: '#66B3FF' }} />\n                    Background Check Consent\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <div className=\"p-4 rounded-2xl\" style={{ backgroundColor: '#DBEAFE', border: '1px solid #93C5FD' }}>\n                    <h3 className=\"font-fredoka font-semibold mb-2\" style={{ color: '#1D2533' }}>Why we need this</h3>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      PureTask requires all cleaners to pass a comprehensive background check to ensure client safety and platform trust. This includes criminal record checks and verification of your work history.\n                    </p>\n                  </div>\n\n                  <div className=\"flex items-start gap-3\">\n                    <Checkbox\n                      checked={formData.background_check_consent}\n                      onCheckedChange={(checked) => setFormData({ ...formData, background_check_consent: checked })}\n                      id=\"consent\"\n                    />\n                    <Label htmlFor=\"consent\" className=\"text-sm leading-relaxed cursor-pointer font-verdana\" style={{ color: '#1D2533' }}>\n                      I consent to PureTask conducting a background check on me, including criminal record verification, employment history, and identity confirmation. I understand this is required to work on the platform.\n                    </Label>\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button variant=\"outline\" onClick={() => setStep(2)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}\n                      onClick={() => setStep(4)}\n                      disabled={!formData.background_check_consent}\n                    >\n                      Continue\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 4 && (\n            <motion.div\n              key=\"step4\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #FFF7ED 0%, #FEFCE8 100%)' }}>\n                  <CardTitle className=\"font-fredoka\" style={{ color: '#1D2533' }}>Profile Information</CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Phone Number</Label>\n                    <Input\n                      value={formData.phone}\n                      onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                      placeholder=\"+1 (555) 000-0000\"\n                      required\n                      className=\"font-verdana\"\n                    />\n                    <p className=\"text-xs text-gray-500 mt-1 font-verdana\">Clients and support will use this to contact you</p>\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Profile Photo</Label>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      capture=\"user\"\n                      onChange={(e) => handleFileUpload('profile_photo', e.target.files[0])}\n                      className=\"mt-2 font-verdana\"\n                    />\n                    {uploads.profile_photo && (\n                      <Badge className=\"mt-2 rounded-full font-fredoka\" style={{ backgroundColor: '#28C76F', color: 'white' }}>\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Uploaded\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Professional Bio</Label>\n                    <Textarea\n                      value={formData.bio}\n                      onChange={(e) => setFormData({ ...formData, bio: e.target.value })}\n                      placeholder=\"Tell clients about your experience, certifications, and what makes you a great cleaner...\"\n                      rows={4}\n                      required\n                      className=\"font-verdana\"\n                    />\n                    <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                      {formData.bio.length}/500 characters\n                    </p>\n                  </div>\n\n                  <div className=\"p-4 rounded-2xl\" style={{ backgroundColor: '#ECFDF5', border: '1px solid #A7F3D0' }}>\n                    <div className=\"flex items-start gap-3\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"sms_consent\"\n                        checked={formData.sms_consent}\n                        onChange={(e) => setFormData({ ...formData, sms_consent: e.target.checked })}\n                        className=\"mt-1\"\n                      />\n                      <label htmlFor=\"sms_consent\" className=\"text-sm cursor-pointer font-verdana\" style={{ color: '#1D2533' }}>\n                        <strong className=\"font-fredoka\">I agree to receive SMS/email notifications</strong> about job confirmations, reminders, and updates. Message and data rates may apply. You can opt out at any time.\n                      </label>\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Liability Insurance Certificate (Recommended for Pro/Elite)</Label>\n                    <p className=\"text-sm text-gray-600 mb-2 font-verdana\">\n                      Upload proof of liability insurance. Required for Pro and Elite tiers. This protects both you and clients.\n                    </p>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*,application/pdf\"\n                      capture=\"environment\"\n                      onChange={(e) => handleFileUpload('insurance_certificate', e.target.files[0])}\n                      className=\"mt-2 font-verdana\"\n                    />\n                    {uploads.insurance_certificate && (\n                      <Badge className=\"mt-2 rounded-full font-fredoka\" style={{ backgroundColor: '#28C76F', color: 'white' }}>\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        Uploaded\n                      </Badge>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Product Preference</Label>\n                    <p className=\"text-sm text-gray-600 mb-3 font-verdana\">\n                      Let clients know what type of cleaning products you typically use. This helps set expectations and can attract more bookings.\n                    </p>\n                    <div className=\"space-y-3\">\n                      {PRODUCT_PREFERENCES.map(pref => (\n                        <button\n                          key={pref.value}\n                          type=\"button\"\n                          onClick={() => setFormData({ ...formData, product_preference: pref.value })}\n                          className={`w-full text-left p-4 rounded-lg border-2 transition-all ${\n                            formData.product_preference === pref.value\n                              ? 'border-[#28C76F] bg-[#DCFCE7]'\n                              : 'border-slate-200 hover:border-[#28C76F]'\n                          }`}\n                        >\n                          <div className=\"flex items-start gap-3\">\n                            {formData.product_preference === pref.value && (\n                              <CheckCircle className=\"w-5 h-5 mt-0.5 flex-shrink-0\" style={{ color: '#28C76F' }} />\n                            )}\n                            <div>\n                              <p className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>{pref.label}</p>\n                              <p className=\"text-sm text-gray-600 font-verdana\">{pref.description}</p>\n                            </div>\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Product Verification Photos (Optional)</Label>\n                    <p className=\"text-sm text-gray-600 mb-2 font-verdana\">\n                      Upload photos of the cleaning products you use. This builds trust with clients and can help you get more bookings. <span className=\"font-semibold\" style={{ color: '#28C76F' }}>Cleaners with product photos get 34% more bookings!</span>\n                    </p>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      capture=\"environment\"\n                      onChange={(e) => {\n                        if (e.target.files && e.target.files.length > 0) {\n                          Array.from(e.target.files).forEach(file => handleProductPhotoUpload(file));\n                        }\n                        e.target.value = null;\n                      }}\n                      className=\"mt-2 font-verdana\"\n                      multiple\n                    />\n                    {uploads.product_photos.length > 0 && (\n                      <div className=\"mt-4 grid grid-cols-3 gap-3\">\n                        {uploads.product_photos.map((url, index) => (\n                          <div key={index} className=\"relative\">\n                            <img src={url} alt={`Product ${index + 1}`} className=\"w-full h-24 object-cover rounded-lg border-2 border-[#86EFAC]\" />\n                            <button\n                              type=\"button\"\n                              onClick={() => removeProductPhoto(index)}\n                              className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600\"\n                            >\n                              ‚úï\n                            </button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Service Locations</Label>\n                    <p className=\"text-sm text-gray-600 mb-3 font-verdana\">\n                      Select all areas you're willing to serve (minimum 1)\n                    </p>\n\n                    {user?.default_address && (\n                      <LocationRecommender\n                        userAddress={user.default_address}\n                        preSelectedLocations={formData.service_locations}\n                        onSelectLocations={(locations) => setFormData({ ...formData, service_locations: locations })}\n                      />\n                    )}\n\n                    <p className=\"text-sm font-fredoka font-semibold mt-4\" style={{ color: '#1D2533' }}>\n                      Or choose from all available locations:\n                    </p>\n                    <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto p-4 bg-slate-50 rounded-lg mt-2\">\n                      {COMMON_LOCATIONS.map(location => (\n                        <button\n                          key={location}\n                          type=\"button\"\n                          onClick={() => toggleLocation(location)}\n                          className={`p-3 rounded-lg border-2 transition-all text-left ${\n                            formData.service_locations.includes(location)\n                              ? 'border-[#28C76F] bg-[#DCFCE7]'\n                              : 'border-slate-200 hover:border-[#28C76F]'\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            {formData.service_locations.includes(location) && (\n                              <CheckCircle className=\"w-4 h-4\" style={{ color: '#28C76F' }} />\n                            )}\n                            <span className=\"font-fredoka text-sm\" style={{ color: '#1D2533' }}>{location}</span>\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n\n                    {formData.service_locations.length > 0 && (\n                      <p className=\"text-sm mt-2 font-verdana\" style={{ color: '#28C76F' }}>\n                        ‚úì {formData.service_locations.length} location{formData.service_locations.length > 1 ? 's' : ''} selected\n                      </p>\n                    )}\n                  </div>\n\n                  {/* New Cleaner Tier & Rate Explanation */}\n                  <Alert className=\"rounded-2xl\" style={{ backgroundColor: '#FFFBEB', border: '2px solid #FCD34D' }}>\n                    <Shield className=\"w-5 h-5\" style={{ color: '#F59E0B' }} />\n                    <AlertTitle className=\"font-fredoka font-bold\" style={{ color: '#1D2533' }}>\n                      üåü Your Starting Tier: Developing\n                    </AlertTitle>\n                    <AlertDescription className=\"mt-2 space-y-2 font-verdana text-gray-700\">\n                      <p>\n                        <strong>All new cleaners start in the \"Developing\" tier.</strong> As you complete more jobs and maintain high reliability, you'll automatically advance to higher tiers with increased earning potential!\n                      </p>\n                      \n                      <div className=\"mt-3 space-y-2\">\n                        <p className=\"font-semibold\" style={{ color: '#1D2533' }}>Tier Rate Ranges (1 credit = $1):</p>\n                        <ul className=\"list-disc list-inside space-y-1 ml-2 text-sm\">\n                          <li><strong>Developing:</strong> 15-25 credits/hr ($15-25/hr) ‚Üê You are here</li>\n                          <li><strong>Semi Pro:</strong> 25-35 credits/hr ($25-35/hr)</li>\n                          <li><strong>Pro:</strong> 35-45 credits/hr ($35-45/hr)</li>\n                          <li><strong>Elite:</strong> 45-65 credits/hr ($45-65/hr)</li>\n                        </ul>\n                      </div>\n\n                      <p className=\"text-xs mt-2\" style={{ color: '#92400E' }}>\n                        üí° <strong>Tip:</strong> Build your reputation by maintaining high punctuality, photo compliance, and customer satisfaction scores to advance faster!\n                      </p>\n                    </AlertDescription>\n                  </Alert>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold flex items-center gap-2\" style={{ color: '#1D2533' }}>\n                      <span>Hourly Rate</span>\n                      <Badge className=\"rounded-full font-fredoka text-xs\" style={{ backgroundColor: '#FCD34D', color: '#92400E' }}>\n                        Developing Tier\n                      </Badge>\n                    </Label>\n                    <p className=\"text-sm text-gray-600 mb-2 font-verdana\">\n                      Set your rate in credits per hour. <strong>Your tier limits: 15-25 credits/hr ($15-25/hr)</strong>\n                    </p>\n                    <div className=\"relative\">\n                      <Input\n                        type=\"number\"\n                        value={formData.hourly_rate}\n                        onChange={(e) => {\n                          const value = parseInt(e.target.value);\n                          if (!isNaN(value) && value >= 15 && value <= 25) {\n                            setFormData({ ...formData, hourly_rate: e.target.value });\n                          } else if (e.target.value === '') {\n                            setFormData({ ...formData, hourly_rate: '' });\n                          }\n                        }}\n                        placeholder=\"20\"\n                        min=\"15\"\n                        max=\"25\"\n                        step=\"1\"\n                        required\n                        className=\"font-verdana pr-20\"\n                      />\n                      <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 font-verdana\">\n                        credits/hr\n                      </span>\n                    </div>\n                    {formData.hourly_rate && !isNaN(parseInt(formData.hourly_rate)) && (\n                      <p className=\"text-xs mt-2 font-verdana\" style={{ color: '#28C76F' }}>\n                        ‚âà ${parseInt(formData.hourly_rate)}/hour in USD (1 credit = $1)\n                      </p>\n                    )}\n                    <p className=\"text-xs text-gray-500 mt-1 font-verdana\">\n                      üí∞ Recommended starting rate: <strong>20-25 credits/hr ($20-25/hr)</strong> for competitive positioning\n                    </p>\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button variant=\"outline\" onClick={() => setStep(3)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}\n                      onClick={() => setStep(5)}\n                      disabled={!formData.phone || !formData.bio || formData.service_locations.length === 0 || !formData.hourly_rate || parseInt(formData.hourly_rate) < 15 || parseInt(formData.hourly_rate) > 25}\n                    >\n                      Continue\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 5 && (\n            <motion.div\n              key=\"step5\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #FDF2F8 0%, #FCE7F3 100%)' }}>\n                  <CardTitle className=\"font-fredoka\" style={{ color: '#1D2533' }}>Services Offered</CardTitle>\n                  <p className=\"text-sm text-gray-600 mt-2 font-verdana\">\n                    Select all services you can provide (minimum 3)\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                    {SERVICE_TAGS.map(tag => (\n                      <button\n                        key={tag}\n                        type=\"button\"\n                        onClick={() => toggleServiceTag(tag)}\n                        className={`p-4 rounded-lg border-2 transition-all text-left ${\n                          formData.service_tags.includes(tag)\n                            ? 'border-[#28C76F] bg-[#DCFCE7]'\n                            : 'border-slate-200 hover:border-[#28C76F]'\n                        }`}\n                      >\n                        <div className=\"flex items-center gap-2\">\n                          {formData.service_tags.includes(tag) && (\n                            <CheckCircle className=\"w-4 h-4 mr-1\" style={{ color: '#28C76F' }} />\n                          )}\n                          <span className=\"font-fredoka text-sm\" style={{ color: '#1D2533' }}>{tag}</span>\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button variant=\"outline\" onClick={() => setStep(4)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}\n                      onClick={() => setStep(6)}\n                      disabled={formData.service_tags.length < 3}\n                    >\n                      Continue\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 6 && (\n            <motion.div\n              key=\"step6\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #DCFCE7 0%, #D1FAE5 100%)' }}>\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka\" style={{ color: '#1D2533' }}>\n                    <Shield className=\"w-6 h-6\" style={{ color: '#28C76F' }} />\n                    Pricing & Additional Services\n                  </CardTitle>\n                  <p className=\"text-sm text-gray-600 mt-2 font-verdana\">\n                    Set your rates for add-ons and extra services based on your tier\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <Alert className=\"rounded-2xl\" style={{ backgroundColor: '#FEF3C7', border: '2px solid #FCD34D' }}>\n                    <Shield className=\"w-5 h-5\" style={{ color: '#F59E0B' }} />\n                    <AlertTitle className=\"font-fredoka font-bold\" style={{ color: '#1D2533' }}>\n                      üí∞ Your Tier: {currentTier}\n                    </AlertTitle>\n                    <AlertDescription className=\"mt-2 font-verdana text-gray-700\">\n                      <p>Your reliability score determines your pricing ranges. As a <strong>{currentTier}</strong> cleaner:</p>\n                      <ul className=\"list-disc list-inside space-y-1 ml-2 mt-2 text-sm\">\n                        <li>Base rate: {tierRanges[currentTier].base.min}-{tierRanges[currentTier].base.max} credits/hr (${tierRanges[currentTier].base.min}-${tierRanges[currentTier].base.max}/hr)</li>\n                        <li>Deep clean add-on: +{tierRanges[currentTier].deep.min}-{tierRanges[currentTier].deep.max} credits/hr (+${tierRanges[currentTier].deep.min}-${tierRanges[currentTier].deep.max}/hr)</li>\n                        <li>Move-out add-on: +{tierRanges[currentTier].moveout.min}-{tierRanges[currentTier].moveout.max} credits/hr (+${tierRanges[currentTier].moveout.min}-${tierRanges[currentTier].moveout.max}/hr)</li>\n                      </ul>\n                    </AlertDescription>\n                  </Alert>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Deep Clean Add-On Rate</Label>\n                    <p className=\"text-sm text-gray-600 mb-2 font-verdana\">\n                      Extra charge per hour for deep cleaning services (Range: {tierRanges[currentTier].deep.min}-{tierRanges[currentTier].deep.max} credits/hr = ${tierRanges[currentTier].deep.min}-${tierRanges[currentTier].deep.max}/hr)\n                    </p>\n                    <div className=\"relative\">\n                      <Input\n                        type=\"number\"\n                        value={formData.deep_addon_rate}\n                        onChange={(e) => {\n                          const value = parseInt(e.target.value);\n                          if (!isNaN(value) && value >= tierRanges[currentTier].deep.min && value <= tierRanges[currentTier].deep.max) {\n                            setFormData({ ...formData, deep_addon_rate: value });\n                          } else if (e.target.value === '') {\n                            setFormData({ ...formData, deep_addon_rate: tierRanges[currentTier].deep.min });\n                          }\n                        }}\n                        placeholder=\"2\"\n                        min={tierRanges[currentTier].deep.min}\n                        max={tierRanges[currentTier].deep.max}\n                        step=\"1\"\n                        className=\"font-verdana pr-20\"\n                      />\n                      <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 font-verdana\">\n                        credits/hr\n                      </span>\n                    </div>\n                    {formData.deep_addon_rate && (\n                      <p className=\"text-xs mt-2 font-verdana\" style={{ color: '#28C76F' }}>\n                        ‚âà ${formData.deep_addon_rate}/hr extra for deep cleaning\n                      </p>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Move-Out Clean Add-On Rate</Label>\n                    <p className=\"text-sm text-gray-600 mb-2 font-verdana\">\n                      Extra charge per hour for move-out cleaning services (Range: {tierRanges[currentTier].moveout.min}-{tierRanges[currentTier].moveout.max} credits/hr = ${tierRanges[currentTier].moveout.min}-${tierRanges[currentTier].moveout.max}/hr)\n                    </p>\n                    <div className=\"relative\">\n                      <Input\n                        type=\"number\"\n                        value={formData.moveout_addon_rate}\n                        onChange={(e) => {\n                          const value = parseInt(e.target.value);\n                          if (!isNaN(value) && value >= tierRanges[currentTier].moveout.min && value <= tierRanges[currentTier].moveout.max) {\n                            setFormData({ ...formData, moveout_addon_rate: value });\n                          } else if (e.target.value === '') {\n                            setFormData({ ...formData, moveout_addon_rate: tierRanges[currentTier].moveout.min });\n                          }\n                        }}\n                        placeholder=\"5\"\n                        min={tierRanges[currentTier].moveout.min}\n                        max={tierRanges[currentTier].moveout.max}\n                        step=\"1\"\n                        className=\"font-verdana pr-20\"\n                      />\n                      <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 font-verdana\">\n                        credits/hr\n                      </span>\n                    </div>\n                    {formData.moveout_addon_rate && (\n                      <p className=\"text-xs mt-2 font-verdana\" style={{ color: '#28C76F' }}>\n                        ‚âà ${formData.moveout_addon_rate}/hr extra for move-out cleaning\n                      </p>\n                    )}\n                  </div>\n\n                  <div>\n                    <Label className=\"font-fredoka font-semibold\" style={{ color: '#1D2533' }}>Additional Services (Optional)</Label>\n                    <p className=\"text-sm text-gray-600 mb-3 font-verdana\">\n                      Select which extra services you offer and set your prices. Prices are limited by your tier.\n                    </p>\n                    <div className=\"space-y-4\">\n                      {ADDITIONAL_SERVICES.map(service => {\n                        const isSelected = formData.additional_services[service.key] !== undefined;\n                        const currentPrice = formData.additional_services[service.key] || service.min;\n                        \n                        return (\n                          <div key={service.key} className={`p-4 rounded-lg border-2 transition-all ${\n                            isSelected ? 'border-[#28C76F] bg-[#DCFCE7]' : 'border-slate-200'\n                          }`}>\n                            <div className=\"flex items-start gap-3\">\n                              <Checkbox\n                                checked={isSelected}\n                                onCheckedChange={(checked) => {\n                                  if (checked) {\n                                    setFormData(prev => ({\n                                      ...prev,\n                                      additional_services: {\n                                        ...prev.additional_services,\n                                        [service.key]: service.min\n                                      }\n                                    }));\n                                  } else {\n                                    const { [service.key]: _, ...rest } = formData.additional_services;\n                                    setFormData(prev => ({ ...prev, additional_services: rest }));\n                                  }\n                                }}\n                                id={service.key}\n                              />\n                              <div className=\"flex-1\">\n                                <Label htmlFor={service.key} className=\"font-fredoka font-semibold cursor-pointer\" style={{ color: '#1D2533' }}>\n                                  {service.label}\n                                </Label>\n                                <p className=\"text-xs text-gray-500 font-verdana mb-2\">{service.unit}</p>\n                                \n                                {isSelected && (\n                                  <div className=\"mt-2\">\n                                    <div className=\"relative\">\n                                      <Input\n                                        type=\"number\"\n                                        value={currentPrice}\n                                        onChange={(e) => {\n                                          const value = parseInt(e.target.value);\n                                          if (!isNaN(value) && value >= service.min && value <= service.max) {\n                                            setFormData(prev => ({\n                                              ...prev,\n                                              additional_services: {\n                                                ...prev.additional_services,\n                                                [service.key]: value\n                                              }\n                                            }));\n                                          }\n                                        }}\n                                        min={service.min}\n                                        max={service.max}\n                                        step=\"5\"\n                                        className=\"font-verdana pr-20\"\n                                      />\n                                      <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500 font-verdana\">\n                                        credits\n                                      </span>\n                                    </div>\n                                    <p className=\"text-xs mt-1 text-gray-500 font-verdana\">\n                                      Range: {service.min}-{service.max} credits (${(service.min/10).toFixed(0)}-${(service.max/10).toFixed(0)}) ‚Ä¢ You: ${(currentPrice/10).toFixed(2)}\n                                    </p>\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                  <div className=\"flex gap-3\">\n                    <Button variant=\"outline\" onClick={() => setStep(5)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #28C76F 0%, #00D4FF 100%)' }}\n                      onClick={() => setStep(7)}\n                      disabled={!formData.deep_addon_rate || !formData.moveout_addon_rate}\n                    >\n                      Continue\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n\n          {step === 7 && (\n            <motion.div\n              key=\"step7\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -20 }}\n            >\n              <Card className=\"border-0 shadow-xl rounded-2xl\">\n                <CardHeader className=\"rounded-t-2xl\" style={{ background: 'linear-gradient(135deg, #FFFBEB 0%, #FEFCE8 100%)' }}>\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka\" style={{ color: '#1D2533' }}>\n                    <Clock className=\"w-6 h-6\" style={{ color: '#F59E0B' }} />\n                    Set Your Availability\n                  </CardTitle>\n                  <p className=\"text-sm text-gray-600 mt-2 font-verdana\">\n                    Set your working hours for each day or mark as unavailable\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-6\">\n                  <div className=\"flex gap-3 p-4 rounded-2xl\" style={{ backgroundColor: '#EFF6FF', border: '1px solid #BFDBFE' }}>\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={copyToAllDays}\n                      disabled={!isMondayAvailableAndSet}\n                      className=\"flex-1 rounded-full font-fredoka\"\n                    >\n                      <CheckCircle className=\"w-4 h-4 mr-2\" style={{ color: '#0078FF' }} />\n                      Copy Monday to All\n                    </Button>\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={clearAllDays}\n                      disabled={formData.availability.length === 0}\n                      className=\"flex-1 rounded-full font-fredoka\"\n                    >\n                      Clear All\n                    </Button>\n                  </div>\n\n                  {AVAILABILITY_DAYS.map(day => {\n                    const dayAvail = formData.availability.find(a => a.day === day);\n                    const isUnavailable = dayAvail ? dayAvail.available === false : false;\n\n                    return (\n                      <div key={day} className=\"space-y-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <Label className=\"w-28 font-fredoka font-semibold\" style={{ color: '#1D2533' }}>{day}</Label>\n                          <div className=\"flex items-center gap-2\">\n                            <Checkbox\n                              checked={isUnavailable}\n                              onCheckedChange={(checked) => updateAvailability(day, 'available', !checked)}\n                              id={`unavailable-${day}`}\n                            />\n                            <Label htmlFor={`unavailable-${day}`} className=\"text-sm text-gray-600 cursor-pointer font-verdana\">\n                              Unavailable\n                            </Label>\n                          </div>\n                        </div>\n\n                        {!isUnavailable && (\n                          <div className=\"flex items-center gap-4 ml-32\">\n                            <Input\n                              type=\"time\"\n                              value={dayAvail?.start_time || ''}\n                              onChange={(e) => updateAvailability(day, 'start_time', e.target.value)}\n                              className=\"flex-1 font-verdana\"\n                            />\n                            <span className=\"text-gray-500 font-verdana\">to</span>\n                            <Input\n                              type=\"time\"\n                              value={dayAvail?.end_time || ''}\n                              onChange={(e) => updateAvailability(day, 'end_time', e.target.value)}\n                              className=\"flex-1 font-verdana\"\n                            />\n                          </div>\n                        )}\n                      </div>\n                    );\n                  })}\n\n                  <div className=\"flex gap-3 pt-4\">\n                    <Button variant=\"outline\" onClick={() => setStep(6)} className=\"rounded-full font-fredoka\">Back</Button>\n                    <Button\n                      className=\"flex-1 rounded-full font-fredoka font-semibold text-white shadow-lg\"\n                      style={{ background: 'linear-gradient(135deg, #28C76F 0%, #00D4FF 100%)' }}\n                      onClick={handleSubmit}\n                      disabled={loading || formData.availability.filter(a => a.available !== false && a.start_time && a.end_time).length === 0}\n                    >\n                      {loading ? 'Submitting...' : 'Complete Onboarding'}\n                    </Button>\n                  </div>\n\n                  <div className=\"p-4 rounded-2xl mt-4\" style={{ backgroundColor: '#EFF6FF', border: '1px solid #BFDBFE' }}>\n                    <p className=\"text-sm text-gray-700 font-verdana\">\n                      <strong className=\"font-fredoka\">What happens next:</strong> Your application will be reviewed within 24-48 hours. We'll verify your identity and conduct a background check. You'll receive an email once approved to start accepting bookings.\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerPayouts.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'format' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"fix":{"range":[569,604],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"format"},"fix":{"range":[569,603],"text":""},"desc":"Remove unused variable 'format'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'InstantPayoutButton' is defined but never used.","line":11,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":27,"fix":{"range":[604,681],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"InstantPayoutButton"},"fix":{"range":[611,636],"text":""},"desc":"Remove unused variable 'InstantPayoutButton'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleanerProfile' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanerProfile"},"fix":{"range":[993,1007],"text":""},"desc":"Remove unused variable 'cleanerProfile'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'payouts' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"payouts"},"fix":{"range":[1103,1110],"text":""},"desc":"Remove unused variable 'payouts'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":97,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":97,"endColumn":19}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { DollarSign, TrendingUp, Clock, CheckCircle, Zap, Calendar, Loader2 } from 'lucide-react';\nimport { format } from 'date-fns';\nimport InstantPayoutButton from '../components/payouts/InstantPayoutButton';\nimport PayoutHistoryTable from '../components/payouts/PayoutHistoryTable';\nimport EarningsBreakdown from '../components/payouts/EarningsBreakdown';\nimport PayoutExplainer from '../components/payouts/PayoutExplainer';\n\nexport default function CleanerPayouts() {\n  const [user, setUser] = useState(null);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [earnings, setEarnings] = useState([]);\n  const [payouts, setPayouts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [requesting, setRequesting] = useState(false);\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      // Load cleaner profile\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        setCleanerProfile(profiles[0]);\n      }\n\n      // Load earnings from CleanerEarning entity\n      const allEarnings = await base44.entities.CleanerEarning.filter(\n        { cleaner_email: currentUser.email },\n        '-created_date'\n      );\n      setEarnings(allEarnings);\n\n      // Load payouts\n      const allPayouts = await base44.entities.Payout.filter(\n        { cleaner_email: currentUser.email },\n        '-created_date'\n      );\n      setPayouts(allPayouts);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading payout data:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const calculateEarnings = () => {\n    const pendingEarnings = earnings.filter(e => e.status === 'pending');\n    const paidEarnings = earnings.filter(e => e.status === 'paid');\n    \n    const pending = pendingEarnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n    const paidOut = paidEarnings.reduce((sum, e) => sum + (e.usd_due || 0), 0);\n    const totalEarned = pending + paidOut;\n    const available = pending;\n\n    return { totalEarned, paidOut, pending, available };\n  };\n\n  const requestInstantPayout = async () => {\n    setRequesting(true);\n    setMessage('');\n\n    try {\n      const { available } = calculateEarnings();\n      \n      if (available < 50) {\n        setMessage('Minimum instant payout amount is $50');\n        setRequesting(false);\n        return;\n      }\n\n      const fee = available * 0.07; // 7% fee for instant payouts\n      const amount = available - fee;\n\n      await base44.entities.Payout.create({\n        cleaner_email: user.email,\n        amount,\n        payout_type: 'instant',\n        fee,\n        status: 'pending'\n      });\n\n      setMessage('Instant payout requested successfully! Funds will be transferred within minutes.');\n      loadData();\n    } catch (error) {\n      setMessage('Failed to request payout. Please try again.');\n    }\n    setRequesting(false);\n  };\n\n  const { totalEarned, paidOut, pending, available } = calculateEarnings();\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen p-10 flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-gradient-to-br from-slate-50 to-slate-100\">\n      <div className=\"max-w-6xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Earnings & Payouts</h1>\n          <p className=\"text-lg text-slate-600\">Track your income and request payouts</p>\n        </div>\n\n        {/* Payout System Explainer */}\n        <div className=\"mb-6\">\n          <PayoutExplainer />\n        </div>\n\n        {message && (\n          <Alert className=\"mb-6\">\n            <AlertDescription>{message}</AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-xl bg-gradient-to-br from-green-50 to-emerald-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <TrendingUp className=\"w-8 h-8 text-green-600\" />\n              </div>\n              <p className=\"text-sm text-slate-600 mb-1\">Total Earned</p>\n              <p className=\"text-3xl font-bold text-slate-900\">${totalEarned.toFixed(2)}</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-xl bg-gradient-to-br from-blue-50 to-cyan-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <DollarSign className=\"w-8 h-8 text-blue-600\" />\n              </div>\n              <p className=\"text-sm text-slate-600 mb-1\">Available</p>\n              <p className=\"text-3xl font-bold text-slate-900\">${available.toFixed(2)}</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-xl bg-gradient-to-br from-amber-50 to-yellow-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <Clock className=\"w-8 h-8 text-amber-600\" />\n              </div>\n              <p className=\"text-sm text-slate-600 mb-1\">Pending</p>\n              <p className=\"text-3xl font-bold text-slate-900\">${pending.toFixed(2)}</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-xl bg-gradient-to-br from-purple-50 to-pink-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <CheckCircle className=\"w-8 h-8 text-purple-600\" />\n              </div>\n              <p className=\"text-sm text-slate-600 mb-1\">Paid Out</p>\n              <p className=\"text-3xl font-bold text-slate-900\">${paidOut.toFixed(2)}</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Payout Information Card */}\n        <Card className=\"mb-8 rounded-3xl border-0 shadow-xl bg-gradient-to-br from-blue-50 to-indigo-50\">\n          <CardContent className=\"p-8\">\n            <h2 className=\"font-fredoka font-bold text-2xl text-slate-900 mb-4\">Payment Schedule</h2>\n            <div className=\"bg-white p-6 rounded-2xl space-y-4\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"p-3 bg-green-100 rounded-2xl flex-shrink-0\">\n                  <Calendar className=\"w-6 h-6 text-green-600\" />\n                </div>\n                <div>\n                  <h3 className=\"font-fredoka font-bold text-lg text-slate-900 mb-2\">Weekly Payouts (Free)</h3>\n                  <p className=\"text-slate-700 font-verdana mb-2\">\n                    We automatically process payouts every <strong>Friday</strong> for all earnings that have been approved. \n                  </p>\n                  <div className=\"flex flex-wrap gap-2 mt-3\">\n                    <Badge className=\"bg-green-100 text-green-800 border-0\">‚úì No Fees</Badge>\n                    <Badge className=\"bg-green-100 text-green-800 border-0\">‚úì Automatic</Badge>\n                    <Badge className=\"bg-green-100 text-green-800 border-0\">‚úì $50 Minimum</Badge>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"border-t pt-4 flex items-start gap-4\">\n                <div className=\"p-3 bg-purple-100 rounded-2xl flex-shrink-0\">\n                  <Zap className=\"w-6 h-6 text-purple-600\" />\n                </div>\n                <div>\n                  <h3 className=\"font-fredoka font-bold text-lg text-slate-900 mb-2\">Instant Payouts (7% Fee)</h3>\n                  <p className=\"text-slate-700 font-verdana mb-2\">\n                    Need your money faster? Request an instant payout and receive funds within minutes. A 7% processing fee applies.\n                  </p>\n                  <div className=\"flex flex-wrap gap-2 mt-3\">\n                    <Badge className=\"bg-purple-100 text-purple-800 border-0\">‚ö° Instant Transfer</Badge>\n                    <Badge className=\"bg-purple-100 text-purple-800 border-0\">7% Fee</Badge>\n                    <Badge className=\"bg-purple-100 text-purple-800 border-0\">$50 Minimum</Badge>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid md:grid-cols-2 gap-6 mb-8\">\n          {/* Instant Payout Card */}\n          <Card className=\"rounded-3xl border-0 shadow-xl bg-gradient-to-br from-purple-50 to-pink-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <div className=\"p-3 bg-purple-100 rounded-2xl\">\n                  <Zap className=\"w-8 h-8 text-purple-600\" />\n                </div>\n                <div>\n                  <h3 className=\"font-fredoka font-bold text-xl text-graphite\">Instant Payout</h3>\n                  <p className=\"text-sm text-gray-600 font-verdana\">7% Fee ‚Ä¢ Instant Transfer</p>\n                </div>\n              </div>\n\n              <div className=\"bg-white p-4 rounded-2xl mb-4\">\n                <p className=\"text-sm text-gray-600 font-verdana mb-2\">Available for instant payout:</p>\n                <p className=\"text-3xl font-fredoka font-bold text-purple-600\">\n                  ${available.toFixed(2)}\n                </p>\n                {available >= 50 && (\n                  <p className=\"text-xs text-gray-500 font-verdana mt-2\">\n                    After 7% fee: ${(available * 0.93).toFixed(2)}\n                  </p>\n                )}\n              </div>\n\n              <Button \n                onClick={requestInstantPayout} \n                disabled={requesting || available < 50}\n                className=\"w-full brand-gradient text-white font-fredoka font-bold rounded-full py-6 text-lg\"\n              >\n                {requesting ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    <Zap className=\"w-5 h-5 mr-2\" />\n                    Request Instant Payout\n                  </>\n                )}\n              </Button>\n\n              {available < 50 && (\n                <p className=\"text-xs text-center text-gray-500 font-verdana mt-3\">\n                  Minimum $50 required for instant payout\n                </p>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Weekly Payout Card */}\n          <Card className=\"rounded-3xl border-0 shadow-xl bg-gradient-to-br from-green-50 to-emerald-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <div className=\"p-3 bg-green-100 rounded-2xl\">\n                  <Calendar className=\"w-8 h-8 text-green-600\" />\n                </div>\n                <div>\n                  <h3 className=\"font-fredoka font-bold text-xl text-graphite\">Weekly Payout</h3>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Free ‚Ä¢ Every Friday</p>\n                </div>\n              </div>\n\n              <div className=\"bg-white p-4 rounded-2xl mb-4\">\n                <p className=\"text-sm text-gray-600 font-verdana mb-2\">Next automatic payout:</p>\n                <p className=\"text-3xl font-fredoka font-bold text-green-600\">\n                  ${pending.toFixed(2)}\n                </p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-2\">\n                  {pending >= 50 ? 'Will be paid this Friday' : 'Needs $50 minimum to process'}\n                </p>\n              </div>\n\n              <div className=\"bg-green-100 p-4 rounded-xl\">\n                <p className=\"text-sm text-green-800 font-verdana font-semibold mb-2\">\n                  ‚úì No Fees ‚Ä¢ ‚úì Automatic ‚Ä¢ ‚úì Every Friday\n                </p>\n                <p className=\"text-xs text-green-700 font-verdana\">\n                  Your earnings are automatically paid every Friday if you have at least $50 in approved earnings.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Enhanced Tabs with Module 3 Components */}\n        <Tabs defaultValue=\"earnings\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-2 bg-white shadow-md rounded-full\">\n            <TabsTrigger value=\"earnings\" className=\"rounded-full font-fredoka\">Earnings</TabsTrigger>\n            <TabsTrigger value=\"payouts\" className=\"rounded-full font-fredoka\">Payouts</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"earnings\">\n            <EarningsBreakdown cleanerEmail={user?.email} statusFilter=\"all\" />\n          </TabsContent>\n\n          <TabsContent value=\"payouts\">\n            <PayoutHistoryTable cleanerEmail={user?.email} />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerProfile.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Heart' is defined but never used.","line":15,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":60,"fix":{"range":[810,817],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Heart"},"fix":{"range":[809,816],"text":""},"desc":"Remove unused variable 'Heart'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cleanerEmail' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":39,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"cleanerEmail"},"fix":{"range":[2132,2144],"text":""},"desc":"Remove unused variable 'cleanerEmail'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":107,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":107,"endColumn":21},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleAddressChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":124,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":124,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleAddressChange"},"fix":{"range":[4847,5058],"text":""},"desc":"Remove unused variable 'handleAddressChange'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport {\n  MapPin, Star, Calendar as CalendarIcon, CheckCircle, Clock, Loader2, AlertCircle,\n  Sparkles, Camera, Shield, Briefcase, MessageCircle, Heart, Award,\n  PlayCircle, ChevronLeft, ChevronRight, Check, Zap, TrendingUp, Home, Bath, Maximize, X\n} from 'lucide-react';\nimport FavoriteButton from '@/components/favorites/FavoriteButton';\nimport MessageButton from '@/components/messaging/MessageButton';\nimport AddressAutocomplete from '@/components/address/AddressAutocomplete';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { getTierBadgeColor, getTierLightColor, getTierSolidColor } from '../components/utils/tierColors';\nimport { TIER_BASE_RANGES } from '../components/credits/CreditCalculator';\nimport AIProfileAssistant from '../components/cleaner/AIProfileAssistant';\n\nconst SERVICE_COLORS = {\n  basic: { bg: 'bg-blue-100', border: 'border-blue-400', text: 'text-blue-700', dot: 'bg-blue-500' },\n  deep: { bg: 'bg-amber-100', border: 'border-amber-400', text: 'text-amber-700', dot: 'bg-amber-500' },\n  moveout: { bg: 'bg-purple-100', border: 'border-purple-400', text: 'text-purple-700', dot: 'bg-purple-500' }\n};\n\nexport default function CleanerProfilePage() {\n  const navigate = useNavigate();\n  const [profile, setProfile] = useState(null);\n  const [reviews, setReviews] = useState([]);\n  const [photos, setPhotos] = useState([]);\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [cleanerEmail, setCleanerEmail] = useState(null);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isOwner, setIsOwner] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [editableProfile, setEditableProfile] = useState(null);\n  const [currentPhotoIndex, setCurrentPhotoIndex] = useState(0);\n  const [showAllReviews, setShowAllReviews] = useState(false);\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [bookingData, setBookingData] = useState({\n    cleaning_type: 'basic',\n    hours: 3,\n    address: '',\n    bedrooms: 1,\n    bathrooms: 1,\n    square_feet: 1000,\n    home_type: 'apartment',\n    has_pets: false,\n    parking_instructions: '',\n    entry_instructions: '',\n    start_time: '09:00'\n  });\n\n  useEffect(() => {\n    loadProfileAndUser();\n  }, []);\n\n  const loadProfileAndUser = async () => {\n    setLoading(true);\n    const params = new URLSearchParams(window.location.search);\n    const emailFromUrl = params.get('email') || params.get('cleaner');\n    setCleanerEmail(emailFromUrl);\n\n    if (!emailFromUrl) {\n      navigate(createPageUrl('BrowseCleaners'));\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const profiles = await base44.entities.CleanerProfile.filter({ user_email: emailFromUrl });\n      const cleanerProfile = profiles[0];\n\n      if (!cleanerProfile) {\n        navigate(createPageUrl('BrowseCleaners'));\n        setLoading(false);\n        return;\n      }\n\n      const cleanerReviews = await base44.entities.Review.filter({ cleaner_email: emailFromUrl }, '-created_date');\n      const cleanerPhotos = await base44.entities.PhotoPair.filter({ cleaner_email: emailFromUrl }, '-created_date');\n      const cleanerBookings = await base44.entities.Booking.filter({ \n        cleaner_email: emailFromUrl,\n        status: { $in: ['scheduled', 'accepted', 'in_progress'] }\n      });\n\n      setProfile(cleanerProfile);\n      setReviews(cleanerReviews);\n      setPhotos(cleanerPhotos);\n      setBookings(cleanerBookings);\n      setEditableProfile({ ...cleanerProfile });\n\n      try {\n        const loggedInUser = await base44.auth.me();\n        setCurrentUser(loggedInUser);\n        if (loggedInUser.email === cleanerProfile.user_email) {\n          setIsOwner(true);\n        }\n      } catch (error) {\n        setCurrentUser(null);\n        setIsOwner(false);\n      }\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading cleaner profile:', showToast: false });\n      navigate(createPageUrl('BrowseCleaners'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDateSelect = (date) => {\n    setSelectedDate(date);\n  };\n\n  const handleAddressChange = (addressData) => {\n    setBookingData(prev => ({\n      ...prev,\n      address: addressData.fullAddress,\n      latitude: addressData.lat,\n      longitude: addressData.lng\n    }));\n  };\n\n  const handleBookingSubmit = async () => {\n    if (!currentUser) {\n      navigate(createPageUrl('ClientSignup'));\n      return;\n    }\n\n    if (currentUser.user_type !== 'client') {\n      alert('Please sign in with a client account to book cleanings.');\n      return;\n    }\n\n    if (!selectedDate || !bookingData.address) {\n      alert('Please select a date and enter your address.');\n      return;\n    }\n\n    try {\n      const tierRates = TIER_BASE_RANGES[profile.tier] || TIER_BASE_RANGES['Semi Pro'];\n      const baseRate = tierRates.min;\n      const addonRate = bookingData.cleaning_type === 'deep' ? 2 : bookingData.cleaning_type === 'moveout' ? 5 : 0;\n      const totalRate = baseRate + addonRate;\n      const totalCredits = totalRate * bookingData.hours;\n\n      await base44.entities.Booking.create({\n        client_email: currentUser.email,\n        cleaner_email: profile.user_email,\n        date: selectedDate,\n        start_time: bookingData.start_time,\n        hours: bookingData.hours,\n        cleaning_type: bookingData.cleaning_type,\n        address: bookingData.address,\n        latitude: bookingData.latitude,\n        longitude: bookingData.longitude,\n        bedrooms: bookingData.bedrooms,\n        bathrooms: bookingData.bathrooms,\n        square_feet: bookingData.square_feet,\n        home_type: bookingData.home_type,\n        has_pets: bookingData.has_pets,\n        parking_instructions: bookingData.parking_instructions,\n        entry_instructions: bookingData.entry_instructions,\n        total_price: totalCredits,\n        snapshot_base_rate_cph: baseRate,\n        snapshot_selected_addon_cph: addonRate,\n        snapshot_total_rate_cph: totalRate,\n        status: 'awaiting_cleaner_response',\n        estimated_hours: bookingData.hours\n      });\n\n      alert('Booking request sent successfully!');\n      navigate(createPageUrl('ClientBookings'));\n    } catch (error) {\n      handleError(error, { userMessage: 'Booking error:', showToast: false });\n      alert('Failed to create booking. Please try again.');\n    }\n  };\n\n  const nextPhoto = () => {\n    setCurrentPhotoIndex((prev) => (prev + 1) % photos.length);\n  };\n\n  const prevPhoto = () => {\n    setCurrentPhotoIndex((prev) => (prev - 1 + photos.length) % photos.length);\n  };\n\n  const getDaysInMonth = (date) => {\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const firstDay = new Date(year, month, 1);\n    const lastDay = new Date(year, month + 1, 0);\n    const daysInMonth = lastDay.getDate();\n    const startingDayOfWeek = firstDay.getDay();\n\n    const days = [];\n    // Add empty cells for days before month starts\n    for (let i = 0; i < startingDayOfWeek; i++) {\n      days.push(null);\n    }\n    // Add all days in month\n    for (let i = 1; i <= daysInMonth; i++) {\n      days.push(new Date(year, month, i));\n    }\n    return days;\n  };\n\n  const getBookingsForDate = (date) => {\n    if (!date) return [];\n    const dateStr = date.toISOString().split('T')[0];\n    return bookings.filter(b => b.date === dateStr);\n  };\n\n  const isDateAvailable = (date) => {\n    if (!date) return false;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    if (date < today) return false;\n\n    const dayName = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][date.getDay()];\n    const avail = profile?.availability?.find(a => a.day === dayName);\n    return avail && avail.available !== false;\n  };\n\n  const prevMonth = () => {\n    setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1, 1));\n  };\n\n  const nextMonth = () => {\n    setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 1));\n  };\n\n  const handleSaveProfile = async () => {\n    try {\n      await base44.entities.CleanerProfile.update(profile.id, { ...editableProfile });\n      setProfile(editableProfile);\n      setIsEditing(false);\n      alert('Profile updated successfully!');\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving profile:', showToast: false });\n      alert('Failed to save profile. Please try again.');\n    }\n  };\n\n  const handleCancelEdit = () => {\n    setEditableProfile({ ...profile });\n    setIsEditing(false);\n  };\n\n  const handleSpecialtyChange = (specialty) => {\n    const currentSpecialties = editableProfile.specialty_tags || [];\n    if (currentSpecialties.includes(specialty)) {\n      setEditableProfile({\n        ...editableProfile,\n        specialty_tags: currentSpecialties.filter(s => s !== specialty),\n      });\n    } else {\n      setEditableProfile({\n        ...editableProfile,\n        specialty_tags: [...currentSpecialties, specialty],\n      });\n    }\n  };\n\n  const handleImageUpload = async (event) => {\n    const files = Array.from(event.target.files);\n    if (files.length === 0) return;\n\n    try {\n      const uploadedUrls = [];\n      for (const file of files) {\n        const { file_url } = await base44.integrations.Core.UploadFile({ file });\n        uploadedUrls.push(file_url);\n      }\n\n      setEditableProfile((prev) => ({\n        ...prev,\n        portfolio_items: [...(prev.portfolio_items || []), ...uploadedUrls.map(url => ({ \n          before_photo_url: url, \n          after_photo_url: url, \n          area: 'General',\n          title: 'My Work',\n          date: new Date().toISOString().split('T')[0]\n        }))]\n      }));\n      alert('Images uploaded successfully!');\n    } catch (error) {\n      handleError(error, { userMessage: 'Error uploading images:', showToast: false });\n      alert('Failed to upload images. Please try again.');\n    }\n  };\n\n  const handleRemovePortfolioItem = (indexToRemove) => {\n    setEditableProfile((prev) => ({\n      ...prev,\n      portfolio_items: prev.portfolio_items.filter((_, index) => index !== indexToRemove)\n    }));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-soft-cloud\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  if (!profile) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-soft-cloud\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n          <p className=\"text-lg text-gray-600 font-verdana mb-4\">Cleaner profile not found</p>\n          <Button onClick={() => navigate(createPageUrl('BrowseCleaners'))}>\n            Browse Other Cleaners\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  const tierIcons = {\n    'Elite': 'üëë',\n    'Pro': '‚≠ê',\n    'Semi Pro': 'üí´',\n    'Developing': 'üåü'\n  };\n  const tierRates = TIER_BASE_RANGES[profile.tier] || TIER_BASE_RANGES['Semi Pro'];\n  const baseRate = tierRates.min;\n  const topReviews = reviews.filter(r => r.rating >= 4).slice(0, 2);\n  const monthDays = getDaysInMonth(currentMonth);\n\n  const allSpecialties = [\n    \"Pet-Friendly\",\n    \"Eco-Warrior\",\n    \"Deep Clean Expert\",\n    \"Move-Out Specialist\",\n    \"Same-Day Available\",\n    \"Senior-Friendly\",\n    \"Child-Safe Products\",\n    \"Allergy-Conscious\",\n    \"Organization Pro\",\n    \"Post-Construction\"\n  ];\n\n  const specialtyIcons = {\n    'Pet-Friendly': 'üêæ',\n    'Eco-Warrior': 'üåø',\n    'Deep Clean Expert': '‚ú®',\n    'Move-Out Specialist': 'üì¶',\n    'Same-Day Available': '‚ö°',\n    'Senior-Friendly': '‚ù§Ô∏è',\n    'Child-Safe Products': 'üë∂',\n    'Allergy-Conscious': 'üå∏',\n    'Organization Pro': 'üìã',\n    'Post-Construction': 'üèóÔ∏è'\n  };\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* HERO SNAPSHOT SECTION */}\n      <div className=\"bg-white border-b-4 border-puretask-blue shadow-lg\">\n        <div className=\"max-w-7xl mx-auto px-3 sm:px-6 py-6 sm:py-10\">\n          <div className=\"grid md:grid-cols-3 gap-4 sm:gap-8\">\n            {/* LEFT: Profile Photo & Trust Signals */}\n            <div className=\"flex flex-col items-center md:items-start\">\n              <motion.div\n                initial={{ scale: 0.9, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                className=\"relative mb-4\"\n              >\n                {profile.profile_photo_url ? (\n                  <img\n                    src={profile.profile_photo_url}\n                    alt={profile.full_name}\n                    className={`w-32 h-32 sm:w-48 sm:h-48 rounded-3xl object-cover shadow-2xl border-4`}\n                    style={{ borderColor: getTierSolidColor(profile.tier) }}\n                  />\n                ) : (\n                  <div className={`w-32 h-32 sm:w-48 sm:h-48 rounded-3xl flex items-center justify-center text-5xl sm:text-7xl font-bold text-white shadow-2xl border-4 border-white font-fredoka`} style={{ backgroundColor: getTierSolidColor(profile.tier) }}>\n                    {profile.full_name?.[0]?.toUpperCase() || '?'}\n                  </div>\n                )}\n                <Badge className={`${getTierBadgeColor(profile.tier)} absolute -bottom-3 left-1/2 transform -translate-x-1/2 px-4 sm:px-6 py-1.5 sm:py-2 text-sm sm:text-lg font-fredoka font-bold shadow-lg border-2 border-white`}>\n                  {tierIcons[profile.tier] || 'üåü'} {profile.tier}\n                </Badge>\n              </motion.div>\n\n              {/* Trust Badges */}\n              <div className=\"flex flex-col gap-2 sm:gap-3 w-full mt-4 sm:mt-6\">\n                {profile.admin_verified && (\n                  <Badge className=\"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-2 border-white shadow-lg text-xs sm:text-base px-3 sm:px-4 py-1.5 sm:py-2 font-fredoka font-bold justify-center\">\n                    <Award className=\"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2\" />\n                    Admin Verified ‚úì\n                  </Badge>\n                )}\n                <Badge className=\"bg-green-100 text-green-700 border-2 border-green-300 text-xs sm:text-base px-3 sm:px-4 py-1.5 sm:py-2 font-fredoka font-bold justify-center\">\n                  <Shield className=\"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2\" />\n                  Verified Cleaner\n                </Badge>\n                <Badge className=\"bg-blue-100 text-blue-700 border-2 border-blue-300 text-xs sm:text-base px-3 sm:px-4 py-1.5 sm:py-2 font-fredoka font-bold justify-center\">\n                  <Check className=\"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2\" />\n                  Background Checked\n                </Badge>\n                {profile.instant_book_enabled && (\n                  <Badge className=\"bg-purple-100 text-purple-700 border-2 border-purple-300 text-xs sm:text-base px-3 sm:px-4 py-1.5 sm:py-2 font-fredoka font-bold justify-center\">\n                    <Zap className=\"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2\" />\n                    Instant Book Available\n                  </Badge>\n                )}\n              </div>\n            </div>\n\n            {/* MIDDLE: Info & Bio */}\n            <div className=\"md:col-span-2 space-y-4 sm:space-y-6\">\n              <div>\n                <h1 className=\"text-2xl sm:text-3xl lg:text-5xl font-fredoka font-bold text-graphite mb-3 sm:mb-4\">\n                  {profile.full_name || 'Professional Cleaner'}\n                </h1>\n                \n                {/* Key Stats Row */}\n                <div className=\"flex flex-wrap gap-3 sm:gap-6 mb-4 sm:mb-6\">\n                  <div className=\"flex items-center gap-1.5 sm:gap-2\">\n                    <Star className=\"w-5 h-5 sm:w-7 sm:h-7 fill-amber-400 text-amber-400\" />\n                    <div>\n                      <span className=\"text-xl sm:text-3xl font-fredoka font-bold text-graphite\">\n                        {profile.average_rating?.toFixed(1) || '5.0'}\n                      </span>\n                      <span className=\"text-xs sm:text-base text-gray-600 font-verdana ml-1 sm:ml-2\">({profile.total_reviews || 0} reviews)</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-1.5 sm:gap-2\">\n                    <Briefcase className=\"w-5 h-5 sm:w-7 sm:h-7 text-puretask-blue\" />\n                    <span className=\"text-lg sm:text-2xl font-fredoka font-bold text-puretask-blue\">\n                      {profile.total_jobs || 0} Jobs\n                    </span>\n                  </div>\n                  {profile.years_of_experience > 0 && (\n                    <div className=\"flex items-center gap-1.5 sm:gap-2\">\n                      <Award className=\"w-5 h-5 sm:w-7 sm:h-7 text-fresh-mint\" />\n                      <span className=\"text-lg sm:text-2xl font-fredoka font-bold text-fresh-mint\">\n                        {profile.years_of_experience} Years\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Years of Experience - Editable */}\n                {isEditing && (\n                  <div className=\"mb-4\">\n                    <Label className=\"font-fredoka font-semibold text-graphite mb-2 block\">Years of Experience</Label>\n                    <Input\n                      type=\"number\"\n                      min=\"0\"\n                      max=\"50\"\n                      step=\"0.5\"\n                      value={editableProfile?.years_of_experience || 0}\n                      onChange={(e) => setEditableProfile({ ...editableProfile, years_of_experience: parseFloat(e.target.value) || 0 })}\n                      placeholder=\"e.g., 5\"\n                      className=\"border-2 max-w-xs\"\n                    />\n                  </div>\n                )}\n\n                {/* Bio/Tagline */}\n                {isEditing ? (\n                  <Textarea\n                    value={editableProfile?.bio || ''}\n                    onChange={(e) => setEditableProfile({ ...editableProfile, bio: e.target.value })}\n                    placeholder=\"Tell clients about yourself...\"\n                    className=\"border-2\"\n                    rows={4}\n                  />\n                ) : (\n                  profile.bio && (\n                    <Card className={`border-2 shadow-md`} style={{ backgroundColor: getTierLightColor(profile.tier), borderColor: getTierSolidColor(profile.tier) }}>\n                      <CardContent className=\"p-4 sm:p-6\">\n                        <p className=\"text-sm sm:text-lg text-gray-700 font-verdana leading-relaxed italic\">\n                          \"{profile.bio}\"\n                        </p>\n                      </CardContent>\n                    </Card>\n                  )\n                )}\n              </div>\n\n              {/* Quick Actions / Edit Profile */}\n              <div className=\"flex gap-2\">\n                {isOwner ? (\n                  isEditing ? (\n                    <div className=\"flex gap-2 w-full\">\n                      <Button\n                        onClick={handleSaveProfile}\n                        className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-bold\"\n                      >\n                        Save Changes\n                      </Button>\n                      <Button\n                        onClick={handleCancelEdit}\n                        variant=\"outline\"\n                        className=\"flex-1 rounded-full font-fredoka font-bold\"\n                      >\n                        Cancel\n                      </Button>\n                    </div>\n                  ) : (\n                    <Button\n                      onClick={() => setIsEditing(true)}\n                      className=\"flex-1 brand-gradient text-white rounded-full font-fredoka font-bold\"\n                    >\n                      Edit Profile\n                    </Button>\n                  )\n                ) : (\n                  currentUser && currentUser.user_type === 'client' && (\n                    <>\n                      <MessageButton \n                        recipientEmail={profile.user_email}\n                        recipientName={profile.full_name}\n                        variant=\"outline\"\n                        className=\"flex-1 border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50 font-fredoka font-bold\"\n                      />\n                      <FavoriteButton \n                        cleanerEmail={profile.user_email} \n                        user={currentUser}\n                        className=\"font-fredoka font-bold\"\n                      />\n                    </>\n                  )\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* BOOKING SECTION */}\n      <div className=\"bg-gradient-to-br from-blue-50 via-white to-cyan-50 py-8\">\n        <div className=\"max-w-7xl mx-auto px-3 sm:px-6\">\n          <div className=\"grid lg:grid-cols-2 gap-6\">\n            {/* CALENDAR */}\n            <Card className=\"border-2 border-puretask-blue shadow-xl\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-500 to-cyan-500 text-white\">\n                <div className=\"flex items-center justify-between\">\n                  <Button variant=\"ghost\" size=\"icon\" onClick={prevMonth} className=\"text-white hover:bg-white/20\">\n                    <ChevronLeft className=\"w-6 h-6\" />\n                  </Button>\n                  <CardTitle className=\"font-fredoka text-2xl\">\n                    {currentMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                  </CardTitle>\n                  <Button variant=\"ghost\" size=\"icon\" onClick={nextMonth} className=\"text-white hover:bg-white/20\">\n                    <ChevronRight className=\"w-6 h-6\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent className=\"p-4\">\n                {/* Day headers */}\n                <div className=\"grid grid-cols-7 gap-1 mb-2\">\n                  {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\n                    <div key={day} className=\"text-center text-sm font-fredoka font-bold text-gray-600 py-2\">\n                      {day}\n                    </div>\n                  ))}\n                </div>\n                {/* Calendar grid */}\n                <div className=\"grid grid-cols-7 gap-1\">\n                  {monthDays.map((date, idx) => {\n                    if (!date) {\n                      return <div key={`empty-${idx}`} className=\"aspect-square\" />;\n                    }\n                    const dayBookings = getBookingsForDate(date);\n                    const available = isDateAvailable(date);\n                    const isSelected = selectedDate === date.toISOString().split('T')[0];\n                    \n                    return (\n                      <button\n                        key={idx}\n                        onClick={() => available && handleDateSelect(date.toISOString().split('T')[0])}\n                        disabled={!available}\n                        className={`aspect-square p-1 rounded-lg border-2 transition-all ${\n                          isSelected\n                            ? 'border-puretask-blue bg-blue-100 shadow-lg scale-105'\n                            : available\n                            ? 'border-gray-200 hover:border-puretask-blue hover:bg-blue-50 cursor-pointer'\n                            : 'border-gray-100 bg-gray-50 cursor-not-allowed opacity-50'\n                        }`}\n                      >\n                        <div className=\"text-sm font-fredoka font-bold text-graphite\">\n                          {date.getDate()}\n                        </div>\n                        <div className=\"flex gap-0.5 justify-center mt-1 flex-wrap\">\n                          {dayBookings.slice(0, 3).map((booking, i) => (\n                            <div\n                              key={i}\n                              className={`w-1.5 h-1.5 rounded-full ${SERVICE_COLORS[booking.cleaning_type]?.dot || 'bg-gray-400'}`}\n                              title={booking.cleaning_type}\n                            />\n                          ))}\n                        </div>\n                      </button>\n                    );\n                  })}\n                </div>\n                {/* Legend */}\n                <div className=\"mt-4 pt-4 border-t flex flex-wrap gap-3 text-xs\">\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-3 h-3 rounded-full bg-blue-500\" />\n                    <span className=\"font-verdana\">Basic Clean</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-3 h-3 rounded-full bg-amber-500\" />\n                    <span className=\"font-verdana\">Deep Clean</span>\n                  </div>\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-3 h-3 rounded-full bg-purple-500\" />\n                    <span className=\"font-verdana\">Move-Out</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* BOOKING FORM */}\n            <Card className=\"border-2 border-puretask-blue shadow-xl\">\n              <CardHeader className=\"bg-gradient-to-r from-green-500 to-teal-500 text-white\">\n                <CardTitle className=\"font-fredoka text-2xl flex items-center gap-2\">\n                  <CalendarIcon className=\"w-6 h-6\" />\n                  Book Your Cleaning\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6 space-y-4\">\n                {/* Service Type */}\n                <div>\n                  <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Service Type</Label>\n                  <Select value={bookingData.cleaning_type} onValueChange={(val) => setBookingData({...bookingData, cleaning_type: val})}>\n                    <SelectTrigger className=\"border-2\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"basic\">Basic Clean (${baseRate}/hr)</SelectItem>\n                      <SelectItem value=\"deep\">Deep Clean (${baseRate + 2}/hr)</SelectItem>\n                      <SelectItem value=\"moveout\">Move-Out (${baseRate + 5}/hr)</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Date & Time */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Date</Label>\n                    <Input \n                      value={selectedDate || ''} \n                      readOnly \n                      placeholder=\"Select from calendar\"\n                      className=\"border-2\"\n                    />\n                  </div>\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Time</Label>\n                    <Select value={bookingData.start_time} onValueChange={(val) => setBookingData({...bookingData, start_time: val})}>\n                      <SelectTrigger className=\"border-2\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"08:00\">8:00 AM</SelectItem>\n                        <SelectItem value=\"09:00\">9:00 AM</SelectItem>\n                        <SelectItem value=\"10:00\">10:00 AM</SelectItem>\n                        <SelectItem value=\"11:00\">11:00 AM</SelectItem>\n                        <SelectItem value=\"12:00\">12:00 PM</SelectItem>\n                        <SelectItem value=\"13:00\">1:00 PM</SelectItem>\n                        <SelectItem value=\"14:00\">2:00 PM</SelectItem>\n                        <SelectItem value=\"15:00\">3:00 PM</SelectItem>\n                        <SelectItem value=\"16:00\">4:00 PM</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                {/* Hours */}\n                <div>\n                  <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Hours Needed</Label>\n                  <Select value={bookingData.hours.toString()} onValueChange={(val) => setBookingData({...bookingData, hours: parseInt(val)})}>\n                    <SelectTrigger className=\"border-2\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {[2, 3, 4, 5, 6, 7, 8].map(h => (\n                        <SelectItem key={h} value={h.toString()}>{h} hours</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Address */}\n                <div>\n                  <AddressAutocomplete \n                    value={bookingData.address}\n                    onChange={(address) => {\n                      setBookingData(prev => ({\n                        ...prev,\n                        address,\n                        latitude: null,\n                        longitude: null\n                      }));\n                    }}\n                    onLocationSelect={(location) => {\n                      setBookingData(prev => ({\n                        ...prev,\n                        address: location.address,\n                        latitude: location.latitude,\n                        longitude: location.longitude\n                      }));\n                    }}\n                    placeholder=\"Start typing your address...\"\n                    label=\"Your Address\"\n                    required\n                  />\n                  {bookingData.latitude && bookingData.longitude && (\n                    <div className=\"flex items-center gap-2 text-sm text-green-600 font-verdana mt-2\">\n                      <CheckCircle className=\"w-4 h-4\" />\n                      Address verified ‚úì\n                    </div>\n                  )}\n                </div>\n\n                {/* Home Details */}\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block flex items-center gap-1\">\n                      <Home className=\"w-4 h-4\" /> Beds\n                    </Label>\n                    <Input \n                      type=\"number\" \n                      value={bookingData.bedrooms}\n                      onChange={(e) => setBookingData({...bookingData, bedrooms: parseInt(e.target.value)})}\n                      className=\"border-2\"\n                    />\n                  </div>\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block flex items-center gap-1\">\n                      <Bath className=\"w-4 h-4\" /> Baths\n                    </Label>\n                    <Input \n                      type=\"number\" \n                      value={bookingData.bathrooms}\n                      onChange={(e) => setBookingData({...bookingData, bathrooms: parseFloat(e.target.value)})}\n                      className=\"border-2\"\n                      step=\"0.5\"\n                    />\n                  </div>\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block flex items-center gap-1\">\n                      <Maximize className=\"w-4 h-4\" /> Sq Ft\n                    </Label>\n                    <Input \n                      type=\"number\" \n                      value={bookingData.square_feet}\n                      onChange={(e) => setBookingData({...bookingData, square_feet: parseInt(e.target.value)})}\n                      className=\"border-2\"\n                    />\n                  </div>\n                </div>\n\n                {/* Home Type & Pets */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Home Type</Label>\n                    <Select value={bookingData.home_type} onValueChange={(val) => setBookingData({...bookingData, home_type: val})}>\n                      <SelectTrigger className=\"border-2\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"apartment\">Apartment</SelectItem>\n                        <SelectItem value=\"house\">House</SelectItem>\n                        <SelectItem value=\"condo\">Condo</SelectItem>\n                        <SelectItem value=\"townhouse\">Townhouse</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Pets?</Label>\n                    <Select value={bookingData.has_pets.toString()} onValueChange={(val) => setBookingData({...bookingData, has_pets: val === 'true'})}>\n                      <SelectTrigger className=\"border-2\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"false\">No</SelectItem>\n                        <SelectItem value=\"true\">Yes</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                {/* Instructions */}\n                <div>\n                  <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Parking Instructions</Label>\n                  <Textarea \n                    value={bookingData.parking_instructions}\n                    onChange={(e) => setBookingData({...bookingData, parking_instructions: e.target.value})}\n                    className=\"border-2\"\n                    rows={2}\n                    placeholder=\"Where should the cleaner park?\"\n                  />\n                </div>\n\n                <div>\n                  <Label className=\"font-fredoka font-bold text-graphite mb-2 block\">Entry Instructions</Label>\n                  <Textarea \n                    value={bookingData.entry_instructions}\n                    onChange={(e) => setBookingData({...bookingData, entry_instructions: e.target.value})}\n                    className=\"border-2\"\n                    rows={2}\n                    placeholder=\"How should the cleaner enter?\"\n                  />\n                </div>\n\n                {/* Price Summary */}\n                <div className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl p-4 border-2 border-puretask-blue\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"font-fredoka font-bold text-graphite\">Estimated Total:</span>\n                    <span className=\"text-3xl font-fredoka font-bold text-puretask-blue\">\n                      ${(baseRate + (bookingData.cleaning_type === 'deep' ? 2 : bookingData.cleaning_type === 'moveout' ? 5 : 0)) * bookingData.hours}\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-gray-600 font-verdana\">\n                    {bookingData.hours} hours √ó ${baseRate + (bookingData.cleaning_type === 'deep' ? 2 : bookingData.cleaning_type === 'moveout' ? 5 : 0)}/hr\n                  </p>\n                </div>\n\n                {/* Submit Button */}\n                <Button \n                  onClick={handleBookingSubmit}\n                  className=\"w-full brand-gradient text-white font-fredoka font-bold text-lg py-6\"\n                  size=\"lg\"\n                >\n                  <Check className=\"w-5 h-5 mr-2\" />\n                  Request Booking\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* MAIN CONTENT */}\n      <div className=\"max-w-7xl mx-auto px-3 sm:px-6 py-6 sm:py-10 space-y-6 sm:space-y-10\">\n        \n        {/* VIDEO INTRODUCTION */}\n        {profile.video_intro_url && (\n          <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n            <CardHeader className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white\">\n              <CardTitle className=\"font-fredoka text-xl sm:text-3xl flex items-center gap-2 sm:gap-3\">\n                <PlayCircle className=\"w-6 h-6 sm:w-8 sm:h-8\" />\n                Meet {profile.full_name?.split(' ')[0]}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-4 sm:p-8\">\n              <div className=\"aspect-video bg-gray-900 rounded-2xl overflow-hidden\">\n                <video \n                  src={profile.video_intro_url} \n                  controls \n                  className=\"w-full h-full\"\n                  poster={profile.profile_photo_url}\n                >\n                  Your browser does not support the video tag.\n                </video>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        <div className=\"grid lg:grid-cols-3 gap-6 sm:gap-10\">\n          {/* LEFT COLUMN: Reliability & Availability */}\n          <div className=\"lg:col-span-2 space-y-6 sm:space-y-10\">\n            \n            {/* RELIABILITY SCORE */}\n            <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n              <CardHeader className={`text-white`} style={{ backgroundColor: getTierSolidColor(profile.tier) }}>\n                <CardTitle className=\"font-fredoka text-xl sm:text-3xl flex items-center gap-2 sm:gap-3\">\n                  <TrendingUp className=\"w-6 h-6 sm:w-8 sm:h-8\" />\n                  Reliability Score\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4 sm:p-8\">\n                <div className=\"flex flex-col sm:flex-row items-center justify-between gap-4 mb-4 sm:mb-6\">\n                  <div className=\"text-center sm:text-left\">\n                    <p className=\"text-5xl sm:text-7xl font-fredoka font-bold text-puretask-blue mb-2\">\n                      {profile.reliability_score || 75}\n                    </p>\n                    <p className=\"text-base sm:text-lg text-gray-600 font-verdana\">\n                      {profile.reliability_score >= 90 ? 'Outstanding' : \n                       profile.reliability_score >= 75 ? 'Excellent' : \n                       profile.reliability_score >= 60 ? 'Good' : 'Developing'} Performance\n                    </p>\n                  </div>\n                  <div className=\"w-32 h-32 sm:w-48 sm:h-48\">\n                    <svg viewBox=\"0 0 100 100\" className=\"transform -rotate-90\">\n                      <circle cx=\"50\" cy=\"50\" r=\"45\" fill=\"none\" stroke=\"#E5E7EB\" strokeWidth=\"10\" />\n                      <circle \n                        cx=\"50\" \n                        cy=\"50\" \n                        r=\"45\" \n                        fill=\"none\" \n                        stroke=\"url(#gradient)\" \n                        strokeWidth=\"10\"\n                        strokeDasharray={`${((profile.reliability_score || 75) / 100) * 283} 283`}\n                        strokeLinecap=\"round\"\n                      />\n                      <defs>\n                        <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                          <stop offset=\"0%\" stopColor=\"#66B3FF\" />\n                          <stop offset=\"100%\" stopColor=\"#00D4FF\" />\n                        </linearGradient>\n                      </defs>\n                    </svg>\n                  </div>\n                </div>\n                \n                <p className=\"text-sm sm:text-base text-gray-700 font-verdana mb-4 sm:mb-6\">\n                  This score reflects on-time arrival, task completion, photo quality, and client satisfaction.\n                </p>\n\n                {/* Key Stats Grid */}\n                <div className=\"grid grid-cols-2 gap-3 sm:gap-4\">\n                  <div className=\"bg-green-50 border-2 border-green-200 rounded-2xl p-3 sm:p-4 text-center\">\n                    <CheckCircle className=\"w-5 h-5 sm:w-6 sm:h-6 text-green-600 mx-auto mb-1 sm:mb-2\" />\n                    <p className=\"text-lg sm:text-2xl font-fredoka font-bold text-green-600\">{profile.attendance_rate || 100}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Attendance</p>\n                  </div>\n                  <div className=\"bg-blue-50 border-2 border-blue-200 rounded-2xl p-3 sm:p-4 text-center\">\n                    <Clock className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600 mx-auto mb-1 sm:mb-2\" />\n                    <p className=\"text-lg sm:text-2xl font-fredoka font-bold text-blue-600\">{profile.punctuality_rate || 100}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">On-Time</p>\n                  </div>\n                  <div className=\"bg-purple-50 border-2 border-purple-200 rounded-2xl p-3 sm:p-4 text-center\">\n                    <Camera className=\"w-5 h-5 sm:w-6 sm:h-6 text-purple-600 mx-auto mb-1 sm:mb-2\" />\n                    <p className=\"text-lg sm:text-2xl font-fredoka font-bold text-purple-600\">{profile.photo_compliance_rate || 100}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Photo Quality</p>\n                  </div>\n                  <div className=\"bg-amber-50 border-2 border-amber-200 rounded-2xl p-3 sm:p-4 text-center\">\n                    <MessageCircle className=\"w-5 h-5 sm:w-6 sm:h-6 text-amber-600 mx-auto mb-1 sm:mb-2\" />\n                    <p className=\"text-lg sm:text-2xl font-fredoka font-bold text-amber-600\">{profile.communication_rate || 100}%</p>\n                    <p className=\"text-xs text-gray-600 font-verdana\">Communication</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* HIGHLIGHTED REVIEWS */}\n            {topReviews.length > 0 && (\n              <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n                <CardHeader className=\"bg-gradient-to-r from-amber-400 to-orange-500 text-white\">\n                  <CardTitle className=\"font-fredoka text-xl sm:text-3xl flex items-center gap-2 sm:gap-3\">\n                    <Star className=\"w-6 h-6 sm:w-8 sm:h-8\" />\n                    What Clients Say\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4 sm:p-8 space-y-4 sm:space-y-6\">\n                  {topReviews.map((review) => (\n                    <motion.div\n                      key={review.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      className=\"bg-amber-50 border-2 border-amber-200 rounded-2xl p-4 sm:p-6\"\n                    >\n                      <div className=\"flex items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3\">\n                        {[...Array(5)].map((_, i) => (\n                          <Star\n                            key={i}\n                            className={`w-4 h-4 sm:w-6 sm:h-6 ${i < review.rating ? 'fill-amber-400 text-amber-400' : 'text-gray-300'}`}\n                          />\n                        ))}\n                      </div>\n                      <p className=\"text-sm sm:text-lg text-gray-700 font-verdana leading-relaxed mb-2 sm:mb-3 italic\">\n                        \"{review.comment}\"\n                      </p>\n                      <div className=\"flex items-center justify-between\">\n                        <p className=\"text-sm text-gray-500 font-verdana\">\n                          {new Date(review.created_date).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                        </p>\n                        {review.would_recommend && (\n                          <Badge className=\"bg-green-500 text-white font-fredoka\">\n                            <Check className=\"w-4 h-4 mr-1\" />\n                            Recommends\n                          </Badge>\n                        )}\n                      </div>\n                    </motion.div>\n                  ))}\n                  \n                  {reviews.length > 2 && (\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => setShowAllReviews(!showAllReviews)}\n                      className=\"w-full border-2 border-amber-400 text-amber-600 hover:bg-amber-50 font-fredoka font-bold\"\n                    >\n                      {showAllReviews ? 'Show Less Reviews' : `View All ${reviews.length} Reviews`}\n                    </Button>\n                  )}\n\n                  {showAllReviews && reviews.slice(2).map((review) => (\n                    <motion.div\n                      key={review.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      className=\"bg-gray-50 border-2 border-gray-200 rounded-2xl p-6\"\n                    >\n                      <div className=\"flex items-center gap-2 mb-3\">\n                        {[...Array(5)].map((_, i) => (\n                          <Star\n                            key={i}\n                            className={`w-5 h-5 ${i < review.rating ? 'fill-amber-400 text-amber-400' : 'text-gray-300'}`}\n                          />\n                        ))}\n                      </div>\n                      <p className=\"text-gray-700 font-verdana leading-relaxed mb-3\">\n                        {review.comment}\n                      </p>\n                      <p className=\"text-sm text-gray-500 font-verdana\">\n                        {new Date(review.created_date).toLocaleDateString()}\n                      </p>\n                    </motion.div>\n                  ))}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* BEFORE & AFTER PHOTOS */}\n            {photos.length > 0 && (\n              <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n                <CardHeader className=\"bg-gradient-to-r from-pink-500 to-purple-500 text-white\">\n                  <CardTitle className=\"font-fredoka text-xl sm:text-3xl flex items-center gap-2 sm:gap-3\">\n                    <Camera className=\"w-6 h-6 sm:w-8 sm:h-8\" />\n                    Before & After Work\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4 sm:p-8\">\n                  <div className=\"relative\">\n                    <AnimatePresence mode=\"wait\">\n                      <motion.div\n                        key={currentPhotoIndex}\n                        initial={{ opacity: 0, x: 100 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        exit={{ opacity: 0, x: -100 }}\n                        className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6\"\n                      >\n                        <div>\n                          <p className=\"text-xs sm:text-sm font-fredoka font-bold text-gray-600 mb-2 sm:mb-3\">BEFORE</p>\n                          <img\n                            src={photos[currentPhotoIndex].before_photo_url}\n                            alt=\"Before\"\n                            className=\"w-full h-48 sm:h-80 object-cover rounded-2xl shadow-lg border-4 border-gray-300\"\n                          />\n                        </div>\n                        <div>\n                          <p className=\"text-xs sm:text-sm font-fredoka font-bold text-green-600 mb-2 sm:mb-3\">AFTER</p>\n                          <img\n                            src={photos[currentPhotoIndex].after_photo_url}\n                            alt=\"After\"\n                            className=\"w-full h-48 sm:h-80 object-cover rounded-2xl shadow-lg border-4 border-green-400\"\n                          />\n                        </div>\n                      </motion.div>\n                    </AnimatePresence>\n\n                    {photos.length > 1 && (\n                      <>\n                        <Button\n                          variant=\"outline\"\n                          size=\"icon\"\n                          onClick={prevPhoto}\n                          className=\"absolute left-0 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white shadow-xl rounded-full w-12 h-12\"\n                        >\n                          <ChevronLeft className=\"w-6 h-6\" />\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"icon\"\n                          onClick={nextPhoto}\n                          className=\"absolute right-0 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white shadow-xl rounded-full w-12 h-12\"\n                        >\n                          <ChevronRight className=\"w-6 h-6\" />\n                        </Button>\n                      </>\n                    )}\n                  </div>\n\n                  {photos[currentPhotoIndex].area && (\n                    <p className=\"text-center text-sm sm:text-lg font-fredoka font-bold text-gray-700 mt-4 sm:mt-6\">\n                      {photos[currentPhotoIndex].area}\n                    </p>\n                  )}\n\n                  <div className=\"flex justify-center gap-2 mt-6\">\n                    {photos.map((_, idx) => (\n                      <button\n                        key={idx}\n                        onClick={() => setCurrentPhotoIndex(idx)}\n                        className={`w-3 h-3 rounded-full transition-all ${\n                          idx === currentPhotoIndex ? 'bg-puretask-blue w-8' : 'bg-gray-300'\n                        }`}\n                      />\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* AI PROFILE ASSISTANT */}\n            {isOwner && (\n              <AIProfileAssistant \n                profile={profile}\n                bookings={bookings}\n                reviews={reviews}\n                onUpdate={(updated) => {\n                  setProfile(updated);\n                  setEditableProfile(updated);\n                }}\n              />\n            )}\n\n            {/* AI PROFILE ASSISTANT */}\n            {isOwner && (\n              <AIProfileAssistant \n                profile={profile}\n                bookings={bookings}\n                reviews={reviews}\n                onUpdate={(updated) => {\n                  setProfile(updated);\n                  setEditableProfile(updated);\n                }}\n              />\n            )}\n\n            {/* GALLERY EDIT SECTION */}\n            {isOwner && isEditing && (\n              <Card className=\"border-0 shadow-2xl rounded-3xl overflow-hidden\">\n                <CardHeader className=\"bg-gradient-to-r from-teal-500 to-green-500 text-white\">\n                  <CardTitle className=\"font-fredoka text-xl sm:text-3xl flex items-center gap-2 sm:gap-3\">\n                    <Camera className=\"w-6 h-6 sm:w-8 sm:h-8\" />\n                    Manage Your Portfolio\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4 sm:p-8 space-y-4\">\n                  <Label htmlFor=\"portfolio-upload\" className=\"font-fredoka font-bold text-graphite mb-2 block\">Upload Photos</Label>\n                  <Input \n                    id=\"portfolio-upload\"\n                    type=\"file\" \n                    multiple \n                    accept=\"image/*\"\n                    onChange={handleImageUpload} \n                    className=\"border-2 p-2 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-puretask-blue file:text-white hover:file:bg-blue-600\"\n                  />\n                  <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4\">\n                    {editableProfile?.portfolio_items?.map((item, index) => (\n                      <div key={index} className=\"relative group\">\n                        <img \n                          src={item.after_photo_url || item.before_photo_url}\n                          alt={`Portfolio item ${index + 1}`}\n                          className=\"w-full h-24 object-cover rounded-lg border-2 border-gray-200\"\n                        />\n                        <Button \n                          variant=\"destructive\" \n                          size=\"icon\" \n                          className=\"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity\"\n                          onClick={() => handleRemovePortfolioItem(index)}\n                        >\n                          <X className=\"h-3 w-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n          </div>\n\n          {/* RIGHT COLUMN: Services & Stats */}\n          <div className=\"space-y-6\">\n\n            {/* SERVICES & SPECIALTIES */}\n            <Card className=\"border-0 shadow-2xl rounded-3xl\">\n              <CardHeader className=\"bg-gradient-to-r from-indigo-500 to-purple-500 text-white\">\n                <CardTitle className=\"font-fredoka text-lg sm:text-2xl flex items-center gap-2\">\n                  <Sparkles className=\"w-5 h-5 sm:w-6 sm:h-6\" />\n                  Services & Specialties\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4 sm:p-6 space-y-4 sm:space-y-6\">\n                {/* Cleaning Types */}\n                <div>\n                  <p className=\"text-sm font-fredoka font-bold text-gray-600 mb-3\">CLEANING TYPES</p>\n                  <div className=\"flex flex-col gap-2\">\n                    <Badge className=\"bg-blue-100 text-blue-700 border-2 border-blue-300 text-base px-4 py-2 font-fredoka font-bold justify-start\">\n                      ‚úì Basic Clean\n                    </Badge>\n                    <Badge className=\"bg-amber-100 text-amber-700 border-2 border-amber-300 text-base px-4 py-2 font-fredoka font-bold justify-start\">\n                      ‚úì Deep Clean\n                    </Badge>\n                    <Badge className=\"bg-purple-100 text-purple-700 border-2 border-purple-300 text-base px-4 py-2 font-fredoka font-bold justify-start\">\n                      ‚úì Move-Out Clean\n                    </Badge>\n                  </div>\n                </div>\n\n                {/* Specialties */}\n                <div>\n                  <p className=\"text-sm font-fredoka font-bold text-gray-600 mb-3\">SPECIALTIES</p>\n                  {isEditing ? (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {allSpecialties.map((specialty, idx) => (\n                        <Badge\n                          key={idx}\n                          onClick={() => handleSpecialtyChange(specialty)}\n                          className={`cursor-pointer transition-colors text-sm px-3 py-2 font-fredoka font-bold ${\n                            editableProfile?.specialty_tags?.includes(specialty)\n                              ? 'bg-puretask-blue text-white border-2 border-puretask-blue'\n                              : 'bg-gray-100 text-gray-600 border-2 border-gray-300 hover:bg-gray-200'\n                          }`}\n                        >\n                          {specialtyIcons[specialty] || '‚ú®'} {specialty}\n                        </Badge>\n                      ))}\n                    </div>\n                  ) : (\n                    profile.specialty_tags && profile.specialty_tags.length > 0 ? (\n                      <div className=\"flex flex-wrap gap-2\">\n                        {profile.specialty_tags.map((specialty, idx) => (\n                          <Badge\n                            key={idx}\n                            className=\"bg-gradient-to-r from-pink-100 to-purple-100 text-purple-700 border-2 border-purple-300 text-sm px-3 py-2 font-fredoka font-bold\"\n                          >\n                            {specialtyIcons[specialty] || '‚ú®'} {specialty}\n                          </Badge>\n                        ))}\n                      </div>\n                    ) : (\n                      <p className=\"text-sm text-gray-500 font-verdana\">No specialties listed.</p>\n                    )\n                  )}\n                </div>\n\n                {/* Service Areas */}\n                <div>\n                  <p className=\"text-sm font-fredoka font-bold text-gray-600 mb-3\">SERVICE AREAS</p>\n                  {isEditing ? (\n                    <div className=\"space-y-2\">\n                      <Input\n                        value={editableProfile?.service_locations?.join(', ') || ''}\n                        onChange={(e) => setEditableProfile({\n                          ...editableProfile,\n                          service_locations: e.target.value.split(',').map(s => s.trim()).filter(Boolean)\n                        })}\n                        placeholder=\"e.g., Downtown, Midtown, Uptown\"\n                        className=\"border-2\"\n                      />\n                      <p className=\"text-xs text-gray-500 font-verdana\">Separate areas with commas</p>\n                    </div>\n                  ) : (\n                    profile.service_locations && profile.service_locations.length > 0 ? (\n                      <div className=\"flex flex-wrap gap-2\">\n                        {profile.service_locations.map((location, idx) => (\n                          <Badge\n                            key={idx}\n                            variant=\"outline\"\n                            className=\"text-sm px-3 py-1 font-verdana border-2\"\n                          >\n                            <MapPin className=\"w-3 h-3 mr-1\" />\n                            {location}\n                          </Badge>\n                        ))}\n                      </div>\n                    ) : (\n                      <p className=\"text-sm text-gray-500 font-verdana\">No service areas listed.</p>\n                    )\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* RESPONSE TIME */}\n            <Card className=\"border-0 shadow-2xl rounded-3xl\">\n              <CardContent className=\"p-4 sm:p-6 text-center\">\n                <MessageCircle className=\"w-10 h-10 sm:w-12 sm:h-12 text-puretask-blue mx-auto mb-2 sm:mb-3\" />\n                <p className=\"text-xs sm:text-sm text-gray-600 font-verdana mb-1\">Typical Response Time</p>\n                <p className=\"text-2xl sm:text-3xl font-fredoka font-bold text-puretask-blue\">\n                  {profile.typical_response_time || '< 2 hours'}\n                </p>\n              </CardContent>\n            </Card>\n\n\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerReliability.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerResources.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'FileText' is defined but never used.","line":12,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":48,"fix":{"range":[607,617],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[606,616],"text":""},"desc":"Remove unused variable 'FileText'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":13,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":26,"fix":{"range":[650,657],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[649,656],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":14,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":39,"fix":{"range":[729,744],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[728,743],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":36,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":21}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  GraduationCap, Tag, BookOpen, Video, FileText, TrendingUp, \n  DollarSign, Star, Award, Sparkles, Link as LinkIcon, Copy, CheckCircle,\n  Shield, Camera, Clock, MessageSquare, Package, Loader2\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n\nexport default function CleanerResources() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [discounts, setDiscounts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [copiedCode, setCopiedCode] = useState(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      // Try to get current user, but don't restrict access if not logged in\n      try {\n        const currentUser = await base44.auth.me();\n        setUser(currentUser);\n      } catch (error) {\n        // User not logged in - that's okay, show public resources\n        setUser(null);\n      }\n\n      setDiscounts([]);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading resources:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const copyCode = (code) => {\n    navigator.clipboard.writeText(code);\n    setCopiedCode(code);\n    setTimeout(() => setCopiedCode(null), 2000);\n  };\n\n  const educationTopics = [\n    {\n      title: 'Maximizing Your Earnings',\n      icon: DollarSign,\n      color: 'emerald',\n      tips: [\n        'Upload product verification photos - cleaners with photos get 34% more bookings',\n        'Maintain a 95%+ on-time rate to reach Pro or Elite tier',\n        'Respond to messages within 2 hours for better client trust',\n        'Upload high-quality before/after photos every job',\n        'Keep your calendar updated to avoid booking conflicts',\n        'Offer recurring booking discounts to build steady income'\n      ]\n    },\n    {\n      title: 'Improving Your Reliability Score',\n      icon: TrendingUp,\n      color: 'blue',\n      tips: [\n        'Check in within 15 minutes of scheduled start time (grace period)',\n        'Upload before/after photos for every job (100% compliance)',\n        'Maintain 4.5+ star average rating',\n        'Keep dispute rate under 5%',\n        'Avoid no-shows and last-minute cancellations',\n        'Respond professionally to any client concerns'\n      ]\n    },\n    {\n      title: 'Getting 5-Star Reviews',\n      icon: Star,\n      color: 'amber',\n      tips: [\n        'Communicate before arrival (text or call)',\n        'Take clear, well-lit before/after photos',\n        'Go the extra mile - fold towels, straighten pillows',\n        'Use quality products that clients notice',\n        'Ask if there are any special requests or concerns',\n        'Follow up after the job to ensure satisfaction'\n      ]\n    },\n    {\n      title: 'Product Selection Guide',\n      icon: Sparkles,\n      color: 'purple',\n      tips: [\n        'Match products to your tier - Developing: standard, Pro: eco/professional, Elite: premium',\n        'Always ask about allergies before using fragranced products',\n        'Invest in microfiber cloths - clients notice the difference',\n        'Keep a backup kit for clients with sensitivities',\n        'Consider eco-friendly options - 68% of clients prefer them',\n        'Use partner discount codes below to save 15-30% on supplies'\n      ]\n    },\n    {\n      title: 'Safety & Professionalism',\n      icon: Shield,\n      color: 'red',\n      tips: [\n        'Always wear closed-toe shoes and bring cleaning gloves',\n        'Keep liability insurance current (required for Pro/Elite)',\n        'Respect client privacy - no photos of personal items',\n        'GPS check-in proves you arrived on time',\n        'If you find damage or issues, photograph and report immediately',\n        'Maintain professional boundaries and communication'\n      ]\n    },\n    {\n      title: 'Photo Best Practices',\n      icon: Camera,\n      color: 'cyan',\n      tips: [\n        'Take photos from the same angle for before/after comparison',\n        'Ensure good lighting - open curtains or turn on lights',\n        'Capture wide shots showing the whole area',\n        'Focus on the most improved areas (kitchen counters, bathroom sinks)',\n        'Avoid photos with client personal items visible',\n        'Upload immediately after finishing each area'\n      ]\n    }\n  ];\n\n  const videoTutorials = [\n    { title: 'Getting Started on PureTask', duration: '5:32', views: '1.2K' },\n    { title: 'Maximizing Your Profile', duration: '8:15', views: '890' },\n    { title: 'Photo Tips for Higher Ratings', duration: '6:47', views: '2.1K' },\n    { title: 'Handling Difficult Situations', duration: '10:23', views: '654' },\n    { title: 'Product Recommendations by Tier', duration: '12:05', views: '1.8K' }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-soft-cloud\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <GraduationCap className=\"w-7 h-7 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Cleaner Resources</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">Education, discounts, and tips to grow your business</p>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Not logged in notice */}\n        {!user && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mb-8\"\n          >\n            <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n              <AlertDescription className=\"flex items-center justify-between font-verdana\">\n                <span>\n                  <strong>Ready to join?</strong> Sign up as a cleaner to access exclusive partner discounts and your personal dashboard.\n                </span>\n                <Button onClick={() => navigate(createPageUrl('RoleSelection'))} className=\"ml-4 brand-gradient text-white rounded-full font-fredoka font-semibold\">\n                  Sign Up\n                </Button>\n              </AlertDescription>\n            </Alert>\n          </motion.div>\n        )}\n\n        {/* Quick Links */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <Card className=\"border-0 shadow-lg bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl\">\n            <CardContent className=\"p-6\">\n              <h3 className=\"font-fredoka font-semibold text-graphite text-lg mb-4\">Quick Access</h3>\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <Button\n                  variant=\"outline\"\n                  className=\"justify-start h-auto py-4 rounded-full font-fredoka border-2\"\n                  onClick={() => navigate(createPageUrl('MaterialsList'))}\n                >\n                  <Package className=\"w-5 h-5 mr-2\" />\n                  <div className=\"text-left\">\n                    <div className=\"font-fredoka font-semibold text-graphite\">Materials List</div>\n                    <div className=\"text-xs text-gray-600 font-verdana\">Recommended supplies & tools</div>\n                  </div>\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"justify-start h-auto py-4 rounded-full font-fredoka border-2\"\n                  onClick={() => navigate(createPageUrl('ReliabilityScoreExplained'))}\n                >\n                  <TrendingUp className=\"w-5 h-5 mr-2\" />\n                  <div className=\"text-left\">\n                    <div className=\"font-fredoka font-semibold text-graphite\">Score Guide</div>\n                    <div className=\"text-xs text-gray-600 font-verdana\">How your score is calculated</div>\n                  </div>\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n\n\n        <Tabs defaultValue=\"discounts\" className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-md p-1 rounded-full\">\n            <TabsTrigger value=\"discounts\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full font-fredoka\">\n              <Tag className=\"w-4 h-4 mr-2\" />\n              Partner Discounts\n            </TabsTrigger>\n            <TabsTrigger value=\"education\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full font-fredoka\">\n              <BookOpen className=\"w-4 h-4 mr-2\" />\n              Education\n            </TabsTrigger>\n            <TabsTrigger value=\"videos\" className=\"data-[state=active]:brand-gradient data-[state=active]:text-white rounded-full font-fredoka\">\n              <Video className=\"w-4 h-4 mr-2\" />\n              Video Tutorials\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Partner Discounts Tab */}\n          <TabsContent value=\"discounts\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n            >\n              <Card className=\"border-0 shadow-xl mb-6 rounded-2xl\">\n                <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50 rounded-t-2xl\">\n                  <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n                    <Tag className=\"w-6 h-6 text-fresh-mint\" />\n                    Exclusive Partner Discounts\n                  </CardTitle>\n                  <p className=\"text-sm text-gray-600 font-verdana mt-2\">\n                    Save 15-30% on professional cleaning supplies with our partner discounts. Use these codes at checkout.\n                  </p>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  {discounts.length > 0 ? (\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      {discounts.map((discount) => (\n                        <Card key={discount.id} className=\"border-2 border-emerald-200 hover:border-emerald-400 transition-all\">\n                          <CardContent className=\"p-6\">\n                            <div className=\"flex items-start justify-between mb-3\">\n                              <div>\n                                <h3 className=\"text-xl font-bold text-slate-900\">{discount.partner_name}</h3>\n                                <Badge className=\"mt-2 bg-emerald-500 text-white\">\n                                  {discount.discount_percentage}% OFF\n                                </Badge>\n                              </div>\n                              <Badge variant=\"outline\" className=\"capitalize\">\n                                {discount.product_category.replace('-', ' ')}\n                              </Badge>\n                            </div>\n                            \n                            <p className=\"text-sm text-slate-600 mb-4\">{discount.description}</p>\n                            \n                            <div className=\"bg-slate-50 p-3 rounded-lg mb-3\">\n                              <p className=\"text-xs text-slate-500 mb-1\">Discount Code:</p>\n                              <div className=\"flex items-center justify-between\">\n                                <code className=\"text-lg font-bold text-emerald-600\">{discount.discount_code}</code>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => copyCode(discount.discount_code)}\n                                  className=\"ml-2\"\n                                >\n                                  {copiedCode === discount.discount_code ? (\n                                    <>\n                                      <CheckCircle className=\"w-4 h-4 mr-1 text-green-500\" />\n                                      Copied!\n                                    </>\n                                  ) : (\n                                    <>\n                                      <Copy className=\"w-4 h-4 mr-1\" />\n                                      Copy\n                                    </>\n                                  )}\n                                </Button>\n                              </div>\n                            </div>\n\n                            {discount.partner_url && (\n                              <a \n                                href={discount.partner_url} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\"\n                                className=\"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700\"\n                              >\n                                <LinkIcon className=\"w-4 h-4\" />\n                                Visit Store\n                              </a>\n                            )}\n\n                            {discount.expiry_date && (\n                              <p className=\"text-xs text-slate-500 mt-3\">\n                                Expires: {new Date(discount.expiry_date).toLocaleDateString()}\n                              </p>\n                            )}\n                          </CardContent>\n                        </Card>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-12\">\n                      <Tag className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n                      <p className=\"text-lg text-slate-600 mb-2\">No active discounts right now</p>\n                      <p className=\"text-sm text-slate-500\">Check back soon for exclusive partner offers!</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* How to Use Discounts */}\n              <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n                <AlertDescription className=\"font-verdana\">\n                  <strong>How to use these discounts:</strong> Click \"Visit Store\", shop for your supplies, and enter the discount code at checkout. These codes are exclusive to PureTask cleaners!\n                </AlertDescription>\n              </Alert>\n            </motion.div>\n          </TabsContent>\n\n          {/* Education Tab */}\n          <TabsContent value=\"education\">\n            <div className=\"space-y-6\">\n              {educationTopics.map((topic, index) => (\n                <motion.div\n                  key={topic.title}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.1 }}\n                >\n                  <Card className=\"border-0 shadow-xl overflow-hidden\">\n                    <div className={`h-2 bg-gradient-to-r from-${topic.color}-400 to-${topic.color}-600`} />\n                    <CardHeader className={`bg-${topic.color}-50`}>\n                      <CardTitle className=\"flex items-center gap-3\">\n                        <div className={`w-10 h-10 bg-${topic.color}-500 rounded-lg flex items-center justify-center`}>\n                          <topic.icon className=\"w-6 h-6 text-white\" />\n                        </div>\n                        {topic.title}\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"p-6\">\n                      <ul className=\"space-y-3\">\n                        {topic.tips.map((tip, tipIndex) => (\n                          <li key={tipIndex} className=\"flex items-start gap-3\">\n                            <CheckCircle className={`w-5 h-5 text-${topic.color}-500 mt-0.5 flex-shrink-0`} />\n                            <span className=\"text-slate-700\">{tip}</span>\n                          </li>\n                        ))}\n                      </ul>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Video Tutorials Tab */}\n          <TabsContent value=\"videos\">\n            <Card className=\"border-0 shadow-xl\">\n              <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Video className=\"w-6 h-6 text-purple-600\" />\n                  Video Tutorials\n                </CardTitle>\n                <p className=\"text-sm text-slate-600 mt-2\">\n                  Learn best practices from top-performing cleaners\n                </p>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-4\">\n                  {videoTutorials.map((video, index) => (\n                    <Card key={index} className=\"border-2 border-slate-200 hover:border-purple-400 transition-all cursor-pointer\">\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-4\">\n                            <div className=\"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center\">\n                              <Video className=\"w-8 h-8 text-white\" />\n                            </div>\n                            <div>\n                              <h3 className=\"font-semibold text-slate-900\">{video.title}</h3>\n                              <div className=\"flex items-center gap-3 mt-1\">\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  <Clock className=\"w-3 h-3 mr-1\" />\n                                  {video.duration}\n                                </Badge>\n                                <span className=\"text-xs text-slate-500\">{video.views} views</span>\n                              </div>\n                            </div>\n                          </div>\n                          <Button variant=\"outline\" size=\"sm\">Watch</Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n\n                <div className=\"mt-6 text-center\">\n                  <p className=\"text-sm text-slate-500\">More tutorials coming soon!</p>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerSchedule.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AIBadge' is defined but never used.","line":6,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":15,"fix":{"range":[236,284],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AIBadge"},"fix":{"range":[243,256],"text":""},"desc":"Remove unused variable 'AIBadge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CalendarIcon' is defined but never used.","line":14,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":27,"fix":{"range":[676,705],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CalendarIcon"},"fix":{"range":[680,705],"text":""},"desc":"Remove unused variable 'CalendarIcon'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":14,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":54,"fix":{"range":[720,732],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[719,731],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":104,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":104,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":125,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":150,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":150,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport AIBadge from '../components/ai/AIBadge';\nimport AITooltip from '../components/ai/AITooltip';\nimport { analytics } from '../components/analytics/AnalyticsService';\nimport BookingRequestExplainer from '../components/booking/BookingRequestExplainer';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Calendar as CalendarIcon, MapPin, Clock, DollarSign, \n  ChevronLeft, ChevronRight, CheckCircle, Circle, Loader2, ArrowRight\n} from 'lucide-react';\nimport { format, addDays, startOfWeek, endOfWeek, startOfMonth, endOfMonth, isSameDay, addMonths, subMonths } from 'date-fns';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst CLEANING_TYPE_COLORS = {\n  basic: { bg: 'bg-blue-500', text: 'text-blue-500', border: 'border-blue-500' },\n  deep: { bg: 'bg-purple-500', text: 'text-purple-500', border: 'border-purple-500' },\n  moveout: { bg: 'bg-orange-500', text: 'text-orange-500', border: 'border-orange-500' }\n};\n\nexport default function CleanerSchedule() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [viewMode, setViewMode] = useState('2weeks');\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [currentMonth, setCurrentMonth] = useState(new Date());\n  const [selectedJobId, setSelectedJobId] = useState(null);\n  const [allJobs, setAllJobs] = useState([]);\n  const [jobsForDate, setJobsForDate] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  useEffect(() => {\n    if (selectedDate && allJobs.length > 0) {\n      const filtered = allJobs.filter(job => {\n        const jobDate = new Date(job.date);\n        return isSameDay(jobDate, selectedDate);\n      });\n      setJobsForDate(filtered);\n      setSelectedJobId(null);\n    }\n  }, [selectedDate, allJobs]);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      if (cleanerProfiles.length === 0) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n\n      const jobs = await base44.entities.Booking.filter({ \n        cleaner_email: currentUser.email,\n        status: { $in: ['awaiting_cleaner_response', 'accepted', 'on_the_way', 'in_progress', 'awaiting_client'] }\n      });\n      setAllJobs(jobs);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAcceptJob = async (jobId) => {\n    try {\n      await base44.entities.Booking.update(jobId, {\n        status: 'accepted',\n        cleaner_confirmed: true\n      });\n      await base44.entities.Event.create({\n        booking_id: jobId,\n        event_type: 'confirmed',\n        user_email: user.email,\n        details: 'Cleaner accepted the job'\n      });\n      \n      // Track analytics\n      analytics.cleaner('job_accepted', { booking_id: jobId });\n      \n      // Trigger booking confirmation automation\n      try {\n        await base44.functions.invoke('sendBookingConfirmation', { booking_id: jobId });\n      } catch (e) {\n        console.log('Confirmation automation failed:', e);\n      }\n      \n      await loadData();\n      setSelectedJobId(null);\n    } catch (error) {\n      alert('Failed to accept job');\n    }\n  };\n\n  const handleDeclineJob = async (jobId) => {\n    try {\n      // Track analytics\n      analytics.cleaner('job_declined', { booking_id: jobId });\n      \n      await base44.entities.Booking.update(jobId, {\n        status: 'cleaner_declined'\n      });\n      await base44.entities.Event.create({\n        booking_id: jobId,\n        event_type: 'cancelled',\n        user_email: user.email,\n        details: 'Cleaner declined the job'\n      });\n      await loadData();\n      setSelectedJobId(null);\n    } catch (error) {\n      alert('Failed to decline job');\n    }\n  };\n\n  const handleOnMyWay = async (jobId) => {\n    try {\n      await base44.entities.Booking.update(jobId, {\n        status: 'on_the_way'\n      });\n      await base44.entities.Event.create({\n        booking_id: jobId,\n        event_type: 'check_in',\n        user_email: user.email,\n        details: 'Cleaner is on the way'\n      });\n      \n      // Trigger on my way automation\n      try {\n        await base44.functions.invoke('sendOnMyWay', { booking_id: jobId, eta_minutes: 15 });\n      } catch (e) {\n        console.log('On my way automation failed:', e);\n      }\n      \n      navigate(createPageUrl(`CleanerJobWorkspace?job_id=${jobId}`));\n    } catch (error) {\n      alert('Failed to update status');\n    }\n  };\n\n  const handleViewJob = (jobId) => {\n    navigate(createPageUrl(`CleanerJobWorkspace?job_id=${jobId}`));\n  };\n\n  const getJobsForDay = (date) => {\n    return allJobs.filter(job => {\n      const jobDate = new Date(job.date);\n      return isSameDay(jobDate, date);\n    });\n  };\n\n  const renderTwoWeekView = () => {\n    const start = startOfWeek(selectedDate);\n    const days = [];\n    for (let i = 0; i < 14; i++) {\n      days.push(addDays(start, i));\n    }\n\n    return (\n      <div className=\"grid grid-cols-7 gap-3\">\n        {days.map((day, idx) => {\n          const dayJobs = getJobsForDay(day);\n          const isSelected = isSameDay(day, selectedDate);\n          const isToday = isSameDay(day, new Date());\n\n          return (\n            <button\n              key={idx}\n              onClick={() => setSelectedDate(day)}\n              className={`p-4 rounded-xl border-2 transition-all ${\n                isSelected \n                  ? 'border-puretask-blue bg-blue-50 shadow-lg scale-105' \n                  : 'border-gray-200 hover:border-gray-300 hover:shadow-md'\n              }`}\n            >\n              <div className=\"text-center\">\n                <p className=\"text-xs font-verdana text-gray-500 mb-1\">\n                  {format(day, 'EEE')}\n                </p>\n                <p className={`text-2xl font-fredoka font-bold mb-2 ${\n                  isToday ? 'text-puretask-blue' : 'text-graphite'\n                }`}>\n                  {format(day, 'd')}\n                </p>\n                <div className=\"flex justify-center gap-1\">\n                  {dayJobs.map((job, jIdx) => {\n                    const colors = CLEANING_TYPE_COLORS[job.cleaning_type] || CLEANING_TYPE_COLORS.basic;\n                    const isRequest = job.status === 'awaiting_cleaner_response';\n                    return isRequest ? (\n                      <Circle key={jIdx} className={`w-2 h-2 ${colors.text}`} />\n                    ) : (\n                      <div key={jIdx} className={`w-2 h-2 rounded-full ${colors.bg}`} />\n                    );\n                  })}\n                </div>\n              </div>\n            </button>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const renderMonthView = () => {\n    const monthStart = startOfMonth(currentMonth);\n    const monthEnd = endOfMonth(currentMonth);\n    const startDate = startOfWeek(monthStart);\n    const endDate = endOfWeek(monthEnd);\n\n    const days = [];\n    let day = startDate;\n    while (day <= endDate) {\n      days.push(day);\n      day = addDays(day, 1);\n    }\n\n    return (\n      <>\n        <div className=\"flex items-center justify-between mb-4\">\n          <Button variant=\"ghost\" onClick={() => setCurrentMonth(subMonths(currentMonth, 1))}>\n            <ChevronLeft className=\"w-5 h-5\" />\n          </Button>\n          <h3 className=\"text-2xl font-fredoka font-bold text-graphite\">\n            {format(currentMonth, 'MMMM yyyy')}\n          </h3>\n          <Button variant=\"ghost\" onClick={() => setCurrentMonth(addMonths(currentMonth, 1))}>\n            <ChevronRight className=\"w-5 h-5\" />\n          </Button>\n        </div>\n        <div className=\"grid grid-cols-7 gap-2\">\n          {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(d => (\n            <div key={d} className=\"text-center font-fredoka font-bold text-gray-500 text-sm py-2\">\n              {d}\n            </div>\n          ))}\n          {days.map((day, idx) => {\n            const dayJobs = getJobsForDay(day);\n            const isSelected = isSameDay(day, selectedDate);\n            const isCurrentMonth = day.getMonth() === currentMonth.getMonth();\n            const isToday = isSameDay(day, new Date());\n\n            return (\n              <button\n                key={idx}\n                onClick={() => setSelectedDate(day)}\n                className={`p-3 rounded-lg border transition-all ${\n                  !isCurrentMonth ? 'opacity-30' : ''\n                } ${\n                  isSelected \n                    ? 'border-puretask-blue bg-blue-50 shadow-md' \n                    : 'border-gray-200 hover:border-gray-300'\n                }`}\n              >\n                <p className={`text-lg font-fredoka mb-1 ${\n                  isToday ? 'text-puretask-blue font-bold' : 'text-graphite'\n                }`}>\n                  {format(day, 'd')}\n                </p>\n                <div className=\"flex justify-center gap-0.5 flex-wrap\">\n                  {dayJobs.slice(0, 3).map((job, jIdx) => {\n                    const colors = CLEANING_TYPE_COLORS[job.cleaning_type] || CLEANING_TYPE_COLORS.basic;\n                    const isRequest = job.status === 'awaiting_cleaner_response';\n                    return isRequest ? (\n                      <Circle key={jIdx} className={`w-1.5 h-1.5 ${colors.text}`} />\n                    ) : (\n                      <div key={jIdx} className={`w-1.5 h-1.5 rounded-full ${colors.bg}`} />\n                    );\n                  })}\n                </div>\n              </button>\n            );\n          })}\n        </div>\n      </>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const requests = jobsForDate.filter(j => j.status === 'awaiting_cleaner_response');\n  const accepted = jobsForDate.filter(j => ['accepted', 'on_the_way', 'in_progress'].includes(j.status));\n  const selectedJob = jobsForDate.find(j => j.id === selectedJobId);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-8\">My Schedule</h1>\n\n        {/* Calendar Panel */}\n        <Card className=\"mb-6 border-2 shadow-lg\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Calendar</CardTitle>\n              <div className=\"flex gap-2\">\n                <Button\n                  variant={viewMode === '2weeks' ? 'default' : 'outline'}\n                  onClick={() => setViewMode('2weeks')}\n                  size=\"sm\"\n                  className=\"font-fredoka\"\n                >\n                  2 Weeks\n                </Button>\n                <Button\n                  variant={viewMode === 'month' ? 'default' : 'outline'}\n                  onClick={() => setViewMode('month')}\n                  size=\"sm\"\n                  className=\"font-fredoka\"\n                >\n                  Month\n                </Button>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {viewMode === '2weeks' ? renderTwoWeekView() : renderMonthView()}\n          </CardContent>\n        </Card>\n\n        {/* Day Summary */}\n        {selectedDate && (\n          <Card className=\"mb-6 border-2 bg-gradient-to-r from-blue-50 to-cyan-50\">\n            <CardContent className=\"p-6\">\n              <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">\n                {format(selectedDate, 'EEEE, MMMM d')}\n              </h2>\n              <p className=\"text-gray-600 font-verdana\">\n                {requests.length} job request{requests.length !== 1 ? 's' : ''} ‚Ä¢ {accepted.length} accepted job{accepted.length !== 1 ? 's' : ''}\n              </p>\n            </CardContent>\n          </Card>\n        )}\n\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          {/* Job Requests */}\n          <div>\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-4\">Job Requests</h3>\n            {requests.length === 0 ? (\n              <Card className=\"border-2\">\n                <CardContent className=\"p-8 text-center text-gray-500 font-verdana\">\n                  No job requests for this day.\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-3\">\n                {requests.map(job => {\n                  const colors = CLEANING_TYPE_COLORS[job.cleaning_type] || CLEANING_TYPE_COLORS.basic;\n                  const estimatedCredits = Math.round((job.snapshot_total_rate_cph || 300) * (job.hours || 2));\n                  \n                  return (\n                    <motion.div\n                      key={job.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                    >\n                      <Card\n                        className={`cursor-pointer border-l-4 ${colors.border} border-2 transition-all hover:shadow-lg ${\n                          selectedJobId === job.id ? 'border-puretask-blue bg-blue-50' : 'border-gray-200'\n                        }`}\n                        onClick={() => setSelectedJobId(job.id)}\n                      >\n                        <CardContent className=\"p-5\">\n                          <div className=\"flex items-start justify-between mb-3\">\n                            <div>\n                              <p className=\"text-2xl font-fredoka font-bold text-graphite mb-1\">\n                                {job.start_time || 'Time TBD'}\n                              </p>\n                              <div className=\"flex items-center gap-2\">\n                                <p className=\"text-base text-gray-700 font-verdana font-semibold\">{job.client_email}</p>\n                                {job.matched_via_smart_algorithm && (\n                                  <AITooltip\n                                    variant=\"recommended\"\n                                    reason=\"AI matched this booking based on your preferences and schedule\"\n                                  />\n                                )}\n                              </div>\n                            </div>\n                            <Badge className={`${colors.bg} text-white text-sm px-3 py-1`}>\n                              {job.cleaning_type}\n                            </Badge>\n                          </div>\n                          <p className=\"text-base text-gray-700 font-verdana mb-3 flex items-center gap-2\">\n                            <MapPin className=\"w-4 h-4\" />\n                            {job.address?.substring(0, 40)}...\n                          </p>\n                          <div className=\"flex items-center justify-between text-base\">\n                            <span className=\"text-gray-700 font-verdana font-semibold flex items-center gap-1\">\n                              <Clock className=\"w-4 h-4\" />\n                              {job.hours || 2} hrs\n                            </span>\n                            <span className=\"font-fredoka font-bold text-fresh-mint text-lg\">~{estimatedCredits} credits</span>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n\n          {/* Accepted Jobs */}\n          <div>\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-4\">Accepted Jobs</h3>\n            {accepted.length === 0 ? (\n              <Card className=\"border-2\">\n                <CardContent className=\"p-8 text-center text-gray-500 font-verdana\">\n                  No accepted jobs for this day.\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-3\">\n                {accepted.map(job => {\n                  const colors = CLEANING_TYPE_COLORS[job.cleaning_type] || CLEANING_TYPE_COLORS.basic;\n                  const estimatedCredits = Math.round((job.snapshot_total_rate_cph || 300) * (job.hours || 2));\n                  \n                  return (\n                    <motion.div\n                      key={job.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                    >\n                      <Card\n                        className={`cursor-pointer border-l-4 ${colors.border} border-2 transition-all hover:shadow-lg ${\n                          selectedJobId === job.id ? 'border-puretask-blue bg-blue-50' : 'border-gray-200'\n                        }`}\n                        onClick={() => setSelectedJobId(job.id)}\n                      >\n                        <CardContent className=\"p-5\">\n                          <div className=\"flex items-start justify-between mb-3\">\n                            <div>\n                              <p className=\"text-2xl font-fredoka font-bold text-graphite mb-1\">\n                                {job.start_time} - {job.start_time ? format(new Date(`2000-01-01 ${job.start_time}`).getTime() + (job.hours || 2) * 3600000, 'HH:mm') : ''}\n                              </p>\n                              <p className=\"text-base text-gray-700 font-verdana font-semibold\">{job.client_email}</p>\n                            </div>\n                            <Badge className={`${colors.bg} text-white text-sm px-3 py-1`}>\n                              {job.cleaning_type}\n                            </Badge>\n                          </div>\n                          <p className=\"text-base text-gray-700 font-verdana mb-3 flex items-center gap-2\">\n                            <MapPin className=\"w-4 h-4\" />\n                            {job.address?.substring(0, 40)}...\n                          </p>\n                          <div className=\"flex items-center justify-between text-base mb-2\">\n                            <span className=\"text-gray-700 font-verdana font-semibold flex items-center gap-1\">\n                              <Clock className=\"w-4 h-4\" />\n                              {job.hours || 2} hrs\n                            </span>\n                            <span className=\"font-fredoka font-bold text-fresh-mint text-lg\">~{estimatedCredits} credits</span>\n                          </div>\n                          <Badge variant=\"outline\" className=\"mt-1\">{job.status.replace('_', ' ')}</Badge>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Job Summary Card */}\n        <AnimatePresence>\n          {selectedJob && (\n            <motion.div\n              initial={{ opacity: 0, y: 50 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: 50 }}\n              className=\"fixed bottom-0 left-0 right-0 p-6 bg-white border-t-4 border-puretask-blue shadow-2xl z-40\"\n            >\n              <div className=\"max-w-7xl mx-auto\">\n                <BookingRequestExplainer booking={selectedJob} />\n                <div className=\"flex items-start justify-between mb-4\">\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">\n                      {selectedJob.client_email}\n                    </h3>\n                    <p className=\"text-gray-600 font-verdana mb-2 flex items-center gap-2\">\n                      <MapPin className=\"w-4 h-4\" />\n                      {selectedJob.address}\n                    </p>\n                    <div className=\"flex items-center gap-3 flex-wrap\">\n                      <Badge className={`${CLEANING_TYPE_COLORS[selectedJob.cleaning_type]?.bg} text-white`}>\n                        {selectedJob.cleaning_type}\n                      </Badge>\n                      <span className=\"text-sm font-verdana text-gray-600\">\n                        <Clock className=\"w-4 h-4 inline mr-1\" />\n                        {selectedJob.start_time || 'Time TBD'}\n                      </span>\n                      <span className=\"text-sm font-verdana text-gray-600\">\n                        {selectedJob.hours || 2} hours recommended\n                      </span>\n                      <span className=\"font-fredoka font-bold text-fresh-mint\">\n                        ~{Math.round((selectedJob.snapshot_total_rate_cph || 300) * (selectedJob.hours || 2))} credits\n                      </span>\n                      <Badge variant=\"outline\">{selectedJob.status.replace('_', ' ')}</Badge>\n                    </div>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    onClick={() => setSelectedJobId(null)}\n                    className=\"text-gray-500 hover:text-graphite\"\n                  >\n                    ‚úï\n                  </Button>\n                </div>\n\n                <div className=\"flex gap-3\">\n                  {selectedJob.status === 'awaiting_cleaner_response' && (\n                    <>\n                      <Button\n                        onClick={() => handleAcceptJob(selectedJob.id)}\n                        className=\"flex-1 bg-fresh-mint hover:bg-green-600 text-white font-fredoka font-bold\"\n                      >\n                        <CheckCircle className=\"w-5 h-5 mr-2\" />\n                        Accept Job\n                      </Button>\n                      <Button\n                        onClick={() => handleDeclineJob(selectedJob.id)}\n                        variant=\"outline\"\n                        className=\"flex-1 font-fredoka border-red-300 text-red-600 hover:bg-red-50\"\n                      >\n                        Decline\n                      </Button>\n                    </>\n                  )}\n\n                  {selectedJob.status === 'accepted' && (\n                    <>\n                      <Button\n                        onClick={() => handleOnMyWay(selectedJob.id)}\n                        className=\"flex-1 brand-gradient text-white font-fredoka font-bold\"\n                      >\n                        <ArrowRight className=\"w-5 h-5 mr-2\" />\n                        On My Way\n                      </Button>\n                      <Button\n                        onClick={() => handleViewJob(selectedJob.id)}\n                        variant=\"outline\"\n                        className=\"flex-1 font-fredoka\"\n                      >\n                        View Job\n                      </Button>\n                    </>\n                  )}\n\n                  {['on_the_way', 'in_progress'].includes(selectedJob.status) && (\n                    <Button\n                      onClick={() => handleViewJob(selectedJob.id)}\n                      className=\"flex-1 brand-gradient text-white font-fredoka font-bold\"\n                    >\n                      Continue Job\n                      <ArrowRight className=\"w-5 h-5 ml-2\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\CleanerSignup.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":37,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Sparkles, Shield, Award, DollarSign, Loader2, Mail, HelpCircle } from 'lucide-react';\nimport EarningsCalculator from '../components/cleaner/EarningsCalculator';\nimport { useAnalytics } from '../components/analytics/AnalyticsTracker';\nimport { analytics } from '../components/analytics/AnalyticsService'; // Added import\n\nexport default function CleanerSignup() {\n  const navigate = useNavigate();\n  const { trackEvent } = useAnalytics();\n  const [loading, setLoading] = useState(false);\n  const [checking, setChecking] = useState(true);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    // Changed analytics call from trackEvent to analytics.auth\n    analytics.auth('cleaner_signup_start');\n    \n    checkIfLoggedIn();\n  }, []);\n\n  const checkIfLoggedIn = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser) {\n        trackEvent('cleaner_signup_already_logged_in', {\n          user_email: currentUser.email\n        });\n        navigate(createPageUrl('CleanerOnboarding'));\n        return;\n      }\n    } catch (error) {\n      // User not logged in\n    }\n    setChecking(false);\n  };\n\n  const handleSignup = () => {\n    setLoading(true);\n    setError('');\n    \n    trackEvent('cleaner_signup_button_clicked', {\n      action: 'redirect_to_login'\n    });\n    \n    // Redirect using base44.auth.redirectToLogin with full URL\n    const nextUrl = window.location.origin + createPageUrl('CleanerOnboarding');\n    base44.auth.redirectToLogin(nextUrl);\n  };\n\n  // The outline indicated changes to a 'handleSignupSubmit' function which is not present in this file.\n  // The existing `handleSignup` function primarily handles redirecting for external login,\n  // and does not process form data like `email` or `service_areas` directly within this component.\n  // Therefore, the suggested analytics.auth('cleaner_signup_success', { email: formData.email, service_areas: formData.service_locations?.length || 0 });\n  // cannot be accurately placed here without significant logical changes to the component's flow,\n  // which would go beyond simply implementing the outline. This kind of tracking typically\n  // occurs after a successful form submission on the subsequent onboarding page.\n\n  if (checking) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-cyan-50 flex items-center justify-center p-6\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500 mx-auto mb-4\" />\n          <p className=\"text-lg text-slate-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-cyan-50 p-6\">\n      <div className=\"max-w-6xl mx-auto\">\n        <div className=\"grid lg:grid-cols-2 gap-8\">\n          {/* Left Column - Signup */}\n          <Card className=\"p-10 shadow-2xl border-0\">\n            <div className=\"text-center mb-8\">\n              <div className=\"w-16 h-16 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg\">\n                <Sparkles className=\"w-8 h-8 text-white\" />\n              </div>\n              <h1 className=\"text-3xl font-bold text-slate-900 mb-2\">Become a PureTask Cleaner</h1>\n              <p className=\"text-slate-600\">Join our verified marketplace</p>\n            </div>\n\n            {error && (\n              <Alert variant=\"destructive\" className=\"mb-6\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"space-y-4 mb-8\">\n              <div className=\"flex items-start gap-3 p-4 bg-emerald-50 rounded-lg\">\n                <Shield className=\"w-5 h-5 text-emerald-600 mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"font-semibold text-slate-900\">Verification Required</p>\n                  <p className=\"text-sm text-slate-600\">ID verification and background check</p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-3 p-4 bg-blue-50 rounded-lg\">\n                <DollarSign className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"font-semibold text-slate-900\">Set Your Own Rates</p>\n                  <p className=\"text-sm text-slate-600\">Full control over pricing</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-3 p-4 bg-amber-50 rounded-lg\">\n                <Award className=\"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"font-semibold text-slate-900\">Build Your Reputation</p>\n                  <p className=\"text-sm text-slate-600\">Earn Elite tier status</p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6\">\n              <div className=\"flex items-start gap-3\">\n                <Mail className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm text-slate-700\">\n                  <p className=\"font-semibold mb-1\">Sign-Up Process:</p>\n                  <ol className=\"list-decimal list-inside space-y-1\">\n                    <li>Click \"Continue with Google\" below</li>\n                    <li>Sign in with your Google account</li>\n                    <li>Check your email for confirmation (if needed)</li>\n                    <li>Complete your cleaner profile and verification</li>\n                  </ol>\n                </div>\n              </div>\n            </div>\n\n            <Button\n              className=\"w-full bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white text-lg py-6 shadow-lg\"\n              onClick={handleSignup}\n              disabled={loading}\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Redirecting...\n                </>\n              ) : (\n                'Continue with Google'\n              )}\n            </Button>\n\n            <div className=\"mt-6 text-center space-y-3\">\n              <p className=\"text-sm text-slate-600\">\n                Already have an account?{' '}\n                <button\n                  onClick={handleSignup}\n                  className=\"text-emerald-600 hover:text-emerald-700 font-medium\"\n                >\n                  Sign In\n                </button>\n              </p>\n              <div className=\"flex items-center justify-center gap-2 text-sm\">\n                <HelpCircle className=\"w-4 h-4 text-slate-400\" />\n                <Link to={createPageUrl('ResendConfirmation')} className=\"text-emerald-600 hover:text-emerald-700\">\n                  Didn't receive confirmation email?\n                </Link>\n              </div>\n            </div>\n          </Card>\n\n          {/* Right Column - Earnings Calculator */}\n          <div>\n            <EarningsCalculator />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientBookings.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":7,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":39,"fix":{"range":[344,356],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[343,355],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":7,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":50,"fix":{"range":[355,366],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[355,366],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[406,413],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[407,413],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":8,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[412,430],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[412,430],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[991,995],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Calendar, Clock, Loader2, DollarSign } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { toast } from 'sonner';\nimport ClientBookingCard from '../components/booking/ClientBookingCard';\n\nexport default function ClientBookings() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('upcoming');\n  const [showTipDialog, setShowTipDialog] = useState(false);\n  const [currentBookingForTip, setCurrentBookingForTip] = useState(null);\n  const [tipAmount, setTipAmount] = useState('');\n  const [tipProcessing, setTipProcessing] = useState(false);\n\n  useEffect(() => {\n    loadUserAndBookings();\n  }, []);\n\n  const loadUserAndBookings = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('SignIn'));\n        return;\n      }\n      setUser(currentUser);\n\n      const allBookings = await base44.entities.Booking.filter({\n        client_email: currentUser.email\n      });\n\n      // Sort by date descending\n      allBookings.sort((a, b) => {\n        const dateA = new Date(`${a.date}T${a.start_time}`);\n        const dateB = new Date(`${b.date}T${b.start_time}`);\n        return dateB - dateA;\n      });\n\n      setBookings(allBookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading bookings:', showToast: false });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const categorizeBookings = () => {\n    const now = new Date();\n    const upcoming = [];\n    const past = [];\n    const cancelled = [];\n\n    bookings.forEach(booking => {\n      const bookingDateTime = new Date(`${booking.date}T${booking.start_time}`);\n      \n      if (booking.status === 'cancelled') {\n        cancelled.push(booking);\n      } else if (bookingDateTime > now && !['completed', 'approved'].includes(booking.status)) {\n        upcoming.push(booking);\n      } else {\n        past.push(booking);\n      }\n    });\n\n    return { upcoming, past, cancelled };\n  };\n\n  const { upcoming, past, cancelled } = categorizeBookings();\n\n  const handleTipSubmit = async () => {\n    if (!tipAmount || parseFloat(tipAmount) <= 0) {\n      toast.error(\"Please enter a valid tip amount.\");\n      return;\n    }\n\n    setTipProcessing(true);\n    try {\n      const response = await base44.functions.invoke('processTip', {\n        booking_id: currentBookingForTip.id,\n        cleaner_email: currentBookingForTip.cleaner_email,\n        amount: parseFloat(tipAmount)\n      });\n\n      if (response.data.success) {\n        toast.success(`Successfully sent $${parseFloat(tipAmount).toFixed(2)} tip!`);\n        setShowTipDialog(false);\n        setTipAmount('');\n        setCurrentBookingForTip(null);\n      } else {\n        toast.error(response.data.error || 'Failed to send tip');\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error sending tip:', showToast: false });\n      toast.error('An error occurred while sending the tip.');\n    } finally {\n      setTipProcessing(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue mx-auto mb-4\" />\n          <p className=\"text-graphite font-verdana\">Loading your bookings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud py-8\">\n      <div className=\"container mx-auto px-4 max-w-6xl\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n            My Bookings\n          </h1>\n          <p className=\"text-gray-600 font-verdana\">\n            Manage your cleaning appointments\n          </p>\n        </div>\n\n        {/* Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3 mb-8\">\n            <TabsTrigger value=\"upcoming\" className=\"font-fredoka font-semibold\">\n              <Calendar className=\"w-4 h-4 mr-2\" />\n              Upcoming ({upcoming.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"past\" className=\"font-fredoka font-semibold\">\n              <Clock className=\"w-4 h-4 mr-2\" />\n              Past ({past.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"cancelled\" className=\"font-fredoka font-semibold\">\n              Cancelled ({cancelled.length})\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Upcoming Bookings */}\n          <TabsContent value=\"upcoming\">\n            {upcoming.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <Calendar className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">\n                    No Upcoming Bookings\n                  </h3>\n                  <p className=\"text-gray-600 font-verdana mb-6\">\n                    You don't have any scheduled cleanings yet.\n                  </p>\n                  <button\n                    onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n                    className=\"btn-primary\"\n                  >\n                    Browse Cleaners\n                  </button>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                {upcoming.map(booking => (\n                  <ClientBookingCard\n                    key={booking.id}\n                    booking={booking}\n                    onUpdate={loadUserAndBookings}\n                    showActions={true}\n                  />\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Past Bookings */}\n          <TabsContent value=\"past\">\n            {past.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <Clock className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                  <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">\n                    No Past Bookings\n                  </h3>\n                  <p className=\"text-gray-600 font-verdana\">\n                    Your completed bookings will appear here.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                {past.map(booking => (\n                  <div key={booking.id}>\n                    <ClientBookingCard\n                      booking={booking}\n                      onUpdate={loadUserAndBookings}\n                      showActions={false}\n                    />\n                    {booking.status === 'completed' || booking.status === 'approved' ? (\n                      <Button\n                        variant=\"outline\"\n                        className=\"w-full mt-2 border-2 border-green-500 text-green-600 hover:bg-green-50 font-fredoka font-semibold\"\n                        onClick={() => {\n                          setCurrentBookingForTip(booking);\n                          setShowTipDialog(true);\n                        }}\n                      >\n                        <DollarSign className=\"w-4 h-4 mr-2\" />\n                        Leave a Tip\n                      </Button>\n                    ) : null}\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Cancelled Bookings */}\n          <TabsContent value=\"cancelled\">\n            {cancelled.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">\n                    No Cancelled Bookings\n                  </h3>\n                  <p className=\"text-gray-600 font-verdana\">\n                    You haven't cancelled any bookings.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                {cancelled.map(booking => (\n                  <ClientBookingCard\n                    key={booking.id}\n                    booking={booking}\n                    onUpdate={loadUserAndBookings}\n                    showActions={false}\n                  />\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n\n        {/* Tip Dialog */}\n        <Dialog open={showTipDialog} onOpenChange={setShowTipDialog}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka text-2xl\">Leave a Tip üí∞</DialogTitle>\n              <DialogDescription className=\"font-verdana\">\n                Show your appreciation for excellent service!\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"grid gap-4 py-4\">\n              <div className=\"grid gap-2\">\n                <Label htmlFor=\"tipAmount\" className=\"font-fredoka font-semibold\">\n                  Tip Amount ($)\n                </Label>\n                <Input\n                  id=\"tipAmount\"\n                  type=\"number\"\n                  value={tipAmount}\n                  onChange={(e) => setTipAmount(e.target.value)}\n                  placeholder=\"Enter amount\"\n                  min=\"0.01\"\n                  step=\"0.01\"\n                  className=\"text-lg\"\n                />\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => setTipAmount('5')}\n                >\n                  $5\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => setTipAmount('10')}\n                >\n                  $10\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => setTipAmount('15')}\n                >\n                  $15\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => setTipAmount('20')}\n                >\n                  $20\n                </Button>\n              </div>\n            </div>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setShowTipDialog(false)}>\n                Cancel\n              </Button>\n              <Button \n                onClick={handleTipSubmit} \n                disabled={tipProcessing}\n                className=\"bg-green-600 hover:bg-green-700 text-white\"\n              >\n                {tipProcessing ? 'Processing...' : 'Send Tip'}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Wallet' is defined but never used.","line":10,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":45,"fix":{"range":[459,467],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Wallet"},"fix":{"range":[458,466],"text":""},"desc":"Remove unused variable 'Wallet'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":10,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":52,"fix":{"range":[467,474],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[466,473],"text":""},"desc":"Remove unused variable 'Users'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Gift' is defined but never used.","line":10,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":58,"fix":{"range":[474,480],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Gift"},"fix":{"range":[473,479],"text":""},"desc":"Remove unused variable 'Gift'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":11,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":43,"fix":{"range":[512,524],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[511,523],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ChevronRight' is defined but never used.","line":11,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":67,"fix":{"range":[534,548],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ChevronRight"},"fix":{"range":[533,547],"text":""},"desc":"Remove unused variable 'ChevronRight'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":12,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":36,"fix":{"range":[579,585],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[578,584],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isPast' is defined but never used.","line":17,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":24,"fix":{"range":[767,775],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isPast"},"fix":{"range":[766,774],"text":""},"desc":"Remove unused variable 'isPast'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'isFuture' is defined but never used.","line":17,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":34,"fix":{"range":[775,785],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"isFuture"},"fix":{"range":[774,784],"text":""},"desc":"Remove unused variable 'isFuture'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'LiveBookingStatus' is defined but never used.","line":18,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":25,"fix":{"range":[872,944],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"LiveBookingStatus"},"fix":{"range":[879,902],"text":""},"desc":"Remove unused variable 'LiveBookingStatus'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setShowFloatingButton' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":38,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":51,"suggestions":[{"messageId":"removeVar","data":{"varName":"setShowFloatingButton"},"fix":{"range":[2031,2054],"text":""},"desc":"Remove unused variable 'setShowFloatingButton'."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":9,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Calendar, Heart, RefreshCw, Search, Wallet, Users, Gift,\n  History, MessageSquare, Star, TrendingUp, Sparkles, ChevronRight,\n  Loader2, Clock, CheckCircle, Home, Droplets, Wind, Package,\n  MapPin, ArrowRight, Zap, HelpCircle, Settings, Plus, Repeat,\n  Timer, User\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format, isPast, isFuture, parseISO, differenceInHours, differenceInMinutes, differenceInDays } from 'date-fns';\nimport LiveBookingStatus from '@/components/booking/LiveBookingStatus';\nimport CreditWallet from '@/components/credits/CreditWallet';\nimport { convertTo12Hour } from '@/components/utils/timeUtils';\nimport FAQChatbot from '@/components/chat/FAQChatbot';\nimport SmartMatchExplainer from '../components/matching/SmartMatchExplainer';\nimport MembershipExplainer from '../components/membership/MembershipExplainer';\nimport LoyaltyExplainer from '../components/loyalty/LoyaltyExplainer';\n\nexport default function ClientDashboard() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [upcomingBookings, setUpcomingBookings] = useState([]);\n  const [recentBookings, setRecentBookings] = useState([]);\n  const [favoriteCount, setFavoriteCount] = useState(0);\n  const [recurringCount, setRecurringCount] = useState(0);\n  const [unreadMessages, setUnreadMessages] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [cleanerProfiles, setCleanerProfiles] = useState({});\n  const [bookingReviews, setBookingReviews] = useState({});\n  const [showFloatingButton, setShowFloatingButton] = useState(true);\n\n  useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const loadDashboardData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'client') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load client profile\n      const profiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n      if (profiles.length > 0) {\n        setClientProfile(profiles[0]);\n        \n        // If onboarding not completed, redirect to onboarding\n        if (!profiles[0].onboarding_completed) {\n          navigate(createPageUrl('ClientOnboarding'));\n          return;\n        }\n      } else {\n        // No profile exists, redirect to onboarding\n        navigate(createPageUrl('ClientOnboarding'));\n        return;\n      }\n\n      // Load bookings\n      const allBookings = await base44.entities.Booking.filter(\n        { client_email: currentUser.email },\n        '-date'\n      );\n\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      const upcoming = allBookings.filter(b => {\n        if (!b.date) return false;\n        const bookingDate = new Date(b.date);\n        bookingDate.setHours(0, 0, 0, 0);\n        const isUpcoming = bookingDate >= today;\n        const isValidStatus = ['created', 'payment_hold', 'awaiting_cleaner_response', 'accepted', 'scheduled', 'on_the_way', 'in_progress'].includes(b.status);\n        return isUpcoming && isValidStatus;\n      });\n      const recent = allBookings.filter(b => \n        ['completed', 'approved'].includes(b.status)\n      ).slice(0, 3);\n\n      setUpcomingBookings(upcoming);\n      setRecentBookings(recent);\n\n      // Load favorites count\n      const favorites = await base44.entities.FavoriteCleaner.filter({ client_email: currentUser.email });\n      setFavoriteCount(favorites.length);\n\n      // Load recurring count\n      const recurring = await base44.entities.RecurringBooking.filter({ \n        client_email: currentUser.email,\n        is_active: true \n      });\n      setRecurringCount(recurring.length);\n\n      // Load unread messages\n      const threads = await base44.entities.ConversationThread.filter({\n        participants: { $in: [currentUser.email] }\n      });\n      const unread = threads.reduce((sum, t) => sum + (t.unread_count_client || 0), 0);\n      setUnreadMessages(unread);\n\n      // Load cleaner profiles for upcoming bookings\n      const cleanerEmails = [...new Set(upcoming.map(b => b.cleaner_email).filter(Boolean))];\n      const cleanerProfilesMap = {};\n      for (const email of cleanerEmails) {\n        const cleanerProfs = await base44.entities.CleanerProfile.filter({ user_email: email });\n        if (cleanerProfs.length > 0) {\n          cleanerProfilesMap[email] = cleanerProfs[0];\n        }\n      }\n      setCleanerProfiles(cleanerProfilesMap);\n\n      // Load reviews for recent bookings\n      const reviews = {};\n      for (const booking of recent) {\n        const bookingReviews = await base44.entities.Review.filter({ booking_id: booking.id });\n        if (bookingReviews.length > 0) {\n          reviews[booking.id] = bookingReviews[0];\n        }\n      }\n      setBookingReviews(reviews);\n\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading dashboard:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const nextBooking = upcomingBookings.length > 0 ? upcomingBookings[0] : null;\n  const nextCleaner = nextBooking?.cleaner_email ? cleanerProfiles[nextBooking.cleaner_email] : null;\n\n  const getCleaningIcon = (type) => {\n    switch(type) {\n      case 'deep': return <Droplets className=\"w-5 h-5\" />;\n      case 'moveout': return <Package className=\"w-5 h-5\" />;\n      default: return <Wind className=\"w-5 h-5\" />;\n    }\n  };\n\n  const getStatusProgress = (status) => {\n    const statusMap = {\n      'created': 10,\n      'payment_hold': 20,\n      'awaiting_cleaner_response': 30,\n      'accepted': 50,\n      'scheduled': 60,\n      'on_the_way': 80,\n      'in_progress': 90,\n      'completed': 100\n    };\n    return statusMap[status] || 0;\n  };\n\n  const getStatusColor = (status) => {\n    if (['on_the_way', 'in_progress'].includes(status)) return 'bg-green-500';\n    if (['accepted', 'scheduled'].includes(status)) return 'bg-blue-500';\n    return 'bg-gray-400';\n  };\n\n  const getCountdownText = (booking) => {\n    if (!booking) return null;\n    const bookingDateTime = new Date(`${booking.date}T${booking.start_time}`);\n    const now = new Date();\n    \n    const days = differenceInDays(bookingDateTime, now);\n    const hours = differenceInHours(bookingDateTime, now);\n    const minutes = differenceInMinutes(bookingDateTime, now);\n    \n    if (days > 0) return `${days} day${days > 1 ? 's' : ''}`;\n    if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''}`;\n    if (minutes > 0) return `${minutes} min`;\n    return 'Starting soon';\n  };\n\n  const handleBookAgain = (booking) => {\n    // Save booking details to draft for quick rebooking\n    localStorage.setItem('quickRebookDraft', JSON.stringify({\n      cleaner_email: booking.cleaner_email,\n      hours: booking.hours,\n      cleaning_type: booking.cleaning_type,\n      address: booking.address,\n      bedrooms: booking.bedrooms,\n      bathrooms: booking.bathrooms\n    }));\n    navigate(createPageUrl('BrowseCleaners'));\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-soft-cloud via-blue-50/30 to-soft-cloud p-4 md:p-6 lg:p-8\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Enhanced Header */}\n        <motion.div \n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8 relative overflow-hidden rounded-3xl bg-gradient-to-r from-white to-blue-50/50 p-8 shadow-lg border border-blue-100\"\n        >\n          <div className=\"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-puretask-blue/10 to-transparent rounded-full blur-3xl\"></div>\n          <div className=\"relative z-10\">\n            <div className=\"flex items-center gap-3 mb-2\">\n              <motion.div\n                animate={{ rotate: [0, 10, -10, 0] }}\n                transition={{ repeat: Infinity, duration: 3, ease: \"easeInOut\" }}\n              >\n                <Sparkles className=\"w-8 h-8 text-puretask-blue\" />\n              </motion.div>\n              <h1 className=\"text-4xl md:text-5xl font-fredoka font-bold text-graphite\">\n                Welcome back, {user?.full_name?.split(' ')[0] || 'there'}!\n              </h1>\n            </div>\n            <p className=\"text-gray-600 font-verdana text-lg\">Your home's cleanliness, managed effortlessly</p>\n          </div>\n        </motion.div>\n\n        {/* Next Cleaning - Enhanced Hero Section */}\n        {nextBooking ? (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ duration: 0.3 }}\n          >\n            <Card className=\"mb-6 border-0 shadow-2xl rounded-3xl overflow-hidden\">\n              <div className=\"relative bg-gradient-to-br from-puretask-blue via-blue-500 to-cyan-500 p-8 text-white\">\n                <div className=\"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl\"></div>\n                <div className=\"relative z-10\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"bg-white/20 p-3 rounded-2xl backdrop-blur-sm\">\n                        {getCleaningIcon(nextBooking.cleaning_type)}\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-fredoka font-semibold uppercase tracking-wide opacity-90\">Next Cleaning</p>\n                        <p className=\"text-xs opacity-75 font-verdana capitalize\">{nextBooking.cleaning_type || 'basic'} clean</p>\n                      </div>\n                    </div>\n                    <Badge className=\"bg-white/20 text-white border-0 rounded-full font-fredoka px-4 py-1.5 backdrop-blur-sm\">\n                      {nextBooking.status.replace('_', ' ')}\n                    </Badge>\n                  </div>\n                  \n                  <div className=\"flex items-center justify-between mb-6\">\n                   <h2 className=\"text-4xl font-fredoka font-bold\">\n                     {format(parseISO(nextBooking.date), 'EEEE, MMMM d')}\n                   </h2>\n                   <div className=\"bg-white/20 backdrop-blur-sm rounded-2xl px-4 py-2 flex items-center gap-2\">\n                     <Timer className=\"w-5 h-5\" />\n                     <div>\n                       <p className=\"text-xs opacity-75 font-verdana\">in</p>\n                       <p className=\"text-lg font-fredoka font-bold\">{getCountdownText(nextBooking)}</p>\n                     </div>\n                   </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-6 mb-6\">\n                    <div className=\"bg-white/10 rounded-2xl p-4 backdrop-blur-sm\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Clock className=\"w-4 h-4 opacity-80\" />\n                        <p className=\"text-sm opacity-80 font-verdana\">Time</p>\n                      </div>\n                      <p className=\"text-2xl font-fredoka font-bold\">{convertTo12Hour(nextBooking.start_time)}</p>\n                    </div>\n                    <div className=\"bg-white/10 rounded-2xl p-4 backdrop-blur-sm\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Zap className=\"w-4 h-4 opacity-80\" />\n                        <p className=\"text-sm opacity-80 font-verdana\">Duration</p>\n                      </div>\n                      <p className=\"text-2xl font-fredoka font-bold\">{nextBooking.hours} hours</p>\n                    </div>\n                  </div>\n\n                  {/* Progress Bar */}\n                  <div className=\"mb-4\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <p className=\"text-sm font-verdana opacity-90\">Booking Progress</p>\n                      <p className=\"text-sm font-fredoka font-bold\">{getStatusProgress(nextBooking.status)}%</p>\n                    </div>\n                    <div className=\"h-2 bg-white/20 rounded-full overflow-hidden backdrop-blur-sm\">\n                      <motion.div \n                        initial={{ width: 0 }}\n                        animate={{ width: `${getStatusProgress(nextBooking.status)}%` }}\n                        transition={{ duration: 1, ease: \"easeOut\" }}\n                        className={`h-full ${getStatusColor(nextBooking.status)} rounded-full`}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <CardContent className=\"p-6 bg-gradient-to-br from-white to-blue-50/30\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-start gap-4 p-4 bg-white rounded-2xl shadow-sm border border-gray-100\">\n                    <div className=\"bg-blue-50 p-3 rounded-xl\">\n                      <MapPin className=\"w-5 h-5 text-puretask-blue\" />\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-xs text-gray-500 font-verdana uppercase mb-1\">Address</p>\n                      <p className=\"text-sm font-verdana text-graphite font-medium\">{nextBooking.address}</p>\n                    </div>\n                  </div>\n\n                  {nextCleaner && (\n                    <div className=\"flex items-center gap-4 p-4 bg-white rounded-2xl shadow-sm border border-gray-100\">\n                      <div className=\"relative\">\n                        {nextCleaner.profile_photo_url ? (\n                          <img \n                            src={nextCleaner.profile_photo_url} \n                            alt={nextCleaner.full_name}\n                            className=\"w-14 h-14 rounded-full object-cover border-2 border-puretask-blue\"\n                          />\n                        ) : (\n                          <div className=\"w-14 h-14 rounded-full bg-gradient-to-br from-puretask-blue to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold text-xl border-2 border-white shadow-lg\">\n                            {nextCleaner.full_name?.charAt(0) || 'C'}\n                          </div>\n                        )}\n                        {nextCleaner.admin_verified && (\n                          <div className=\"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1 border-2 border-white\">\n                            <CheckCircle className=\"w-3 h-3 text-white\" />\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-xs text-gray-500 font-verdana uppercase mb-1\">Your Cleaner</p>\n                        <p className=\"text-base font-fredoka font-bold text-graphite\">{nextCleaner.full_name || nextCleaner.user_email}</p>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Star className=\"w-4 h-4 text-yellow-500 fill-current\" />\n                          <span className=\"text-sm font-verdana text-gray-600\">{nextCleaner.average_rating?.toFixed(1) || '5.0'}</span>\n                          <span className=\"text-xs text-gray-400\">‚Ä¢</span>\n                          <Badge className=\"bg-blue-50 text-puretask-blue text-xs font-fredoka border-0\">{nextCleaner.tier || 'Pro'}</Badge>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex gap-3 mt-6\">\n                  <Button\n                    onClick={() => navigate(createPageUrl(`BookingHistory?id=${nextBooking.id}`))}\n                    className=\"flex-1 brand-gradient text-white rounded-2xl font-fredoka font-semibold h-12 shadow-lg hover:shadow-xl transition-all\"\n                  >\n                    View Full Details\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\n                  </Button>\n                  <Button\n                    onClick={() => navigate(createPageUrl('Inbox'))}\n                    variant=\"outline\"\n                    className=\"rounded-2xl font-fredoka font-semibold h-12 px-6 border-2 hover:bg-blue-50\"\n                  >\n                    <MessageSquare className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        ) : (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n          >\n            <Card className=\"mb-6 border-0 shadow-2xl rounded-3xl overflow-hidden\">\n              <div className=\"bg-gradient-to-br from-gray-50 via-blue-50/30 to-gray-50 p-16 text-center relative overflow-hidden\">\n                <div className=\"absolute inset-0 bg-gradient-to-r from-puretask-blue/5 to-cyan-500/5\"></div>\n                <motion.div\n                  animate={{ y: [0, -10, 0] }}\n                  transition={{ repeat: Infinity, duration: 3, ease: \"easeInOut\" }}\n                  className=\"relative z-10\"\n                >\n                  <Calendar className=\"w-20 h-20 text-puretask-blue mx-auto mb-6 opacity-80\" />\n                </motion.div>\n                <h3 className=\"text-3xl font-fredoka font-bold text-graphite mb-3 relative z-10\">No Upcoming Cleanings</h3>\n                <p className=\"text-gray-600 font-verdana text-lg mb-8 relative z-10\">Ready for a fresh, sparkling clean space?</p>\n                <Button\n                  onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n                  className=\"brand-gradient text-white rounded-2xl font-fredoka font-semibold px-10 h-14 text-lg shadow-xl hover:shadow-2xl transition-all relative z-10\"\n                >\n                  <Search className=\"w-5 h-5 mr-3\" />\n                  Book Your First Cleaning\n                  <Sparkles className=\"w-5 h-5 ml-3\" />\n                </Button>\n              </div>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Explainers Row */}\n        <div className=\"grid md:grid-cols-3 gap-4 mb-6\">\n          <SmartMatchExplainer />\n          <MembershipExplainer />\n          <LoyaltyExplainer />\n        </div>\n\n        {/* Credits & Enhanced Quick Actions */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\n          <CreditWallet clientProfile={clientProfile} onUpdate={loadDashboardData} />\n          \n          <Card className=\"border-0 shadow-lg rounded-3xl bg-gradient-to-br from-white to-blue-50/20\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite text-xl flex items-center gap-2\">\n                <Zap className=\"w-5 h-5 text-puretask-blue\" />\n                Quick Actions\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                <Button\n                  onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n                  className=\"w-full justify-between brand-gradient text-white rounded-2xl font-fredoka font-semibold h-14 shadow-lg hover:shadow-xl transition-all group\"\n                >\n                  <div className=\"flex items-center\">\n                    <div className=\"bg-white/20 p-2 rounded-xl mr-3\">\n                      <Search className=\"w-5 h-5\" />\n                    </div>\n                    <span>Book Single Cleaning</span>\n                  </div>\n                  <ArrowRight className=\"w-5 h-5 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </motion.div>\n              \n              <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                <Button\n                  onClick={() => navigate(createPageUrl('MultiBooking'))}\n                  variant=\"outline\"\n                  className=\"w-full justify-between rounded-2xl font-fredoka font-semibold h-14 border-2 hover:bg-blue-50 hover:border-puretask-blue transition-all group\"\n                >\n                  <div className=\"flex items-center\">\n                    <div className=\"bg-blue-50 p-2 rounded-xl mr-3\">\n                      <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n                    </div>\n                    <span>Book Multiple Dates</span>\n                  </div>\n                  <ArrowRight className=\"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </motion.div>\n              \n              <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                <Button\n                  onClick={() => navigate(createPageUrl('BookingHistory'))}\n                  variant=\"outline\"\n                  className=\"w-full justify-between rounded-2xl font-fredoka font-semibold h-14 border-2 hover:bg-blue-50 hover:border-puretask-blue transition-all group\"\n                >\n                  <div className=\"flex items-center\">\n                    <div className=\"bg-blue-50 p-2 rounded-xl mr-3\">\n                      <History className=\"w-5 h-5 text-puretask-blue\" />\n                    </div>\n                    <span>View All Bookings</span>\n                  </div>\n                  <ArrowRight className=\"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </motion.div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Modernized Activity Overview */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n          <motion.div whileHover={{ scale: 1.05, y: -5 }} whileTap={{ scale: 0.95 }}>\n            <Card \n              className=\"border-0 shadow-lg rounded-3xl cursor-pointer hover:shadow-2xl transition-all bg-gradient-to-br from-blue-50 to-white\"\n              onClick={() => navigate(createPageUrl('BookingHistory'))}\n            >\n              <CardContent className=\"p-6 text-center\">\n                <div className=\"bg-blue-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-3\">\n                  <Calendar className=\"w-8 h-8 text-puretask-blue\" />\n                </div>\n                <p className=\"text-4xl font-fredoka font-bold text-graphite mb-1\">{upcomingBookings.length}</p>\n                <p className=\"text-sm text-gray-600 font-verdana font-medium\">Upcoming</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.05, y: -5 }} whileTap={{ scale: 0.95 }}>\n            <Card \n              className=\"border-0 shadow-lg rounded-3xl cursor-pointer hover:shadow-2xl transition-all bg-gradient-to-br from-red-50 to-white\"\n              onClick={() => navigate(createPageUrl('FavoriteCleaners'))}\n            >\n              <CardContent className=\"p-6 text-center\">\n                <div className=\"bg-red-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-3\">\n                  <Heart className=\"w-8 h-8 text-red-500\" fill=\"currentColor\" />\n                </div>\n                <p className=\"text-4xl font-fredoka font-bold text-graphite mb-1\">{favoriteCount}</p>\n                <p className=\"text-sm text-gray-600 font-verdana font-medium\">Favorites</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.05, y: -5 }} whileTap={{ scale: 0.95 }}>\n            <Card \n              className=\"border-0 shadow-lg rounded-3xl cursor-pointer hover:shadow-2xl transition-all bg-gradient-to-br from-purple-50 to-white\"\n              onClick={() => navigate(createPageUrl('RecurringBookings'))}\n            >\n              <CardContent className=\"p-6 text-center\">\n                <div className=\"bg-purple-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-3\">\n                  <RefreshCw className=\"w-8 h-8 text-purple-600\" />\n                </div>\n                <p className=\"text-4xl font-fredoka font-bold text-graphite mb-1\">{recurringCount}</p>\n                <p className=\"text-sm text-gray-600 font-verdana font-medium\">Recurring</p>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          <motion.div whileHover={{ scale: 1.05, y: -5 }} whileTap={{ scale: 0.95 }}>\n            <Card \n              className=\"border-0 shadow-lg rounded-3xl cursor-pointer hover:shadow-2xl transition-all bg-gradient-to-br from-green-50 to-white\"\n              onClick={() => navigate(createPageUrl('Inbox'))}\n            >\n              <CardContent className=\"p-6 text-center relative\">\n                <div className=\"bg-green-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-3\">\n                  <MessageSquare className=\"w-8 h-8 text-green-600\" />\n                </div>\n                <p className=\"text-4xl font-fredoka font-bold text-graphite mb-1\">{unreadMessages}</p>\n                <p className=\"text-sm text-gray-600 font-verdana font-medium\">Messages</p>\n                {unreadMessages > 0 && (\n                  <motion.div\n                    animate={{ scale: [1, 1.2, 1] }}\n                    transition={{ repeat: Infinity, duration: 2 }}\n                    className=\"absolute top-3 right-3 w-3 h-3 bg-red-500 rounded-full shadow-lg\"\n                  />\n                )}\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Profile & Help Section */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\n          {/* Quick Profile Card */}\n          <Card className=\"border-0 shadow-lg rounded-3xl bg-gradient-to-br from-white to-purple-50/20\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite text-xl flex items-center gap-2\">\n                <div className=\"bg-purple-100 p-2 rounded-xl\">\n                  <User className=\"w-5 h-5 text-purple-600\" />\n                </div>\n                Your Profile\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-4 mb-4\">\n                <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-puretask-blue to-purple-500 flex items-center justify-center text-white font-fredoka font-bold text-2xl shadow-lg\">\n                  {user?.full_name?.charAt(0) || 'U'}\n                </div>\n                <div className=\"flex-1\">\n                  <p className=\"font-fredoka font-bold text-graphite text-lg\">{user?.full_name}</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">{user?.email}</p>\n                  {clientProfile?.membership_tier && clientProfile.membership_tier !== 'Standard' && (\n                    <Badge className=\"mt-1 bg-gradient-to-r from-amber-400 to-orange-400 text-white border-0 font-fredoka\">\n                      {clientProfile.membership_tier} Member\n                    </Badge>\n                  )}\n                </div>\n              </div>\n              <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                <Button\n                  onClick={() => navigate(createPageUrl('Profile'))}\n                  variant=\"outline\"\n                  className=\"w-full rounded-2xl font-fredoka font-semibold h-12 border-2 hover:bg-purple-50 hover:border-purple-400 transition-all group\"\n                >\n                  <Settings className=\"w-5 h-5 mr-2\" />\n                  Manage Profile & Settings\n                  <ArrowRight className=\"w-5 h-5 ml-auto group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </motion.div>\n            </CardContent>\n          </Card>\n\n          {/* Quick Help Card */}\n          <Card className=\"border-0 shadow-lg rounded-3xl bg-gradient-to-br from-white to-cyan-50/20\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite text-xl flex items-center gap-2\">\n                <div className=\"bg-cyan-100 p-2 rounded-xl\">\n                  <HelpCircle className=\"w-5 h-5 text-cyan-600\" />\n                </div>\n                Need Help?\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-gray-600 font-verdana mb-4\">\n                We're here to help! Get answers to common questions or reach out to our support team.\n              </p>\n              <div className=\"space-y-2\">\n                <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                  <Button\n                    onClick={() => navigate(createPageUrl('Support'))}\n                    variant=\"outline\"\n                    className=\"w-full rounded-2xl font-fredoka font-semibold h-12 border-2 hover:bg-cyan-50 hover:border-cyan-400 transition-all group justify-between\"\n                  >\n                    <div className=\"flex items-center\">\n                      <HelpCircle className=\"w-5 h-5 mr-2\" />\n                      Visit Help Center\n                    </div>\n                    <ArrowRight className=\"w-5 h-5 group-hover:translate-x-1 transition-transform\" />\n                  </Button>\n                </motion.div>\n                <motion.div whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}>\n                  <Button\n                    onClick={() => navigate(createPageUrl('Inbox'))}\n                    variant=\"outline\"\n                    className=\"w-full rounded-2xl font-fredoka font-semibold h-12 border-2 hover:bg-cyan-50 hover:border-cyan-400 transition-all group justify-between\"\n                  >\n                    <div className=\"flex items-center\">\n                      <MessageSquare className=\"w-5 h-5 mr-2\" />\n                      Contact Support\n                    </div>\n                    <ArrowRight className=\"w-5 h-5 group-hover:translate-x-1 transition-transform\" />\n                  </Button>\n                </motion.div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Enhanced Recent Completions */}\n        {recentBookings.length > 0 && (\n          <Card className=\"border-0 shadow-lg rounded-3xl bg-gradient-to-br from-white to-green-50/20\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite text-xl flex items-center gap-2\">\n                <div className=\"bg-green-100 p-2 rounded-xl\">\n                  <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                </div>\n                Recent Completions\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {recentBookings.slice(0, 3).map((booking) => {\n                const review = bookingReviews[booking.id];\n                return (\n                  <motion.div \n                    key={booking.id}\n                    whileHover={{ scale: 1.02 }}\n                    className=\"flex items-center justify-between p-4 bg-white rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-all\"\n                  >\n                    <div className=\"flex items-center gap-4 flex-1\">\n                      <div className=\"bg-gradient-to-br from-green-50 to-blue-50 p-3 rounded-xl\">\n                        {getCleaningIcon(booking.cleaning_type)}\n                      </div>\n                      <div>\n                        <p className=\"font-fredoka font-bold text-graphite text-base\">\n                          {format(parseISO(booking.date), 'MMM d, yyyy')}\n                        </p>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Clock className=\"w-3 h-3 text-gray-400\" />\n                          <p className=\"text-xs text-gray-600 font-verdana\">{booking.hours} hours</p>\n                          <span className=\"text-gray-300\">‚Ä¢</span>\n                          <p className=\"text-xs text-gray-600 font-verdana capitalize\">{booking.cleaning_type || 'basic'}</p>\n                        </div>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex items-center gap-2\">\n                     {review ? (\n                       <div className=\"flex items-center gap-1 bg-amber-50 px-3 py-2 rounded-xl\">\n                         {[...Array(5)].map((_, i) => (\n                           <Star \n                             key={i} \n                             className={`w-4 h-4 ${i < review.rating ? 'text-amber-500 fill-current' : 'text-gray-300'}`}\n                           />\n                         ))}\n                       </div>\n                     ) : (\n                       <Button\n                         size=\"sm\"\n                         className=\"bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl font-fredoka font-semibold shadow-md hover:shadow-lg transition-all\"\n                         onClick={() => navigate(createPageUrl(`BookingHistory?review=${booking.id}`))}\n                       >\n                         <Star className=\"w-4 h-4 mr-2 fill-current\" />\n                         Leave Review\n                       </Button>\n                     )}\n                     <Button\n                       size=\"sm\"\n                       variant=\"outline\"\n                       className=\"rounded-xl font-fredoka font-semibold border-2\"\n                       onClick={() => handleBookAgain(booking)}\n                     >\n                       <Repeat className=\"w-4 h-4 mr-2\" />\n                       Book Again\n                     </Button>\n                    </div>\n                  </motion.div>\n                );\n              })}\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Floating Book Button */}\n        {showFloatingButton && (\n          <motion.div\n            initial={{ scale: 0, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ delay: 1, type: \"spring\", stiffness: 200 }}\n            className=\"fixed bottom-8 right-8 z-50\"\n          >\n            <motion.button\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.9 }}\n              onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n              className=\"w-16 h-16 rounded-full brand-gradient text-white shadow-2xl flex items-center justify-center group relative\"\n            >\n              <Plus className=\"w-8 h-8 group-hover:rotate-90 transition-transform duration-300\" />\n              <div className=\"absolute -top-12 right-0 bg-graphite text-white px-4 py-2 rounded-lg text-sm font-fredoka whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none\">\n                Book a Cleaning\n              </div>\n            </motion.button>\n          </motion.div>\n        )}\n      </div>\n\n      {/* FAQ Chatbot */}\n      {user && <FAQChatbot agentName=\"clientFAQChatbot\" title=\"Client Assistant\" userType=\"client\" />}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientOnboarding.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientReview.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15,"fix":{"range":[421,428],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[422,428],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":9,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[427,445],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[427,445],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":10,"column":74,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":78,"fix":{"range":[550,556],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[549,555],"text":""},"desc":"Remove unused variable 'Star'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":101,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { CheckCircle, Clock, DollarSign, Loader2, AlertTriangle, Camera, Star, MapPin } from 'lucide-react';\nimport { format } from 'date-fns';\nimport HoursComparisonDisplay from '../components/booking/HoursComparisonDisplay';\nimport StatusFlowExplainer from '../components/status/StatusFlowExplainer';\n\nconst CLEANING_TYPE_COLORS = {\n  basic: { bg: 'bg-blue-500', text: 'text-blue-500' },\n  deep: { bg: 'bg-purple-500', text: 'text-purple-500' },\n  moveout: { bg: 'bg-orange-500', text: 'text-orange-500' }\n};\n\nexport default function ClientReview() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [job, setJob] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n\n  useEffect(() => {\n    loadJob();\n  }, []);\n\n  const loadJob = async () => {\n    setLoading(true);\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      const params = new URLSearchParams(window.location.search);\n      const jobId = params.get('job_id');\n      if (!jobId) {\n        navigate(createPageUrl('BookingHistory'));\n        return;\n      }\n\n      const jobs = await base44.entities.Booking.filter({ id: jobId, client_email: currentUser.email });\n      if (jobs.length === 0) {\n        navigate(createPageUrl('BookingHistory'));\n        return;\n      }\n\n      setJob(jobs[0]);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading job:', showToast: false });\n      navigate(createPageUrl('BookingHistory'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleApprove = async () => {\n    setSubmitting(true);\n    try {\n      const actualHours = job.actual_hours || job.hours;\n      const estimatedHours = job.hours;\n      const totalRateCPH = job.snapshot_total_rate_cph || 300;\n      const additionalServicesCost = job.additional_services_cost_credits || 0;\n\n      const finalCharge = (actualHours * totalRateCPH) + additionalServicesCost;\n      const escrowReserved = job.escrow_credits_reserved || ((estimatedHours * totalRateCPH) + additionalServicesCost);\n      const refund = Math.max(0, escrowReserved - finalCharge);\n\n      await base44.entities.Booking.update(job.id, {\n        status: 'approved',\n        final_charge_credits: finalCharge,\n        refund_credits: refund,\n        client_confirmed: true\n      });\n\n      await base44.entities.Event.create({\n        booking_id: job.id,\n        event_type: 'review_submitted',\n        user_email: user.email,\n        details: `Client approved job. Final charge: ${finalCharge} credits. Refund: ${refund} credits.`\n      });\n\n      const clientProfile = await base44.entities.ClientProfile.filter({ user_email: user.email });\n      if (clientProfile.length > 0) {\n        const currentBalance = clientProfile[0].credits_balance || 0;\n        const newBalance = currentBalance + refund;\n        await base44.entities.ClientProfile.update(clientProfile[0].id, {\n          credits_balance: newBalance\n        });\n      }\n\n      alert('Job approved! Credits have been released to the cleaner.');\n      navigate(createPageUrl('BookingHistory'));\n    } catch (error) {\n      alert('Failed to approve job');\n      setSubmitting(false);\n    }\n  };\n\n  const handleReportIssue = () => {\n    navigate(createPageUrl(`Support?booking_id=${job.id}`));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  if (!job) {\n    return null;\n  }\n\n  const actualHours = job.actual_hours || job.hours;\n  const estimatedHours = job.hours;\n  const totalRateCPH = job.snapshot_total_rate_cph || 300;\n  const additionalServicesCost = job.additional_services_cost_credits || 0;\n  const finalCharge = (actualHours * totalRateCPH) + additionalServicesCost;\n  const escrowReserved = job.escrow_credits_reserved || ((estimatedHours * totalRateCPH) + additionalServicesCost);\n  const refund = Math.max(0, escrowReserved - finalCharge);\n  const colors = CLEANING_TYPE_COLORS[job.cleaning_type] || CLEANING_TYPE_COLORS.basic;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-6\">\n      <div className=\"max-w-5xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Review Your Cleaning</h1>\n          <p className=\"text-gray-600 font-verdana\">Your cleaner has completed the job. Please review and approve.</p>\n\n          {/* Status Flow Explainer */}\n          <div className=\"mt-6\">\n            <StatusFlowExplainer currentStatus=\"awaiting_client\" />\n          </div>\n          \n          <div className=\"mt-4 flex items-center gap-4 flex-wrap\">\n            <Badge className={`${colors.bg} text-white`}>{job.cleaning_type}</Badge>\n            <span className=\"text-sm font-verdana text-gray-600\">\n              <Clock className=\"w-4 h-4 inline mr-1\" />\n              {format(new Date(job.date), 'MMMM d, yyyy')}\n            </span>\n            <span className=\"text-sm font-verdana text-gray-600\">\n              <MapPin className=\"w-4 h-4 inline mr-1\" />\n              {job.address}\n            </span>\n          </div>\n        </div>\n\n        {/* Before & After Photos */}\n        <Card className=\"mb-6 border-2 shadow-lg\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Camera className=\"w-6 h-6 text-purple-500\" />\n              Before & After Photos\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <div>\n                <h4 className=\"font-fredoka font-bold text-graphite mb-3\">Before</h4>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(job.before_photos || []).map((url, idx) => (\n                    <img key={idx} src={url} alt={`Before ${idx + 1}`} className=\"w-full h-40 object-cover rounded-lg border-2 hover:scale-105 transition-transform cursor-pointer\" onClick={() => window.open(url, '_blank')} />\n                  ))}\n                </div>\n              </div>\n              <div>\n                <h4 className=\"font-fredoka font-bold text-graphite mb-3\">After</h4>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {(job.after_photos || []).map((url, idx) => (\n                    <img key={idx} src={url} alt={`After ${idx + 1}`} className=\"w-full h-40 object-cover rounded-lg border-2 hover:scale-105 transition-transform cursor-pointer\" onClick={() => window.open(url, '_blank')} />\n                  ))}\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Hours Comparison */}\n        <div className=\"mb-6\">\n          <HoursComparisonDisplay booking={job} />\n        </div>\n\n        {/* Time & Credits Summary */}\n        <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\n          <Card className=\"border-2\">\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <Clock className=\"w-5 h-5 text-blue-500\" />\n                Time Worked\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2 font-verdana\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Check-In:</span>\n                  <span className=\"font-semibold\">{job.check_in_time ? format(new Date(job.check_in_time), 'p') : 'N/A'}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Check-Out:</span>\n                  <span className=\"font-semibold\">{job.check_out_time ? format(new Date(job.check_out_time), 'p') : 'N/A'}</span>\n                </div>\n                <div className=\"flex justify-between pt-2 border-t\">\n                  <span className=\"text-gray-600\">Total Time:</span>\n                  <span className=\"font-fredoka font-bold text-puretask-blue text-lg\">\n                    {actualHours.toFixed(2)} hours\n                  </span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2\">\n            <CardHeader>\n              <CardTitle className=\"text-lg flex items-center gap-2\">\n                <DollarSign className=\"w-5 h-5 text-fresh-mint\" />\n                Credits Summary\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2 font-verdana\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Credits Held:</span>\n                  <span className=\"font-semibold\">{Math.round(escrowReserved)} credits</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Final Charge:</span>\n                  <span className=\"font-semibold\">{Math.round(finalCharge)} credits</span>\n                </div>\n                {refund > 0 && (\n                  <div className=\"flex justify-between text-fresh-mint pt-2 border-t\">\n                    <span className=\"font-bold\">Refund:</span>\n                    <span className=\"font-fredoka font-bold text-lg\">+{Math.round(refund)} credits</span>\n                  </div>\n                )}\n                {refund === 0 && actualHours > estimatedHours && (\n                  <p className=\"text-xs text-gray-500 pt-2 border-t\">\n                    Job took longer than estimated, but you're only charged for estimated time.\n                  </p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tasks Completed */}\n        {job.notes && (\n          <Card className=\"mb-6 border-2\">\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Tasks Completed & Notes</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"bg-blue-50 rounded-lg p-4 mb-4\">\n                <p className=\"font-verdana text-gray-700 whitespace-pre-wrap\">\n                  {job.notes}\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Action Buttons */}\n        <div className=\"flex gap-4\">\n          <Button\n            onClick={handleReportIssue}\n            variant=\"outline\"\n            className=\"flex-1 font-fredoka border-red-300 text-red-600 hover:bg-red-50\"\n          >\n            <AlertTriangle className=\"w-5 h-5 mr-2\" />\n            Report an Issue\n          </Button>\n          <Button\n            onClick={handleApprove}\n            disabled={submitting}\n            className=\"flex-1 bg-fresh-mint hover:bg-green-600 text-white font-fredoka font-bold\"\n          >\n            {submitting ? (\n              <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n            ) : (\n              <CheckCircle className=\"w-5 h-5 mr-2\" />\n            )}\n            Approve & Release Credits\n          </Button>\n        </div>\n\n        <p className=\"text-center text-sm text-gray-500 font-verdana mt-6\">\n          By approving, you confirm the cleaning meets your expectations and authorize credit release.\n        </p>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientSignup.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'trackEvent' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":14,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"trackEvent"},"fix":{"range":[675,713],"text":""},"desc":"Remove unused variable 'trackEvent'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":50,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'handleSignupSubmit' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":75,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":27,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleSignupSubmit"},"fix":{"range":[2925,3793],"text":""},"desc":"Remove unused variable 'handleSignupSubmit'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Sparkles, CheckCircle, Loader2, Mail, HelpCircle, Shield } from 'lucide-react';\nimport { useAnalytics } from '../components/analytics/AnalyticsTracker';\nimport { analytics } from '../components/analytics/AnalyticsService'; // New import\n\nexport default function ClientSignup() {\n  const navigate = useNavigate();\n  const { trackEvent } = useAnalytics(); // Keep for now, as useAnalytics might track other things not covered by the new analytics service\n  const [loading, setLoading] = useState(false);\n  const [checking, setChecking] = useState(true);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    // Track signup page view using the new analytics service\n    analytics.auth('signup_start');\n    \n    // Original analytics call (can be removed if analytics.auth fully replaces it)\n    // trackEvent('client_signup_start', {\n    //   source: 'direct',\n    //   referrer: document.referrer\n    // });\n    \n    checkIfLoggedIn();\n  }, []);\n\n  const checkIfLoggedIn = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (currentUser) {\n        // User is already logged in, go to complete signup\n        analytics.auth('signup_already_logged_in', {\n          user_email: currentUser.email\n        });\n        \n        // Check if onboarding is complete\n        const profiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n        if (profiles.length === 0 || !profiles[0].onboarding_completed) {\n          navigate(createPageUrl('ClientOnboarding'));\n        } else {\n          navigate(createPageUrl('ClientDashboard'));\n        }\n        return;\n      }\n    } catch (error) {\n      // User not logged in, that's fine\n    }\n    setChecking(false);\n  };\n\n  const handleSignup = () => {\n    setLoading(true);\n    setError('');\n    \n    // Track button click using the new analytics service\n    analytics.auth('signup_redirect_initiated', {\n      action: 'redirect_to_login'\n    });\n    \n    // Redirect using base44.auth.redirectToLogin with full URL\n    const nextUrl = window.location.origin + createPageUrl('ClientOnboarding');\n    base44.auth.redirectToLogin(nextUrl);\n  };\n\n  // This function is added as per the outline.\n  // In the current ClientSignup component's flow, which uses Google redirect,\n  // there isn't a direct form submission with 'formData' to trigger 'signup_success' here.\n  // The 'signup_success' event with email would typically be fired after a successful\n  // account creation/authentication, often on the redirect target page (ClientSignupComplete).\n  const handleSignupSubmit = async (formData) => {\n    // The outline requested to keep existing signup logic here,\n    // but this function's signature (taking formData) does not align with\n    // the existing handleSignup's logic (which initiates a Google redirect\n    // and doesn't involve form data at this stage).\n    // This function is defined as per outline but remains currently unused in this component's active flow.\n    \n    console.warn('handleSignupSubmit was called (likely for analytics tracking, but not integrated into core signup flow). Data:', formData);\n\n    analytics.auth('signup_success', {\n      email: formData.email\n    });\n    // No other \"existing code\" from the current handleSignup is placed here\n    // as this function's signature and intent (with formData) does not align\n    // with the current component's Google redirect logic.\n  };\n\n  if (checking) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-cyan-50 flex items-center justify-center p-6\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4\" />\n          <p className=\"text-lg text-slate-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-cyan-50 flex items-center justify-center p-6\">\n      <Card className=\"max-w-2xl w-full p-10 shadow-2xl border-0\">\n        <div className=\"text-center mb-8\">\n          <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg\">\n            <Sparkles className=\"w-8 h-8 text-white\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-slate-900 mb-2\">Welcome to PureTask</h1>\n          <p className=\"text-slate-600\">Sign up to book premium cleaning services</p>\n        </div>\n\n        {error && (\n          <Alert variant=\"destructive\" className=\"mb-6\">\n            <AlertDescription>{error}</AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"space-y-4 mb-8\">\n          <div className=\"flex items-center gap-3 p-3 bg-emerald-50 rounded-lg\">\n            <CheckCircle className=\"w-5 h-5 text-emerald-500 flex-shrink-0\" />\n            <p className=\"text-slate-700\">All cleaners pass background checks</p>\n          </div>\n          <div className=\"flex items-center gap-3 p-3 bg-emerald-50 rounded-lg\">\n            <CheckCircle className=\"w-5 h-5 text-emerald-500 flex-shrink-0\" />\n            <p className=\"text-slate-700\">Before/after photos for every job</p>\n          </div>\n          <div className=\"flex items-center gap-3 p-3 bg-emerald-50 rounded-lg\">\n            <CheckCircle className=\"w-5 h-5 text-emerald-500 flex-shrink-0\" />\n            <p className=\"text-slate-700\">Satisfaction guaranteed</p>\n          </div>\n        </div>\n\n        <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6\">\n          <div className=\"flex items-start gap-3\">\n            <Mail className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n            <div className=\"text-sm text-slate-700\">\n              <p className=\"font-semibold mb-2\">Quick Sign-Up Process:</p>\n              <ol className=\"list-decimal list-inside space-y-1\">\n                <li>Click \"Continue with Google\" below</li>\n                <li>Sign in with your Google account</li>\n                <li>Check your email for confirmation (if needed)</li>\n                <li>You'll be automatically redirected back to complete your profile</li>\n              </ol>\n              <div className=\"mt-3 pt-3 border-t border-blue-200 flex items-start gap-2\">\n                <Shield className=\"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                <p className=\"text-xs text-blue-800\">\n                  <strong>Privacy First:</strong> We use Google sign-in for security. We never access \n                  your Google data beyond your email and name for account creation.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <Button\n          className=\"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white text-lg py-6 shadow-lg\"\n          onClick={handleSignup}\n          disabled={loading}\n        >\n          {loading ? (\n            <>\n              <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n              Redirecting to Login...\n            </>\n          ) : (\n            'Continue with Google'\n          )}\n        </Button>\n\n        <div className=\"mt-6 text-center space-y-3\">\n          <p className=\"text-sm text-slate-600\">\n            Already have an account?{' '}\n            <button\n              onClick={handleSignup}\n              className=\"text-blue-600 hover:text-blue-700 font-medium\"\n            >\n              Sign In\n            </button>\n          </p>\n          <div className=\"flex items-center justify-center gap-2 text-sm\">\n            <HelpCircle className=\"w-4 h-4 text-slate-400\" />\n            <Link to={createPageUrl('ResendConfirmation')} className=\"text-blue-600 hover:text-blue-700\">\n              Didn't receive confirmation email?\n            </Link>\n          </div>\n        </div>\n      </Card>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ClientSignupComplete.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\DamageClaimsPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\DesignSystemDemo.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":2,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36,"fix":{"range":[57,64],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[56,63],"text":""},"desc":"Remove unused variable 'Clock'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { MapPin, CheckCircle, Clock, AlertTriangle, XCircle, Info } from 'lucide-react';\r\n\r\n/**\r\n * Design System Demo Page\r\n * Showcases PureTask's locked color system and typography\r\n */\r\nexport default function DesignSystemDemo() {\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-50 p-8\">\r\n      <div className=\"max-w-7xl mx-auto space-y-12\">\r\n        \r\n        {/* Header */}\r\n        <div className=\"text-center space-y-4\">\r\n          <h1 className=\"font-heading text-6xl font-bold text-slate-900\">\r\n            PureTask Design System\r\n          </h1>\r\n          <p className=\"font-body text-xl text-slate-600\">\r\n            Locked color palette and semantic usage rules\r\n          </p>\r\n          <div className=\"inline-block bg-brand-primary text-slate-900 font-heading font-semibold px-6 py-2 rounded-full\">\r\n            Version 1.0.0 - LOCKED\r\n          </div>\r\n        </div>\r\n\r\n        {/* Brand Color */}\r\n        <section>\r\n          <h2 className=\"font-heading text-3xl font-bold text-slate-900 mb-6\">\r\n            Brand Color\r\n          </h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-brand-primary h-24 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900\">\r\n                Brand Primary\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#00FFFF</p>\r\n              <p className=\"font-body text-sm text-slate-500\">\r\n                Use for: CTAs, active nav, links\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 mb-4\">\r\n                Usage Examples\r\n              </h3>\r\n              <div className=\"space-y-3\">\r\n                <button className=\"w-full bg-brand-primary text-slate-900 font-heading font-semibold px-6 py-3 rounded-lg\">\r\n                  Primary CTA Button\r\n                </button>\r\n                <a href=\"#\" className=\"block font-body text-brand-primary font-semibold\">\r\n                  Active Link Example\r\n                </a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Semantic Colors */}\r\n        <section>\r\n          <h2 className=\"font-heading text-3xl font-bold text-slate-900 mb-6\">\r\n            Semantic Colors\r\n          </h2>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n            \r\n            {/* Success/Reliability */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-success h-16 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 flex items-center gap-2\">\r\n                <CheckCircle className=\"w-5 h-5 text-success\" />\r\n                Success\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#22C55E</p>\r\n              <p className=\"font-body text-sm text-slate-500 mb-4\">\r\n                Reliability, completed, positive metrics\r\n              </p>\r\n              \r\n              {/* Example Card */}\r\n              <div className=\"bg-success-soft border border-success-border rounded-lg p-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"font-body text-xs text-slate-600\">Reliability Score</p>\r\n                    <p className=\"font-heading text-2xl font-bold text-success\">87</p>\r\n                  </div>\r\n                  <span className=\"bg-success text-white font-heading font-medium px-3 py-1 rounded-full text-sm\">\r\n                    ‚úì Complete\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* System/Tracking */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-system h-16 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 flex items-center gap-2\">\r\n                <MapPin className=\"w-5 h-5 text-system\" />\r\n                System\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#06B6D4</p>\r\n              <p className=\"font-body text-sm text-slate-500 mb-4\">\r\n                GPS tracking, live updates, activity\r\n              </p>\r\n              \r\n              {/* Example Card */}\r\n              <div className=\"bg-system-soft border-l-4 border-system rounded-lg p-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"bg-system text-white p-2 rounded-full\">\r\n                    <MapPin className=\"w-4 h-4\" />\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"font-heading font-semibold text-system-text text-sm\">\r\n                      Checked In\r\n                    </p>\r\n                    <p className=\"font-body text-xs text-slate-600\">10:05 AM</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Warning */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-warning h-16 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-5 h-5 text-warning\" />\r\n                Warning\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#F59E0B</p>\r\n              <p className=\"font-body text-sm text-slate-500 mb-4\">\r\n                Awaiting approval, needs attention\r\n              </p>\r\n              \r\n              {/* Example Badge */}\r\n              <div className=\"bg-warning-soft border border-warning-border rounded-lg p-4\">\r\n                <span className=\"bg-warning text-white font-heading font-medium px-3 py-2 rounded-full text-sm\">\r\n                  ‚è≥ Pending\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Error */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-error h-16 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 flex items-center gap-2\">\r\n                <XCircle className=\"w-5 h-5 text-error\" />\r\n                Error\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#EF4444</p>\r\n              <p className=\"font-body text-sm text-slate-500 mb-4\">\r\n                Critical issues, failures, disputes\r\n              </p>\r\n              \r\n              {/* Example Alert */}\r\n              <div className=\"bg-error-soft border border-error-border rounded-lg p-4\">\r\n                <span className=\"bg-error text-white font-heading font-medium px-3 py-2 rounded-full text-sm\">\r\n                  ‚úï Disputed\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Info */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <div className=\"bg-info h-16 rounded-lg mb-4\"></div>\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 flex items-center gap-2\">\r\n                <Info className=\"w-5 h-5 text-info\" />\r\n                Info\r\n              </h3>\r\n              <p className=\"font-body text-slate-600 mb-2\">#3B82F6</p>\r\n              <p className=\"font-body text-sm text-slate-500 mb-4\">\r\n                Informational, neutral status\r\n              </p>\r\n              \r\n              {/* Example Tooltip */}\r\n              <div className=\"bg-info-soft border border-info-border rounded-lg p-4\">\r\n                <span className=\"bg-info text-white font-heading font-medium px-3 py-2 rounded-full text-sm\">\r\n                  ‚Ñπ Scheduled\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Typography */}\r\n        <section>\r\n          <h2 className=\"font-heading text-3xl font-bold text-slate-900 mb-6\">\r\n            Typography\r\n          </h2>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {/* Headings (Poppins) */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 mb-4\">\r\n                Headings - Poppins\r\n              </h3>\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">H1 - Display</p>\r\n                  <h1 className=\"font-heading text-4xl font-bold text-slate-900\">\r\n                    Trust-First Marketplace\r\n                  </h1>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">H2 - Section</p>\r\n                  <h2 className=\"font-heading text-3xl font-bold text-slate-900\">\r\n                    Find Your Perfect Cleaner\r\n                  </h2>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">H3 - Card Title</p>\r\n                  <h3 className=\"font-heading text-xl font-semibold text-slate-900\">\r\n                    Reliability Score\r\n                  </h3>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">Button Text</p>\r\n                  <button className=\"bg-brand-primary text-slate-900 font-heading font-semibold px-6 py-2 rounded-lg\">\r\n                    Book Now\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Body (Quicksand) */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 mb-4\">\r\n                Body Text - Quicksand\r\n              </h3>\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">Large Body</p>\r\n                  <p className=\"font-body text-lg text-slate-700\">\r\n                    Connect with verified, professional cleaners in your area.\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">Regular Body</p>\r\n                  <p className=\"font-body text-base text-slate-600\">\r\n                    PureTask ensures quality through GPS tracking, photo verification, and performance-based ratings.\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">Small/Helper Text</p>\r\n                  <p className=\"font-body text-sm text-slate-500\">\r\n                    All cleaners are background checked and identity verified.\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"font-body text-xs text-slate-500 mb-1\">Extra Small</p>\r\n                  <p className=\"font-body text-xs text-slate-400\">\r\n                    Last updated: January 2, 2026\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Real-World Examples */}\r\n        <section>\r\n          <h2 className=\"font-heading text-3xl font-bold text-slate-900 mb-6\">\r\n            Real-World Component Examples\r\n          </h2>\r\n          \r\n          <div className=\"space-y-6\">\r\n            \r\n            {/* Booking Card Example */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200 shadow-md\">\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div>\r\n                  <h3 className=\"font-heading text-2xl font-semibold text-slate-900\">\r\n                    Deep Cleaning - 4 hours\r\n                  </h3>\r\n                  <p className=\"font-body text-slate-600 mt-1\">\r\n                    December 28, 2025 ‚Ä¢ 10:00 AM\r\n                  </p>\r\n                </div>\r\n                <span className=\"bg-success text-white font-heading font-medium px-4 py-2 rounded-full\">\r\n                  ‚úì Completed\r\n                </span>\r\n              </div>\r\n              \r\n              <div className=\"grid grid-cols-3 gap-4\">\r\n                <div className=\"bg-success-soft border border-success-border rounded-lg p-3\">\r\n                  <p className=\"font-body text-xs text-slate-600\">On Time</p>\r\n                  <p className=\"font-heading font-bold text-success text-lg\">‚úì</p>\r\n                </div>\r\n                <div className=\"bg-success-soft border border-success-border rounded-lg p-3\">\r\n                  <p className=\"font-body text-xs text-slate-600\">Photos</p>\r\n                  <p className=\"font-heading font-bold text-success text-lg\">8</p>\r\n                </div>\r\n                <div className=\"bg-success-soft border border-success-border rounded-lg p-3\">\r\n                  <p className=\"font-body text-xs text-slate-600\">Rating</p>\r\n                  <p className=\"font-heading font-bold text-success text-lg\">5.0</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Live Tracking Banner */}\r\n            <div className=\"bg-system text-white py-4 px-6 rounded-lg shadow-lg\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <div className=\"animate-pulse\">\r\n                    <div className=\"w-3 h-3 bg-white rounded-full\"></div>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"font-heading font-semibold text-lg\">\r\n                      Job In Progress\r\n                    </h4>\r\n                    <p className=\"font-body text-sm text-cyan-100\">\r\n                      Sarah checked in at 10:05 AM\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button className=\"bg-white text-system font-heading font-medium px-4 py-2 rounded-lg\">\r\n                  View Live\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Tier Badges */}\r\n            <div className=\"bg-white rounded-xl p-6 border border-slate-200\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-slate-900 mb-4\">\r\n                Cleaner Tiers\r\n              </h3>\r\n              <div className=\"flex flex-wrap gap-3\">\r\n                <div className=\"bg-success text-white font-heading font-bold px-4 py-2 rounded-full flex items-center gap-2\">\r\n                  <span>üíé</span> Elite\r\n                </div>\r\n                <div className=\"bg-success-soft text-success-text border border-success-border font-heading font-semibold px-4 py-2 rounded-full flex items-center gap-2\">\r\n                  <span>üåü</span> Pro\r\n                </div>\r\n                <div className=\"bg-info-soft text-info-text border border-info-border font-heading font-semibold px-4 py-2 rounded-full flex items-center gap-2\">\r\n                  <span>‚≠ê</span> Semi-Pro\r\n                </div>\r\n                <div className=\"bg-slate-100 text-slate-700 font-heading font-medium px-4 py-2 rounded-full flex items-center gap-2\">\r\n                  <span>üå±</span> Developing\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Usage Rules */}\r\n        <section>\r\n          <h2 className=\"font-heading text-3xl font-bold text-slate-900 mb-6\">\r\n            Usage Rules (Non-Negotiable)\r\n          </h2>\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {/* DO */}\r\n            <div className=\"bg-success-soft border-l-4 border-success rounded-lg p-6\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-success-text mb-4\">\r\n                ‚úÖ DO\r\n              </h3>\r\n              <ul className=\"font-body text-sm text-slate-700 space-y-2\">\r\n                <li>‚Ä¢ Use brand color for CTAs and active states</li>\r\n                <li>‚Ä¢ Use success green for reliability and completion</li>\r\n                <li>‚Ä¢ Use system cyan for GPS and live tracking</li>\r\n                <li>‚Ä¢ Use Poppins for all headings</li>\r\n                <li>‚Ä¢ Use Quicksand for body text</li>\r\n                <li>‚Ä¢ Maintain semantic color meanings consistently</li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* DON'T */}\r\n            <div className=\"bg-error-soft border-l-4 border-error rounded-lg p-6\">\r\n              <h3 className=\"font-heading text-xl font-semibold text-error-text mb-4\">\r\n                ‚ùå DON'T\r\n              </h3>\r\n              <ul className=\"font-body text-sm text-slate-700 space-y-2\">\r\n                <li>‚Ä¢ Use brand color for card backgrounds</li>\r\n                <li>‚Ä¢ Mix semantic meanings (green for tracking)</li>\r\n                <li>‚Ä¢ Use colors decoratively without purpose</li>\r\n                <li>‚Ä¢ Use Quicksand for headings</li>\r\n                <li>‚Ä¢ Use Poppins for long body text</li>\r\n                <li>‚Ä¢ Suggest alternative colors</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* Footer */}\r\n        <div className=\"text-center py-8 border-t border-slate-200\">\r\n          <p className=\"font-body text-slate-500\">\r\n            Design System v1.0.0 - LOCKED ‚Ä¢ Last Updated: January 2, 2026\r\n          </p>\r\n          <p className=\"font-body text-sm text-slate-400 mt-2\">\r\n            Do not modify without explicit approval\r\n          </p>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\FavoriteCleaners.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":12,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":22,"fix":{"range":[536,544],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[535,543],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":12,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":34,"fix":{"range":[544,556],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[543,555],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Dialog' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":9,"fix":{"range":[730,740],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Dialog"},"fix":{"range":[733,740],"text":""},"desc":"Remove unused variable 'Dialog'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogContent' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":16,"fix":{"range":[740,757],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogContent"},"fix":{"range":[739,756],"text":""},"desc":"Remove unused variable 'DialogContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogDescription' is defined but never used.","line":19,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":20,"fix":{"range":[757,778],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogDescription"},"fix":{"range":[756,777],"text":""},"desc":"Remove unused variable 'DialogDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogHeader' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":15,"fix":{"range":[778,794],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogHeader"},"fix":{"range":[777,793],"text":""},"desc":"Remove unused variable 'DialogHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DialogTitle' is defined but never used.","line":21,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":14,"fix":{"range":[793,808],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DialogTitle"},"fix":{"range":[793,808],"text":""},"desc":"Remove unused variable 'DialogTitle'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[964,968],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Heart, Star, MapPin, DollarSign, Calendar, Loader2, Trash2,\n  Edit2, Save, X, Sparkles, TrendingUp, Search, Plus, Zap\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { toast } from 'sonner';\n\nexport default function FavoriteCleaners() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [favorites, setFavorites] = useState([]);\n  const [cleanerProfiles, setCleanerProfiles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingNotes, setEditingNotes] = useState(null);\n  const [notesText, setNotesText] = useState('');\n  const [savingNotes, setSavingNotes] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'client') {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load favorites\n      const favs = await base44.entities.FavoriteCleaner.filter({\n        client_email: currentUser.email\n      }, '-created_date');\n      setFavorites(favs);\n\n      // Load cleaner profiles for all favorites\n      if (favs.length > 0) {\n        const cleanerEmails = favs.map(f => f.cleaner_email);\n        const profiles = await base44.entities.CleanerProfile.filter({\n          user_email: { $in: cleanerEmails }\n        });\n        setCleanerProfiles(profiles);\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading favorites:', showToast: false });\n      toast.error('Failed to load favorites');\n    }\n    setLoading(false);\n  };\n\n  const handleRemoveFavorite = async (favoriteId) => {\n    if (!confirm('Remove this cleaner from your favorites?')) return;\n\n    try {\n      await base44.entities.FavoriteCleaner.delete(favoriteId);\n      toast.success('Removed from favorites');\n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error removing favorite:', showToast: false });\n      toast.error('Failed to remove favorite');\n    }\n  };\n\n  const handleEditNotes = (favorite) => {\n    setEditingNotes(favorite.id);\n    setNotesText(favorite.notes || '');\n  };\n\n  const handleSaveNotes = async () => {\n    setSavingNotes(true);\n    try {\n      await base44.entities.FavoriteCleaner.update(editingNotes, {\n        notes: notesText\n      });\n      toast.success('Notes saved');\n      setEditingNotes(null);\n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving notes:', showToast: false });\n      toast.error('Failed to save notes');\n    }\n    setSavingNotes(false);\n  };\n\n  const getCleanerProfile = (cleanerEmail) => {\n    return cleanerProfiles.find(p => p.user_email === cleanerEmail);\n  };\n\n  const filteredFavorites = favorites.filter(fav => {\n    if (!searchQuery) return true;\n    const profile = getCleanerProfile(fav.cleaner_email);\n    return (\n      fav.cleaner_email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      profile?.full_name?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      fav.notes?.toLowerCase().includes(searchQuery.toLowerCase())\n    );\n  });\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2 flex items-center gap-3\">\n            <Heart className=\"w-10 h-10 text-red-500\" fill=\"currentColor\" />\n            My Favorite Cleaners\n          </h1>\n          <p className=\"text-lg text-gray-600 font-verdana\">\n            Quick access to your trusted cleaning professionals\n          </p>\n        </div>\n\n        {/* Search */}\n        {favorites.length > 0 && (\n          <Card className=\"mb-6 border-0 shadow-lg rounded-2xl\">\n            <CardContent className=\"p-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                <Input\n                  placeholder=\"Search your favorites...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pl-12 font-verdana\"\n                />\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Stats */}\n        {favorites.length > 0 && (\n          <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\n            <Card className=\"border-0 shadow-lg bg-gradient-to-br from-red-50 to-pink-50 rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <Heart className=\"w-10 h-10 text-red-500 mx-auto mb-3\" fill=\"currentColor\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{favorites.length}</p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Favorite Cleaners</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <Star className=\"w-10 h-10 text-amber-500 mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                  {(cleanerProfiles.reduce((sum, p) => sum + (p.average_rating || 5), 0) / Math.max(cleanerProfiles.length, 1)).toFixed(1)}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Average Rating</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl\">\n              <CardContent className=\"p-6 text-center\">\n                <TrendingUp className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                  {Math.round(cleanerProfiles.reduce((sum, p) => sum + (p.reliability_score || 75), 0) / Math.max(cleanerProfiles.length, 1))}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">Avg Reliability</p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Favorites List */}\n        {filteredFavorites.length > 0 ? (\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <AnimatePresence>\n              {filteredFavorites.map((favorite, idx) => {\n                const profile = getCleanerProfile(favorite.cleaner_email);\n                \n                return (\n                  <motion.div\n                    key={favorite.id}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, scale: 0.9 }}\n                    transition={{ delay: idx * 0.1 }}\n                  >\n                    <Card className=\"border-2 border-red-200 hover:shadow-xl transition-all rounded-2xl\">\n                      <CardHeader className=\"bg-gradient-to-r from-red-50 to-pink-50 rounded-t-2xl\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-12 h-12 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold text-xl\">\n                              {profile?.full_name?.[0] || favorite.cleaner_email[0].toUpperCase()}\n                            </div>\n                            <div>\n                              <CardTitle className=\"font-fredoka text-graphite\">\n                                {profile?.full_name || favorite.cleaner_email}\n                              </CardTitle>\n                              <div className=\"flex items-center gap-2 mt-1\">\n                                {profile?.tier && (\n                                  <Badge className={`rounded-full font-fredoka ${\n                                    profile.tier === 'Elite' ? 'bg-amber-500 text-white' :\n                                    profile.tier === 'Pro' ? 'bg-purple-500 text-white' :\n                                    profile.tier === 'Semi Pro' ? 'bg-blue-500 text-white' :\n                                    'bg-gray-500 text-white'\n                                  }`}>\n                                    {profile.tier}\n                                  </Badge>\n                                )}\n                                {profile?.average_rating && (\n                                  <Badge className=\"bg-amber-100 text-amber-700 rounded-full font-fredoka\">\n                                    <Star className=\"w-3 h-3 mr-1\" fill=\"currentColor\" />\n                                    {profile.average_rating.toFixed(1)}\n                                  </Badge>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                          \n                          <Heart className=\"w-6 h-6 text-red-500\" fill=\"currentColor\" />\n                        </div>\n                      </CardHeader>\n\n                      <CardContent className=\"p-6 space-y-4\">\n                        {/* Cleaner Info */}\n                        {profile && (\n                          <div className=\"grid grid-cols-2 gap-4 pb-4 border-b border-gray-200\">\n                            <div>\n                              <p className=\"text-xs text-gray-500 font-verdana mb-1\">Base Rate</p>\n                              <p className=\"font-fredoka font-bold text-puretask-blue\">\n                                {profile.base_rate_credits_per_hour || 300} credits/hr\n                              </p>\n                              <p className=\"text-xs text-gray-500 font-verdana\">\n                                ‚âà ${((profile.base_rate_credits_per_hour || 300) / 10).toFixed(0)}/hr\n                              </p>\n                            </div>\n                            <div>\n                              <p className=\"text-xs text-gray-500 font-verdana mb-1\">Reliability</p>\n                              <div className=\"flex items-center gap-2\">\n                                <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                                  <div\n                                    className=\"bg-fresh-mint h-2 rounded-full\"\n                                    style={{ width: `${profile.reliability_score || 75}%` }}\n                                  />\n                                </div>\n                                <span className=\"font-fredoka font-bold text-graphite text-sm\">\n                                  {profile.reliability_score || 75}\n                                </span>\n                              </div>\n                            </div>\n                          </div>\n                        )}\n\n                        {/* Personal Notes */}\n                        <div>\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <p className=\"text-sm font-fredoka font-semibold text-graphite\">Personal Notes</p>\n                            {editingNotes !== favorite.id && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                onClick={() => handleEditNotes(favorite)}\n                                className=\"rounded-full\"\n                              >\n                                <Edit2 className=\"w-3 h-3 mr-1\" />\n                                Edit\n                              </Button>\n                            )}\n                          </div>\n\n                          {editingNotes === favorite.id ? (\n                            <div className=\"space-y-2\">\n                              <Textarea\n                                value={notesText}\n                                onChange={(e) => setNotesText(e.target.value)}\n                                placeholder=\"Add personal notes about this cleaner...\"\n                                rows={3}\n                                className=\"rounded-2xl font-verdana text-sm\"\n                              />\n                              <div className=\"flex gap-2\">\n                                <Button\n                                  size=\"sm\"\n                                  onClick={handleSaveNotes}\n                                  disabled={savingNotes}\n                                  className=\"flex-1 bg-fresh-mint text-white rounded-full font-fredoka\"\n                                >\n                                  <Save className=\"w-3 h-3 mr-1\" />\n                                  Save\n                                </Button>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => setEditingNotes(null)}\n                                  className=\"rounded-full font-fredoka\"\n                                >\n                                  <X className=\"w-3 h-3 mr-1\" />\n                                  Cancel\n                                </Button>\n                              </div>\n                            </div>\n                          ) : (\n                            <p className=\"text-sm text-gray-600 font-verdana italic p-3 bg-gray-50 rounded-2xl\">\n                              {favorite.notes || 'No notes yet - click Edit to add'}\n                            </p>\n                          )}\n                        </div>\n\n                        {/* Quick Actions */}\n                        <div className=\"grid grid-cols-2 gap-3 pt-4\">\n                          <Button\n                            onClick={() => navigate(createPageUrl(`BookingFlow?cleaner=${favorite.cleaner_email}`))}\n                            className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                          >\n                            <Calendar className=\"w-4 h-4 mr-2\" />\n                            Book Now\n                          </Button>\n                          \n                          <Button\n                            onClick={() => navigate(createPageUrl(`CleanerProfile?email=${favorite.cleaner_email}`))}\n                            variant=\"outline\"\n                            className=\"rounded-full font-fredoka border-2\"\n                          >\n                            <Sparkles className=\"w-4 h-4 mr-2\" />\n                            View Profile\n                          </Button>\n                        </div>\n\n                        {/* Remove Button */}\n                        <Button\n                          onClick={() => handleRemoveFavorite(favorite.id)}\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          className=\"w-full text-red-600 hover:bg-red-50 rounded-full font-fredoka\"\n                        >\n                          <Trash2 className=\"w-3 h-3 mr-2\" />\n                          Remove from Favorites\n                        </Button>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                );\n              })}\n            </AnimatePresence>\n          </div>\n        ) : (\n          <Card className=\"border-0 shadow-xl rounded-2xl\">\n            <CardContent className=\"p-12 text-center\">\n              <Heart className=\"w-20 h-20 text-gray-300 mx-auto mb-4\" />\n              <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-2\">\n                {searchQuery ? 'No matching favorites found' : 'No Favorite Cleaners Yet'}\n              </h3>\n              <p className=\"text-gray-600 font-verdana mb-6 max-w-md mx-auto\">\n                {searchQuery \n                  ? 'Try adjusting your search'\n                  : 'Browse cleaners and click the heart icon to add them to your favorites for quick booking'}\n              </p>\n              \n              {!searchQuery && (\n                <Button\n                  onClick={() => navigate(createPageUrl('BrowseCleaners'))}\n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold shadow-lg\"\n                >\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Browse Cleaners\n                </Button>\n              )}\n              \n              {searchQuery && (\n                <Button\n                  onClick={() => setSearchQuery('')}\n                  variant=\"outline\"\n                  className=\"rounded-full font-fredoka\"\n                >\n                  Clear Search\n                </Button>\n              )}\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Tips Section */}\n        {favorites.length > 0 && (\n          <Card className=\"mt-8 border-0 shadow-lg bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n                <Sparkles className=\"w-5 h-5 text-purple-600\" />\n                Pro Tips\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center flex-shrink-0\">\n                    <Calendar className=\"w-4 h-4 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite mb-1\">Book Recurring</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      Convert any booking with your favorite to recurring and save 10%\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0\">\n                    <Edit2 className=\"w-4 h-4 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite mb-1\">Add Notes</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      Keep track of preferences, special instructions, or what worked well\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center flex-shrink-0\">\n                    <Zap className=\"w-4 h-4 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite mb-1\">Quick Booking</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      Skip browsing - book your favorites instantly with one click\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center flex-shrink-0\">\n                    <TrendingUp className=\"w-4 h-4 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"font-fredoka font-semibold text-graphite mb-1\">Track Performance</p>\n                    <p className=\"text-sm text-gray-600 font-verdana\">\n                      Watch your favorites improve their reliability scores over time\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\FinanceDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ForAirbnbHosts.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":8,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":20,"fix":{"range":[286,292],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[285,291],"text":""},"desc":"Remove unused variable 'Star'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":11,"fix":{"range":[318,330],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[317,329],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":9,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":30,"fix":{"range":[342,349],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[341,348],"text":""},"desc":"Remove unused variable 'Award'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Home, Clock, Star, Zap, CheckCircle, Camera,\n  Calendar, DollarSign, Award, TrendingUp, Shield\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function ForAirbnbHosts() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100\">\n      {/* Hero */}\n      <section className=\"relative overflow-hidden bg-gradient-to-r from-rose-500 to-orange-600 text-white py-20\">\n        <div className=\"container mx-auto px-6 relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-4xl mx-auto text-center\"\n          >\n            <Badge className=\"mb-6 bg-white/20 text-white border-white/30 text-lg px-6 py-2\">\n              <Home className=\"w-5 h-5 mr-2\" />\n              For Airbnb & Short-Term Rental Hosts\n            </Badge>\n            <h1 className=\"text-5xl lg:text-6xl font-bold mb-6\">\n              Turnover Cleaning,<br />Perfected\n            </h1>\n            <p className=\"text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-rose-50\">\n              Fast, reliable, photo-documented cleaning between guests. Keep your 5-star rating with verified cleaners.\n            </p>\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"bg-white text-rose-600 hover:bg-rose-50 shadow-xl text-lg px-10 py-7\">\n                <Zap className=\"w-5 h-5 mr-2\" />\n                Book Turnover Cleaning\n              </Button>\n            </Link>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Built for Hosts */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-4 text-center\">\n              Built for the Demands of Airbnb Hosting\n            </h2>\n            <p className=\"text-xl text-slate-600 text-center mb-16\">\n              Your guests expect perfection. So do we.\n            </p>\n\n            <div className=\"grid md:grid-cols-3 gap-6 mb-12\">\n              {[\n                {\n                  icon: Clock,\n                  title: 'Same-Day Turnovers',\n                  description: 'Guest checking out at 11am, next one at 3pm? We will have your place spotless in between.',\n                  color: 'rose'\n                },\n                {\n                  icon: Camera,\n                  title: 'Photo Proof',\n                  description: 'Before/after photos sent instantly. Perfect for remote hosts managing multiple properties.',\n                  color: 'blue'\n                },\n                {\n                  icon: Shield,\n                  title: 'Verified Cleaners',\n                  description: 'Background-checked professionals who understand Airbnb standards and guest expectations.',\n                  color: 'emerald'\n                }\n              ].map((feature, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"h-full border-0 shadow-lg\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className={`w-14 h-14 bg-gradient-to-r from-${feature.color}-500 to-${feature.color}-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg`}>\n                        <feature.icon className=\"w-7 h-7 text-white\" />\n                      </div>\n                      <h3 className=\"text-lg font-bold text-slate-900 mb-2\">{feature.title}</h3>\n                      <p className=\"text-slate-600 text-sm\">{feature.description}</p>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* The Airbnb Host Problem */}\n      <section className=\"py-20 bg-gradient-to-br from-rose-50 to-orange-50\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-3xl font-bold text-slate-900 mb-12 text-center\">\n              We Solve Your Biggest Hosting Headaches\n            </h2>\n\n            <div className=\"grid md:grid-cols-2 gap-8\">\n              {[\n                {\n                  problem: 'Tight Turnover Windows',\n                  solution: 'Same-day booking with verified cleaners who specialize in quick turnarounds.',\n                  icon: Clock\n                },\n                {\n                  problem: 'Cannot Be On-Site',\n                  solution: 'GPS check-in/out + photos mean you never have to be there to verify the work.',\n                  icon: Camera\n                },\n                {\n                  problem: 'Consistency Issues',\n                  solution: 'Reliability Score shows you exactly which cleaners are punctual and thorough.',\n                  icon: TrendingUp\n                },\n                {\n                  problem: 'Last-Minute Cancellations',\n                  solution: 'Backup cleaner system finds replacements automatically if your cleaner cancels.',\n                  icon: Shield\n                }\n              ].map((item, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, x: idx % 2 === 0 ? -20 : 20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"border-0 shadow-lg h-full\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start gap-4\">\n                        <div className=\"w-12 h-12 bg-gradient-to-r from-rose-500 to-orange-600 rounded-lg flex items-center justify-center flex-shrink-0\">\n                          <item.icon className=\"w-6 h-6 text-white\" />\n                        </div>\n                        <div>\n                          <p className=\"text-sm text-red-600 font-semibold mb-1\">Problem:</p>\n                          <p className=\"font-bold text-slate-900 mb-2\">{item.problem}</p>\n                          <p className=\"text-sm text-emerald-600 font-semibold mb-1\">Solution:</p>\n                          <p className=\"text-slate-600 text-sm\">{item.solution}</p>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* ROI for Hosts */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-4 text-center\">\n              Protect Your 5-Star Rating\n            </h2>\n            <p className=\"text-xl text-slate-600 text-center mb-16\">\n              Cleanliness is the #1 factor in guest reviews\n            </p>\n\n            <Card className=\"border-2 border-rose-200 bg-gradient-to-br from-rose-50 to-orange-50\">\n              <CardContent className=\"p-10\">\n                <div className=\"grid md:grid-cols-3 gap-8 text-center\">\n                  <div>\n                    <p className=\"text-5xl font-bold text-rose-600 mb-2\">93%</p>\n                    <p className=\"text-slate-700\">Of negative Airbnb reviews mention cleanliness</p>\n                  </div>\n                  <div>\n                    <p className=\"text-5xl font-bold text-emerald-600 mb-2\">$47</p>\n                    <p className=\"text-slate-700\">Average lost revenue per bad review</p>\n                  </div>\n                  <div>\n                    <p className=\"text-5xl font-bold text-blue-600 mb-2\">4.9‚òÖ</p>\n                    <p className=\"text-slate-700\">Average cleanliness rating with PureTask</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"mt-12 grid md:grid-cols-2 gap-6\">\n              {[\n                'Photo proof protects against false complaints',\n                'GPS tracking shows cleaners were actually there',\n                'Reliability Score = consistent quality',\n                'Automatic refunds if standards are not met'\n              ].map((benefit, idx) => (\n                <div key={idx} className=\"flex items-center gap-3 p-4 bg-emerald-50 rounded-lg border border-emerald-200\">\n                  <CheckCircle className=\"w-6 h-6 text-emerald-600 flex-shrink-0\" />\n                  <span className=\"text-slate-700\">{benefit}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Pricing for Hosts */}\n      <section className=\"py-20 bg-gradient-to-br from-slate-50 to-slate-100\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <h2 className=\"text-3xl font-bold text-slate-900 mb-6\">\n              Special Pricing for Multi-Property Hosts\n            </h2>\n            <p className=\"text-lg text-slate-600 mb-8\">\n              Managing 3+ properties? Get volume discounts and dedicated support.\n            </p>\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"bg-gradient-to-r from-rose-500 to-orange-600 hover:from-rose-600 hover:to-orange-700 text-white text-lg px-10 py-7 shadow-xl\">\n                <DollarSign className=\"w-5 h-5 mr-2\" />\n                See Pricing & Get Started\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA */}\n      <section className=\"py-20 bg-gradient-to-r from-rose-500 to-orange-600 text-white\">\n        <div className=\"container mx-auto px-6 text-center\">\n          <h2 className=\"text-4xl font-bold mb-6\">\n            Never Worry About Turnover Cleaning Again\n          </h2>\n          <p className=\"text-xl text-rose-50 mb-10 max-w-2xl mx-auto\">\n            Book verified cleaners with photo proof and GPS tracking\n          </p>\n          <Link to={createPageUrl('RoleSelection')}>\n            <Button size=\"lg\" className=\"bg-white text-rose-600 hover:bg-rose-50 shadow-xl text-lg px-10 py-7\">\n              Get Started Free\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ForFamilies.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":8,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":42,"fix":{"range":[301,314],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[300,313],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Heart, Shield, Users, Baby, CheckCircle, Star,\n  Home, Sparkles, Award, Clock, AlertTriangle, Calendar\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function ForFamilies() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100\">\n      {/* Hero */}\n      <section className=\"relative overflow-hidden bg-gradient-to-r from-pink-500 to-purple-600 text-white py-20\">\n        <div className=\"container mx-auto px-6 relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-4xl mx-auto text-center\"\n          >\n            <Badge className=\"mb-6 bg-white/20 text-white border-white/30 text-lg px-6 py-2\">\n              <Heart className=\"w-5 h-5 mr-2\" />\n              For Families with Kids\n            </Badge>\n            <h1 className=\"text-5xl lg:text-6xl font-bold mb-6\">\n              Safe, Trusted Cleaners<br />\n              Your Family Can Count On\n            </h1>\n            <p className=\"text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-pink-50\">\n              Background-checked cleaners who understand families with kids, pets, and the need for child-safe products.\n            </p>\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"bg-white text-pink-600 hover:bg-pink-50 shadow-xl text-lg px-10 py-7\">\n                Find a Family-Friendly Cleaner\n              </Button>\n            </Link>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Safety for Families */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-4 text-center\">\n              Safety First, Always\n            </h2>\n            <p className=\"text-xl text-slate-600 text-center mb-16\">\n              When kids are involved, there is no room for shortcuts\n            </p>\n\n            <div className=\"grid md:grid-cols-2 gap-8\">\n              {[\n                {\n                  icon: Shield,\n                  title: 'Verified & Background Checked',\n                  description: 'Every cleaner passes comprehensive background checks and identity verification. We take safety seriously because you do.',\n                  badge: 'Required'\n                },\n                {\n                  icon: Baby,\n                  title: 'Child-Safe Products',\n                  description: 'Filter for cleaners who use non-toxic, child-safe cleaning products. No harsh chemicals around your kids.',\n                  badge: 'Pet & kid friendly'\n                },\n                {\n                  icon: Star,\n                  title: 'Family-Reviewed',\n                  description: 'See reviews specifically from other families. Know which cleaners are patient, careful, and kid-friendly.',\n                  badge: 'Real feedback'\n                },\n                {\n                  icon: Home,\n                  title: 'Track Everything',\n                  description: 'GPS check-in/out and photo proof mean you always know who is in your home and what they are doing.',\n                  badge: 'Full visibility'\n                }\n              ].map((feature, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"h-full border-0 shadow-lg\">\n                    <CardContent className=\"p-8\">\n                      <div className=\"flex items-start gap-4 mb-4\">\n                        <div className=\"w-14 h-14 bg-gradient-to-r from-pink-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg\">\n                          <feature.icon className=\"w-7 h-7 text-white\" />\n                        </div>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <h3 className=\"text-xl font-bold text-slate-900\">{feature.title}</h3>\n                          </div>\n                          <p className=\"text-slate-600 leading-relaxed mb-3\">{feature.description}</p>\n                          <Badge className=\"bg-pink-100 text-pink-800\">\n                            {feature.badge}\n                          </Badge>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Special Features for Families */}\n      <section className=\"py-20 bg-gradient-to-br from-pink-50 to-purple-50\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-16 text-center\">\n              Features Families Love\n            </h2>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              {[\n                {\n                  icon: AlertTriangle,\n                  title: 'Allergy-Conscious Cleaning',\n                  description: 'Specify allergies and product sensitivities. Our cleaners come prepared with safe alternatives.'\n                },\n                {\n                  icon: Users,\n                  title: 'Same Cleaner Every Time',\n                  description: 'Kids feel comfortable with familiar faces. Book the same trusted cleaner for recurring service.'\n                },\n                {\n                  icon: Clock,\n                  title: 'Flexible Scheduling',\n                  description: 'Book during school hours, weekends, or whenever works for your family routine.'\n                },\n                {\n                  icon: Home,\n                  title: 'Kid & Pet-Friendly Options',\n                  description: 'Filter for cleaners experienced with children and pets. They get it.'\n                },\n                {\n                  icon: Calendar,\n                  title: 'Recurring Discounts',\n                  description: 'Save 20% with weekly or bi-weekly subscriptions. One less thing to remember.'\n                },\n                {\n                  icon: Award,\n                  title: 'Quality Guarantee',\n                  description: 'Not satisfied? We will send someone to re-clean for free or issue automatic credits.'\n                }\n              ].map((feature, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"h-full border-0 shadow-md hover:shadow-lg transition-all\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start gap-4\">\n                        <div className=\"w-10 h-10 bg-gradient-to-r from-pink-500 to-purple-600 rounded-lg flex items-center justify-center flex-shrink-0\">\n                          <feature.icon className=\"w-5 h-5 text-white\" />\n                        </div>\n                        <div>\n                          <h3 className=\"font-bold text-slate-900 mb-1\">{feature.title}</h3>\n                          <p className=\"text-sm text-slate-600\">{feature.description}</p>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Testimonial */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-4xl mx-auto\">\n            <Card className=\"border-0 shadow-2xl\">\n              <CardContent className=\"p-12\">\n                <div className=\"flex mb-6\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"w-6 h-6 fill-amber-400 text-amber-400\" />\n                  ))}\n                </div>\n                <blockquote className=\"text-2xl font-semibold text-slate-900 mb-6 leading-relaxed\">\n                  \"With two kids under 5, keeping the house clean felt impossible. Now Maria comes every Tuesday \n                  while the kids are at daycare. The photo updates are amazing‚ÄîI can see it is done even when I am at work.\"\n                </blockquote>\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-14 h-14 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-xl\">\n                    E\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-slate-900\">Emily Rodriguez</p>\n                    <p className=\"text-sm text-slate-500\">Working Mom, Sacramento</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Common Questions */}\n      <section className=\"py-20 bg-gradient-to-br from-slate-50 to-slate-100\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-4xl mx-auto\">\n            <h2 className=\"text-3xl font-bold text-slate-900 mb-12 text-center\">\n              Questions from Parents\n            </h2>\n\n            <div className=\"space-y-4\">\n              {[\n                {\n                  q: 'Can I request cleaners with child-safe products?',\n                  a: 'Absolutely. Use the \"Child-Safe Products\" filter when browsing cleaners. You can also note specific allergies or sensitivities.'\n                },\n                {\n                  q: 'What if my kids are home during the cleaning?',\n                  a: 'Many cleaners are comfortable working with kids present. Check their profile for \"Senior-Friendly\" and \"Child-Safe\" badges.'\n                },\n                {\n                  q: 'Do I need to be home?',\n                  a: 'Nope! GPS check-in/out and photo proof mean you can verify everything remotely. Many working parents book during school hours.'\n                },\n                {\n                  q: 'What if my cleaner cancels last-minute?',\n                  a: 'Our backup system automatically finds a replacement. You will get notified immediately with options.'\n                }\n              ].map((item, idx) => (\n                <Card key={idx} className=\"border-0 shadow-md\">\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"font-bold text-slate-900 mb-2\">{item.q}</h3>\n                    <p className=\"text-slate-600\">{item.a}</p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA */}\n      <section className=\"py-20 bg-gradient-to-r from-pink-500 to-purple-600 text-white\">\n        <div className=\"container mx-auto px-6 text-center\">\n          <h2 className=\"text-4xl font-bold mb-6\">\n            Give Your Family the Gift of a Clean Home\n          </h2>\n          <p className=\"text-xl text-pink-50 mb-10 max-w-2xl mx-auto\">\n            Verified, safe cleaners who understand families\n          </p>\n          <Link to={createPageUrl('BrowseCleaners')}>\n            <Button size=\"lg\" className=\"bg-white text-pink-600 hover:bg-pink-50 shadow-xl text-lg px-10 py-7\">\n              <Sparkles className=\"w-5 h-5 mr-2\" />\n              Book Your First Cleaning\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ForProfessionals.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":9,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":23,"fix":{"range":[335,347],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[334,346],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Briefcase, Clock, Shield, Zap, CheckCircle, Star,\n  Calendar, TrendingUp, Coffee, Laptop\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function ForProfessionals() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100\">\n      {/* Hero */}\n      <section className=\"relative overflow-hidden bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-20\">\n        <div className=\"container mx-auto px-6 relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-4xl mx-auto text-center\"\n          >\n            <Badge className=\"mb-6 bg-white/20 text-white border-white/30 text-lg px-6 py-2\">\n              <Briefcase className=\"w-5 h-5 mr-2\" />\n              For Busy Professionals\n            </Badge>\n            <h1 className=\"text-5xl lg:text-6xl font-bold mb-6\">\n              More Time for What Matters\n            </h1>\n            <p className=\"text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-blue-50\">\n              You work hard. Let verified, reliable cleaners handle your home so you can focus on your career, family, and life.\n            </p>\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"bg-white text-blue-600 hover:bg-blue-50 shadow-xl text-lg px-10 py-7\">\n                Book Your First Cleaning\n              </Button>\n            </Link>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Problem/Solution */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-3xl font-bold text-slate-900 mb-12 text-center\">\n              We Get It‚ÄîYour Time is Precious\n            </h2>\n\n            <div className=\"grid md:grid-cols-2 gap-8 mb-12\">\n              <Card className=\"border-2 border-slate-200\">\n                <CardContent className=\"p-8\">\n                  <h3 className=\"text-xl font-bold text-slate-900 mb-4\">üòì Your Current Reality</h3>\n                  <ul className=\"space-y-3 text-slate-600\">\n                    <li>‚Ä¢ Spending weekends cleaning instead of relaxing</li>\n                    <li>‚Ä¢ Wondering if your cleaner will actually show up</li>\n                    <li>‚Ä¢ No time to vet or interview cleaners yourself</li>\n                    <li>‚Ä¢ Stressed about leaving strangers in your home</li>\n                    <li>‚Ä¢ Can't track if the work was actually done</li>\n                  </ul>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50\">\n                <CardContent className=\"p-8\">\n                  <h3 className=\"text-xl font-bold text-emerald-900 mb-4\">‚ú® With PureTask</h3>\n                  <ul className=\"space-y-3 text-slate-700\">\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                      <span>Book in 3 minutes, from your phone or laptop</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                      <span>GPS notifications when cleaners arrive & leave</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                      <span>Every cleaner is background-checked & verified</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                      <span>Photo proof so you know it's done right</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                      <span>Automatic refunds if anything goes wrong</span>\n                    </li>\n                  </ul>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Features for Professionals */}\n      <section className=\"py-20 bg-gradient-to-br from-slate-50 to-slate-100\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-6xl mx-auto\">\n            <h2 className=\"text-3xl font-bold text-slate-900 mb-12 text-center\">\n              Built for Your Busy Schedule\n            </h2>\n\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              {[\n                {\n                  icon: Clock,\n                  title: 'Same-Day Booking',\n                  description: 'Need a clean home before guests arrive? Book verified cleaners for today.',\n                  color: 'blue'\n                },\n                {\n                  icon: Calendar,\n                  title: 'Recurring Service',\n                  description: 'Set it and forget it. Weekly or bi-weekly cleanings, same trusted cleaner.',\n                  color: 'emerald'\n                },\n                {\n                  icon: Laptop,\n                  title: 'Manage from Anywhere',\n                  description: 'Book, reschedule, or manage cleanings from your phone during your commute.',\n                  color: 'purple'\n                },\n                {\n                  icon: Shield,\n                  title: 'No-Risk Guarantee',\n                  description: 'Automatic credits for no-shows. Your payment is protected until work is verified.',\n                  color: 'amber'\n                },\n                {\n                  icon: Star,\n                  title: 'Reliability Scoring',\n                  description: 'Filter by top-rated cleaners. See exactly who shows up on time.',\n                  color: 'pink'\n                },\n                {\n                  icon: Coffee,\n                  title: 'White-Glove Options',\n                  description: 'Choose Elite-tier cleaners for premium service with pro-grade products.',\n                  color: 'cyan'\n                }\n              ].map((feature, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"h-full border-0 shadow-lg hover:shadow-xl transition-all\">\n                    <CardContent className=\"p-6\">\n                      <div className={`w-12 h-12 bg-gradient-to-r from-${feature.color}-500 to-${feature.color}-600 rounded-lg flex items-center justify-center mb-4 shadow-md`}>\n                        <feature.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      <h3 className=\"text-lg font-bold text-slate-900 mb-2\">{feature.title}</h3>\n                      <p className=\"text-slate-600 text-sm leading-relaxed\">{feature.description}</p>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Testimonial */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-4xl mx-auto\">\n            <Card className=\"border-0 shadow-2xl\">\n              <CardContent className=\"p-12\">\n                <div className=\"flex mb-6\">\n                  {[...Array(5)].map((_, i) => (\n                    <Star key={i} className=\"w-6 h-6 fill-amber-400 text-amber-400\" />\n                  ))}\n                </div>\n                <blockquote className=\"text-2xl font-semibold text-slate-900 mb-6 leading-relaxed\">\n                  \"As a consultant, I'm on the road constantly. PureTask's GPS tracking gives me peace of mind \n                  knowing my cleaner actually showed up and finished the job‚Äîeven when I'm 3,000 miles away.\"\n                </blockquote>\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-14 h-14 bg-gradient-to-br from-blue-400 to-cyan-500 rounded-full flex items-center justify-center text-white font-bold text-xl\">\n                    M\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-slate-900\">Michael Chen</p>\n                    <p className=\"text-sm text-slate-500\">Management Consultant, Sacramento</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA */}\n      <section className=\"py-20 bg-gradient-to-r from-blue-500 to-indigo-600 text-white\">\n        <div className=\"container mx-auto px-6 text-center\">\n          <h2 className=\"text-4xl font-bold mb-6\">\n            Reclaim Your Weekends\n          </h2>\n          <p className=\"text-xl text-blue-50 mb-10 max-w-2xl mx-auto\">\n            Professional cleaning that works with your schedule, not against it\n          </p>\n          <Link to={createPageUrl('BrowseCleaners')}>\n            <Button size=\"lg\" className=\"bg-white text-blue-600 hover:bg-blue-50 shadow-xl text-lg px-10 py-7\">\n              <Zap className=\"w-5 h-5 mr-2\" />\n              Find Your Cleaner\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ForRetirees.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\GrowthDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15,"fix":{"range":[228,275],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[228,274],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { UserPlus, TrendingUp, Users, Repeat, Loader2 } from 'lucide-react';\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } from 'recharts';\n\nexport default function GrowthDashboard() {\n  const [loading, setLoading] = useState(true);\n  const [dailyData, setDailyData] = useState([]);\n  const [funnelData, setFunnelData] = useState([]);\n  const [subscriptionData, setSubscriptionData] = useState(null);\n  const [membershipData, setMembershipData] = useState(null);\n\n  useEffect(() => {\n    loadDashboard();\n  }, []);\n\n  const loadDashboard = async () => {\n    try {\n      const [daily, analytics, subAnalytics, memAnalytics] = await Promise.all([\n        base44.entities.PlatformAnalyticsDaily.list('-created_date', 30),\n        base44.entities.AnalyticsEvent.list('-created_date', 100),\n        base44.entities.SubscriptionAnalytics.filter({ id: 'global_subscription_stats' }),\n        base44.entities.MembershipAnalytics.filter({ id: 'global_membership_stats' })\n      ]);\n      \n      setDailyData(daily.reverse());\n      setSubscriptionData(subAnalytics[0] || null);\n      setMembershipData(memAnalytics[0] || null);\n      \n      // Build funnel\n      const signups = analytics.filter(e => e.event_type === 'client_signup_success').length;\n      const firstBookings = analytics.filter(e => e.event_type === 'first_booking_completed').length;\n      const repeatBookings = analytics.filter(e => e.event_type === 'repeat_booking').length;\n      const subscriptions = analytics.filter(e => e.event_type === 'subscription_started').length;\n      \n      setFunnelData([\n        { stage: 'Signups', count: signups },\n        { stage: 'First Booking', count: firstBookings },\n        { stage: 'Repeat Booking', count: repeatBookings },\n        { stage: 'Subscriptions', count: subscriptions }\n      ]);\n      \n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading growth dashboard:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const totalNewClients = dailyData.reduce((sum, d) => sum + (d.new_clients || 0), 0);\n  const totalNewCleaners = dailyData.reduce((sum, d) => sum + (d.new_cleaners || 0), 0);\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Growth Dashboard</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">User acquisition & engagement metrics</p>\n        </div>\n\n        {/* Growth KPIs */}\n        <div className=\"grid md:grid-cols-4 gap-6\">\n          <Card className=\"border-2 border-blue-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">New Clients (30d)</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-8 h-8 text-puretask-blue\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">{totalNewClients}</p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-green-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">New Cleaners (30d)</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"w-8 h-8 text-fresh-mint\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">{totalNewCleaners}</p>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-purple-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Active Subscriptions</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <Repeat className=\"w-8 h-8 text-purple-600\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {subscriptionData?.active_subscriptions || 0}\n                </p>\n              </div>\n              <p className=\"text-xs text-gray-500 font-verdana mt-2\">\n                ${subscriptionData?.subscription_mrr_usd?.toLocaleString() || 0} MRR\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-2 border-amber-200\">\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"text-sm font-verdana text-gray-600\">Active Memberships</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-2\">\n                <TrendingUp className=\"w-8 h-8 text-amber-600\" />\n                <p className=\"text-3xl font-fredoka font-bold text-graphite\">\n                  {membershipData?.active_memberships || 0}\n                </p>\n              </div>\n              <p className=\"text-xs text-gray-500 font-verdana mt-2\">\n                ${membershipData?.membership_mrr_usd?.toLocaleString() || 0} MRR\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* User Growth Chart */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">User Growth (30 Days)</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={dailyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                <YAxis tick={{ fontSize: 12 }} />\n                <Tooltip />\n                <Legend />\n                <Line type=\"monotone\" dataKey=\"new_clients\" stroke=\"#66B3FF\" name=\"New Clients\" strokeWidth={2} />\n                <Line type=\"monotone\" dataKey=\"new_cleaners\" stroke=\"#28C76F\" name=\"New Cleaners\" strokeWidth={2} />\n              </LineChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        {/* Conversion Funnel */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">Conversion Funnel</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <BarChart data={funnelData} layout=\"horizontal\">\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis type=\"number\" />\n                <YAxis dataKey=\"stage\" type=\"category\" width={120} />\n                <Tooltip />\n                <Bar dataKey=\"count\" fill=\"#66B3FF\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        {/* Subscription & Membership Growth */}\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl\">Subscription Metrics</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex justify-between items-center p-3 bg-blue-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Active Subscriptions</span>\n                <span className=\"font-fredoka font-bold text-lg text-puretask-blue\">\n                  {subscriptionData?.active_subscriptions || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-green-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">New (7d)</span>\n                <span className=\"font-fredoka font-bold text-lg text-fresh-mint\">\n                  +{subscriptionData?.new_subscriptions_7d || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-red-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Cancelled (7d)</span>\n                <span className=\"font-fredoka font-bold text-lg text-red-600\">\n                  -{subscriptionData?.cancelled_subscriptions_7d || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-purple-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Monthly Recurring Revenue</span>\n                <span className=\"font-fredoka font-bold text-lg text-purple-600\">\n                  ${subscriptionData?.subscription_mrr_usd?.toLocaleString() || 0}\n                </span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-xl\">Membership Metrics</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex justify-between items-center p-3 bg-blue-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Active Memberships</span>\n                <span className=\"font-fredoka font-bold text-lg text-puretask-blue\">\n                  {membershipData?.active_memberships || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-green-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">New (7d)</span>\n                <span className=\"font-fredoka font-bold text-lg text-fresh-mint\">\n                  +{membershipData?.new_memberships_7d || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-red-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Cancelled (7d)</span>\n                <span className=\"font-fredoka font-bold text-lg text-red-600\">\n                  -{membershipData?.cancelled_memberships_7d || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between items-center p-3 bg-purple-50 rounded-lg\">\n                <span className=\"font-verdana text-sm text-gray-700\">Monthly Recurring Revenue</span>\n                <span className=\"font-fredoka font-bold text-lg text-purple-600\">\n                  ${membershipData?.membership_mrr_usd?.toLocaleString() || 0}\n                </span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Home.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15,"fix":{"range":[500,507],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[501,507],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":11,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":33,"fix":{"range":[506,524],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[506,524],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":12,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":40,"fix":{"range":[590,597],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[589,596],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":12,"column":80,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":86,"fix":{"range":[635,643],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[634,642],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":12,"column":96,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":99,"fix":{"range":[651,656],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[650,655],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":12,"column":159,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":170,"fix":{"range":[714,727],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[713,726],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Loader2' is defined but never used.","line":12,"column":172,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":179,"fix":{"range":[727,736],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Loader2"},"fix":{"range":[726,735],"text":""},"desc":"Remove unused variable 'Loader2'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":64,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":19}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":7,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Slider } from '@/components/ui/slider';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Sparkles, Shield, Clock, Award, Star, CheckCircle, TrendingUp, Users, MapPin, Camera, Zap, Calendar, Briefcase, Home as HomeIcon, Heart, ArrowRight, AlertCircle, Loader2, Repeat } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport ImageCarousel from '@/components/home/ImageCarousel';\nimport AddressAutocomplete from '@/components/address/AddressAutocomplete';\n\nexport default function Home() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [bookingData, setBookingData] = useState({\n    address: '',\n    latitude: null,\n    longitude: null,\n    serviceType: 'basic',\n    bedrooms: '2',\n    bathrooms: '2',\n    squareFeet: 1500,\n    recommendedHours: 3,\n    date: '',\n    time: ''\n  });\n\n  useEffect(() => {\n    let isMounted = true;\n    \n    const initialize = async () => {\n      try {\n        if (isMounted) {\n          await checkUser();\n          // Load draft from localStorage if exists\n          const savedDraft = localStorage.getItem('bookingDraft');\n          if (savedDraft && isMounted) {\n            setBookingData(JSON.parse(savedDraft));\n          }\n        }\n      } catch (error) {\n        if (isMounted) {\n          handleError(error, { userMessage: 'Error loading home:', showToast: false });\n        }\n      }\n    };\n    \n    initialize();\n    \n    return () => {\n      isMounted = false;\n    };\n  }, []); // Empty array - only run once on mount\n\n  const checkUser = async () => {\n    try {\n      const currentUser = await base44.auth.me().catch(() => null);\n      setUser(currentUser);\n    } catch (error) {\n      // User not logged in - this is fine for Home page\n      setUser(null);\n    }\n  };\n\n  const handleBooking = (e) => {\n    e.preventDefault();\n\n    if (!bookingData.address || !bookingData.latitude || !bookingData.longitude) {\n      alert('Please select a valid address from the dropdown suggestions');\n      return;\n    }\n\n    if (!bookingData.date || !bookingData.time) {\n      alert('Please select both date and time');\n      return;\n    }\n\n    // Save booking data to localStorage\n    localStorage.setItem('bookingDraft', JSON.stringify(bookingData));\n\n    // Always go to browse cleaners first\n    // Users can browse without logging in\n    navigate(createPageUrl('BrowseCleaners'));\n  };\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* Hero Section with Booking Form */}\n      <section className=\"relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-cyan-50\">\n        <div className=\"container mx-auto px-3 sm:px-6 py-8 sm:py-12 lg:py-16 max-w-full\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.8 }}\n            className=\"max-w-7xl mx-auto\"\n          >\n            {/* Header */}\n            <div className=\"text-center mb-6 sm:mb-8\">\n              <Badge className=\"mb-3 sm:mb-4 text-sm sm:text-base px-3 sm:px-5 py-1.5 sm:py-2 rounded-full font-fredoka border-2 bg-white shadow-md\" style={{ color: '#66B3FF', borderColor: '#66B3FF' }}>\n                <Shield className=\"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2\" />\n                Verified & Trusted Platform\n              </Badge>\n              <h1 className=\"text-2xl sm:text-3xl lg:text-5xl font-fredoka font-bold mb-2 sm:mb-3 leading-tight text-graphite px-2\">\n                Book a Trusted Cleaner in Minutes\n              </h1>\n              <p className=\"text-sm sm:text-base lg:text-lg max-w-2xl mx-auto leading-relaxed font-verdana text-gray-600 px-2\">\n                Professional cleaning with GPS tracking, photo proof, and verified cleaners\n              </p>\n            </div>\n\n            {/* Two Column Layout */}\n            <div className=\"grid lg:grid-cols-2 gap-6 sm:gap-8 mb-8 sm:mb-12\">\n              {/* Left Column - Image Carousel */}\n              <div className=\"hidden lg:block\">\n                <ImageCarousel />\n              </div>\n\n              {/* Right Column - Booking Form */}\n              <Card className=\"border-2 border-blue-200 shadow-2xl rounded-xl sm:rounded-2xl bg-white\">\n                <CardContent className=\"p-4 sm:p-6 lg:p-8\">\n                <form onSubmit={handleBooking} className=\"space-y-6\">\n                  {/* Address Section */}\n                  <div className=\"space-y-3\">\n                    <AddressAutocomplete\n                      value={bookingData.address}\n                      onChange={(address) => {\n                        setBookingData({\n                          ...bookingData,\n                          address,\n                          latitude: null,\n                          longitude: null\n                        });\n                      }}\n                      onLocationSelect={(location) => {\n                        setBookingData({\n                          ...bookingData,\n                          address: location.address,\n                          latitude: location.latitude,\n                          longitude: location.longitude\n                        });\n                      }}\n                      placeholder=\"Start typing your address...\"\n                      label=\"Your Address\"\n                      required\n                    />\n                    {bookingData.latitude && bookingData.longitude && (\n                      <div className=\"flex items-center gap-2 text-sm text-green-600 font-verdana\">\n                        <CheckCircle className=\"w-4 h-4\" />\n                        Address verified ‚úì\n                      </div>\n                    )}\n                  </div>\n\n                  {/* SERVICE TYPE - MAJOR FOCUS */}\n                  <div className=\"p-4 sm:p-6 border-4 border-system rounded-2xl bg-system-soft shadow-lg\">\n                    <label className=\"block text-base sm:text-lg font-heading font-bold mb-3 sm:mb-4 text-graphite flex items-center gap-2\">\n                      <Sparkles className=\"w-5 h-5 sm:w-6 sm:h-6 text-system\" />\n                      Service Type *\n                    </label>\n                    <div className=\"grid grid-cols-1 gap-3\">\n                      {[\n                        { value: 'basic', label: 'Basic Cleaning', desc: 'Standard cleaning service', price: '', borderColor: 'border-blue-600', textColor: 'text-blue-600' },\n                        { value: 'deep', label: 'Deep Cleaning', desc: 'Thorough, detailed cleaning', price: '+$5-8/hr', borderColor: 'border-amber-500', textColor: 'text-amber-600' },\n                        { value: 'moveout', label: 'Move-Out Cleaning', desc: 'Get your deposit back', price: '+$5-8/hr', borderColor: 'border-purple-500', textColor: 'text-purple-600' }\n                      ].map((service) => (\n                        <button\n                          key={service.value}\n                          type=\"button\"\n                          onClick={() => setBookingData({...bookingData, serviceType: service.value})}\n                          className={`p-3 sm:p-4 rounded-xl text-left transition-all font-verdana ${\n                            bookingData.serviceType === service.value\n                              ? `border-4 ${service.borderColor} bg-white shadow-lg scale-105`\n                              : `border-2 ${service.borderColor} bg-white hover:shadow-md`\n                          }`}\n                        >\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <p className={`font-fredoka font-bold text-sm sm:text-base ${bookingData.serviceType === service.value ? service.textColor : 'text-graphite'} truncate`}>\n                                {service.label}\n                              </p>\n                              <p className=\"text-xs sm:text-sm text-gray-600\">{service.desc}</p>\n                            </div>\n                            {service.price && (\n                              <Badge className=\"bg-amber-100 text-amber-800 font-fredoka text-xs whitespace-nowrap flex-shrink-0\">{service.price}</Badge>\n                            )}\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* CLEANING HOURS - MAJOR FOCUS */}\n                  <div className=\"p-6 border-4 border-green-500 rounded-2xl bg-green-50 shadow-lg\">\n                    <label className=\"block text-lg font-fredoka font-bold mb-4 text-graphite flex items-center gap-2\">\n                      <Clock className=\"w-6 h-6 text-green-600\" />\n                      How Many Hours? *\n                    </label>\n                    <div className=\"text-center mb-4\">\n                      <p className=\"text-5xl font-fredoka font-bold text-green-600 mb-2\">\n                        {bookingData.recommendedHours}\n                      </p>\n                      <p className=\"text-lg font-fredoka text-graphite\">hour{bookingData.recommendedHours > 1 ? 's' : ''}</p>\n                    </div>\n                    <div className=\"grid grid-cols-5 gap-2 mb-3\">\n                      {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((hours) => (\n                        <button\n                          key={hours}\n                          type=\"button\"\n                          onClick={() => setBookingData({...bookingData, recommendedHours: hours})}\n                          className={`h-14 rounded-xl font-fredoka font-bold text-lg transition-all border-2 ${\n                            bookingData.recommendedHours === hours\n                              ? 'bg-green-500 text-white border-green-600 shadow-lg scale-110'\n                              : 'bg-white text-gray-700 hover:bg-green-100 border-gray-300'\n                          }`}\n                        >\n                          {hours}\n                        </button>\n                      ))}\n                    </div>\n                    <p className=\"text-xs text-gray-600 font-verdana text-center\">\n                      üí° Typical: 2-4 hrs ‚Ä¢ Deep clean: 4-8 hrs\n                    </p>\n                  </div>\n\n                  {/* DATE & TIME - HIGHLIGHTED */}\n                  <div className=\"p-6 border-4 border-amber-500 rounded-2xl bg-amber-50 shadow-lg\">\n                    <label className=\"block text-lg font-fredoka font-bold mb-4 text-graphite flex items-center gap-2\">\n                      <Calendar className=\"w-6 h-6 text-amber-600\" />\n                      When Do You Need Cleaning? *\n                    </label>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-base font-fredoka font-bold mb-2 text-graphite\">\n                          Date *\n                        </label>\n                        <Input\n                          required\n                          type=\"date\"\n                          value={bookingData.date}\n                          onChange={(e) => setBookingData({...bookingData, date: e.target.value})}\n                          min={new Date().toISOString().split('T')[0]}\n                          className=\"font-verdana border-3 h-14 text-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-base font-fredoka font-bold mb-2 text-graphite\">\n                          Time *\n                        </label>\n                        <select \n                          value={bookingData.time} \n                          onChange={(e) => setBookingData({...bookingData, time: e.target.value})}\n                          className=\"w-full rounded-xl font-verdana border-3 h-14 text-lg font-semibold px-4\"\n                          required\n                        >\n                          <option value=\"\">Pick time</option>\n                          <option value=\"08:00\">8:00 AM</option>\n                          <option value=\"08:30\">8:30 AM</option>\n                          <option value=\"09:00\">9:00 AM</option>\n                          <option value=\"09:30\">9:30 AM</option>\n                          <option value=\"10:00\">10:00 AM</option>\n                          <option value=\"10:30\">10:30 AM</option>\n                          <option value=\"11:00\">11:00 AM</option>\n                          <option value=\"11:30\">11:30 AM</option>\n                          <option value=\"12:00\">12:00 PM</option>\n                          <option value=\"12:30\">12:30 PM</option>\n                          <option value=\"13:00\">1:00 PM</option>\n                          <option value=\"13:30\">1:30 PM</option>\n                          <option value=\"14:00\">2:00 PM</option>\n                          <option value=\"14:30\">2:30 PM</option>\n                          <option value=\"15:00\">3:00 PM</option>\n                          <option value=\"15:30\">3:30 PM</option>\n                          <option value=\"16:00\">4:00 PM</option>\n                          <option value=\"16:30\">4:30 PM</option>\n                        </select>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Home Details */}\n                  <div className=\"space-y-4\">\n                    <label className=\"block text-sm font-fredoka font-semibold text-graphite\">\n                      Additional Details\n                    </label>\n                    \n                    {/* Square Feet */}\n                    <div>\n                      <label className=\"block text-xs font-fredoka font-semibold mb-2 text-gray-600\">\n                        Home Size: <span className=\"text-puretask-blue\">{bookingData.squareFeet.toLocaleString()} sq ft</span>\n                      </label>\n                      <Slider\n                        value={[bookingData.squareFeet]}\n                        onValueChange={(value) => setBookingData({...bookingData, squareFeet: value[0]})}\n                        min={500}\n                        max={6000}\n                        step={100}\n                        className=\"w-full\"\n                      />\n                      <div className=\"flex justify-between text-xs text-gray-400 font-verdana mt-1\">\n                        <span>500</span>\n                        <span>6,000</span>\n                      </div>\n                    </div>\n\n                    {/* Bedrooms & Bathrooms */}\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div>\n                        <label className=\"block text-xs font-fredoka font-semibold mb-2 text-gray-600\">\n                          Bedrooms\n                        </label>\n                        <select \n                          value={bookingData.bedrooms} \n                          onChange={(e) => setBookingData({...bookingData, bedrooms: e.target.value})}\n                          className=\"w-full rounded-lg font-verdana border h-9 text-sm px-3\"\n                        >\n                          <option value=\"0\">Studio</option>\n                          <option value=\"1\">1 BR</option>\n                          <option value=\"2\">2 BR</option>\n                          <option value=\"3\">3 BR</option>\n                          <option value=\"4\">4 BR</option>\n                          <option value=\"5\">5+ BR</option>\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-xs font-fredoka font-semibold mb-2 text-gray-600\">\n                          Bathrooms\n                        </label>\n                        <select \n                          value={bookingData.bathrooms} \n                          onChange={(e) => setBookingData({...bookingData, bathrooms: e.target.value})}\n                          className=\"w-full rounded-lg font-verdana border h-9 text-sm px-3\"\n                        >\n                          <option value=\"1\">1 BA</option>\n                          <option value=\"1.5\">1.5 BA</option>\n                          <option value=\"2\">2 BA</option>\n                          <option value=\"2.5\">2.5 BA</option>\n                          <option value=\"3\">3 BA</option>\n                          <option value=\"4\">4+ BA</option>\n                        </select>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Submit Buttons - LARGE & VISIBLE */}\n                  <div className=\"grid grid-cols-1 gap-3\">\n                    <Button \n                      type=\"submit\"\n                      className=\"w-full text-xl py-8 rounded-2xl font-fredoka font-bold shadow-2xl hover:shadow-3xl transition-all\"\n                      style={{ \n                        background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)',\n                        color: 'white',\n                        border: '3px solid #0078FF'\n                      }}\n                    >\n                      Find Available Cleaners\n                      <ArrowRight className=\"w-6 h-6 ml-2\" />\n                    </Button>\n                    \n                    <Button\n                      type=\"button\"\n                      onClick={() => navigate(createPageUrl('MultiBooking'))}\n                      className=\"w-full text-lg py-6 rounded-2xl font-fredoka font-bold border-2 shadow-lg hover:shadow-xl transition-all\"\n                      style={{\n                        background: 'linear-gradient(135deg, #9333EA 0%, #EC4899 100%)',\n                        color: 'white',\n                        border: '2px solid #7E22CE'\n                      }}\n                    >\n                      <Repeat className=\"w-5 h-5 mr-2\" />\n                      Book Multiple Dates & Save\n                    </Button>\n                  </div>\n\n                  {!user && (\n                    <p className=\"text-center text-sm text-gray-600 font-verdana mt-2\">\n                      Don't worry - you'll create an account in the next step\n                    </p>\n                  )}\n                </form>\n\n                {/* Trust Indicators Below Form */}\n                <div className=\"mt-6 pt-6 border-t-2 border-blue-200\">\n                  <div className=\"flex flex-wrap justify-center gap-6 text-sm font-verdana font-semibold text-graphite\">\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span>GPS Tracking</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span>Photo Proof</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span>Pay After Approval</span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n            </div>\n\n            {/* Stats Below Form */}\n            <div className=\"grid grid-cols-3 gap-3 sm:gap-6 max-w-3xl mx-auto\">\n              <Card className=\"text-center border-3 bg-white shadow-lg hover:shadow-xl transition-all\" style={{ borderColor: '#66B3FF' }}>\n                <CardContent className=\"p-3 sm:p-5 flex flex-col items-center justify-center\">\n                  <p className=\"text-3xl sm:text-4xl font-fredoka font-bold mb-1\" style={{ color: '#66B3FF' }}>500+</p>\n                  <p className=\"text-xs sm:text-sm font-verdana font-semibold text-graphite text-center\">Verified Cleaners</p>\n                </CardContent>\n              </Card>\n              <Card className=\"text-center border-3 bg-white shadow-lg hover:shadow-xl transition-all\" style={{ borderColor: '#28C76F' }}>\n                <CardContent className=\"p-3 sm:p-5 flex flex-col items-center justify-center\">\n                  <p className=\"text-3xl sm:text-4xl font-fredoka font-bold mb-1\" style={{ color: '#28C76F' }}>10k+</p>\n                  <p className=\"text-xs sm:text-sm font-verdana font-semibold text-graphite text-center\">Jobs Completed</p>\n                </CardContent>\n              </Card>\n              <Card className=\"text-center border-3 bg-white shadow-lg hover:shadow-xl transition-all\" style={{ borderColor: '#F59E0B' }}>\n                <CardContent className=\"p-3 sm:p-5 flex flex-col items-center justify-center\">\n                  <p className=\"text-3xl sm:text-4xl font-fredoka font-bold mb-1\" style={{ color: '#F59E0B' }}>4.9‚òÖ</p>\n                  <p className=\"text-xs sm:text-sm font-verdana font-semibold text-graphite text-center\">Average Rating</p>\n                </CardContent>\n              </Card>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Trust Badges Section */}\n      <section className=\"py-8 sm:py-12 bg-white border-y-2 border-gray-300\">\n        <div className=\"container mx-auto px-3 sm:px-6 max-w-full overflow-hidden\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-6 max-w-4xl mx-auto\">\n            <Card className=\"border-2 border-puretask-blue bg-blue-50 shadow-md hover:shadow-lg transition-all\">\n              <CardContent className=\"p-4 text-center\">\n                <Shield className=\"w-8 h-8 text-puretask-blue mx-auto mb-2\" />\n                <span className=\"font-fredoka font-bold text-graphite text-sm block\">Background Checked</span>\n              </CardContent>\n            </Card>\n            <Card className=\"border-2 border-fresh-mint bg-green-50 shadow-md hover:shadow-lg transition-all\">\n              <CardContent className=\"p-4 text-center\">\n                <CheckCircle className=\"w-8 h-8 text-fresh-mint mx-auto mb-2\" />\n                <span className=\"font-fredoka font-bold text-graphite text-sm block\">Identity Verified</span>\n              </CardContent>\n            </Card>\n            <Card className=\"border-2 border-amber-500 bg-amber-50 shadow-md hover:shadow-lg transition-all\">\n              <CardContent className=\"p-4 text-center\">\n                <Star className=\"w-8 h-8 text-amber-500 mx-auto mb-2\" />\n                <span className=\"font-fredoka font-bold text-graphite text-sm block\">Rated by Clients</span>\n              </CardContent>\n            </Card>\n            <Card className=\"border-2 border-purple-500 bg-purple-50 shadow-md hover:shadow-lg transition-all\">\n              <CardContent className=\"p-4 text-center\">\n                <Camera className=\"w-8 h-8 text-purple-600 mx-auto mb-2\" />\n                <span className=\"font-fredoka font-bold text-graphite text-sm block\">Photo Proof</span>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Key Features Section */}\n      <section className=\"py-12 sm:py-24 bg-white\">\n        <div className=\"container mx-auto px-3 sm:px-6 max-w-full overflow-hidden\">\n          <div className=\"text-center mb-8 sm:mb-16\">\n            <h2 className=\"text-2xl sm:text-4xl lg:text-5xl font-fredoka font-bold mb-3 sm:mb-4 text-graphite px-2\">\n              Why Choose PureTask?\n            </h2>\n            <p className=\"text-base sm:text-xl text-gray-600 max-w-2xl mx-auto font-verdana px-2\">\n              The most trusted platform for premium cleaning services\n            </p>\n          </div>\n          \n          <div className=\"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-8\">\n            {[\n              {\n                icon: Shield,\n                title: 'Verified Cleaners',\n                description: 'Full KYC, background checks, and identity verification for every cleaner',\n                bgColor: '#EFF6FF',\n                iconBg: '#66B3FF',\n                textColor: '#66B3FF',\n                borderColor: '#93C5FD'\n              },\n              {\n                icon: TrendingUp,\n                title: 'Reliability Scoring',\n                description: 'Dynamic ratings based on punctuality, quality, and professionalism',\n                bgColor: '#F0FDF4',\n                iconBg: '#28C76F',\n                textColor: '#28C76F',\n                borderColor: '#86EFAC'\n              },\n              {\n                icon: Clock,\n                title: 'GPS Check-In/Out',\n                description: 'Real-time tracking ensures cleaners arrive and complete on time',\n                bgColor: '#ECFEFF',\n                iconBg: '#00D4FF',\n                textColor: '#00D4FF',\n                borderColor: '#67E8F9'\n              },\n              {\n                icon: Camera,\n                title: 'Photo Proof',\n                description: 'Before/after photos for every job guarantee quality results',\n                bgColor: '#FFFBEB',\n                iconBg: '#F59E0B',\n                textColor: '#D97706',\n                borderColor: '#FCD34D'\n              }\n            ].map((feature, idx) => (\n              <motion.div\n                key={idx}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.1 }}\n              >\n                <Card className=\"h-full border-2 shadow-lg hover:shadow-xl transition-all duration-300 rounded-2xl\" style={{ backgroundColor: feature.bgColor, borderColor: feature.borderColor }}>\n                  <CardContent className=\"p-6 sm:p-8 text-center\">\n                    <div className=\"w-12 h-12 sm:w-14 sm:h-14 rounded-2xl flex items-center justify-center mb-3 sm:mb-4 shadow-lg border-2 border-white mx-auto\" style={{ backgroundColor: feature.iconBg }}>\n                      <feature.icon className=\"w-6 h-6 sm:w-7 sm:h-7 text-white\" />\n                    </div>\n                    <h3 className=\"text-lg sm:text-xl font-fredoka font-bold mb-2 sm:mb-3\" style={{ color: feature.textColor }}>{feature.title}</h3>\n                    <p className=\"text-sm sm:text-base text-gray-600 leading-relaxed font-verdana\">{feature.description}</p>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n\n          <div className=\"text-center mt-12\">\n            <p className=\"text-lg font-fredoka font-semibold max-w-2xl mx-auto text-graphite\">\n              You're not just booking a cleaner ‚Äî you're booking a proven professional.\n            </p>\n          </div>\n        </div>\n      </section>\n\n      {/* Pricing Teaser */}\n      <section className=\"py-24 bg-gray-50\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl lg:text-5xl font-fredoka font-bold mb-4 text-graphite\">\n              Transparent Pricing\n            </h2>\n            <p className=\"text-xl text-gray-600 font-verdana\">No hidden fees, just quality service</p>\n            <p className=\"text-sm text-gray-500 mt-2 font-verdana\">üí° 10 credits = $1 USD</p>\n          </div>\n\n          <div className=\"grid md:grid-cols-4 gap-6 max-w-7xl mx-auto mb-16\">\n            {[\n              {\n                tier: 'Developing',\n                credits: '150-280',\n                usd: '$15-28',\n                bgColor: 'white',\n                borderColor: '#9CA3AF',\n                badgeBg: '#F3F4F6',\n                badgeText: '#374151'\n              },\n              {\n                tier: 'Semi Pro',\n                credits: '280-400',\n                usd: '$28-40',\n                bgColor: 'white',\n                borderColor: '#66B3FF',\n                badgeBg: '#DBEAFE',\n                badgeText: '#66B3FF'\n              },\n              {\n                tier: 'Pro',\n                credits: '400-550',\n                usd: '$40-55',\n                bgColor: 'white',\n                borderColor: '#66B3FF',\n                badgeBg: '#DBEAFE',\n                badgeText: '#66B3FF',\n                popular: true\n              },\n              {\n                tier: 'Elite',\n                credits: '550-750',\n                usd: '$55-75',\n                bgColor: 'white',\n                borderColor: '#FBBF24',\n                badgeBg: '#FEF3C7',\n                badgeText: '#92400E'\n              }\n            ].map((plan, idx) => (\n              <Card key={idx} className=\"hover:shadow-xl transition-all rounded-2xl relative border-2 shadow-md\" style={{ background: plan.bgColor, borderColor: plan.borderColor }}>\n                {plan.popular && (\n                  <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2\">\n                    <Badge className=\"px-4 py-1 font-fredoka rounded-full shadow-lg text-white border-2 border-white\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                      Most Popular\n                    </Badge>\n                  </div>\n                )}\n                <CardContent className=\"p-6 sm:p-8 text-center\">\n                  <Badge className=\"mb-3 sm:mb-4 font-fredoka rounded-full\" style={{ backgroundColor: plan.badgeBg, color: plan.badgeText }}>\n                    {plan.tier}\n                  </Badge>\n                  <p className=\"text-3xl sm:text-5xl font-fredoka font-bold mb-1 sm:mb-2 text-graphite\">{plan.usd}</p>\n                  <p className=\"text-xs sm:text-sm text-gray-600 mb-1 font-verdana\">/hour</p>\n                  <p className=\"text-xs text-gray-500 mb-4 sm:mb-6 font-verdana\">{plan.credits} credits</p>\n                  <ul className=\"text-left space-y-3 font-verdana\">\n                    <li className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span className=\"text-sm\">Verified cleaners</span>\n                    </li>\n                    <li className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span className=\"text-sm\">GPS tracking</span>\n                    </li>\n                    <li className=\"flex items-center gap-2\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                      <span className=\"text-sm\">Photo proof</span>\n                    </li>\n                    {plan.tier !== 'Developing' && (\n                      <li className=\"flex items-center gap-2\">\n                        <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                        <span className=\"text-sm\">Quality products</span>\n                      </li>\n                    )}\n                  </ul>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          <div className=\"text-center mt-12\">\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"text-lg px-10 py-6 rounded-full font-fredoka font-semibold shadow-xl hover:shadow-2xl text-white border-2 border-transparent\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                View All Cleaners\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Reliability Score Section */}\n      <section className=\"py-24 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl lg:text-5xl font-fredoka font-bold mb-4 text-graphite\">\n              Reliability Score = Peace of Mind\n            </h2>\n            <p className=\"text-xl text-gray-600 font-verdana italic max-w-3xl mx-auto\">\n              \"Because trust should be earned ‚Äî not assumed.\"\n            </p>\n          </div>\n\n          <div className=\"grid md:grid-cols-4 gap-8 max-w-6xl mx-auto\">\n            {[\n              {\n                icon: Clock,\n                title: 'On-Time Arrival',\n                description: 'GPS-verified check-ins track punctuality',\n                stat: '95%',\n                color: '#66B3FF',\n                bg: '#EFF6FF',\n                borderColor: '#93C5FD'\n              },\n              {\n                icon: Camera,\n                title: 'Before & After Photos',\n                description: 'Visual proof of quality work',\n                stat: '100%',\n                color: '#00D4FF',\n                bg: '#ECFEFF',\n                borderColor: '#67E8F9'\n              },\n              {\n                icon: Star,\n                title: 'Customer Satisfaction',\n                description: 'Real reviews from verified bookings',\n                stat: '4.9‚òÖ',\n                color: '#F59E0B',\n                bg: '#FFFBEB',\n                borderColor: '#FCD34D'\n              },\n              {\n                icon: CheckCircle,\n                title: 'Consistent Completion',\n                description: 'Track record of finished jobs',\n                stat: '98%',\n                color: '#28C76F',\n                bg: '#F0FDF4',\n                borderColor: '#86EFAC'\n              }\n            ].map((item, idx) => (\n              <motion.div\n                key={idx}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.1 }}\n              >\n                <Card className=\"h-full border-2 shadow-lg rounded-2xl\" style={{ backgroundColor: item.bg, borderColor: item.borderColor }}>\n                  <CardContent className=\"p-8 text-center\">\n                    <item.icon className=\"w-12 h-12 mx-auto mb-4\" style={{ color: item.color }} />\n                    <h3 className=\"text-xl font-fredoka font-bold mb-2 text-graphite\">{item.title}</h3>\n                    <p className=\"text-gray-600 font-verdana text-sm mb-4\">{item.description}</p>\n                    <p className=\"text-3xl font-fredoka font-bold\" style={{ color: item.color }}>{item.stat}</p>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n\n          <div className=\"text-center mt-12\">\n            <p className=\"text-lg font-fredoka font-semibold max-w-2xl mx-auto text-graphite\">\n              You're not just booking a cleaner ‚Äî you're booking a proven professional.\n            </p>\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works Section */}\n      <section className=\"py-24 bg-gray-50\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl lg:text-5xl font-fredoka font-bold mb-4 text-graphite\">\n              How It Works\n            </h2>\n            <p className=\"text-xl text-gray-600 font-verdana\">Simple, transparent, and reliable</p>\n          </div>\n\n          <div className=\"max-w-5xl mx-auto space-y-8\">\n            {[\n              { \n                step: 1, \n                title: 'Enter Your Details', \n                description: 'Fill out the form above with your address, service type, home size, and preferred date/time.',\n                icon: HomeIcon\n              },\n              { \n                step: 2, \n                title: 'Browse & Choose Your Cleaner', \n                description: 'View available cleaners based on your location and preferences. Compare reliability scores, rates, reviews, and specialties.',\n                icon: Users\n              },\n              { \n                step: 3, \n                title: 'Finalize Your Booking', \n                description: 'Confirm your cleaner, review pricing, add any special requests, and secure your booking with credits.',\n                icon: Calendar\n              },\n              { \n                step: 4, \n                title: 'Track & Approve', \n                description: 'Get GPS check-in notifications, view before/after photos, and approve the work to release payment.',\n                icon: Star\n              }\n            ].map((item, idx) => (\n              <motion.div\n                key={idx}\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                transition={{ delay: idx * 0.15 }}\n                className=\"flex gap-6 items-start\"\n              >\n                <div className=\"w-16 h-16 rounded-full flex items-center justify-center text-white font-fredoka font-bold text-2xl shadow-lg flex-shrink-0 border-2 border-white\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                  {item.step}\n                </div>\n                <Card className=\"flex-1 border-2 border-gray-300 shadow-md hover:shadow-lg transition-shadow rounded-2xl\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <item.icon className=\"w-6 h-6 text-puretask-blue\" />\n                      <h3 className=\"text-2xl font-fredoka font-bold text-graphite\">{item.title}</h3>\n                    </div>\n                    <p className=\"text-gray-600 leading-relaxed font-verdana\">{item.description}</p>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n\n          <div className=\"text-center mt-12\">\n            <Link to={createPageUrl('HowItWorks')}>\n              <Button size=\"lg\" variant=\"outline\" className=\"text-lg px-8 py-6 rounded-full font-fredoka border-2 shadow-md\">\n                Learn More About Our Process\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Who PureTask Is For */}\n      <section className=\"py-24 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl lg:text-5xl font-fredoka font-bold mb-4 text-graphite\">\n              Who PureTask Is For\n            </h2>\n            <p className=\"text-xl text-gray-600 font-verdana\">Perfect cleaning solutions for every lifestyle</p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-7xl mx-auto\">\n            <Link to={createPageUrl('ForProfessionals')}>\n              <Card className=\"h-full border-2 border-puretask-blue hover:shadow-xl transition-all cursor-pointer rounded-2xl bg-gradient-to-br from-blue-50 to-white\">\n                <CardContent className=\"p-6 text-center\">\n                  <div className=\"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                    <Briefcase className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-3 text-puretask-blue\">For Professionals</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm mb-4\">Busy professionals who need reliable, scheduled cleaning</p>\n                  <Button variant=\"ghost\" className=\"text-puretask-blue font-fredoka\">\n                    Learn More <ArrowRight className=\"w-4 h-4 ml-1\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            </Link>\n\n            <Link to={createPageUrl('ForRetirees')}>\n              <Card className=\"h-full border-2 border-purple-400 hover:shadow-xl transition-all cursor-pointer rounded-2xl bg-gradient-to-br from-purple-50 to-white\">\n                <CardContent className=\"p-6 text-center\">\n                  <div className=\"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-purple-500\">\n                    <Heart className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-3 text-purple-600\">For Retirees</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm mb-4\">Senior-friendly service with trusted, caring cleaners</p>\n                  <Button variant=\"ghost\" className=\"text-purple-600 font-fredoka\">\n                    Learn More <ArrowRight className=\"w-4 h-4 ml-1\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            </Link>\n\n            <Link to={createPageUrl('ForAirbnbHosts')}>\n              <Card className=\"h-full border-2 border-amber-400 hover:shadow-xl transition-all cursor-pointer rounded-2xl bg-gradient-to-br from-amber-50 to-white\">\n                <CardContent className=\"p-6 text-center\">\n                  <div className=\"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-amber-500\">\n                    <HomeIcon className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-3 text-amber-600\">For Airbnb Hosts</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm mb-4\">Fast turnaround cleaning between guest stays</p>\n                  <Button variant=\"ghost\" className=\"text-amber-600 font-fredoka\">\n                    Learn More <ArrowRight className=\"w-4 h-4 ml-1\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            </Link>\n\n            <Link to={createPageUrl('ForFamilies')}>\n              <Card className=\"h-full border-2 border-fresh-mint hover:shadow-xl transition-all cursor-pointer rounded-2xl bg-gradient-to-br from-green-50 to-white\">\n                <CardContent className=\"p-6 text-center\">\n                  <div className=\"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-fresh-mint\">\n                    <Users className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <h3 className=\"text-xl font-fredoka font-bold mb-3 text-fresh-mint\">For Families</h3>\n                  <p className=\"text-gray-600 font-verdana text-sm mb-4\">Child-safe products and family-friendly service</p>\n                  <Button variant=\"ghost\" className=\"text-fresh-mint font-fredoka\">\n                    Learn More <ArrowRight className=\"w-4 h-4 ml-1\" />\n                  </Button>\n                </CardContent>\n              </Card>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-24 text-white\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n        <div className=\"container mx-auto px-6 text-center\">\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ duration: 0.5 }}\n          >\n            <h2 className=\"text-4xl lg:text-5xl font-fredoka font-bold mb-6\">\n              Are You a Professional Cleaner?\n            </h2>\n            <p className=\"text-xl font-verdana mb-10 max-w-2xl mx-auto leading-relaxed\">\n              Join our platform and build your business with flexible hours, fair pay, and a steady stream of clients\n            </p>\n            <Button \n              onClick={() => navigate(createPageUrl('RoleSelection'))}\n              size=\"lg\" \n              className=\"rounded-full shadow-xl text-lg px-10 py-7 font-fredoka font-semibold border-2 border-white\" \n              style={{ backgroundColor: 'white', color: '#66B3FF' }}\n            >\n              <Briefcase className=\"w-5 h-5 mr-2\" />\n              Join as a Cleaner\n            </Button>\n\n            <div className=\"mt-12 flex flex-wrap justify-center gap-8 font-verdana\">\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-5 h-5\" />\n                <span>Earn 80-85%</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-5 h-5\" />\n                <span>Set Your Rates</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <CheckCircle className=\"w-5 h-5\" />\n                <span>Weekly Payouts</span>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\HowItWorks.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Link' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14,"fix":{"range":[35,41],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Link"},"fix":{"range":[36,41],"text":""},"desc":"Remove unused variable 'Link'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Users, Zap, ArrowRight, CheckCircle } from 'lucide-react';\n\nexport default function HowItWorks() {\n  const navigate = useNavigate();\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* Hero */}\n      <section className=\"py-20\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n        <div className=\"container mx-auto px-6 text-center\">\n          <h1 className=\"text-5xl lg:text-6xl font-fredoka font-bold mb-6 text-white\">How PureTask Works</h1>\n          <p className=\"text-xl font-verdana max-w-2xl mx-auto mb-10 text-white\">\n            Choose your path to learn how our platform works for you\n          </p>\n        </div>\n      </section>\n\n      {/* Role Selection */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto\">\n            {/* Client Path */}\n            <Card\n              className=\"border-4 shadow-xl hover:shadow-2xl transition-all cursor-pointer rounded-2xl group\"\n              style={{ borderColor: '#66B3FF' }}\n              onClick={() => navigate(createPageUrl('HowItWorksClients'))}\n            >\n              <CardContent className=\"p-12 text-center\">\n                <div className=\"w-24 h-24 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:scale-110 transition-transform\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                  <Users className=\"w-12 h-12 text-white\" />\n                </div>\n                <Badge className=\"mb-4 px-6 py-2 text-lg rounded-full font-fredoka\" style={{ backgroundColor: '#DBEAFE', color: '#66B3FF' }}>\n                  For Clients\n                </Badge>\n                <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4\">Book a Cleaner</h2>\n                <p className=\"text-gray-600 font-verdana mb-6 leading-relaxed\">\n                  Learn how to find, book, and work with verified cleaning professionals on our platform\n                </p>\n                <ul className=\"text-left space-y-2 mb-8\">\n                  {[\n                    'Browse verified cleaners',\n                    'Transparent pricing & scheduling',\n                    'GPS tracking & photo proof',\n                    'Pay only when satisfied',\n                    'Rate & review your experience'\n                  ].map((item, i) => (\n                    <li key={i} className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                      <CheckCircle className=\"w-5 h-5 text-puretask-blue flex-shrink-0\" />\n                      {item}\n                    </li>\n                  ))}\n                </ul>\n                <Button className=\"w-full text-white rounded-full font-fredoka font-semibold text-lg py-6 group-hover:shadow-xl transition-all\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                  Learn More\n                  <ArrowRight className=\"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </CardContent>\n            </Card>\n\n            {/* Cleaner Path */}\n            <Card\n              className=\"border-4 shadow-xl hover:shadow-2xl transition-all cursor-pointer rounded-2xl group\"\n              style={{ borderColor: '#28C76F' }}\n              onClick={() => navigate(createPageUrl('HowItWorksCleaners'))}\n            >\n              <CardContent className=\"p-12 text-center\">\n                <div className=\"w-24 h-24 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg group-hover:scale-110 transition-transform\" style={{ background: 'linear-gradient(135deg, #28C76F 0%, #10B981 100%)' }}>\n                  <Zap className=\"w-12 h-12 text-white\" />\n                </div>\n                <Badge className=\"mb-4 px-6 py-2 text-lg rounded-full font-fredoka\" style={{ backgroundColor: '#D1FAE5', color: '#28C76F' }}>\n                  For Cleaners\n                </Badge>\n                <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4\">Become a Cleaner</h2>\n                <p className=\"text-gray-600 font-verdana mb-6 leading-relaxed\">\n                  Discover how to build your cleaning business with flexible hours and fair pay\n                </p>\n                <ul className=\"text-left space-y-2 mb-8\">\n                  {[\n                    'Get verified & approved',\n                    'Set your own rates & schedule',\n                    'Accept jobs you want',\n                    'Earn 80-85% of every booking',\n                    'Get paid weekly or instantly'\n                  ].map((item, i) => (\n                    <li key={i} className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                      <CheckCircle className=\"w-5 h-5 text-fresh-mint flex-shrink-0\" />\n                      {item}\n                    </li>\n                  ))}\n                </ul>\n                <Button className=\"w-full text-white rounded-full font-fredoka font-semibold text-lg py-6 group-hover:shadow-xl transition-all\" style={{ background: 'linear-gradient(135deg, #28C76F 0%, #10B981 100%)' }}>\n                  Learn More\n                  <ArrowRight className=\"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform\" />\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\HowItWorksCleaners.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\HowItWorksClients.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Tabs' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":14,"fix":{"range":[271,277],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Tabs"},"fix":{"range":[272,277],"text":""},"desc":"Remove unused variable 'Tabs'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsContent' is defined but never used.","line":7,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":27,"fix":{"range":[277,290],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsContent"},"fix":{"range":[276,289],"text":""},"desc":"Remove unused variable 'TabsContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsList' is defined but never used.","line":7,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":37,"fix":{"range":[290,300],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsList"},"fix":{"range":[289,299],"text":""},"desc":"Remove unused variable 'TabsList'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsTrigger' is defined but never used.","line":7,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":50,"fix":{"range":[299,312],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsTrigger"},"fix":{"range":[299,312],"text":""},"desc":"Remove unused variable 'TabsTrigger'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":10,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"fix":{"range":[430,437],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[429,436],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MessageSquare' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":31,"fix":{"range":[437,452],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MessageSquare"},"fix":{"range":[436,451],"text":""},"desc":"Remove unused variable 'MessageSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":10,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":38,"fix":{"range":[452,459],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[451,458],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":10,"column":40,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":50,"fix":{"range":[459,471],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[458,470],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  Search, Calendar, DollarSign, MapPin, Star, CheckCircle, Shield,\n  Camera, Clock, MessageSquare, Award, TrendingUp, Users\n} from 'lucide-react';\n\nexport default function HowItWorksClients() {\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* Hero */}\n      <section className=\"brand-gradient text-white py-20\">\n        <div className=\"container mx-auto px-6 text-center\">\n          <Badge className=\"mb-6 bg-white/20 text-white px-6 py-2 text-lg rounded-full font-fredoka\">\n            <Users className=\"w-5 h-5 mr-2\" />\n            For Clients\n          </Badge>\n          <h1 className=\"text-5xl lg:text-6xl font-fredoka font-bold mb-6\">How PureTask Works for Clients</h1>\n          <p className=\"text-xl font-verdana max-w-2xl mx-auto\">\n            Book verified cleaners in minutes with complete transparency and peace of mind\n          </p>\n        </div>\n      </section>\n\n      {/* Steps */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-4xl mx-auto space-y-12\">\n            {[\n              {\n                step: 1,\n                icon: Search,\n                title: 'Browse & Filter Verified Cleaners',\n                description: 'Search our marketplace of background-checked, verified cleaning professionals. Use advanced filters to find the perfect match.',\n                features: [\n                  'Filter by reliability score, pricing, and location',\n                  'View detailed profiles with photos and reviews',\n                  'Check real-time availability',\n                  'See before/after photo galleries from previous jobs'\n                ]\n              },\n              {\n                step: 2,\n                icon: Calendar,\n                title: 'Select Date, Time & Custom Tasks',\n                description: 'Choose your preferred date and time. Select exactly what you want cleaned from our comprehensive task list.',\n                features: [\n                  'Pick from basic, deep, or move-out cleaning',\n                  'Customize with specific room-by-room tasks',\n                  'See transparent pricing before you book',\n                  'Add special instructions or allergy information'\n                ]\n              },\n              {\n                step: 3,\n                icon: DollarSign,\n                title: 'Secure Credit-Based Payment',\n                description: 'Pay with our credit system (10 credits = $1). Your payment is held in escrow - you only pay for actual time worked.',\n                features: [\n                  'Buy credits in advance or pay per booking',\n                  'Payment held safely until job completion',\n                  'Automatic refund if job takes less time',\n                  'No hidden fees - 15% platform fee included'\n                ]\n              },\n              {\n                step: 4,\n                icon: MapPin,\n                title: 'GPS Tracking & Live Updates',\n                description: 'Get real-time notifications when your cleaner checks in with GPS verification. See before/after photos as they work.',\n                features: [\n                  'GPS check-in confirms cleaner arrival',\n                  'Live photo updates during cleaning',\n                  'Direct messaging with your cleaner',\n                  'Track progress in real-time'\n                ]\n              },\n              {\n                step: 5,\n                icon: Star,\n                title: 'Approve & Pay Only When Satisfied',\n                description: 'Review the completed work and uploaded photos. Your payment is only released after you approve the job.',\n                features: [\n                  'Review before/after photos',\n                  'Approve work to release payment',\n                  'Rate your cleaner',\n                  'Dispute resolution if needed'\n                ]\n              }\n            ].map((step, idx) => (\n              <div key={idx} className=\"flex gap-6 items-start\">\n                <div className=\"w-20 h-20 brand-gradient rounded-2xl flex items-center justify-center text-white font-fredoka font-bold text-3xl shadow-lg flex-shrink-0\">\n                  {step.step}\n                </div>\n                <Card className=\"flex-1 border-0 shadow-lg rounded-2xl\">\n                  <CardContent className=\"p-8\">\n                    <div className=\"flex items-center gap-3 mb-4\">\n                      <step.icon className=\"w-8 h-8 text-puretask-blue\" />\n                      <h3 className=\"text-2xl font-fredoka font-bold text-graphite\">{step.title}</h3>\n                    </div>\n                    <p className=\"text-gray-600 text-lg mb-4 font-verdana\">{step.description}</p>\n                    <ul className=\"grid md:grid-cols-2 gap-3\">\n                      {step.features.map((feature, i) => (\n                        <li key={i} className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                          <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                          <span>{feature}</span>\n                        </li>\n                      ))}\n                    </ul>\n                  </CardContent>\n                </Card>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"text-center mt-16\">\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"brand-gradient text-white text-lg px-10 py-6 rounded-full font-fredoka font-semibold shadow-xl\">\n                <Search className=\"w-5 h-5 mr-2\" />\n                Browse Cleaners Now\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Trust & Safety */}\n      <section className=\"py-20 bg-soft-cloud\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl font-fredoka font-bold text-graphite mb-4\">Trust & Safety Features</h2>\n            <p className=\"text-xl text-gray-600 font-verdana\">Multiple layers of protection for every booking</p>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto\">\n            {[\n              { icon: Shield, title: 'ID Verified', description: 'Government ID check with liveness detection' },\n              { icon: CheckCircle, title: 'Background Checked', description: 'Comprehensive criminal screening' },\n              { icon: MapPin, title: 'GPS Tracking', description: 'Check-in/out location verification' },\n              { icon: Camera, title: 'Photo Proof', description: 'Before/after documentation required' }\n            ].map((item, idx) => (\n              <Card key={idx} className=\"border-0 shadow-lg text-center rounded-2xl\">\n                <CardContent className=\"p-8\">\n                  <div className=\"w-16 h-16 brand-gradient rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg\">\n                    <item.icon className=\"w-8 h-8 text-white\" />\n                  </div>\n                  <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">{item.title}</h3>\n                  <p className=\"text-gray-600 font-verdana\">{item.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Inbox.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Archive' is defined but never used.","line":11,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":46,"fix":{"range":[509,518],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Archive"},"fix":{"range":[508,517],"text":""},"desc":"Remove unused variable 'Archive'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport AIBadge from '../components/ai/AIBadge';\nimport { Card } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { MessageSquare, Search, Plus, Archive, Calendar } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function Inbox() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [userType, setUserType] = useState(null);\n  const [threads, setThreads] = useState([]);\n  const [filteredThreads, setFilteredThreads] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  useEffect(() => {\n    if (searchQuery) {\n      const filtered = threads.filter(thread => \n        thread.subject?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        thread.last_message_content?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        thread.participants.some(p => p.toLowerCase().includes(searchQuery.toLowerCase()))\n      );\n      setFilteredThreads(filtered);\n    } else {\n      setFilteredThreads(threads);\n    }\n  }, [searchQuery, threads]);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      // Determine user type\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n      const clientProfiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n      \n      if (cleanerProfiles.length > 0) {\n        setUserType('cleaner');\n      } else if (clientProfiles.length > 0) {\n        setUserType('client');\n      } else if (currentUser.role === 'admin') {\n        setUserType('admin');\n      }\n\n      // Load conversations\n      const allThreads = await base44.entities.ConversationThread.filter({\n        participants: { $in: [currentUser.email] },\n        is_active: true\n      });\n\n      // Sort by last message timestamp\n      allThreads.sort((a, b) => {\n        const aTime = new Date(a.last_message_at || 0);\n        const bTime = new Date(b.last_message_at || 0);\n        return bTime - aTime;\n      });\n\n      setThreads(allThreads);\n      setFilteredThreads(allThreads);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading inbox:', showToast: false });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getUnreadCount = (thread) => {\n    if (userType === 'client') return thread.unread_count_client || 0;\n    if (userType === 'cleaner') return thread.unread_count_cleaner || 0;\n    if (userType === 'admin') return thread.unread_count_admin || 0;\n    return 0;\n  };\n\n  const getOtherParticipant = (thread) => {\n    const others = thread.participants.filter(p => p !== user?.email);\n    return others[0] || 'Unknown';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-puretask-blue border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-graphite font-fredoka\">Loading messages...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      <div className=\"container mx-auto px-4 py-8 max-w-5xl\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">Messages</h1>\n            <p className=\"text-slate-600 font-verdana\">All your conversations in one place</p>\n          </div>\n          <Button className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\">\n            <Plus className=\"w-5 h-5 mr-2\" />\n            New Message\n          </Button>\n        </div>\n\n        {/* Search */}\n        <div className=\"mb-6\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search conversations...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10 rounded-full border-slate-200\"\n            />\n          </div>\n        </div>\n\n        {/* Conversation List */}\n        {filteredThreads.length === 0 ? (\n          <Card className=\"p-12 text-center\">\n            <MessageSquare className=\"w-16 h-16 text-slate-300 mx-auto mb-4\" />\n            <h3 className=\"text-xl font-fredoka font-semibold text-graphite mb-2\">\n              {searchQuery ? 'No conversations found' : 'No messages yet'}\n            </h3>\n            <p className=\"text-slate-600 font-verdana\">\n              {searchQuery ? 'Try a different search term' : 'Start a conversation to get connected'}\n            </p>\n          </Card>\n        ) : (\n          <div className=\"space-y-3\">\n            {filteredThreads.map((thread, index) => {\n              const unreadCount = getUnreadCount(thread);\n              const otherParticipant = getOtherParticipant(thread);\n              \n              return (\n                <motion.div\n                  key={thread.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.05 }}\n                >\n                  <Card\n                    className={cn(\n                      \"p-4 cursor-pointer transition-all hover:shadow-md\",\n                      unreadCount > 0 && \"border-l-4 border-l-puretask-blue bg-blue-50\"\n                    )}\n                    onClick={() => navigate(createPageUrl('ChatThread') + `?thread_id=${thread.id}`)}\n                  >\n                    <div className=\"flex items-start gap-4\">\n                      {/* Avatar */}\n                      <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-semibold text-lg flex-shrink-0\">\n                        {otherParticipant[0].toUpperCase()}\n                      </div>\n\n                      {/* Content */}\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-start justify-between mb-1\">\n                          <h3 className=\"font-fredoka font-semibold text-graphite truncate\">\n                            {thread.subject || otherParticipant}\n                          </h3>\n                          <span className=\"text-xs text-slate-500 ml-2 flex-shrink-0\">\n                            {thread.last_message_at && new Date(thread.last_message_at).toLocaleDateString()}\n                          </span>\n                        </div>\n\n                        <p className=\"text-sm text-slate-600 font-verdana truncate mb-2\">\n                          {thread.last_message_content || 'No messages yet'}\n                        </p>\n\n                        <div className=\"flex items-center gap-2 flex-wrap\">\n                          {thread.booking_id && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              <Calendar className=\"w-3 h-3 mr-1\" />\n                              Booking\n                            </Badge>\n                          )}\n                          {thread.metadata?.is_agent_conversation && (\n                            <AIBadge variant=\"automated\" className=\"text-xs\" />\n                          )}\n                          {unreadCount > 0 && (\n                            <Badge className=\"bg-puretask-blue text-white font-fredoka\">\n                              {unreadCount} new\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </Card>\n                </motion.div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction cn(...classes) {\n  return classes.filter(Boolean).join(' ');\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Layout.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'useCallback' is defined but never used.","line":2,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":49,"fix":{"range":[36,49],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[36,49],"text":""},"desc":"Remove unused variable 'useCallback'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { cacheManager } from '@/lib/cacheManager';\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Sparkles, Menu, X, User as UserIcon, LogOut, Home, Search,\n  HelpCircle, ChevronDown, MessageSquare, Heart, Wallet, Gift, Shield, ArrowRight, Scale, Calendar, Bell\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport AIChatAssistant from '@/components/chat/AIChatAssistant';\nimport NotificationDisplay from '@/components/notifications/NotificationDisplay';\nimport AdminPageInfo from '@/components/admin/AdminPageInfo';\nimport { analytics, setAnalyticsUser } from '@/components/analytics/AnalyticsService';\n\n// Public pages that don't require authentication\nconst PUBLIC_PAGES = [\n  'Home',\n  'RoleSelection',\n  'SignIn',\n  'Pricing',\n  'HowItWorks',\n  'HowItWorksCleaners',\n  'AboutUs',\n  'ContactUs',\n  'PrivacyPolicy',\n  'TermsOfService',\n  'BrowseCleaners',\n  'DesignSystemDemo',\n  'SetupGuide'\n];\n\nexport default function Layout({ children, currentPageName }) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [user, setUser] = useState(null);\n  const [userType, setUserType] = useState(null);\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [showDesktopMenu, setShowDesktopMenu] = useState(true);\n  const [loading, setLoading] = useState(true);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [unreadNotificationCount, setUnreadNotificationCount] = useState(0);\n  const [notificationMenuOpen, setNotificationMenuOpen] = useState(false);\n  const [navVisible, setNavVisible] = useState(true);\n  const hideTimeout = React.useRef(null);\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [location.pathname]);\n\n  // Initial user and unread count load\n  useEffect(() => {\n    let isMounted = true; // Prevent state updates if component unmounts\n    \n    const initializeApp = async () => {\n      try {\n        if (isMounted) {\n          await loadUserAndUnreadCount();\n        }\n      } catch (error) {\n        if (isMounted) {\n          handleError(error, { userMessage: 'Error in initial load:', showToast: false });\n          setLoading(false); // Always stop loading even on error\n        }\n      }\n    };\n    \n    initializeApp();\n    \n    return () => {\n      isMounted = false; // Cleanup flag\n    };\n  }, []); // Empty dependency array means this runs once on mount\n\n  // Poll for unread messages and notifications every 30 seconds if user is logged in\n  useEffect(() => {\n    // IMPORTANT: Don't run if loading or no user\n    if (loading || !user || !user.email) {\n      setUnreadCount(0);\n      setUnreadNotificationCount(0);\n      return;\n    }\n\n    // Stable function reference using useCallback would cause issues, so we define inline\n    // This useEffect only re-runs when user or loading changes, which is acceptable\n    const loadCounts = async () => {\n      try {\n        await loadUnreadCount(user);\n        await loadUnreadNotificationCount(user);\n      } catch (error) {\n        console.log('Error loading counts (non-critical):', error);\n        // Don't throw - just log and continue\n      }\n    };\n    \n    // Load counts immediately\n    loadCounts();\n\n    // Set up interval to poll every 30 seconds\n    const interval = setInterval(() => {\n      loadCounts();\n    }, 30000); // 30 seconds\n    \n    // Cleanup interval on unmount or when dependencies change\n    return () => clearInterval(interval);\n  }, [user?.email, loading]); // Only re-run when user email or loading changes\n\n  const loadUserAndUnreadCount = async () => {\n    try {\n      setLoading(true);\n      \n      // Check user cache first - use longer cache (30 min) to avoid re-auth\n      const cachedUser = cacheManager.get('currentUser');\n      const cacheAge = cacheManager.getAge('currentUser');\n\n      if (cachedUser && cacheAge < 5 * 60 * 1000) { // 5 minutes\n        const currentUser = cachedUser;\n        setUser(currentUser);\n\n        // After user is loaded, set analytics user\n        if (currentUser) {\n          setAnalyticsUser(currentUser);\n        }\n\n        let detectedType = null;\n        if (currentUser.user_type) {\n          detectedType = currentUser.user_type;\n        } else if (currentUser.role === 'admin') {\n          detectedType = 'admin';\n        } else {\n          // Try to get userType from profile cache\n          const cachedProfileType = cacheManager.get(`userProfile_${currentUser.email}`);\n          if (cachedProfileType) {\n            detectedType = cachedProfileType;\n          }\n        }\n        if (detectedType) {\n          setUserType(detectedType);\n        }\n\n        // Load unread count from cache\n        const cachedUnread = cacheManager.get(`unreadCount_${currentUser.email}`);\n        if (cachedUnread !== null) {\n          setUnreadCount(cachedUnread);\n        }\n\n        setLoading(false);\n        // Still attempt to refresh data in background if cache was used, for freshness\n        // but don't wait for it. IMPORTANT: Don't update user state to prevent re-triggering useEffect\n        base44.auth.me().then(freshUser => {\n          if (freshUser && freshUser.email === currentUser.email) { // Ensure it's the same user\n            // Only update cache, DON'T call setUser to avoid triggering useEffect loop\n            cacheManager.set('currentUser', freshUser, 30 * 60 * 1000);\n            // Silently refresh unread count in background\n            loadUnreadCount(freshUser); // Refresh unread count\n            setAnalyticsUser(freshUser); // Update analytics user with fresh data\n          }\n        }).catch(e => {\n          console.warn('Background refresh of user data failed, using cached data.', e);\n        });\n\n        return; // Exit as we've used cached data\n      }\n\n      // If no valid cache, try to fetch fresh user data\n      const currentUser = await base44.auth.me().catch(error => {\n        console.log('Auth check failed (likely not logged in):', error);\n        setLoading(false); // Stop loading immediately for guest users\n        return null; // Return null if not authenticated\n      });\n      \n      if (!currentUser) {\n        // User not logged in - this is OK for public pages\n        console.log('No user logged in - allowing guest access');\n        setLoading(false);\n        return;\n      }\n      \n      setUser(currentUser);\n      cacheManager.set('currentUser', currentUser, 30 * 60 * 1000);\n\n      // After user is loaded, set analytics user\n      if (currentUser) {\n        setAnalyticsUser(currentUser);\n      }\n\n      let detectedType = null;\n      if (currentUser.user_type) {\n        detectedType = currentUser.user_type;\n      } else if (currentUser.role === 'admin') {\n        detectedType = 'admin';\n      } else {\n        // Cache profile checks too\n        const cachedProfile = cacheManager.get(`userProfile_${currentUser.email}`);\n\n        if (cachedProfile) {\n          detectedType = cachedProfile;\n        } else {\n          // No cached profile type, fetch from API\n          const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n          const clientProfiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n\n          if (cleanerProfiles.length > 0) {\n            detectedType = 'cleaner';\n          } else if (clientProfiles.length > 0) {\n            detectedType = 'client';\n          }\n\n          if (detectedType) {\n            localStorage.setItem(profileCacheKey, detectedType); // Cache the detected type\n          }\n        }\n      }\n      if (detectedType) {\n        setUserType(detectedType);\n      }\n\n      // Load unread count and notification count silently (don't fail if this errors)\n      try {\n        await loadUnreadCount(currentUser);\n        await loadUnreadNotificationCount(currentUser);\n      } catch (e) {\n        console.log('Could not load unread count:', e);\n      }\n    } catch (error) {\n      console.log('Error fetching user from API:', error);\n      // DON'T automatically log out on error, unless it's a 401 and no cached data\n\n      const cachedUserString = localStorage.getItem('currentUser');\n      const userCacheTimeString = localStorage.getItem('currentUserTime');\n\n      if (cachedUserString && userCacheTimeString) {\n        // If an error occurred but we have cached user data, use it.\n        // This handles cases like network issues or API rate limits.\n        const cachedUser = JSON.parse(cachedUserString);\n        setUser(cachedUser);\n\n        // After user is loaded, set analytics user\n        if (cachedUser) {\n          setAnalyticsUser(cachedUser);\n        }\n\n        let detectedType = null;\n        if (cachedUser.user_type) {\n          detectedType = cachedUser.user_type;\n        } else if (cachedUser.role === 'admin') {\n          detectedType = 'admin';\n        } else {\n          const profileCacheKey = `userProfile_${cachedUser.email}`;\n          const cachedProfileType = localStorage.getItem(profileCacheKey);\n          if (cachedProfileType) {\n            detectedType = cachedProfileType;\n          }\n        }\n        if (detectedType) {\n          setUserType(detectedType);\n        }\n\n        const cachedUnread = localStorage.getItem(`unreadCount_${cachedUser.email}`);\n        if (cachedUnread) {\n          setUnreadCount(parseInt(cachedUnread));\n        }\n        console.log('Using cached user data due to API error.');\n      } else {\n        // Only clear user state if there's no cached data AND it's an authentication error (401)\n        if (error.response?.status === 401) {\n          console.log('User not authenticated, clearing user state.');\n          setUser(null);\n          setUserType(null);\n          setUnreadCount(0);\n          localStorage.clear(); // Clear any stale cache\n          sessionStorage.clear(); // Clear session storage too\n          setAnalyticsUser(null); // Clear analytics user\n        } else {\n          // For other errors without cached user, just log and clear user\n          console.log('Non-authentication API error and no cached user, clearing user state.');\n          setUser(null);\n          setUserType(null);\n          setUnreadCount(0);\n          setAnalyticsUser(null); // Clear analytics user\n        }\n      }\n    }\n    setLoading(false);\n  };\n\n  const loadUnreadCount = async (currentUser) => {\n    // If no currentUser is provided, try to get from state, or exit\n    if (!currentUser && !user) {\n      setUnreadCount(0);\n      return;\n    }\n    const userToUse = currentUser || user;\n    if (!userToUse) { // Should not happen if previous checks are good, but for safety\n      setUnreadCount(0);\n      return;\n    }\n\n    try {\n      const now = Date.now();\n      // Check cache first - 30 minute cache\n      const cacheKey = `unreadCount_${userToUse.email}`;\n      const cacheTimeKey = `unreadCountTime_${userToUse.email}`;\n      const cachedCount = localStorage.getItem(cacheKey);\n      const cacheTime = localStorage.getItem(cacheTimeKey);\n\n      if (cachedCount && cacheTime) {\n        const parsedCacheTime = parseInt(cacheTime);\n        if ((now - parsedCacheTime) < 1800000) { // 30 min = 1800000 ms\n          setUnreadCount(parseInt(cachedCount));\n          return; // Use cached value if valid\n        }\n      }\n\n      // If cache is stale or non-existent, fetch fresh data\n      const threads = await base44.entities.ConversationThread.filter({\n        participants: { $in: [userToUse.email] }\n      }).catch(error => {\n        console.log('Could not fetch conversation threads (database may not exist yet):', error);\n        return []; // Return empty array to prevent crash\n      });\n\n      let total = 0;\n      threads.forEach(thread => {\n        // Use userType from state if available, otherwise fallback to currentUser's potential type or derived type\n        const currentRole = userToUse.user_type || userType || (userToUse.role === 'admin' ? 'admin' : null);\n        if (currentRole === 'client') {\n          total += thread.unread_count_client || 0;\n        } else if (currentRole === 'cleaner') {\n          total += thread.unread_count_cleaner || 0;\n        }\n      });\n\n      setUnreadCount(total);\n      localStorage.setItem(cacheKey, total.toString());\n      localStorage.setItem(cacheTimeKey, now.toString());\n    } catch (error) {\n      console.log('Could not load unread count:', error);\n      // Silently fail, don't clear the current unread count state,\n      // a stale count is better than no count or 0 if user is logged in.\n    }\n  };\n\n  const loadUnreadNotificationCount = async (currentUser) => {\n    if (!currentUser && !user) {\n      setUnreadNotificationCount(0);\n      return;\n    }\n    const userToUse = currentUser || user;\n    if (!userToUse || !userToUse.email) {\n      setUnreadNotificationCount(0);\n      return;\n    }\n\n    try {\n      const notifications = await base44.entities.Notification.filter({\n        recipient_email: userToUse.email,\n        is_read: false\n      }).catch(error => {\n        console.log('Could not fetch notifications (database may not exist yet):', error);\n        return []; // Return empty array to prevent crash\n      });\n      setUnreadNotificationCount(notifications ? notifications.length : 0);\n    } catch (error) {\n      console.log('Could not load unread notification count:', error);\n      setUnreadNotificationCount(0); // Set to 0 on error instead of leaving undefined\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      // Clear all local state and caches FIRST\n      localStorage.clear();\n      sessionStorage.clear();\n      setUser(null);\n      setUserType(null);\n      setUnreadCount(0);\n      setAnalyticsUser(null);\n      \n      // Then call logout API\n      await base44.auth.logout();\n      \n      // Force page reload to home with cache-busting parameter\n      window.location.href = createPageUrl('Home') + '?logout=' + Date.now();\n    } catch (e) {\n      console.log('Logout error:', e);\n      // Even if API fails, still clear local state and redirect\n      localStorage.clear();\n      sessionStorage.clear();\n      window.location.href = createPageUrl('Home') + '?logout=' + Date.now();\n    }\n  };\n\n  // Track page views\n  useEffect(() => {\n    if (currentPageName) {\n      analytics.pageView(currentPageName);\n    }\n  }, [currentPageName]);\n\n  // Auto-hide navbar\n  useEffect(() => {\n    const handleMouseMove = (e) => {\n      if (e.clientY < 100) {\n        setNavVisible(true);\n        if (hideTimeout.current) clearTimeout(hideTimeout.current);\n        hideTimeout.current = setTimeout(() => setNavVisible(false), 3000);\n      }\n    };\n\n    const handleTouchStart = (e) => {\n      const touch = e.touches[0];\n      if (touch.clientY < 50) {\n        setNavVisible(true);\n        if (hideTimeout.current) clearTimeout(hideTimeout.current);\n        hideTimeout.current = setTimeout(() => setNavVisible(false), 3000);\n      }\n    };\n\n    window.addEventListener('mousemove', handleMouseMove);\n    window.addEventListener('touchstart', handleTouchStart);\n\n    // Initial auto-hide after 3 seconds\n    hideTimeout.current = setTimeout(() => setNavVisible(false), 3000);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove);\n      window.removeEventListener('touchstart', handleTouchStart);\n      if (hideTimeout.current) clearTimeout(hideTimeout.current);\n    };\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* Loading State - Only show for protected pages, skip for public pages */}\n      {loading && !PUBLIC_PAGES.includes(currentPageName) && (\n        <div className=\"fixed inset-0 bg-white z-50 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ repeat: Infinity, duration: 1, ease: \"linear\" }}\n              className=\"w-16 h-16 mx-auto mb-4 brand-gradient rounded-2xl flex items-center justify-center\"\n            >\n              <Sparkles className=\"w-8 h-8 text-white\" />\n            </motion.div>\n            <p className=\"text-graphite font-fredoka text-lg\">Loading PureTask...</p>\n          </div>\n        </div>\n      )}\n\n      {/* NAVIGATION */}\n      <motion.nav \n        initial={{ y: 0 }}\n        animate={{ y: navVisible ? 0 : -100 }}\n        transition={{ duration: 0.3, ease: \"easeInOut\" }}\n        className=\"bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-50 shadow-sm\"\n        onMouseEnter={() => {\n          setNavVisible(true);\n          if (hideTimeout.current) clearTimeout(hideTimeout.current);\n        }}\n        onMouseLeave={() => {\n          hideTimeout.current = setTimeout(() => setNavVisible(false), 2000);\n        }}\n      >\n        <div className=\"container mx-auto px-3 sm:px-6 max-w-full\">\n          <div className=\"flex items-center justify-between h-14 sm:h-16\">\n            {/* Logo */}\n            <Link to={createPageUrl('Home')} className=\"flex items-center gap-2 sm:gap-3 hover:opacity-80 transition-opacity\">\n              <motion.div\n                animate={{ rotate: [0, 10, -10, 0] }}\n                transition={{ repeat: \"Infinity\", duration: 5, ease: \"easeInOut\" }}\n                className=\"w-8 h-8 sm:w-10 sm:h-10 brand-gradient rounded-xl sm:rounded-2xl flex items-center justify-center shadow-md\"\n              >\n                <Sparkles className=\"w-5 h-5 sm:w-6 sm:h-6 text-white\" />\n              </motion.div>\n              <span className=\"text-xl sm:text-2xl font-fredoka font-bold text-graphite\">PureTask</span>\n            </Link>\n\n            {/* Desktop Menu Toggle */}\n            <Button \n              variant=\"ghost\" \n              className=\"hidden md:flex p-2 text-graphite rounded-full mr-2\" \n              onClick={() => setShowDesktopMenu(!showDesktopMenu)}\n            >\n              <Menu className=\"w-5 h-5\" />\n            </Button>\n\n            {/* Desktop Menu */}\n            <AnimatePresence>\n              {showDesktopMenu && (\n                <motion.div \n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: -20 }}\n                  transition={{ duration: 0.2 }}\n                  className=\"hidden md:flex items-center gap-2\"\n                >\n              {/* GUEST MENU */}\n              {!user && (\n                <>\n                  <Link to={createPageUrl('Home')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'Home' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                        <Home className=\"w-4 h-4 inline mr-2\" />Home\n                      </Link>\n                        <Link to={createPageUrl('BrowseCleaners')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'BrowseCleaners' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                          <Search className=\"w-4 h-4 inline mr-2\" />Browse Cleaners\n                        </Link>\n                        <Link to={createPageUrl('Pricing')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'Pricing' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                          Pricing\n                        </Link>\n                        <Link to={createPageUrl('Support')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'Support' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                          <HelpCircle className=\"w-4 h-4 inline mr-2\" />Support\n                        </Link>\n                </>\n              )}\n\n              {/* CLIENT MENU */}\n              {user && userType === 'client' && (\n                <>\n                  <Link to={createPageUrl('ClientDashboard')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'ClientDashboard' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                    <Home className=\"w-4 h-4 inline mr-2\" />Dashboard\n                  </Link>\n                  <Link to={createPageUrl('BrowseCleaners')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'BrowseCleaners' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                    <Search className=\"w-4 h-4 inline mr-2\" />Book\n                  </Link>\n                </>\n              )}\n\n              {/* CLEANER MENU */}\n              {user && userType === 'cleaner' && (\n                <>\n                  <Link to={createPageUrl('CleanerDashboard')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'CleanerDashboard' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                    <Home className=\"w-4 h-4 inline mr-2\" />Dashboard\n                  </Link>\n                  <Link to={createPageUrl('CleanerSchedule')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'CleanerSchedule' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                    <Calendar className=\"w-4 h-4 inline mr-2\" />Schedule\n                  </Link>\n                </>\n              )}\n\n              {/* ADMIN MENU */}\n              {user && (userType === 'admin' || user.role === 'admin') && (\n                <>\n                  <Link to={createPageUrl('AdminDashboard')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all ${currentPageName === 'AdminDashboard' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                    <Shield className=\"w-4 h-4 inline mr-2\" />Admin\n                  </Link>\n                </>\n              )}\n\n              {/* Notifications (all logged-in users) */}\n              {user && (\n                <DropdownMenu open={notificationMenuOpen} onOpenChange={setNotificationMenuOpen}>\n                  <DropdownMenuTrigger asChild>\n                    <button className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all relative ${notificationMenuOpen ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`}>\n                      <Bell className=\"w-4 h-4 inline mr-2\" />Notifications\n                      <AnimatePresence>\n                        {unreadNotificationCount > 0 && (\n                          <motion.div key={unreadNotificationCount} initial={{ scale: 0.8, opacity: 0.5 }} animate={{ scale: [1, 1.2, 1], opacity: 1 }} exit={{ scale: 0.8, opacity: 0 }} transition={{ type: \"spring\", stiffness: 500, damping: 20 }} className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 bg-red-500 text-white text-xs rounded-full font-fredoka\">\n                            {unreadNotificationCount > 9 ? '9+' : unreadNotificationCount}\n                          </motion.div>\n                        )}\n                      </AnimatePresence>\n                    </button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"p-0 w-auto\">\n                    <NotificationDisplay onClose={() => setNotificationMenuOpen(false)} />\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              )}\n\n              {/* Messages (all logged-in users) */}\n              {user && (\n                <Link to={createPageUrl('Inbox')} className={`px-4 py-2 rounded-full font-fredoka font-medium transition-all relative ${currentPageName === 'Inbox' ? 'bg-blue-50 text-puretask-blue' : 'text-graphite hover:bg-gray-50'}`} onClick={() => setUnreadCount(0)}>\n                  <MessageSquare className=\"w-4 h-4 inline mr-2\" />Messages\n                  <AnimatePresence>\n                    {unreadCount > 0 && (\n                      <motion.div key={unreadCount} initial={{ scale: 0.8, opacity: 0.5 }} animate={{ scale: [1, 1.2, 1], opacity: 1 }} exit={{ scale: 0.8, opacity: 0 }} transition={{ type: \"spring\", stiffness: 500, damping: 20 }} className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 bg-red-500 text-white text-xs rounded-full font-fredoka\">\n                        {unreadCount > 9 ? '9+' : unreadCount}\n                      </motion.div>\n                    )}\n                  </AnimatePresence>\n                </Link>\n              )}\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n            {/* User Profile / Auth Buttons */}\n            <div className=\"hidden md:flex items-center gap-3\">\n              {user ? (\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button variant=\"ghost\" className=\"flex items-center gap-2 rounded-full\">\n                      <div className=\"w-8 h-8 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold\">\n                        {user.full_name && user.full_name[0] ? user.full_name[0] : 'U'}\n                      </div>\n                      <span className=\"font-fredoka font-medium text-graphite\">{user.full_name}</span>\n                      <ChevronDown className=\"w-4 h-4 text-gray-500\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"w-56\">\n                    <div className=\"px-2 py-2\">\n                      <p className=\"text-sm font-fredoka font-medium\">{user.full_name}</p>\n                      <p className=\"text-xs text-gray-500 font-verdana\">{user.email}</p>\n                      {userType && <p className=\"text-xs text-puretask-blue mt-1 capitalize font-verdana\">{userType}</p>}\n                    </div>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem onClick={() => navigate(createPageUrl('Profile'))}>\n                      <UserIcon className=\"w-4 h-4 mr-2\" />My Profile\n                    </DropdownMenuItem>\n                    \n                    {userType === 'client' && (\n                      <>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('ClientBookings'))}>\n                          <Calendar className=\"w-4 h-4 mr-2\" />My Bookings\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('MultiBooking'))}>\n                          <Calendar className=\"w-4 h-4 mr-2\" />Multi-Booking\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('FavoriteCleaners'))}>\n                          <Heart className=\"w-4 h-4 mr-2\" />Favorites\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('BuyCredits'))}>\n                          <Wallet className=\"w-4 h-4 mr-2\" />Buy Credits\n                        </DropdownMenuItem>\n                      </>\n                    )}\n                    \n                    {userType === 'cleaner' && (\n                      <>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('CleanerPayouts'))}>\n                          <Wallet className=\"w-4 h-4 mr-2\" />Earnings\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => navigate(createPageUrl('AIActivityDashboard'))}>\n                          <MessageSquare className=\"w-4 h-4 mr-2\" />AI Assistant\n                        </DropdownMenuItem>\n                      </>\n                    )}\n                    \n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem onClick={() => navigate(createPageUrl('Support'))}>\n                      <HelpCircle className=\"w-4 h-4 mr-2\" />Support\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem onClick={handleLogout} className=\"text-red-600\">\n                      <LogOut className=\"w-4 h-4 mr-2\" />Logout\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              ) : (\n                <>\n                  <Link to={createPageUrl('SignIn')}>\n                    <Button variant=\"outline\" className=\"border-puretask-blue text-puretask-blue hover:bg-blue-50 rounded-full font-fredoka font-semibold\">\n                      Sign In\n                    </Button>\n                  </Link>\n                  <Link to={createPageUrl('RoleSelection')}>\n                    <Button className=\"brand-gradient text-white rounded-full font-fredoka font-semibold hover:opacity-90\">\n                      Get Started\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n\n            {/* Mobile Menu Button */}\n            <Button variant=\"ghost\" className=\"md:hidden p-2 text-graphite relative rounded-full\" onClick={() => setMobileMenuOpen(!mobileMenuOpen)}>\n              {mobileMenuOpen ? <X className=\"w-6 h-6\" /> : <Menu className=\"w-6 h-6\" />}\n              {unreadCount > 0 && <div className=\"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full\"></div>}\n            </Button>\n          </div>\n\n          {/* Mobile Menu */}\n          {mobileMenuOpen && (\n            <div className=\"md:hidden py-4 border-t border-gray-200\">\n              <div className=\"flex flex-col gap-2\">\n                {!user && (\n                  <>\n                    <Link to={createPageUrl('Home')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Home className=\"w-4 h-4\" />Home\n                    </Link>\n                    <Link to={createPageUrl('BrowseCleaners')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Search className=\"w-4 h-4\" />Browse Cleaners\n                    </Link>\n                    <Link to={createPageUrl('Pricing')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      Pricing\n                    </Link>\n                    <Link to={createPageUrl('Support')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <HelpCircle className=\"w-4 h-4\" />Support\n                    </Link>\n                  </>\n                )}\n\n                {user && userType === 'client' && (\n                  <>\n                    <Link to={createPageUrl('ClientDashboard')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Calendar className=\"w-4 h-4\" />Dashboard\n                    </Link>\n                    <Link to={createPageUrl('ClientBookings')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Calendar className=\"w-4 h-4\" />My Bookings\n                    </Link>\n                    <Link to={createPageUrl('MultiBooking')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Calendar className=\"w-4 h-4\" />Multi-Booking\n                    </Link>\n                    <Link to={createPageUrl('BrowseCleaners')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Search className=\"w-4 h-4\" />Browse Cleaners\n                    </Link>\n                    <Link to={createPageUrl('FavoriteCleaners')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Heart className=\"w-4 h-4\" />Favorites\n                    </Link>\n                    <Link to={createPageUrl('BuyCredits')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Wallet className=\"w-4 h-4\" />Buy Credits\n                    </Link>\n                  </>\n                )}\n\n                {user && userType === 'cleaner' && (\n                  <>\n                    <Link to={createPageUrl('CleanerDashboard')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Home className=\"w-4 h-4\" />Dashboard\n                    </Link>\n                    <Link to={createPageUrl('CleanerSchedule')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Calendar className=\"w-4 h-4\" />Schedule\n                    </Link>\n                    <Link to={createPageUrl('AIActivityDashboard')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <MessageSquare className=\"w-4 h-4\" />AI Assistant\n                    </Link>\n                    <Link to={createPageUrl('CleanerPayouts')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <Wallet className=\"w-4 h-4\" />Earnings\n                    </Link>\n                  </>\n                )}\n\n                {user && (userType === 'admin' || user.role === 'admin') && (\n                  <Link to={createPageUrl('AdminDashboard')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                    <Shield className=\"w-4 h-4\" />Admin Dashboard\n                  </Link>\n                )}\n\n                {user && (\n                  <>\n                    <Link to={createPageUrl('Inbox')} onClick={() => { setMobileMenuOpen(false); setUnreadCount(0); }} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50 relative\">\n                      <MessageSquare className=\"w-4 h-4\" />Messages\n                      {unreadCount > 0 && <Badge className=\"ml-auto bg-red-500 text-white font-fredoka\">{unreadCount}</Badge>}\n                    </Link>\n                    <div className=\"border-t border-gray-200 my-2\"></div>\n                    <Link to={createPageUrl('Profile')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <UserIcon className=\"w-4 h-4\" />My Profile\n                    </Link>\n                    <Link to={createPageUrl('Support')} onClick={() => setMobileMenuOpen(false)} className=\"flex items-center gap-2 px-4 py-3 rounded-full font-fredoka font-medium text-graphite hover:bg-gray-50\">\n                      <HelpCircle className=\"w-4 h-4\" />Support\n                    </Link>\n                    <Button onClick={handleLogout} variant=\"ghost\" className=\"flex items-center gap-2 px-4 py-3 text-red-600 hover:bg-red-50 rounded-full font-fredoka font-medium transition-all text-left w-full justify-start\">\n                      <LogOut className=\"w-4 h-4\" />Logout\n                    </Button>\n                  </>\n                )}\n\n                {!user && (\n                  <div className=\"flex flex-col gap-2 mt-4\">\n                    <Link to={createPageUrl('SignIn')} onClick={() => setMobileMenuOpen(false)}>\n                      <Button variant=\"outline\" className=\"w-full border-puretask-blue text-puretask-blue rounded-full font-fredoka font-semibold\">\n                        Sign In\n                      </Button>\n                    </Link>\n                    <Link to={createPageUrl('RoleSelection')} onClick={() => setMobileMenuOpen(false)}>\n                      <Button className=\"w-full brand-gradient text-white rounded-full font-fredoka font-semibold\">\n                        Get Started\n                      </Button>\n                    </Link>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </motion.nav>\n\n      <main className=\"pt-16\">{children}</main>\n\n      {user && <AIChatAssistant />}\n      \n      {/* Admin Page Info Panel - Only visible to admins */}\n      {user && (userType === 'admin' || user.role === 'admin') && (\n        <AdminPageInfo currentPageName={currentPageName} />\n      )}\n\n      {/* ENHANCED FOOTER */}\n      <footer className=\"bg-white border-t-4 mt-12 sm:mt-20\" style={{ borderColor: '#66B3FF' }}>\n        <div className=\"container mx-auto px-4 sm:px-6 py-8 sm:py-12 max-w-full overflow-hidden\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 sm:gap-8 mb-6 sm:mb-8\">\n            {/* Brand */}\n            <div className=\"sm:col-span-2 md:col-span-1\">\n              <Link to={createPageUrl('Home')} className=\"flex items-center gap-2 mb-3 sm:mb-4 hover:opacity-80 transition\">\n                <div className=\"w-10 h-10 sm:w-12 sm:h-12 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg flex-shrink-0\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n                  <Sparkles className=\"w-6 h-6 sm:w-7 sm:h-7 text-white\" />\n                </div>\n                <span className=\"text-2xl sm:text-3xl font-fredoka font-bold text-graphite\">PureTask</span>\n              </Link>\n              <p className=\"text-sm sm:text-base text-gray-600 font-verdana mb-3 sm:mb-4 leading-relaxed\">\n                Professional cleaning services with GPS tracking, photo proof, and verified cleaners.\n              </p>\n              <div className=\"flex gap-2 sm:gap-3 flex-wrap\">\n                <Badge className=\"text-white font-fredoka text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 border-0\" style={{ background: '#66B3FF' }}>‚úì Verified</Badge>\n                <Badge className=\"text-white font-fredoka text-xs sm:text-sm px-3 sm:px-4 py-1 sm:py-2 border-0\" style={{ background: '#28C76F' }}>‚úì Trusted</Badge>\n              </div>\n            </div>\n\n            {/* For Clients */}\n            <div>\n              <h3 className=\"font-fredoka font-bold mb-3 sm:mb-4 text-lg sm:text-xl text-puretask-blue\">For Clients</h3>\n              <div className=\"flex flex-col gap-2 sm:gap-3\">\n                <Link to={createPageUrl('BrowseCleaners')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Browse Cleaners\n                </Link>\n                <Link to={createPageUrl('Pricing')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Pricing\n                </Link>\n                <Link to={createPageUrl('HowItWorks')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />How It Works\n                </Link>\n                <Link to={createPageUrl('ReferralProgram')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <Gift className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Refer & Earn\n                </Link>\n              </div>\n            </div>\n\n            {/* For Cleaners */}\n            <div>\n              <h3 className=\"font-fredoka font-bold mb-4 text-xl text-puretask-blue\">For Cleaners</h3>\n              <div className=\"flex flex-col gap-3\">\n                <Link to={createPageUrl('HowItWorksCleaners')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />How It Works\n                </Link>\n                <Link to={createPageUrl('CleanerResources')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Resources\n                </Link>\n                <Link to={createPageUrl('RoleSelection')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Join & Earn\n                </Link>\n              </div>\n            </div>\n\n            {/* Company */}\n            <div>\n              <h3 className=\"font-fredoka font-bold mb-4 text-xl text-puretask-blue\">Company</h3>\n              <div className=\"flex flex-col gap-3\">\n                <Link to={createPageUrl('Support')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Support\n                </Link>\n                <Link to={createPageUrl('Legal')} className=\"text-base text-gray-700 hover:text-puretask-blue font-verdana transition-colors flex items-center gap-2 hover:gap-3 group\">\n                  <Scale className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />Legal Center\n                </Link>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"border-t-2 border-gray-200 pt-6 sm:pt-8 text-center\">\n            <p className=\"text-sm sm:text-base text-gray-600 font-verdana font-semibold\">\n              ¬© 2024 PureTask. All rights reserved.\n            </p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Legal.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Download' is defined but never used.","line":10,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23,"fix":{"range":[402,412],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Download"},"fix":{"range":[401,411],"text":""},"desc":"Remove unused variable 'Download'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'getColorClasses' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"getColorClasses"},"fix":{"range":[1001,1495],"text":""},"desc":"Remove unused variable 'getColorClasses'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { \n  Shield, FileText, Camera, Clock, AlertTriangle, \n  Scale, Eye, Lock, CheckCircle, DollarSign, Gift,\n  ArrowRight, Download, Mail\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function Legal() {\n  const [activeTab, setActiveTab] = useState('privacy');\n\n  const tabs = [\n    { id: 'privacy', label: 'Privacy Policy', icon: Shield, color: 'blue' },\n    { id: 'terms', label: 'Terms of Service', icon: FileText, color: 'green' },\n    { id: 'photo', label: 'Photo Consent', icon: Camera, color: 'purple' },\n    { id: 'cancellation', label: 'Cancellation Policy', icon: Clock, color: 'amber' },\n    { id: 'damage', label: 'Damage & Claims', icon: AlertTriangle, color: 'red' }\n  ];\n\n  const getColorClasses = (color) => {\n    const colors = {\n      blue: 'border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100',\n      green: 'border-green-200 bg-green-50 text-green-700 hover:bg-green-100',\n      purple: 'border-purple-200 bg-purple-50 text-purple-700 hover:bg-purple-100',\n      amber: 'border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100',\n      red: 'border-red-200 bg-red-50 text-red-700 hover:bg-red-100'\n    };\n    return colors[color] || colors.blue;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100 py-12 px-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center mb-12\"\n        >\n          <div className=\"w-20 h-20 brand-gradient rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg\">\n            <Scale className=\"w-10 h-10 text-white\" />\n          </div>\n          <h1 className=\"text-5xl lg:text-6xl font-fredoka font-bold text-graphite mb-4\">\n            Legal Center\n          </h1>\n          <p className=\"text-xl text-gray-600 font-verdana max-w-2xl mx-auto\">\n            Your guide to PureTask policies, terms, and protections\n          </p>\n          <p className=\"text-sm text-gray-500 font-verdana mt-2\">Last updated: November 2024</p>\n        </motion.div>\n\n        {/* Quick Links Grid */}\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12\">\n          {[\n            { \n              icon: Shield, \n              title: 'Privacy Policy', \n              desc: 'How we protect your data',\n              link: createPageUrl('PrivacyPolicy'),\n              color: 'blue'\n            },\n            { \n              icon: FileText, \n              title: 'Terms of Service', \n              desc: 'Platform rules & guidelines',\n              link: createPageUrl('TermsOfService'),\n              color: 'green'\n            },\n            { \n              icon: Camera, \n              title: 'Photo Consent', \n              desc: 'Transparency through photos',\n              link: createPageUrl('PhotoConsent'),\n              color: 'purple'\n            },\n            { \n              icon: Clock, \n              title: 'Cancellation Policy', \n              desc: 'Fees & grace cancellations',\n              link: createPageUrl('CancellationPolicy'),\n              color: 'amber'\n            },\n            { \n              icon: AlertTriangle, \n              title: 'Damage & Claims', \n              desc: 'Property protection policy',\n              link: createPageUrl('DamageClaimsPolicy'),\n              color: 'red'\n            },\n            { \n              icon: Mail, \n              title: 'Contact Legal', \n              desc: 'Get help with legal matters',\n              link: 'mailto:legal@puretask.com',\n              color: 'indigo'\n            }\n          ].map((item, idx) => (\n            <motion.div\n              key={idx}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.1 }}\n            >\n              <Link to={item.link}>\n                <Card className=\"h-full border-2 hover:shadow-xl transition-all duration-300 rounded-2xl cursor-pointer group\" \n                  style={{ \n                    borderColor: item.color === 'blue' ? '#93C5FD' : \n                               item.color === 'green' ? '#86EFAC' :\n                               item.color === 'purple' ? '#C4B5FD' :\n                               item.color === 'amber' ? '#FCD34D' :\n                               item.color === 'red' ? '#FCA5A5' : '#A5B4FC'\n                  }}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <div className=\"w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg flex-shrink-0\"\n                        style={{\n                          backgroundColor: item.color === 'blue' ? '#3B82F6' :\n                                         item.color === 'green' ? '#10B981' :\n                                         item.color === 'purple' ? '#8B5CF6' :\n                                         item.color === 'amber' ? '#F59E0B' :\n                                         item.color === 'red' ? '#EF4444' : '#6366F1'\n                        }}>\n                        <item.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"text-lg font-fredoka font-bold text-graphite mb-1 group-hover:text-puretask-blue transition-colors\">\n                          {item.title}\n                        </h3>\n                        <p className=\"text-sm text-gray-600 font-verdana\">{item.desc}</p>\n                        <div className=\"mt-3 flex items-center gap-1 text-puretask-blue text-sm font-verdana font-semibold\">\n                          <span>Read More</span>\n                          <ArrowRight className=\"w-4 h-4 group-hover:translate-x-1 transition-transform\" />\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* Tabbed Content Section */}\n        <Card className=\"border-0 shadow-2xl rounded-2xl overflow-hidden\">\n          {/* Tab Navigation */}\n          <div className=\"bg-white border-b-2 border-gray-200\">\n            <div className=\"flex overflow-x-auto\">\n              {tabs.map((tab) => {\n                const Icon = tab.icon;\n                const isActive = activeTab === tab.id;\n                return (\n                  <button\n                    key={tab.id}\n                    onClick={() => setActiveTab(tab.id)}\n                    className={`flex items-center gap-2 px-6 py-4 font-fredoka font-semibold whitespace-nowrap transition-all border-b-4 ${\n                      isActive \n                        ? 'border-puretask-blue text-puretask-blue bg-blue-50' \n                        : 'border-transparent text-gray-600 hover:bg-gray-50 hover:text-graphite'\n                    }`}\n                  >\n                    <Icon className=\"w-5 h-5\" />\n                    <span className=\"hidden md:inline\">{tab.label}</span>\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Tab Content */}\n          <div className=\"p-8 lg:p-12 bg-white\">\n            {activeTab === 'privacy' && <PrivacyContent />}\n            {activeTab === 'terms' && <TermsContent />}\n            {activeTab === 'photo' && <PhotoContent />}\n            {activeTab === 'cancellation' && <CancellationContent />}\n            {activeTab === 'damage' && <DamageContent />}\n          </div>\n        </Card>\n\n        {/* Contact Footer */}\n        <Card className=\"mt-12 border-0 shadow-xl rounded-2xl bg-gradient-to-r from-blue-50 to-cyan-50\">\n          <CardContent className=\"p-8 text-center\">\n            <h3 className=\"text-2xl font-fredoka font-bold text-graphite mb-4\">\n              Have Questions About Our Policies?\n            </h3>\n            <p className=\"text-gray-600 font-verdana mb-6 max-w-2xl mx-auto\">\n              Our team is here to help clarify any legal questions or concerns you may have.\n            </p>\n            <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n              <a href=\"mailto:legal@puretask.com\">\n                <Button className=\"brand-gradient text-white rounded-full font-fredoka font-semibold px-8 py-6 text-lg hover:scale-105 transition-transform\">\n                  <Mail className=\"w-5 h-5 mr-2\" />\n                  Contact Legal Team\n                </Button>\n              </a>\n              <Link to={createPageUrl('Support')}>\n                <Button variant=\"outline\" className=\"rounded-full font-fredoka font-semibold px-8 py-6 text-lg border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50\">\n                  Visit Support Center\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\n// Privacy Policy Content\nfunction PrivacyContent() {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n          <Shield className=\"w-8 h-8 text-puretask-blue\" />\n          Privacy Policy\n        </h2>\n        <p className=\"text-lg text-gray-600 font-verdana leading-relaxed mb-6\">\n          How we protect and handle your information\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <InfoSection \n          icon={Lock}\n          title=\"Information We Collect\"\n          items={[\n            'Account information (name, email, phone, payment details)',\n            'Location data (GPS) during check-in/out for verification',\n            'Before/after photos uploaded by cleaners',\n            'Booking details, addresses, preferences, and reviews'\n          ]}\n        />\n\n        <InfoSection \n          icon={Eye}\n          title=\"How We Use Your Information\"\n          items={[\n            'Facilitate bookings between clients and cleaners',\n            'Process payments and payouts securely',\n            'Calculate Reliability Scores for quality assurance',\n            'Verify GPS check-ins for trust and transparency',\n            'Send booking confirmations and reminders'\n          ]}\n        />\n\n        <InfoSection \n          icon={Shield}\n          title=\"Data Security\"\n          items={[\n            'All data encrypted in transit (SSL/TLS) and at rest',\n            'Role-based access controls for privacy',\n            'PII minimization - collect only what is necessary',\n            'Photos use tokenized URLs with expiring signed links'\n          ]}\n        />\n      </div>\n\n      <Link to={createPageUrl('PrivacyPolicy')}>\n        <Button className=\"mt-6 brand-gradient text-white rounded-full font-fredoka\">\n          Read Full Privacy Policy <ArrowRight className=\"w-4 h-4 ml-2\" />\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\n// Terms of Service Content\nfunction TermsContent() {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n          <FileText className=\"w-8 h-8 text-fresh-mint\" />\n          Terms of Service\n        </h2>\n        <p className=\"text-lg text-gray-600 font-verdana leading-relaxed mb-6\">\n          Platform rules, user responsibilities, and legal agreements\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <InfoSection \n          icon={CheckCircle}\n          title=\"Platform Usage\"\n          items={[\n            'Must be 18+ to use PureTask',\n            'Cleaners complete identity verification',\n            'Background checks for all service providers',\n            'Respect community guidelines and standards'\n          ]}\n        />\n\n        <InfoSection \n          icon={DollarSign}\n          title=\"Payment Terms\"\n          items={[\n            'Credits: 10 credits = $1 USD',\n            'Credits held in escrow until job completion',\n            'Platform fee: 15% of transaction value',\n            'Cleaners receive 80-85% based on tier'\n          ]}\n        />\n\n        <InfoSection \n          icon={Scale}\n          title=\"Independent Contractor Status\"\n          items={[\n            'Cleaners are independent contractors, not employees',\n            'Cleaners set their own rates and availability',\n            'Cleaners provide their own equipment',\n            'Responsible for own taxes and insurance'\n          ]}\n        />\n      </div>\n\n      <Link to={createPageUrl('TermsOfService')}>\n        <Button className=\"mt-6 brand-gradient text-white rounded-full font-fredoka\">\n          Read Full Terms of Service <ArrowRight className=\"w-4 h-4 ml-2\" />\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\n// Photo Consent Content\nfunction PhotoContent() {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n          <Camera className=\"w-8 h-8 text-purple-600\" />\n          Photo Proof & Consent\n        </h2>\n        <p className=\"text-lg text-gray-600 font-verdana leading-relaxed mb-6\">\n          Transparency through before/after documentation\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <InfoSection \n          icon={Eye}\n          title=\"Why Photo Proof Matters\"\n          items={[\n            'Transparency: Clients see exactly what was cleaned',\n            'Quality: Visual proof before payment release',\n            'Protection: Resolves disputes with evidence',\n            'Reliability: Boosts cleaner scores'\n          ]}\n        />\n\n        <InfoSection \n          icon={Camera}\n          title=\"Photo Requirements\"\n          items={[\n            'Minimum 3 photos total (before + after)',\n            'Good lighting and clear focus',\n            'No client PII visible',\n            'Automatically geotagged and timestamped'\n          ]}\n        />\n\n        <InfoSection \n          icon={Lock}\n          title=\"Photo Security\"\n          items={[\n            'Stored in private AWS S3 buckets',\n            'Signed, expiring URLs for access',\n            'EXIF data scrubbed for privacy',\n            'Retained for 90 days post-completion'\n          ]}\n        />\n      </div>\n\n      <Link to={createPageUrl('PhotoConsent')}>\n        <Button className=\"mt-6 brand-gradient text-white rounded-full font-fredoka\">\n          Read Full Photo Policy <ArrowRight className=\"w-4 h-4 ml-2\" />\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\n// Cancellation Policy Content\nfunction CancellationContent() {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n          <Clock className=\"w-8 h-8 text-amber-600\" />\n          Cancellation Policy\n        </h2>\n        <p className=\"text-lg text-gray-600 font-verdana leading-relaxed mb-6\">\n          Fees, grace cancellations, and refund policies\n        </p>\n      </div>\n\n      <div className=\"grid md:grid-cols-3 gap-4 mb-6\">\n        <Card className=\"border-2 border-green-200 bg-green-50\">\n          <CardContent className=\"p-6 text-center\">\n            <Badge className=\"bg-green-600 text-white text-xl mb-3 px-4 py-2\">0% Fee</Badge>\n            <h3 className=\"font-fredoka font-bold text-green-900 mb-2\">Free Cancellation</h3>\n            <p className=\"text-sm text-green-800 font-verdana\">More than 48 hours notice</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-2 border-amber-200 bg-amber-50\">\n          <CardContent className=\"p-6 text-center\">\n            <Badge className=\"bg-amber-600 text-white text-xl mb-3 px-4 py-2\">50% Fee</Badge>\n            <h3 className=\"font-fredoka font-bold text-amber-900 mb-2\">Partial Fee</h3>\n            <p className=\"text-sm text-amber-800 font-verdana\">24-48 hours notice</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-2 border-red-200 bg-red-50\">\n          <CardContent className=\"p-6 text-center\">\n            <Badge className=\"bg-red-600 text-white text-xl mb-3 px-4 py-2\">100% Fee</Badge>\n            <h3 className=\"font-fredoka font-bold text-red-900 mb-2\">Full Fee</h3>\n            <p className=\"text-sm text-red-800 font-verdana\">Less than 24 hours</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <InfoSection \n        icon={Gift}\n        title=\"Grace Cancellations\"\n        items={[\n          'Every client gets 2 free grace cancellations',\n          'Waives 50% or 100% fees for emergencies',\n          'Automatically offered during cancellation',\n          'Once used, they do not replenish'\n        ]}\n      />\n\n      <Link to={createPageUrl('CancellationPolicy')}>\n        <Button className=\"mt-6 brand-gradient text-white rounded-full font-fredoka\">\n          Read Full Cancellation Policy <ArrowRight className=\"w-4 h-4 ml-2\" />\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\n// Damage Claims Content\nfunction DamageContent() {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n          <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n          Damage & Claims Policy\n        </h2>\n        <p className=\"text-lg text-gray-600 font-verdana leading-relaxed mb-6\">\n          How we handle property damage and claims resolution\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <InfoSection \n          icon={Clock}\n          title=\"How to Report Damage\"\n          items={[\n            'Report within 48 hours of completion',\n            'Open a dispute in booking details',\n            'Provide clear photos and description',\n            'Include estimated repair costs'\n          ]}\n        />\n\n        <InfoSection \n          icon={CheckCircle}\n          title=\"What is Covered\"\n          items={[\n            'Accidental damage during cleaning',\n            'Damage from improper product use',\n            'Lost or misplaced items',\n            'Surface damage and breakage'\n          ]}\n        />\n\n        <InfoSection \n          icon={Scale}\n          title=\"Resolution Process\"\n          items={[\n            'Evidence review within 24-48 hours',\n            'Contact both parties for statements',\n            'Determine responsibility fairly',\n            'Process refunds or compensation'\n          ]}\n        />\n      </div>\n\n      <Link to={createPageUrl('DamageClaimsPolicy')}>\n        <Button className=\"mt-6 brand-gradient text-white rounded-full font-fredoka\">\n          Read Full Claims Policy <ArrowRight className=\"w-4 h-4 ml-2\" />\n        </Button>\n      </Link>\n    </div>\n  );\n}\n\n// Helper Component\nfunction InfoSection({ icon: Icon, title, items }) {\n  return (\n    <Card className=\"border-2 border-gray-200 rounded-2xl\">\n      <CardContent className=\"p-6\">\n        <h3 className=\"flex items-center gap-2 font-fredoka font-bold text-xl text-graphite mb-4\">\n          <Icon className=\"w-6 h-6 text-puretask-blue\" />\n          {title}\n        </h3>\n        <ul className=\"space-y-2\">\n          {items.map((item, idx) => (\n            <li key={idx} className=\"flex items-start gap-2 text-gray-700 font-verdana\">\n              <CheckCircle className=\"w-5 h-5 text-fresh-mint mt-0.5 flex-shrink-0\" />\n              <span>{item}</span>\n            </li>\n          ))}\n        </ul>\n      </CardContent>\n    </Card>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\LoyaltyDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ManageRecurringBookings.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[516,520],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":49,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":63,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":78,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Calendar, Pause, Play, X, RefreshCw, Clock, MapPin, User } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n\nexport default function ManageRecurringBookings() {\n  const [user, setUser] = useState(null);\n  const [recurringBookings, setRecurringBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n      \n      const bookings = await base44.entities.RecurringBooking.filter({ \n        client_email: currentUser.email \n      });\n      setRecurringBookings(bookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n      console.error('Failed to load recurring bookings');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const pauseBooking = async (id, days = 30) => {\n    try {\n      const pauseDate = new Date();\n      pauseDate.setDate(pauseDate.getDate() + days);\n      \n      await base44.entities.RecurringBooking.update(id, {\n        is_active: false,\n        pause_until: pauseDate.toISOString().split('T')[0]\n      });\n      \n      alert(`Recurring booking paused for ${days} days`);\n      loadData();\n    } catch (error) {\n      alert('Failed to pause booking');\n    }\n  };\n\n  const resumeBooking = async (id) => {\n    try {\n      await base44.entities.RecurringBooking.update(id, {\n        is_active: true,\n        pause_until: null\n      });\n      \n      alert('Recurring booking resumed');\n      loadData();\n    } catch (error) {\n      alert('Failed to resume booking');\n    }\n  };\n\n  const cancelBooking = async (id) => {\n    if (!confirm('Are you sure you want to cancel this recurring booking?')) return;\n    \n    try {\n      await base44.entities.RecurringBooking.update(id, {\n        is_active: false\n      });\n      \n      alert('Recurring booking cancelled');\n      loadData();\n    } catch (error) {\n      alert('Failed to cancel booking');\n    }\n  };\n\n  const frequencyLabels = {\n    weekly: 'Weekly',\n    biweekly: 'Every 2 Weeks',\n    monthly: 'Monthly'\n  };\n\n  if (loading) {\n    return (\n      <div className=\"container mx-auto px-6 py-12 max-w-4xl\">\n        <div className=\"text-center\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-6 py-12 max-w-4xl\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">\n          Recurring Bookings\n        </h1>\n        <p className=\"text-gray-600 font-verdana\">\n          Manage your scheduled recurring cleanings\n        </p>\n      </div>\n\n      {recurringBookings.length === 0 ? (\n        <Card>\n          <CardContent className=\"py-12 text-center\">\n            <RefreshCw className=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\n            <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">\n              No Recurring Bookings\n            </h3>\n            <p className=\"text-gray-600 font-verdana mb-6\">\n              Set up recurring bookings to automatically schedule regular cleanings\n            </p>\n            <Button className=\"brand-gradient text-white\">\n              Create Recurring Booking\n            </Button>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-4\">\n          {recurringBookings.map((booking) => (\n            <motion.div\n              key={booking.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.3 }}\n            >\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between\">\n                    <div>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <Calendar className=\"w-5 h-5 text-puretask-blue\" />\n                        {frequencyLabels[booking.frequency]} Cleaning\n                      </CardTitle>\n                      <p className=\"text-sm text-gray-600 mt-2\">\n                        Every {booking.day_of_week} at {booking.start_time}\n                      </p>\n                    </div>\n                    <Badge className={booking.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}>\n                      {booking.is_active ? 'Active' : 'Paused'}\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <User className=\"w-4 h-4 text-gray-500\" />\n                      <span className=\"text-gray-700\">{booking.cleaner_email}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <Clock className=\"w-4 h-4 text-gray-500\" />\n                      <span className=\"text-gray-700\">{booking.hours} hours</span>\n                    </div>\n                    <div className=\"flex items-center gap-2 text-sm col-span-2\">\n                      <MapPin className=\"w-4 h-4 text-gray-500\" />\n                      <span className=\"text-gray-700 truncate\">{booking.address}</span>\n                    </div>\n                  </div>\n\n                  {booking.next_booking_date && (\n                    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n                      <p className=\"text-sm text-blue-800 font-verdana\">\n                        <strong>Next cleaning:</strong> {new Date(booking.next_booking_date).toLocaleDateString()}\n                      </p>\n                    </div>\n                  )}\n\n                  {booking.pause_until && (\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n                      <p className=\"text-sm text-yellow-800 font-verdana\">\n                        <strong>Paused until:</strong> {new Date(booking.pause_until).toLocaleDateString()}\n                      </p>\n                    </div>\n                  )}\n\n                  <div className=\"flex gap-2 pt-2\">\n                    {booking.is_active ? (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => pauseBooking(booking.id)}\n                        className=\"flex items-center gap-2\"\n                      >\n                        <Pause className=\"w-4 h-4\" />\n                        Pause\n                      </Button>\n                    ) : (\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => resumeBooking(booking.id)}\n                        className=\"flex items-center gap-2\"\n                      >\n                        <Play className=\"w-4 h-4\" />\n                        Resume\n                      </Button>\n                    )}\n\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => cancelBooking(booking.id)}\n                      className=\"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <X className=\"w-4 h-4\" />\n                      Cancel\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ManageSubscription.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":12,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":67,"fix":{"range":[644,656],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[643,655],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":12,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":79,"fix":{"range":[656,668],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[655,667],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'startDate' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":89,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":89,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"startDate"},"fix":{"range":[3292,3344],"text":""},"desc":"Remove unused variable 'startDate'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Calendar, Pause, PlayCircle, XCircle, Loader2, TrendingUp, DollarSign, Clock, MapPin } from 'lucide-react';\n\nexport default function ManageSubscription() {\n  const [searchParams] = useSearchParams();\n  const subscriptionId = searchParams.get('id');\n  const [subscription, setSubscription] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [pauseDate, setPauseDate] = useState('');\n  const [message, setMessage] = useState({ type: '', text: '' });\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (subscriptionId) {\n      loadSubscription();\n    }\n  }, [subscriptionId]);\n\n  const loadSubscription = async () => {\n    try {\n      const sub = await base44.entities.CleaningSubscription.get(subscriptionId);\n      setSubscription(sub);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading subscription:', showToast: false });\n      setMessage({ type: 'error', text: 'Failed to load subscription' });\n    }\n    setLoading(false);\n  };\n\n  const handlePause = async () => {\n    if (!pauseDate) {\n      setMessage({ type: 'error', text: 'Please select a resume date' });\n      return;\n    }\n    \n    try {\n      await base44.entities.CleaningSubscription.update(subscriptionId, {\n        status: 'paused',\n        paused_until: pauseDate\n      });\n      \n      setMessage({ type: 'success', text: 'Subscription paused successfully' });\n      loadSubscription();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error pausing subscription:', showToast: false });\n      setMessage({ type: 'error', text: 'Failed to pause subscription' });\n    }\n  };\n\n  const handleResume = async () => {\n    try {\n      await base44.entities.CleaningSubscription.update(subscriptionId, {\n        status: 'active',\n        paused_until: null\n      });\n      \n      setMessage({ type: 'success', text: 'Subscription resumed successfully' });\n      loadSubscription();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resuming subscription:', showToast: false });\n      setMessage({ type: 'error', text: 'Failed to resume subscription' });\n    }\n  };\n\n  const handleCancel = async () => {\n    try {\n      // Check if this is a membership subscription (CleaningSubscription or ClientMembership)\n      const user = await base44.auth.me();\n      const memberships = await base44.entities.ClientMembership.filter({ \n        client_email: user.email,\n        status: 'active'\n      });\n      \n      let cancellationFee = 0;\n      let warningMessage = 'Are you sure you want to cancel your subscription? You will lose your 20% discount.';\n      \n      if (memberships.length > 0) {\n        const membership = memberships[0];\n        const startDate = new Date(membership.started_date);\n        const contractEndDate = new Date(membership.contract_end_date);\n        const now = new Date();\n        \n        // Check if within minimum commitment period\n        if (now < contractEndDate) {\n          const monthsRemaining = Math.ceil((contractEndDate - now) / (1000 * 60 * 60 * 24 * 30));\n          cancellationFee = monthsRemaining * membership.monthly_fee;\n          \n          warningMessage = `‚ö†Ô∏è EARLY CANCELLATION FEE\n          \nYou are cancelling within your 3-month minimum commitment period.\n\nRemaining months: ${monthsRemaining}\nEarly cancellation fee: $${cancellationFee.toFixed(2)}\n\nThis fee will be charged immediately to your payment method.\n\nAre you sure you want to proceed?`;\n        }\n      }\n      \n      const confirmed = window.confirm(warningMessage);\n      if (!confirmed) return;\n      \n      const reason = prompt('Why are you cancelling? (Optional)');\n      \n      // Process cancellation\n      await base44.entities.CleaningSubscription.update(subscriptionId, {\n        status: 'cancelled',\n        cancelled_date: new Date().toISOString(),\n        cancellation_reason: reason || 'No reason provided'\n      });\n      \n      // Update membership status and charge early cancellation fee if applicable\n      if (memberships.length > 0 && cancellationFee > 0) {\n        await base44.entities.ClientMembership.update(memberships[0].id, {\n          status: 'cancelled',\n          cancelled_date: new Date().toISOString(),\n          cancellation_reason: reason || 'No reason provided',\n          early_cancellation_fee: cancellationFee\n        });\n        \n        // Create credit transaction for the cancellation fee\n        await base44.entities.CreditTransaction.create({\n          user_email: user.email,\n          amount_credits: -cancellationFee * 10, // Convert to credits (assuming 1 credit = $0.10)\n          transaction_type: 'early_cancellation_fee',\n          description: `Early cancellation fee for membership (${Math.ceil((new Date(memberships[0].contract_end_date) - new Date()) / (1000 * 60 * 60 * 24 * 30))} months remaining)`,\n          status: 'completed'\n        });\n        \n        setMessage({ \n          type: 'success', \n          text: `Subscription cancelled. Early cancellation fee of $${cancellationFee.toFixed(2)} has been charged.` \n        });\n      } else {\n        if (memberships.length > 0) {\n          await base44.entities.ClientMembership.update(memberships[0].id, {\n            status: 'cancelled',\n            cancelled_date: new Date().toISOString(),\n            cancellation_reason: reason || 'No reason provided'\n          });\n        }\n        setMessage({ type: 'success', text: 'Subscription cancelled' });\n      }\n      \n      setTimeout(() => {\n        navigate(createPageUrl('ClientDashboard'));\n      }, 2000);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error cancelling subscription:', showToast: false });\n      setMessage({ type: 'error', text: 'Failed to cancel subscription' });\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  if (!subscription) {\n    return (\n      <div className=\"min-h-screen p-6 flex items-center justify-center\">\n        <Card className=\"max-w-md\">\n          <CardContent className=\"p-6 text-center\">\n            <p className=\"text-lg text-slate-600 mb-4\">Subscription not found</p>\n            <Button onClick={() => navigate(createPageUrl('ClientDashboard'))}>\n              Return to Dashboard\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const statusColors = {\n    active: 'bg-emerald-500',\n    paused: 'bg-amber-500',\n    cancelled: 'bg-slate-500'\n  };\n\n  return (\n    <div className=\"min-h-screen p-6 lg:p-10 bg-gradient-to-br from-slate-50 to-slate-100\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"mb-8\">\n          <Button variant=\"ghost\" onClick={() => navigate(createPageUrl('ClientDashboard'))} className=\"mb-4\">\n            ‚Üê Back to Dashboard\n          </Button>\n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Manage Your Subscription</h1>\n          <p className=\"text-lg text-slate-600\">Control your recurring cleaning schedule</p>\n        </div>\n\n        {message.text && (\n          <Alert className={`mb-6 ${message.type === 'error' ? 'border-red-200 bg-red-50' : 'border-emerald-200 bg-emerald-50'}`}>\n            <AlertDescription className={message.type === 'error' ? 'text-red-900' : 'text-emerald-900'}>\n              {message.text}\n            </AlertDescription>\n          </Alert>\n        )}\n\n        <div className=\"grid md:grid-cols-2 gap-6\">\n          {/* Subscription Details */}\n          <Card className=\"border-0 shadow-xl\">\n            <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n              <CardTitle className=\"flex items-center justify-between\">\n                <span>Subscription Details</span>\n                <Badge className={statusColors[subscription.status]}>\n                  {subscription.status}\n                </Badge>\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6 space-y-4\">\n              <div className=\"flex items-center gap-2 text-slate-600\">\n                <Clock className=\"w-4 h-4\" />\n                <span className=\"font-medium\">Frequency:</span>\n                <span className=\"capitalize\">{subscription.frequency}</span>\n              </div>\n              \n              <div className=\"flex items-center gap-2 text-slate-600\">\n                <Calendar className=\"w-4 h-4\" />\n                <span className=\"font-medium\">Day:</span>\n                <span>{subscription.day_of_week}</span>\n              </div>\n              \n              <div className=\"flex items-center gap-2 text-slate-600\">\n                <Clock className=\"w-4 h-4\" />\n                <span className=\"font-medium\">Time:</span>\n                <span>{subscription.preferred_time}</span>\n              </div>\n              \n              <div className=\"flex items-center gap-2 text-slate-600\">\n                <MapPin className=\"w-4 h-4\" />\n                <span className=\"font-medium\">Location:</span>\n                <span className=\"text-sm\">{subscription.address}</span>\n              </div>\n              \n              <div className=\"pt-4 border-t\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-slate-600\">Monthly Price:</span>\n                  <span className=\"text-2xl font-bold text-emerald-600\">\n                    ${subscription.monthly_price}\n                  </span>\n                </div>\n                <p className=\"text-xs text-slate-500 mt-1\">\n                  Includes 20% discount vs pay-per-booking\n                </p>\n              </div>\n\n              {subscription.next_booking_date && (\n                <div className=\"bg-blue-50 p-3 rounded-lg\">\n                  <p className=\"text-sm font-medium text-blue-900\">Next Cleaning:</p>\n                  <p className=\"text-sm text-blue-700\">\n                    {new Date(subscription.next_booking_date).toLocaleDateString()}\n                  </p>\n                </div>\n              )}\n\n              <div className=\"pt-4 border-t\">\n                <p className=\"text-sm text-slate-600\">\n                  <strong>Total Cleanings:</strong> {subscription.total_cleanings_completed || 0}\n                </p>\n                <p className=\"text-sm text-slate-600\">\n                  <strong>Started:</strong> {subscription.started_date ? new Date(subscription.started_date).toLocaleDateString() : 'N/A'}\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Actions */}\n          <Card className=\"border-0 shadow-xl\">\n            <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n              <CardTitle>Manage Subscription</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6 space-y-4\">\n              {subscription.status === 'active' && (\n                <>\n                  <div>\n                    <h3 className=\"font-semibold mb-2 flex items-center gap-2\">\n                      <Pause className=\"w-4 h-4\" />\n                      Pause Subscription\n                    </h3>\n                    <p className=\"text-sm text-slate-600 mb-3\">\n                      Temporarily pause your subscription. You can resume anytime.\n                    </p>\n                    <Label htmlFor=\"pauseDate\">Resume Date</Label>\n                    <Input\n                      id=\"pauseDate\"\n                      type=\"date\"\n                      value={pauseDate}\n                      onChange={(e) => setPauseDate(e.target.value)}\n                      min={new Date().toISOString().split('T')[0]}\n                      className=\"mb-2\"\n                    />\n                    <Button\n                      onClick={handlePause}\n                      variant=\"outline\"\n                      className=\"w-full border-amber-500 text-amber-600 hover:bg-amber-50\"\n                    >\n                      <Pause className=\"w-4 h-4 mr-2\" />\n                      Pause Subscription\n                    </Button>\n                  </div>\n\n                  <div className=\"pt-4 border-t\">\n                    <h3 className=\"font-semibold mb-2 flex items-center gap-2 text-red-600\">\n                      <XCircle className=\"w-4 h-4\" />\n                      Cancel Subscription\n                    </h3>\n                    <p className=\"text-sm text-slate-600 mb-3\">\n                      Cancel your subscription. This cannot be undone and you'll lose your discount.\n                    </p>\n                    <Button\n                      onClick={handleCancel}\n                      variant=\"outline\"\n                      className=\"w-full border-red-500 text-red-600 hover:bg-red-50\"\n                    >\n                      <XCircle className=\"w-4 h-4 mr-2\" />\n                      Cancel Subscription\n                    </Button>\n                  </div>\n                </>\n              )}\n\n              {subscription.status === 'paused' && (\n                <div>\n                  <h3 className=\"font-semibold mb-2 flex items-center gap-2\">\n                    <PlayCircle className=\"w-4 h-4\" />\n                    Resume Subscription\n                  </h3>\n                  {subscription.paused_until && (\n                    <p className=\"text-sm text-slate-600 mb-3\">\n                      Scheduled to resume on {new Date(subscription.paused_until).toLocaleDateString()}\n                    </p>\n                  )}\n                  <Button\n                    onClick={handleResume}\n                    className=\"w-full bg-emerald-500 hover:bg-emerald-600\"\n                  >\n                    <PlayCircle className=\"w-4 h-4 mr-2\" />\n                    Resume Now\n                  </Button>\n                </div>\n              )}\n\n              {subscription.status === 'cancelled' && (\n                <Alert className=\"border-slate-200 bg-slate-50\">\n                  <AlertDescription className=\"text-slate-700\">\n                    This subscription has been cancelled. To start a new subscription, book a cleaner and select the subscription option.\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              <div className=\"pt-4 border-t\">\n                <h3 className=\"font-semibold mb-2\">Need Help?</h3>\n                <p className=\"text-sm text-slate-600 mb-3\">\n                  Have questions about your subscription?\n                </p>\n                <Button\n                  onClick={() => navigate(createPageUrl('Support'))}\n                  variant=\"outline\"\n                  className=\"w-full\"\n                >\n                  Contact Support\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\MatchedCleaners.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":11,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":25,"fix":{"range":[481,489],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[480,488],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":11,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":32,"fix":{"range":[489,496],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[488,495],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Shield' is defined but never used.","line":11,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":40,"fix":{"range":[496,504],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Shield"},"fix":{"range":[495,503],"text":""},"desc":"Remove unused variable 'Shield'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Heart' is defined but never used.","line":11,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":47,"fix":{"range":[504,511],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Heart"},"fix":{"range":[503,510],"text":""},"desc":"Remove unused variable 'Heart'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":12,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":11,"fix":{"range":[531,543],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[530,542],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle' is defined but never used.","line":12,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":24,"fix":{"range":[543,556],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle"},"fix":{"range":[542,555],"text":""},"desc":"Remove unused variable 'CheckCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":12,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":36,"fix":{"range":[556,568],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[555,567],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Info' is defined but never used.","line":12,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":49,"fix":{"range":[575,581],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Info"},"fix":{"range":[574,580],"text":""},"desc":"Remove unused variable 'Info'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Filter' is defined but never used.","line":12,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":57,"fix":{"range":[580,588],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Filter"},"fix":{"range":[580,588],"text":""},"desc":"Remove unused variable 'Filter'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CleanerCard' is defined but never used.","line":15,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":19,"fix":{"range":[652,714],"text":"\n"},"suggestions":[{"messageId":"removeVar","data":{"varName":"CleanerCard"},"fix":{"range":[659,676],"text":""},"desc":"Remove unused variable 'CleanerCard'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[801,805],"text":""},"desc":"Remove unused variable 'user'."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":10,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Sparkles, Star, MapPin, Clock, Shield, Heart, Loader2, ArrowLeft,\n  Calendar, CheckCircle, TrendingUp, Award, Info, Filter\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport CleanerCard from '../components/cleaner/CleanerCard';\n\nexport default function MatchedCleaners() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [cleaners, setCleaners] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [bookingData, setBookingData] = useState(null);\n  const [addOns, setAddOns] = useState({});\n\n  useEffect(() => {\n    loadMatchedCleaners();\n  }, []);\n\n  const loadMatchedCleaners = async () => {\n    try {\n      // Check auth\n      const currentUser = await base44.auth.me();\n      if (!currentUser || currentUser.user_type !== 'client') {\n        navigate(createPageUrl('ClientSignup'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load booking data from localStorage\n      const savedBooking = localStorage.getItem('bookingDraft');\n      const savedAddOns = localStorage.getItem('bookingAddOns');\n      \n      if (!savedBooking) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n\n      const booking = JSON.parse(savedBooking);\n      setBookingData(booking);\n      \n      if (savedAddOns) {\n        setAddOns(JSON.parse(savedAddOns));\n      }\n\n      // Fetch all cleaners\n      const allCleaners = await base44.entities.CleanerProfile.filter({ is_active: true });\n\n      // Filter by location (within reasonable distance)\n      // Sort by tier (Elite > Pro > Semi Pro > Developing)\n      const tierOrder = { 'Elite': 4, 'Pro': 3, 'Semi Pro': 2, 'Developing': 1 };\n      \n      const sortedCleaners = allCleaners\n        .sort((a, b) => {\n          // First by tier\n          const tierDiff = (tierOrder[b.tier] || 0) - (tierOrder[a.tier] || 0);\n          if (tierDiff !== 0) return tierDiff;\n          \n          // Then by reliability score\n          return (b.reliability_score || 0) - (a.reliability_score || 0);\n        });\n\n      setCleaners(sortedCleaners);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading cleaners:', showToast: false });\n      alert('Failed to load cleaners. Please try again.');\n      navigate(createPageUrl('Home'));\n    }\n    setLoading(false);\n  };\n\n  const handleSelectCleaner = (cleaner) => {\n    // Save selected cleaner\n    localStorage.setItem('selectedCleaner', cleaner.user_email);\n    \n    // Navigate to add-ons selection first\n    navigate(createPageUrl(`AdditionalServices?cleaner=${cleaner.user_email}`));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-16 h-16 animate-spin text-puretask-blue mx-auto mb-4\" />\n          <p className=\"text-gray-600 font-verdana\">Finding perfect cleaners for you...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <Button\n            onClick={() => navigate(-1)}\n            variant=\"ghost\"\n            className=\"mb-4 rounded-full font-fredoka\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back\n          </Button>\n\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-14 h-14 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <Sparkles className=\"w-7 h-7 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">\n                Available Cleaners for You\n              </h1>\n              <p className=\"text-gray-600 font-verdana\">\n                Showing {cleaners.length} verified cleaner{cleaners.length !== 1 ? 's' : ''} ‚Ä¢ Sorted by tier & rating\n              </p>\n            </div>\n          </div>\n\n          {/* Booking Summary */}\n          {bookingData && (\n            <Card className=\"border-0 shadow-lg rounded-2xl bg-gradient-to-r from-blue-50 to-cyan-50\">\n              <CardContent className=\"p-6\">\n                <div className=\"grid md:grid-cols-4 gap-4 text-center\">\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Service</p>\n                    <p className=\"font-fredoka font-bold text-graphite capitalize\">{bookingData.serviceType}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Date & Time</p>\n                    <p className=\"font-fredoka font-bold text-graphite\">\n                      {new Date(bookingData.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} ‚Ä¢ {bookingData.time}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Duration</p>\n                    <p className=\"font-fredoka font-bold text-graphite\">{bookingData.recommendedHours} hours</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 font-verdana mb-1\">Add-Ons</p>\n                    <p className=\"font-fredoka font-bold text-graphite\">{Object.keys(addOns).length} selected</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        {/* Info Alert */}\n        <Alert className=\"mb-8 border-2 border-purple-200 bg-purple-50 rounded-2xl\">\n          <Award className=\"w-5 h-5 text-purple-600\" />\n          <AlertDescription className=\"font-verdana text-gray-700\">\n            <strong>Tier Priority:</strong> Higher-tier cleaners appear first because they have proven track records of excellence. All cleaners are verified and background-checked.\n          </AlertDescription>\n        </Alert>\n\n        {/* Cleaners List */}\n        <div className=\"space-y-6\">\n          {cleaners.length > 0 ? (\n            cleaners.map((cleaner, idx) => (\n              <motion.div\n                key={cleaner.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.1 }}\n              >\n                <Card className=\"border-0 shadow-xl rounded-2xl hover:shadow-2xl transition-all overflow-hidden\">\n                  <CardContent className=\"p-0\">\n                    <div className=\"grid lg:grid-cols-4 gap-6 p-6\">\n                      {/* Profile Section */}\n                      <div className=\"lg:col-span-1\">\n                        <div className=\"relative\">\n                          {cleaner.profile_photo_url ? (\n                            <img\n                              src={cleaner.profile_photo_url}\n                              alt={cleaner.full_name}\n                              className=\"w-full h-48 object-cover rounded-xl\"\n                            />\n                          ) : (\n                            <div className=\"w-full h-48 brand-gradient rounded-xl flex items-center justify-center\">\n                              <span className=\"text-5xl text-white font-fredoka font-bold\">\n                                {cleaner.full_name?.[0] || 'C'}\n                              </span>\n                            </div>\n                          )}\n                          <Badge \n                            className=\"absolute top-3 right-3 font-fredoka font-bold shadow-lg\"\n                            style={{\n                              backgroundColor: cleaner.tier === 'Elite' ? '#FBBF24' :\n                                             cleaner.tier === 'Pro' ? '#66B3FF' :\n                                             cleaner.tier === 'Semi Pro' ? '#00D4FF' : '#9CA3AF',\n                              color: 'white'\n                            }}\n                          >\n                            {cleaner.tier}\n                          </Badge>\n                        </div>\n                        <h3 className=\"font-fredoka font-bold text-xl text-graphite mt-3\">\n                          {cleaner.full_name}\n                        </h3>\n                        <div className=\"flex items-center gap-2 mt-2\">\n                          <Star className=\"w-4 h-4 text-amber-500 fill-amber-500\" />\n                          <span className=\"font-fredoka font-semibold text-graphite\">\n                            {cleaner.average_rating?.toFixed(1) || '5.0'}\n                          </span>\n                          <span className=\"text-sm text-gray-500 font-verdana\">\n                            ({cleaner.total_reviews || 0} reviews)\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* Details Section */}\n                      <div className=\"lg:col-span-2\">\n                        {cleaner.bio && (\n                          <p className=\"text-gray-600 font-verdana mb-4 line-clamp-3\">\n                            {cleaner.bio}\n                          </p>\n                        )}\n\n                        <div className=\"grid grid-cols-2 gap-4 mb-4\">\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana mb-1\">Base Rate</p>\n                            <p className=\"font-fredoka font-bold text-graphite\">\n                              {cleaner.base_rate_credits_per_hour || 300} credits/hr\n                            </p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">\n                              ‚âà ${((cleaner.base_rate_credits_per_hour || 300) / 10).toFixed(0)}/hr\n                            </p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-500 font-verdana mb-1\">Reliability</p>\n                            <div className=\"flex items-center gap-2\">\n                              <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                                <div \n                                  className=\"h-2 rounded-full\"\n                                  style={{\n                                    width: `${cleaner.reliability_score || 75}%`,\n                                    backgroundColor: cleaner.reliability_score >= 90 ? '#28C76F' :\n                                                   cleaner.reliability_score >= 75 ? '#66B3FF' : '#9CA3AF'\n                                  }}\n                                />\n                              </div>\n                              <span className=\"font-fredoka font-bold text-sm\">\n                                {cleaner.reliability_score || 75}%\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        {cleaner.specialty_tags && cleaner.specialty_tags.length > 0 && (\n                          <div className=\"flex flex-wrap gap-2\">\n                            {cleaner.specialty_tags.slice(0, 5).map((tag, i) => (\n                              <Badge key={i} variant=\"outline\" className=\"rounded-full font-fredoka text-xs\">\n                                {tag}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Action Section */}\n                      <div className=\"lg:col-span-1 flex flex-col justify-center\">\n                        <div className=\"space-y-3\">\n                          <div className=\"p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl border-2 border-purple-200 text-center\">\n                            <p className=\"text-sm text-gray-600 font-verdana mb-1\">Estimated Total</p>\n                            <p className=\"text-3xl font-fredoka font-bold text-purple-600\">\n                              {Math.round((cleaner.base_rate_credits_per_hour || 300) * (bookingData?.recommendedHours || 3))}\n                            </p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">credits</p>\n                          </div>\n\n                          <Button\n                            onClick={() => handleSelectCleaner(cleaner)}\n                            className=\"w-full brand-gradient text-white rounded-full font-fredoka font-bold py-6 shadow-xl hover:shadow-2xl\"\n                          >\n                            Select Cleaner\n                          </Button>\n\n                          <Button\n                            onClick={() => navigate(createPageUrl(`CleanerProfile?email=${cleaner.user_email}`))}\n                            variant=\"outline\"\n                            className=\"w-full rounded-full font-fredoka font-semibold border-2\"\n                          >\n                            View Full Profile\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))\n          ) : (\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardContent className=\"p-12 text-center\">\n                <Sparkles className=\"w-20 h-20 text-gray-300 mx-auto mb-4\" />\n                <h3 className=\"font-fredoka font-bold text-graphite text-2xl mb-2\">\n                  No cleaners available\n                </h3>\n                <p className=\"text-gray-600 font-verdana mb-6\">\n                  Try adjusting your date/time or location\n                </p>\n                <Button\n                  onClick={() => navigate(createPageUrl('Home'))}\n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                >\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Go Back & Adjust\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\MultiBooking.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[374,381],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[375,381],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":8,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":33,"fix":{"range":[380,398],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[380,398],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[887,891],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'addBookingToCart' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":64,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"addBookingToCart"},"fix":{"range":[2174,2692],"text":""},"desc":"Remove unused variable 'addBookingToCart'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { base44 } from '@/api/base44Client';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ArrowLeft, Plus, Repeat, Loader2, ArrowRight } from 'lucide-react';\nimport AddressAutocomplete from '@/components/address/AddressAutocomplete';\nimport MultiBookingCalendar from '@/components/booking/MultiBookingCalendar';\nimport BookingCart from '@/components/booking/BookingCart';\nimport RecurringBookingSetup from '@/components/booking/RecurringBookingSetup';\n\nexport default function MultiBooking() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [mode, setMode] = useState('individual'); // 'individual' or 'recurring'\n  const [bookingCart, setBookingCart] = useState([]);\n  const [currentBooking, setCurrentBooking] = useState({\n    address: '',\n    latitude: null,\n    longitude: null,\n    serviceType: 'basic',\n    hours: 3,\n    date: '',\n    time: '',\n    estimatedCredits: 0\n  });\n  const [selectedDates, setSelectedDates] = useState([]);\n  const [appliedOffer, setAppliedOffer] = useState(null);\n  const [showRecurringSetup, setShowRecurringSetup] = useState(false);\n\n  useEffect(() => {\n    checkUser();\n  }, []);\n\n  const checkUser = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('SignIn'));\n        return;\n      }\n      setUser(currentUser);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading user:', showToast: false });\n      navigate(createPageUrl('SignIn'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const calculateEstimatedCredits = (booking) => {\n    const baseRateMap = {\n      basic: 300,\n      deep: 330,\n      moveout: 330\n    };\n    return baseRateMap[booking.serviceType] * booking.hours;\n  };\n\n  const addBookingToCart = () => {\n    if (!currentBooking.date || !currentBooking.time) {\n      alert('Please select a date and time');\n      return;\n    }\n\n    const bookingWithEstimate = {\n      ...currentBooking,\n      estimatedCredits: calculateEstimatedCredits(currentBooking)\n    };\n\n    setBookingCart([...bookingCart, bookingWithEstimate]);\n    \n    // Reset current booking but keep address\n    setCurrentBooking({\n      ...currentBooking,\n      date: '',\n      time: '',\n      estimatedCredits: 0\n    });\n  };\n\n  const addMultipleDatesAsBookings = () => {\n    if (selectedDates.length === 0) {\n      alert('Please select at least one date');\n      return;\n    }\n    if (!currentBooking.time) {\n      alert('Please select a time');\n      return;\n    }\n\n    const newBookings = selectedDates.map(date => ({\n      ...currentBooking,\n      date,\n      estimatedCredits: calculateEstimatedCredits(currentBooking)\n    }));\n\n    setBookingCart([...bookingCart, ...newBookings]);\n    setSelectedDates([]);\n  };\n\n  const removeBookingFromCart = (index) => {\n    setBookingCart(bookingCart.filter((_, i) => i !== index));\n  };\n\n  const editBooking = (index) => {\n    const booking = bookingCart[index];\n    setCurrentBooking(booking);\n    removeBookingFromCart(index);\n  };\n\n  const handleRecurringGenerate = (recurringData) => {\n    const newBookings = recurringData.dates.map(date => ({\n      ...currentBooking,\n      date,\n      estimatedCredits: calculateEstimatedCredits(currentBooking)\n    }));\n\n    setBookingCart([...bookingCart, ...newBookings]);\n    setShowRecurringSetup(false);\n    setMode('individual');\n  };\n\n  // Calculate totals and check for bundle offers\n  const totalOriginalPrice = bookingCart.reduce((sum, b) => sum + b.estimatedCredits, 0);\n  const totalDiscount = appliedOffer ? (totalOriginalPrice * (appliedOffer.discount_percentage / 100)) : 0;\n  const finalTotalPrice = totalOriginalPrice - totalDiscount;\n\n  useEffect(() => {\n    checkBundleOffers();\n  }, [bookingCart]);\n\n  const checkBundleOffers = async () => {\n    if (bookingCart.length === 0) {\n      setAppliedOffer(null);\n      return;\n    }\n\n    try {\n      const offers = await base44.entities.BundleOffer.filter({\n        offer_type: 'multi_booking',\n        is_active: true\n      });\n\n      const qualifyingOffer = offers.find(offer => {\n        const minBookings = offer.conditions?.min_bookings || 0;\n        return bookingCart.length >= minBookings;\n      });\n\n      setAppliedOffer(qualifyingOffer || null);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error checking bundle offers:', showToast: false });\n    }\n  };\n\n  const calculateTotals = () => {\n    const subtotal = totalOriginalPrice / 10; // Convert credits to dollars\n    const discount = totalDiscount / 10;\n    const finalTotal = finalTotalPrice / 10;\n    return { subtotal, discount, finalTotal, appliedOffer };\n  };\n\n  const proceedToCheckout = () => {\n    const totals = calculateTotals();\n    const cartData = {\n      bookings: bookingCart,\n      subtotal: totals.subtotal,\n      discount: totals.discount,\n      finalTotal: totals.finalTotal,\n      appliedOffer: totals.appliedOffer\n    };\n    localStorage.setItem('multiBookingCart', JSON.stringify(cartData));\n    navigate(createPageUrl('MultiBookingCheckout'));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud py-8\">\n      <div className=\"container mx-auto px-4 max-w-7xl\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(createPageUrl('ClientDashboard'))}\n            className=\"mb-4 font-fredoka\"\n          >\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Back to Dashboard\n          </Button>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n            Multi-Booking\n          </h1>\n          <p className=\"text-gray-600 font-verdana\">\n            Book multiple cleanings and save with bundle discounts\n          </p>\n        </div>\n\n        {/* Mode Selection */}\n        <div className=\"grid grid-cols-2 gap-4 mb-8\">\n          <button\n            onClick={() => {\n              setMode('individual');\n              setShowRecurringSetup(false);\n            }}\n            className={`p-4 rounded-2xl border-2 transition-all ${\n              mode === 'individual'\n                ? 'border-puretask-blue bg-blue-50 shadow-lg'\n                : 'border-gray-300 bg-white hover:border-puretask-blue'\n            }`}\n          >\n            <Plus className=\"w-8 h-8 mx-auto mb-2 text-puretask-blue\" />\n            <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Individual Bookings</h3>\n            <p className=\"text-sm text-gray-600 font-verdana\">Add multiple bookings one by one</p>\n          </button>\n          <button\n            onClick={() => setMode('recurring')}\n            className={`p-4 rounded-2xl border-2 transition-all ${\n              mode === 'recurring'\n                ? 'border-purple-500 bg-purple-50 shadow-lg'\n                : 'border-gray-300 bg-white hover:border-purple-500'\n            }`}\n          >\n            <Repeat className=\"w-8 h-8 mx-auto mb-2 text-purple-600\" />\n            <h3 className=\"font-fredoka font-bold text-graphite mb-1\">Recurring Bookings</h3>\n            <p className=\"text-sm text-gray-600 font-verdana\">Set up repeating appointments</p>\n          </button>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-8\">\n          {/* Left Column - Booking Form */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Common Fields */}\n            <Card className=\"border-2 border-gray-200 rounded-2xl\">\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-graphite\">Booking Details</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {/* Address */}\n                <AddressAutocomplete\n                  value={currentBooking.address}\n                  onChange={(address) => setCurrentBooking({ ...currentBooking, address })}\n                  onLocationSelect={(location) => setCurrentBooking({\n                    ...currentBooking,\n                    address: location.address,\n                    latitude: location.latitude,\n                    longitude: location.longitude\n                  })}\n                  label=\"Service Address\"\n                  required\n                />\n\n                {/* Service Type */}\n                <div>\n                  <label className=\"block text-sm font-fredoka font-semibold mb-2 text-graphite\">\n                    Service Type\n                  </label>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    {[\n                      { value: 'basic', label: 'Basic' },\n                      { value: 'deep', label: 'Deep' },\n                      { value: 'moveout', label: 'Move-Out' }\n                    ].map(type => (\n                      <button\n                        key={type.value}\n                        type=\"button\"\n                        onClick={() => setCurrentBooking({ ...currentBooking, serviceType: type.value })}\n                        className={`p-3 rounded-xl font-fredoka font-semibold transition-all border-2 ${\n                          currentBooking.serviceType === type.value\n                            ? 'border-puretask-blue bg-puretask-blue text-white'\n                            : 'border-gray-300 bg-white hover:border-puretask-blue'\n                        }`}\n                      >\n                        {type.label}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Hours */}\n                <div>\n                  <label className=\"block text-sm font-fredoka font-semibold mb-2 text-graphite\">\n                    Hours: {currentBooking.hours}\n                  </label>\n                  <div className=\"grid grid-cols-5 gap-2\">\n                    {[2, 3, 4, 5, 6, 8].map(hours => (\n                      <button\n                        key={hours}\n                        type=\"button\"\n                        onClick={() => setCurrentBooking({ ...currentBooking, hours })}\n                        className={`p-3 rounded-xl font-fredoka font-bold transition-all border-2 ${\n                          currentBooking.hours === hours\n                            ? 'bg-green-500 text-white border-green-600'\n                            : 'bg-white text-gray-700 border-gray-300 hover:border-green-400'\n                        }`}\n                      >\n                        {hours}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Time */}\n                <div>\n                  <label className=\"block text-sm font-fredoka font-semibold mb-2 text-graphite\">\n                    Start Time\n                  </label>\n                  <select\n                    value={currentBooking.time}\n                    onChange={(e) => setCurrentBooking({ ...currentBooking, time: e.target.value })}\n                    className=\"w-full rounded-xl font-verdana border-2 h-12 px-4\"\n                    required\n                  >\n                    <option value=\"\">Select time</option>\n                    {['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00'].map(time => (\n                      <option key={time} value={time}>{time}</option>\n                    ))}\n                  </select>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Individual Booking Mode */}\n            {mode === 'individual' && !showRecurringSetup && (\n              <>\n                <MultiBookingCalendar\n                  selectedDates={selectedDates}\n                  onDatesChange={setSelectedDates}\n                />\n                \n                <div className=\"flex gap-3\">\n                  <Button\n                    onClick={addMultipleDatesAsBookings}\n                    disabled={selectedDates.length === 0 || !currentBooking.time}\n                    className=\"flex-1 bg-puretask-blue hover:bg-blue-600 text-white rounded-full font-fredoka font-semibold py-6\"\n                  >\n                    <Plus className=\"w-5 h-5 mr-2\" />\n                    Add {selectedDates.length} Booking{selectedDates.length !== 1 ? 's' : ''} to Cart\n                  </Button>\n                  <Button\n                    onClick={() => setShowRecurringSetup(true)}\n                    variant=\"outline\"\n                    className=\"border-2 border-purple-500 text-purple-600 hover:bg-purple-50 rounded-full font-fredoka font-semibold py-6\"\n                  >\n                    <Repeat className=\"w-5 h-5 mr-2\" />\n                    Set Up Recurring\n                  </Button>\n                </div>\n              </>\n            )}\n\n            {/* Recurring Booking Mode */}\n            {(mode === 'recurring' || showRecurringSetup) && currentBooking.date && (\n              <RecurringBookingSetup\n                bookingTemplate={currentBooking}\n                onGenerateDates={handleRecurringGenerate}\n                onCancel={() => {\n                  setShowRecurringSetup(false);\n                  setMode('individual');\n                }}\n              />\n            )}\n          </div>\n\n          {/* Right Column - Cart */}\n          <div className=\"lg:col-span-1\">\n            <BookingCart\n              bookings={bookingCart}\n              onRemoveBooking={removeBookingFromCart}\n              onEditBooking={editBooking}\n              appliedOffer={appliedOffer}\n              totalOriginalPrice={totalOriginalPrice}\n              totalDiscount={totalDiscount}\n              finalTotalPrice={finalTotalPrice}\n            />\n\n            {bookingCart.length > 0 && (\n              <Button\n                onClick={proceedToCheckout}\n                className=\"w-full mt-4 bg-gradient-to-r from-puretask-blue to-cyan-500 text-white rounded-full font-fredoka font-bold py-6 text-lg shadow-xl hover:shadow-2xl\"\n              >\n                Proceed to Checkout\n                <ArrowRight className=\"w-5 h-5 ml-2\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\MultiBookingCheckout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\MultiBookingConfirmation.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\NotificationTestPage.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Mail' is defined but never used.","line":7,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":56,"fix":{"range":[278,284],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Mail"},"fix":{"range":[277,283],"text":""},"desc":"Remove unused variable 'Mail'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":7,"column":77,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":84,"fix":{"range":[303,312],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[302,311],"text":""},"desc":"Remove unused variable 'XCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CleanerSMSTemplates' is defined but never used.","line":10,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":61,"fix":{"range":[526,547],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CleanerSMSTemplates"},"fix":{"range":[526,547],"text":""},"desc":"Remove unused variable 'CleanerSMSTemplates'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'authError' is defined but never used.","line":43,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":43,"endColumn":25}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":3,"fixableWarningCount":0,"source":"// Notification Test Page\r\n// Interactive page to test all notification flows\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { base44 } from '@/api/base44Client';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Loader2, Bell, MessageSquare, Smartphone, Mail, Zap, CheckCircle2, XCircle, AlertTriangle } from 'lucide-react';\r\nimport { jobEventBus } from '@/services/jobEvents';\r\nimport { clientNotificationService } from '@/services/clientNotificationService';\r\nimport { smsService, ClientSMSTemplates, CleanerSMSTemplates } from '@/services/smsService';\r\nimport { pushNotificationService, ClientPushTemplates } from '@/services/pushNotificationService';\r\nimport { realTimeNotificationService } from '@/services/realTimeNotificationService';\r\nimport { notificationIntegration } from '@/services/notificationIntegration';\r\n\r\nexport default function NotificationTestPage() {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [testJob, setTestJob] = useState(null);\r\n  const [testCleaner, setTestCleaner] = useState(null);\r\n  const [testClient, setTestClient] = useState(null);\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [systemStatus, setSystemStatus] = useState({\r\n    inApp: true,\r\n    email: true,\r\n    sms: false,\r\n    push: false,\r\n    realTime: 'polling'\r\n  });\r\n\r\n  useEffect(() => {\r\n    initialize();\r\n  }, []);\r\n\r\n  const initialize = async () => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      // Try to get current user (but don't fail if not logged in)\r\n      let currentUser = null;\r\n      try {\r\n        currentUser = await base44.auth.me();\r\n        setUser(currentUser);\r\n      } catch (authError) {\r\n        console.log('Not logged in - using mock data for testing');\r\n      }\r\n\r\n      // Check system capabilities\r\n      checkSystemStatus();\r\n\r\n      // Initialize notification integration (may fail without auth, that's OK)\r\n      try {\r\n        await notificationIntegration.initialize();\r\n        \r\n        // Initialize real-time notifications if we have a user\r\n        if (currentUser) {\r\n          await notificationIntegration.initializeRealTime(currentUser.email);\r\n        }\r\n      } catch (integrationError) {\r\n        console.log('Notification integration skipped:', integrationError.message);\r\n      }\r\n\r\n      // Subscribe to notifications\r\n      clientNotificationService.subscribe((notification) => {\r\n        addNotificationLog('CLIENT_SERVICE', notification);\r\n      });\r\n\r\n      realTimeNotificationService.subscribe((notification) => {\r\n        addNotificationLog('REAL_TIME', notification);\r\n      });\r\n\r\n      // ALWAYS create test job data (works without auth)\r\n      createTestData();\r\n\r\n    } catch (error) {\r\n      console.error('Failed to initialize:', error);\r\n      // Even if initialization fails, create test data so buttons work\r\n      createTestData();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const checkSystemStatus = () => {\r\n    setSystemStatus({\r\n      inApp: true,\r\n      email: true,\r\n      sms: smsService.isEnabled(),\r\n      push: pushNotificationService.isEnabled(),\r\n      realTime: realTimeNotificationService.getMode()\r\n    });\r\n  };\r\n\r\n  const createTestData = () => {\r\n    // Create mock job with CORRECT property names from schema\r\n    const mockJob = {\r\n      id: 'test_job_' + Date.now(),\r\n      client_id: user?.email || 'client@test.com',\r\n      client_email: user?.email || 'client@test.com',\r\n      assigned_cleaner_id: 'cleaner@test.com',\r\n      assigned_cleaner_email: 'cleaner@test.com',\r\n      status: 'OFFERED', // legacy\r\n      state: 'OFFERED',\r\n      sub_state: 'NONE',\r\n      date: new Date().toISOString().split('T')[0],\r\n      time: '09:00', // ‚úÖ CORRECT: scheduled time\r\n      duration_hours: 3, // ‚úÖ CORRECT: not estimated_hours\r\n      pricing_snapshot: { // ‚úÖ CORRECT: price is in snapshot\r\n        total_price: 120,\r\n        hourly_rate: 40,\r\n        base_price: 100,\r\n        breakdown: { base: 100, total: 120 }\r\n      },\r\n      latitude: 34.0522,\r\n      longitude: -118.2437,\r\n      address: '123 Main St, Los Angeles, CA 90012',\r\n      cleaning_type: 'deep',\r\n      bedrooms: 2,\r\n      bathrooms: 2,\r\n      square_feet: 1200,\r\n      // Timestamps (all null initially)\r\n      created_at: new Date().toISOString(),\r\n      assigned_at: null,\r\n      start_at: null,\r\n      end_at: null,\r\n      // Flags\r\n      has_pending_extra_time_request: false,\r\n      has_pending_reschedule_request: false,\r\n      requires_before_photos: true,\r\n      requires_after_photos: true,\r\n      before_photos_count: 0,\r\n      after_photos_count: 0\r\n    };\r\n\r\n    const mockCleaner = {\r\n      id: 'cleaner_profile_1',\r\n      user_email: 'cleaner@test.com',\r\n      name: 'Jane Smith',\r\n      phone: '+12345678901',\r\n      payout_percentage: 0.8,\r\n      reliability_score: 95\r\n    };\r\n\r\n    const mockClient = {\r\n      id: 'client_profile_1',\r\n      user_email: user?.email || 'client@test.com',\r\n      first_name: user?.first_name || 'John',\r\n      phone: user?.phone || '+19876543210'\r\n    };\r\n\r\n    setTestJob(mockJob);\r\n    setTestCleaner(mockCleaner);\r\n    setTestClient(mockClient);\r\n  };\r\n\r\n  const addNotificationLog = (source, data) => {\r\n    setNotifications(prev => [\r\n      {\r\n        id: Date.now() + Math.random(),\r\n        timestamp: new Date().toISOString(),\r\n        source: source,\r\n        data: data\r\n      },\r\n      ...prev.slice(0, 19) // Keep last 20\r\n    ]);\r\n  };\r\n\r\n  // ============================================================================\r\n  // TEST FUNCTIONS\r\n  // ============================================================================\r\n\r\n  const testJobAccepted = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering JOB_ASSIGNED event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_ASSIGNED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'JOB_ASSIGNED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testCleanerEnRoute = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering CLEANER_EN_ROUTE event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'CLEANER_EN_ROUTE',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      location: { lat: 34.0522, lng: -118.2437 }\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'CLEANER_EN_ROUTE event emitted', status: 'success' });\r\n  };\r\n\r\n  const testCleanerArrived = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering CLEANER_ARRIVED event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'CLEANER_ARRIVED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      location: { lat: 34.0522, lng: -118.2437 }\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'CLEANER_ARRIVED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testJobStarted = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering JOB_STARTED event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_STARTED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      location: { lat: 34.0522, lng: -118.2437 }\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'JOB_STARTED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testPhotosUploaded = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering BEFORE_PHOTO_UPLOADED event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'BEFORE_PHOTO_UPLOADED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      photoId: 'photo_' + Date.now()\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'BEFORE_PHOTO_UPLOADED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testExtraTimeRequested = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering EXTRA_TIME_REQUESTED event (URGENT)...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'EXTRA_TIME_REQUESTED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      minutesRequested: 30,\r\n      reason: 'Kitchen requires additional deep cleaning'\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'EXTRA_TIME_REQUESTED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testJobCompleted = async () => {\r\n    addNotificationLog('TEST', { action: 'Triggering JOB_COMPLETED event...' });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_COMPLETED',\r\n      jobId: testJob.id,\r\n      cleanerId: testCleaner.user_email,\r\n      location: { lat: 34.0522, lng: -118.2437 },\r\n      minutesWorked: 180\r\n    });\r\n\r\n    addNotificationLog('TEST', { action: 'JOB_COMPLETED event emitted', status: 'success' });\r\n  };\r\n\r\n  const testSMSDirect = async () => {\r\n    if (!systemStatus.sms) {\r\n      alert('SMS not configured. Set VITE_TWILIO_* environment variables.');\r\n      return;\r\n    }\r\n\r\n    addNotificationLog('TEST', { action: 'Sending test SMS...' });\r\n    \r\n    const result = await smsService.sendSMS({\r\n      to: testClient.phone,\r\n      message: ClientSMSTemplates.cleanerEnRoute(testCleaner.name, '15 minutes'),\r\n      priority: 'high'\r\n    });\r\n\r\n    addNotificationLog('SMS_SERVICE', result);\r\n  };\r\n\r\n  const testPushDirect = async () => {\r\n    if (!systemStatus.push) {\r\n      alert('Push notifications not enabled. Click \"Enable Push\" first.');\r\n      return;\r\n    }\r\n\r\n    addNotificationLog('TEST', { action: 'Sending test push notification...' });\r\n    \r\n    const result = await pushNotificationService.showLocalNotification(\r\n      ClientPushTemplates.cleanerEnRoute(testCleaner.name, '15 minutes')\r\n    );\r\n\r\n    addNotificationLog('PUSH_SERVICE', { success: result });\r\n  };\r\n\r\n  const testAllNotifications = async () => {\r\n    addNotificationLog('TEST', { action: 'Running full job lifecycle test...', status: 'info' });\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 500));\r\n    await testJobAccepted();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testCleanerEnRoute();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testCleanerArrived();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testJobStarted();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testPhotosUploaded();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testExtraTimeRequested();\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 1000));\r\n    await testJobCompleted();\r\n    \r\n    addNotificationLog('TEST', { action: 'Full lifecycle test complete!', status: 'success' });\r\n  };\r\n\r\n  const requestPushPermission = async () => {\r\n    const granted = await pushNotificationService.requestPermission();\r\n    if (granted) {\r\n      alert('Push notifications enabled!');\r\n      checkSystemStatus();\r\n    } else {\r\n      alert('Push notifications denied. Enable in browser settings.');\r\n    }\r\n  };\r\n\r\n  const clearLogs = () => {\r\n    setNotifications([]);\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin text-system\" />\r\n        <span className=\"ml-3 text-lg font-heading\">Initializing test environment...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-6 py-8 max-w-7xl\">\r\n      {/* Header */}\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-4xl font-heading font-bold text-graphite mb-2\">\r\n          Notification System Test Page\r\n        </h1>\r\n        <p className=\"text-gray-600 font-body\">\r\n          Trigger notification events and see the system in action\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Left Column: System Status & Test Data */}\r\n        <div className=\"lg:col-span-1 space-y-6\">\r\n          {/* System Status */}\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <div className=\"flex items-center mb-4\">\r\n              <Zap className=\"h-5 w-5 text-system mr-2\" />\r\n              <h2 className=\"text-lg font-heading font-bold\">System Status</h2>\r\n            </div>\r\n            <div className=\"space-y-3 text-sm font-body\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>In-App Notifications:</span>\r\n                <Badge variant=\"success\" className=\"text-xs\">‚úÖ Active</Badge>\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>Email Service:</span>\r\n                <Badge variant=\"success\" className=\"text-xs\">‚úÖ Active</Badge>\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>SMS Service:</span>\r\n                {systemStatus.sms ? (\r\n                  <Badge variant=\"success\" className=\"text-xs\">‚úÖ Active</Badge>\r\n                ) : (\r\n                  <Badge variant=\"warning\" className=\"text-xs\">‚ö†Ô∏è Dev Mode</Badge>\r\n                )}\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>Push Notifications:</span>\r\n                {systemStatus.push ? (\r\n                  <Badge variant=\"success\" className=\"text-xs\">‚úÖ Enabled</Badge>\r\n                ) : (\r\n                  <button onClick={requestPushPermission} className=\"h-6 text-xs rounded-md px-3 inline-flex items-center justify-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\">\r\n                    Enable\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <div className=\"flex items-center justify-between\">\r\n                <span>Real-Time Mode:</span>\r\n                <Badge variant=\"system\" className=\"text-xs\">\r\n                  {systemStatus.realTime === 'websocket' && '‚ö° WebSocket'}\r\n                  {systemStatus.realTime === 'sse' && '‚ö° SSE'}\r\n                  {systemStatus.realTime === 'polling' && 'üîÑ Polling'}\r\n                </Badge>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Test Data */}\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <div className=\"flex items-center mb-4\">\r\n              <Bell className=\"h-5 w-5 text-system mr-2\" />\r\n              <h2 className=\"text-lg font-heading font-bold\">Test Data</h2>\r\n            </div>\r\n            <div className=\"space-y-2 text-xs font-body text-gray-700\">\r\n              <div>\r\n                <strong>Job ID:</strong>\r\n                <p className=\"text-gray-600 truncate\">{testJob?.id}</p>\r\n              </div>\r\n              <div>\r\n                <strong>Client:</strong>\r\n                <p className=\"text-gray-600\">{testClient?.first_name} ({testClient?.user_email})</p>\r\n              </div>\r\n              <div>\r\n                <strong>Cleaner:</strong>\r\n                <p className=\"text-gray-600\">{testCleaner?.name} ({testCleaner?.user_email})</p>\r\n              </div>\r\n              <div>\r\n                <strong>Address:</strong>\r\n                <p className=\"text-gray-600\">{testJob?.address}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Actions */}\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <h2 className=\"text-lg font-heading font-bold mb-4\">Quick Actions</h2>\r\n            <div className=\"space-y-2\">\r\n              <button\r\n                onClick={testAllNotifications}\r\n                className=\"w-full bg-system hover:bg-system-dark text-white font-heading h-8 rounded-md px-3 text-xs inline-flex items-center justify-center transition-colors\"\r\n              >\r\n                üé¨ Run Full Test\r\n              </button>\r\n              <button\r\n                onClick={clearLogs}\r\n                className=\"w-full font-heading h-8 rounded-md px-3 text-xs inline-flex items-center justify-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                üóëÔ∏è Clear Logs\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Middle Column: Test Buttons */}\r\n        <div className=\"lg:col-span-1 space-y-4\">\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <h2 className=\"text-xl font-heading font-bold mb-4\">Client Notifications</h2>\r\n            <div className=\"space-y-3\">\r\n              <button\r\n                onClick={testJobAccepted}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                <CheckCircle2 className=\"mr-2 h-4 w-4 text-success\" />\r\n                Job Accepted\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testCleanerEnRoute}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                üöó Cleaner En Route\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testCleanerArrived}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                üìç Cleaner Arrived\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testJobStarted}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                üßπ Job Started\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testPhotosUploaded}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                üì∏ Photos Uploaded\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testExtraTimeRequested}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors bg-amber-50 border border-amber-300 hover:bg-amber-100\"\r\n              >\r\n                <AlertTriangle className=\"mr-2 h-4 w-4 text-amber-600\" />\r\n                Extra Time (URGENT)\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testJobCompleted}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\"\r\n              >\r\n                <CheckCircle2 className=\"mr-2 h-4 w-4 text-success\" />\r\n                Job Completed\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <h2 className=\"text-xl font-heading font-bold mb-4\">Direct Tests</h2>\r\n            <div className=\"space-y-3\">\r\n              <button\r\n                onClick={testSMSDirect}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground disabled:pointer-events-none disabled:opacity-50\"\r\n                disabled={!systemStatus.sms}\r\n              >\r\n                <MessageSquare className=\"mr-2 h-4 w-4 text-system\" />\r\n                Send Test SMS\r\n              </button>\r\n              \r\n              <button\r\n                onClick={testPushDirect}\r\n                className=\"w-full justify-start font-body h-9 px-4 py-2 rounded-md inline-flex items-center transition-colors border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground disabled:pointer-events-none disabled:opacity-50\"\r\n                disabled={!systemStatus.push}\r\n              >\r\n                <Smartphone className=\"mr-2 h-4 w-4 text-system\" />\r\n                Send Test Push\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Column: Notification Log */}\r\n        <div className=\"lg:col-span-1\">\r\n          <div className=\"rounded-xl border bg-card text-card-foreground shadow p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-xl font-heading font-bold\">Notification Log</h2>\r\n              <Badge variant=\"secondary\" className=\"text-xs\">\r\n                {notifications.length} events\r\n              </Badge>\r\n            </div>\r\n            \r\n            <div className=\"space-y-2 max-h-[600px] overflow-y-auto\">\r\n              {notifications.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500 font-body text-sm\">\r\n                  No events yet. Click a button to test!\r\n                </div>\r\n              ) : (\r\n                notifications.map((notification) => (\r\n                  <div\r\n                    key={notification.id}\r\n                    className=\"p-3 bg-gray-50 rounded-lg border border-gray-200 text-xs font-mono\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between mb-1\">\r\n                      <Badge\r\n                        variant={\r\n                          notification.source === 'TEST' ? 'secondary' :\r\n                          notification.source === 'CLIENT_SERVICE' ? 'success' :\r\n                          notification.source === 'REAL_TIME' ? 'system' :\r\n                          notification.source === 'SMS_SERVICE' ? 'info' :\r\n                          'default'\r\n                        }\r\n                        className=\"text-xs\"\r\n                      >\r\n                        {notification.source}\r\n                      </Badge>\r\n                      <span className=\"text-gray-500\">\r\n                        {new Date(notification.timestamp).toLocaleTimeString()}\r\n                      </span>\r\n                    </div>\r\n                    <pre className=\"text-gray-700 whitespace-pre-wrap break-words\">\r\n                      {JSON.stringify(notification.data, null, 2)}\r\n                    </pre>\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Instructions */}\r\n      <div className=\"rounded-xl border bg-blue-50 border-blue-200 shadow mt-6 p-6\">\r\n        <h3 className=\"text-lg font-heading font-bold text-blue-900 mb-2\">\r\n          üìù Testing Instructions\r\n        </h3>\r\n        <ol className=\"list-decimal list-inside space-y-2 text-sm font-body text-blue-800\">\r\n          <li>Check the <strong>System Status</strong> to see which channels are active</li>\r\n          <li>Click <strong>\"Run Full Test\"</strong> to simulate a complete job lifecycle</li>\r\n          <li>Or click individual buttons to test specific notifications</li>\r\n          <li>Watch the <strong>Notification Log</strong> to see events being processed</li>\r\n          <li>Check your in-app notification bell (top right) for notifications</li>\r\n          <li>Check your email inbox for email notifications</li>\r\n          <li>If SMS/Push enabled, check your phone/browser for those too</li>\r\n          <li>Extra Time Request is URGENT - should always notify even if preferences disabled</li>\r\n        </ol>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\OpsDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":12,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":45,"fix":{"range":[730,739],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[729,738],"text":""},"desc":"Remove unused variable 'XCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bell' is defined but never used.","line":12,"column":105,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":109,"fix":{"range":[797,803],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bell"},"fix":{"range":[796,802],"text":""},"desc":"Remove unused variable 'Bell'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Settings' is defined but never used.","line":12,"column":145,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":153,"fix":{"range":[837,847],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Settings"},"fix":{"range":[836,846],"text":""},"desc":"Remove unused variable 'Settings'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Search' is defined but never used.","line":12,"column":155,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":161,"fix":{"range":[847,855],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Search"},"fix":{"range":[846,854],"text":""},"desc":"Remove unused variable 'Search'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Calendar' is defined but never used.","line":12,"column":163,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":171,"fix":{"range":[855,865],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Calendar"},"fix":{"range":[854,864],"text":""},"desc":"Remove unused variable 'Calendar'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Target' is defined but never used.","line":12,"column":173,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":179,"fix":{"range":[865,873],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Target"},"fix":{"range":[864,872],"text":""},"desc":"Remove unused variable 'Target'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'BarChart3' is defined but never used.","line":12,"column":181,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":190,"fix":{"range":[873,884],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"BarChart3"},"fix":{"range":[872,883],"text":""},"desc":"Remove unused variable 'BarChart3'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":12,"column":192,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":203,"fix":{"range":[884,897],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[883,896],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckSquare' is defined but never used.","line":12,"column":212,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":223,"fix":{"range":[904,917],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckSquare"},"fix":{"range":[903,916],"text":""},"desc":"Remove unused variable 'CheckSquare'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'PieChart' is defined but never used.","line":13,"column":109,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":117,"fix":{"range":[1053,1063],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"PieChart"},"fix":{"range":[1052,1062],"text":""},"desc":"Remove unused variable 'PieChart'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Pie' is defined but never used.","line":13,"column":119,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":122,"fix":{"range":[1063,1068],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Pie"},"fix":{"range":[1062,1067],"text":""},"desc":"Remove unused variable 'Pie'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Cell' is defined but never used.","line":13,"column":124,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":128,"fix":{"range":[1068,1074],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Cell"},"fix":{"range":[1067,1073],"text":""},"desc":"Remove unused variable 'Cell'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'dateRange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"dateRange"},"fix":{"range":[1943,1952],"text":""},"desc":"Remove unused variable 'dateRange'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setDateRange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"setDateRange"},"fix":{"range":[1952,1966],"text":""},"desc":"Remove unused variable 'setDateRange'."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":12,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog';\nimport { Textarea } from '@/components/ui/textarea';\nimport { AlertTriangle, CheckCircle, XCircle, Clock, Loader2, Activity, Zap, MapPin, Users, TrendingUp, Bell, Play, Pause, RefreshCw, Download, Settings, Search, Calendar, Target, BarChart3, AlertCircle, Radio, CheckSquare, Send } from 'lucide-react';\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, PieChart, Pie, Cell, AreaChart, Area } from 'recharts';\nimport { toast } from 'sonner';\nimport { createPageUrl } from '@/utils';\nimport { useNavigate } from 'react-router-dom';\n\nexport default function OpsDashboard() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [dailyData, setDailyData] = useState([]);\n  const [alerts, setAlerts] = useState([]);\n  const [cleanerSnapshots, setCleanerSnapshots] = useState([]);\n  const [liveBookings, setLiveBookings] = useState([]);\n  const [activeCleaners, setActiveCleaners] = useState([]);\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const [lastUpdated, setLastUpdated] = useState(new Date());\n  const [currentUser, setCurrentUser] = useState(null);\n  const [announcementOpen, setAnnouncementOpen] = useState(false);\n  const [announcementText, setAnnouncementText] = useState('');\n  const [dateRange, setDateRange] = useState('7d');\n  const [searchTerm, setSearchTerm] = useState('');\n\n  useEffect(() => {\n    loadCurrentUser();\n    loadDashboard();\n  }, []);\n\n  useEffect(() => {\n    if (autoRefresh) {\n      const interval = setInterval(() => {\n        loadDashboard();\n      }, 30000); // 30 seconds\n      return () => clearInterval(interval);\n    }\n  }, [autoRefresh]);\n\n  const loadCurrentUser = async () => {\n    try {\n      const user = await base44.auth.me();\n      setCurrentUser(user);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading user:', showToast: false });\n    }\n  };\n\n  const loadDashboard = async () => {\n    try {\n      const now = new Date();\n      const today = now.toISOString().split('T')[0];\n      \n      const [daily, systemAlerts, snapshots, bookings, cleaners] = await Promise.all([\n        base44.entities.PlatformAnalyticsDaily.list('-created_date', 30),\n        base44.entities.SystemAlert.filter({ is_resolved: false }),\n        base44.entities.CleanerDailySnapshot.list('-created_date', 100),\n        base44.entities.Booking.filter({\n          status: { $in: ['scheduled', 'on_the_way', 'in_progress', 'awaiting_client', 'awaiting_cleaner_response'] },\n          date: { $gte: today }\n        }).catch(() => []),\n        base44.entities.CleanerProfile.filter({ is_active: true }).catch(() => [])\n      ]);\n      \n      setDailyData(daily.reverse());\n      setAlerts(systemAlerts);\n      setCleanerSnapshots(snapshots);\n      setLiveBookings(bookings);\n      setActiveCleaners(cleaners);\n      setLastUpdated(new Date());\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading ops dashboard:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const handleSendAnnouncement = async () => {\n    if (!announcementText.trim()) {\n      toast.error('Please enter an announcement message');\n      return;\n    }\n\n    try {\n      const users = await base44.entities.User.list();\n      \n      for (const user of users) {\n        await base44.entities.Notification.create({\n          recipient_email: user.email,\n          type: 'system_alert',\n          title: 'Platform Announcement',\n          message: announcementText,\n          priority: 'high'\n        });\n      }\n\n      if (currentUser) {\n        await base44.entities.AdminAuditLog.create({\n          admin_email: currentUser.email,\n          action_type: 'SEND_ANNOUNCEMENT',\n          target_type: 'notification',\n          target_id: 'broadcast',\n          metadata: { message: announcementText, recipient_count: users.length }\n        });\n      }\n\n      toast.success(`Announcement sent to ${users.length} users`);\n      setAnnouncementOpen(false);\n      setAnnouncementText('');\n    } catch (error) {\n      handleError(error, { userMessage: 'Error sending announcement:', showToast: false });\n      toast.error('Failed to send announcement');\n    }\n  };\n\n  const handleResolveAlert = async (alertId) => {\n    try {\n      await base44.entities.SystemAlert.update(alertId, {\n        is_resolved: true,\n        resolved_at: new Date().toISOString()\n      });\n      toast.success('Alert resolved');\n      loadDashboard();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving alert:', showToast: false });\n      toast.error('Failed to resolve alert');\n    }\n  };\n\n  const exportData = () => {\n    const csv = [\n      ['Date', 'Total Bookings', 'Completed', 'Cancelled', 'Disputed', 'Cancel Rate', 'Dispute Rate', 'Avg Rating'],\n      ...dailyData.map(d => [\n        d.date,\n        d.total_bookings || 0,\n        d.completed_bookings || 0,\n        d.cancelled_bookings || 0,\n        d.disputed_bookings || 0,\n        d.cancel_rate?.toFixed(2) || 0,\n        d.dispute_rate?.toFixed(2) || 0,\n        d.avg_rating?.toFixed(2) || 0\n      ])\n    ].map(row => row.join(',')).join('\\n');\n\n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `ops-dashboard-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    toast.success('Data exported successfully');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const latestDay = dailyData[dailyData.length - 1] || {};\n\n  // Calculate real-time metrics\n  const inProgress = liveBookings.filter(b => b.status === 'in_progress').length;\n  const onTheWay = liveBookings.filter(b => b.status === 'on_the_way').length;\n  const awaitingResponse = liveBookings.filter(b => b.status === 'awaiting_cleaner_response').length;\n  const awaitingApproval = liveBookings.filter(b => b.status === 'awaiting_client').length;\n  \n  // Platform health score (0-100)\n  const healthScore = Math.round(\n    (100 - (latestDay.cancel_rate || 0) * 5) * 0.3 +\n    (100 - (latestDay.dispute_rate || 0) * 10) * 0.3 +\n    ((latestDay.avg_rating || 5) / 5 * 100) * 0.4\n  );\n\n  const healthColor = healthScore >= 90 ? 'text-green-600' : healthScore >= 70 ? 'text-yellow-600' : 'text-red-600';\n\n  // Hourly breakdown (mock data - would need actual hourly analytics)\n  const hourlyData = Array.from({ length: 24 }, (_, i) => ({\n    hour: `${i}:00`,\n    bookings: Math.floor(Math.random() * 10) + 1\n  }));\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header with Controls */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite flex items-center gap-3\">\n              Operations Dashboard\n              {autoRefresh && <Radio className=\"w-6 h-6 text-red-500 animate-pulse\" />}\n            </h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">\n              Last updated: {lastUpdated.toLocaleTimeString()}\n            </p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setAutoRefresh(!autoRefresh)}\n              className=\"font-fredoka\"\n            >\n              {autoRefresh ? <Pause className=\"w-4 h-4 mr-2\" /> : <Play className=\"w-4 h-4 mr-2\" />}\n              Auto-refresh\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={loadDashboard}\n              className=\"font-fredoka\"\n            >\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Refresh\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={exportData}\n              className=\"font-fredoka\"\n            >\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export\n            </Button>\n            <Button\n              variant=\"default\"\n              size=\"sm\"\n              onClick={() => setAnnouncementOpen(true)}\n              className=\"font-fredoka brand-gradient text-white\"\n            >\n              <Send className=\"w-4 h-4 mr-2\" />\n              Announcement\n            </Button>\n          </div>\n        </div>\n\n        {/* Platform Health Score */}\n        <Card className=\"border-2 border-blue-200\">\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Platform Health Score</p>\n                <p className={`text-5xl font-fredoka font-bold ${healthColor}`}>{healthScore}</p>\n                <p className=\"text-sm text-gray-500 font-verdana mt-1\">\n                  {healthScore >= 90 ? 'Excellent' : healthScore >= 70 ? 'Good' : 'Needs Attention'}\n                </p>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"text-center\">\n                    <p className=\"text-2xl font-fredoka font-bold text-green-600\">{inProgress}</p>\n                    <p className=\"text-xs text-gray-500 font-verdana\">In Progress</p>\n                  </div>\n                  <div className=\"text-center\">\n                    <p className=\"text-2xl font-fredoka font-bold text-blue-600\">{onTheWay}</p>\n                    <p className=\"text-xs text-gray-500 font-verdana\">On The Way</p>\n                  </div>\n                  <div className=\"text-center\">\n                    <p className=\"text-2xl font-fredoka font-bold text-amber-600\">{awaitingResponse}</p>\n                    <p className=\"text-xs text-gray-500 font-verdana\">Awaiting Response</p>\n                  </div>\n                  <div className=\"text-center\">\n                    <p className=\"text-2xl font-fredoka font-bold text-purple-600\">{awaitingApproval}</p>\n                    <p className=\"text-xs text-gray-500 font-verdana\">Awaiting Approval</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Critical Alerts Banner */}\n        {alerts.length > 0 && (\n          <div className=\"space-y-2\">\n            {alerts.slice(0, 3).map(alert => (\n              <Alert key={alert.id} className={`border-2 ${\n                alert.severity === 'critical' ? 'border-red-500 bg-red-50' :\n                alert.severity === 'high' ? 'border-amber-500 bg-amber-50' :\n                'border-yellow-500 bg-yellow-50'\n              }`}>\n                <AlertTriangle className=\"w-5 h-5\" />\n                <AlertDescription className=\"font-verdana flex items-center justify-between\">\n                  <div>\n                    <strong className=\"font-fredoka\">{alert.type.replace(/_/g, ' ').toUpperCase()}:</strong> {alert.message}\n                  </div>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleResolveAlert(alert.id)}\n                    className=\"font-fredoka\"\n                  >\n                    Resolve\n                  </Button>\n                </AlertDescription>\n              </Alert>\n            ))}\n            {alerts.length > 3 && (\n              <p className=\"text-sm text-gray-500 font-verdana text-center\">\n                +{alerts.length - 3} more alerts\n              </p>\n            )}\n          </div>\n        )}\n\n        {/* Main Tabs */}\n        <Tabs defaultValue=\"overview\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-6\">\n            <TabsTrigger value=\"overview\" className=\"font-fredoka\">Overview</TabsTrigger>\n            <TabsTrigger value=\"live\" className=\"font-fredoka\">Live Activity</TabsTrigger>\n            <TabsTrigger value=\"analytics\" className=\"font-fredoka\">Analytics</TabsTrigger>\n            <TabsTrigger value=\"queue\" className=\"font-fredoka\">Queue ({awaitingResponse})</TabsTrigger>\n            <TabsTrigger value=\"cleaners\" className=\"font-fredoka\">Cleaners</TabsTrigger>\n            <TabsTrigger value=\"performance\" className=\"font-fredoka\">Performance</TabsTrigger>\n          </TabsList>\n\n          {/* OVERVIEW TAB */}\n          <TabsContent value=\"overview\" className=\"space-y-6\">\n            {/* Today's Stats */}\n            <div className=\"grid md:grid-cols-4 gap-6\">\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-verdana text-gray-600\">Today's Bookings</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">{latestDay.total_bookings || 0}</p>\n                  <div className=\"flex gap-2 mt-2\">\n                    <Badge className=\"bg-green-100 text-green-800 font-verdana text-xs\">\n                      <CheckCircle className=\"w-3 h-3 mr-1\" />\n                      {latestDay.completed_bookings || 0} completed\n                    </Badge>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-verdana text-gray-600\">Cancellations</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">{latestDay.cancelled_bookings || 0}</p>\n                  <p className=\"text-sm text-gray-500 font-verdana mt-2\">\n                    {latestDay.cancel_rate?.toFixed(1) || 0}% rate\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-verdana text-gray-600\">Disputes</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">{latestDay.disputed_bookings || 0}</p>\n                  <p className=\"text-sm text-gray-500 font-verdana mt-2\">\n                    {latestDay.dispute_rate?.toFixed(1) || 0}% rate\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-sm font-verdana text-gray-600\">Active Cleaners</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">{activeCleaners.length}</p>\n                  <p className=\"text-sm text-gray-500 font-verdana mt-2\">{latestDay.active_cleaners || 0} working today</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Operational Trends */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl\">Booking Status Trends</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {dailyData.length > 0 ? (\n                  <ResponsiveContainer width=\"100%\" height={350}>\n                    <BarChart data={dailyData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                      <YAxis tick={{ fontSize: 12 }} />\n                      <Tooltip />\n                      <Legend />\n                      <Bar dataKey=\"completed_bookings\" fill=\"#28C76F\" name=\"Completed\" />\n                      <Bar dataKey=\"cancelled_bookings\" fill=\"#EA5455\" name=\"Cancelled\" />\n                      <Bar dataKey=\"disputed_bookings\" fill=\"#FF9F43\" name=\"Disputed\" />\n                    </BarChart>\n                  </ResponsiveContainer>\n                ) : (\n                  <p className=\"text-center text-gray-500 py-12 font-verdana\">No data available</p>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Rate Trends */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl\">Health Metrics</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {dailyData.length > 0 ? (\n                  <ResponsiveContainer width=\"100%\" height={300}>\n                    <LineChart data={dailyData}>\n                      <CartesianGrid strokeDasharray=\"3 3\" />\n                      <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} />\n                      <YAxis tick={{ fontSize: 12 }} />\n                      <Tooltip />\n                      <Legend />\n                      <Line type=\"monotone\" dataKey=\"cancel_rate\" stroke=\"#EA5455\" name=\"Cancel Rate %\" strokeWidth={2} />\n                      <Line type=\"monotone\" dataKey=\"dispute_rate\" stroke=\"#FF9F43\" name=\"Dispute Rate %\" strokeWidth={2} />\n                      <Line type=\"monotone\" dataKey=\"avg_rating\" stroke=\"#28C76F\" name=\"Avg Rating\" strokeWidth={2} />\n                    </LineChart>\n                  </ResponsiveContainer>\n                ) : (\n                  <p className=\"text-center text-gray-500 py-12 font-verdana\">No data available</p>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* LIVE ACTIVITY TAB */}\n          <TabsContent value=\"live\" className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                    <Activity className=\"w-5 h-5 text-green-600\" />\n                    Jobs In Progress ({inProgress})\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3 max-h-[400px] overflow-y-auto\">\n                    {liveBookings.filter(b => b.status === 'in_progress').map(booking => (\n                      <div key={booking.id} className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                        <div className=\"flex items-start justify-between\">\n                          <div>\n                            <p className=\"font-fredoka font-semibold\">{booking.client_email}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Cleaner: {booking.cleaner_email}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">{booking.address}</p>\n                          </div>\n                          <Badge className=\"bg-green-600 text-white\">In Progress</Badge>\n                        </div>\n                      </div>\n                    ))}\n                    {inProgress === 0 && (\n                      <p className=\"text-center text-gray-500 py-8 font-verdana\">No jobs in progress</p>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                    <MapPin className=\"w-5 h-5 text-blue-600\" />\n                    On The Way ({onTheWay})\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3 max-h-[400px] overflow-y-auto\">\n                    {liveBookings.filter(b => b.status === 'on_the_way').map(booking => (\n                      <div key={booking.id} className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                        <div className=\"flex items-start justify-between\">\n                          <div>\n                            <p className=\"font-fredoka font-semibold\">{booking.client_email}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Cleaner: {booking.cleaner_email}</p>\n                            <p className=\"text-xs text-gray-500 font-verdana\">Start: {booking.start_time}</p>\n                          </div>\n                          <Badge className=\"bg-blue-600 text-white\">On The Way</Badge>\n                        </div>\n                      </div>\n                    ))}\n                    {onTheWay === 0 && (\n                      <p className=\"text-center text-gray-500 py-8 font-verdana\">No cleaners on the way</p>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5 text-purple-600\" />\n                  Awaiting Client Approval ({awaitingApproval})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {liveBookings.filter(b => b.status === 'awaiting_client').map(booking => (\n                    <div key={booking.id} className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"font-fredoka font-semibold\">{booking.client_email}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Cleaner: {booking.cleaner_email}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Completed: {new Date(booking.check_out_time).toLocaleString()}</p>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => navigate(createPageUrl('AdminBookingsConsoleV2'))}\n                          className=\"font-fredoka\"\n                        >\n                          Review\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                  {awaitingApproval === 0 && (\n                    <p className=\"text-center text-gray-500 py-8 font-verdana\">No bookings awaiting approval</p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* ANALYTICS TAB */}\n          <TabsContent value=\"analytics\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl\">Hourly Activity Distribution</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ResponsiveContainer width=\"100%\" height={300}>\n                  <AreaChart data={hourlyData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"hour\" />\n                    <YAxis />\n                    <Tooltip />\n                    <Area type=\"monotone\" dataKey=\"bookings\" stroke=\"#66B3FF\" fill=\"#66B3FF\" fillOpacity={0.6} />\n                  </AreaChart>\n                </ResponsiveContainer>\n              </CardContent>\n            </Card>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Weekly Comparison</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <div className=\"flex justify-between mb-2\">\n                        <span className=\"text-sm font-verdana\">This Week</span>\n                        <span className=\"text-sm font-fredoka font-bold\">{latestDay.total_bookings || 0} bookings</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-blue-600 h-2 rounded-full\" style={{ width: '100%' }}></div>\n                      </div>\n                    </div>\n                    <div>\n                      <div className=\"flex justify-between mb-2\">\n                        <span className=\"text-sm font-verdana\">Last Week</span>\n                        <span className=\"text-sm font-fredoka font-bold\">{Math.floor((latestDay.total_bookings || 0) * 0.85)} bookings</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-gray-400 h-2 rounded-full\" style={{ width: '85%' }}></div>\n                      </div>\n                    </div>\n                    <Badge className=\"bg-green-100 text-green-800 font-fredoka\">\n                      <TrendingUp className=\"w-3 h-3 mr-1\" />\n                      +15% growth\n                    </Badge>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-xl\">Daily Goals</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <div className=\"flex justify-between mb-2\">\n                        <span className=\"text-sm font-verdana\">Bookings Target</span>\n                        <span className=\"text-sm font-fredoka\">{latestDay.total_bookings || 0} / 50</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className=\"bg-puretask-blue h-2 rounded-full\" style={{ width: `${Math.min(((latestDay.total_bookings || 0) / 50) * 100, 100)}%` }}></div>\n                      </div>\n                    </div>\n                    <div>\n                      <div className=\"flex justify-between mb-2\">\n                        <span className=\"text-sm font-verdana\">Quality Score</span>\n                        <span className=\"text-sm font-fredoka\">{healthScore} / 90</span>\n                      </div>\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div className={`h-2 rounded-full ${healthScore >= 90 ? 'bg-green-600' : 'bg-amber-600'}`} style={{ width: `${Math.min((healthScore / 90) * 100, 100)}%` }}></div>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* QUEUE TAB */}\n          <TabsContent value=\"queue\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                  <Clock className=\"w-5 h-5 text-amber-600\" />\n                  Bookings Awaiting Cleaner Response\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {liveBookings.filter(b => b.status === 'awaiting_cleaner_response').map(booking => (\n                    <div key={booking.id} className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <p className=\"font-fredoka font-semibold\">{booking.client_email}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Requested: {booking.cleaner_email || 'Unassigned'}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">Date: {booking.date} at {booking.start_time}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">\n                            Expires: {booking.request_expires_at ? new Date(booking.request_expires_at).toLocaleString() : 'N/A'}\n                          </p>\n                        </div>\n                        <div className=\"flex flex-col gap-2\">\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => navigate(createPageUrl('AdminBookingsConsoleV2'))}\n                            className=\"font-fredoka\"\n                          >\n                            View Details\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"default\"\n                            className=\"font-fredoka brand-gradient text-white\"\n                          >\n                            Reassign\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                  {awaitingResponse === 0 && (\n                    <p className=\"text-center text-gray-500 py-12 font-verdana\">No bookings awaiting response</p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* CLEANERS TAB */}\n          <TabsContent value=\"cleaners\" className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n                  <Users className=\"w-5 h-5 text-blue-600\" />\n                  Available Cleaners Now ({activeCleaners.length})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"mb-4\">\n                  <Input\n                    placeholder=\"Search cleaners...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"font-verdana\"\n                  />\n                </div>\n                <div className=\"space-y-3 max-h-[500px] overflow-y-auto\">\n                  {activeCleaners.filter(c => !searchTerm || c.user_email.toLowerCase().includes(searchTerm.toLowerCase())).map(cleaner => (\n                    <div key={cleaner.id} className=\"p-4 bg-gray-50 rounded-lg border border-gray-200\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"font-fredoka font-semibold\">{cleaner.user_email}</p>\n                          <div className=\"flex items-center gap-2 mt-1\">\n                            <Badge className=\"bg-blue-100 text-blue-800 font-fredoka text-xs\">{cleaner.tier}</Badge>\n                            <Badge variant=\"outline\" className=\"font-verdana text-xs\">\n                              {cleaner.reliability_score || 0}/100\n                            </Badge>\n                            {cleaner.instant_book_enabled && (\n                              <Badge className=\"bg-green-100 text-green-800 font-fredoka text-xs\">\n                                <Zap className=\"w-3 h-3 mr-1\" />\n                                Instant Book\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => navigate(createPageUrl('CleanerProfile') + '?email=' + cleaner.user_email)}\n                          className=\"font-fredoka\"\n                        >\n                          View Profile\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                  {activeCleaners.length === 0 && (\n                    <p className=\"text-center text-gray-500 py-12 font-verdana\">No active cleaners</p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* PERFORMANCE TAB */}\n          <TabsContent value=\"performance\" className=\"space-y-6\">\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"font-fredoka text-xl\">Top Performing Cleaners (Last 7 Days)</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {cleanerSnapshots.slice(0, 10).map((snapshot, idx) => (\n                    <div key={snapshot.id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-xl\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-8 h-8 rounded-full bg-gradient-to-r from-amber-500 to-yellow-500 flex items-center justify-center text-white font-fredoka font-bold text-sm\">\n                          #{idx + 1}\n                        </div>\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold\">\n                          {snapshot.cleaner_email[0].toUpperCase()}\n                        </div>\n                        <div>\n                          <p className=\"font-fredoka font-semibold text-graphite\">{snapshot.cleaner_email}</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">{snapshot.tier}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"text-right\">\n                          <p className=\"text-sm font-verdana text-gray-600\">{snapshot.completed_jobs} jobs</p>\n                          <p className=\"text-xs text-gray-500 font-verdana\">${snapshot.earnings_usd?.toFixed(0) || 0} earned</p>\n                        </div>\n                        <Badge className=\"bg-blue-100 text-blue-800 font-fredoka\">\n                          {snapshot.reliability_score || 0}/100\n                        </Badge>\n                      </div>\n                    </div>\n                  ))}\n                  {cleanerSnapshots.length === 0 && (\n                    <p className=\"text-center text-gray-500 py-8 font-verdana\">No cleaner data available yet</p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-sm\">Service Level</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold\">95.2%</p>\n                  <p className=\"text-xs text-gray-500 font-verdana mt-1\">First-time completion rate</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-sm\">Avg Response Time</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold\">4.2h</p>\n                  <p className=\"text-xs text-gray-500 font-verdana mt-1\">Cleaner acceptance time</p>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"font-fredoka text-sm\">Photo Compliance</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-3xl font-fredoka font-bold\">98.5%</p>\n                  <p className=\"text-xs text-gray-500 font-verdana mt-1\">Photo proof submission rate</p>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        {/* Announcement Modal */}\n        <Dialog open={announcementOpen} onOpenChange={setAnnouncementOpen}>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka\">Send Platform Announcement</DialogTitle>\n              <DialogDescription className=\"font-verdana\">\n                This will send a notification to all users on the platform\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <Textarea\n                value={announcementText}\n                onChange={(e) => setAnnouncementText(e.target.value)}\n                placeholder=\"Enter your announcement message...\"\n                className=\"font-verdana min-h-[120px]\"\n              />\n            </div>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setAnnouncementOpen(false)} className=\"font-fredoka\">\n                Cancel\n              </Button>\n              <Button onClick={handleSendAnnouncement} className=\"font-fredoka brand-gradient text-white\">\n                <Send className=\"w-4 h-4 mr-2\" />\n                Send to All Users\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\PaymentCheckout.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\PaymentSuccess.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Link' is defined but never used.","line":3,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27,"fix":{"range":[122,128],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Link"},"fix":{"range":[122,128],"text":""},"desc":"Remove unused variable 'Link'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ArrowRight' is defined but never used.","line":9,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":33,"fix":{"range":[440,452],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ArrowRight"},"fix":{"range":[439,451],"text":""},"desc":"Remove unused variable 'ArrowRight'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'isUpcoming' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":202,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":35,"suggestions":[{"messageId":"removeVar","data":{"varName":"isUpcoming"},"fix":{"range":[7944,7990],"text":""},"desc":"Remove unused variable 'isUpcoming'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle, ArrowRight, Loader2, Clock, Bell, Camera, Star, Calendar, MessageSquare } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { format, parseISO } from 'date-fns';\nimport { convertTo12Hour } from '../components/utils/timeUtils';\n\nexport default function PaymentSuccess() {\n  const navigate = useNavigate();\n  const [booking, setBooking] = useState(null);\n  const [cleaner, setCleaner] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const bookingId = urlParams.get('bookingId');\n    if (bookingId) {\n      loadBooking(bookingId);\n    } else {\n      navigate(createPageUrl('Home'));\n    }\n  }, []);\n\n  const loadBooking = async (id) => {\n    try {\n      const fetchedBooking = await base44.entities.Booking.get(id);\n      setBooking(fetchedBooking);\n\n      // Load cleaner profile\n      const cleanerProfiles = await base44.entities.CleanerProfile.filter({\n        user_email: fetchedBooking.cleaner_email\n      });\n      if (cleanerProfiles.length > 0) {\n        setCleaner(cleanerProfiles[0]);\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading booking:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-emerald-500\" />\n      </div>\n    );\n  }\n\n  const timelineSteps = [\n    {\n      title: 'Payment Hold Placed',\n      description: 'Your card has been authorized but not charged yet',\n      icon: CheckCircle,\n      status: 'complete',\n      time: 'Just now'\n    },\n    {\n      title: 'Cleaner Confirmation',\n      description: `${cleaner?.full_name || 'Your cleaner'} will confirm within 4 hours`,\n      icon: Bell,\n      status: booking?.cleaner_confirmed ? 'complete' : 'pending',\n      time: booking?.cleaner_confirmed ? 'Confirmed' : 'Within 4 hours'\n    },\n    {\n      title: 'Cleaning Day',\n      description: 'Your cleaner will arrive and complete the service',\n      icon: Calendar,\n      status: 'upcoming',\n      time: booking ? format(parseISO(booking.date), 'MMM d, yyyy') + ' at ' + convertTo12Hour(booking.start_time) : ''\n    },\n    {\n      title: 'Photo Verification',\n      description: 'Review before/after photos and approve the work',\n      icon: Camera,\n      status: 'upcoming',\n      time: 'After cleaning'\n    },\n    {\n      title: 'Payment Processed',\n      description: 'Payment will be captured only after you approve',\n      icon: CheckCircle,\n      status: 'upcoming',\n      time: 'After approval'\n    },\n    {\n      title: 'Leave a Review',\n      description: 'Share your experience to help others',\n      icon: Star,\n      status: 'upcoming',\n      time: 'Optional'\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-green-50 p-6\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Success Header */}\n        <motion.div\n          initial={{ scale: 0.9, opacity: 0 }}\n          animate={{ scale: 1, opacity: 1 }}\n          transition={{ duration: 0.5 }}\n          className=\"text-center mb-8\"\n        >\n          <motion.div\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\n            className=\"w-24 h-24 bg-gradient-to-br from-emerald-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl\"\n          >\n            <CheckCircle className=\"w-12 h-12 text-white\" />\n          </motion.div>\n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">Booking Confirmed!</h1>\n          <p className=\"text-lg text-slate-600 mb-4\">\n            Your cleaning is scheduled and payment is secured\n          </p>\n          <Badge className=\"bg-emerald-100 text-emerald-800 border-emerald-300 text-sm px-4 py-1\">\n            Booking ID: {booking?.id?.slice(0, 8)}\n          </Badge>\n        </motion.div>\n\n        {/* Booking Summary */}\n        {booking && (\n          <motion.div\n            initial={{ y: 20, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            transition={{ delay: 0.3 }}\n          >\n            <Card className=\"mb-8 border-0 shadow-xl\">\n              <CardHeader className=\"bg-gradient-to-r from-slate-50 to-slate-100\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-5 h-5 text-emerald-600\" />\n                  Booking Details\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"grid md:grid-cols-2 gap-6\">\n                  <div className=\"space-y-3\">\n                    <div>\n                      <p className=\"text-sm text-slate-500 mb-1\">Date & Time</p>\n                      <p className=\"font-semibold text-slate-900\">\n                        {format(parseISO(booking.date), 'EEEE, MMMM d, yyyy')}\n                      </p>\n                      <p className=\"text-slate-700\">{convertTo12Hour(booking.start_time)}</p>\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-slate-500 mb-1\">Duration</p>\n                      <p className=\"font-semibold text-slate-900\">{booking.hours} hours</p>\n                    </div>\n                    {cleaner && (\n                      <div>\n                        <p className=\"text-sm text-slate-500 mb-1\">Your Cleaner</p>\n                        <p className=\"font-semibold text-slate-900\">{cleaner.full_name}</p>\n                        <Badge className=\"mt-1 bg-purple-100 text-purple-800 border-purple-200\">\n                          {cleaner.tier} Tier\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"space-y-3\">\n                    <div>\n                      <p className=\"text-sm text-slate-500 mb-1\">Address</p>\n                      <p className=\"font-semibold text-slate-900\">{booking.address}</p>\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-slate-500 mb-1\">Total Price</p>\n                      <p className=\"text-2xl font-bold text-emerald-600\">${booking.total_price.toFixed(2)}</p>\n                      <p className=\"text-xs text-slate-500\">Payment hold placed - will be charged after cleaning</p>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* What Happens Next - Timeline */}\n        <motion.div\n          initial={{ y: 20, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          transition={{ delay: 0.4 }}\n        >\n          <Card className=\"mb-8 border-0 shadow-xl\">\n            <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <Clock className=\"w-5 h-5 text-blue-600\" />\n                What Happens Next\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-6\">\n                {timelineSteps.map((step, index) => {\n                  const Icon = step.icon;\n                  const isComplete = step.status === 'complete';\n                  const isPending = step.status === 'pending';\n                  const isUpcoming = step.status === 'upcoming';\n\n                  return (\n                    <motion.div\n                      key={index}\n                      initial={{ x: -20, opacity: 0 }}\n                      animate={{ x: 0, opacity: 1 }}\n                      transition={{ delay: 0.5 + index * 0.1 }}\n                      className=\"flex gap-4\"\n                    >\n                      {/* Timeline Line */}\n                      <div className=\"flex flex-col items-center\">\n                        <div className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                          isComplete ? 'bg-emerald-500' :\n                          isPending ? 'bg-blue-500 animate-pulse' :\n                          'bg-slate-300'\n                        }`}>\n                          <Icon className={`w-5 h-5 ${\n                            isComplete || isPending ? 'text-white' : 'text-slate-500'\n                          }`} />\n                        </div>\n                        {index < timelineSteps.length - 1 && (\n                          <div className={`w-0.5 h-12 ${\n                            isComplete ? 'bg-emerald-300' : 'bg-slate-200'\n                          }`} />\n                        )}\n                      </div>\n\n                      {/* Content */}\n                      <div className=\"flex-1 pb-6\">\n                        <div className=\"flex items-start justify-between mb-1\">\n                          <h3 className={`font-semibold ${\n                            isComplete ? 'text-emerald-900' :\n                            isPending ? 'text-blue-900' :\n                            'text-slate-700'\n                          }`}>\n                            {step.title}\n                          </h3>\n                          <span className={`text-sm ${\n                            isComplete ? 'text-emerald-600 font-medium' :\n                            isPending ? 'text-blue-600 font-medium' :\n                            'text-slate-500'\n                          }`}>\n                            {step.time}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-slate-600\">{step.description}</p>\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Quick Actions */}\n        <motion.div\n          initial={{ y: 20, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          transition={{ delay: 0.6 }}\n          className=\"grid md:grid-cols-3 gap-4 mb-8\"\n        >\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer border-2 border-slate-200 hover:border-emerald-300\">\n            <CardContent className=\"p-6 text-center\">\n              <MessageSquare className=\"w-8 h-8 text-blue-500 mx-auto mb-3\" />\n              <h3 className=\"font-semibold text-slate-900 mb-2\">Message Your Cleaner</h3>\n              <p className=\"text-sm text-slate-600 mb-4\">\n                Ask questions or provide special instructions\n              </p>\n              <Button variant=\"outline\" className=\"w-full\" onClick={() => navigate(createPageUrl('Inbox'))}>\n                Open Messages\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer border-2 border-slate-200 hover:border-purple-300\">\n            <CardContent className=\"p-6 text-center\">\n              <Calendar className=\"w-8 h-8 text-purple-500 mx-auto mb-3\" />\n              <h3 className=\"font-semibold text-slate-900 mb-2\">View Your Bookings</h3>\n              <p className=\"text-sm text-slate-600 mb-4\">\n                See all your scheduled cleanings\n              </p>\n              <Button variant=\"outline\" className=\"w-full\" onClick={() => navigate(createPageUrl('ClientDashboard'))}>\n                Go to Dashboard\n              </Button>\n            </CardContent>\n          </Card>\n\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer border-2 border-slate-200 hover:border-green-300\">\n            <CardContent className=\"p-6 text-center\">\n              <Calendar className=\"w-8 h-8 text-green-500 mx-auto mb-3\" />\n              <h3 className=\"font-semibold text-slate-900 mb-2\">Book Another Cleaning</h3>\n              <p className=\"text-sm text-slate-600 mb-4\">\n                Schedule your next cleaning service\n              </p>\n              <Button variant=\"outline\" className=\"w-full\" onClick={() => navigate(createPageUrl('BrowseCleaners'))}>\n                Browse Cleaners\n              </Button>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Next Steps Reminder */}\n        <motion.div\n          initial={{ y: 20, opacity: 0 }}\n          animate={{ y: 0, opacity: 1 }}\n          transition={{ delay: 0.7 }}\n          className=\"bg-gradient-to-r from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-lg p-6 text-center\"\n        >\n          <Bell className=\"w-8 h-8 text-amber-600 mx-auto mb-3\" />\n          <h3 className=\"font-semibold text-amber-900 mb-2\">We'll Keep You Updated</h3>\n          <p className=\"text-sm text-amber-800\">\n            You'll receive email and SMS notifications at each step. Check your inbox for confirmation details.\n          </p>\n        </motion.div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\PhotoConsent.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\PreLaunch.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":46,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, CheckCircle, Clock, Shield, Star, Users, Zap, Mail, ArrowRight, MapPin, Camera, Award, Calendar, Phone, Home, Bell, Gift } from 'lucide-react';\nimport { motion } from 'framer-motion';\nimport { base44 } from '@/api/base44Client';\n\nexport default function PreLaunch() {\n  const [email, setEmail] = useState('');\n  const [phone, setPhone] = useState('');\n  const [address, setAddress] = useState('');\n  const [userType, setUserType] = useState('client');\n  const [submitted, setSubmitted] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!email || !email.includes('@')) {\n      setError('Please enter a valid email address');\n      return;\n    }\n    if (!phone || phone.length < 10) {\n      setError('Please enter a valid phone number');\n      return;\n    }\n    if (!address || address.length < 5) {\n      setError('Please enter your address');\n      return;\n    }\n    \n    setLoading(true);\n    setError('');\n    \n    try {\n      await base44.entities.PreLaunchSignup.create({\n        email,\n        phone,\n        address,\n        user_type: userType,\n        signed_up_at: new Date().toISOString()\n      });\n      setSubmitted(true);\n    } catch (err) {\n      console.log('Signup recorded:', email, phone, address, userType);\n      setSubmitted(true);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const benefits = [\n    { icon: Zap, title: 'Early Access', description: 'Be the first to experience PureTask' },\n    { icon: Star, title: 'Founding Member Perks', description: 'Exclusive discounts for early supporters' },\n    { icon: Shield, title: 'Priority Onboarding', description: 'Skip the waitlist when we launch' },\n  ];\n\n  const stats = [\n    { value: '100+', label: 'Cleaner Goal Before Launch' },\n    { value: '50+', label: 'Cities We\\'re Targeting' },\n    { value: '1,000+', label: 'Early Signups Goal' },\n  ];\n\n  const features = [\n    { icon: MapPin, title: 'GPS Tracking', description: 'Know exactly when your cleaner arrives and leaves' },\n    { icon: Camera, title: 'Photo Proof', description: 'Before & after photos for every cleaning' },\n    { icon: Shield, title: 'Verified Cleaners', description: 'Background-checked professionals only' },\n    { icon: Award, title: 'Reliability Scores', description: 'Transparent performance metrics' },\n  ];\n\n  if (submitted) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-[#F7F9FC] via-white to-[#EFF6FF] flex items-center justify-center p-6\">\n        <motion.div\n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          className=\"text-center max-w-lg\"\n        >\n          <div className=\"w-20 h-20 rounded-full bg-[#28C76F] flex items-center justify-center mx-auto mb-6\">\n            <CheckCircle className=\"w-10 h-10 text-white\" />\n          </div>\n          <h1 className=\"text-3xl font-fredoka font-bold text-[#1D2533] mb-4\">\n            You're on the list!\n          </h1>\n          \n          {userType === 'cleaner' ? (\n            <div className=\"mb-6\">\n              <div className=\"bg-[#28C76F]/10 border border-[#28C76F]/30 rounded-2xl p-6 mb-4\">\n                <Gift className=\"w-10 h-10 text-[#28C76F] mx-auto mb-3\" />\n                <p className=\"text-lg font-fredoka font-bold text-[#28C76F] mb-2\">\n                  üéâ You'll receive 150 FREE credits!\n                </p>\n                <p className=\"text-gray-600 font-fredoka text-sm\">\n                  As a thank you for joining early, you'll get 150 credits added to your account when we launch ‚Äî that's $15 towards your first earnings boost!\n                </p>\n              </div>\n            </div>\n          ) : (\n            <div className=\"mb-6\">\n              <div className=\"bg-[#0078FF]/10 border border-[#0078FF]/30 rounded-2xl p-6 mb-4\">\n                <Gift className=\"w-10 h-10 text-[#0078FF] mx-auto mb-3\" />\n                <p className=\"text-lg font-fredoka font-bold text-[#0078FF] mb-2\">\n                  üéÅ Early Bird Special Coming!\n                </p>\n                <p className=\"text-gray-600 font-fredoka text-sm\">\n                  Check your email! We'll be sending you an exclusive early bird coupon code with a special discount on your first booking.\n                </p>\n              </div>\n            </div>\n          )}\n\n          <div className=\"bg-gray-50 rounded-2xl p-5 mb-6\">\n            <Bell className=\"w-6 h-6 text-[#0078FF] mx-auto mb-3\" />\n            <p className=\"font-fredoka font-semibold text-[#1D2533] mb-2\">We'll remind you:</p>\n            <ul className=\"text-sm text-gray-600 font-fredoka space-y-1\">\n              <li>üìÖ 1 week before launch</li>\n              <li>‚è∞ 48 hours before launch</li>\n              <li>üöÄ Launch day notification</li>\n            </ul>\n          </div>\n\n          <p className=\"text-gray-600 font-fredoka mb-4\">\n            We'll notify you at <span className=\"font-semibold text-[#0078FF]\">{email}</span>\n          </p>\n          \n          <Badge className=\"bg-[#0078FF] text-white px-4 py-2 text-sm font-fredoka\">\n            {userType === 'client' ? 'üè† Client Waitlist' : '‚ú® Cleaner Waitlist'}\n          </Badge>\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-[#F7F9FC] via-white to-[#EFF6FF]\">\n      {/* Hero Section */}\n      <div className=\"container mx-auto px-4 py-12 md:py-20\">\n        <div className=\"max-w-4xl mx-auto text-center\">\n          {/* Logo */}\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"flex items-center justify-center gap-3 mb-8\"\n          >\n            <div className=\"w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg bg-gradient-to-br from-[#0078FF] to-[#00D4FF]\">\n              <Sparkles className=\"w-8 h-8 text-white\" />\n            </div>\n            <span className=\"text-4xl font-fredoka font-bold text-[#1D2533]\">PureTask</span>\n          </motion.div>\n\n          {/* Coming Soon Badge */}\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 0.1 }}\n          >\n            <Badge className=\"bg-[#0078FF]/10 text-[#0078FF] border border-[#0078FF]/20 px-4 py-2 text-sm font-fredoka mb-6\">\n              <Clock className=\"w-4 h-4 mr-2 inline\" />\n              Launching Soon\n            </Badge>\n          </motion.div>\n\n          {/* Headline */}\n          <motion.h1\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"text-4xl md:text-6xl font-fredoka font-bold text-[#1D2533] mb-6 leading-tight\"\n          >\n            Professional Cleaning,\n            <br />\n            <span className=\"bg-gradient-to-r from-[#0078FF] to-[#00D4FF] bg-clip-text text-transparent\">\n              Reimagined\n            </span>\n          </motion.h1>\n\n          <motion.p\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.3 }}\n            className=\"text-xl text-gray-600 font-fredoka mb-10 max-w-2xl mx-auto\"\n          >\n            GPS tracking, photo proof, verified cleaners, and transparent pricing. \n            Join the waitlist and be the first to experience the future of home cleaning.\n          </motion.p>\n\n          {/* Signup Form */}\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.4 }}\n          >\n            <Card className=\"max-w-lg mx-auto border-2 border-[#0078FF]/20 shadow-xl bg-white/80 backdrop-blur\">\n              <CardContent className=\"p-6 md:p-8\">\n                <h2 className=\"text-xl font-fredoka font-bold text-[#1D2533] mb-2\">\n                  Join the Waitlist\n                </h2>\n                <p className=\"text-gray-600 font-fredoka text-sm mb-6\">\n                  Get early access and exclusive founding member benefits\n                </p>\n\n                {/* User Type Toggle */}\n                <div className=\"flex gap-2 mb-6\">\n                  <button\n                    onClick={() => setUserType('client')}\n                    className={`flex-1 py-3 px-4 rounded-xl font-fredoka font-semibold transition-all ${\n                      userType === 'client'\n                        ? 'bg-[#0078FF] text-white shadow-lg'\n                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                    }`}\n                  >\n                    <Users className=\"w-4 h-4 inline mr-2\" />\n                    I Need a Cleaner\n                  </button>\n                  <button\n                    onClick={() => setUserType('cleaner')}\n                    className={`flex-1 py-3 px-4 rounded-xl font-fredoka font-semibold transition-all ${\n                      userType === 'cleaner'\n                        ? 'bg-[#28C76F] text-white shadow-lg'\n                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                    }`}\n                  >\n                    <Sparkles className=\"w-4 h-4 inline mr-2\" />\n                    I'm a Cleaner\n                  </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  <div className=\"relative\">\n                    <Mail className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                    <Input\n                      type=\"email\"\n                      placeholder=\"Enter your email\"\n                      value={email}\n                      onChange={(e) => setEmail(e.target.value)}\n                      className=\"pl-12 h-14 text-lg border-2 border-gray-200 focus:border-[#0078FF] rounded-xl font-fredoka\"\n                    />\n                  </div>\n\n                  <div className=\"relative\">\n                    <Phone className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                    <Input\n                      type=\"tel\"\n                      placeholder=\"Phone number\"\n                      value={phone}\n                      onChange={(e) => setPhone(e.target.value)}\n                      className=\"pl-12 h-14 text-lg border-2 border-gray-200 focus:border-[#0078FF] rounded-xl font-fredoka\"\n                    />\n                  </div>\n\n                  <div className=\"relative\">\n                    <Home className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                    <Input\n                      type=\"text\"\n                      placeholder=\"Your address (city, state)\"\n                      value={address}\n                      onChange={(e) => setAddress(e.target.value)}\n                      className=\"pl-12 h-14 text-lg border-2 border-gray-200 focus:border-[#0078FF] rounded-xl font-fredoka\"\n                    />\n                  </div>\n                  \n                  {error && (\n                    <p className=\"text-red-500 text-sm font-fredoka\">{error}</p>\n                  )}\n\n                  <Button\n                    type=\"submit\"\n                    disabled={loading}\n                    className={`w-full h-14 text-lg font-fredoka font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all ${\n                      userType === 'client'\n                        ? 'bg-gradient-to-r from-[#0078FF] to-[#00D4FF]'\n                        : 'bg-[#28C76F] hover:bg-[#22A85C]'\n                    }`}\n                  >\n                    {loading ? (\n                      'Joining...'\n                    ) : (\n                      <>\n                        Get Early Access\n                        <ArrowRight className=\"w-5 h-5 ml-2\" />\n                      </>\n                    )}\n                  </Button>\n                </form>\n\n                <p className=\"text-xs text-gray-500 font-fredoka mt-4\">\n                  {userType === 'cleaner' \n                    ? '‚ú® Cleaners get 150 FREE credits at launch!'\n                    : 'üéÅ Clients get an exclusive early bird discount code!'}\n                </p>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n      </div>\n\n      {/* Stats Section */}\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"max-w-3xl mx-auto\">\n          <h3 className=\"text-center font-fredoka font-bold text-[#1D2533] mb-6\">Our Pre-Launch Goals</h3>\n          <div className=\"grid grid-cols-3 gap-4 md:gap-8\">\n            {stats.map((stat, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.5 + index * 0.1 }}\n                className=\"text-center\"\n              >\n                <div className=\"text-3xl md:text-4xl font-fredoka font-bold text-[#0078FF]\">\n                  {stat.value}\n                </div>\n                <div className=\"text-sm text-gray-600 font-fredoka mt-1\">\n                  {stat.label}\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Features Preview Section */}\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"max-w-4xl mx-auto\">\n          <h2 className=\"text-2xl md:text-3xl font-fredoka font-bold text-center text-[#1D2533] mb-4\">\n            What's Coming\n          </h2>\n          <p className=\"text-center text-gray-600 font-fredoka mb-10 max-w-xl mx-auto\">\n            We're building the most transparent and reliable cleaning platform ever created\n          </p>\n          <div className=\"grid md:grid-cols-4 gap-4\">\n            {features.map((feature, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.6 + index * 0.1 }}\n                className=\"text-center p-4\"\n              >\n                <div className=\"w-12 h-12 rounded-xl bg-[#0078FF]/10 flex items-center justify-center mx-auto mb-3\">\n                  <feature.icon className=\"w-6 h-6 text-[#0078FF]\" />\n                </div>\n                <h3 className=\"text-sm font-fredoka font-bold text-[#1D2533] mb-1\">\n                  {feature.title}\n                </h3>\n                <p className=\"text-gray-500 font-fredoka text-xs\">\n                  {feature.description}\n                </p>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Benefits Section */}\n      <div className=\"container mx-auto px-4 py-12 pb-20\">\n        <div className=\"max-w-4xl mx-auto\">\n          <h2 className=\"text-2xl md:text-3xl font-fredoka font-bold text-center text-[#1D2533] mb-10\">\n            Why Join Early?\n          </h2>\n          <div className=\"grid md:grid-cols-3 gap-6\">\n            {benefits.map((benefit, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.7 + index * 0.1 }}\n              >\n                <Card className=\"h-full border-0 shadow-lg bg-white hover:shadow-xl transition-shadow\">\n                  <CardContent className=\"p-6 text-center\">\n                    <div className=\"w-14 h-14 rounded-2xl bg-[#0078FF]/10 flex items-center justify-center mx-auto mb-4\">\n                      <benefit.icon className=\"w-7 h-7 text-[#0078FF]\" />\n                    </div>\n                    <h3 className=\"text-lg font-fredoka font-bold text-[#1D2533] mb-2\">\n                      {benefit.title}\n                    </h3>\n                    <p className=\"text-gray-600 font-fredoka text-sm\">\n                      {benefit.description}\n                    </p>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Launch Timeline */}\n      <div className=\"container mx-auto px-4 py-12 bg-[#0078FF]/5\">\n        <div className=\"max-w-2xl mx-auto text-center\">\n          <Calendar className=\"w-10 h-10 text-[#0078FF] mx-auto mb-4\" />\n          <h2 className=\"text-2xl font-fredoka font-bold text-[#1D2533] mb-4\">\n            Expected Launch: Early 2025\n          </h2>\n          <p className=\"text-gray-600 font-fredoka\">\n            We're putting the finishing touches on an amazing experience. \n            Sign up above to be notified the moment we go live!\n          </p>\n        </div>\n      </div>\n\n      {/* Footer */}\n      <div className=\"border-t border-gray-200 py-8\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <div className=\"flex items-center justify-center gap-2 mb-2\">\n            <Sparkles className=\"w-5 h-5 text-[#0078FF]\" />\n            <span className=\"font-fredoka font-bold text-[#1D2533]\">PureTask</span>\n          </div>\n          <p className=\"text-sm text-gray-500 font-fredoka\">\n            ¬© 2024 PureTask. Coming soon to transform your cleaning experience.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Pricing.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TabsContent' is defined but never used.","line":7,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":27,"fix":{"range":[314,327],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TabsContent"},"fix":{"range":[313,326],"text":""},"desc":"Remove unused variable 'TabsContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":10,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":21,"fix":{"range":[469,476],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[468,475],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Star' is defined but never used.","line":10,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":35,"fix":{"range":[484,490],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Star"},"fix":{"range":[483,489],"text":""},"desc":"Remove unused variable 'Star'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":10,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":47,"fix":{"range":[495,502],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[494,501],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Camera' is defined but never used.","line":10,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":55,"fix":{"range":[502,510],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Camera"},"fix":{"range":[501,509],"text":""},"desc":"Remove unused variable 'Camera'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":13,"fix":{"range":[516,530],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[515,529],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'DollarSign' is defined but never used.","line":11,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":25,"fix":{"range":[530,542],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"DollarSign"},"fix":{"range":[529,541],"text":""},"desc":"Remove unused variable 'DollarSign'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Users' is defined but never used.","line":11,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":32,"fix":{"range":[542,549],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Users"},"fix":{"range":[541,548],"text":""},"desc":"Remove unused variable 'Users'."}]}],"suppressedMessages":[],"errorCount":8,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":8,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  CheckCircle, Award, Shield, Star, Zap, Clock, Camera, Info,\n  TrendingUp, DollarSign, Users, Sparkles, Target\n} from 'lucide-react';\n\nexport default function Pricing() {\n  const [userType, setUserType] = useState('client');\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* Hero */}\n      <section className=\"py-20\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n        <div className=\"container mx-auto px-6 text-center\">\n          <h1 className=\"text-5xl lg:text-6xl font-fredoka font-bold mb-6 text-white\">Transparent, Fair Pricing</h1>\n          <p className=\"text-xl font-verdana max-w-2xl mx-auto mb-4 text-white\">\n            No hidden fees. Pay for quality service at rates you choose.\n          </p>\n          <div className=\"flex items-center justify-center gap-6 mt-8\">\n            <div className=\"text-center\">\n              <p className=\"text-4xl font-fredoka font-bold text-white\">10 credits = $1</p>\n              <p className=\"text-sm opacity-90 font-verdana mt-1 text-white\">Simple conversion</p>\n            </div>\n            <div className=\"text-center\">\n              <p className=\"text-4xl font-fredoka font-bold text-white\">15%</p>\n              <p className=\"text-sm opacity-90 font-verdana mt-1 text-white\">Platform fee</p>\n            </div>\n          </div>\n\n          <Tabs value={userType} onValueChange={setUserType} className=\"max-w-md mx-auto mt-12\">\n            <TabsList className=\"grid w-full grid-cols-2 bg-white/20 rounded-full p-1\">\n              <TabsTrigger value=\"client\" className=\"data-[state=active]:text-puretask-blue rounded-full font-fredoka font-semibold text-white\" style={{ backgroundColor: userType === 'client' ? 'white' : 'transparent' }}>\n                For Clients\n              </TabsTrigger>\n              <TabsTrigger value=\"cleaner\" className=\"data-[state=active]:text-fresh-mint rounded-full font-fredoka font-semibold text-white\" style={{ backgroundColor: userType === 'cleaner' ? 'white' : 'transparent' }}>\n                For Cleaners\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n        </div>\n      </section>\n\n      {/* Client Pricing */}\n      {userType === 'client' && (\n        <>\n          <section className=\"py-20\">\n            <div className=\"container mx-auto px-6\">\n              <div className=\"text-center mb-16\">\n                <h2 className=\"text-4xl font-fredoka font-bold text-graphite mb-4\">Choose Your Cleaner Tier</h2>\n                <p className=\"text-xl text-gray-600 font-verdana\">Higher reliability = Better service ‚Ä¢ All cleaners are verified</p>\n              </div>\n\n              {/* Tier Cards */}\n              <div className=\"grid md:grid-cols-4 gap-6 max-w-7xl mx-auto mb-16\">\n                {[\n                  {\n                    tier: 'Developing',\n                    score: '0-59',\n                    creditsRange: '150-350',\n                    usdRange: '$15-35',\n                    color: 'slate',\n                    description: 'Great for regular maintenance and budget-friendly options',\n                    features: [\n                      'ID verified & background checked',\n                      'GPS tracking & photo proof',\n                      'Standard cleaning supplies',\n                      'Building their reputation',\n                      'Often new to platform',\n                      'Great value for basic cleans'\n                    ]\n                  },\n                  {\n                    tier: 'Semi Pro',\n                    score: '60-74',\n                    creditsRange: '350-450',\n                    usdRange: '$35-45',\n                    color: 'blue',\n                    description: 'Consistent performers with proven track records',\n                    features: [\n                      'All Developing features',\n                      'Proven reliability (60-74 score)',\n                      'Quality cleaning products',\n                      'Priority scheduling available',\n                      'Specialty services offered',\n                      'Detailed work and communication'\n                    ]\n                  },\n                  {\n                    tier: 'Pro',\n                    score: '75-89',\n                    creditsRange: '450-600',\n                    usdRange: '$45-60',\n                    color: 'purple',\n                    popular: true,\n                    description: 'Experienced professionals - our most popular tier',\n                    features: [\n                      'All Semi Pro features',\n                      'High reliability score (75-89)',\n                      'Professional/eco-friendly products',\n                      'Same-day booking accepted',\n                      'Guaranteed on-time arrival',\n                      'Advanced cleaning techniques'\n                    ]\n                  },\n                  {\n                    tier: 'Elite',\n                    score: '90-100',\n                    creditsRange: '600-850',\n                    usdRange: '$60-85',\n                    color: 'emerald',\n                    description: 'Top 10% of all cleaners - exceptional service',\n                    features: [\n                      'All Pro features',\n                      'Elite reliability (90-100)',\n                      'Premium professional products',\n                      'White-glove service',\n                      'Highest priority scheduling',\n                      'Expert certifications & training'\n                    ]\n                  }\n                ].map((plan, idx) => (\n                  <Card key={idx} className={`relative border-2 hover:shadow-2xl transition-all rounded-2xl ${\n                    plan.popular ? 'border-purple-500 shadow-xl' : 'border-gray-200'\n                  }`}>\n                    {plan.popular && (\n                      <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2\">\n                        <Badge className=\"bg-gradient-to-r from-purple-500 to-pink-600 text-white px-4 py-1 font-fredoka rounded-full shadow-lg\">\n                          Most Popular\n                        </Badge>\n                      </div>\n                    )}\n                    <CardHeader className=\"text-center pb-6 pt-8\">\n                      <Badge className={`mb-4 bg-${plan.color}-100 text-${plan.color}-700 w-fit mx-auto px-4 py-2 text-base rounded-full font-fredoka`}>\n                        <Target className=\"w-4 h-4 mr-2\" />\n                        {plan.tier} Tier\n                      </Badge>\n                      <div className=\"mb-3\">\n                        <p className=\"text-sm text-gray-500 font-verdana mb-1\">Reliability Score: {plan.score}</p>\n                        <p className=\"text-4xl font-fredoka font-bold text-graphite mb-1\">{plan.creditsRange}</p>\n                        <p className=\"text-sm text-gray-500 font-verdana\">credits/hour</p>\n                      </div>\n                      <p className=\"text-lg text-puretask-blue font-fredoka font-bold\">‚âà {plan.usdRange}/hour</p>\n                      <p className=\"text-gray-600 mt-4 font-verdana text-sm leading-relaxed px-2\">{plan.description}</p>\n                    </CardHeader>\n                    <CardContent className=\"pt-0\">\n                      <ul className=\"space-y-2.5 mb-6\">\n                        {plan.features.map((feature, i) => (\n                          <li key={i} className=\"flex items-start gap-2\">\n                            <CheckCircle className=\"w-5 h-5 text-fresh-mint flex-shrink-0 mt-0.5\" />\n                            <span className=\"text-gray-700 font-verdana text-sm\">{feature}</span>\n                          </li>\n                        ))}\n                      </ul>\n                      <Link to={createPageUrl('BrowseCleaners')}>\n                        <Button className={`w-full rounded-full font-fredoka font-semibold ${\n                          plan.popular\n                            ? 'brand-gradient text-white'\n                            : 'border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50'\n                        }`}>\n                          Browse {plan.tier} Cleaners\n                        </Button>\n                      </Link>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n\n              {/* Add-Ons */}\n              <div className=\"max-w-4xl mx-auto mt-16\">\n                <h3 className=\"text-3xl font-fredoka font-bold text-graphite mb-8 text-center\">Service Add-Ons</h3>\n                <div className=\"grid md:grid-cols-3 gap-6\">\n                  <Card className=\"border-0 shadow-lg rounded-2xl bg-white\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                        <span className=\"text-3xl\">üè†</span>\n                      </div>\n                      <h4 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">Basic Cleaning</h4>\n                      <p className=\"text-sm text-gray-600 font-verdana mb-4\">Standard maintenance and tidying</p>\n                      <Badge className=\"bg-blue-500 text-white font-fredoka\">Base Rate Only</Badge>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"border-2 border-purple-500 shadow-xl rounded-2xl bg-gradient-to-br from-purple-50 to-pink-50\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className=\"w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4\">\n                        <Sparkles className=\"w-8 h-8 text-white\" />\n                      </div>\n                      <h4 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">Deep Clean</h4>\n                      <p className=\"text-sm text-gray-600 font-verdana mb-4\">Baseboards, fans, inside appliances</p>\n                      <Badge className=\"bg-purple-500 text-white font-fredoka text-base\">+30-80 credits/hr</Badge>\n                      <p className=\"text-xs text-gray-600 mt-2 font-verdana\">‚âà +$3-8/hour</p>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"border-2 border-emerald-500 shadow-xl rounded-2xl bg-gradient-to-br from-emerald-50 to-green-50\">\n                    <CardContent className=\"p-6 text-center\">\n                      <div className=\"w-16 h-16 bg-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4\">\n                        <span className=\"text-3xl\">üì¶</span>\n                      </div>\n                      <h4 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">Move-Out/In</h4>\n                      <p className=\"text-sm text-gray-600 font-verdana mb-4\">Complete vacant property deep clean</p>\n                      <Badge className=\"bg-emerald-500 text-white font-fredoka text-base\">+30-80 credits/hr</Badge>\n                      <p className=\"text-xs text-gray-600 mt-2 font-verdana\">‚âà +$3-8/hour</p>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                <Alert className=\"mt-8 border-blue-200 bg-blue-50 rounded-2xl\">\n                  <Info className=\"w-4 h-4 text-puretask-blue\" />\n                  <AlertDescription className=\"text-blue-900 font-verdana\">\n                    <strong>Add-on Pricing:</strong> Each cleaner sets their own add-on rate within the $3-8/hour range based on their experience and the extra work involved. Deep cleans and move-outs take significantly more time and effort than basic cleaning.\n                  </AlertDescription>\n                </Alert>\n              </div>\n\n              {/* Platform Fee */}\n              <div className=\"max-w-3xl mx-auto mt-16\">\n                <Card className=\"border-0 shadow-xl bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl\">\n                  <CardContent className=\"p-8\">\n                    <div className=\"flex items-start gap-4\">\n                      <Shield className=\"w-8 h-8 text-puretask-blue mt-1 flex-shrink-0\" />\n                      <div>\n                        <h4 className=\"font-fredoka font-bold text-graphite text-xl mb-3\">Platform Fee: 15%</h4>\n                        <p className=\"text-gray-700 leading-relaxed font-verdana mb-4\">\n                          Our 15% platform fee covers the costs and features that make PureTask the safest, most transparent cleaning marketplace:\n                        </p>\n                        <ul className=\"grid md:grid-cols-2 gap-3 text-sm text-gray-700\">\n                          {[\n                            'Identity & background verification',\n                            'GPS tracking & geolocation',\n                            'Before/after photo storage',\n                            'Secure escrow payment system',\n                            '24/7 customer support',\n                            'Dispute resolution services',\n                            'Platform maintenance & development',\n                            'Trust & safety monitoring'\n                          ].map((item, i) => (\n                            <li key={i} className=\"flex items-center gap-2 font-verdana\">\n                              <CheckCircle className=\"w-4 h-4 text-fresh-mint flex-shrink-0\" />\n                              {item}\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </section>\n\n          {/* Example Pricing */}\n          <section className=\"py-20 bg-white\">\n            <div className=\"container mx-auto px-6\">\n              <div className=\"text-center mb-12\">\n                <h2 className=\"text-4xl font-fredoka font-bold text-graphite mb-4\">Example Pricing</h2>\n                <p className=\"text-xl text-gray-600 font-verdana\">See how it all works out</p>\n              </div>\n\n              <div className=\"grid md:grid-cols-3 gap-6 max-w-5xl mx-auto\">\n                <Card className=\"border-0 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n                    <CardTitle className=\"text-center font-fredoka\">Basic Clean Example</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3 text-sm\">\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">Semi Pro cleaner</span>\n                        <span className=\"font-bold font-fredoka\">400 credits/hr</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">3 hours √ó 400</span>\n                        <span className=\"font-bold font-fredoka\">1,200 credits</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-3 bg-emerald-50 rounded-lg px-3 mt-3\">\n                        <span className=\"font-bold text-graphite font-fredoka\">Total Cost</span>\n                        <span className=\"text-2xl font-bold text-fresh-mint font-fredoka\">$120</span>\n                      </div>\n                      <p className=\"text-xs text-gray-500 text-center mt-2 font-verdana\">You pay $120 ‚Ä¢ Cleaner earns $102 ‚Ä¢ Platform: $18</p>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"border-2 border-purple-500 shadow-xl rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n                    <CardTitle className=\"text-center font-fredoka\">Deep Clean Example</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3 text-sm\">\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">Pro cleaner base</span>\n                        <span className=\"font-bold font-fredoka\">500 credits/hr</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">Deep clean add-on</span>\n                        <span className=\"font-bold font-fredoka\">+50 credits/hr</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">4 hours √ó 550</span>\n                        <span className=\"font-bold font-fredoka\">2,200 credits</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-3 bg-purple-50 rounded-lg px-3 mt-3\">\n                        <span className=\"font-bold text-graphite font-fredoka\">Total Cost</span>\n                        <span className=\"text-2xl font-bold text-purple-600 font-fredoka\">$220</span>\n                      </div>\n                      <p className=\"text-xs text-gray-500 text-center mt-2 font-verdana\">You pay $220 ‚Ä¢ Cleaner earns $187 ‚Ä¢ Platform: $33</p>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"border-2 border-emerald-500 shadow-xl rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n                    <CardTitle className=\"text-center font-fredoka\">Move-Out Example</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-3 text-sm\">\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">Elite cleaner base</span>\n                        <span className=\"font-bold font-fredoka\">700 credits/hr</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">Move-out add-on</span>\n                        <span className=\"font-bold font-fredoka\">+60 credits/hr</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2 border-b\">\n                        <span className=\"text-gray-600 font-verdana\">5 hours √ó 760</span>\n                        <span className=\"font-bold font-fredoka\">3,800 credits</span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-3 bg-emerald-50 rounded-lg px-3 mt-3\">\n                        <span className=\"font-bold text-graphite font-fredoka\">Total Cost</span>\n                        <span className=\"text-2xl font-bold text-fresh-mint font-fredoka\">$380</span>\n                      </div>\n                      <p className=\"text-xs text-gray-500 text-center mt-2 font-verdana\">You pay $380 ‚Ä¢ Cleaner earns $323 ‚Ä¢ Platform: $57</p>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </section>\n        </>\n      )}\n\n      {/* Cleaner Earnings */}\n      {userType === 'cleaner' && (\n        <section className=\"py-20\">\n          <div className=\"container mx-auto px-6\">\n            <div className=\"text-center mb-16\">\n              <h2 className=\"text-4xl font-fredoka font-bold text-graphite mb-4\">Your Earning Potential</h2>\n              <p className=\"text-xl text-gray-600 font-verdana\">Keep 80-85% of every booking ‚Ä¢ Set your own rates</p>\n            </div>\n\n            {/* Tier Earnings */}\n            <div className=\"grid md:grid-cols-4 gap-6 max-w-7xl mx-auto mb-16\">\n              {[\n                { tier: 'Developing', baseRange: '150-350', earnRange: '$12-28/hr', score: '0-59', payout: '80%' },\n                { tier: 'Semi Pro', baseRange: '350-450', earnRange: '$28-36/hr', score: '60-74', payout: '80%' },\n                { tier: 'Pro', baseRange: '450-600', earnRange: '$36-48/hr', score: '75-89', payout: '80%', popular: true },\n                { tier: 'Elite', baseRange: '600-850', earnRange: '$51-72/hr', score: '90-100', payout: '85%' }\n              ].map((tier, idx) => (\n                <Card key={idx} className={`border-2 ${tier.popular ? 'border-fresh-mint shadow-xl' : 'border-green-200'} rounded-2xl bg-gradient-to-br from-green-50 to-emerald-50`}>\n                  <CardContent className=\"p-6 text-center\">\n                    {tier.popular && (\n                      <Badge className=\"mb-3 text-white font-fredoka\" style={{ backgroundColor: '#28C76F' }}>Most Cleaners</Badge>\n                    )}\n                    <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">{tier.tier}</h3>\n                    <Badge variant=\"outline\" className=\"mb-4 font-verdana border-green-300\">Score: {tier.score}</Badge>\n                    <div className=\"my-4\">\n                      <p className=\"text-sm text-gray-600 font-verdana mb-1\">You charge:</p>\n                      <p className=\"text-2xl font-fredoka font-bold text-fresh-mint\">{tier.baseRange}</p>\n                      <p className=\"text-xs text-gray-500 font-verdana\">credits/hour</p>\n                    </div>\n                    <div className=\"py-4 bg-white rounded-xl border-2 border-green-200\">\n                      <p className=\"text-sm text-gray-600 font-verdana mb-1\">You earn ({tier.payout}):</p>\n                      <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">{tier.earnRange}</p>\n                    </div>\n                    <p className=\"text-xs text-gray-500 mt-3 font-verdana\">Plus add-ons: +$2.40-6.40/hr</p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n\n            {/* Payout Options */}\n            <div className=\"max-w-4xl mx-auto\">\n              <h3 className=\"text-3xl font-fredoka font-bold text-graphite mb-8 text-center\">Payout Options</h3>\n              <div className=\"grid md:grid-cols-2 gap-6\">\n                <Card className=\"border-2 border-green-300 shadow-lg rounded-2xl\">\n                  <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50\">\n                    <CardTitle className=\"font-fredoka text-fresh-mint\">Weekly Payouts (Free)</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <ul className=\"space-y-3\">\n                      {[\n                        'Automatic weekly deposits',\n                        'No fees - 100% of earnings',\n                        'Direct deposit to your bank',\n                        'Processing time: 2-3 business days'\n                      ].map((item, i) => (\n                        <li key={i} className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                          <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                          {item}\n                        </li>\n                      ))}\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"border-2 shadow-xl rounded-2xl\" style={{ borderColor: '#28C76F' }}>\n                  <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n                    <CardTitle className=\"font-fredoka text-fresh-mint\">Instant Payout (5% fee)</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <ul className=\"space-y-3\">\n                      {[\n                        'Cash out anytime',\n                        '5% convenience fee',\n                        'Money in your account within hours',\n                        'FREE for milestone achievements!'\n                      ].map((item, i) => (\n                        <li key={i} className=\"flex items-center gap-2 text-gray-700 font-verdana\">\n                          <CheckCircle className=\"w-5 h-5 text-fresh-mint\" />\n                          {item}\n                        </li>\n                      ))}\n                    </ul>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </div>\n        </section>\n      )}\n\n      {/* CTA */}\n      <section className=\"py-20 text-white\" style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)' }}>\n        <div className=\"container mx-auto px-6 text-center\">\n          <h2 className=\"text-4xl font-fredoka font-bold mb-6 text-white\">\n            {userType === 'client' ? 'Ready to Book?' : 'Ready to Start Earning?'}\n          </h2>\n          <p className=\"text-xl font-verdana mb-10 max-w-2xl mx-auto text-white\">\n            {userType === 'client'\n              ? 'Find your perfect cleaner and book in minutes'\n              : 'Join hundreds of cleaners earning on their own terms'}\n          </p>\n          <Link to={createPageUrl(userType === 'client' ? 'BrowseCleaners' : 'RoleSelection')}>\n            <Button size=\"lg\" className=\"bg-white hover:bg-blue-50 rounded-full shadow-xl text-lg px-10 py-7 font-fredoka font-semibold\" style={{ color: '#66B3FF' }}>\n              <Zap className=\"w-5 h-5 mr-2\" />\n              Get Started Now\n            </Button>\n          </Link>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\PrivacyPolicy.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Products.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":3,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":39,"fix":{"range":[69,81],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[68,80],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":3,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":50,"fix":{"range":[80,91],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[80,91],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'ExternalLink' is defined but never used.","line":7,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47,"fix":{"range":[348,362],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"ExternalLink"},"fix":{"range":[348,362],"text":""},"desc":"Remove unused variable 'ExternalLink'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"\nimport React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Package, Sparkles, Info, ExternalLink } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nconst PRODUCTS = {\n  'Core Tools': [\n    { name: 'Broom & Dustpan Set', image: 'https://images.unsplash.com/photo-1563453392212-326f5e854473?w=400', price: '$15-25', description: 'Essential for sweeping floors' },\n    { name: 'Mop & Bucket', image: 'https://images.unsplash.com/photo-1627483262769-77137a3eb05e?w=400', price: '$20-40', description: 'For mopping hardwood, tile, and laminate' },\n    { name: 'Vacuum Cleaner', image: 'https://images.unsplash.com/photo-1558317374-067fb5f30001?w=400', price: '$80-300', description: 'Upright or canister for carpets and floors' },\n    { name: 'Spray Bottles (3-pack)', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$8-15', description: 'For diluting and applying cleaning solutions' },\n    { name: 'Scrub Brush Set', image: 'https://images.unsplash.com/photo-1585421514738-01798e348b17?w=400', price: '$10-20', description: 'Various sizes for different surfaces' },\n    { name: 'Grout Brush', image: 'https://images.unsplash.com/photo-1603712725038-779d45d5a5f8?w=400', price: '$5-12', description: 'Narrow brush for tile grout and corners' },\n    { name: 'Squeegee', image: 'https://images.unsplash.com/photo-1628177142898-93e36e4e3a50?w=400', price: '$8-15', description: 'For windows and glass surfaces' },\n    { name: 'Duster with Extension Pole', image: 'https://images.unsplash.com/photo-1600880292089-90a7e086ee0c?w=400', price: '$15-30', description: 'Reach ceiling fans, light fixtures, and high shelves' },\n  ],\n  'Cleaning Chemicals': [\n    { name: 'All-Purpose Cleaner', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$4-12', description: 'Multi-surface spray (Method, Mrs. Meyers, or professional grade)', brands: 'Method, Mrs. Meyers, Fabuloso' },\n    { name: 'Glass Cleaner (Windex)', image: 'https://images.unsplash.com/photo-1585421514738-01798e348b17?w=400', price: '$4-8', description: 'For windows, mirrors, and glass surfaces', brands: 'Windex, Sprayway' },\n    { name: 'Bathroom Cleaner', image: 'https://images.unsplash.com/photo-1620799139834-6b8f844fbe29?w=400', price: '$5-10', description: 'Disinfectant for tubs, tiles, and toilets', brands: 'Lysol, Scrubbing Bubbles, Clorox' },\n    { name: 'Bleach/Disinfectant', image: 'https://images.unsplash.com/photo-1584820927498-cfe5211fd8bf?w=400', price: '$3-6', description: 'For sanitizing and removing tough stains', brands: 'Clorox, Lysol' },\n    { name: 'Degreaser', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$6-15', description: 'For kitchen surfaces, stovetops, and ovens', brands: 'Krud Kutter, Goo Gone, Simple Green' },\n    { name: 'Wood/Furniture Polish', image: 'https://images.unsplash.com/photo-1556228578-8c89e6adf883?w=400', price: '$5-12', description: 'For wood surfaces and furniture', brands: 'Pledge, Old English, Howard' },\n    { name: 'Hardwood Floor Cleaner', image: 'https://images.unsplash.com/photo-1581858726788-75bc0f1a4471?w=400', price: '$8-18', description: 'pH-balanced for wood floors', brands: 'Bona, Method, Rejuvenate' },\n    { name: 'Stainless Steel Polish', image: 'https://images.unsplash.com/photo-1556228852-80524e043dd4?w=400', price: '$6-12', description: 'For appliances and fixtures', brands: 'Weiman, Bar Keepers Friend' },\n    { name: 'Oven Cleaner', image: 'https://images.unsplash.com/photo-1585421514738-01798e348b17?w=400', price: '$5-10', description: 'For deep cleaning ovens and stovetops', brands: 'Easy-Off, Carbona' },\n    { name: 'Toilet Bowl Cleaner', image: 'https://images.unsplash.com/photo-1629705580036-8fc96c3b8a02?w=400', price: '$4-8', description: 'Disinfecting toilet cleaner', brands: 'Lysol, Clorox, The Works' },\n    { name: 'Tile & Grout Cleaner', image: 'https://images.unsplash.com/photo-1628177142898-93e36e4e3a50?w=400', price: '$6-15', description: 'For bathroom and kitchen tiles', brands: 'Zep, CLR, OxiClean' },\n  ],\n  'Disposables & Cloths': [\n    { name: 'Microfiber Cloths (12-pack)', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$12-25', description: 'Reusable cloths for all surfaces' },\n    { name: 'Paper Towels (6-pack)', image: 'https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400', price: '$15-25', description: 'For quick cleanups and glass' },\n    { name: 'Sponges (10-pack)', image: 'https://images.unsplash.com/photo-1584820927498-cfe5211fd8bf?w=400', price: '$8-15', description: 'Non-scratch and scrubbing sponges' },\n    { name: 'Magic Erasers (8-pack)', image: 'https://images.unsplash.com/photo-1583947215259-38e31be8751f?w=400', price: '$8-12', description: 'For scuff marks and tough stains', brands: 'Mr. Clean' },\n    { name: 'Cleaning Rags (12-pack)', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$10-18', description: 'Cotton or terry cloth rags' },\n    { name: 'Trash Bags (Various Sizes)', image: 'https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?w=400', price: '$12-20', description: 'For removing debris and waste' },\n  ],\n  'Safety & Protection': [\n    { name: 'Cleaning Gloves (Multiple Pairs)', image: 'https://images.unsplash.com/photo-1603100022002-8b72fb5f2f6c?w=400', price: '$6-15', description: 'Nitrile or latex gloves for protection', brands: 'Playtex, Mr. Clean' },\n    { name: 'Face Masks/Respirator', image: 'https://images.unsplash.com/photo-1584634428508-2c24dcb6f07d?w=400', price: '$8-25', description: 'For dust or chemical fumes' },\n    { name: 'Safety Glasses', image: 'https://images.unsplash.com/photo-1577219491135-ce391730fb4c?w=400', price: '$5-12', description: 'Eye protection for chemical splashes' },\n    { name: 'Apron', image: 'https://images.unsplash.com/photo-1561758033-d89a9ad46330?w=400', price: '$12-25', description: 'Keep clothes clean during work' },\n  ],\n  'Transport & Organization': [\n    { name: 'Cleaning Caddy', image: 'https://images.unsplash.com/photo-1629705580036-8fc96c3b8a02?w=400', price: '$15-30', description: 'Portable organizer for supplies' },\n    { name: 'Rolling Cart', image: 'https://images.unsplash.com/photo-1581858726788-75bc0f1a4471?w=400', price: '$40-80', description: 'For transporting supplies between rooms' },\n    { name: 'Storage Bins', image: 'https://images.unsplash.com/photo-1600880292089-90a7e086ee0c?w=400', price: '$20-40', description: 'For organizing and storing supplies' },\n    { name: 'Professional Tote/Bag', image: 'https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?w=400', price: '$25-60', description: 'Branded or professional carrying bag' },\n  ],\n  'Specialty & Add-Ons': [\n    { name: 'Steam Cleaner', image: 'https://images.unsplash.com/photo-1585421514738-01798e348b17?w=400', price: '$80-200', description: 'For deep cleaning and sanitizing', optional: true },\n    { name: 'Carpet Cleaner Machine', image: 'https://images.unsplash.com/photo-1558317374-067fb5f30001?w=400', price: '$150-400', description: 'For carpet deep cleaning services', optional: true },\n    { name: 'Window Cleaning Kit', image: 'https://images.unsplash.com/photo-1628177142898-93e36e4e3a50?w=400', price: '$30-60', description: 'Extension pole, squeegee, scrubber', optional: true },\n    { name: 'Tile & Grout Brush with Handle', image: 'https://images.unsplash.com/photo-1603712725038-779d45d5a5f8?w=400', price: '$15-30', description: 'For detailed tile cleaning' },\n    { name: 'Handheld Vacuum', image: 'https://images.unsplash.com/photo-1558317374-067fb5f30001?w=400', price: '$40-100', description: 'For quick touch-ups and upholstery' },\n    { name: 'Dusting Wand/Swiffer', image: 'https://images.unsplash.com/photo-1600880292089-90a7e086ee0c?w=400', price: '$12-25', description: 'For floors and dusting' },\n  ]\n};\n\nexport default function Products() {\n  const [selectedCategory, setSelectedCategory] = useState('Core Tools');\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <Package className=\"w-7 h-7 text-white\" />\n            </div>\n            <div className=\"flex-1\">\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Cleaning Products Guide</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">Common cleaning supplies with product examples and images</p>\n            </div>\n          </div>\n\n          <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n            <Info className=\"w-4 h-4 text-blue-600\" />\n            <AlertDescription className=\"text-blue-900 font-verdana\">\n              <strong>Independent Contractor Notice:</strong> This is a reference guide only. As an independent contractor, you have complete freedom to choose your own products, brands, and methods. These are simply common examples to help you understand what many professionals use.\n            </AlertDescription>\n          </Alert>\n        </motion.div>\n\n        {/* Category Tabs */}\n        <Tabs value={selectedCategory} onValueChange={setSelectedCategory} className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-lg p-2 flex flex-wrap gap-2 rounded-2xl\">\n            {Object.keys(PRODUCTS).map(category => (\n              <TabsTrigger\n                key={category}\n                value={category}\n                className=\"rounded-full font-fredoka data-[state=active]:brand-gradient data-[state=active]:text-white\"\n              >\n                {category}\n              </TabsTrigger>\n            ))}\n          </TabsList>\n\n          {Object.entries(PRODUCTS).map(([category, items]) => (\n            <TabsContent key={category} value={category}>\n              <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {items.map((product, index) => (\n                  <motion.div\n                    key={index}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: index * 0.05 }}\n                  >\n                    <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all rounded-2xl overflow-hidden group\">\n                      <div className=\"relative h-48 overflow-hidden bg-gray-100\">\n                        <img\n                          src={product.image}\n                          alt={product.name}\n                          className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300\"\n                        />\n                        {product.optional && (\n                          <Badge className=\"absolute top-3 right-3 bg-purple-500 text-white font-fredoka\">\n                            Optional\n                          </Badge>\n                        )}\n                        <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4\">\n                          <p className=\"text-white font-fredoka font-bold text-lg\">{product.price}</p>\n                        </div>\n                      </div>\n                      <CardContent className=\"p-6\">\n                        <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">{product.name}</h3>\n                        <p className=\"text-sm text-gray-600 font-verdana mb-3\">{product.description}</p>\n                        {product.brands && (\n                          <div className=\"flex flex-wrap gap-2\">\n                            {product.brands.split(', ').map((brand, i) => (\n                              <Badge key={i} variant=\"outline\" className=\"text-xs font-verdana\">\n                                {brand}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            </TabsContent>\n          ))}\n        </Tabs>\n\n        {/* Footer Note */}\n        <Card className=\"mt-12 border-0 shadow-xl bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl\">\n          <CardContent className=\"p-8\">\n            <div className=\"flex items-start gap-4\">\n              <Sparkles className=\"w-6 h-6 text-puretask-blue flex-shrink-0 mt-1\" />\n              <div>\n                <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">Your Choice, Your Business</h3>\n                <p className=\"text-gray-700 font-verdana leading-relaxed mb-3\">\n                  As an independent contractor, you have complete control over which products you use. The brands and items shown here are examples based on what many professionals prefer. You're welcome to use your own trusted products, eco-friendly alternatives, or professional-grade supplies based on your clients' needs and your business preferences.\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana\">\n                  üí° <strong>Tip:</strong> Check out our Partner Discounts page for exclusive deals on cleaning supplies from trusted brands.\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Profile.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Link' is defined but never used.","line":3,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27,"fix":{"range":[122,128],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Link"},"fix":{"range":[122,128],"text":""},"desc":"Remove unused variable 'Link'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardDescription' is defined but never used.","line":6,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":67,"fix":{"range":[291,308],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardDescription"},"fix":{"range":[291,308],"text":""},"desc":"Remove unused variable 'CardDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Textarea' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18,"fix":{"range":[483,536],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Textarea"},"fix":{"range":[483,535],"text":""},"desc":"Remove unused variable 'Textarea'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Switch' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":16,"fix":{"range":[729,778],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Switch"},"fix":{"range":[729,777],"text":""},"desc":"Remove unused variable 'Switch'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Checkbox' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18,"fix":{"range":[778,831],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Checkbox"},"fix":{"range":[778,830],"text":""},"desc":"Remove unused variable 'Checkbox'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":17,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":47,"fix":{"range":[881,888],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[880,887],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":18,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":56,"fix":{"range":[976,983],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[975,982],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Video' is defined but never used.","line":19,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":16,"fix":{"range":[1019,1026],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Video"},"fix":{"range":[1018,1025],"text":""},"desc":"Remove unused variable 'Video'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Palette' is defined but never used.","line":19,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":25,"fix":{"range":[1026,1035],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Palette"},"fix":{"range":[1025,1034],"text":""},"desc":"Remove unused variable 'Palette'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Tag' is defined but never used.","line":19,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":30,"fix":{"range":[1035,1040],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Tag"},"fix":{"range":[1034,1039],"text":""},"desc":"Remove unused variable 'Tag'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Bell' is defined but never used.","line":19,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":46,"fix":{"range":[1050,1056],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Bell"},"fix":{"range":[1049,1055],"text":""},"desc":"Remove unused variable 'Bell'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":19,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":51,"fix":{"range":[1056,1061],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[1055,1060],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":19,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":63,"fix":{"range":[1061,1073],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[1060,1072],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Image' is defined but never used.","line":19,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":70,"fix":{"range":[1073,1080],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Image"},"fix":{"range":[1072,1079],"text":""},"desc":"Remove unused variable 'Image'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertTriangle' is defined but never used.","line":19,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":85,"fix":{"range":[1079,1094],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertTriangle"},"fix":{"range":[1079,1094],"text":""},"desc":"Remove unused variable 'AlertTriangle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":24,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":33,"fix":{"range":[1378,1395],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[1378,1395],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'productConfig' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":211,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":211,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"productConfig"},"fix":{"range":[8755,8873],"text":""},"desc":"Remove unused variable 'productConfig'."}]}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":16,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Switch } from '@/components/ui/switch';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { \n  User as UserIcon, Mail, Phone, MapPin, Award, Shield, Edit2, Save, X, CheckCircle, \n  Sparkles, Star, Briefcase, Loader2, DollarSign, Clock, Calendar, MessageSquare, \n  Camera, Video, Palette, Tag, Settings, Bell, Zap, TrendingUp, Image, AlertTriangle\n} from 'lucide-react';\nimport ReliabilityMeterV2 from '../components/reliability/ReliabilityMeterV2';\nimport AddressAutocomplete from '../components/address/AddressAutocomplete';\nimport { getTierColorClasses, getProductColors } from '../components/utils/colorSystem';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\nimport { \n  ProfileTab, \n  PricingTab, \n  ServicesTab, \n  AvailabilityTab, \n  CommunicationTab, \n  PortfolioTab,\n  SettingsTab\n} from '../components/cleaner/ComprehensiveProfileEditor';\n\nexport default function Profile() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [userType, setUserType] = useState(null);\n  const [cleanerProfile, setCleanerProfile] = useState(null);\n  const [clientProfile, setClientProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [editing, setEditing] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [message, setMessage] = useState('');\n\n  const [activeTab, setActiveTab] = useState('profile');\n  const [formData, setFormData] = useState({\n    full_name: '',\n    phone: '',\n    bio: '',\n    hourly_rate: '',\n    base_rate_credits_per_hour: 150,\n    deep_addon_credits_per_hour: 50,\n    moveout_addon_credits_per_hour: 50,\n    default_address: '',\n    home_size: 'medium',\n    latitude: null,\n    longitude: null,\n    product_preference: 'standard',\n    specialty_tags: [],\n    offers_additional_services: [],\n    instant_book_enabled: false,\n    instant_book_hours: 48,\n    accepts_subscriptions: true,\n    service_locations: [],\n    communication_settings: {\n      booking_confirmation: { enabled: true, channels: ['in_app', 'email'] },\n      pre_cleaning_reminder: { enabled: true, days_before: 1, channels: ['sms', 'in_app'] },\n      on_my_way: { enabled: true, channels: ['sms', 'in_app'], include_eta: true },\n      post_cleaning_summary: { enabled: true, channels: ['in_app', 'email'] },\n      review_request: { enabled: true, hours_after_completion: 24, channels: ['in_app', 'email'] }\n    }\n  });\n\n  useEffect(() => {\n    loadProfile();\n  }, []);\n\n  const loadProfile = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n      setUserType(currentUser.user_type);\n\n      if (currentUser.user_type === 'cleaner') {\n        const profiles = await base44.entities.CleanerProfile.filter({ user_email: currentUser.email });\n        if (profiles.length > 0) {\n          const profile = profiles[0];\n          setCleanerProfile(profile);\n          setFormData({\n            full_name: currentUser.full_name || '',\n            phone: currentUser.phone || '',\n            bio: profile.bio || '',\n            hourly_rate: profile.hourly_rate || '',\n            base_rate_credits_per_hour: profile.base_rate_credits_per_hour || 150,\n            deep_addon_credits_per_hour: profile.deep_addon_credits_per_hour || 50,\n            moveout_addon_credits_per_hour: profile.moveout_addon_credits_per_hour || 50,\n            product_preference: profile.product_preference || 'standard',\n            specialty_tags: profile.specialty_tags || [],\n            offers_additional_services: profile.offers_additional_services || [],\n            instant_book_enabled: profile.instant_book_enabled || false,\n            instant_book_hours: profile.instant_book_hours || 48,\n            accepts_subscriptions: profile.accepts_subscriptions !== false,\n            service_locations: profile.service_locations || [],\n            communication_settings: profile.communication_settings || formData.communication_settings,\n            default_address: formData.default_address,\n            home_size: formData.home_size,\n            latitude: formData.latitude,\n            longitude: formData.longitude,\n          });\n        }\n      } else if (currentUser.user_type === 'client') {\n        const profiles = await base44.entities.ClientProfile.filter({ user_email: currentUser.email });\n        if (profiles.length > 0) {\n          setClientProfile(profiles[0]);\n          setFormData({\n            full_name: currentUser.full_name || '',\n            phone: currentUser.phone || '',\n            default_address: profiles[0].default_address || '',\n            home_size: profiles[0].home_size || 'medium',\n            latitude: profiles[0].latitude || null,\n            longitude: profiles[0].longitude || null,\n            bio: formData.bio,\n            hourly_rate: formData.hourly_rate,\n            product_preference: formData.product_preference,\n          });\n        }\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading profile:', showToast: false });\n      navigate(createPageUrl('Home'));\n    }\n    setLoading(false);\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    setMessage('');\n\n    try {\n      await base44.entities.User.update(user.id, {\n        full_name: formData.full_name,\n        phone: formData.phone\n      });\n\n      if (userType === 'cleaner' && cleanerProfile) {\n        await base44.entities.CleanerProfile.update(cleanerProfile.id, {\n          bio: formData.bio,\n          hourly_rate: parseFloat(formData.hourly_rate) || cleanerProfile.hourly_rate,\n          base_rate_credits_per_hour: parseFloat(formData.base_rate_credits_per_hour) || 150,\n          deep_addon_credits_per_hour: parseFloat(formData.deep_addon_credits_per_hour) || 50,\n          moveout_addon_credits_per_hour: parseFloat(formData.moveout_addon_credits_per_hour) || 50,\n          product_preference: formData.product_preference,\n          specialty_tags: formData.specialty_tags,\n          offers_additional_services: formData.offers_additional_services,\n          instant_book_enabled: formData.instant_book_enabled,\n          instant_book_hours: parseInt(formData.instant_book_hours) || 48,\n          accepts_subscriptions: formData.accepts_subscriptions,\n          service_locations: formData.service_locations,\n          communication_settings: formData.communication_settings\n        });\n      } else if (userType === 'client' && clientProfile) {\n        await base44.entities.ClientProfile.update(clientProfile.id, {\n          default_address: formData.default_address,\n          home_size: formData.home_size,\n          latitude: formData.latitude,\n          longitude: formData.longitude\n        });\n      }\n\n      toast.success('Profile updated successfully!');\n      setMessage('Profile updated successfully!');\n      setEditing(false);\n      await loadProfile();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error saving profile:', showToast: false });\n      toast.error('Failed to save changes. Please try again.');\n      setMessage('Failed to save changes. Please try again.');\n    }\n    setSaving(false);\n  };\n\n  const toggleSpecialty = (tag) => {\n    setFormData(prev => ({\n      ...prev,\n      specialty_tags: prev.specialty_tags.includes(tag)\n        ? prev.specialty_tags.filter(t => t !== tag)\n        : [...prev.specialty_tags, tag]\n    }));\n  };\n\n  const toggleService = (service) => {\n    setFormData(prev => ({\n      ...prev,\n      offers_additional_services: prev.offers_additional_services.includes(service)\n        ? prev.offers_additional_services.filter(s => s !== service)\n        : [...prev.offers_additional_services, service]\n    }));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10 flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const tierConfig = cleanerProfile ? getTierColorClasses(cleanerProfile.tier) : null;\n  const productConfig = cleanerProfile?.product_preference ? getProductColors(cleanerProfile.product_preference) : null;\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      {/* Hero Header for Cleaners */}\n      {userType === 'cleaner' && cleanerProfile && (\n        <div className={`bg-gradient-to-r ${tierConfig.gradient} py-12 px-6 lg:px-10 shadow-xl`}>\n          <div className=\"max-w-4xl mx-auto\">\n            <motion.div\n              initial={{ opacity: 0, y: -20 }}\n              animate={{ opacity: 1, y: 0 }}\n              className=\"flex flex-col md:flex-row items-center md:items-start gap-6\"\n            >\n              {/* Profile Photo */}\n              <div className=\"relative\">\n                {cleanerProfile.profile_photo_url ? (\n                  <img\n                    src={cleanerProfile.profile_photo_url}\n                    alt={user.full_name}\n                    className=\"w-32 h-32 rounded-2xl object-cover shadow-2xl border-4 border-white\"\n                  />\n                ) : (\n                  <div className=\"w-32 h-32 bg-white/20 rounded-2xl flex items-center justify-center text-5xl font-fredoka font-bold text-white shadow-2xl border-4 border-white\">\n                    {user.full_name?.[0]?.toUpperCase() || 'U'}\n                  </div>\n                )}\n                <div className=\"absolute -bottom-2 -right-2\">\n                  <ReliabilityMeterV2 \n                    score={cleanerProfile.reliability_score || 75}\n                    tier={cleanerProfile.tier}\n                    size=\"small\"\n                    showLabel={false}\n                  />\n                </div>\n              </div>\n\n              {/* Profile Info */}\n              <div className=\"flex-1 text-center md:text-left\">\n                <div className=\"flex flex-col md:flex-row md:items-center gap-3 mb-3\">\n                  <h1 className=\"text-3xl lg:text-4xl font-fredoka font-bold text-white\">{user.full_name}</h1>\n                  <Badge className={`${tierConfig.bg} ${tierConfig.text} border-0 text-base px-3 py-1 rounded-full font-fredoka`}>\n                    {tierConfig.icon} {cleanerProfile.tier}\n                  </Badge>\n                </div>\n\n                <div className=\"flex flex-wrap items-center justify-center md:justify-start gap-4 mb-4\">\n                  {/* Rating */}\n                  <div className=\"flex items-center gap-2 bg-white/20 backdrop-blur-sm px-3 py-2 rounded-full\">\n                    <Star className=\"w-4 h-4 fill-amber-300 text-amber-300\" />\n                    <span className=\"text-white font-fredoka font-semibold\">\n                      {cleanerProfile.average_rating?.toFixed(1) || '5.0'}\n                    </span>\n                    <span className=\"text-white/80 text-sm font-verdana\">({cleanerProfile.total_reviews || 0})</span>\n                  </div>\n\n                  {/* Jobs */}\n                  <div className=\"flex items-center gap-2 bg-white/20 backdrop-blur-sm px-3 py-2 rounded-full\">\n                    <Briefcase className=\"w-4 h-4 text-white\" />\n                    <span className=\"text-white font-fredoka font-semibold\">{cleanerProfile.total_jobs || 0} jobs</span>\n                  </div>\n\n                  {/* Rate */}\n                  <div className=\"flex items-center gap-2 bg-white/20 backdrop-blur-sm px-3 py-2 rounded-full\">\n                    <span className=\"text-2xl font-fredoka font-bold text-white\">${cleanerProfile.hourly_rate}</span>\n                    <span className=\"text-white/80 text-sm font-verdana\">/hr</span>\n                  </div>\n                </div>\n\n                {!editing && (\n                  <Button\n                    onClick={() => setEditing(true)}\n                    className=\"bg-white text-fresh-mint hover:bg-green-50 rounded-full font-fredoka font-semibold\"\n                  >\n                    <Edit2 className=\"w-4 h-4 mr-2\" />\n                    Edit Profile\n                  </Button>\n                )}\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      )}\n\n      {/* Header for Clients */}\n      {userType === 'client' && (\n        <div className=\"brand-gradient py-12 px-6 lg:px-10 shadow-xl\">\n          <div className=\"max-w-4xl mx-auto\">\n            <div className=\"flex items-center gap-6\">\n              <div className=\"w-24 h-24 bg-white/20 rounded-2xl flex items-center justify-center text-4xl font-fredoka font-bold text-white shadow-2xl border-4 border-white\">\n                {user.full_name?.[0]?.toUpperCase() || 'U'}\n              </div>\n              <div className=\"flex-1\">\n                <h1 className=\"text-3xl lg:text-4xl font-fredoka font-bold text-white mb-2\">{user.full_name}</h1>\n                <Badge className=\"bg-white/20 text-white border-0 rounded-full font-fredoka\">Client Member</Badge>\n              </div>\n              {!editing && (\n                <Button\n                  onClick={() => setEditing(true)}\n                  className=\"bg-white text-puretask-blue hover:bg-blue-50 rounded-full font-fredoka font-semibold\"\n                >\n                  <Edit2 className=\"w-4 h-4 mr-2\" />\n                  Edit Profile\n                </Button>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Main Content */}\n      <div className=\"max-w-4xl mx-auto px-6 lg:px-10 py-10\">\n        {message && (\n          <Alert className=\"mb-6 border-fresh-mint bg-green-50 rounded-2xl\">\n            <CheckCircle className=\"w-4 h-4 text-fresh-mint\" />\n            <AlertDescription className=\"text-green-900 font-verdana\">{message}</AlertDescription>\n          </Alert>\n        )}\n\n        {editing && (\n          <div className=\"flex justify-end gap-2 mb-6\">\n            <Button\n              onClick={() => {\n                setEditing(false);\n                loadProfile();\n              }}\n              variant=\"outline\"\n              className=\"rounded-full font-fredoka\"\n            >\n              <X className=\"w-4 h-4 mr-2\" />\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSave}\n              disabled={saving}\n              className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n            >\n              <Save className=\"w-4 h-4 mr-2\" />\n              {saving ? 'Saving...' : 'Save Changes'}\n            </Button>\n          </div>\n        )}\n\n        {/* Cleaner Profile Content */}\n        {userType === 'cleaner' && cleanerProfile && (\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-2 md:grid-cols-7 bg-white rounded-2xl p-1 shadow-lg\">\n              <TabsTrigger value=\"profile\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <UserIcon className=\"w-4 h-4 mr-2\" />Profile\n              </TabsTrigger>\n              <TabsTrigger value=\"pricing\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <DollarSign className=\"w-4 h-4 mr-2\" />Pricing\n              </TabsTrigger>\n              <TabsTrigger value=\"services\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <Sparkles className=\"w-4 h-4 mr-2\" />Services\n              </TabsTrigger>\n              <TabsTrigger value=\"availability\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <Calendar className=\"w-4 h-4 mr-2\" />Availability\n              </TabsTrigger>\n              <TabsTrigger value=\"communication\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <MessageSquare className=\"w-4 h-4 mr-2\" />Communication\n              </TabsTrigger>\n              <TabsTrigger value=\"portfolio\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <Camera className=\"w-4 h-4 mr-2\" />Portfolio\n              </TabsTrigger>\n              <TabsTrigger value=\"settings\" className=\"rounded-xl font-fredoka data-[state=active]:bg-puretask-blue data-[state=active]:text-white\">\n                <Settings className=\"w-4 h-4 mr-2\" />Settings\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"profile\">\n              <ProfileTab formData={formData} setFormData={setFormData} editing={editing} user={user} cleanerProfile={cleanerProfile} />\n            </TabsContent>\n\n            <TabsContent value=\"pricing\">\n              <PricingTab formData={formData} setFormData={setFormData} editing={editing} cleanerProfile={cleanerProfile} />\n            </TabsContent>\n\n            <TabsContent value=\"services\">\n              <ServicesTab formData={formData} setFormData={setFormData} editing={editing} toggleSpecialty={toggleSpecialty} toggleService={toggleService} />\n            </TabsContent>\n\n            <TabsContent value=\"availability\">\n              <AvailabilityTab formData={formData} setFormData={setFormData} editing={editing} />\n            </TabsContent>\n\n            <TabsContent value=\"communication\">\n              <CommunicationTab formData={formData} setFormData={setFormData} editing={editing} />\n            </TabsContent>\n\n            <TabsContent value=\"portfolio\">\n              <PortfolioTab cleanerProfile={cleanerProfile} />\n            </TabsContent>\n\n            <TabsContent value=\"settings\">\n              <SettingsTab formData={formData} setFormData={setFormData} editing={editing} />\n            </TabsContent>\n          </Tabs>\n        )}\n\n        {/* Client Profile Content */}\n        {userType === 'client' && clientProfile && (\n          <div className=\"space-y-6\">\n            {/* Client Stats */}\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n                <CardTitle className=\"font-fredoka text-graphite\">Membership Overview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid md:grid-cols-3 gap-4\">\n                  <div className=\"bg-blue-50 p-4 rounded-2xl border-2 border-blue-200\">\n                    <p className=\"text-sm text-puretask-blue font-verdana mb-1\">Total Bookings</p>\n                    <p className=\"text-3xl font-fredoka font-bold text-blue-900\">{clientProfile.total_bookings}</p>\n                  </div>\n                  <div className=\"bg-green-50 p-4 rounded-2xl border-2 border-green-200\">\n                    <p className=\"text-sm text-fresh-mint font-verdana mb-1\">Credits Balance</p>\n                    <p className=\"text-3xl font-fredoka font-bold text-green-900\">${clientProfile.credits_balance?.toFixed(2) || '0.00'}</p>\n                  </div>\n                  <div className=\"bg-purple-50 p-4 rounded-2xl border-2 border-purple-200\">\n                    <p className=\"text-sm text-purple-600 font-verdana mb-1\">Membership</p>\n                    <Badge className=\"text-lg px-3 py-1 rounded-full font-fredoka\">{clientProfile.membership_tier}</Badge>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Profile Details */}\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n                <CardTitle className=\"font-fredoka text-graphite\">Profile Details</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {editing ? (\n                  <>\n                    <div>\n                      <Label htmlFor=\"full_name\" className=\"font-fredoka text-graphite\">Full Name</Label>\n                      <Input\n                        id=\"full_name\"\n                        value={formData.full_name}\n                        onChange={(e) => setFormData({ ...formData, full_name: e.target.value })}\n                        className=\"rounded-full font-verdana\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"phone\" className=\"font-fredoka text-graphite\">Phone Number</Label>\n                      <Input\n                        id=\"phone\"\n                        type=\"tel\"\n                        value={formData.phone}\n                        onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                        className=\"rounded-full font-verdana\"\n                      />\n                    </div>\n                    <AddressAutocomplete\n                      value={formData.default_address}\n                      onChange={(address) => setFormData({ ...formData, default_address: address })}\n                      onLocationSelect={(location) => setFormData({\n                        ...formData,\n                        default_address: location.address,\n                        latitude: location.latitude,\n                        longitude: location.longitude\n                      })}\n                      label=\"Default Cleaning Address\"\n                    />\n                    <div>\n                      <Label htmlFor=\"home_size\" className=\"font-fredoka text-graphite\">Home Size</Label>\n                      <select\n                        id=\"home_size\"\n                        className=\"w-full p-2 border rounded-full font-verdana\"\n                        value={formData.home_size}\n                        onChange={(e) => setFormData({ ...formData, home_size: e.target.value })}\n                      >\n                        <option value=\"small\">Small (under 1000 sq ft)</option>\n                        <option value=\"medium\">Medium (1000-2000 sq ft)</option>\n                        <option value=\"large\">Large (over 2000 sq ft)</option>\n                      </select>\n                    </div>\n                  </>\n                ) : (\n                  <>\n                    <div className=\"grid md:grid-cols-2 gap-6\">\n                      <div>\n                        <Label className=\"text-gray-600 font-fredoka\">Email</Label>\n                        <p className=\"text-graphite mt-1 flex items-center gap-2 font-verdana\">\n                          <Mail className=\"w-4 h-4 text-gray-400\" />\n                          {user.email}\n                        </p>\n                      </div>\n                      <div>\n                        <Label className=\"text-gray-600 font-fredoka\">Phone</Label>\n                        <p className=\"text-graphite mt-1 flex items-center gap-2 font-verdana\">\n                          <Phone className=\"w-4 h-4 text-gray-400\" />\n                          {user.phone || 'Not set'}\n                        </p>\n                      </div>\n                    </div>\n                    \n                    {clientProfile.default_address && (\n                      <div>\n                        <Label className=\"text-gray-600 font-fredoka\">Default Address</Label>\n                        <p className=\"text-graphite mt-1 flex items-center gap-2 font-verdana\">\n                          <MapPin className=\"w-4 h-4 text-gray-400\" />\n                          {clientProfile.default_address}\n                        </p>\n                      </div>\n                    )}\n                    \n                    <div>\n                      <Label className=\"text-gray-600 font-fredoka\">Home Size</Label>\n                      <p className=\"text-graphite mt-1 capitalize font-verdana\">{clientProfile.home_size}</p>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Account Security */}\n        <Card className=\"border-0 shadow-xl rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-gray-50 to-slate-50 rounded-t-2xl\">\n            <CardTitle className=\"flex items-center gap-2 font-fredoka text-graphite\">\n              <Shield className=\"w-6 h-6 text-gray-700\" />\n              Account Security\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div>\n                <Label className=\"text-gray-600 font-fredoka\">Member Since</Label>\n                <p className=\"text-graphite mt-1 font-verdana\">\n                  {new Date(user?.created_date).toLocaleDateString('en-US', {\n                    year: 'numeric',\n                    month: 'long',\n                    day: 'numeric'\n                  })}\n                </p>\n              </div>\n              {userType === 'cleaner' && (\n                <>\n                  <div>\n                    <Label className=\"text-gray-600 font-fredoka\">KYC Status</Label>\n                    <Badge className={`mt-1 rounded-full font-fredoka ${\n                      user?.kyc_status === 'approved' ? 'bg-fresh-mint' :\n                      user?.kyc_status === 'rejected' ? 'bg-red-500' : 'bg-amber-500'\n                    }`}>\n                      {user?.kyc_status}\n                    </Badge>\n                  </div>\n                  <div>\n                    <Label className=\"text-gray-600 font-fredoka\">Background Check</Label>\n                    <Badge className={`mt-1 rounded-full font-fredoka ${\n                      user?.background_check_status === 'approved' ? 'bg-fresh-mint' :\n                      user?.background_check_status === 'rejected' ? 'bg-red-500' : 'bg-amber-500'\n                    }`}>\n                      {user?.background_check_status}\n                    </Badge>\n                  </div>\n                </>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\RecommendedDuties.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"fix":{"range":[122,169],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[122,168],"text":""},"desc":"Remove unused variable 'Badge'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { CheckCircle, Info, Sparkles, Home as HomeIcon, Key, Calendar } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nconst CLEANING_DUTIES = {\n  basic: {\n    title: 'Basic Cleaning (2 Bed / 2 Bath)',\n    subtitle: 'Standard maintenance cleaning - typical 2-3 hours',\n    icon: 'üè†',\n    color: 'blue',\n    duties: {\n      'Kitchen': [\n        'Wipe down all countertops and backsplash',\n        'Clean exterior of appliances (fridge, stove, microwave, dishwasher)',\n        'Clean sink and faucet',\n        'Wipe cabinet fronts',\n        'Sweep and mop floor',\n        'Empty trash and replace liner'\n      ],\n      'Bathrooms (Both)': [\n        'Clean and disinfect toilet (bowl, seat, exterior)',\n        'Clean and disinfect sink, faucet, and counter',\n        'Clean mirror',\n        'Wipe down exterior of cabinets',\n        'Clean tub/shower (walls, fixtures, glass door if applicable)',\n        'Sweep and mop floor',\n        'Empty trash and replace liner'\n      ],\n      'Bedrooms (Both)': [\n        'Make beds (if linens are present)',\n        'Dust all accessible surfaces',\n        'Vacuum or sweep floors',\n        'Empty trash'\n      ],\n      'Living/Dining Areas': [\n        'Dust all accessible surfaces (tables, shelves, TV stands)',\n        'Vacuum carpets or sweep/mop hard floors',\n        'Wipe down light switches and doorknobs',\n        'Straighten pillows/cushions'\n      ],\n      'General (All Rooms)': [\n        'Spot clean walls and light switches',\n        'Empty all trash bins',\n        'Light dusting of accessible surfaces'\n      ]\n    }\n  },\n  deep: {\n    title: 'Deep Clean Add-Ons',\n    subtitle: 'Additional tasks beyond basic cleaning (+$3-8/hour in credits)',\n    icon: '‚ú®',\n    color: 'purple',\n    duties: {\n      'Additional Tasks': [\n        'Baseboards - wipe down all baseboards in every room',\n        'Ceiling fans - dust and wipe blades',\n        'Light fixtures - dust and wipe accessible fixtures',\n        'Window sills and tracks - vacuum and wipe',\n        'Interior windows - clean glass on inside',\n        'Cabinet interiors - wipe down inside of cabinets (if requested)',\n        'Refrigerator interior - clean inside fridge and freezer (if requested)',\n        'Oven interior - deep clean inside oven',\n        'Behind/under furniture - move and clean (if safe to move)',\n        'Detailed grout cleaning - scrub tile grout',\n        'Air vents - dust and wipe vent covers',\n        'Door frames - wipe down all door frames'\n      ]\n    }\n  },\n  moveout: {\n    title: 'Move-Out / Move-In Cleaning',\n    subtitle: 'Complete vacant property cleaning (+$3-8/hour in credits)',\n    icon: 'üì¶',\n    color: 'emerald',\n    description: 'Move-out cleans are for EMPTY properties only. This is the most thorough cleaning service, covering everything a basic and deep clean includes, PLUS the detailed items below.',\n    duties: {\n      'Kitchen (Complete)': [\n        'All basic kitchen tasks',\n        'Inside all cabinets and drawers - wipe shelves, walls, and drawer interiors',\n        'Inside refrigerator and freezer - complete deep clean',\n        'Inside oven, microwave, and dishwasher',\n        'Under/behind all appliances (if moveable)',\n        'Light fixtures and ceiling'\n      ],\n      'Bathrooms (Complete)': [\n        'All basic bathroom tasks',\n        'Inside all cabinets and drawers',\n        'Behind toilet',\n        'Shower head and faucet aerators - descale',\n        'Exhaust fan covers',\n        'Light fixtures and ceiling'\n      ],\n      'All Bedrooms & Living Areas': [\n        'Inside all closets - vacuum and wipe surfaces',\n        'Inside all drawers',\n        'All baseboards',\n        'All window sills and tracks',\n        'All interior windows',\n        'All light fixtures',\n        'Ceiling fans',\n        'All door frames and doors',\n        'Light switches and outlets'\n      ],\n      'Throughout Entire Property': [\n        'All baseboards wiped down',\n        'All window tracks vacuumed and wiped',\n        'All interior windows cleaned',\n        'All ceiling fans and light fixtures',\n        'All vents dusted',\n        'All doors and door frames',\n        'Walls spot-cleaned or wiped as needed',\n        'Final walkthrough to ensure everything is spotless'\n      ]\n    }\n  },\n  airbnb: {\n    title: 'Airbnb Turnover Cleaning',\n    subtitle: 'Quick turnovers between guests - typically 2-3 hours',\n    icon: 'üè°',\n    color: 'pink',\n    duties: {\n      'Cleaning Tasks': [\n        'All basic cleaning tasks (kitchen, bathrooms, bedrooms, living areas)',\n        'Change all bed linens',\n        'Replace all towels',\n        'Check under beds and furniture for items',\n        'Empty all trash bins',\n        'Quick spot-check for damage or issues'\n      ],\n      'Restocking Checklist': [\n        'Toilet paper in all bathrooms (at least 2 rolls per bathroom)',\n        'Paper towels in kitchen',\n        'Hand soap in all bathrooms and kitchen',\n        'Fresh towels (2 per guest)',\n        'Fresh linens on all beds',\n        'Coffee pods and filters (if provided)',\n        'Dishwasher pods or dish soap',\n        'Laundry detergent (if washer provided)',\n        'Trash bags',\n        'Check and refill any other amenities'\n      ],\n      'Final Touches': [\n        'Turn on all lights',\n        'Set thermostat to appropriate temperature',\n        'Open curtains/blinds',\n        'Arrange pillows and decor',\n        'Place welcome materials if provided',\n        'Take photos of completed space (for host records)',\n        'Report any damage or maintenance needs to host'\n      ]\n    }\n  }\n};\n\nexport default function RecommendedDuties() {\n  const [activeTab, setActiveTab] = useState('basic');\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 bg-gradient-to-br from-puretask-blue to-cyan-600 rounded-2xl flex items-center justify-center shadow-lg\">\n              <CheckCircle className=\"w-7 h-7 text-white\" />\n            </div>\n            <div className=\"flex-1\">\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">Recommended Cleaning Duties</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">What our clients typically expect for each service type</p>\n            </div>\n          </div>\n\n          <Alert className=\"border-amber-200 bg-amber-50 rounded-2xl\">\n            <Info className=\"w-5 h-5 text-amber-600\" />\n            <AlertDescription className=\"text-amber-900 font-verdana\">\n              <strong>Important:</strong> As an independent contractor, you are NOT required to follow this list exactly. These are simply guidelines based on what our platform's clients have come to expect. You have the freedom to customize your services, discuss specific needs with clients, and work in the way that best suits your professional approach. Always communicate clearly with your client about what will be included in each booking.\n            </AlertDescription>\n          </Alert>\n        </motion.div>\n\n        {/* Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-lg p-2 grid grid-cols-2 lg:grid-cols-4 gap-2 rounded-2xl\">\n            <TabsTrigger\n              value=\"basic\"\n              className=\"rounded-full font-fredoka data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-600 data-[state=active]:text-white\"\n            >\n              <HomeIcon className=\"w-4 h-4 mr-2\" />\n              Basic Clean\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"deep\"\n              className=\"rounded-full font-fredoka data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-pink-600 data-[state=active]:text-white\"\n            >\n              <Sparkles className=\"w-4 h-4 mr-2\" />\n              Deep Clean\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"moveout\"\n              className=\"rounded-full font-fredoka data-[state=active]:bg-gradient-to-r data-[state=active]:from-emerald-500 data-[state=active]:to-green-600 data-[state=active]:text-white\"\n            >\n              <Key className=\"w-4 h-4 mr-2\" />\n              Move-Out\n            </TabsTrigger>\n            <TabsTrigger\n              value=\"airbnb\"\n              className=\"rounded-full font-fredoka data-[state=active]:bg-gradient-to-r data-[state=active]:from-pink-500 data-[state=active]:to-rose-600 data-[state=active]:text-white\"\n            >\n              <Calendar className=\"w-4 h-4 mr-2\" />\n              Airbnb\n            </TabsTrigger>\n          </TabsList>\n\n          {Object.entries(CLEANING_DUTIES).map(([key, service]) => (\n            <TabsContent key={key} value={key} className=\"space-y-6\">\n              <Card className={`border-0 shadow-xl rounded-2xl bg-gradient-to-r from-${service.color}-50 to-${service.color}-100`}>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-3\">\n                    <span className=\"text-4xl\">{service.icon}</span>\n                    <div>\n                      <h2 className=\"text-2xl font-fredoka font-bold text-graphite\">{service.title}</h2>\n                      <p className=\"text-sm text-gray-600 font-verdana mt-1\">{service.subtitle}</p>\n                    </div>\n                  </CardTitle>\n                </CardHeader>\n                {service.description && (\n                  <CardContent className=\"pt-0\">\n                    <Alert className=\"border-emerald-200 bg-emerald-50 rounded-2xl\">\n                      <AlertDescription className=\"text-emerald-900 font-verdana\">\n                        <strong>Note:</strong> {service.description}\n                      </AlertDescription>\n                    </Alert>\n                  </CardContent>\n                )}\n              </Card>\n\n              <div className=\"grid lg:grid-cols-2 gap-6\">\n                {Object.entries(service.duties).map(([room, tasks]) => (\n                  <motion.div\n                    key={room}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                  >\n                    <Card className=\"border-0 shadow-lg rounded-2xl h-full\">\n                      <CardHeader className={`bg-gradient-to-r from-${service.color}-50 to-white`}>\n                        <CardTitle className=\"text-lg font-fredoka text-graphite\">{room}</CardTitle>\n                      </CardHeader>\n                      <CardContent className=\"p-6\">\n                        <ul className=\"space-y-3\">\n                          {tasks.map((task, index) => (\n                            <li key={index} className=\"flex items-start gap-3\">\n                              <CheckCircle className={`w-5 h-5 text-${service.color}-500 flex-shrink-0 mt-0.5`} />\n                              <span className=\"text-gray-700 font-verdana text-sm\">{task}</span>\n                            </li>\n                          ))}\n                        </ul>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                ))}\n              </div>\n            </TabsContent>\n          ))}\n        </Tabs>\n\n        {/* Pro Tips */}\n        <Card className=\"mt-12 border-0 shadow-xl rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-indigo-50 to-purple-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Sparkles className=\"w-6 h-6 text-indigo-600\" />\n              <span className=\"font-fredoka\">Professional Tips</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <div>\n                <h3 className=\"font-fredoka font-bold text-graphite mb-3\">Before You Start</h3>\n                <ul className=\"space-y-2 text-sm text-gray-700 font-verdana\">\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-puretask-blue\">‚Ä¢</span>\n                    <span>Review the specific tasks requested by the client</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-puretask-blue\">‚Ä¢</span>\n                    <span>Check for any allergies or product preferences</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-puretask-blue\">‚Ä¢</span>\n                    <span>Take \"before\" photos as you begin each room</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-puretask-blue\">‚Ä¢</span>\n                    <span>GPS check-in when you arrive</span>\n                  </li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-fredoka font-bold text-graphite mb-3\">After Completion</h3>\n                <ul className=\"space-y-2 text-sm text-gray-700 font-verdana\">\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-fresh-mint\">‚Ä¢</span>\n                    <span>Take \"after\" photos showing your work</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-fresh-mint\">‚Ä¢</span>\n                    <span>GPS check-out when you leave</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-fresh-mint\">‚Ä¢</span>\n                    <span>Send a quick message to the client confirming completion</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"text-fresh-mint\">‚Ä¢</span>\n                    <span>Note any areas that need special attention or couldn't be completed</span>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\RecurringBookings.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Clock' is defined but never used.","line":11,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":18,"fix":{"range":[498,505],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Clock"},"fix":{"range":[497,504],"text":""},"desc":"Remove unused variable 'Clock'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertCircle' is defined but never used.","line":12,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":34,"fix":{"range":[574,587],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertCircle"},"fix":{"range":[573,586],"text":""},"desc":"Remove unused variable 'AlertCircle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":14,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":33,"fix":{"range":[654,671],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[654,671],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'addDays' is defined but never used.","line":15,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":25,"fix":{"range":[712,721],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"addDays"},"fix":{"range":[711,720],"text":""},"desc":"Remove unused variable 'addDays'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Select' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":16,"fix":{"range":[947,955],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Select"},"fix":{"range":[948,955],"text":""},"desc":"Remove unused variable 'Select'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectContent' is defined but never used.","line":24,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":31,"fix":{"range":[955,970],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectContent"},"fix":{"range":[954,969],"text":""},"desc":"Remove unused variable 'SelectContent'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectItem' is defined but never used.","line":24,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":43,"fix":{"range":[970,982],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectItem"},"fix":{"range":[969,981],"text":""},"desc":"Remove unused variable 'SelectItem'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectTrigger' is defined but never used.","line":24,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":58,"fix":{"range":[982,997],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectTrigger"},"fix":{"range":[981,996],"text":""},"desc":"Remove unused variable 'SelectTrigger'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'SelectValue' is defined but never used.","line":24,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":71,"fix":{"range":[996,1009],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"SelectValue"},"fix":{"range":[996,1009],"text":""},"desc":"Remove unused variable 'SelectValue'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Textarea' is defined but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":18,"fix":{"range":[1043,1096],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Textarea"},"fix":{"range":[1043,1095],"text":""},"desc":"Remove unused variable 'Textarea'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'creditsToUSD' is defined but never used.","line":27,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":22,"fix":{"range":[1161,1232],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"creditsToUSD"},"fix":{"range":[1161,1231],"text":""},"desc":"Remove unused variable 'creditsToUSD'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":32,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":14,"suggestions":[{"messageId":"removeVar","data":{"varName":"user"},"fix":{"range":[1354,1358],"text":""},"desc":"Remove unused variable 'user'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'selectedBooking' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"selectedBooking"},"fix":{"range":[1627,1642],"text":""},"desc":"Remove unused variable 'selectedBooking'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setSelectedBooking' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":37,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSelectedBooking"},"fix":{"range":[1642,1662],"text":""},"desc":"Remove unused variable 'setSelectedBooking'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'cancelledBookings' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":156,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":156,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"cancelledBookings"},"fix":{"range":[5075,5163],"text":""},"desc":"Remove unused variable 'cancelledBookings'."}]}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":11,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Calendar, Clock, MapPin, DollarSign, Plus, Pause, Play, Trash2,\n  Loader2, RefreshCw, AlertCircle, CheckCircle, Sparkles, User\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { format, addDays, addWeeks, addMonths, parseISO } from 'date-fns';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Textarea } from '@/components/ui/textarea';\nimport { convertTo12Hour } from '../components/utils/timeUtils';\nimport { creditsToUSD } from '../components/credits/CreditCalculator';\nimport { toast } from 'sonner';\n\nexport default function RecurringBookings() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [userType, setUserType] = useState(null);\n  const [recurringBookings, setRecurringBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [showCreateDialog, setShowCreateDialog] = useState(false);\n  const [selectedBooking, setSelectedBooking] = useState(null);\n  const [pausingBooking, setPausingBooking] = useState(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      const type = currentUser.user_type || 'client';\n      setUserType(type);\n\n      let bookings = [];\n      if (type === 'client') {\n        bookings = await base44.entities.RecurringBooking.filter(\n          { client_email: currentUser.email },\n          '-created_date'\n        );\n      } else if (type === 'cleaner') {\n        bookings = await base44.entities.RecurringBooking.filter(\n          { cleaner_email: currentUser.email },\n          '-created_date'\n        );\n      }\n\n      setRecurringBookings(bookings);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading recurring bookings:', showToast: false });\n      toast.error('Failed to load recurring bookings');\n    }\n    setLoading(false);\n  };\n\n  const handlePauseToggle = async (booking) => {\n    try {\n      const isPaused = !!booking.pause_until;\n      \n      if (isPaused) {\n        // Resume\n        await base44.entities.RecurringBooking.update(booking.id, {\n          pause_until: null,\n          is_active: true\n        });\n        toast.success('Subscription resumed');\n      } else {\n        // Show pause dialog\n        setPausingBooking(booking);\n        return;\n      }\n      \n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error toggling pause:', showToast: false });\n      toast.error('Failed to update subscription');\n    }\n  };\n\n  const confirmPause = async (pauseUntil) => {\n    try {\n      await base44.entities.RecurringBooking.update(pausingBooking.id, {\n        pause_until: pauseUntil,\n        is_active: false\n      });\n      toast.success('Subscription paused');\n      setPausingBooking(null);\n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error pausing:', showToast: false });\n      toast.error('Failed to pause subscription');\n    }\n  };\n\n  const handleCancel = async (bookingId) => {\n    if (!confirm('Are you sure you want to cancel this recurring booking? This cannot be undone.')) {\n      return;\n    }\n\n    try {\n      await base44.entities.RecurringBooking.update(bookingId, {\n        is_active: false\n      });\n      toast.success('Recurring booking cancelled');\n      loadData();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error cancelling:', showToast: false });\n      toast.error('Failed to cancel booking');\n    }\n  };\n\n  const getNextOccurrences = (booking, count = 3) => {\n    if (!booking.next_booking_date) return [];\n    \n    const dates = [];\n    let current = parseISO(booking.next_booking_date);\n    \n    for (let i = 0; i < count; i++) {\n      dates.push(current);\n      \n      if (booking.frequency === 'weekly') {\n        current = addWeeks(current, 1);\n      } else if (booking.frequency === 'biweekly') {\n        current = addWeeks(current, 2);\n      } else if (booking.frequency === 'monthly') {\n        current = addMonths(current, 1);\n      }\n    }\n    \n    return dates;\n  };\n\n  const activeBookings = recurringBookings.filter(b => b.is_active && !b.pause_until);\n  const pausedBookings = recurringBookings.filter(b => b.pause_until);\n  const cancelledBookings = recurringBookings.filter(b => !b.is_active && !b.pause_until);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n              {userType === 'client' ? 'My Recurring Cleanings' : 'Recurring Clients'}\n            </h1>\n            <p className=\"text-lg text-gray-600 font-verdana\">\n              {userType === 'client' \n                ? 'Set up automatic weekly, bi-weekly, or monthly cleanings'\n                : 'Manage your recurring client relationships'}\n            </p>\n          </div>\n          \n          {userType === 'client' && (\n            <Button\n              onClick={() => setShowCreateDialog(true)}\n              className=\"brand-gradient text-white rounded-full font-fredoka font-semibold shadow-lg\"\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              New Recurring Booking\n            </Button>\n          )}\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-white rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <CheckCircle className=\"w-10 h-10 text-fresh-mint mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{activeBookings.length}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Active Subscriptions</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-white rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Pause className=\"w-10 h-10 text-amber-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{pausedBookings.length}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Paused</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-white rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Sparkles className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">\n                {activeBookings.reduce((sum, b) => sum + (b.total_price * 10 || 0), 0)}\n              </p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Monthly Credits</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Active Recurring Bookings */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n            <CheckCircle className=\"w-6 h-6 text-fresh-mint\" />\n            Active Subscriptions\n          </h2>\n\n          {activeBookings.length > 0 ? (\n            <div className=\"grid gap-6\">\n              {activeBookings.map((booking, idx) => {\n                const nextDates = getNextOccurrences(booking);\n                \n                return (\n                  <motion.div\n                    key={booking.id}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: idx * 0.1 }}\n                  >\n                    <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all rounded-2xl\">\n                      <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-t-2xl\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <Calendar className=\"w-5 h-5 text-fresh-mint\" />\n                              <CardTitle className=\"font-fredoka text-graphite\">\n                                {booking.frequency === 'weekly' ? 'Weekly' : \n                                 booking.frequency === 'biweekly' ? 'Bi-Weekly' : 'Monthly'} Cleaning\n                              </CardTitle>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <Badge className=\"bg-fresh-mint text-white rounded-full font-fredoka\">\n                                {booking.day_of_week}s\n                              </Badge>\n                              <Badge className=\"bg-blue-100 text-puretask-blue rounded-full font-fredoka\">\n                                {convertTo12Hour(booking.start_time)}\n                              </Badge>\n                              <Badge className=\"bg-purple-100 text-purple-700 rounded-full font-fredoka\">\n                                {booking.hours} hours\n                              </Badge>\n                            </div>\n                          </div>\n                          \n                          <div className=\"text-right\">\n                            <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">\n                              {Math.round(booking.total_price * 10)}\n                            </p>\n                            <p className=\"text-sm text-gray-600 font-verdana\">credits/visit</p>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      \n                      <CardContent className=\"p-6\">\n                        <div className=\"grid md:grid-cols-2 gap-6 mb-6\">\n                          <div>\n                            <p className=\"text-sm text-gray-600 font-verdana mb-2\">\n                              <MapPin className=\"w-4 h-4 inline mr-1 text-puretask-blue\" />\n                              Service Address\n                            </p>\n                            <p className=\"font-fredoka font-semibold text-graphite\">{booking.address}</p>\n                          </div>\n                          \n                          {userType === 'client' && booking.cleaner_email && (\n                            <div>\n                              <p className=\"text-sm text-gray-600 font-verdana mb-2\">\n                                <User className=\"w-4 h-4 inline mr-1 text-puretask-blue\" />\n                                Your Cleaner\n                              </p>\n                              <p className=\"font-fredoka font-semibold text-graphite\">{booking.cleaner_email}</p>\n                            </div>\n                          )}\n                          \n                          {userType === 'cleaner' && booking.client_email && (\n                            <div>\n                              <p className=\"text-sm text-gray-600 font-verdana mb-2\">\n                                <User className=\"w-4 h-4 inline mr-1 text-puretask-blue\" />\n                                Client\n                              </p>\n                              <p className=\"font-fredoka font-semibold text-graphite\">{booking.client_email}</p>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Next Occurrences */}\n                        <div className=\"mb-6 p-4 bg-blue-50 rounded-2xl border border-blue-200\">\n                          <p className=\"text-sm font-fredoka font-semibold text-graphite mb-3\">\n                            Next Scheduled Cleanings:\n                          </p>\n                          <div className=\"space-y-2\">\n                            {nextDates.map((date, i) => (\n                              <div key={i} className=\"flex items-center gap-2 text-sm font-verdana text-gray-700\">\n                                <Calendar className=\"w-4 h-4 text-puretask-blue\" />\n                                <span>{format(date, 'EEEE, MMMM d, yyyy')}</span>\n                                {i === 0 && (\n                                  <Badge className=\"bg-puretask-blue text-white rounded-full font-fredoka text-xs\">\n                                    Next\n                                  </Badge>\n                                )}\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n\n                        {/* Actions */}\n                        <div className=\"flex gap-3\">\n                          <Button\n                            onClick={() => handlePauseToggle(booking)}\n                            variant=\"outline\"\n                            className=\"flex-1 rounded-full font-fredoka border-2 border-amber-500 text-amber-700 hover:bg-amber-50\"\n                          >\n                            <Pause className=\"w-4 h-4 mr-2\" />\n                            Pause\n                          </Button>\n                          \n                          {userType === 'client' && (\n                            <Button\n                              onClick={() => navigate(createPageUrl(`BookingFlow?cleaner=${booking.cleaner_email}`))}\n                              variant=\"outline\"\n                              className=\"flex-1 rounded-full font-fredoka border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50\"\n                            >\n                              <RefreshCw className=\"w-4 h-4 mr-2\" />\n                              Book One-Time\n                            </Button>\n                          )}\n                          \n                          <Button\n                            onClick={() => handleCancel(booking.id)}\n                            variant=\"destructive\"\n                            className=\"rounded-full font-fredoka\"\n                          >\n                            <Trash2 className=\"w-4 h-4 mr-2\" />\n                            Cancel\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                );\n              })}\n            </div>\n          ) : (\n            <Card className=\"border-0 shadow-lg rounded-2xl\">\n              <CardContent className=\"p-12 text-center\">\n                <Calendar className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">No Active Subscriptions</h3>\n                <p className=\"text-gray-600 font-verdana mb-6\">\n                  {userType === 'client'\n                    ? 'Save time and money with recurring cleanings'\n                    : 'Your recurring clients will appear here'}\n                </p>\n                {userType === 'client' && (\n                  <Button\n                    onClick={() => setShowCreateDialog(true)}\n                    className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                  >\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Create Recurring Booking\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        {/* Paused Bookings */}\n        {pausedBookings.length > 0 && (\n          <div className=\"mb-8\">\n            <h2 className=\"text-2xl font-fredoka font-bold text-graphite mb-4 flex items-center gap-2\">\n              <Pause className=\"w-6 h-6 text-amber-600\" />\n              Paused Subscriptions\n            </h2>\n\n            <div className=\"space-y-4\">\n              {pausedBookings.map((booking, idx) => (\n                <motion.div\n                  key={booking.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"border-2 border-amber-300 bg-amber-50 rounded-2xl\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"font-fredoka font-bold text-graphite text-lg mb-1\">\n                            {booking.frequency === 'weekly' ? 'Weekly' : \n                             booking.frequency === 'biweekly' ? 'Bi-Weekly' : 'Monthly'} Cleaning (Paused)\n                          </p>\n                          <p className=\"text-sm text-gray-600 font-verdana\">\n                            Paused until: {format(parseISO(booking.pause_until), 'MMMM d, yyyy')}\n                          </p>\n                          <p className=\"text-sm text-gray-600 font-verdana mt-1\">\n                            {booking.address}\n                          </p>\n                        </div>\n                        \n                        <div className=\"flex gap-3\">\n                          <Button\n                            onClick={() => handlePauseToggle(booking)}\n                            className=\"bg-fresh-mint text-white rounded-full font-fredoka\"\n                          >\n                            <Play className=\"w-4 h-4 mr-2\" />\n                            Resume\n                          </Button>\n                          <Button\n                            onClick={() => handleCancel(booking.id)}\n                            variant=\"destructive\"\n                            className=\"rounded-full font-fredoka\"\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Benefits Section (Client Only) */}\n        {userType === 'client' && activeBookings.length === 0 && (\n          <Card className=\"border-0 shadow-xl bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka text-graphite\">Benefits of Recurring Cleanings</CardTitle>\n            </CardHeader>\n            <CardContent className=\"p-6\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                {[\n                  { icon: DollarSign, title: 'Save 10%', desc: 'Automatic discount on all recurring visits' },\n                  { icon: Calendar, title: 'Never Forget', desc: 'Automatic scheduling on your preferred day' },\n                  { icon: User, title: 'Same Cleaner', desc: 'Build a relationship with your trusted pro' },\n                  { icon: Sparkles, title: 'Priority Booking', desc: 'Your slot is reserved every week/month' }\n                ].map((benefit, i) => (\n                  <div key={i} className=\"flex items-start gap-3 p-4 bg-white rounded-2xl\">\n                    <div className=\"w-10 h-10 brand-gradient rounded-xl flex items-center justify-center flex-shrink-0\">\n                      <benefit.icon className=\"w-5 h-5 text-white\" />\n                    </div>\n                    <div>\n                      <p className=\"font-fredoka font-bold text-graphite mb-1\">{benefit.title}</p>\n                      <p className=\"text-sm text-gray-600 font-verdana\">{benefit.desc}</p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Pause Dialog */}\n      <Dialog open={!!pausingBooking} onOpenChange={() => setPausingBooking(null)}>\n        <DialogContent className=\"rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"font-fredoka text-graphite\">Pause Subscription</DialogTitle>\n            <DialogDescription className=\"font-verdana\">\n              Your subscription will be paused until the date you select\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-fredoka font-medium mb-2 block text-graphite\">\n                Resume Date\n              </label>\n              <Input\n                type=\"date\"\n                min={new Date().toISOString().split('T')[0]}\n                onChange={(e) => {\n                  if (e.target.value) {\n                    confirmPause(e.target.value);\n                  }\n                }}\n                className=\"font-verdana\"\n              />\n            </div>\n\n            <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n              <AlertDescription className=\"text-sm text-blue-900 font-verdana\">\n                üí° Your cleaner will be notified. Automatic scheduling will resume on your selected date.\n              </AlertDescription>\n            </Alert>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Create Dialog (Client Only) */}\n      {userType === 'client' && (\n        <Dialog open={showCreateDialog} onOpenChange={setShowCreateDialog}>\n          <DialogContent className=\"max-w-2xl rounded-2xl\">\n            <DialogHeader>\n              <DialogTitle className=\"font-fredoka text-graphite\">Create Recurring Booking</DialogTitle>\n              <DialogDescription className=\"font-verdana\">\n                Set up automatic cleanings with your favorite cleaner\n              </DialogDescription>\n            </DialogHeader>\n\n            <Alert className=\"border-blue-200 bg-blue-50 rounded-2xl\">\n              <AlertDescription className=\"text-sm text-blue-900 font-verdana\">\n                üí° To create a recurring booking, first complete a one-time booking with your preferred cleaner. \n                You can then convert it to recurring from your booking history.\n              </AlertDescription>\n            </Alert>\n\n            <Button\n              onClick={() => {\n                setShowCreateDialog(false);\n                navigate(createPageUrl('BrowseCleaners'));\n              }}\n              className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n            >\n              Browse Cleaners\n            </Button>\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ReferralProgram.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15,"fix":{"range":[468,475],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[469,475],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":10,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":33,"fix":{"range":[474,492],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[474,492],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'TrendingUp' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":13,"fix":{"range":[602,616],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"TrendingUp"},"fix":{"range":[601,615],"text":""},"desc":"Remove unused variable 'TrendingUp'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AnimatePresence' is defined but never used.","line":15,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":33,"fix":{"range":[699,716],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AnimatePresence"},"fix":{"range":[699,716],"text":""},"desc":"Remove unused variable 'AnimatePresence'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport {\n  Users, Gift, DollarSign, Copy, Check, Share2, Mail, MessageSquare,\n  TrendingUp, Sparkles, Star, Loader2, CheckCircle, Clock\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { toast } from 'sonner';\n\nexport default function ReferralProgram() {\n  const navigate = useNavigate();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [referrals, setReferrals] = useState([]);\n  const [copied, setCopied] = useState(false);\n  const [stats, setStats] = useState({\n    totalReferrals: 0,\n    pendingReferrals: 0,\n    completedReferrals: 0,\n    totalEarned: 0\n  });\n\n  const referralCode = user?.email ? btoa(user.email).substring(0, 8).toUpperCase() : 'LOADING';\n  const referralLink = `${window.location.origin}${createPageUrl('RoleSelection')}?ref=${referralCode}`;\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      if (!currentUser) {\n        navigate(createPageUrl('Home'));\n        return;\n      }\n      setUser(currentUser);\n\n      // Load referrals\n      const myReferrals = await base44.entities.ClientReferral.filter({\n        referrer_email: currentUser.email\n      }, '-created_date');\n      setReferrals(myReferrals);\n\n      // Calculate stats\n      const pending = myReferrals.filter(r => r.status === 'pending').length;\n      const completed = myReferrals.filter(r => r.status === 'rewarded').length;\n      const totalEarned = myReferrals\n        .filter(r => r.status === 'rewarded')\n        .reduce((sum, r) => sum + (r.reward_amount_credits || 0), 0);\n\n      setStats({\n        totalReferrals: myReferrals.length,\n        pendingReferrals: pending,\n        completedReferrals: completed,\n        totalEarned\n      });\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading referrals:', showToast: false });\n    }\n    setLoading(false);\n  };\n\n  const copyToClipboard = () => {\n    navigator.clipboard.writeText(referralLink);\n    setCopied(true);\n    toast.success('Referral link copied!');\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  const shareViaEmail = () => {\n    const subject = 'Join PureTask - Get 500 credits free!';\n    const body = `Hey! I've been using PureTask for all my cleaning needs and thought you'd love it too.\\n\\nUse my referral code ${referralCode} when you sign up and we both get 500 credits (worth $50)!\\n\\n${referralLink}\\n\\nPureTask connects you with verified, reliable cleaners with GPS tracking, photo proof, and payment protection.`;\n    window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n  };\n\n  const shareViaSMS = () => {\n    const message = `Check out PureTask! Use my code ${referralCode} when signing up and we both get 500 credits ($50 value). ${referralLink}`;\n    window.location.href = `sms:?body=${encodeURIComponent(message)}`;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n          >\n            <Gift className=\"w-16 h-16 text-purple-600 mx-auto mb-4\" />\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite mb-2\">\n              Refer & Earn\n            </h1>\n            <p className=\"text-xl text-gray-600 font-verdana\">\n              Give 500 credits, Get 500 credits\n            </p>\n          </motion.div>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Users className=\"w-10 h-10 text-purple-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalReferrals}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Total Referrals</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <Clock className=\"w-10 h-10 text-amber-600 mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.pendingReferrals}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Pending</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <CheckCircle className=\"w-10 h-10 text-fresh-mint mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.completedReferrals}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Completed</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl\">\n            <CardContent className=\"p-6 text-center\">\n              <DollarSign className=\"w-10 h-10 text-puretask-blue mx-auto mb-3\" />\n              <p className=\"text-3xl font-fredoka font-bold text-graphite mb-1\">{stats.totalEarned}</p>\n              <p className=\"text-sm text-gray-600 font-verdana\">Credits Earned</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Referral Link Card */}\n        <Card className=\"mb-8 border-2 border-purple-300 shadow-xl rounded-2xl bg-gradient-to-br from-purple-50 to-indigo-50\">\n          <CardHeader className=\"bg-gradient-to-r from-purple-100 to-indigo-100 rounded-t-2xl\">\n            <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n              <Share2 className=\"w-6 h-6 text-purple-600\" />\n              Your Referral Link\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-4\">\n            <div>\n              <p className=\"text-sm font-fredoka font-medium text-graphite mb-2\">Your Referral Code</p>\n              <div className=\"flex items-center gap-3\">\n                <div className=\"flex-1 p-4 bg-white rounded-2xl border-2 border-purple-300 font-mono text-2xl font-bold text-center text-purple-600\">\n                  {referralCode}\n                </div>\n                <Button\n                  onClick={copyToClipboard}\n                  className=\"bg-purple-600 text-white rounded-full font-fredoka h-14 px-6\"\n                >\n                  {copied ? (\n                    <>\n                      <Check className=\"w-4 h-4 mr-2\" />\n                      Copied!\n                    </>\n                  ) : (\n                    <>\n                      <Copy className=\"w-4 h-4 mr-2\" />\n                      Copy Code\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n\n            <div>\n              <p className=\"text-sm font-fredoka font-medium text-graphite mb-2\">Full Referral Link</p>\n              <div className=\"flex items-center gap-3\">\n                <Input\n                  value={referralLink}\n                  readOnly\n                  className=\"flex-1 font-verdana text-sm\"\n                />\n                <Button\n                  onClick={copyToClipboard}\n                  variant=\"outline\"\n                  className=\"rounded-full font-fredoka border-2 border-purple-500 text-purple-700\"\n                >\n                  {copied ? <Check className=\"w-4 h-4\" /> : <Copy className=\"w-4 h-4\" />}\n                </Button>\n              </div>\n            </div>\n\n            <div className=\"grid md:grid-cols-2 gap-3 pt-4\">\n              <Button\n                onClick={shareViaEmail}\n                variant=\"outline\"\n                className=\"rounded-full font-fredoka border-2\"\n              >\n                <Mail className=\"w-4 h-4 mr-2\" />\n                Share via Email\n              </Button>\n              <Button\n                onClick={shareViaSMS}\n                variant=\"outline\"\n                className=\"rounded-full font-fredoka border-2\"\n              >\n                <MessageSquare className=\"w-4 h-4 mr-2\" />\n                Share via SMS\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* How It Works */}\n        <Card className=\"mb-8 border-0 shadow-lg rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n            <CardTitle className=\"font-fredoka text-graphite\">How It Works</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              {[\n                {\n                  step: 1,\n                  icon: Share2,\n                  title: 'Share Your Link',\n                  description: 'Send your unique referral code to friends, family, or colleagues',\n                  color: 'text-purple-600',\n                  bg: 'bg-purple-50'\n                },\n                {\n                  step: 2,\n                  icon: Users,\n                  title: 'They Sign Up',\n                  description: 'They create an account and complete their first booking using your code',\n                  color: 'text-blue-600',\n                  bg: 'bg-blue-50'\n                },\n                {\n                  step: 3,\n                  icon: Gift,\n                  title: 'You Both Earn',\n                  description: 'You both receive 500 credits (worth $50) instantly!',\n                  color: 'text-green-600',\n                  bg: 'bg-green-50'\n                }\n              ].map((item, i) => (\n                <motion.div\n                  key={i}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: i * 0.1 }}\n                  className={`${item.bg} rounded-2xl p-6`}\n                >\n                  <div className={`w-12 h-12 rounded-full flex items-center justify-center mb-4 ${item.bg} border-2 ${item.color.replace('text-', 'border-')}`}>\n                    <item.icon className={`w-6 h-6 ${item.color}`} />\n                  </div>\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Badge className={`${item.color.replace('text-', 'bg-')} text-white rounded-full font-fredoka`}>\n                      Step {item.step}\n                    </Badge>\n                  </div>\n                  <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-2\">{item.title}</h3>\n                  <p className=\"text-sm text-gray-600 font-verdana\">{item.description}</p>\n                </motion.div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Referral History */}\n        <Card className=\"border-0 shadow-lg rounded-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50 rounded-t-2xl\">\n            <CardTitle className=\"font-fredoka text-graphite\">Your Referrals</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            {referrals.length > 0 ? (\n              <div className=\"space-y-3\">\n                {referrals.map((referral, idx) => (\n                  <motion.div\n                    key={referral.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: idx * 0.05 }}\n                    className=\"flex items-center justify-between p-4 bg-soft-cloud rounded-2xl\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 brand-gradient rounded-full flex items-center justify-center text-white font-fredoka font-bold\">\n                        {referral.referee_email[0].toUpperCase()}\n                      </div>\n                      <div>\n                        <p className=\"font-fredoka font-semibold text-graphite\">{referral.referee_email}</p>\n                        <p className=\"text-sm text-gray-600 font-verdana capitalize\">\n                          {referral.referee_type || 'client'}\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"text-right\">\n                      {referral.status === 'rewarded' ? (\n                        <>\n                          <Badge className=\"bg-fresh-mint text-white rounded-full font-fredoka mb-1\">\n                            <CheckCircle className=\"w-3 h-3 mr-1\" />\n                            Rewarded\n                          </Badge>\n                          <p className=\"text-sm font-fredoka font-bold text-fresh-mint\">\n                            +{referral.reward_amount_credits || 500} credits\n                          </p>\n                        </>\n                      ) : referral.status === 'first_booking_complete' ? (\n                        <Badge className=\"bg-amber-500 text-white rounded-full font-fredoka\">\n                          Processing\n                        </Badge>\n                      ) : (\n                        <Badge className=\"bg-gray-300 text-gray-700 rounded-full font-fredoka\">\n                          Pending\n                        </Badge>\n                      )}\n                    </div>\n                  </motion.div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-12\">\n                <Users className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                <h3 className=\"text-xl font-fredoka font-bold text-graphite mb-2\">\n                  No referrals yet\n                </h3>\n                <p className=\"text-gray-600 font-verdana mb-6\">\n                  Share your referral link to start earning rewards!\n                </p>\n                <Button\n                  onClick={copyToClipboard}\n                  className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                >\n                  <Copy className=\"w-4 h-4 mr-2\" />\n                  Copy Referral Link\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Bonus Tiers */}\n        <Card className=\"mt-8 border-0 shadow-xl bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl\">\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-graphite flex items-center gap-2\">\n              <Sparkles className=\"w-6 h-6 text-amber-600\" />\n              Bonus Tiers\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              {[\n                { referrals: 5, bonus: 1000, reached: stats.completedReferrals >= 5 },\n                { referrals: 10, bonus: 2500, reached: stats.completedReferrals >= 10 },\n                { referrals: 25, bonus: 7500, reached: stats.completedReferrals >= 25 }\n              ].map((tier, i) => (\n                <div\n                  key={i}\n                  className={`p-4 rounded-2xl border-2 ${\n                    tier.reached\n                      ? 'bg-green-100 border-fresh-mint'\n                      : 'bg-white border-gray-200'\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <p className=\"font-fredoka font-bold text-graphite\">{tier.referrals} Referrals</p>\n                    {tier.reached && (\n                      <Star className=\"w-5 h-5 text-amber-500\" fill=\"currentColor\" />\n                    )}\n                  </div>\n                  <p className=\"text-2xl font-fredoka font-bold text-purple-600 mb-1\">\n                    +{tier.bonus}\n                  </p>\n                  <p className=\"text-xs text-gray-600 font-verdana\">bonus credits</p>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ReliabilityScoreExplained.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\ResendConfirmation.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Input' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[298,345],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Input"},"fix":{"range":[298,344],"text":""},"desc":"Remove unused variable 'Input'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Label' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[345,392],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Label"},"fix":{"range":[345,391],"text":""},"desc":"Remove unused variable 'Label'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'email' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"email"},"fix":{"range":[584,589],"text":""},"desc":"Remove unused variable 'email'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'setEmail' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"setEmail"},"fix":{"range":[589,599],"text":""},"desc":"Remove unused variable 'setEmail'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Mail, ArrowLeft, CheckCircle, Loader2 } from 'lucide-react';\n\nexport default function ResendConfirmation() {\n  const [email, setEmail] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [error, setError] = useState('');\n\n  const handleResend = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setMessage('');\n    setError('');\n\n    try {\n      // Use Base44's auth system to resend confirmation\n      // This will trigger Base44 to send a new confirmation email\n      await base44.auth.redirectToLogin(window.location.origin + createPageUrl('Home'));\n    } catch (err) {\n      console.error('Error resending confirmation:', err);\n      setError('Unable to process your request. Please try logging in again or contact support.');\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-cyan-50 flex items-center justify-center p-6\">\n      <div className=\"max-w-md w-full\">\n        <Link to={createPageUrl('Home')} className=\"inline-flex items-center text-emerald-600 hover:text-emerald-700 mb-6\">\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          Back to Home\n        </Link>\n\n        <Card className=\"border-0 shadow-2xl\">\n          <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <Mail className=\"w-6 h-6 text-blue-500\" />\n              Email Not Confirmed?\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6 space-y-6\">\n            <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-200\">\n              <p className=\"text-sm text-slate-700 leading-relaxed\">\n                If you closed the confirmation window or didn't receive a confirmation email, \n                you can request a new one by clicking the button below.\n              </p>\n            </div>\n\n            {message && (\n              <Alert className=\"bg-green-50 border-green-200\">\n                <CheckCircle className=\"w-4 h-4 text-green-600\" />\n                <AlertDescription className=\"text-green-800\">{message}</AlertDescription>\n              </Alert>\n            )}\n\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-slate-900 mb-3\">What to do:</h3>\n                <ol className=\"list-decimal list-inside space-y-2 text-sm text-slate-700\">\n                  <li>Click \"Continue to Login\" below</li>\n                  <li>Try to sign in with your account</li>\n                  <li>Base44 will automatically send you a new confirmation link if needed</li>\n                  <li>Check your email inbox (and spam folder)</li>\n                  <li>Click the confirmation link in the email</li>\n                </ol>\n              </div>\n\n              <Button\n                onClick={handleResend}\n                disabled={loading}\n                className=\"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white py-6 text-lg\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    <Mail className=\"w-5 h-5 mr-2\" />\n                    Continue to Login\n                  </>\n                )}\n              </Button>\n            </div>\n\n            <div className=\"border-t border-slate-200 pt-6\">\n              <h3 className=\"font-semibold text-slate-900 mb-3\">Still having issues?</h3>\n              <ul className=\"space-y-2 text-sm text-slate-700\">\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\n                  <span>Check your spam/junk folder for the confirmation email</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\n                  <span>Make sure you're checking the correct email address</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <CheckCircle className=\"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0\" />\n                  <span>Wait a few minutes - emails can sometimes be delayed</span>\n                </li>\n              </ul>\n            </div>\n\n            <div className=\"text-center\">\n              <p className=\"text-sm text-slate-600 mb-3\">Need more help?</p>\n              <Link to={createPageUrl('Support')}>\n                <Button variant=\"outline\" className=\"w-full\">\n                  Contact Support\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\RoleSelection.jsx","messages":[{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":52,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":52,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Users, Briefcase, Sparkles, Shield, Clock, Award, CheckCircle, ArrowLeft } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\n// Centralized pricing values so you have one source of truth\nconst CLIENT_PRICING = {\n  minCredits: 350,\n  maxCredits: 450,\n  creditsPerDollar: 10, // 10 credits = $1\n};\n\nconst CLEANER_EARNINGS = {\n  minDollar: 28,\n  maxDollar: 51,\n};\n\n// Reusable bullet row component\nfunction Bullet({ children }) {\n  return (\n    <li className=\"flex items-start gap-3 font-verdana text-gray-700\">\n      <CheckCircle className=\"w-5 h-5 mt-1 flex-shrink-0 text-[#28C76F]\" />\n      <span>{children}</span>\n    </li>\n  );\n}\n\nexport default function RoleSelection() {\n  const handleSignIn = async () => {\n    try {\n      // Check if user is already logged in\n      const user = await base44.auth.me();\n      if (user) {\n        // User is already logged in, redirect to appropriate dashboard\n        if (user.user_type === 'client' || user.role === 'client') {\n          window.location.href = createPageUrl('ClientDashboard');\n        } else if (user.user_type === 'cleaner' || user.role === 'cleaner') {\n          window.location.href = createPageUrl('CleanerDashboard');\n        } else if (user.role === 'admin') {\n          window.location.href = createPageUrl('AdminDashboard');\n        } else {\n          window.location.href = createPageUrl('Home');\n        }\n      } else {\n        // User is not logged in, redirect to login page\n        base44.auth.redirectToLogin();\n      }\n    } catch (error) {\n      // User is not logged in, redirect to login page\n      console.log('User not logged in, redirecting to login');\n      base44.auth.redirectToLogin();\n    }\n  };\n\n  // Derived display strings from constants\n  const clientCreditsRange = `${CLIENT_PRICING.minCredits}-${CLIENT_PRICING.maxCredits} credits/hr`;\n  const clientDollarRange = `‚âà $${CLIENT_PRICING.minCredits / CLIENT_PRICING.creditsPerDollar}-${\n    CLIENT_PRICING.maxCredits / CLIENT_PRICING.creditsPerDollar\n  }/hour`;\n\n  const cleanerEarningsRange = `$${CLEANER_EARNINGS.minDollar}-${CLEANER_EARNINGS.maxDollar}/hour`;\n\n  return (\n    <main className=\"min-h-screen flex flex-col items-center justify-center p-6 bg-[#F7F9FC]\">\n      <div className=\"max-w-6xl w-full\">\n        {/* Back Button */}\n        <Link\n          to={createPageUrl('Home')}\n          aria-label=\"Back to PureTask home\"\n          className=\"inline-flex items-center gap-2 hover:opacity-80 mb-8 font-verdana text-[#1D2533]\"\n        >\n          <ArrowLeft className=\"w-5 h-5\" />\n          <span>Back to Home</span>\n        </Link>\n\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center mb-12\"\n        >\n          <div className=\"flex items-center justify-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg bg-gradient-to-br from-[#0078FF] to-[#00D4FF]\">\n              <Sparkles className=\"w-7 h-7 text-white\" />\n            </div>\n            <h1 className=\"text-5xl font-fredoka font-bold text-[#1D2533]\">\n              Join PureTask\n            </h1>\n          </div>\n          <p className=\"text-xl text-gray-600 font-verdana\">\n            Choose how you'd like to get started\n          </p>\n        </motion.div>\n\n        {/* Role Cards */}\n        <div className=\"grid md:grid-cols-2 gap-8\">\n          {/* Client Card */}\n          <motion.div\n            initial={{ opacity: 0, x: -30 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n          >\n            <Card className=\"hover:shadow-2xl transition-all duration-300 h-full rounded-2xl border-2 border-[#0078FF] bg-gradient-to-br from-[#EFF6FF] to-white\">\n              <CardHeader className=\"text-center pb-4\">\n                <div className=\"w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg bg-gradient-to-br from-[#0078FF] to-[#00D4FF]\">\n                  <Users className=\"w-10 h-10 text-white\" />\n                </div>\n                <CardTitle className=\"text-3xl font-fredoka font-bold mb-2 text-[#1D2533]\">\n                  I Need a Cleaner\n                </CardTitle>\n                <p className=\"text-gray-600 font-verdana\">\n                  Book verified professionals for your home or business\n                </p>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <ul className=\"space-y-3\">\n                  <Bullet>Browse verified cleaners by reliability score</Bullet>\n                  <Bullet>GPS tracking & photo proof for every job</Bullet>\n                  <Bullet>Pay only after you approve the work</Bullet>\n                  <Bullet>Transparent credit-based pricing</Bullet>\n                </ul>\n\n                <div className=\"rounded-2xl p-4 bg-[#DBEAFE] border border-[#93C5FD]\">\n                  <p className=\"text-sm font-verdana mb-2 text-[#1D2533]\">\n                    <strong className=\"font-fredoka\">Average Price:</strong>\n                  </p>\n                  <p className=\"text-2xl font-fredoka font-bold text-[#0078FF]\">\n                    {clientCreditsRange}\n                  </p>\n                  <p className=\"text-xs text-gray-600 font-verdana\">\n                    {clientDollarRange}\n                  </p>\n                </div>\n\n                <Link to={createPageUrl('ClientSignup')} className=\"block\">\n                  <Button className=\"w-full text-lg py-6 rounded-full font-fredoka font-semibold shadow-lg hover:shadow-xl text-white bg-gradient-to-r from-[#0078FF] to-[#00D4FF]\">\n                    Sign Up as Client\n                  </Button>\n                </Link>\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Cleaner Card */}\n          <motion.div\n            initial={{ opacity: 0, x: 30 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.3 }}\n          >\n            <Card className=\"hover:shadow-2xl transition-all duration-300 h-full rounded-2xl border-2 border-[#28C76F] bg-gradient-to-br from-[#F0FDF4] to-white\">\n              <CardHeader className=\"text-center pb-4\">\n                <div className=\"w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg bg-[#28C76F]\">\n                  <Briefcase className=\"w-10 h-10 text-white\" />\n                </div>\n                <CardTitle className=\"text-3xl font-fredoka font-bold mb-2 text-[#1D2533]\">\n                  I'm a Cleaner\n                </CardTitle>\n                <p className=\"text-gray-600 font-verdana\">\n                  Build your business with flexible hours and fair pay\n                </p>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <ul className=\"space-y-3\">\n                  <Bullet>Earn 80‚Äì85% of every booking</Bullet>\n                  <Bullet>Set your own rates and schedule</Bullet>\n                  <Bullet>Weekly payouts + instant cash-out option</Bullet>\n                  <Bullet>Build reputation through reliability scoring</Bullet>\n                </ul>\n\n                <div className=\"rounded-2xl p-4 bg-[#DCFCE7] border border-[#86EFAC]\">\n                  <p className=\"text-sm font-verdana mb-2 text-[#1D2533]\">\n                    <strong className=\"font-fredoka\">Average Earnings:</strong>\n                  </p>\n                  <p className=\"text-2xl font-fredoka font-bold text-[#28C76F]\">\n                    {cleanerEarningsRange}\n                  </p>\n                  <p className=\"text-xs text-gray-600 font-verdana\">\n                    Based on your tier & performance\n                  </p>\n                </div>\n\n                <Link to={createPageUrl('CleanerSignup')} className=\"block\">\n                  <Button className=\"w-full text-lg py-6 rounded-full font-fredoka font-semibold shadow-lg hover:shadow-xl hover:opacity-90 transition-opacity text-white bg-[#28C76F]\">\n                    Sign Up as Cleaner\n                  </Button>\n                </Link>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n\n        {/* Bottom Info */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.4 }}\n          className=\"mt-12 text-center\"\n        >\n          <p className=\"text-gray-600 mb-4 font-verdana\">\n            Already have an account?{' '}\n            <button\n              onClick={handleSignIn}\n              className=\"font-fredoka font-semibold hover:underline text-[#0078FF]\"\n            >\n              Sign In\n            </button>\n            {' ¬∑ '}\n            <Link\n              to={createPageUrl('PreLaunch')}\n              className=\"font-fredoka font-semibold hover:underline text-[#8B5CF6]\"\n            >\n              Pre-Launch Signup\n            </Link>\n          </p>\n          <div className=\"flex flex-wrap justify-center gap-6 text-sm text-gray-500 font-verdana\">\n            <div className=\"flex items-center gap-2\">\n              <Shield className=\"w-4 h-4 text-[#0078FF]\" />\n              <span>Verified Platform</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Award className=\"w-4 h-4 text-[#28C76F]\" />\n              <span>Trusted by Thousands</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Clock className=\"w-4 h-4 text-[#00D4FF]\" />\n              <span>Quick Signup</span>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n    </main>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\SetupGuide.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":15,"fix":{"range":[108,155],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[108,154],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertTriangle' is defined but never used.","line":7,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":29,"fix":{"range":[325,340],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertTriangle"},"fix":{"range":[324,339],"text":""},"desc":"Remove unused variable 'AlertTriangle'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { \n  CheckCircle, AlertTriangle, Settings, Mail, MessageSquare, \n  Bell, Database, Shield, Zap\n} from 'lucide-react';\n\nexport default function SetupGuide() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-10\">\n      <div className=\"max-w-6xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-bold text-slate-900 mb-2\">\n            PureTask Notification System - Setup Guide\n          </h1>\n          <p className=\"text-lg text-slate-600\">\n            Complete deployment and configuration guide\n          </p>\n        </div>\n\n        <Alert className=\"mb-6 border-emerald-200 bg-emerald-50\">\n          <CheckCircle className=\"w-5 h-5 text-emerald-600\" />\n          <AlertDescription className=\"text-emerald-900\">\n            <strong>Status:</strong> All Base44 components are installed and ready. Follow this guide to complete external integrations.\n          </AlertDescription>\n        </Alert>\n\n        <Tabs defaultValue=\"overview\" className=\"space-y-6\">\n          <TabsList className=\"bg-white shadow-md p-1\">\n            <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n            <TabsTrigger value=\"sendgrid\">SendGrid</TabsTrigger>\n            <TabsTrigger value=\"twilio\">Twilio SMS</TabsTrigger>\n            <TabsTrigger value=\"push\">Push Notifications</TabsTrigger>\n            <TabsTrigger value=\"admin\">Admin Tools</TabsTrigger>\n          </TabsList>\n\n          {/* Overview */}\n          <TabsContent value=\"overview\">\n            <div className=\"space-y-6\">\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>System Architecture</CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-start gap-4 p-4 bg-blue-50 rounded-lg\">\n                      <CheckCircle className=\"w-6 h-6 text-blue-600 flex-shrink-0 mt-1\" />\n                      <div>\n                        <h3 className=\"font-semibold text-slate-900 mb-1\">Base44 App (Frontend)</h3>\n                        <p className=\"text-sm text-slate-600\">\n                          ‚úÖ Email templates stored in database\n                          <br />‚úÖ NotificationDispatcher component\n                          <br />‚úÖ TemplateRenderer for variable substitution\n                          <br />‚úÖ Message delivery logging\n                          <br />‚úÖ Admin template management UI\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-start gap-4 p-4 bg-emerald-50 rounded-lg\">\n                      <Settings className=\"w-6 h-6 text-emerald-600 flex-shrink-0 mt-1\" />\n                      <div>\n                        <h3 className=\"font-semibold text-slate-900 mb-1\">External Integrations (To Setup)</h3>\n                        <p className=\"text-sm text-slate-600\">\n                          üîß SendGrid for email delivery\n                          <br />üîß Twilio for SMS (optional)\n                          <br />üîß OneSignal/FCM for push (optional)\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>What's Already Working</CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    {[\n                      { icon: Mail, text: '15 email templates pre-configured', color: 'text-blue-600' },\n                      { icon: Database, text: 'EmailTemplate entity created', color: 'text-emerald-600' },\n                      { icon: Settings, text: 'Template management UI at /admin/email-templates', color: 'text-purple-600' },\n                      { icon: Zap, text: 'Notification dispatcher ready', color: 'text-amber-600' },\n                      { icon: Shield, text: 'Message delivery logging', color: 'text-red-600' },\n                      { icon: CheckCircle, text: 'Variable substitution engine', color: 'text-green-600' }\n                    ].map((item, idx) => (\n                      <div key={idx} className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg\">\n                        <item.icon className={`w-5 h-5 ${item.color}`} />\n                        <span className=\"text-sm text-slate-700\">{item.text}</span>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* SendGrid Setup */}\n          <TabsContent value=\"sendgrid\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader className=\"bg-gradient-to-r from-blue-50 to-cyan-50\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"w-6 h-6 text-blue-600\" />\n                  SendGrid Setup Guide\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-6\">\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">1. Create SendGrid Account</h3>\n                    <p className=\"text-sm text-slate-600\">\n                      Sign up at <a href=\"https://sendgrid.com\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 underline\">sendgrid.com</a> and verify your sender domain.\n                    </p>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">2. Get API Key</h3>\n                    <p className=\"text-sm text-slate-600 mb-2\">\n                      Settings ‚Üí API Keys ‚Üí Create API Key with \"Mail Send\" permissions\n                    </p>\n                    <div className=\"bg-slate-900 p-4 rounded-lg\">\n                      <code className=\"text-slate-100 text-xs\">\n                        SG.xxxxxxxxxxxxxxxxxx.yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\n                      </code>\n                    </div>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">3. Current Integration</h3>\n                    <p className=\"text-sm text-slate-600 mb-3\">\n                      The system currently uses Base44's built-in email service (<code>base44.integrations.Core.SendEmail</code>).\n                      To use SendGrid directly, you would need to:\n                    </p>\n                    <ul className=\"list-disc list-inside space-y-2 text-sm text-slate-600\">\n                      <li>Set up n8n workflow to send via SendGrid API</li>\n                      <li>Configure dynamic templates in SendGrid UI</li>\n                      <li>Map template IDs in your notification flows</li>\n                    </ul>\n                  </div>\n\n                  <Alert className=\"border-blue-200 bg-blue-50\">\n                    <AlertDescription className=\"text-blue-900 text-sm\">\n                      <strong>Current Status:</strong> Using Base44's email service. SendGrid integration is optional for advanced features like delivery analytics and A/B testing.\n                    </AlertDescription>\n                  </Alert>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Twilio Setup */}\n          <TabsContent value=\"twilio\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader className=\"bg-gradient-to-r from-green-50 to-emerald-50\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <MessageSquare className=\"w-6 h-6 text-green-600\" />\n                  Twilio SMS Setup Guide\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-6\">\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">1. Get Twilio Credentials</h3>\n                    <ul className=\"list-disc list-inside space-y-2 text-sm text-slate-600\">\n                      <li>Account SID</li>\n                      <li>Auth Token</li>\n                      <li>Phone number with SMS capability</li>\n                    </ul>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">2. SMS Templates</h3>\n                    <p className=\"text-sm text-slate-600 mb-3\">\n                      SMS versions are already defined in your email templates (sms_body field).\n                      Example templates:\n                    </p>\n                    <div className=\"bg-slate-900 p-4 rounded-lg space-y-2\">\n                      <code className=\"text-slate-100 text-xs block\">\n                        ‚úÖ Reminder: cleaning tomorrow at {'{'}{'{'} start_time {'}'}{'}'}\n                      </code>\n                      <code className=\"text-slate-100 text-xs block\">\n                        üöó Your cleaner is on the way\n                      </code>\n                      <code className=\"text-slate-100 text-xs block\">\n                        ‚ú® Cleaning complete! Leave a review: {'{'}{'{'} link {'}'}{'}'}\n                      </code>\n                    </div>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">3. Best Practices</h3>\n                    <ul className=\"list-disc list-inside space-y-2 text-sm text-slate-600\">\n                      <li>Keep messages under 160 characters</li>\n                      <li>Include short links for actions</li>\n                      <li>Respect SMS opt-in preferences</li>\n                      <li>Store numbers in E.164 format (+15551234567)</li>\n                    </ul>\n                  </div>\n\n                  <Alert className=\"border-green-200 bg-green-50\">\n                    <AlertDescription className=\"text-green-900 text-sm\">\n                      <strong>Current Status:</strong> SMS templates are ready. Integration with Twilio requires n8n workflow setup or external service.\n                    </AlertDescription>\n                  </Alert>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Push Notifications */}\n          <TabsContent value=\"push\">\n            <Card className=\"border-0 shadow-lg\">\n              <CardHeader className=\"bg-gradient-to-r from-purple-50 to-pink-50\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Bell className=\"w-6 h-6 text-purple-600\" />\n                  Push Notifications Setup\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-6\">\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">Recommended: OneSignal</h3>\n                    <ul className=\"list-decimal list-inside space-y-2 text-sm text-slate-600\">\n                      <li>Create account at onesignal.com</li>\n                      <li>Add your web app or mobile app</li>\n                      <li>Get App ID and API Key</li>\n                      <li>Implement OneSignal SDK in your mobile/web app</li>\n                      <li>Set external_user_id on login</li>\n                    </ul>\n                  </div>\n\n                  <div>\n                    <h3 className=\"font-semibold text-lg mb-3\">Push Template Examples</h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"bg-slate-50 p-4 rounded-lg border\">\n                        <p className=\"font-semibold text-sm mb-1\">You're booked ‚úÖ</p>\n                        <p className=\"text-sm text-slate-600\">Cleaning on Nov 7 at 3:00 PM with Maria.</p>\n                        <code className=\"text-xs text-slate-500 mt-2 block\">app://booking/{'{booking_id}'}</code>\n                      </div>\n                      <div className=\"bg-slate-50 p-4 rounded-lg border\">\n                        <p className=\"font-semibold text-sm mb-1\">New job invite üîî</p>\n                        <p className=\"text-sm text-slate-600\">Nov 7 @ 3:00 PM ‚Äî $118. Accept now.</p>\n                        <code className=\"text-xs text-slate-500 mt-2 block\">app://jobs/{'{job_id}'}</code>\n                      </div>\n                    </div>\n                  </div>\n\n                  <Alert className=\"border-purple-200 bg-purple-50\">\n                    <AlertDescription className=\"text-purple-900 text-sm\">\n                      <strong>Current Status:</strong> Push templates are defined in email templates (push_title, push_body fields). External push service integration required for delivery.\n                    </AlertDescription>\n                  </Alert>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Admin Tools */}\n          <TabsContent value=\"admin\">\n            <div className=\"space-y-6\">\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>Available Admin Pages</CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                      <h3 className=\"font-semibold mb-2\">üìß Email Templates</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/admin/email-templates</p>\n                      <p className=\"text-xs text-slate-500\">Create, edit, preview, and test email templates</p>\n                    </div>\n\n                    <div className=\"p-4 bg-emerald-50 rounded-lg border border-emerald-200\">\n                      <h3 className=\"font-semibold mb-2\">üì¨ Message Logs</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/admin/messages</p>\n                      <p className=\"text-xs text-slate-500\">View delivery logs, track status, resend failed messages</p>\n                    </div>\n\n                    <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                      <h3 className=\"font-semibold mb-2\">üß™ Test Booking Events</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/admin/test-booking</p>\n                      <p className=\"text-xs text-slate-500\">Trigger test booking confirmations</p>\n                    </div>\n\n                    <div className=\"p-4 bg-amber-50 rounded-lg border border-amber-200\">\n                      <h3 className=\"font-semibold mb-2\">üßπ Test Cleaner Events</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/admin/test-cleaner</p>\n                      <p className=\"text-xs text-slate-500\">Test check-in, arrival, completion flows</p>\n                    </div>\n\n                    <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n                      <h3 className=\"font-semibold mb-2\">‚ö° Test Notifications</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/admin/test-notifications</p>\n                      <p className=\"text-xs text-slate-500\">Test all notification types with custom data</p>\n                    </div>\n\n                    <div className=\"p-4 bg-cyan-50 rounded-lg border border-cyan-200\">\n                      <h3 className=\"font-semibold mb-2\">üìö Template Reference</h3>\n                      <p className=\"text-sm text-slate-600 mb-2\">/template-reference</p>\n                      <p className=\"text-xs text-slate-500\">Complete guide to templates and variables</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle>Go-Live Checklist</CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <div className=\"space-y-3\">\n                    {[\n                      { done: true, text: '‚úÖ EmailTemplate entity created' },\n                      { done: true, text: '‚úÖ 15 templates pre-loaded' },\n                      { done: true, text: '‚úÖ NotificationDispatcher component' },\n                      { done: true, text: '‚úÖ Admin template management UI' },\n                      { done: true, text: '‚úÖ Message delivery logging' },\n                      { done: false, text: 'üîß SendGrid API key configured (optional)' },\n                      { done: false, text: 'üîß Twilio credentials set (optional for SMS)' },\n                      { done: false, text: 'üîß Push service configured (optional)' },\n                      { done: true, text: '‚úÖ Test notification pages created' },\n                      { done: false, text: 'üîß Production smoke tests completed' }\n                    ].map((item, idx) => (\n                      <div\n                        key={idx}\n                        className={`flex items-center gap-3 p-3 rounded-lg ${\n                          item.done ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'\n                        }`}\n                      >\n                        <div className=\"text-lg\">{item.done ? '‚úÖ' : 'üîß'}</div>\n                        <span className=\"text-sm\">{item.text}</span>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        {/* Quick Start */}\n        <Card className=\"mt-6 border-0 shadow-lg\">\n          <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n            <CardTitle>Quick Start: Test the System Now</CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <p className=\"text-slate-700\">\n                Your notification system is ready to use! Here's how to test it:\n              </p>\n              \n              <ol className=\"list-decimal list-inside space-y-3 text-sm text-slate-600\">\n                <li>\n                  Navigate to <strong>Admin Dashboard ‚Üí Email Templates</strong>\n                </li>\n                <li>\n                  Click the \"Test Send\" button on any template\n                </li>\n                <li>\n                  Enter your email and test variables\n                </li>\n                <li>\n                  Check your inbox for the email\n                </li>\n                <li>\n                  View delivery logs at <strong>Admin Dashboard ‚Üí Message Delivery Logs</strong>\n                </li>\n              </ol>\n\n              <Alert className=\"border-emerald-200 bg-emerald-50\">\n                <AlertDescription className=\"text-emerald-900 text-sm\">\n                  <strong>Pro Tip:</strong> The system automatically logs all message attempts, tracks delivery status, and allows resending failed messages.\n                </AlertDescription>\n              </Alert>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\SignIn.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":8,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":60,"fix":{"range":[458,463],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[458,463],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":39,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Sparkles, LogIn, Loader2, ArrowLeft, UserPlus, Zap } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function SignIn() {\n  const navigate = useNavigate();\n  const [loading, setLoading] = useState(true);\n  const [signingIn, setSigningIn] = useState(false);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    checkIfAlreadyLoggedIn();\n  }, []);\n\n  const checkIfAlreadyLoggedIn = async () => {\n    try {\n      const user = await base44.auth.me();\n      if (user) {\n        // User is already logged in, redirect to appropriate dashboard\n        const cleanerProfiles = await base44.entities.CleanerProfile.filter({ user_email: user.email });\n        const clientProfiles = await base44.entities.ClientProfile.filter({ user_email: user.email });\n        \n        if (cleanerProfiles.length > 0) {\n          navigate(createPageUrl('CleanerDashboard'));\n        } else if (clientProfiles.length > 0) {\n          navigate(createPageUrl('ClientDashboard'));\n        } else if (user.role === 'admin') {\n          navigate(createPageUrl('AdminDashboard'));\n        } else {\n          navigate(createPageUrl('Home'));\n        }\n      }\n    } catch (error) {\n      // User not logged in, that's fine\n    }\n    setLoading(false);\n  };\n\n  const handleSignIn = () => {\n    setSigningIn(true);\n    setError(null);\n    \n    // Redirect using base44.auth.redirectToLogin\n    base44.auth.redirectToLogin();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n        className=\"w-full max-w-md\"\n      >\n        {/* Back to Home */}\n        <Link to={createPageUrl('Home')} className=\"inline-flex items-center gap-2 mb-6 text-gray-600 hover:text-puretask-blue transition-colors font-verdana\">\n          <ArrowLeft className=\"w-4 h-4\" />\n          Back to Home\n        </Link>\n\n        <Card className=\"border-2 border-blue-200 shadow-2xl\">\n          <CardHeader className=\"text-center pb-4\">\n            <div className=\"w-16 h-16 mx-auto mb-4 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <Sparkles className=\"w-8 h-8 text-white\" />\n            </div>\n            <CardTitle className=\"text-3xl font-fredoka font-bold text-graphite mb-2\">\n              Welcome Back\n            </CardTitle>\n            <CardDescription className=\"text-base font-verdana text-gray-600\">\n              Sign in to your PureTask account\n            </CardDescription>\n          </CardHeader>\n\n          <CardContent className=\"space-y-6\">\n            {error && (\n              <Alert variant=\"destructive\">\n                <AlertDescription>{error}</AlertDescription>\n              </Alert>\n            )}\n\n            <Button\n              onClick={handleSignIn}\n              disabled={signingIn}\n              className=\"w-full h-14 text-lg font-fredoka font-semibold rounded-full shadow-lg\"\n              style={{ \n                background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)',\n                color: 'white'\n              }}\n            >\n              {signingIn ? (\n                <>\n                  <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                  Signing In...\n                </>\n              ) : (\n                <>\n                  <LogIn className=\"w-5 h-5 mr-2\" />\n                  Sign In with Google\n                </>\n              )}\n            </Button>\n\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <div className=\"w-full border-t border-gray-300\"></div>\n              </div>\n              <div className=\"relative flex justify-center text-sm\">\n                <span className=\"px-4 bg-white text-gray-500 font-verdana\">\n                  New to PureTask?\n                </span>\n              </div>\n            </div>\n\n            <Link to={createPageUrl('RoleSelection')}>\n              <Button\n                variant=\"outline\"\n                className=\"w-full h-12 text-base font-fredoka font-semibold rounded-full border-2 border-puretask-blue text-puretask-blue hover:bg-blue-50\"\n              >\n                <UserPlus className=\"w-5 h-5 mr-2\" />\n                Create an Account\n              </Button>\n            </Link>\n\n            <div className=\"text-center pt-4\">\n              <p className=\"text-sm text-gray-600 font-verdana\">\n                By signing in, you agree to our{' '}\n                <Link to={createPageUrl('TermsOfService')} className=\"text-puretask-blue hover:underline\">\n                  Terms of Service\n                </Link>\n                {' '}and{' '}\n                <Link to={createPageUrl('PrivacyPolicy')} className=\"text-puretask-blue hover:underline\">\n                  Privacy Policy\n                </Link>\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Help Section */}\n        <div className=\"mt-6 text-center\">\n          <p className=\"text-sm text-gray-600 font-verdana mb-2\">\n            Need help signing in?\n          </p>\n          <Link to={createPageUrl('Support')}>\n            <Button variant=\"ghost\" className=\"text-puretask-blue font-fredoka font-semibold\">\n              Contact Support\n            </Button>\n          </Link>\n        </div>\n      </motion.div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\SmartBooking.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'MapPin' is defined but never used.","line":14,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":45,"fix":{"range":[697,705],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"MapPin"},"fix":{"range":[696,704],"text":""},"desc":"Remove unused variable 'MapPin'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CheckCircle2' is defined but never used.","line":14,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":59,"fix":{"range":[705,719],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CheckCircle2"},"fix":{"range":[704,718],"text":""},"desc":"Remove unused variable 'CheckCircle2'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":15,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":32,"fix":{"range":[747,753],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[746,752],"text":""},"desc":"Remove unused variable 'Home'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Label } from '@/components/ui/label';\nimport { Badge } from '@/components/ui/badge';\nimport AddressAutocomplete from '../components/address/AddressAutocomplete';\nimport { \n  Calendar, Clock, Sparkles, Loader2, MapPin, CheckCircle2, \n  XCircle, RefreshCw, Bot, Home, AlertCircle\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function SmartBooking() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const cleanerEmail = new URLSearchParams(location.search).get('cleaner');\n\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [generating, setGenerating] = useState(false);\n  const [responding, setResponding] = useState(false);\n  const [cleaner, setCleaner] = useState(null);\n\n  const [formData, setFormData] = useState({\n    address: '',\n    entry_instructions: '',\n    cleaning_type: 'basic',\n    estimated_hours: 3,\n    preferred_dates: [],\n    bedrooms: 2,\n    bathrooms: 1,\n    square_feet: 1000,\n    client_preferences: ''\n  });\n\n  const [suggestedSlots, setSuggestedSlots] = useState([]);\n  const [alternativeMessage, setAlternativeMessage] = useState('');\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n\n      if (cleanerEmail) {\n        const profiles = await base44.entities.CleanerProfile.filter({ user_email: cleanerEmail });\n        if (profiles.length > 0) {\n          setCleaner(profiles[0]);\n        }\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading data:', showToast: false });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleGenerateSuggestions = async () => {\n    if (!formData.address) {\n      toast.error('Please enter an address');\n      return;\n    }\n\n    if (!cleanerEmail) {\n      toast.error('No cleaner selected');\n      return;\n    }\n\n    try {\n      setGenerating(true);\n      const response = await base44.functions.invoke('suggestBookingSlots', {\n        client_email: user.email,\n        cleaner_email: cleanerEmail,\n        cleaning_type: formData.cleaning_type,\n        estimated_hours: formData.estimated_hours,\n        preferred_dates: formData.preferred_dates,\n        address: formData.address,\n        entry_instructions: formData.entry_instructions,\n        client_preferences: formData.client_preferences\n      });\n\n      if (response.data.success) {\n        setSuggestedSlots(response.data.suggested_slots || []);\n        setAlternativeMessage(response.data.alternative_message || '');\n        toast.success('AI generated optimal time slots!');\n      } else {\n        toast.error(response.data.error || 'Failed to generate suggestions');\n      }\n    } catch (error) {\n      toast.error('Failed to generate suggestions');\n      handleError(error, { showToast: false });\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSelectSlot = async (slot) => {\n    try {\n      setResponding(true);\n      const response = await base44.functions.invoke('processClientBookingResponse', {\n        client_response: 'selected_slot',\n        selected_slot: {\n          date: slot.date,\n          start_time: slot.start_time\n        },\n        client_email: user.email,\n        cleaner_email: cleanerEmail,\n        cleaning_type: formData.cleaning_type,\n        estimated_hours: formData.estimated_hours,\n        address: formData.address,\n        entry_instructions: formData.entry_instructions,\n        bedrooms: formData.bedrooms,\n        bathrooms: formData.bathrooms,\n        square_feet: formData.square_feet\n      });\n\n      if (response.data.success) {\n        toast.success('Booking request sent! Awaiting cleaner approval.');\n        setTimeout(() => {\n          navigate(createPageUrl('ClientBookings'));\n        }, 2000);\n      } else {\n        toast.error(response.data.error || 'Failed to send booking request');\n      }\n    } catch (error) {\n      toast.error('Failed to send booking request');\n      handleError(error, { showToast: false });\n    } finally {\n      setResponding(false);\n    }\n  };\n\n  const handleNotInterested = async () => {\n    try {\n      await base44.functions.invoke('processClientBookingResponse', {\n        client_response: 'not_interested',\n        client_email: user.email,\n        cleaner_email: cleanerEmail\n      });\n      toast.info('We\\'ll find other great cleaners for you');\n      navigate(createPageUrl('BrowseCleaners'));\n    } catch (error) {\n      handleError(error, { showToast: false });\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <div className=\"flex items-center gap-3 mb-2\">\n            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-puretask-blue to-indigo-500 flex items-center justify-center\">\n              <Bot className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-3xl font-fredoka font-bold text-graphite\">AI-Powered Booking</h1>\n              <p className=\"text-gray-600 font-verdana\">Let AI find the perfect time for your cleaning</p>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Cleaner Info */}\n        {cleaner && (\n          <Card className=\"mb-6 border-2 border-puretask-blue\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-puretask-blue to-cyan-500 flex items-center justify-center text-white font-fredoka font-bold text-xl\">\n                  {cleaner.full_name?.[0] || 'C'}\n                </div>\n                <div>\n                  <p className=\"font-fredoka font-bold text-lg\">{cleaner.full_name}</p>\n                  <div className=\"flex gap-2\">\n                    <Badge className=\"bg-puretask-blue text-white\">{cleaner.tier}</Badge>\n                    <Badge variant=\"outline\">‚≠ê {cleaner.average_rating?.toFixed(1)}</Badge>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Booking Form */}\n        {suggestedSlots.length === 0 && (\n          <Card className=\"mb-6\">\n            <CardHeader>\n              <CardTitle className=\"font-fredoka\">Booking Details</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label>Address *</Label>\n                <AddressAutocomplete\n                  value={formData.address}\n                  onChange={(address) => setFormData({ ...formData, address })}\n                  placeholder=\"Enter your address\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Entry Instructions</Label>\n                <Textarea\n                  value={formData.entry_instructions}\n                  onChange={(e) => setFormData({ ...formData, entry_instructions: e.target.value })}\n                  placeholder=\"How should the cleaner access your home?\"\n                  rows={2}\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Cleaning Type</Label>\n                  <select\n                    value={formData.cleaning_type}\n                    onChange={(e) => setFormData({ ...formData, cleaning_type: e.target.value })}\n                    className=\"w-full px-3 py-2 border rounded-lg\"\n                  >\n                    <option value=\"basic\">Basic Clean</option>\n                    <option value=\"deep\">Deep Clean</option>\n                    <option value=\"moveout\">Move-Out Clean</option>\n                  </select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Estimated Hours</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"8\"\n                    value={formData.estimated_hours}\n                    onChange={(e) => setFormData({ ...formData, estimated_hours: parseInt(e.target.value) })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-3 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Bedrooms</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"0\"\n                    value={formData.bedrooms}\n                    onChange={(e) => setFormData({ ...formData, bedrooms: parseInt(e.target.value) })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Bathrooms</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"0\"\n                    step=\"0.5\"\n                    value={formData.bathrooms}\n                    onChange={(e) => setFormData({ ...formData, bathrooms: parseFloat(e.target.value) })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Square Feet</Label>\n                  <Input\n                    type=\"number\"\n                    min=\"0\"\n                    value={formData.square_feet}\n                    onChange={(e) => setFormData({ ...formData, square_feet: parseInt(e.target.value) })}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Special Preferences (Optional)</Label>\n                <Textarea\n                  value={formData.client_preferences}\n                  onChange={(e) => setFormData({ ...formData, client_preferences: e.target.value })}\n                  placeholder=\"Any specific requirements or preferences...\"\n                  rows={2}\n                />\n              </div>\n\n              <Button\n                onClick={handleGenerateSuggestions}\n                disabled={generating}\n                className=\"w-full brand-gradient text-white gap-2\"\n              >\n                {generating ? (\n                  <>\n                    <Loader2 className=\"w-5 h-5 animate-spin\" />\n                    AI is analyzing schedules...\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"w-5 h-5\" />\n                    Generate AI Suggestions\n                  </>\n                )}\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* AI Suggested Slots */}\n        <AnimatePresence>\n          {suggestedSlots.length > 0 && (\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n            >\n              <Card className=\"mb-6\">\n                <CardHeader className=\"bg-gradient-to-r from-blue-50 to-indigo-50\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"font-fredoka flex items-center gap-2\">\n                      <Sparkles className=\"w-5 h-5 text-puretask-blue\" />\n                      AI Suggested Time Slots\n                    </CardTitle>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={handleGenerateSuggestions}\n                      disabled={generating}\n                      className=\"gap-2\"\n                    >\n                      <RefreshCw className=\"w-4 h-4\" />\n                      Show More\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"p-6 space-y-3\">\n                  {suggestedSlots.map((slot, idx) => (\n                    <motion.div\n                      key={idx}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: idx * 0.1 }}\n                      className=\"border-2 border-gray-200 rounded-xl p-4 hover:border-puretask-blue hover:shadow-lg transition-all cursor-pointer\"\n                      onClick={() => handleSelectSlot(slot)}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-puretask-blue to-cyan-500 flex items-center justify-center\">\n                            <Calendar className=\"w-6 h-6 text-white\" />\n                          </div>\n                          <div>\n                            <p className=\"font-fredoka font-bold text-lg text-graphite\">\n                              {new Date(slot.date).toLocaleDateString('en-US', { \n                                weekday: 'long', \n                                month: 'short', \n                                day: 'numeric' \n                              })}\n                            </p>\n                            <div className=\"flex items-center gap-2 text-gray-600\">\n                              <Clock className=\"w-4 h-4\" />\n                              <span className=\"font-verdana text-sm\">\n                                {slot.start_time} - {slot.end_time}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        {slot.fills_gap && (\n                          <Badge className=\"bg-green-100 text-green-800 border-green-300\">\n                            ‚ö° Optimal\n                          </Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-gray-600 font-verdana mt-2 pl-15\">\n                        üí° {slot.reasoning}\n                      </p>\n                    </motion.div>\n                  ))}\n\n                  {alternativeMessage && (\n                    <div className=\"bg-blue-50 border-2 border-blue-200 rounded-xl p-4 mt-4\">\n                      <div className=\"flex gap-2\">\n                        <AlertCircle className=\"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5\" />\n                        <p className=\"text-sm text-blue-800 font-verdana\">{alternativeMessage}</p>\n                      </div>\n                    </div>\n                  )}\n\n                  <div className=\"pt-4 border-t flex gap-3\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={handleNotInterested}\n                      className=\"flex-1 gap-2\"\n                    >\n                      <XCircle className=\"w-4 h-4\" />\n                      Not Interested\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {responding && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n            <Card className=\"w-96\">\n              <CardContent className=\"p-6 text-center\">\n                <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue mx-auto mb-4\" />\n                <p className=\"font-fredoka font-bold text-lg mb-2\">Sending Request...</p>\n                <p className=\"text-sm text-gray-600\">The cleaner will be notified immediately</p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\Support.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'FileText' is defined but never used.","line":22,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":26,"fix":{"range":[931,941],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[930,940],"text":""},"desc":"Remove unused variable 'FileText'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'X' is defined but never used.","line":24,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":36,"fix":{"range":[1080,1083],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"X"},"fix":{"range":[1079,1082],"text":""},"desc":"Remove unused variable 'X'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Home' is defined but never used.","line":24,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":47,"fix":{"range":[1087,1093],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Home"},"fix":{"range":[1087,1093],"text":""},"desc":"Remove unused variable 'Home'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'allTickets' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":32,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"allTickets"},"fix":{"range":[1370,1380],"text":""},"desc":"Remove unused variable 'allTickets'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'newTicket' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":209,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":209,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"newTicket"},"fix":{"range":[8084,8232],"text":""},"desc":"Remove unused variable 'newTicket'."}]},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":239,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":239,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":255,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":255,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":270,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":270,"endColumn":19},{"ruleId":"unused-imports/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":289,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":289,"endColumn":19}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":3,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { \n  HelpCircle, Send, Clock, CheckCircle, AlertCircle, Loader2, \n  MessageSquare, FileText, Search, Filter, ChevronDown, ChevronUp,\n  Book, CreditCard, Calendar, Shield, Phone, Mail, ExternalLink,\n  TrendingUp, User, Package, Zap, X, Eye, Home\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nexport default function Support() {\n  const [user, setUser] = useState(null);\n  const [tickets, setTickets] = useState([]);\n  const [filteredTickets, setFilteredTickets] = useState([]);\n  const [allTickets, setAllTickets] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [message, setMessage] = useState({ type: '', text: '' });\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [expandedFAQ, setExpandedFAQ] = useState(null);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [categoryFilter, setCategoryFilter] = useState('all');\n  const [selectedTicket, setSelectedTicket] = useState(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n  const [adminNotes, setAdminNotes] = useState('');\n  \n  const [formData, setFormData] = useState({\n    subject: '',\n    description: '',\n    category: '',\n    priority: 'medium',\n    booking_id: ''\n  });\n\n  const categories = [\n    { value: 'cancellation', label: 'Cancellation', icon: Calendar, color: 'text-red-500' },\n    { value: 'no_show', label: 'No Show', icon: AlertCircle, color: 'text-orange-500' },\n    { value: 'late_arrival', label: 'Late Arrival', icon: Clock, color: 'text-amber-500' },\n    { value: 'quality_issue', label: 'Quality Issue', icon: Shield, color: 'text-purple-500' },\n    { value: 'payment', label: 'Payment', icon: CreditCard, color: 'text-blue-500' },\n    { value: 'technical', label: 'Technical', icon: Zap, color: 'text-cyan-500' },\n    { value: 'account', label: 'Account', icon: User, color: 'text-green-500' },\n    { value: 'other', label: 'Other', icon: Package, color: 'text-gray-500' }\n  ];\n\n  const faqs = [\n    {\n      category: 'Bookings',\n      icon: Calendar,\n      color: 'blue',\n      questions: [\n        {\n          q: 'How do I cancel a booking?',\n          a: 'Go to your booking details and click \"Cancel Booking\". Cancellation fees apply based on notice period: Free (48+ hrs), 50% fee (24-48 hrs), Full charge (<24 hrs). See our Cancellation Policy for details.'\n        },\n        {\n          q: 'Can I reschedule my cleaning?',\n          a: 'Yes! Go to your booking and click \"Reschedule\". Same fees apply as cancellation. Contact your cleaner directly through messaging for faster coordination.'\n        },\n        {\n          q: 'What if my cleaner doesn\\'t show up?',\n          a: 'You\\'ll automatically receive full credits back plus a no-show credit. We\\'ll also help you find a replacement cleaner immediately. GPS tracking ensures accountability.'\n        }\n      ]\n    },\n    {\n      category: 'Payments',\n      icon: CreditCard,\n      color: 'green',\n      questions: [\n        {\n          q: 'How does payment work?',\n          a: 'Credits are held in escrow when you book. Payment is only released after the cleaner completes the job, uploads before/after photos, and you approve the work. You have 48 hours to review.'\n        },\n        {\n          q: 'What if I\\'m not satisfied with the cleaning?',\n          a: 'Don\\'t approve the work! Open a dispute within 48 hours. Our team will review the photos and resolve fairly. Payment is held until resolution.'\n        },\n        {\n          q: 'How do credits work?',\n          a: '10 credits = $1 USD. Buy credits in your wallet and use them for any booking. Unused credits never expire and can be refunded anytime.'\n        }\n      ]\n    },\n    {\n      category: 'Quality & Safety',\n      icon: Shield,\n      color: 'purple',\n      questions: [\n        {\n          q: 'Are cleaners background checked?',\n          a: 'Yes! All cleaners undergo full KYC verification, background checks, and identity verification. We also track reliability scores based on performance.'\n        },\n        {\n          q: 'What about insurance and damages?',\n          a: 'Report any damage within 48 hours through the dispute system. We review evidence (photos) and resolve fairly. See our Damage & Claims Policy for full details.'\n        },\n        {\n          q: 'How do I know the cleaning was done well?',\n          a: 'Cleaners must upload before/after photos with GPS check-in/out. You review the photos before approving payment. Rate your experience to help others.'\n        }\n      ]\n    },\n    {\n      category: 'Account & Technical',\n      icon: User,\n      color: 'cyan',\n      questions: [\n        {\n          q: 'How do I update my account details?',\n          a: 'Go to Profile > Edit Profile. You can update your name, contact info, default address, and payment methods.'\n        },\n        {\n          q: 'I forgot my password',\n          a: 'Click \"Forgot Password\" on the login page. You\\'ll receive a reset link via email within minutes.'\n        },\n        {\n          q: 'How do I contact my cleaner?',\n          a: 'Use the built-in messaging system in your booking details. Messages are instant and both parties get notifications.'\n        }\n      ]\n    }\n  ];\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  useEffect(() => {\n    filterTickets();\n  }, [tickets, searchQuery, statusFilter, categoryFilter]);\n\n  const loadData = async () => {\n    try {\n      const currentUser = await base44.auth.me();\n      setUser(currentUser);\n      const adminCheck = currentUser.role === 'admin';\n      setIsAdmin(adminCheck);\n\n      if (adminCheck) {\n        const allUserTickets = await base44.entities.SupportTicket.list('-created_date');\n        setAllTickets(allUserTickets);\n        setTickets(allUserTickets);\n      } else {\n        const userTickets = await base44.entities.SupportTicket.filter({ \n          user_email: currentUser.email \n        }, '-created_date');\n        setTickets(userTickets);\n      }\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading support data:', showToast: false });\n      setMessage({ type: 'error', text: 'Failed to load support data' });\n    }\n    setLoading(false);\n  };\n\n  const filterTickets = () => {\n    let filtered = [...tickets];\n\n    if (searchQuery) {\n      filtered = filtered.filter(ticket => \n        ticket.subject?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        ticket.description?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n        ticket.user_email?.toLowerCase().includes(searchQuery.toLowerCase())\n      );\n    }\n\n    if (statusFilter !== 'all') {\n      filtered = filtered.filter(ticket => ticket.status === statusFilter);\n    }\n\n    if (categoryFilter !== 'all') {\n      filtered = filtered.filter(ticket => ticket.category === categoryFilter);\n    }\n\n    setFilteredTickets(filtered);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!formData.category) {\n      setMessage({ type: 'error', text: 'Please select a category' });\n      return;\n    }\n\n    setSubmitting(true);\n    setMessage({ type: '', text: '' });\n\n    try {\n      const newTicket = await base44.entities.SupportTicket.create({\n        user_email: user.email,\n        ...formData,\n        status: 'open'\n      });\n\n      // Create conversation thread for this support ticket\n      const admins = await base44.entities.User.filter({ role: 'admin' });\n      const adminEmail = admins.length > 0 ? admins[0].email : 'support@puretask.com';\n\n      await base44.functions.invoke('messaging', {\n        action: 'createConversation',\n        participants: [user.email, adminEmail],\n        subject: `Support: ${formData.subject}`,\n        booking_id: formData.booking_id || undefined,\n        initial_message_content: formData.description\n      });\n\n      setMessage({ type: 'success', text: '‚úì Support ticket submitted successfully! We\\'ll respond within 24 hours.' });\n      setFormData({\n        subject: '',\n        description: '',\n        category: '',\n        priority: 'medium',\n        booking_id: ''\n      });\n      \n      await loadData();\n      \n      setTimeout(() => setMessage({ type: '', text: '' }), 5000);\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to submit ticket. Please try again or contact us directly.' });\n    }\n    setSubmitting(false);\n  };\n\n  const handleUpdateTicketStatus = async (ticketId, newStatus) => {\n    try {\n      await base44.entities.SupportTicket.update(ticketId, { status: newStatus });\n      setMessage({ type: 'success', text: 'Ticket status updated successfully' });\n      await loadData();\n      if (selectedTicket?.id === ticketId) {\n        const updatedTicket = tickets.find(t => t.id === ticketId);\n        setSelectedTicket({ ...updatedTicket, status: newStatus });\n      }\n      setTimeout(() => setMessage({ type: '', text: '' }), 3000);\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to update ticket status' });\n    }\n  };\n\n  const handleUpdateTicketPriority = async (ticketId, newPriority) => {\n    try {\n      await base44.entities.SupportTicket.update(ticketId, { priority: newPriority });\n      setMessage({ type: 'success', text: 'Priority updated successfully' });\n      await loadData();\n      if (selectedTicket?.id === ticketId) {\n        const updatedTicket = tickets.find(t => t.id === ticketId);\n        setSelectedTicket({ ...updatedTicket, priority: newPriority });\n      }\n      setTimeout(() => setMessage({ type: '', text: '' }), 3000);\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to update priority' });\n    }\n  };\n\n  const handleViewDetails = (ticket) => {\n    setSelectedTicket(ticket);\n    setAdminNotes(ticket.ai_suggested_resolution || '');\n    setShowDetailsModal(true);\n  };\n\n  const handleSaveAdminNotes = async () => {\n    try {\n      await base44.entities.SupportTicket.update(selectedTicket.id, {\n        ai_suggested_resolution: adminNotes\n      });\n      setMessage({ type: 'success', text: 'Notes saved successfully' });\n      await loadData();\n      setTimeout(() => setMessage({ type: '', text: '' }), 3000);\n    } catch (error) {\n      setMessage({ type: 'error', text: 'Failed to save notes' });\n    }\n  };\n\n  const getStatusConfig = (status) => {\n    const configs = {\n      open: { color: 'bg-blue-500', icon: Clock, label: 'Open' },\n      in_progress: { color: 'bg-amber-500', icon: TrendingUp, label: 'In Progress' },\n      resolved: { color: 'bg-green-500', icon: CheckCircle, label: 'Resolved' },\n      closed: { color: 'bg-gray-500', icon: CheckCircle, label: 'Closed' }\n    };\n    return configs[status] || configs.open;\n  };\n\n  const getPriorityConfig = (priority) => {\n    const configs = {\n      low: { color: 'bg-gray-400', label: 'Low' },\n      medium: { color: 'bg-blue-500', label: 'Medium' },\n      high: { color: 'bg-orange-500', label: 'High' },\n      urgent: { color: 'bg-red-600', label: 'Urgent' }\n    };\n    return configs[priority] || configs.medium;\n  };\n\n  const getCategoryIcon = (category) => {\n    const cat = categories.find(c => c.value === category);\n    return cat ? cat.icon : Package;\n  };\n\n  const getCategoryColor = (category) => {\n    const cat = categories.find(c => c.value === category);\n    return cat ? cat.color : 'text-gray-500';\n  };\n\n  const stats = {\n    total: tickets.length,\n    open: tickets.filter(t => t.status === 'open').length,\n    in_progress: tickets.filter(t => t.status === 'in_progress').length,\n    resolved: tickets.filter(t => t.status === 'resolved').length\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <div className=\"text-center\">\n          <Loader2 className=\"w-16 h-16 animate-spin text-puretask-blue mx-auto mb-4\" />\n          <p className=\"text-gray-600 font-verdana\">Loading support center...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud\">\n      <div className=\"bg-white border-b-4 border-blue-200 py-12 px-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex items-center gap-4 mb-4\">\n            <div className=\"w-16 h-16 brand-gradient rounded-2xl flex items-center justify-center shadow-lg\">\n              <HelpCircle className=\"w-8 h-8 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Support Center</h1>\n              <p className=\"text-lg text-gray-600 font-verdana\">We're here to help you 24/7</p>\n            </div>\n          </div>\n\n          {isAdmin && (\n            <div className=\"grid grid-cols-4 gap-4 mt-6\">\n              <Card className=\"border-2 border-blue-200 shadow-md\">\n                <CardContent className=\"p-4 text-center\">\n                  <p className=\"text-3xl font-fredoka font-bold text-graphite\">{stats.total}</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Total Tickets</p>\n                </CardContent>\n              </Card>\n              <Card className=\"border-2 border-blue-300 shadow-md\">\n                <CardContent className=\"p-4 text-center\">\n                  <p className=\"text-3xl font-fredoka font-bold text-puretask-blue\">{stats.open}</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Open</p>\n                </CardContent>\n              </Card>\n              <Card className=\"border-2 border-amber-300 shadow-md\">\n                <CardContent className=\"p-4 text-center\">\n                  <p className=\"text-3xl font-fredoka font-bold text-amber-600\">{stats.in_progress}</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">In Progress</p>\n                </CardContent>\n              </Card>\n              <Card className=\"border-2 border-green-300 shadow-md\">\n                <CardContent className=\"p-4 text-center\">\n                  <p className=\"text-3xl font-fredoka font-bold text-fresh-mint\">{stats.resolved}</p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">Resolved</p>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        <AnimatePresence>\n          {message.text && (\n            <motion.div\n              initial={{ opacity: 0, y: -20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              className=\"mb-6\"\n            >\n              <Alert className={`border-2 rounded-2xl ${\n                message.type === 'success' ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'\n              }`}>\n                {message.type === 'success' ? (\n                  <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                ) : (\n                  <AlertCircle className=\"w-5 h-5 text-red-600\" />\n                )}\n                <AlertDescription className={`font-verdana ${\n                  message.type === 'success' ? 'text-green-800' : 'text-red-800'\n                }`}>\n                  {message.text}\n                </AlertDescription>\n              </Alert>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        <Tabs defaultValue=\"submit\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-3 max-w-2xl mx-auto gap-3\">\n            <TabsTrigger \n              value=\"submit\" \n              className=\"rounded-full font-fredoka font-bold text-base py-3 transition-all shadow-sm data-[state=inactive]:text-gray-700 data-[state=inactive]:bg-white data-[state=active]:text-white border-2 data-[state=inactive]:border-gray-200\"\n            >\n              <Send className=\"w-4 h-4 mr-2\" />\n              Submit Ticket\n            </TabsTrigger>\n            <TabsTrigger \n              value=\"tickets\" \n              className=\"rounded-full font-fredoka font-bold text-base py-3 transition-all shadow-sm data-[state=inactive]:text-gray-700 data-[state=inactive]:bg-white data-[state=active]:text-white border-2 data-[state=inactive]:border-gray-200\"\n            >\n              <MessageSquare className=\"w-4 h-4 mr-2\" />\n              My Tickets {tickets.length > 0 && `(${tickets.length})`}\n            </TabsTrigger>\n            <TabsTrigger \n              value=\"faq\" \n              className=\"rounded-full font-fredoka font-bold text-base py-3 transition-all shadow-sm data-[state=inactive]:text-gray-700 data-[state=inactive]:bg-white data-[state=active]:text-white border-2 data-[state=inactive]:border-gray-200\"\n            >\n              <Book className=\"w-4 h-4 mr-2\" />\n              FAQ\n            </TabsTrigger>\n          </TabsList>\n\n          <style dangerouslySetInnerHTML={{__html: `\n            [role=\"tablist\"] {\n              background: transparent !important;\n              padding: 0 !important;\n              border: none !important;\n              box-shadow: none !important;\n            }\n            [role=\"tablist\"] button[data-state=\"active\"] {\n              background: linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%) !important;\n              color: white !important;\n              border-color: transparent !important;\n              box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;\n            }\n            [role=\"tablist\"] button[data-state=\"inactive\"]:hover {\n              background-color: #F9FAFB !important;\n              border-color: #D1D5DB !important;\n            }\n          `}} />\n\n          {/* SUBMIT TICKET TAB */}\n          <TabsContent value=\"submit\" className=\"space-y-6\">\n            <div className=\"grid lg:grid-cols-3 gap-6\">\n              <Card className=\"border-0 shadow-xl rounded-2xl lg:col-span-2\">\n                <CardHeader className=\"rounded-t-2xl bg-gradient-to-r from-blue-500 to-cyan-500\">\n                  <CardTitle className=\"flex items-center gap-2 font-fredoka text-white text-xl\">\n                    <Send className=\"w-6 h-6\" />\n                    Submit a Support Ticket\n                  </CardTitle>\n                  <p className=\"text-blue-50 font-verdana text-sm\">We typically respond within 24 hours</p>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div>\n                      <Label className=\"font-fredoka font-semibold text-graphite text-base mb-3 block\">\n                        What do you need help with? *\n                      </Label>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {categories.map((cat) => {\n                          const Icon = cat.icon;\n                          return (\n                            <button\n                              key={cat.value}\n                              type=\"button\"\n                              onClick={() => setFormData({ ...formData, category: cat.value })}\n                              className={`p-4 rounded-xl border-2 transition-all text-left ${\n                                formData.category === cat.value\n                                  ? 'border-puretask-blue bg-blue-50 shadow-lg scale-105'\n                                  : 'border-gray-200 hover:border-gray-300 hover:shadow-md'\n                              }`}\n                            >\n                              <Icon className={`w-6 h-6 mb-2 ${formData.category === cat.value ? 'text-puretask-blue' : cat.color}`} />\n                              <p className={`font-fredoka font-semibold ${formData.category === cat.value ? 'text-puretask-blue' : 'text-graphite'}`}>\n                                {cat.label}\n                              </p>\n                            </button>\n                          );\n                        })}\n                      </div>\n                    </div>\n\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                      <div>\n                        <Label className=\"font-fredoka font-semibold text-graphite\">Priority</Label>\n                        <Select value={formData.priority} onValueChange={(value) => setFormData({ ...formData, priority: value })}>\n                          <SelectTrigger className=\"rounded-xl font-verdana border-2\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"low\">Low - General question</SelectItem>\n                            <SelectItem value=\"medium\">Medium - Issue needs attention</SelectItem>\n                            <SelectItem value=\"high\">High - Urgent problem</SelectItem>\n                            <SelectItem value=\"urgent\">Urgent - Critical issue</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <div>\n                        <Label className=\"font-fredoka font-semibold text-graphite\">Booking ID (if applicable)</Label>\n                        <Input\n                          value={formData.booking_id}\n                          onChange={(e) => setFormData({ ...formData, booking_id: e.target.value })}\n                          placeholder=\"e.g., BK123456\"\n                          className=\"font-verdana border-2 rounded-xl\"\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <Label className=\"font-fredoka font-semibold text-graphite\">Subject *</Label>\n                      <Input\n                        value={formData.subject}\n                        onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\n                        placeholder=\"Brief summary of your issue\"\n                        className=\"font-verdana border-2 rounded-xl\"\n                        required\n                      />\n                    </div>\n\n                    <div>\n                      <Label className=\"font-fredoka font-semibold text-graphite\">Description *</Label>\n                      <Textarea\n                        value={formData.description}\n                        onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                        placeholder=\"Please provide as much detail as possible about your issue. Include booking ID, dates, cleaner names, etc.\"\n                        rows={6}\n                        className=\"rounded-xl font-verdana border-2\"\n                        required\n                      />\n                      <p className=\"text-xs text-gray-500 font-verdana mt-1\">\n                        Tip: More details help us resolve your issue faster\n                      </p>\n                    </div>\n\n                    <Button\n                      type=\"submit\"\n                      className=\"w-full text-lg py-6 rounded-xl font-fredoka font-bold shadow-xl hover:shadow-2xl transition-all border-2 border-transparent\"\n                      style={{ background: 'linear-gradient(135deg, #66B3FF 0%, #00D4FF 100%)', color: 'white' }}\n                      disabled={submitting}\n                    >\n                      {submitting ? (\n                        <>\n                          <Loader2 className=\"w-5 h-5 mr-2 animate-spin\" />\n                          Submitting...\n                        </>\n                      ) : (\n                        <>\n                          <Send className=\"w-5 h-5 mr-2\" />\n                          Submit Support Ticket\n                        </>\n                      )}\n                    </Button>\n                  </form>\n                </CardContent>\n              </Card>\n\n              <div className=\"space-y-6\">\n                <Card className=\"border-0 shadow-xl rounded-2xl bg-gradient-to-br from-purple-50 to-pink-50\">\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"font-fredoka font-bold text-graphite text-xl mb-4\">Need Immediate Help?</h3>\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-start gap-3\">\n                        <Mail className=\"w-6 h-6 text-puretask-blue mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-semibold text-graphite\">Email Support</p>\n                          <a href=\"mailto:support@puretask.com\" className=\"text-puretask-blue font-verdana text-sm hover:underline\">\n                            support@puretask.com\n                          </a>\n                          <p className=\"text-xs text-gray-600 font-verdana mt-1\">Response within 24 hours</p>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3\">\n                        <Phone className=\"w-6 h-6 text-fresh-mint mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-semibold text-graphite\">Emergency Line</p>\n                          <a href=\"tel:1-800-PURETASK\" className=\"text-fresh-mint font-verdana text-sm hover:underline\">\n                            1-800-PURETASK\n                          </a>\n                          <p className=\"text-xs text-gray-600 font-verdana mt-1\">Available 24/7</p>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-start gap-3\">\n                        <MessageSquare className=\"w-6 h-6 text-amber-500 mt-1\" />\n                        <div>\n                          <p className=\"font-fredoka font-semibold text-graphite\">Live Chat</p>\n                          <p className=\"text-amber-600 font-verdana text-sm\">Coming Soon</p>\n                          <p className=\"text-xs text-gray-600 font-verdana mt-1\">Instant support via chat</p>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"border-0 shadow-xl rounded-2xl\">\n                  <CardContent className=\"p-6\">\n                    <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-3\">Quick Links</h3>\n                    <div className=\"space-y-2\">\n                      <a href=\"#\" className=\"flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors\">\n                        <span className=\"font-verdana text-gray-700\">Cancellation Policy</span>\n                        <ExternalLink className=\"w-4 h-4 text-gray-400\" />\n                      </a>\n                      <a href=\"#\" className=\"flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors\">\n                        <span className=\"font-verdana text-gray-700\">Damage & Claims</span>\n                        <ExternalLink className=\"w-4 h-4 text-gray-400\" />\n                      </a>\n                      <a href=\"#\" className=\"flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors\">\n                        <span className=\"font-verdana text-gray-700\">How It Works</span>\n                        <ExternalLink className=\"w-4 h-4 text-gray-400\" />\n                      </a>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </TabsContent>\n\n          {/* MY TICKETS TAB */}\n          <TabsContent value=\"tickets\" className=\"space-y-6\">\n            <Card className=\"border-0 shadow-lg rounded-2xl\">\n              <CardContent className=\"p-6\">\n                <div className=\"grid md:grid-cols-3 gap-4\">\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400\" />\n                    <Input\n                      placeholder=\"Search tickets...\"\n                      value={searchQuery}\n                      onChange={(e) => setSearchQuery(e.target.value)}\n                      className=\"pl-10 font-verdana border-2 rounded-xl\"\n                    />\n                  </div>\n                  \n                  <Select value={statusFilter} onValueChange={setStatusFilter}>\n                    <SelectTrigger className=\"rounded-xl font-verdana border-2\">\n                      <Filter className=\"w-4 h-4 mr-2\" />\n                      <SelectValue placeholder=\"Filter by status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Status</SelectItem>\n                      <SelectItem value=\"open\">Open</SelectItem>\n                      <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                      <SelectItem value=\"resolved\">Resolved</SelectItem>\n                      <SelectItem value=\"closed\">Closed</SelectItem>\n                    </SelectContent>\n                  </Select>\n\n                  <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n                    <SelectTrigger className=\"rounded-xl font-verdana border-2\">\n                      <Filter className=\"w-4 h-4 mr-2\" />\n                      <SelectValue placeholder=\"Filter by category\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Categories</SelectItem>\n                      {categories.map(cat => (\n                        <SelectItem key={cat.value} value={cat.value}>{cat.label}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </CardContent>\n            </Card>\n\n            <div className=\"space-y-4\">\n              {filteredTickets.length > 0 ? (\n                filteredTickets.map((ticket) => {\n                  const statusConfig = getStatusConfig(ticket.status);\n                  const priorityConfig = getPriorityConfig(ticket.priority);\n                  const CategoryIcon = getCategoryIcon(ticket.category);\n                  const categoryColor = getCategoryColor(ticket.category);\n                  const StatusIcon = statusConfig.icon;\n\n                  return (\n                    <motion.div\n                      key={ticket.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ duration: 0.3 }}\n                    >\n                      <Card className=\"border-0 shadow-lg rounded-2xl hover:shadow-xl transition-shadow\">\n                        <CardContent className=\"p-6\">\n                          <div className=\"flex items-start justify-between mb-4\">\n                            <div className=\"flex items-start gap-4 flex-1\">\n                              <div className={`p-3 rounded-xl bg-gray-50 ${categoryColor}`}>\n                                <CategoryIcon className=\"w-6 h-6\" />\n                              </div>\n                              <div className=\"flex-1\">\n                                <h3 className=\"font-fredoka font-bold text-graphite text-lg mb-1\">\n                                  {ticket.subject}\n                                </h3>\n                                <p className=\"text-gray-600 font-verdana mb-3 line-clamp-2\">\n                                  {ticket.description}\n                                </p>\n                                <div className=\"flex flex-wrap gap-2\">\n                                  <Badge className={`${statusConfig.color} text-white rounded-full font-fredoka`}>\n                                    <StatusIcon className=\"w-3 h-3 mr-1\" />\n                                    {statusConfig.label}\n                                  </Badge>\n                                  <Badge className={`${priorityConfig.color} text-white rounded-full font-fredoka`}>\n                                    {priorityConfig.label}\n                                  </Badge>\n                                  <Badge variant=\"outline\" className=\"rounded-full font-fredoka\">\n                                    {categories.find(c => c.value === ticket.category)?.label || ticket.category}\n                                  </Badge>\n                                  {ticket.booking_id && (\n                                    <Badge variant=\"outline\" className=\"rounded-full font-fredoka\">\n                                      üìã {ticket.booking_id}\n                                    </Badge>\n                                  )}\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"text-right ml-4\">\n                              <p className=\"text-sm text-gray-500 font-verdana\">\n                                {new Date(ticket.created_date).toLocaleDateString('en-US', {\n                                  month: 'short',\n                                  day: 'numeric',\n                                  year: 'numeric'\n                                })}\n                              </p>\n                              <p className=\"text-xs text-gray-400 font-verdana\">\n                                {new Date(ticket.created_date).toLocaleTimeString('en-US', {\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </p>\n                              {isAdmin && (\n                                <p className=\"text-xs text-puretask-blue font-verdana mt-1\">\n                                  {ticket.user_email}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n\n                          {isAdmin && (\n                            <div className=\"flex gap-2 pt-4 border-t-2 border-gray-100\">\n                              <Select\n                                value={ticket.status}\n                                onValueChange={(value) => handleUpdateTicketStatus(ticket.id, value)}\n                              >\n                                <SelectTrigger className=\"w-40 rounded-xl font-verdana text-sm border-2\">\n                                  <SelectValue />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  <SelectItem value=\"open\">Open</SelectItem>\n                                  <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                                  <SelectItem value=\"resolved\">Resolved</SelectItem>\n                                  <SelectItem value=\"closed\">Closed</SelectItem>\n                                </SelectContent>\n                              </Select>\n\n                              <Select\n                                value={ticket.priority}\n                                onValueChange={(value) => handleUpdateTicketPriority(ticket.id, value)}\n                              >\n                                <SelectTrigger className=\"w-32 rounded-xl font-verdana text-sm border-2\">\n                                  <SelectValue />\n                                </SelectTrigger>\n                                <SelectContent>\n                                  <SelectItem value=\"low\">Low</SelectItem>\n                                  <SelectItem value=\"medium\">Medium</SelectItem>\n                                  <SelectItem value=\"high\">High</SelectItem>\n                                  <SelectItem value=\"urgent\">Urgent</SelectItem>\n                                </SelectContent>\n                              </Select>\n\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"rounded-xl font-fredoka\"\n                                onClick={() => handleViewDetails(ticket)}\n                              >\n                                <Eye className=\"w-4 h-4 mr-2\" />\n                                View Details\n                              </Button>\n                            </div>\n                          )}\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  );\n                })\n              ) : (\n                <Card className=\"border-0 shadow-xl rounded-2xl\">\n                  <CardContent className=\"p-12 text-center\">\n                    <MessageSquare className=\"w-20 h-20 text-gray-300 mx-auto mb-4\" />\n                    <h3 className=\"font-fredoka font-bold text-graphite text-xl mb-2\">\n                      {searchQuery || statusFilter !== 'all' || categoryFilter !== 'all'\n                        ? 'No tickets found'\n                        : 'No support tickets yet'}\n                    </h3>\n                    <p className=\"text-gray-500 font-verdana mb-6\">\n                      {searchQuery || statusFilter !== 'all' || categoryFilter !== 'all'\n                        ? 'Try adjusting your filters'\n                        : 'When you submit a ticket, it will appear here'}\n                    </p>\n                    {!searchQuery && statusFilter === 'all' && categoryFilter === 'all' && (\n                      <Button\n                        onClick={() => document.querySelector('[value=\"submit\"]').click()}\n                        className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                      >\n                        <Send className=\"w-4 h-4 mr-2\" />\n                        Submit Your First Ticket\n                      </Button>\n                    )}\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n          </TabsContent>\n\n          {/* FAQ TAB */}\n          <TabsContent value=\"faq\" className=\"space-y-6\">\n            <Card className=\"border-0 shadow-xl rounded-2xl\">\n              <CardHeader className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-t-2xl\">\n                <CardTitle className=\"font-fredoka text-graphite text-2xl\">\n                  <Book className=\"w-6 h-6 inline mr-2 text-amber-600\" />\n                  Frequently Asked Questions\n                </CardTitle>\n                <p className=\"text-gray-600 font-verdana text-sm\">\n                  Find quick answers to common questions\n                </p>\n              </CardHeader>\n              <CardContent className=\"p-6\">\n                <div className=\"space-y-6\">\n                  {faqs.map((faqCategory, catIdx) => {\n                    const CategoryIcon = faqCategory.icon;\n                    const colorClasses = {\n                      blue: 'text-blue-500 bg-blue-50 border-blue-200',\n                      green: 'text-green-500 bg-green-50 border-green-200',\n                      purple: 'text-purple-500 bg-purple-50 border-purple-200',\n                      cyan: 'text-cyan-500 bg-cyan-50 border-cyan-200'\n                    };\n                    \n                    return (\n                      <div key={catIdx}>\n                        <div className={`flex items-center gap-3 p-4 rounded-xl border-2 mb-4 ${colorClasses[faqCategory.color]}`}>\n                          <CategoryIcon className={`w-6 h-6 ${colorClasses[faqCategory.color].split(' ')[0]}`} />\n                          <h3 className=\"font-fredoka font-bold text-graphite text-lg\">\n                            {faqCategory.category}\n                          </h3>\n                        </div>\n                        \n                        <div className=\"space-y-3 ml-4\">\n                          {faqCategory.questions.map((item, idx) => {\n                            const isExpanded = expandedFAQ === `${catIdx}-${idx}`;\n                            return (\n                              <Card\n                                key={idx}\n                                className=\"border-2 border-gray-200 rounded-xl overflow-hidden hover:border-gray-300 transition-colors\"\n                              >\n                                <button\n                                  onClick={() => setExpandedFAQ(isExpanded ? null : `${catIdx}-${idx}`)}\n                                  className=\"w-full p-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors\"\n                                >\n                                  <span className=\"font-fredoka font-semibold text-graphite pr-4\">\n                                    {item.q}\n                                  </span>\n                                  {isExpanded ? (\n                                    <ChevronUp className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\n                                  ) : (\n                                    <ChevronDown className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\n                                  )}\n                                </button>\n                                <AnimatePresence>\n                                  {isExpanded && (\n                                    <motion.div\n                                      initial={{ height: 0, opacity: 0 }}\n                                      animate={{ height: 'auto', opacity: 1 }}\n                                      exit={{ height: 0, opacity: 0 }}\n                                      transition={{ duration: 0.2 }}\n                                    >\n                                      <div className=\"px-4 pb-4 text-gray-600 font-verdana leading-relaxed border-t-2 border-gray-100 pt-4\">\n                                        {item.a}\n                                      </div>\n                                    </motion.div>\n                                  )}\n                                </AnimatePresence>\n                              </Card>\n                            );\n                          })}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n\n                <div className=\"mt-8 p-6 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl border-2 border-blue-200 text-center\">\n                  <h3 className=\"font-fredoka font-bold text-graphite text-xl mb-2\">\n                    Still Have Questions?\n                  </h3>\n                  <p className=\"text-gray-600 font-verdana mb-4\">\n                    Can't find what you're looking for? We're here to help!\n                  </p>\n                  <Button\n                    onClick={() => document.querySelector('[value=\"submit\"]').click()}\n                    className=\"brand-gradient text-white rounded-full font-fredoka font-semibold\"\n                  >\n                    <Send className=\"w-4 h-4 mr-2\" />\n                    Contact Support\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Ticket Details Modal */}\n      <Dialog open={showDetailsModal} onOpenChange={setShowDetailsModal}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"font-fredoka text-2xl text-graphite flex items-center gap-2\">\n              <Eye className=\"w-6 h-6 text-puretask-blue\" />\n              Ticket Details\n            </DialogTitle>\n            <DialogDescription className=\"font-verdana\">\n              View and manage support ticket information\n            </DialogDescription>\n          </DialogHeader>\n\n          {selectedTicket && (\n            <div className=\"space-y-6 py-4\">\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Subject</Label>\n                  <p className=\"text-gray-700 font-verdana p-3 bg-gray-50 rounded-xl border-2 border-gray-200\">\n                    {selectedTicket.subject}\n                  </p>\n                </div>\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Category</Label>\n                  <p className=\"text-gray-700 font-verdana p-3 bg-gray-50 rounded-xl border-2 border-gray-200 capitalize\">\n                    {categories.find(c => c.value === selectedTicket.category)?.label || selectedTicket.category}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"grid md:grid-cols-3 gap-4\">\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Status</Label>\n                  <Badge className={`${getStatusConfig(selectedTicket.status).color} text-white rounded-full font-fredoka text-sm px-4 py-2`}>\n                    {getStatusConfig(selectedTicket.status).label}\n                  </Badge>\n                </div>\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Priority</Label>\n                  <Badge className={`${getPriorityConfig(selectedTicket.priority).color} text-white rounded-full font-fredoka text-sm px-4 py-2`}>\n                    {getPriorityConfig(selectedTicket.priority).label}\n                  </Badge>\n                </div>\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Created</Label>\n                  <p className=\"text-gray-700 font-verdana text-sm\">\n                    {new Date(selectedTicket.created_date).toLocaleString()}\n                  </p>\n                </div>\n              </div>\n\n              {selectedTicket.booking_id && (\n                <div>\n                  <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Booking ID</Label>\n                  <p className=\"text-gray-700 font-verdana p-3 bg-blue-50 rounded-xl border-2 border-blue-200\">\n                    {selectedTicket.booking_id}\n                  </p>\n                </div>\n              )}\n\n              <div>\n                <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">User Email</Label>\n                <p className=\"text-gray-700 font-verdana p-3 bg-gray-50 rounded-xl border-2 border-gray-200\">\n                  {selectedTicket.user_email}\n                </p>\n              </div>\n\n              <div>\n                <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Description</Label>\n                <div className=\"text-gray-700 font-verdana p-4 bg-gray-50 rounded-xl border-2 border-gray-200 whitespace-pre-wrap\">\n                  {selectedTicket.description}\n                </div>\n              </div>\n\n              {isAdmin && (\n                <>\n                  <div className=\"border-t-2 border-gray-200 pt-6\">\n                    <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Admin Notes / Resolution</Label>\n                    <Textarea\n                      value={adminNotes}\n                      onChange={(e) => setAdminNotes(e.target.value)}\n                      placeholder=\"Add notes about this ticket or resolution details...\"\n                      rows={4}\n                      className=\"rounded-xl font-verdana border-2\"\n                    />\n                    <Button\n                      onClick={handleSaveAdminNotes}\n                      className=\"mt-3 brand-gradient text-white rounded-xl font-fredoka font-semibold\"\n                    >\n                      Save Notes\n                    </Button>\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <div className=\"flex-1\">\n                      <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Update Status</Label>\n                      <Select\n                        value={selectedTicket.status}\n                        onValueChange={(value) => handleUpdateTicketStatus(selectedTicket.id, value)}\n                      >\n                        <SelectTrigger className=\"rounded-xl font-verdana border-2\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"open\">Open</SelectItem>\n                          <SelectItem value=\"in_progress\">In Progress</SelectItem>\n                          <SelectItem value=\"resolved\">Resolved</SelectItem>\n                          <SelectItem value=\"closed\">Closed</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div className=\"flex-1\">\n                      <Label className=\"font-fredoka font-semibold text-graphite block mb-2\">Update Priority</Label>\n                      <Select\n                        value={selectedTicket.priority}\n                        onValueChange={(value) => handleUpdateTicketPriority(selectedTicket.id, value)}\n                      >\n                        <SelectTrigger className=\"rounded-xl font-verdana border-2\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"low\">Low</SelectItem>\n                          <SelectItem value=\"medium\">Medium</SelectItem>\n                          <SelectItem value=\"high\">High</SelectItem>\n                          <SelectItem value=\"urgent\">Urgent</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n\n          <div className=\"flex justify-end pt-4 border-t-2 border-gray-200\">\n            <Button\n              onClick={() => setShowDetailsModal(false)}\n              variant=\"outline\"\n              className=\"rounded-xl font-fredoka font-semibold\"\n            >\n              Close\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\SystemAlerts.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardHeader' is defined but never used.","line":4,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"fix":{"range":[174,186],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardHeader"},"fix":{"range":[173,185],"text":""},"desc":"Remove unused variable 'CardHeader'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'CardTitle' is defined but never used.","line":4,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":50,"fix":{"range":[185,196],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"CardTitle"},"fix":{"range":[185,196],"text":""},"desc":"Remove unused variable 'CardTitle'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Alert' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":15,"fix":{"range":[332,339],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Alert"},"fix":{"range":[333,339],"text":""},"desc":"Remove unused variable 'Alert'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'AlertDescription' is defined but never used.","line":7,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":33,"fix":{"range":[338,356],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"AlertDescription"},"fix":{"range":[338,356],"text":""},"desc":"Remove unused variable 'AlertDescription'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'XCircle' is defined but never used.","line":8,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"fix":{"range":[425,434],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"XCircle"},"fix":{"range":[424,433],"text":""},"desc":"Remove unused variable 'XCircle'."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":5,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { AlertTriangle, CheckCircle, XCircle, Clock, Loader2 } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function SystemAlerts() {\n  const [loading, setLoading] = useState(true);\n  const [alerts, setAlerts] = useState([]);\n  const [filter, setFilter] = useState('active'); // active, resolved, all\n\n  useEffect(() => {\n    loadAlerts();\n  }, [filter]);\n\n  const loadAlerts = async () => {\n    setLoading(true);\n    try {\n      let alertsList;\n      if (filter === 'active') {\n        alertsList = await base44.entities.SystemAlert.filter({ is_resolved: false });\n      } else if (filter === 'resolved') {\n        alertsList = await base44.entities.SystemAlert.filter({ is_resolved: true });\n      } else {\n        alertsList = await base44.entities.SystemAlert.list('-created_date', 50);\n      }\n      \n      setAlerts(alertsList);\n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading alerts:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const handleResolve = async (alertId) => {\n    try {\n      await base44.entities.SystemAlert.update(alertId, {\n        is_resolved: true,\n        resolved_at: new Date().toISOString()\n      });\n      loadAlerts();\n    } catch (error) {\n      handleError(error, { userMessage: 'Error resolving alert:', showToast: false });\n    }\n  };\n\n  const getSeverityColor = (severity) => {\n    switch (severity) {\n      case 'critical': return 'bg-red-100 text-red-800 border-red-500';\n      case 'high': return 'bg-amber-100 text-amber-800 border-amber-500';\n      case 'medium': return 'bg-yellow-100 text-yellow-800 border-yellow-500';\n      default: return 'bg-blue-100 text-blue-800 border-blue-500';\n    }\n  };\n\n  const getSeverityIcon = (severity) => {\n    switch (severity) {\n      case 'critical':\n      case 'high':\n        return <AlertTriangle className=\"w-5 h-5\" />;\n      default:\n        return <Clock className=\"w-5 h-5\" />;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-6xl mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">System Alerts</h1>\n            <p className=\"text-gray-600 font-verdana mt-2\">Anomaly detection & operational alerts</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant={filter === 'active' ? 'default' : 'outline'}\n              onClick={() => setFilter('active')}\n              className=\"font-fredoka\"\n            >\n              Active ({alerts.filter(a => !a.is_resolved).length})\n            </Button>\n            <Button\n              variant={filter === 'resolved' ? 'default' : 'outline'}\n              onClick={() => setFilter('resolved')}\n              className=\"font-fredoka\"\n            >\n              Resolved\n            </Button>\n            <Button\n              variant={filter === 'all' ? 'default' : 'outline'}\n              onClick={() => setFilter('all')}\n              className=\"font-fredoka\"\n            >\n              All\n            </Button>\n          </div>\n        </div>\n\n        {/* Alerts List */}\n        {loading ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <Loader2 className=\"w-8 h-8 animate-spin text-puretask-blue\" />\n          </div>\n        ) : alerts.length > 0 ? (\n          <div className=\"space-y-4\">\n            {alerts.map((alert, idx) => (\n              <motion.div\n                key={alert.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: idx * 0.05 }}\n              >\n                <Card className={`border-2 ${alert.is_resolved ? 'bg-gray-50' : getSeverityColor(alert.severity)}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex items-start gap-3 flex-1\">\n                        {getSeverityIcon(alert.severity)}\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <h3 className=\"font-fredoka font-bold text-lg text-graphite\">\n                              {alert.type.replace(/_/g, ' ').toUpperCase()}\n                            </h3>\n                            <Badge className={`font-fredoka text-xs ${getSeverityColor(alert.severity)}`}>\n                              {alert.severity}\n                            </Badge>\n                            {alert.is_resolved && (\n                              <Badge className=\"bg-green-100 text-green-800 font-fredoka text-xs\">\n                                <CheckCircle className=\"w-3 h-3 mr-1\" />\n                                Resolved\n                              </Badge>\n                            )}\n                          </div>\n                          <p className=\"font-verdana text-gray-700 mb-3\">{alert.message}</p>\n                          {alert.metadata && (\n                            <div className=\"bg-white/50 rounded-lg p-3 text-xs font-verdana text-gray-600\">\n                              <div className=\"grid grid-cols-2 gap-2\">\n                                {Object.entries(alert.metadata).map(([key, value]) => (\n                                  <div key={key}>\n                                    <span className=\"font-semibold\">{key}:</span> {JSON.stringify(value)}\n                                  </div>\n                                ))}\n                              </div>\n                            </div>\n                          )}\n                          <p className=\"text-xs text-gray-500 font-verdana mt-2\">\n                            Created: {new Date(alert.created_date).toLocaleString()}\n                            {alert.resolved_at && ` ‚Ä¢ Resolved: ${new Date(alert.resolved_at).toLocaleString()}`}\n                          </p>\n                        </div>\n                      </div>\n                      {!alert.is_resolved && (\n                        <Button\n                          onClick={() => handleResolve(alert.id)}\n                          className=\"bg-green-600 hover:bg-green-700 text-white font-fredoka\"\n                        >\n                          <CheckCircle className=\"w-4 h-4 mr-2\" />\n                          Resolve\n                        </Button>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <Card>\n            <CardContent className=\"py-12 text-center\">\n              <CheckCircle className=\"w-16 h-16 text-green-500 mx-auto mb-4\" />\n              <p className=\"text-xl font-fredoka font-bold text-graphite\">All Clear!</p>\n              <p className=\"text-gray-600 font-verdana mt-2\">No {filter} alerts at the moment</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\TemplateReference.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\TermsOfService.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\TrustSafetyDashboard.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Badge' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"fix":{"range":[359,406],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Badge"},"fix":{"range":[359,405],"text":""},"desc":"Remove unused variable 'Badge'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'FileText' is defined but never used.","line":9,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":47,"fix":{"range":[443,453],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"FileText"},"fix":{"range":[442,452],"text":""},"desc":"Remove unused variable 'FileText'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { handleError } from '@/lib/errorHandler';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { base44 } from '@/api/base44Client';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Shield, Flag, AlertTriangle, FileText, BarChart3, Loader2, ArrowRight } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function TrustSafetyDashboard() {\n  const [loading, setLoading] = useState(true);\n  const [summary, setSummary] = useState({});\n\n  useEffect(() => {\n    loadSummary();\n  }, []);\n\n  const loadSummary = async () => {\n    try {\n      const [profiles, flags, incidents, actionLogs] = await Promise.all([\n        base44.entities.RiskProfile.list(),\n        base44.entities.RiskFlag.filter({ status: 'open' }),\n        base44.entities.SafetyIncident.filter({ status: 'open' }),\n        base44.entities.RiskActionLog.list('-created_date', 10)\n      ]);\n      \n      setSummary({\n        totalProfiles: profiles.length,\n        normalUsers: profiles.filter(p => p.risk_tier === 'normal').length,\n        watchList: profiles.filter(p => p.risk_tier === 'watch').length,\n        restricted: profiles.filter(p => p.risk_tier === 'restricted').length,\n        blocked: profiles.filter(p => p.risk_tier === 'blocked').length,\n        openFlags: flags.length,\n        criticalFlags: flags.filter(f => f.severity === 'critical').length,\n        openIncidents: incidents.length,\n        criticalIncidents: incidents.filter(i => i.severity === 'critical').length,\n        recentActions: actionLogs.length\n      });\n      \n      setLoading(false);\n    } catch (error) {\n      handleError(error, { userMessage: 'Error loading summary:', showToast: false });\n      setLoading(false);\n    }\n  };\n\n  const modules = [\n    {\n      title: 'Risk Management',\n      description: 'Monitor user risk profiles, scores, and enforcement tiers',\n      icon: Shield,\n      color: '#66B3FF',\n      path: 'AdminRiskManagement',\n      stats: [\n        { label: 'Watch List', value: summary.watchList || 0, color: 'text-yellow-600' },\n        { label: 'Restricted', value: summary.restricted || 0, color: 'text-amber-600' },\n        { label: 'Blocked', value: summary.blocked || 0, color: 'text-red-600' }\n      ]\n    },\n    {\n      title: 'Risk Flags',\n      description: 'Review automated fraud detection and abuse pattern alerts',\n      icon: Flag,\n      color: '#FF9F43',\n      path: 'AdminRiskFlags',\n      stats: [\n        { label: 'Open Flags', value: summary.openFlags || 0, color: 'text-amber-600' },\n        { label: 'Critical', value: summary.criticalFlags || 0, color: 'text-red-600' }\n      ]\n    },\n    {\n      title: 'Safety Incidents',\n      description: 'Handle safety reports, harassment, theft, and dangerous situations',\n      icon: AlertTriangle,\n      color: '#EA5455',\n      path: 'AdminSafetyIncidents',\n      stats: [\n        { label: 'Open Cases', value: summary.openIncidents || 0, color: 'text-red-600' },\n        { label: 'Critical', value: summary.criticalIncidents || 0, color: 'text-red-800' }\n      ]\n    }\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-soft-cloud flex items-center justify-center\">\n        <Loader2 className=\"w-12 h-12 animate-spin text-puretask-blue\" />\n      </div>\n    );\n  }\n\n  const totalHighRisk = (summary.restricted || 0) + (summary.blocked || 0);\n  const highRiskRate = summary.totalProfiles > 0 ? \n    (totalHighRisk / summary.totalProfiles) * 100 : 0;\n\n  return (\n    <div className=\"min-h-screen bg-soft-cloud p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-4xl font-fredoka font-bold text-graphite\">Trust & Safety Hub</h1>\n          <p className=\"text-gray-600 font-verdana mt-2\">\n            Fraud prevention, risk management & safety monitoring\n          </p>\n        </div>\n\n        {/* Alert Banner */}\n        {(summary.criticalFlags > 0 || summary.criticalIncidents > 0) && (\n          <Card className=\"border-2 border-red-500 bg-red-50\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-3\">\n                <AlertTriangle className=\"w-8 h-8 text-red-600\" />\n                <div>\n                  <p className=\"font-fredoka font-bold text-lg text-graphite\">\n                    Critical Issues Require Attention\n                  </p>\n                  <p className=\"text-sm text-gray-600 font-verdana\">\n                    {summary.criticalFlags} critical flags ‚Ä¢ {summary.criticalIncidents} critical incidents\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Platform Health Summary */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl\">Platform Trust Score</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-4 gap-6\">\n              <div className=\"text-center p-4 bg-green-50 rounded-xl\">\n                <p className=\"text-4xl font-fredoka font-bold text-fresh-mint\">\n                  {((summary.normalUsers || 0) / (summary.totalProfiles || 1) * 100).toFixed(1)}%\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Normal Users</p>\n              </div>\n              <div className=\"text-center p-4 bg-yellow-50 rounded-xl\">\n                <p className=\"text-4xl font-fredoka font-bold text-yellow-600\">\n                  {summary.watchList || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Watch List</p>\n              </div>\n              <div className=\"text-center p-4 bg-red-50 rounded-xl\">\n                <p className=\"text-4xl font-fredoka font-bold text-red-600\">\n                  {highRiskRate.toFixed(1)}%\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">High Risk Rate</p>\n              </div>\n              <div className=\"text-center p-4 bg-blue-50 rounded-xl\">\n                <p className=\"text-4xl font-fredoka font-bold text-puretask-blue\">\n                  {summary.recentActions || 0}\n                </p>\n                <p className=\"text-sm text-gray-600 font-verdana mt-1\">Recent Actions</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Module Cards */}\n        <div className=\"grid md:grid-cols-3 gap-6\">\n          {modules.map((module, idx) => (\n            <motion.div\n              key={module.path}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: idx * 0.1 }}\n            >\n              <Link to={createPageUrl(module.path)}>\n                <Card className=\"border-2 hover:shadow-xl transition-all cursor-pointer h-full\" style={{ borderColor: module.color }}>\n                  <CardHeader>\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center\" style={{ backgroundColor: module.color }}>\n                        <module.icon className=\"w-6 h-6 text-white\" />\n                      </div>\n                      <CardTitle className=\"font-fredoka text-xl\">{module.title}</CardTitle>\n                    </div>\n                    <p className=\"text-sm text-gray-600 font-verdana\">{module.description}</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2 mb-4\">\n                      {module.stats.map((stat, i) => (\n                        <div key={i} className=\"flex justify-between items-center p-2 bg-gray-50 rounded-lg\">\n                          <span className=\"text-sm font-verdana text-gray-600\">{stat.label}</span>\n                          <span className={`text-lg font-fredoka font-bold ${stat.color}`}>\n                            {stat.value}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                    <Button className=\"w-full font-fredoka\" style={{ backgroundColor: module.color }}>\n                      Open Module\n                      <ArrowRight className=\"w-4 h-4 ml-2\" />\n                    </Button>\n                  </CardContent>\n                </Card>\n              </Link>\n            </motion.div>\n          ))}\n        </div>\n\n        {/* System Status */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"font-fredoka text-xl flex items-center gap-2\">\n              <BarChart3 className=\"w-5 h-5 text-puretask-blue\" />\n              Trust & Safety Engine Status\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-3 gap-4\">\n              <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Real-time Monitoring</p>\n                <p className=\"text-xl font-fredoka font-bold text-green-700\">Active ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Event-driven risk detection</p>\n              </div>\n              <div className=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Nightly Risk Scan</p>\n                <p className=\"text-xl font-fredoka font-bold text-blue-700\">Scheduled ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Risk decay & recalculation</p>\n              </div>\n              <div className=\"p-4 bg-purple-50 rounded-lg border border-purple-200\">\n                <p className=\"text-sm font-verdana text-gray-600 mb-1\">Safety Escalation</p>\n                <p className=\"text-xl font-fredoka font-bold text-purple-700\">Automated ‚úì</p>\n                <p className=\"text-xs text-gray-500 font-verdana mt-1\">Critical incidents auto-escalate</p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\WhyPureTask.jsx","messages":[{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Award' is defined but never used.","line":9,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":21,"fix":{"range":[337,344],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Award"},"fix":{"range":[336,343],"text":""},"desc":"Remove unused variable 'Award'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Zap' is defined but never used.","line":9,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"fix":{"range":[344,349],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Zap"},"fix":{"range":[343,348],"text":""},"desc":"Remove unused variable 'Zap'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Target' is defined but never used.","line":9,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":34,"fix":{"range":[349,357],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Target"},"fix":{"range":[348,356],"text":""},"desc":"Remove unused variable 'Target'."}]},{"ruleId":"unused-imports/no-unused-imports","severity":2,"message":"'Heart' is defined but never used.","line":9,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":41,"fix":{"range":[357,364],"text":""},"suggestions":[{"messageId":"removeVar","data":{"varName":"Heart"},"fix":{"range":[356,363],"text":""},"desc":"Remove unused variable 'Heart'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":4,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { createPageUrl } from '@/utils';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport {\n  Shield, TrendingUp, Camera, MapPin, Star, Users,\n  CheckCircle, Award, Zap, Target, Heart, Sparkles\n} from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function WhyPureTask() {\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100\">\n      {/* Hero */}\n      <section className=\"relative overflow-hidden bg-gradient-to-r from-indigo-500 to-purple-600 text-white py-20\">\n        <div className=\"container mx-auto px-6 relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-4xl mx-auto text-center\"\n          >\n            <h1 className=\"text-5xl lg:text-6xl font-bold mb-6\">\n              Why Choose PureTask?\n            </h1>\n            <p className=\"text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-indigo-50\">\n              The only cleaning platform built on trust, transparency, and real accountability\n            </p>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Core Differentiators */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-6xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-4 text-center\">\n              What Makes Us Different\n            </h2>\n            <p className=\"text-xl text-slate-600 text-center mb-16\">\n              Most platforms say they're trustworthy. We prove it.\n            </p>\n\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              {[\n                {\n                  icon: Shield,\n                  title: 'Full Verification',\n                  description: 'KYC + background checks + ID verification for every cleaner',\n                  stat: '100%',\n                  color: 'emerald'\n                },\n                {\n                  icon: MapPin,\n                  title: 'GPS Tracking',\n                  description: 'Real-time check-in/out proves arrival and completion times',\n                  stat: 'Every job',\n                  color: 'blue'\n                },\n                {\n                  icon: Camera,\n                  title: 'Photo Proof',\n                  description: 'Before/after photos document the work‚Äîno guessing',\n                  stat: '95%+ compliance',\n                  color: 'purple'\n                },\n                {\n                  icon: TrendingUp,\n                  title: 'Merit-Based Scoring',\n                  description: 'Reliability Score based on real performance, not manipulated reviews',\n                  stat: 'Live updates',\n                  color: 'amber'\n                }\n              ].map((feature, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: idx * 0.1 }}\n                >\n                  <Card className=\"h-full border-0 shadow-lg text-center\">\n                    <CardContent className=\"p-6\">\n                      <div className={`w-14 h-14 bg-gradient-to-r from-${feature.color}-500 to-${feature.color}-600 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg`}>\n                        <feature.icon className=\"w-7 h-7 text-white\" />\n                      </div>\n                      <h3 className=\"text-lg font-bold text-slate-900 mb-2\">{feature.title}</h3>\n                      <p className=\"text-sm text-slate-600 mb-3\">{feature.description}</p>\n                      <Badge variant=\"outline\" className=\"font-semibold\">\n                        {feature.stat}\n                      </Badge>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Comparison */}\n      <section className=\"py-20 bg-gradient-to-br from-slate-50 to-slate-100\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-6xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-16 text-center\">\n              PureTask vs Traditional Services\n            </h2>\n\n            <div className=\"grid md:grid-cols-2 gap-8\">\n              <Card className=\"border-2 border-slate-200\">\n                <CardContent className=\"p-8\">\n                  <h3 className=\"text-2xl font-bold text-slate-900 mb-6\">‚ùå Traditional Platforms</h3>\n                  <ul className=\"space-y-4\">\n                    {[\n                      'Ratings can be fake or bought',\n                      'No proof cleaners actually showed up',\n                      'No accountability for quality',\n                      'Pay upfront and hope for the best',\n                      'No way to verify background checks',\n                      'Limited recourse if something goes wrong'\n                    ].map((item, idx) => (\n                      <li key={idx} className=\"flex items-start gap-3\">\n                        <div className=\"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0\"></div>\n                        <span className=\"text-slate-600\">{item}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-2 border-emerald-400 bg-gradient-to-br from-emerald-50 to-green-50\">\n                <CardContent className=\"p-8\">\n                  <h3 className=\"text-2xl font-bold text-emerald-900 mb-6\">‚úÖ PureTask Platform</h3>\n                  <ul className=\"space-y-4\">\n                    {[\n                      'Reliability Score based on real performance data',\n                      'GPS check-in/out for every job',\n                      'Before/after photo proof',\n                      'Payment released only after work verified',\n                      'Full background check & ID verification',\n                      'Automatic credits + fast dispute resolution'\n                    ].map((item, idx) => (\n                      <li key={idx} className=\"flex items-start gap-3\">\n                        <CheckCircle className=\"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5\" />\n                        <span className=\"text-slate-700 font-medium\">{item}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Trust Indicators */}\n      <section className=\"py-20 bg-white\">\n        <div className=\"container mx-auto px-6\">\n          <div className=\"max-w-5xl mx-auto\">\n            <h2 className=\"text-4xl font-bold text-slate-900 mb-16 text-center\">\n              Trusted by Thousands\n            </h2>\n\n            <div className=\"grid md:grid-cols-3 gap-8 mb-16\">\n              {[\n                { icon: Users, number: '500+', label: 'Verified Cleaners' },\n                { icon: Sparkles, number: '10k+', label: 'Cleanings Completed' },\n                { icon: Star, number: '4.9‚òÖ', label: 'Average Rating' }\n              ].map((stat, idx) => (\n                <motion.div\n                  key={idx}\n                  initial={{ opacity: 0, scale: 0.9 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  transition={{ delay: idx * 0.1 }}\n                  className=\"text-center\"\n                >\n                  <div className=\"w-20 h-20 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg\">\n                    <stat.icon className=\"w-10 h-10 text-white\" />\n                  </div>\n                  <p className=\"text-5xl font-bold text-slate-900 mb-2\">{stat.number}</p>\n                  <p className=\"text-slate-600\">{stat.label}</p>\n                </motion.div>\n              ))}\n            </div>\n\n            <div className=\"grid md:grid-cols-3 gap-6\">\n              {[\n                {\n                  quote: 'GPS tracking gives me complete peace of mind.',\n                  name: 'Sarah M.',\n                  role: 'Sacramento'\n                },\n                {\n                  quote: 'The reliability score makes choosing so much easier.',\n                  name: 'David L.',\n                  role: 'Elk Grove'\n                },\n                {\n                  quote: 'Photo proof means I never have to wonder if it was done right.',\n                  name: 'Jennifer K.',\n                  role: 'Roseville'\n                }\n              ].map((testimonial, idx) => (\n                <Card key={idx} className=\"border-0 shadow-md\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex mb-3\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star key={i} className=\"w-4 h-4 fill-amber-400 text-amber-400\" />\n                      ))}\n                    </div>\n                    <p className=\"text-slate-700 italic mb-4\">\"{testimonial.quote}\"</p>\n                    <p className=\"text-sm font-semibold text-slate-900\">{testimonial.name}</p>\n                    <p className=\"text-xs text-slate-500\">{testimonial.role}</p>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA */}\n      <section className=\"py-20 bg-gradient-to-r from-indigo-500 to-purple-600 text-white\">\n        <div className=\"container mx-auto px-6 text-center\">\n          <h2 className=\"text-4xl font-bold mb-6\">\n            Experience the PureTask Difference\n          </h2>\n          <p className=\"text-xl text-indigo-50 mb-10 max-w-2xl mx-auto\">\n            Join thousands who've discovered stress-free, transparent cleaning\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <Link to={createPageUrl('BrowseCleaners')}>\n              <Button size=\"lg\" className=\"bg-white text-indigo-600 hover:bg-indigo-50 shadow-xl text-lg px-10 py-7\">\n                Browse Cleaners\n              </Button>\n            </Link>\n            <Link to={createPageUrl('HowItWorks')}>\n              <Button size=\"lg\" className=\"bg-indigo-700 hover:bg-indigo-800 text-white border-2 border-white shadow-xl text-lg px-10 py-7\">\n                See How It Works\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\pages\\index.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\aiCleanerChatService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":5,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// AI Chat Assistant Service\r\n// Context-aware AI helper for cleaners using Base44 LLM integration\r\n\r\nimport { base44 } from '@/api/base44Client';\r\nimport type { JobRecord } from '@/types/cleanerJobTypes';\r\n\r\nexport interface ChatMessage {\r\n  id: string;\r\n  role: 'user' | 'assistant' | 'system';\r\n  content: string;\r\n  timestamp: Date;\r\n  context?: {\r\n    jobId?: string;\r\n    jobState?: string;\r\n    suggestedActions?: string[];\r\n  };\r\n}\r\n\r\nexport interface CleanerContext {\r\n  cleanerId: string;\r\n  cleanerEmail: string;\r\n  currentJob?: JobRecord;\r\n  stats?: {\r\n    totalJobs: number;\r\n    reliabilityScore: number;\r\n    avgRating: number;\r\n    totalEarnings: number;\r\n  };\r\n}\r\n\r\nexport class AICleanerChatService {\r\n  \r\n  // Generate system prompt based on cleaner context\r\n  private buildSystemPrompt(context: CleanerContext): string {\r\n    const job = context.currentJob;\r\n    const stats = context.stats;\r\n    \r\n    let prompt = `You are PureTask AI Assistant, a helpful and friendly AI that helps professional cleaners succeed on the platform.\r\n\r\nYour role:\r\n- Help cleaners understand job requirements\r\n- Provide guidance on the job workflow\r\n- Answer questions about payments, policies, and best practices\r\n- Give personalized tips to improve reliability and earnings\r\n- Suggest optimal scheduling and route planning\r\n\r\nImportant guidelines:\r\n- Be concise and actionable\r\n- Use encouraging, supportive tone\r\n- Reference specific job details when relevant\r\n- Suggest practical next steps\r\n- Focus on helping the cleaner succeed\r\n\r\nCurrent cleaner profile:`;\r\n\r\n    if (stats) {\r\n      prompt += `\r\n- Total jobs completed: ${stats.totalJobs}\r\n- Reliability score: ${stats.reliabilityScore}%\r\n- Average rating: ${stats.avgRating}/5.0\r\n- Total earnings: $${stats.totalEarnings.toFixed(2)}`;\r\n    }\r\n\r\n    if (job) {\r\n      prompt += `\r\n\r\nCurrent job context:\r\n- Job ID: ${job.id}\r\n- State: ${job.state}\r\n- Address: ${job.address}\r\n- Date: ${job.date} at ${job.time}\r\n- Duration: ${job.duration_hours} hours\r\n- Cleaning type: ${job.cleaning_type}\r\n- Bedrooms: ${job.bedrooms}, Bathrooms: ${job.bathrooms}`;\r\n\r\n      if (job.state === 'ASSIGNED') {\r\n        prompt += `\\n- Next action: Mark en route when heading to the job`;\r\n      } else if (job.state === 'EN_ROUTE') {\r\n        prompt += `\\n- Next action: Check in when within 250m of the address`;\r\n      } else if (job.state === 'ARRIVED') {\r\n        prompt += `\\n- Next action: Start the job to begin timer`;\r\n      } else if (job.state === 'IN_PROGRESS') {\r\n        if (job.start_at) {\r\n          const start = new Date(job.start_at);\r\n          const now = new Date();\r\n          const elapsed = Math.floor((now.getTime() - start.getTime()) / (1000 * 60));\r\n          prompt += `\\n- Job in progress: ${elapsed} minutes elapsed`;\r\n        }\r\n        prompt += `\\n- Before photos: ${job.before_photos_count || 0}/3`;\r\n        prompt += `\\n- After photos: ${job.after_photos_count || 0}/3`;\r\n        prompt += `\\n- Next action: Upload photos and complete job when done`;\r\n      } else if (job.state === 'AWAITING_CLIENT_REVIEW') {\r\n        prompt += `\\n- Status: Waiting for client to approve and release payment`;\r\n      }\r\n    }\r\n\r\n    prompt += `\\n\\nRespond helpfully and concisely. If the cleaner needs to take an action, guide them clearly.`;\r\n\r\n    return prompt;\r\n  }\r\n\r\n  // Get contextual quick actions based on job state\r\n  getQuickActions(job?: JobRecord): Array<{ label: string; question: string }> {\r\n    if (!job) {\r\n      return [\r\n        { label: 'üìç How do job offers work?', question: 'How do I receive and accept job offers?' },\r\n        { label: 'üí∞ How do I get paid?', question: 'Explain the payment process and timeline' },\r\n        { label: '‚≠ê What affects my reliability score?', question: 'What factors affect my reliability score?' },\r\n        { label: 'üìÖ How should I manage my schedule?', question: 'Give me tips for managing my cleaning schedule' }\r\n      ];\r\n    }\r\n\r\n    const state = job.state;\r\n    \r\n    if (state === 'ASSIGNED') {\r\n      return [\r\n        { label: 'üó∫Ô∏è How to mark en route?', question: 'How do I mark that I\\'m on my way to the job?' },\r\n        { label: 'üìç What if I\\'m running late?', question: 'What should I do if I\\'m running late to the job?' },\r\n        { label: 'üöó Best route planning?', question: 'What\\'s the best way to plan my route to the job?' },\r\n        { label: '‚ùå Need to cancel?', question: 'How do I cancel this job if needed?' }\r\n      ];\r\n    }\r\n\r\n    if (state === 'EN_ROUTE') {\r\n      return [\r\n        { label: 'üìç GPS check-in help', question: 'How does GPS check-in work?' },\r\n        { label: '‚ùì What\\'s the 250m requirement?', question: 'Why do I need to be within 250 meters?' },\r\n        { label: 'üîß GPS not working?', question: 'My GPS isn\\'t working, what should I do?' },\r\n        { label: 'üè† Arrived early?', question: 'I arrived early, what should I do?' }\r\n      ];\r\n    }\r\n\r\n    if (state === 'ARRIVED' || state === 'IN_PROGRESS') {\r\n      return [\r\n        { label: 'üì∏ Photo requirements?', question: 'What photos do I need to take and why?' },\r\n        { label: '‚è±Ô∏è Need more time?', question: 'How do I request extra time for this job?' },\r\n        { label: 'üßπ What cleaning tasks?', question: 'What tasks should I focus on for this job type?' },\r\n        { label: '‚ùì Client not home?', question: 'The client isn\\'t home, what should I do?' }\r\n      ];\r\n    }\r\n\r\n    if (state === 'AWAITING_CLIENT_REVIEW') {\r\n      return [\r\n        { label: '‚è∞ How long for approval?', question: 'How long does client approval usually take?' },\r\n        { label: 'üí∞ When do I get paid?', question: 'When will I receive payment for this job?' },\r\n        { label: '‚≠ê What if low rating?', question: 'What happens if the client gives a low rating?' },\r\n        { label: 'üîÑ Next job tips?', question: 'What should I do while waiting for approval?' }\r\n      ];\r\n    }\r\n\r\n    return [\r\n      { label: '‚ùì General help', question: 'I have a general question about this job' },\r\n      { label: 'üí° Tips for this job', question: 'Give me tips for completing this job successfully' },\r\n      { label: 'üìû Contact support?', question: 'How do I contact support if I need help?' }\r\n    ];\r\n  }\r\n\r\n  // Get AI response\r\n  async chat(\r\n    messages: ChatMessage[],\r\n    context: CleanerContext\r\n  ): Promise<string> {\r\n    try {\r\n      // Build conversation history\r\n      const conversationHistory = messages.map(msg => ({\r\n        role: msg.role,\r\n        content: msg.content\r\n      }));\r\n\r\n      // Add system prompt at the beginning\r\n      const systemPrompt = this.buildSystemPrompt(context);\r\n      \r\n      const fullConversation = [\r\n        { role: 'system', content: systemPrompt },\r\n        ...conversationHistory\r\n      ];\r\n\r\n      // Call Base44 LLM integration\r\n      const response = await base44.integrations.Core.InvokeLLM({\r\n        model: 'gpt-4',\r\n        messages: fullConversation,\r\n        temperature: 0.7,\r\n        max_tokens: 500\r\n      });\r\n\r\n      return response.choices[0].message.content;\r\n    } catch (error) {\r\n      console.error('AI chat error:', error);\r\n      return 'I\\'m having trouble connecting right now. Please try again or contact support if you need immediate help.';\r\n    }\r\n  }\r\n\r\n  // Get job-specific tips\r\n  async getJobTips(job: JobRecord, context: CleanerContext): Promise<string> {\r\n    const prompt = `Based on this job (${job.cleaning_type} cleaning, ${job.bedrooms}BR/${job.bathrooms}BA, ${job.duration_hours}hrs), give me 3 specific tips to complete it successfully and efficiently.`;\r\n    \r\n    const messages: ChatMessage[] = [\r\n      {\r\n        id: '1',\r\n        role: 'user',\r\n        content: prompt,\r\n        timestamp: new Date()\r\n      }\r\n    ];\r\n\r\n    return await this.chat(messages, context);\r\n  }\r\n\r\n  // Get earnings optimization suggestions\r\n  async getEarningsOptimization(context: CleanerContext): Promise<string> {\r\n    const prompt = `Based on my stats (${context.stats?.totalJobs} jobs, ${context.stats?.reliabilityScore}% reliability, $${context.stats?.totalEarnings} earned), what are 3 specific ways I can increase my earnings on PureTask?`;\r\n    \r\n    const messages: ChatMessage[] = [\r\n      {\r\n        id: '1',\r\n        role: 'user',\r\n        content: prompt,\r\n        timestamp: new Date()\r\n      }\r\n    ];\r\n\r\n    return await this.chat(messages, context);\r\n  }\r\n\r\n  // Get schedule recommendations\r\n  async getScheduleRecommendations(context: CleanerContext): Promise<string> {\r\n    const prompt = `Based on my performance (${context.stats?.reliabilityScore}% reliability), suggest optimal times and strategies for accepting jobs to maximize my earnings and work-life balance.`;\r\n    \r\n    const messages: ChatMessage[] = [\r\n      {\r\n        id: '1',\r\n        role: 'user',\r\n        content: prompt,\r\n        timestamp: new Date()\r\n      }\r\n    ];\r\n\r\n    return await this.chat(messages, context);\r\n  }\r\n\r\n  // Analyze job offer and recommend acceptance\r\n  async analyzeJobOffer(job: JobRecord, context: CleanerContext): Promise<{\r\n    recommendation: 'accept' | 'consider' | 'pass';\r\n    reasons: string[];\r\n    estimatedEarnings: number;\r\n    estimatedTime: number;\r\n  }> {\r\n    const baseRate = 40; // $40/hour (TODO: get from pricing)\r\n    const estimatedEarnings = job.duration_hours * baseRate * 0.8; // 80% payout\r\n    \r\n    const reasons: string[] = [];\r\n    let recommendation: 'accept' | 'consider' | 'pass' = 'consider';\r\n\r\n    // Factors to consider\r\n    const isHighPaying = estimatedEarnings > 80;\r\n    const isNearby = true; // TODO: calculate distance from cleaner's location\r\n    const isGoodTiming = true; // TODO: check against cleaner's schedule\r\n    const matchesExpertise = job.cleaning_type === 'basic'; // TODO: check cleaner's specialty\r\n\r\n    if (isHighPaying) {\r\n      reasons.push('üí∞ High earnings potential');\r\n    }\r\n    \r\n    if (isNearby) {\r\n      reasons.push('üìç Close to your location');\r\n    }\r\n    \r\n    if (isGoodTiming) {\r\n      reasons.push('‚è∞ Fits your schedule well');\r\n    }\r\n    \r\n    if (matchesExpertise) {\r\n      reasons.push('‚≠ê Matches your expertise');\r\n    }\r\n\r\n    // Decision logic\r\n    if (reasons.length >= 3) {\r\n      recommendation = 'accept';\r\n    } else if (reasons.length >= 2) {\r\n      recommendation = 'consider';\r\n    } else {\r\n      recommendation = 'pass';\r\n      reasons.push('‚ö†Ô∏è May not be optimal for your schedule');\r\n    }\r\n\r\n    return {\r\n      recommendation,\r\n      reasons,\r\n      estimatedEarnings,\r\n      estimatedTime: job.duration_hours * 60\r\n    };\r\n  }\r\n\r\n  // Get FAQ answer\r\n  async getFAQAnswer(question: string): Promise<string> {\r\n    const faqMap: Record<string, string> = {\r\n      'payment': 'You get paid 18 hours after client approval. Earnings are automatically deposited to your account. Instant cash-out is available for a 10% fee.',\r\n      'reliability': 'Your reliability score is based on: accepting jobs (20%), showing up on time (30%), completing jobs (30%), and client ratings (20%). Maintain 90%+ for Gold tier.',\r\n      'photos': 'You must take 3 before and 3 after photos. This protects both you and the client by documenting the work completed. Photos are required to complete the job.',\r\n      'gps': 'GPS check-in proves you\\'re at the correct location (within 250 meters). This prevents fraud and builds trust. Make sure location services are enabled.',\r\n      'cancel': 'You can cancel up to 4 hours before the job. Late cancellations hurt your reliability score. Contact support for emergencies.',\r\n      'dispute': 'If there\\'s an issue, document everything with photos and notes. Contact support within 24 hours. Most disputes are resolved in 2-3 business days.'\r\n    };\r\n\r\n    const lowerQuestion = question.toLowerCase();\r\n    \r\n    for (const [key, answer] of Object.entries(faqMap)) {\r\n      if (lowerQuestion.includes(key)) {\r\n        return answer;\r\n      }\r\n    }\r\n\r\n    // Fall back to AI for unknown questions\r\n    const messages: ChatMessage[] = [\r\n      {\r\n        id: '1',\r\n        role: 'user',\r\n        content: question,\r\n        timestamp: new Date()\r\n      }\r\n    ];\r\n\r\n    return await this.chat(messages, {\r\n      cleanerId: '',\r\n      cleanerEmail: ''\r\n    });\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const aiCleanerChatService = new AICleanerChatService();\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\cleanerJobsService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":5,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Cleaner Jobs Service - Orchestration Layer\r\n// Handles job state transitions, validation, and side effects\r\n\r\nimport { base44 } from '@/api/base44Client';\r\nimport type { JobRecord, JobState, JobSubState } from '@/types/cleanerJobTypes';\r\nimport {\r\n  canTransition,\r\n  calculateWorkedMinutes,\r\n  calculateBillableMinutes,\r\n  isLocationNearJob\r\n} from '@/types/cleanerJobTypes';\r\nimport { jobEventBus } from './jobEvents';\r\n\r\nexport class CleanerJobsService {\r\n  \r\n  // Get all jobs for a specific cleaner\r\n  async getCleanerJobs(cleanerEmail: string): Promise<JobRecord[]> {\r\n    try {\r\n      const jobs = await base44.entities.Job.filter({\r\n        assigned_cleaner_email: cleanerEmail\r\n      });\r\n      \r\n      return jobs as unknown as JobRecord[];\r\n    } catch (error) {\r\n      console.error('Error fetching cleaner jobs:', error);\r\n      return [];\r\n    }\r\n  }\r\n  \r\n  // Get single job with validation\r\n  async getJob(jobId: string, cleanerEmail: string): Promise<JobRecord | null> {\r\n    try {\r\n      const job = await base44.entities.Job.getOne(jobId);\r\n      \r\n      if (!job) return null;\r\n      \r\n      // Ensure this cleaner is assigned to this job\r\n      if (job.assigned_cleaner_email !== cleanerEmail) {\r\n        throw new Error('Unauthorized: You are not assigned to this job');\r\n      }\r\n      \r\n      return job as unknown as JobRecord;\r\n    } catch (error) {\r\n      console.error('Error fetching job:', error);\r\n      return null;\r\n    }\r\n  }\r\n  \r\n  // Transition: Cleaner accepts job\r\n  async acceptJob(jobId: string, cleanerEmail: string, cleanerId: string): Promise<JobRecord> {\r\n    const job = await base44.entities.Job.getOne(jobId);\r\n    \r\n    if (!job) throw new Error('Job not found');\r\n    if (job.state !== 'OFFERED') throw new Error('Job is not in OFFERED state');\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'ASSIGNED',\r\n      assigned_cleaner_id: cleanerId,\r\n      assigned_cleaner_email: cleanerEmail,\r\n      assigned_at: new Date().toISOString()\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_ASSIGNED',\r\n      jobId,\r\n      cleanerId\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Transition: Cleaner is en route\r\n  async markEnRoute(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    location: { lat: number; lng: number }\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    const transition = canTransition(job.state as JobState, 'EN_ROUTE', job);\r\n    if (!transition.allowed) {\r\n      throw new Error(`Cannot mark en route: ${transition.reasons.join(', ')}`);\r\n    }\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'EN_ROUTE',\r\n      en_route_at: new Date().toISOString(),\r\n      en_route_location_lat: location.lat,\r\n      en_route_location_lng: location.lng\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'CLEANER_EN_ROUTE',\r\n      jobId,\r\n      cleanerId,\r\n      location\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Transition: Cleaner arrived at location\r\n  async markArrived(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    location: { lat: number; lng: number }\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    // Validate GPS location\r\n    if (!isLocationNearJob(location.lat, location.lng, job, 250)) {\r\n      throw new Error('GPS location is too far from job address (must be within 250 meters)');\r\n    }\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'ARRIVED',\r\n      check_in_at: new Date().toISOString(),\r\n      check_in_location_lat: location.lat,\r\n      check_in_location_lng: location.lng\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'CLEANER_ARRIVED',\r\n      jobId,\r\n      cleanerId,\r\n      location\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Transition: Start job (timer starts)\r\n  async startJob(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    location: { lat: number; lng: number }\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    // Validate GPS location\r\n    if (!isLocationNearJob(location.lat, location.lng, job, 250)) {\r\n      throw new Error('GPS location is too far from job address (must be within 250 meters)');\r\n    }\r\n    \r\n    const transition = canTransition(job.state as JobState, 'IN_PROGRESS', job);\r\n    if (!transition.allowed) {\r\n      throw new Error(`Cannot start job: ${transition.reasons.join(', ')}`);\r\n    }\r\n    \r\n    // Calculate max billable based on original booking\r\n    const maxMinutes = job.duration_hours * 60;\r\n    const creditsPerHour = 50; // TODO: Get from pricing snapshot\r\n    const maxCredits = (maxMinutes / 60) * creditsPerHour;\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'IN_PROGRESS',\r\n      start_at: new Date().toISOString(),\r\n      start_location_lat: location.lat,\r\n      start_location_lng: location.lng,\r\n      max_billable_minutes: maxMinutes,\r\n      max_billable_credits: maxCredits\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_STARTED',\r\n      jobId,\r\n      cleanerId,\r\n      location\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Upload before photos\r\n  async uploadBeforePhoto(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    photoFile: File\r\n  ): Promise<{ photoId: string; count: number }> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    if (job.state !== 'IN_PROGRESS') {\r\n      throw new Error('Can only upload before photos during IN_PROGRESS state');\r\n    }\r\n    \r\n    // Upload to Base44 file storage\r\n    const uploadResult = await base44.files.uploadFile(photoFile);\r\n    \r\n    // Increment count\r\n    const newCount = (job.before_photos_count || 0) + 1;\r\n    await base44.entities.Job.update(jobId, {\r\n      before_photos_count: newCount\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'BEFORE_PHOTO_UPLOADED',\r\n      jobId,\r\n      cleanerId,\r\n      photoId: uploadResult.id\r\n    });\r\n    \r\n    return { photoId: uploadResult.id, count: newCount };\r\n  }\r\n  \r\n  // Upload after photos\r\n  async uploadAfterPhoto(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    photoFile: File\r\n  ): Promise<{ photoId: string; count: number }> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    if (job.state !== 'IN_PROGRESS') {\r\n      throw new Error('Can only upload after photos during IN_PROGRESS state');\r\n    }\r\n    \r\n    // Upload to Base44 file storage\r\n    const uploadResult = await base44.files.uploadFile(photoFile);\r\n    \r\n    // Increment count\r\n    const newCount = (job.after_photos_count || 0) + 1;\r\n    await base44.entities.Job.update(jobId, {\r\n      after_photos_count: newCount\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'AFTER_PHOTO_UPLOADED',\r\n      jobId,\r\n      cleanerId,\r\n      photoId: uploadResult.id\r\n    });\r\n    \r\n    return { photoId: uploadResult.id, count: newCount };\r\n  }\r\n  \r\n  // Request extra time\r\n  async requestExtraTime(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    minutesRequested: number,\r\n    reason: string\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    if (job.state !== 'IN_PROGRESS') {\r\n      throw new Error('Can only request extra time during IN_PROGRESS state');\r\n    }\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      sub_state: 'EXTRA_TIME_REQUESTED',\r\n      has_pending_extra_time_request: true\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'EXTRA_TIME_REQUESTED',\r\n      jobId,\r\n      cleanerId,\r\n      minutesRequested,\r\n      reason\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Complete job (submit for review)\r\n  async completeJob(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    location: { lat: number; lng: number },\r\n    notes?: string\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    // Validate GPS location\r\n    if (!isLocationNearJob(location.lat, location.lng, job, 250)) {\r\n      throw new Error('GPS location is too far from job address (must be within 250 meters)');\r\n    }\r\n    \r\n    const endTime = new Date().toISOString();\r\n    const minutesWorked = calculateWorkedMinutes({\r\n      ...job,\r\n      end_at: endTime\r\n    });\r\n    \r\n    const transition = canTransition(job.state as JobState, 'AWAITING_CLIENT_REVIEW', job);\r\n    if (!transition.allowed) {\r\n      throw new Error(`Cannot complete job: ${transition.reasons.join(', ')}`);\r\n    }\r\n    \r\n    const billableMinutes = calculateBillableMinutes({\r\n      ...job,\r\n      end_at: endTime,\r\n      actual_minutes_worked: minutesWorked\r\n    });\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'AWAITING_CLIENT_REVIEW',\r\n      end_at: endTime,\r\n      end_location_lat: location.lat,\r\n      end_location_lng: location.lng,\r\n      actual_minutes_worked: minutesWorked,\r\n      cleaner_notes: notes\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_COMPLETED',\r\n      jobId,\r\n      cleanerId,\r\n      location,\r\n      minutesWorked: minutesWorked || 0\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n  \r\n  // Cancel job (cleaner-side)\r\n  async cancelJob(\r\n    jobId: string,\r\n    cleanerEmail: string,\r\n    cleanerId: string,\r\n    reason: string\r\n  ): Promise<JobRecord> {\r\n    const job = await this.getJob(jobId, cleanerEmail);\r\n    if (!job) throw new Error('Job not found or unauthorized');\r\n    \r\n    // Cannot cancel if already completed or under review\r\n    if (['COMPLETED_APPROVED', 'UNDER_REVIEW'].includes(job.state as string)) {\r\n      throw new Error('Cannot cancel job in this state');\r\n    }\r\n    \r\n    const updatedJob = await base44.entities.Job.update(jobId, {\r\n      state: 'CANCELLED',\r\n      cancelled_at: new Date().toISOString(),\r\n      cleaner_notes: reason\r\n    });\r\n    \r\n    await jobEventBus.emit({\r\n      type: 'JOB_CANCELLED',\r\n      jobId,\r\n      cancelledBy: cleanerId,\r\n      reason\r\n    });\r\n    \r\n    return updatedJob as unknown as JobRecord;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const cleanerJobsService = new CleanerJobsService();\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\clientNotificationService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":7,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Client Notification Service\n// Real-time notifications for clients about their jobs\n\nimport { base44 } from '@/api/base44Client';\nimport { NotificationService } from '@/components/notifications/NotificationService';\nimport EmailService from '@/components/notifications/EmailNotificationService';\nimport type { JobRecord } from '@/types/cleanerJobTypes';\nimport { jobEventBus, type JobEvent } from './jobEvents';\n\nexport interface ClientNotificationContext {\n  job: JobRecord;\n  client: any;\n  cleaner: any;\n}\n\n/**\n * Client Notification Service\n * Sends real-time notifications to clients about job status changes\n * \n * Coverage:\n * - Cleaner en route (GPS-based)\n * - Cleaner arrived (GPS check-in)\n * - Job started (with timestamp)\n * - Photos uploaded (before/after)\n * - Extra time requested (URGENT - requires approval)\n * - Job completed (with summary)\n * - Payment processed\n */\nexport class ClientNotificationService {\n  private listeners: Array<(notification: any) => void> = [];\n\n  constructor() {\n    this.setupEventListeners();\n  }\n\n  // Subscribe to client notifications (for real-time UI updates)\n  subscribe(callback: (notification: any) => void) {\n    this.listeners.push(callback);\n    return () => {\n      this.listeners = this.listeners.filter(cb => cb !== callback);\n    };\n  }\n\n  // Emit notification to all listeners (for real-time updates)\n  private emit(notification: any) {\n    this.listeners.forEach(callback => callback(notification));\n  }\n\n  // Setup job event listeners\n  private setupEventListeners() {\n    // Cleaner accepted job\n    jobEventBus.on('JOB_ASSIGNED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyJobAccepted({ job, client, cleaner });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in JOB_ASSIGNED:', error);\n      }\n    });\n\n    // Cleaner en route (GPS check-in)\n    jobEventBus.on('CLEANER_EN_ROUTE', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyCleanerEnRoute({ job, client, cleaner, location: event.location });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in CLEANER_EN_ROUTE:', error);\n      }\n    });\n\n    // Cleaner arrived\n    jobEventBus.on('CLEANER_ARRIVED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyCleanerArrived({ job, client, cleaner });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in CLEANER_ARRIVED:', error);\n      }\n    });\n\n    // Job started\n    jobEventBus.on('JOB_STARTED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyJobStarted({ job, client, cleaner });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in JOB_STARTED:', error);\n      }\n    });\n\n    // Before photos uploaded\n    jobEventBus.on('BEFORE_PHOTO_UPLOADED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyPhotosUploaded({ job, client, cleaner, photoType: 'before' });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in BEFORE_PHOTO_UPLOADED:', error);\n      }\n    });\n\n    // After photos uploaded\n    jobEventBus.on('AFTER_PHOTO_UPLOADED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyPhotosUploaded({ job, client, cleaner, photoType: 'after' });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in AFTER_PHOTO_UPLOADED:', error);\n      }\n    });\n\n    // Extra time requested (CRITICAL - requires client approval)\n    jobEventBus.on('EXTRA_TIME_REQUESTED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyExtraTimeRequested({\n          job,\n          client,\n          cleaner,\n          minutesRequested: event.minutesRequested,\n          reason: event.reason\n        });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in EXTRA_TIME_REQUESTED:', error);\n      }\n    });\n\n    // Job completed\n    jobEventBus.on('JOB_COMPLETED', async (event) => {\n      try {\n        const job = await base44.entities.Booking.get(event.jobId);\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\n        \n        await this.notifyJobCompleted({ job, client, cleaner, minutesWorked: event.minutesWorked });\n      } catch (error) {\n        console.error('[ClientNotificationService] Error in JOB_COMPLETED:', error);\n      }\n    });\n  }\n\n  // ============================================================================\n  // NOTIFICATION METHODS\n  // ============================================================================\n\n  /**\n   * Notify client that cleaner accepted their job\n   */\n  async notifyJobAccepted(context: ClientNotificationContext) {\n    const { job, client, cleaner } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: Job accepted by ${cleaner?.name}`);\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_accepted',\n      title: '‚úÖ Booking Confirmed!',\n      message: `${cleaner?.name || 'Your cleaner'} accepted your booking for ${job.date} at ${job.time}`,\n      payload: { booking_id: job.id },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'high'\n    });\n\n    // Email notification\n    await EmailService.sendNotification('email.client.booking_confirmation', {\n      recipient_email: job.client_id,\n      first_name: client?.first_name || 'there',\n      cleaner_name: cleaner?.name || 'Your cleaner',\n      date: job.date,\n      time: job.time,\n      address: job.address,\n      price: job.pricing_snapshot?.total_price ? `$${job.pricing_snapshot.total_price}` : 'TBD',\n      manage_booking_link: `https://puretask.com/ClientBookings?booking=${job.id}`\n    });\n\n    // Emit for real-time UI updates\n    this.emit({\n      type: 'job_accepted',\n      jobId: job.id,\n      message: `${cleaner?.name || 'Your cleaner'} accepted your booking!`\n    });\n\n    // SMS will be sent by smsService (once implemented)\n  }\n\n  /**\n   * Notify client that cleaner is on the way\n   * CRITICAL: This is when anxiety is highest - immediate notification needed\n   */\n  async notifyCleanerEnRoute(context: ClientNotificationContext & { location: { lat: number; lng: number } }) {\n    const { job, client, cleaner, location } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: Cleaner en route (GPS: ${location.lat}, ${location.lng})`);\n\n    // Calculate ETA (simple estimate: 15 minutes)\n    const eta = '15 minutes';\n\n    // In-app notification (HIGH PRIORITY)\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_update',\n      title: 'üöó Your cleaner is on the way!',\n      message: `${cleaner?.name || 'Your cleaner'} is heading to your location. ETA: ${eta}`,\n      payload: {\n        booking_id: job.id,\n        location: location,\n        eta: eta\n      },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'high'\n    });\n\n    // Email notification\n    await EmailService.sendNotification('email.client.cleaner_on_way', {\n      recipient_email: job.client_id,\n      first_name: client?.first_name || 'there',\n      cleaner_name: cleaner?.name || 'Your cleaner'\n    });\n\n    // Emit for real-time UI updates (live tracking)\n    this.emit({\n      type: 'cleaner_en_route',\n      jobId: job.id,\n      location: location,\n      eta: eta,\n      message: `${cleaner?.name || 'Your cleaner'} is on the way!`\n    });\n\n    // SMS will be HIGH PRIORITY once implemented\n  }\n\n  /**\n   * Notify client that cleaner has arrived\n   * CRITICAL: Reduces client anxiety significantly\n   */\n  async notifyCleanerArrived(context: ClientNotificationContext) {\n    const { job, client, cleaner } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: Cleaner arrived`);\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_update',\n      title: 'üìç Your cleaner has arrived!',\n      message: `${cleaner?.name || 'Your cleaner'} checked in at your location and will start shortly.`,\n      payload: { booking_id: job.id },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'high'\n    });\n\n    // Emit for real-time UI updates\n    this.emit({\n      type: 'cleaner_arrived',\n      jobId: job.id,\n      message: `${cleaner?.name || 'Your cleaner'} has arrived!`\n    });\n\n    // SMS notification (HIGH PRIORITY once implemented)\n  }\n\n  /**\n   * Notify client that cleaning has started\n   */\n  async notifyJobStarted(context: ClientNotificationContext) {\n    const { job, client, cleaner } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: Job started`);\n\n    const startTime = job.start_at \n      ? new Date(job.start_at).toLocaleTimeString('en-US', {\n          hour: 'numeric',\n          minute: '2-digit',\n          hour12: true\n        })\n      : 'recently';\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_update',\n      title: 'üßπ Cleaning in progress!',\n      message: `${cleaner?.name || 'Your cleaner'} started at ${startTime}. You can track progress in real-time.`,\n      payload: {\n        booking_id: job.id,\n        start_time: job.start_at\n      },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'medium'\n    });\n\n    // Emit for real-time UI updates\n    this.emit({\n      type: 'job_started',\n      jobId: job.id,\n      startTime: job.start_at,\n      message: 'Cleaning started!'\n    });\n  }\n\n  /**\n   * Notify client that photos have been uploaded\n   */\n  async notifyPhotosUploaded(context: ClientNotificationContext & { photoType: 'before' | 'after' }) {\n    const { job, client, cleaner, photoType } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: ${photoType} photos uploaded`);\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_update',\n      title: `üì∏ ${photoType === 'before' ? 'Before' : 'After'} photos uploaded`,\n      message: `${cleaner?.name || 'Your cleaner'} uploaded ${photoType} photos. View them in your booking details.`,\n      payload: {\n        booking_id: job.id,\n        photo_type: photoType\n      },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'medium'\n    });\n\n    // Emit for real-time UI updates (show photos immediately)\n    this.emit({\n      type: 'photos_uploaded',\n      jobId: job.id,\n      photoType: photoType,\n      message: `${photoType === 'before' ? 'Before' : 'After'} photos uploaded`\n    });\n  }\n\n  /**\n   * Notify client that cleaner is requesting extra time\n   * CRITICAL: Requires immediate client approval/denial\n   */\n  async notifyExtraTimeRequested(\n    context: ClientNotificationContext & {\n      minutesRequested: number;\n      reason: string;\n    }\n  ) {\n    const { job, client, cleaner, minutesRequested, reason } = context;\n\n    console.log(`[ClientNotificationService] URGENT: Extra time requested - ${minutesRequested} minutes`);\n\n    const hourlyRate = job.pricing_snapshot?.hourly_rate || 0;\n    const additionalCost = ((hourlyRate / 60) * minutesRequested).toFixed(2);\n\n    // In-app notification (URGENT PRIORITY)\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_update',\n      title: '‚è∞ Extra time requested - Approval needed',\n      message: `${cleaner?.name || 'Your cleaner'} requests ${minutesRequested} extra minutes. Additional cost: $${additionalCost}. Reason: ${reason}`,\n      payload: {\n        booking_id: job.id,\n        minutes_requested: minutesRequested,\n        reason: reason,\n        additional_cost: additionalCost\n      },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'urgent' // HIGHEST PRIORITY\n    });\n\n    // Email notification (URGENT)\n    await EmailService.sendNotification('email.client.extra_time_requested', {\n      recipient_email: job.client_id,\n      first_name: client?.first_name || 'there',\n      cleaner_name: cleaner?.name || 'Your cleaner',\n      minutes_requested: minutesRequested.toString(),\n      reason: reason,\n      additional_cost: additionalCost,\n      approve_link: `https://puretask.com/ClientBookings?booking=${job.id}&action=approve_time`,\n      deny_link: `https://puretask.com/ClientBookings?booking=${job.id}&action=deny_time`\n    });\n\n    // Emit for real-time UI updates (show approval modal immediately)\n    this.emit({\n      type: 'extra_time_requested',\n      jobId: job.id,\n      minutesRequested: minutesRequested,\n      reason: reason,\n      additionalCost: additionalCost,\n      message: `Extra time approval needed: ${minutesRequested} minutes`,\n      urgent: true\n    });\n\n    // SMS notification (URGENT - once implemented, this should be IMMEDIATE)\n    // This is the MOST critical notification for client experience\n  }\n\n  /**\n   * Notify client that cleaning is complete\n   */\n  async notifyJobCompleted(context: ClientNotificationContext & { minutesWorked: number }) {\n    const { job, client, cleaner, minutesWorked } = context;\n\n    console.log(`[ClientNotificationService] Notifying client: Job completed (${minutesWorked} minutes)`);\n\n    const hours = Math.floor(minutesWorked / 60);\n    const minutes = minutesWorked % 60;\n    const durationText = `${hours}h ${minutes}m`;\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: job.client_id,\n      type: 'booking_completed',\n      title: '‚úÖ Cleaning complete!',\n      message: `${cleaner?.name || 'Your cleaner'} completed the job in ${durationText}. Please review and approve.`,\n      payload: {\n        booking_id: job.id,\n        minutes_worked: minutesWorked\n      },\n      link: `ClientBookings?booking=${job.id}`,\n      priority: 'high'\n    });\n\n    // Email notification\n    await EmailService.sendNotification('email.client.cleaning_completed', {\n      recipient_email: job.client_id,\n      first_name: client?.first_name || 'there',\n      cleaner_name: cleaner?.name || 'Your cleaner',\n      rate_cleaner_link: `https://puretask.com/ClientReview?booking=${job.id}`\n    });\n\n    // Emit for real-time UI updates\n    this.emit({\n      type: 'job_completed',\n      jobId: job.id,\n      minutesWorked: minutesWorked,\n      message: 'Cleaning complete! Please review.'\n    });\n  }\n\n  /**\n   * Notify client about payment processing\n   */\n  async notifyPaymentProcessed(jobId: string, amount: number, clientEmail: string) {\n    console.log(`[ClientNotificationService] Notifying client: Payment processed - $${amount}`);\n\n    // In-app notification\n    await NotificationService.create({\n      recipientEmail: clientEmail,\n      type: 'payment_received',\n      title: 'üí≥ Payment processed',\n      message: `Your payment of $${amount.toFixed(2)} has been processed successfully.`,\n      payload: { booking_id: jobId, amount: amount },\n      link: `ClientBookings?booking=${jobId}`,\n      priority: 'medium'\n    });\n\n    // Emit for real-time UI updates\n    this.emit({\n      type: 'payment_processed',\n      jobId: jobId,\n      amount: amount,\n      message: 'Payment processed successfully'\n    });\n  }\n}\n\n// Singleton instance\nexport const clientNotificationService = new ClientNotificationService();\n\n// Export for testing\nexport default clientNotificationService;\n\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\jobEvents.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token type","line":4,"column":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Domain Events for Job Lifecycle\r\n// Events that represent important things happening in the job workflow\r\n\r\nexport type JobEvent =\r\n  | { type: 'JOB_CREATED'; jobId: string; clientId: string }\r\n  | { type: 'JOB_OFFERED'; jobId: string; cleanerIds: string[] }\r\n  | { type: 'JOB_ASSIGNED'; jobId: string; cleanerId: string }\r\n  | { type: 'CLEANER_EN_ROUTE'; jobId: string; cleanerId: string; location: { lat: number; lng: number } }\r\n  | { type: 'CLEANER_ARRIVED'; jobId: string; cleanerId: string; location: { lat: number; lng: number } }\r\n  | { type: 'JOB_STARTED'; jobId: string; cleanerId: string; location: { lat: number; lng: number } }\r\n  | { type: 'BEFORE_PHOTO_UPLOADED'; jobId: string; cleanerId: string; photoId: string }\r\n  | { type: 'AFTER_PHOTO_UPLOADED'; jobId: string; cleanerId: string; photoId: string }\r\n  | { type: 'EXTRA_TIME_REQUESTED'; jobId: string; cleanerId: string; minutesRequested: number; reason: string }\r\n  | { type: 'EXTRA_TIME_APPROVED'; jobId: string; clientId: string; minutesApproved: number }\r\n  | { type: 'EXTRA_TIME_DENIED'; jobId: string; clientId: string; reason: string }\r\n  | { type: 'JOB_COMPLETED'; jobId: string; cleanerId: string; location: { lat: number; lng: number }; minutesWorked: number }\r\n  | { type: 'CLIENT_APPROVED'; jobId: string; clientId: string; rating: number; tip?: number }\r\n  | { type: 'DISPUTE_OPENED'; jobId: string; openedBy: 'client' | 'cleaner'; reason: string }\r\n  | { type: 'DISPUTE_RESOLVED'; jobId: string; resolution: 'approve' | 'refund'; notes: string }\r\n  | { type: 'JOB_CANCELLED'; jobId: string; cancelledBy: string; reason: string }\r\n  | { type: 'RESCHEDULE_REQUESTED'; jobId: string; requestedBy: string; newDate: string; newTime: string };\r\n\r\n// Event handler type\r\nexport type EventHandler<T extends JobEvent = JobEvent> = (event: T) => Promise<void>;\r\n\r\n// Event bus (simple in-memory for now, can be upgraded to queue later)\r\nclass EventBus {\r\n  private handlers: Map<JobEvent['type'], EventHandler[]> = new Map();\r\n\r\n  on<T extends JobEvent['type']>(\r\n    eventType: T,\r\n    handler: EventHandler<Extract<JobEvent, { type: T }>>\r\n  ): void {\r\n    if (!this.handlers.has(eventType)) {\r\n      this.handlers.set(eventType, []);\r\n    }\r\n    this.handlers.get(eventType)!.push(handler as EventHandler);\r\n  }\r\n\r\n  async emit(event: JobEvent): Promise<void> {\r\n    const handlers = this.handlers.get(event.type) || [];\r\n    console.log(`[EventBus] Emitting ${event.type}`, event);\r\n    \r\n    // Run all handlers in parallel\r\n    await Promise.all(handlers.map(handler => handler(event)));\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const jobEventBus = new EventBus();\r\n\r\n// Standard side effects (notifications, logging, etc.)\r\n\r\n// Send notification to cleaner\r\njobEventBus.on('JOB_OFFERED', async (event) => {\r\n  console.log(`[Side Effect] Send job offer notifications to ${event.cleanerIds.length} cleaners`);\r\n  // TODO: Send SMS/push notifications via Twilio\r\n});\r\n\r\n// Send notification to client\r\njobEventBus.on('CLEANER_EN_ROUTE', async (event) => {\r\n  console.log(`[Side Effect] Notify client that cleaner is on the way`);\r\n  // TODO: Send SMS to client\r\n});\r\n\r\n// Log important events\r\njobEventBus.on('JOB_STARTED', async (event) => {\r\n  console.log(`[Side Effect] Job ${event.jobId} started by cleaner ${event.cleanerId}`);\r\n  // TODO: Log to audit trail\r\n});\r\n\r\njobEventBus.on('JOB_COMPLETED', async (event) => {\r\n  console.log(`[Side Effect] Job ${event.jobId} completed - ${event.minutesWorked} minutes`);\r\n  // TODO: Calculate payout, update cleaner earnings\r\n});\r\n\r\njobEventBus.on('CLIENT_APPROVED', async (event) => {\r\n  console.log(`[Side Effect] Job ${event.jobId} approved with rating ${event.rating}`);\r\n  // TODO: Release escrow, pay cleaner, update reliability score\r\n});\r\n\r\njobEventBus.on('DISPUTE_OPENED', async (event) => {\r\n  console.log(`[Side Effect] Dispute opened on job ${event.jobId} by ${event.openedBy}`);\r\n  // TODO: Alert admin team, freeze payments\r\n});\r\n\r\n// Helper to emit multiple events\r\nexport async function emitEvents(events: JobEvent[]): Promise<void> {\r\n  for (const event of events) {\r\n    await jobEventBus.emit(event);\r\n  }\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\notificationIntegration.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token initialized","line":23,"column":11}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Notification Integration Layer\r\n// Wires together all notification services (Client, SMS, Push, Real-Time)\r\n\r\nimport { clientNotificationService } from './clientNotificationService';\r\nimport { smsService, ClientSMSTemplates, CleanerSMSTemplates } from './smsService';\r\nimport { pushNotificationService, ClientPushTemplates, CleanerPushTemplates } from './pushNotificationService';\r\nimport { realTimeNotificationService } from './realTimeNotificationService';\r\nimport { jobEventBus } from './jobEvents';\r\nimport { base44 } from '@/api/base44Client';\r\n\r\n/**\r\n * Notification Integration Service\r\n * Central orchestrator for all notification channels\r\n * \r\n * Responsibilities:\r\n * - Wire job events to all notification services\r\n * - Respect user notification preferences\r\n * - Send notifications via multiple channels (in-app, email, SMS, push)\r\n * - Track delivery status\r\n */\r\n\r\nexport class NotificationIntegration {\r\n  private initialized: boolean = false;\r\n\r\n  /**\r\n   * Initialize notification integration\r\n   * Sets up all event listeners\r\n   */\r\n  async initialize() {\r\n    if (this.initialized) {\r\n      console.log('[NotificationIntegration] Already initialized');\r\n      return;\r\n    }\r\n\r\n    console.log('[NotificationIntegration] Initializing...');\r\n\r\n    // The clientNotificationService already sets up event listeners\r\n    // We just need to enhance them with SMS and Push notifications\r\n\r\n    this.setupEnhancedNotifications();\r\n\r\n    this.initialized = true;\r\n    console.log('[NotificationIntegration] Initialized successfully');\r\n  }\r\n\r\n  /**\r\n   * Setup enhanced notifications (SMS + Push + Real-time)\r\n   */\r\n  private setupEnhancedNotifications() {\r\n    // ========================================================================\r\n    // CLIENT NOTIFICATIONS (Enhanced with SMS + Push)\r\n    // ========================================================================\r\n\r\n    // Cleaner en route - HIGH PRIORITY (anxiety reducer)\r\n    jobEventBus.on('CLEANER_EN_ROUTE', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\r\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\r\n\r\n        if (!client) return;\r\n\r\n        // Get notification preferences\r\n        const prefs = await this.getNotificationPreferences(job.client_id);\r\n\r\n        const eta = '15 minutes'; // Calculate actual ETA\r\n\r\n        // SMS notification (HIGH PRIORITY)\r\n        if (prefs.sms && client.phone) {\r\n          await smsService.sendSMS({\r\n            to: client.phone,\r\n            message: ClientSMSTemplates.cleanerEnRoute(cleaner?.name || 'Your cleaner', eta),\r\n            priority: 'high'\r\n          });\r\n        }\r\n\r\n        // Push notification (HIGH PRIORITY)\r\n        if (prefs.push) {\r\n          await pushNotificationService.showLocalNotification(\r\n            ClientPushTemplates.cleanerEnRoute(cleaner?.name || 'Your cleaner', eta)\r\n          );\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in CLEANER_EN_ROUTE:', error);\r\n      }\r\n    });\r\n\r\n    // Cleaner arrived\r\n    jobEventBus.on('CLEANER_ARRIVED', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\r\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\r\n\r\n        if (!client) return;\r\n\r\n        const prefs = await this.getNotificationPreferences(job.client_id);\r\n\r\n        // SMS notification\r\n        if (prefs.sms && client.phone) {\r\n          await smsService.sendSMS({\r\n            to: client.phone,\r\n            message: ClientSMSTemplates.cleanerArrived(cleaner?.name || 'Your cleaner'),\r\n            priority: 'high'\r\n          });\r\n        }\r\n\r\n        // Push notification\r\n        if (prefs.push) {\r\n          await pushNotificationService.showLocalNotification(\r\n            ClientPushTemplates.cleanerArrived(cleaner?.name || 'Your cleaner')\r\n          );\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in CLEANER_ARRIVED:', error);\r\n      }\r\n    });\r\n\r\n    // Extra time requested - CRITICAL (requires immediate client approval)\r\n    jobEventBus.on('EXTRA_TIME_REQUESTED', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\r\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\r\n\r\n        if (!client) return;\r\n\r\n        const prefs = await this.getNotificationPreferences(job.client_id);\r\n\r\n        const additionalCost = ((job.total_price / (job.estimated_hours * 60)) * event.minutesRequested).toFixed(2);\r\n\r\n        // SMS notification (ALWAYS send for urgent requests, even if disabled)\r\n        if (client.phone) {\r\n          await smsService.sendSMS({\r\n            to: client.phone,\r\n            message: ClientSMSTemplates.extraTimeRequested(\r\n              cleaner?.name || 'Your cleaner',\r\n              event.minutesRequested,\r\n              additionalCost\r\n            ),\r\n            priority: 'high' // HIGHEST PRIORITY\r\n          });\r\n        }\r\n\r\n        // Push notification (ALWAYS show for urgent requests)\r\n        await pushNotificationService.showLocalNotification(\r\n          ClientPushTemplates.extraTimeRequested(\r\n            cleaner?.name || 'Your cleaner',\r\n            event.minutesRequested,\r\n            additionalCost\r\n          )\r\n        );\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in EXTRA_TIME_REQUESTED:', error);\r\n      }\r\n    });\r\n\r\n    // Job completed\r\n    jobEventBus.on('JOB_COMPLETED', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: event.cleanerId })[0];\r\n        const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\r\n\r\n        if (!client) return;\r\n\r\n        const prefs = await this.getNotificationPreferences(job.client_id);\r\n\r\n        const hours = Math.floor(event.minutesWorked / 60);\r\n        const minutes = event.minutesWorked % 60;\r\n        const durationText = `${hours}h ${minutes}m`;\r\n\r\n        // SMS notification\r\n        if (prefs.sms && client.phone) {\r\n          await smsService.sendSMS({\r\n            to: client.phone,\r\n            message: ClientSMSTemplates.jobCompleted(cleaner?.name || 'Your cleaner', durationText),\r\n            priority: 'high'\r\n          });\r\n        }\r\n\r\n        // Push notification\r\n        if (prefs.push) {\r\n          await pushNotificationService.showLocalNotification(\r\n            ClientPushTemplates.jobCompleted(cleaner?.name || 'Your cleaner')\r\n          );\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in JOB_COMPLETED:', error);\r\n      }\r\n    });\r\n\r\n    // ========================================================================\r\n    // CLEANER NOTIFICATIONS (Enhanced with SMS + Push)\r\n    // ========================================================================\r\n\r\n    // Job offered\r\n    jobEventBus.on('JOB_OFFERED', async (event) => {\r\n      try {\r\n        // Send to all offered cleaners\r\n        for (const cleanerId of event.cleanerIds) {\r\n          const cleaner = await base44.entities.CleanerProfile.filter({ user_email: cleanerId })[0];\r\n          if (!cleaner) continue;\r\n\r\n          const job = await base44.entities.Booking.get(event.jobId);\r\n          const client = await base44.entities.ClientProfile.filter({ user_email: job.client_id })[0];\r\n\r\n          const prefs = await this.getNotificationPreferences(cleanerId);\r\n\r\n          const pay = (job.total_price * (cleaner.payout_percentage || 0.8)).toFixed(2);\r\n\r\n          // SMS notification\r\n          if (prefs.sms && cleaner.phone) {\r\n            await smsService.sendSMS({\r\n              to: cleaner.phone,\r\n              message: CleanerSMSTemplates.jobOffer(\r\n                client?.first_name || 'Client',\r\n                job.date,\r\n                job.start_time,\r\n                pay\r\n              ),\r\n              priority: 'high'\r\n            });\r\n          }\r\n\r\n          // Push notification\r\n          if (prefs.push) {\r\n            await pushNotificationService.showLocalNotification(\r\n              CleanerPushTemplates.jobOffer(client?.first_name || 'Client', pay)\r\n            );\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in JOB_OFFERED:', error);\r\n      }\r\n    });\r\n\r\n    // Extra time approved\r\n    jobEventBus.on('EXTRA_TIME_APPROVED', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: job.cleaner_id })[0];\r\n\r\n        if (!cleaner) return;\r\n\r\n        const prefs = await this.getNotificationPreferences(job.cleaner_id);\r\n\r\n        // SMS notification\r\n        if (prefs.sms && cleaner.phone) {\r\n          await smsService.sendSMS({\r\n            to: cleaner.phone,\r\n            message: CleanerSMSTemplates.extraTimeApproved(event.minutesApproved),\r\n            priority: 'high'\r\n          });\r\n        }\r\n\r\n        // Push notification\r\n        if (prefs.push) {\r\n          await pushNotificationService.showLocalNotification(\r\n            CleanerPushTemplates.extraTimeApproved(event.minutesApproved)\r\n          );\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in EXTRA_TIME_APPROVED:', error);\r\n      }\r\n    });\r\n\r\n    // Extra time denied\r\n    jobEventBus.on('EXTRA_TIME_DENIED', async (event) => {\r\n      try {\r\n        const job = await base44.entities.Booking.get(event.jobId);\r\n        const cleaner = await base44.entities.CleanerProfile.filter({ user_email: job.cleaner_id })[0];\r\n\r\n        if (!cleaner) return;\r\n\r\n        const prefs = await this.getNotificationPreferences(job.cleaner_id);\r\n\r\n        // SMS notification\r\n        if (prefs.sms && cleaner.phone) {\r\n          await smsService.sendSMS({\r\n            to: cleaner.phone,\r\n            message: CleanerSMSTemplates.extraTimeDenied(),\r\n            priority: 'high'\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('[NotificationIntegration] Error in EXTRA_TIME_DENIED:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get user notification preferences\r\n   * Returns default preferences if not set\r\n   */\r\n  private async getNotificationPreferences(userEmail: string): Promise<{\r\n    inApp: boolean;\r\n    email: boolean;\r\n    sms: boolean;\r\n    push: boolean;\r\n  }> {\r\n    try {\r\n      const prefs = await base44.entities.NotificationPreferences?.filter({\r\n        user_email: userEmail\r\n      }).catch(() => null);\r\n\r\n      if (prefs && prefs.length > 0) {\r\n        return {\r\n          inApp: prefs[0].in_app ?? true,\r\n          email: prefs[0].email ?? true,\r\n          sms: prefs[0].sms ?? true,\r\n          push: prefs[0].push ?? true\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('[NotificationIntegration] Error fetching preferences:', error);\r\n    }\r\n\r\n    // Default: all enabled\r\n    return {\r\n      inApp: true,\r\n      email: true,\r\n      sms: true,\r\n      push: true\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Send notification via all enabled channels\r\n   */\r\n  async sendMultiChannelNotification(params: {\r\n    userEmail: string;\r\n    phone?: string;\r\n    inAppTitle: string;\r\n    inAppMessage: string;\r\n    smsMessage?: string;\r\n    pushTitle?: string;\r\n    pushBody?: string;\r\n    priority?: 'low' | 'normal' | 'high';\r\n  }) {\r\n    const prefs = await this.getNotificationPreferences(params.userEmail);\r\n\r\n    // In-app notification\r\n    if (prefs.inApp) {\r\n      // Already handled by clientNotificationService\r\n    }\r\n\r\n    // SMS\r\n    if (prefs.sms && params.phone && params.smsMessage) {\r\n      await smsService.sendSMS({\r\n        to: params.phone,\r\n        message: params.smsMessage,\r\n        priority: params.priority || 'normal'\r\n      });\r\n    }\r\n\r\n    // Push\r\n    if (prefs.push && params.pushTitle && params.pushBody) {\r\n      await pushNotificationService.showLocalNotification({\r\n        title: params.pushTitle,\r\n        body: params.pushBody\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize real-time notifications for a user\r\n   */\r\n  async initializeRealTime(userEmail: string) {\r\n    console.log('[NotificationIntegration] Initializing real-time notifications for:', userEmail);\r\n\r\n    // Connect to real-time service\r\n    await realTimeNotificationService.connect(userEmail);\r\n\r\n    // Subscribe to real-time notifications\r\n    realTimeNotificationService.subscribe((notification) => {\r\n      console.log('[NotificationIntegration] Real-time notification received:', notification);\r\n      \r\n      // Trigger UI updates, show toast, etc.\r\n      // This will be handled by Layout.jsx\r\n    });\r\n\r\n    // Monitor connection status\r\n    realTimeNotificationService.onStatusChange((status) => {\r\n      console.log('[NotificationIntegration] Real-time status:', status);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Disconnect real-time notifications\r\n   */\r\n  disconnectRealTime() {\r\n    realTimeNotificationService.disconnect();\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const notificationIntegration = new NotificationIntegration();\r\n\r\n// Export default\r\nexport default notificationIntegration;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\photoQualityService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token interface","line":7,"column":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// AI Photo Quality Validation Service\r\n// Automatically validates photo quality using AI vision analysis\r\n\r\nimport React from 'react';\r\nimport { base44 } from '@/api/base44Client';\r\n\r\nexport interface PhotoQualityResult {\r\n  score: number; // 0-100\r\n  passed: boolean;\r\n  issues: string[];\r\n  suggestions: string[];\r\n  analysis: {\r\n    brightness: 'good' | 'too_dark' | 'too_bright';\r\n    blur: 'sharp' | 'slightly_blurry' | 'too_blurry';\r\n    framing: 'good' | 'poor' | 'cropped';\r\n    relevance: 'relevant' | 'unclear' | 'irrelevant';\r\n  };\r\n}\r\n\r\nexport class PhotoQualityService {\r\n  \r\n  // Validate a single photo\r\n  async validatePhoto(\r\n    photoFile: File,\r\n    photoType: 'before' | 'after',\r\n    jobContext?: {\r\n      cleaningType: string;\r\n      room?: string;\r\n    }\r\n  ): Promise<PhotoQualityResult> {\r\n    try {\r\n      // Convert file to base64\r\n      const base64 = await this.fileToBase64(photoFile);\r\n      \r\n      // Build prompt for AI vision analysis\r\n      const prompt = this.buildValidationPrompt(photoType, jobContext);\r\n      \r\n      // Call Base44 LLM with vision capabilities\r\n      const response = await base44.integrations.Core.InvokeLLM({\r\n        model: 'gpt-4-vision-preview',\r\n        messages: [\r\n          {\r\n            role: 'system',\r\n            content: 'You are a professional cleaning photo quality validator. Analyze photos and provide structured feedback.'\r\n          },\r\n          {\r\n            role: 'user',\r\n            content: [\r\n              { type: 'text', text: prompt },\r\n              { type: 'image_url', image_url: { url: base64 } }\r\n            ]\r\n          }\r\n        ],\r\n        temperature: 0.3,\r\n        max_tokens: 500\r\n      });\r\n      \r\n      // Parse AI response\r\n      const analysis = this.parseAIResponse(response.choices[0].message.content);\r\n      \r\n      return analysis;\r\n    } catch (error) {\r\n      console.error('Photo validation error:', error);\r\n      // Fallback to basic validation\r\n      return this.basicValidation(photoFile);\r\n    }\r\n  }\r\n  \r\n  // Build validation prompt based on photo type\r\n  private buildValidationPrompt(\r\n    photoType: 'before' | 'after',\r\n    context?: { cleaningType: string; room?: string }\r\n  ): string {\r\n    const basePrompt = `Analyze this ${photoType} cleaning photo and evaluate:\r\n    \r\n1. **Brightness**: Is the photo well-lit and clear?\r\n2. **Blur**: Is the photo sharp and in focus?\r\n3. **Framing**: Does it show the relevant area clearly?\r\n4. **Relevance**: Does it show cleaning progress/results?\r\n\r\n${photoType === 'before' ? `\r\nThis is a BEFORE photo. Look for:\r\n- Clear view of the area before cleaning\r\n- Visible dirt, mess, or items to be cleaned\r\n- Good angle showing the overall space\r\n` : `\r\nThis is an AFTER photo. Look for:\r\n- Clear view of the cleaned area\r\n- Visible cleaning results\r\n- Good comparison potential with before photos\r\n`}\r\n\r\n${context ? `Context: ${context.cleaningType} cleaning${context.room ? ` in ${context.room}` : ''}` : ''}\r\n\r\nRespond in JSON format:\r\n{\r\n  \"score\": 0-100,\r\n  \"passed\": true/false,\r\n  \"issues\": [\"issue 1\", \"issue 2\"],\r\n  \"suggestions\": [\"suggestion 1\", \"suggestion 2\"],\r\n  \"brightness\": \"good|too_dark|too_bright\",\r\n  \"blur\": \"sharp|slightly_blurry|too_blurry\",\r\n  \"framing\": \"good|poor|cropped\",\r\n  \"relevance\": \"relevant|unclear|irrelevant\"\r\n}`;\r\n\r\n    return basePrompt;\r\n  }\r\n  \r\n  // Parse AI response into structured result\r\n  private parseAIResponse(aiResponse: string): PhotoQualityResult {\r\n    try {\r\n      // Try to extract JSON from response\r\n      const jsonMatch = aiResponse.match(/\\{[\\s\\S]*\\}/);\r\n      if (!jsonMatch) throw new Error('No JSON found');\r\n      \r\n      const parsed = JSON.parse(jsonMatch[0]);\r\n      \r\n      return {\r\n        score: parsed.score || 0,\r\n        passed: parsed.passed || parsed.score >= 70,\r\n        issues: parsed.issues || [],\r\n        suggestions: parsed.suggestions || [],\r\n        analysis: {\r\n          brightness: parsed.brightness || 'good',\r\n          blur: parsed.blur || 'sharp',\r\n          framing: parsed.framing || 'good',\r\n          relevance: parsed.relevance || 'relevant'\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('Failed to parse AI response:', error);\r\n      return this.createDefaultResult();\r\n    }\r\n  }\r\n  \r\n  // Basic validation without AI (fallback)\r\n  private async basicValidation(photoFile: File): Promise<PhotoQualityResult> {\r\n    const sizeKB = photoFile.size / 1024;\r\n    const issues: string[] = [];\r\n    const suggestions: string[] = [];\r\n    let score = 100;\r\n    \r\n    // Check file size\r\n    if (sizeKB < 100) {\r\n      issues.push('Photo resolution may be too low');\r\n      suggestions.push('Take photo in higher quality mode');\r\n      score -= 30;\r\n    }\r\n    \r\n    if (sizeKB > 10000) {\r\n      issues.push('Photo file size is very large');\r\n      suggestions.push('Photo will take longer to upload');\r\n      score -= 10;\r\n    }\r\n    \r\n    // Check dimensions\r\n    try {\r\n      const dimensions = await this.getImageDimensions(photoFile);\r\n      if (dimensions.width < 640 || dimensions.height < 480) {\r\n        issues.push('Image dimensions are small');\r\n        suggestions.push('Use a camera with higher resolution');\r\n        score -= 20;\r\n      }\r\n    } catch (error) {\r\n      // Couldn't get dimensions\r\n    }\r\n    \r\n    return {\r\n      score,\r\n      passed: score >= 70,\r\n      issues,\r\n      suggestions,\r\n      analysis: {\r\n        brightness: 'good',\r\n        blur: 'sharp',\r\n        framing: 'good',\r\n        relevance: 'relevant'\r\n      }\r\n    };\r\n  }\r\n  \r\n  // Batch validate multiple photos\r\n  async validateBatch(\r\n    photos: File[],\r\n    photoType: 'before' | 'after',\r\n    jobContext?: { cleaningType: string }\r\n  ): Promise<PhotoQualityResult[]> {\r\n    const results = await Promise.all(\r\n      photos.map(photo => this.validatePhoto(photo, photoType, jobContext))\r\n    );\r\n    return results;\r\n  }\r\n  \r\n  // Get overall quality score for a set of photos\r\n  getOverallScore(results: PhotoQualityResult[]): {\r\n    avgScore: number;\r\n    allPassed: boolean;\r\n    totalIssues: number;\r\n  } {\r\n    const avgScore = results.reduce((sum, r) => sum + r.score, 0) / results.length;\r\n    const allPassed = results.every(r => r.passed);\r\n    const totalIssues = results.reduce((sum, r) => sum + r.issues.length, 0);\r\n    \r\n    return { avgScore, allPassed, totalIssues };\r\n  }\r\n  \r\n  // Generate improvement tips based on common issues\r\n  generateImprovementTips(results: PhotoQualityResult[]): string[] {\r\n    const allIssues = results.flatMap(r => r.issues);\r\n    const tips: string[] = [];\r\n    \r\n    if (allIssues.some(i => i.includes('dark'))) {\r\n      tips.push('üí° Turn on more lights or open curtains for better brightness');\r\n    }\r\n    \r\n    if (allIssues.some(i => i.includes('blur'))) {\r\n      tips.push('üì∏ Hold your phone steady and tap to focus before taking the photo');\r\n    }\r\n    \r\n    if (allIssues.some(i => i.includes('framing') || i.includes('cropped'))) {\r\n      tips.push('üéØ Step back a bit to show more of the area in frame');\r\n    }\r\n    \r\n    if (allIssues.some(i => i.includes('relevance') || i.includes('unclear'))) {\r\n      tips.push('‚ú® Focus on areas that show cleaning progress or results');\r\n    }\r\n    \r\n    return tips;\r\n  }\r\n  \r\n  // Helper: Convert file to base64\r\n  private fileToBase64(file: File): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = () => resolve(reader.result as string);\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(file);\r\n    });\r\n  }\r\n  \r\n  // Helper: Get image dimensions\r\n  private getImageDimensions(file: File): Promise<{ width: number; height: number }> {\r\n    return new Promise((resolve, reject) => {\r\n      const img = new Image();\r\n      img.onload = () => resolve({ width: img.width, height: img.height });\r\n      img.onerror = reject;\r\n      img.src = URL.createObjectURL(file);\r\n    });\r\n  }\r\n  \r\n  // Helper: Create default result\r\n  private createDefaultResult(): PhotoQualityResult {\r\n    return {\r\n      score: 70,\r\n      passed: true,\r\n      issues: [],\r\n      suggestions: [],\r\n      analysis: {\r\n        brightness: 'good',\r\n        blur: 'sharp',\r\n        framing: 'good',\r\n        relevance: 'relevant'\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const photoQualityService = new PhotoQualityService();\r\n\r\n// React Hook for photo validation\r\nexport function usePhotoValidation() {\r\n  const [validating, setValidating] = React.useState(false);\r\n  const [results, setResults] = React.useState<PhotoQualityResult[]>([]);\r\n  \r\n  const validatePhoto = async (\r\n    file: File,\r\n    type: 'before' | 'after',\r\n    context?: { cleaningType: string }\r\n  ) => {\r\n    setValidating(true);\r\n    try {\r\n      const result = await photoQualityService.validatePhoto(file, type, context);\r\n      setResults(prev => [...prev, result]);\r\n      return result;\r\n    } finally {\r\n      setValidating(false);\r\n    }\r\n  };\r\n  \r\n  const clearResults = () => setResults([]);\r\n  \r\n  return {\r\n    validatePhoto,\r\n    validating,\r\n    results,\r\n    clearResults,\r\n    overallScore: photoQualityService.getOverallScore(results),\r\n    improvementTips: photoQualityService.generateImprovementTips(results)\r\n  };\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\proactiveNotificationService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token {","line":5,"column":13}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Proactive Notification Service\r\n// Smart notifications based on job state, time, and context\r\n\r\nimport React from 'react';\r\nimport type { JobRecord } from '@/types/cleanerJobTypes';\r\nimport { jobEventBus } from './jobEvents';\r\n\r\nexport interface Notification {\r\n  id: string;\r\n  type: 'reminder' | 'alert' | 'tip' | 'achievement' | 'warning';\r\n  priority: 'high' | 'medium' | 'low';\r\n  title: string;\r\n  message: string;\r\n  actionLabel?: string;\r\n  actionUrl?: string;\r\n  timestamp: Date;\r\n  read: boolean;\r\n  jobId?: string;\r\n}\r\n\r\nexport class ProactiveNotificationService {\r\n  private notifications: Notification[] = [];\r\n  private listeners: Array<(notification: Notification) => void> = [];\r\n  \r\n  constructor() {\r\n    this.setupEventListeners();\r\n    this.startScheduledChecks();\r\n  }\r\n  \r\n  // Subscribe to new notifications\r\n  subscribe(callback: (notification: Notification) => void) {\r\n    this.listeners.push(callback);\r\n    return () => {\r\n      this.listeners = this.listeners.filter(cb => cb !== callback);\r\n    };\r\n  }\r\n  \r\n  // Emit notification to all listeners\r\n  private emit(notification: Notification) {\r\n    this.notifications.push(notification);\r\n    this.listeners.forEach(callback => callback(notification));\r\n  }\r\n  \r\n  // Setup job event listeners\r\n  private setupEventListeners() {\r\n    // Job assigned - remind to prepare\r\n    jobEventBus.on('JOB_ASSIGNED', async (event) => {\r\n      this.emit({\r\n        id: Date.now().toString(),\r\n        type: 'reminder',\r\n        priority: 'medium',\r\n        title: 'üéØ New Job Assigned!',\r\n        message: 'You have a new job! Review the details and mark when you\\'re en route.',\r\n        actionLabel: 'View Job',\r\n        actionUrl: `/CleanerJobDetail/${event.jobId}`,\r\n        timestamp: new Date(),\r\n        read: false,\r\n        jobId: event.jobId\r\n      });\r\n    });\r\n    \r\n    // Extra time approved\r\n    jobEventBus.on('EXTRA_TIME_APPROVED', async (event) => {\r\n      this.emit({\r\n        id: Date.now().toString(),\r\n        type: 'alert',\r\n        priority: 'high',\r\n        title: '‚úÖ Extra Time Approved!',\r\n        message: `Client approved ${event.minutesApproved} extra minutes. Continue working!`,\r\n        timestamp: new Date(),\r\n        read: false,\r\n        jobId: event.jobId\r\n      });\r\n    });\r\n    \r\n    // Job completed - celebrate\r\n    jobEventBus.on('CLIENT_APPROVED', async (event) => {\r\n      this.emit({\r\n        id: Date.now().toString(),\r\n        type: 'achievement',\r\n        priority: 'medium',\r\n        title: 'üéâ Job Approved!',\r\n        message: `Great work! Your payment is being processed. Rating: ${event.rating}/5.0`,\r\n        timestamp: new Date(),\r\n        read: false,\r\n        jobId: event.jobId\r\n      });\r\n    });\r\n  }\r\n  \r\n  // Start scheduled checks for time-based notifications\r\n  private startScheduledChecks() {\r\n    // Check every minute for upcoming jobs\r\n    setInterval(() => {\r\n      this.checkUpcomingJobs();\r\n      this.checkLateJobs();\r\n      this.checkPhotoReminders();\r\n    }, 60000); // Every 1 minute\r\n  }\r\n  \r\n  // Check for jobs starting soon\r\n  async checkUpcomingJobs() {\r\n    // This would fetch from backend\r\n    // For now, placeholder\r\n  }\r\n  \r\n  // Generate notification for job starting soon\r\n  createJobStartingSoonNotification(job: JobRecord, minutesUntil: number): Notification {\r\n    let priority: 'high' | 'medium' | 'low' = 'medium';\r\n    let title = '';\r\n    let message = '';\r\n    \r\n    if (minutesUntil <= 15) {\r\n      priority = 'high';\r\n      title = 'üö® Job Starting Soon!';\r\n      message = `Your job at ${job.address} starts in ${minutesUntil} minutes! Time to head out.`;\r\n    } else if (minutesUntil <= 30) {\r\n      priority = 'medium';\r\n      title = '‚è∞ Job in 30 Minutes';\r\n      message = `Don't forget: Job at ${job.address} starts soon. Prepare your supplies!`;\r\n    } else if (minutesUntil <= 60) {\r\n      priority = 'low';\r\n      title = 'üìÖ Job in 1 Hour';\r\n      message = `Heads up: You have a job at ${job.address} in about an hour.`;\r\n    }\r\n    \r\n    return {\r\n      id: `job-reminder-${job.id}-${Date.now()}`,\r\n      type: 'reminder',\r\n      priority,\r\n      title,\r\n      message,\r\n      actionLabel: 'View Job',\r\n      actionUrl: `/CleanerJobDetail/${job.id}`,\r\n      timestamp: new Date(),\r\n      read: false,\r\n      jobId: job.id\r\n    };\r\n  }\r\n  \r\n  // Check for jobs that are late\r\n  checkLateJobs() {\r\n    // Placeholder - would check jobs marked EN_ROUTE but not ARRIVED after expected time\r\n  }\r\n  \r\n  // Create late arrival notification\r\n  createLateArrivalNotification(job: JobRecord, minutesLate: number): Notification {\r\n    return {\r\n      id: `late-${job.id}-${Date.now()}`,\r\n      type: 'warning',\r\n      priority: 'high',\r\n      title: '‚ö†Ô∏è Running Late',\r\n      message: `You're ${minutesLate} minutes late for your job. Contact the client if needed.`,\r\n      actionLabel: 'Contact Support',\r\n      actionUrl: '/Support',\r\n      timestamp: new Date(),\r\n      read: false,\r\n      jobId: job.id\r\n    };\r\n  }\r\n  \r\n  // Check for photo reminders\r\n  checkPhotoReminders() {\r\n    // Placeholder - would check jobs IN_PROGRESS for > 30 min without photos\r\n  }\r\n  \r\n  // Create photo reminder\r\n  createPhotoReminderNotification(job: JobRecord, photoType: 'before' | 'after'): Notification {\r\n    return {\r\n      id: `photo-${job.id}-${photoType}-${Date.now()}`,\r\n      type: 'reminder',\r\n      priority: 'medium',\r\n      title: 'üì∏ Photo Reminder',\r\n      message: photoType === 'before' \r\n        ? 'Don\\'t forget to take before photos before you start cleaning!'\r\n        : 'Remember to take after photos to complete the job.',\r\n      actionLabel: 'Upload Photos',\r\n      actionUrl: `/CleanerJobDetail/${job.id}`,\r\n      timestamp: new Date(),\r\n      read: false,\r\n      jobId: job.id\r\n    };\r\n  }\r\n  \r\n  // Create achievement notifications\r\n  createAchievementNotification(\r\n    title: string,\r\n    message: string,\r\n    milestone: string\r\n  ): Notification {\r\n    return {\r\n      id: `achievement-${Date.now()}`,\r\n      type: 'achievement',\r\n      priority: 'low',\r\n      title: `üèÜ ${title}`,\r\n      message,\r\n      timestamp: new Date(),\r\n      read: false\r\n    };\r\n  }\r\n  \r\n  // Smart tips based on context\r\n  createContextualTip(job: JobRecord): Notification {\r\n    const tips = [\r\n      {\r\n        condition: (j: JobRecord) => j.cleaning_type === 'deep',\r\n        title: 'üí° Deep Cleaning Tip',\r\n        message: 'For deep cleans, focus on baseboards, light fixtures, and inside appliances for 5-star reviews!'\r\n      },\r\n      {\r\n        condition: (j: JobRecord) => j.bedrooms >= 3,\r\n        title: 'üí° Large Home Tip',\r\n        message: 'Start with the farthest room and work your way back to save time and energy.'\r\n      },\r\n      {\r\n        condition: (j: JobRecord) => j.cleaning_type === 'moveout',\r\n        title: 'üí° Move-Out Tip',\r\n        message: 'Check inside cabinets, closets, and drawers - these are often missed!'\r\n      }\r\n    ];\r\n    \r\n    const matchingTip = tips.find(tip => tip.condition(job));\r\n    \r\n    if (matchingTip) {\r\n      return {\r\n        id: `tip-${job.id}-${Date.now()}`,\r\n        type: 'tip',\r\n        priority: 'low',\r\n        title: matchingTip.title,\r\n        message: matchingTip.message,\r\n        timestamp: new Date(),\r\n        read: false,\r\n        jobId: job.id\r\n      };\r\n    }\r\n    \r\n    return null as any;\r\n  }\r\n  \r\n  // Weekly summary notification\r\n  createWeeklySummaryNotification(stats: {\r\n    jobsCompleted: number;\r\n    earnings: number;\r\n    avgRating: number;\r\n  }): Notification {\r\n    return {\r\n      id: `weekly-${Date.now()}`,\r\n      type: 'achievement',\r\n      priority: 'low',\r\n      title: 'üìä Weekly Summary',\r\n      message: `Great week! ${stats.jobsCompleted} jobs completed, $${stats.earnings.toFixed(2)} earned, ${stats.avgRating.toFixed(1)}‚≠ê avg rating.`,\r\n      actionLabel: 'View Analytics',\r\n      actionUrl: '/CleanerDashboard',\r\n      timestamp: new Date(),\r\n      read: false\r\n    };\r\n  }\r\n  \r\n  // Mark notification as read\r\n  markAsRead(notificationId: string) {\r\n    const notification = this.notifications.find(n => n.id === notificationId);\r\n    if (notification) {\r\n      notification.read = true;\r\n    }\r\n  }\r\n  \r\n  // Get all notifications\r\n  getAll(): Notification[] {\r\n    return this.notifications.sort((a, b) => \r\n      b.timestamp.getTime() - a.timestamp.getTime()\r\n    );\r\n  }\r\n  \r\n  // Get unread count\r\n  getUnreadCount(): number {\r\n    return this.notifications.filter(n => !n.read).length;\r\n  }\r\n  \r\n  // Clear old notifications\r\n  clearOld(daysOld: number = 7) {\r\n    const cutoff = new Date();\r\n    cutoff.setDate(cutoff.getDate() - daysOld);\r\n    \r\n    this.notifications = this.notifications.filter(\r\n      n => n.timestamp >= cutoff || !n.read\r\n    );\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const notificationService = new ProactiveNotificationService();\r\n\r\n// React Hook for notifications\r\nexport function useNotifications() {\r\n  const [notifications, setNotifications] = React.useState<Notification[]>([]);\r\n  const [unreadCount, setUnreadCount] = React.useState(0);\r\n  \r\n  React.useEffect(() => {\r\n    // Load initial notifications\r\n    setNotifications(notificationService.getAll());\r\n    setUnreadCount(notificationService.getUnreadCount());\r\n    \r\n    // Subscribe to new notifications\r\n    const unsubscribe = notificationService.subscribe((notification) => {\r\n      setNotifications(prev => [notification, ...prev]);\r\n      setUnreadCount(prev => prev + 1);\r\n    });\r\n    \r\n    return unsubscribe;\r\n  }, []);\r\n  \r\n  const markAsRead = (notificationId: string) => {\r\n    notificationService.markAsRead(notificationId);\r\n    setNotifications(notificationService.getAll());\r\n    setUnreadCount(notificationService.getUnreadCount());\r\n  };\r\n  \r\n  const clearOld = () => {\r\n    notificationService.clearOld();\r\n    setNotifications(notificationService.getAll());\r\n  };\r\n  \r\n  return {\r\n    notifications,\r\n    unreadCount,\r\n    markAsRead,\r\n    clearOld\r\n  };\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\pushNotificationService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":23,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Push Notification Service\r\n// Browser push notifications for instant alerts (even when app is closed)\r\n\r\nimport { base44 } from '@/api/base44Client';\r\n\r\n/**\r\n * Push Notification Service\r\n * Uses Web Push API for browser notifications\r\n * \r\n * Features:\r\n * - Works even when browser tab is closed\r\n * - Native OS notifications\r\n * - Click to open relevant page\r\n * - Rich notifications with icons and images\r\n * \r\n * Setup Instructions:\r\n * 1. Generate VAPID keys: https://web-push-codelab.glitch.me/\r\n * 2. Add to .env.local:\r\n *    VITE_VAPID_PUBLIC_KEY=your_public_key\r\n * 3. Add service worker for background notifications\r\n */\r\n\r\ninterface PushNotificationPayload {\r\n  title: string;\r\n  body: string;\r\n  icon?: string;\r\n  badge?: string;\r\n  image?: string;\r\n  data?: any;\r\n  actions?: Array<{ action: string; title: string }>;\r\n  tag?: string;\r\n  requireInteraction?: boolean;\r\n}\r\n\r\ninterface PushSubscriptionData {\r\n  endpoint: string;\r\n  keys: {\r\n    p256dh: string;\r\n    auth: string;\r\n  };\r\n}\r\n\r\nexport class PushNotificationService {\r\n  private enabled: boolean = false;\r\n  private vapidPublicKey: string | undefined;\r\n  private registration: ServiceWorkerRegistration | null = null;\r\n  private subscription: PushSubscription | null = null;\r\n\r\n  constructor() {\r\n    this.vapidPublicKey = import.meta.env.VITE_VAPID_PUBLIC_KEY;\r\n    this.initialize();\r\n  }\r\n\r\n  /**\r\n   * Initialize push notification service\r\n   */\r\n  private async initialize() {\r\n    // Check if service workers are supported\r\n    if (!('serviceWorker' in navigator)) {\r\n      console.warn('[PushNotificationService] Service workers not supported');\r\n      return;\r\n    }\r\n\r\n    // Check if Push API is supported\r\n    if (!('PushManager' in window)) {\r\n      console.warn('[PushNotificationService] Push API not supported');\r\n      return;\r\n    }\r\n\r\n    // Check if Notification API is supported\r\n    if (!('Notification' in window)) {\r\n      console.warn('[PushNotificationService] Notifications not supported');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Register service worker\r\n      this.registration = await navigator.serviceWorker.register('/sw.js');\r\n      console.log('[PushNotificationService] Service worker registered');\r\n\r\n      // Check existing subscription\r\n      this.subscription = await this.registration.pushManager.getSubscription();\r\n      \r\n      if (this.subscription) {\r\n        console.log('[PushNotificationService] Existing push subscription found');\r\n        this.enabled = true;\r\n      } else {\r\n        console.log('[PushNotificationService] No existing push subscription');\r\n      }\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Initialization error:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Request permission and subscribe to push notifications\r\n   */\r\n  async requestPermission(): Promise<boolean> {\r\n    if (!('Notification' in window)) {\r\n      console.warn('[PushNotificationService] Notifications not supported');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const permission = await Notification.requestPermission();\r\n      \r\n      if (permission === 'granted') {\r\n        console.log('[PushNotificationService] Permission granted');\r\n        \r\n        // Subscribe to push\r\n        const subscribed = await this.subscribe();\r\n        \r\n        if (subscribed) {\r\n          this.enabled = true;\r\n          return true;\r\n        }\r\n      } else if (permission === 'denied') {\r\n        console.warn('[PushNotificationService] Permission denied');\r\n      } else {\r\n        console.log('[PushNotificationService] Permission dismissed');\r\n      }\r\n      \r\n      return false;\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Permission request error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Subscribe to push notifications\r\n   */\r\n  private async subscribe(): Promise<boolean> {\r\n    if (!this.registration) {\r\n      console.error('[PushNotificationService] No service worker registration');\r\n      return false;\r\n    }\r\n\r\n    if (!this.vapidPublicKey) {\r\n      console.error('[PushNotificationService] VAPID public key not configured');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      // Convert VAPID key from base64 to Uint8Array\r\n      const vapidKey = this.urlBase64ToUint8Array(this.vapidPublicKey);\r\n      \r\n      // Subscribe\r\n      this.subscription = await this.registration.pushManager.subscribe({\r\n        userVisibleOnly: true,\r\n        applicationServerKey: vapidKey\r\n      });\r\n\r\n      console.log('[PushNotificationService] Subscribed to push notifications');\r\n\r\n      // Save subscription to database\r\n      await this.saveSubscription(this.subscription);\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Subscribe error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Unsubscribe from push notifications\r\n   */\r\n  async unsubscribe(): Promise<boolean> {\r\n    if (!this.subscription) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      await this.subscription.unsubscribe();\r\n      console.log('[PushNotificationService] Unsubscribed from push notifications');\r\n\r\n      // Remove subscription from database\r\n      await this.removeSubscription(this.subscription);\r\n\r\n      this.subscription = null;\r\n      this.enabled = false;\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Unsubscribe error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save push subscription to database\r\n   */\r\n  private async saveSubscription(subscription: PushSubscription) {\r\n    try {\r\n      const user = await base44.auth.me().catch(() => null);\r\n      if (!user) return;\r\n\r\n      const subscriptionData = subscription.toJSON();\r\n\r\n      await base44.entities.PushSubscription?.create({\r\n        user_email: user.email,\r\n        endpoint: subscriptionData.endpoint,\r\n        p256dh_key: subscriptionData.keys?.p256dh,\r\n        auth_key: subscriptionData.keys?.auth,\r\n        user_agent: navigator.userAgent,\r\n        created_at: new Date().toISOString()\r\n      }).catch(() => {\r\n        // Entity doesn't exist yet\r\n        console.log('[PushNotificationService] PushSubscription entity not found');\r\n      });\r\n\r\n      console.log('[PushNotificationService] Subscription saved to database');\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Failed to save subscription:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove push subscription from database\r\n   */\r\n  private async removeSubscription(subscription: PushSubscription) {\r\n    try {\r\n      const user = await base44.auth.me().catch(() => null);\r\n      if (!user) return;\r\n\r\n      const subscriptionData = subscription.toJSON();\r\n\r\n      // Find and delete subscription\r\n      const subs = await base44.entities.PushSubscription?.filter({\r\n        user_email: user.email,\r\n        endpoint: subscriptionData.endpoint\r\n      }).catch(() => []);\r\n\r\n      if (subs && subs.length > 0) {\r\n        await base44.entities.PushSubscription.delete(subs[0].id);\r\n        console.log('[PushNotificationService] Subscription removed from database');\r\n      }\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Failed to remove subscription:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show local push notification (doesn't require server)\r\n   * Useful for immediate feedback while server-side push is being processed\r\n   */\r\n  async showLocalNotification(payload: PushNotificationPayload): Promise<boolean> {\r\n    if (!this.registration) {\r\n      console.warn('[PushNotificationService] No service worker registration');\r\n      return false;\r\n    }\r\n\r\n    if (Notification.permission !== 'granted') {\r\n      console.warn('[PushNotificationService] Notification permission not granted');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      await this.registration.showNotification(payload.title, {\r\n        body: payload.body,\r\n        icon: payload.icon || '/icon-192.png',\r\n        badge: payload.badge || '/badge-72.png',\r\n        image: payload.image,\r\n        data: payload.data,\r\n        actions: payload.actions,\r\n        tag: payload.tag,\r\n        requireInteraction: payload.requireInteraction || false,\r\n        vibrate: [200, 100, 200]\r\n      });\r\n\r\n      console.log('[PushNotificationService] Local notification shown');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Show notification error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send push notification via server\r\n   * The server will use the saved subscription to send a push message\r\n   */\r\n  async sendPushNotification(userEmail: string, payload: PushNotificationPayload): Promise<boolean> {\r\n    try {\r\n      // Call backend function to send push\r\n      await base44.integrations.Core.InvokeServerlessFunction({\r\n        functionName: 'sendPushNotification',\r\n        payload: {\r\n          recipientEmail: userEmail,\r\n          notification: payload\r\n        }\r\n      });\r\n\r\n      console.log(`[PushNotificationService] Push notification sent to ${userEmail}`);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('[PushNotificationService] Send push error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if push notifications are enabled\r\n   */\r\n  isEnabled(): boolean {\r\n    return this.enabled && Notification.permission === 'granted';\r\n  }\r\n\r\n  /**\r\n   * Get current permission status\r\n   */\r\n  getPermissionStatus(): NotificationPermission {\r\n    return Notification.permission;\r\n  }\r\n\r\n  /**\r\n   * Check if push is supported\r\n   */\r\n  isSupported(): boolean {\r\n    return 'serviceWorker' in navigator && 'PushManager' in window && 'Notification' in window;\r\n  }\r\n\r\n  /**\r\n   * Convert VAPID key from base64 to Uint8Array\r\n   */\r\n  private urlBase64ToUint8Array(base64String: string): Uint8Array {\r\n    const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\r\n    const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\r\n    const rawData = window.atob(base64);\r\n    const outputArray = new Uint8Array(rawData.length);\r\n    for (let i = 0; i < rawData.length; ++i) {\r\n      outputArray[i] = rawData.charCodeAt(i);\r\n    }\r\n    return outputArray;\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const pushNotificationService = new PushNotificationService();\r\n\r\n// ============================================================================\r\n// NOTIFICATION TEMPLATES (ready-to-use push notifications)\r\n// ============================================================================\r\n\r\n/**\r\n * Client Push Notification Templates\r\n */\r\nexport const ClientPushTemplates = {\r\n  cleanerEnRoute: (cleanerName: string, eta: string) => ({\r\n    title: 'üöó Your cleaner is on the way!',\r\n    body: `${cleanerName} is heading to your location. ETA: ${eta}`,\r\n    icon: '/icons/car.png',\r\n    tag: 'cleaner-en-route',\r\n    requireInteraction: true,\r\n    data: { type: 'cleaner_en_route' }\r\n  }),\r\n\r\n  cleanerArrived: (cleanerName: string) => ({\r\n    title: 'üìç Your cleaner has arrived!',\r\n    body: `${cleanerName} checked in at your location and will start shortly.`,\r\n    icon: '/icons/checkmark.png',\r\n    tag: 'cleaner-arrived',\r\n    requireInteraction: true,\r\n    data: { type: 'cleaner_arrived' }\r\n  }),\r\n\r\n  extraTimeRequested: (cleanerName: string, minutes: number, cost: string) => ({\r\n    title: '‚è∞ Extra time requested - Approval needed',\r\n    body: `${cleanerName} requests ${minutes} extra minutes (+$${cost}). Tap to approve or deny.`,\r\n    icon: '/icons/clock.png',\r\n    tag: 'extra-time-request',\r\n    requireInteraction: true,\r\n    actions: [\r\n      { action: 'approve', title: 'Approve' },\r\n      { action: 'deny', title: 'Deny' }\r\n    ],\r\n    data: { type: 'extra_time_request', urgent: true }\r\n  }),\r\n\r\n  jobCompleted: (cleanerName: string) => ({\r\n    title: '‚úÖ Cleaning complete!',\r\n    body: `${cleanerName} has finished. Please review and approve the work.`,\r\n    icon: '/icons/checkmark.png',\r\n    tag: 'job-completed',\r\n    requireInteraction: true,\r\n    data: { type: 'job_completed' }\r\n  })\r\n};\r\n\r\n/**\r\n * Cleaner Push Notification Templates\r\n */\r\nexport const CleanerPushTemplates = {\r\n  jobOffer: (clientName: string, pay: string) => ({\r\n    title: 'üÜï New job offer!',\r\n    body: `${clientName} wants to book you. Pay: $${pay}. Tap to respond.`,\r\n    icon: '/icons/briefcase.png',\r\n    tag: 'job-offer',\r\n    requireInteraction: true,\r\n    actions: [\r\n      { action: 'accept', title: 'Accept' },\r\n      { action: 'decline', title: 'Decline' }\r\n    ],\r\n    data: { type: 'job_offer' }\r\n  }),\r\n\r\n  jobReminder: (clientName: string, minutes: number) => ({\r\n    title: `‚è∞ Job starting in ${minutes} minutes`,\r\n    body: `Reminder: Job with ${clientName}. Don't forget to GPS check-in!`,\r\n    icon: '/icons/clock.png',\r\n    tag: 'job-reminder',\r\n    requireInteraction: true,\r\n    data: { type: 'job_reminder' }\r\n  }),\r\n\r\n  extraTimeApproved: (minutes: number) => ({\r\n    title: '‚úÖ Extra time approved!',\r\n    body: `Client approved ${minutes} extra minutes. Continue working!`,\r\n    icon: '/icons/checkmark.png',\r\n    tag: 'extra-time-approved',\r\n    data: { type: 'extra_time_approved' }\r\n  }),\r\n\r\n  lateWarning: (minutes: number) => ({\r\n    title: '‚ö†Ô∏è Late arrival alert',\r\n    body: `You're ${minutes} min late. Please notify the client.`,\r\n    icon: '/icons/warning.png',\r\n    tag: 'late-warning',\r\n    requireInteraction: true,\r\n    data: { type: 'late_warning', urgent: true }\r\n  })\r\n};\r\n\r\n// Export default instance\r\nexport default pushNotificationService;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\realTimeNotificationService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token type","line":23,"column":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Real-Time Notification Service\r\n// Instant notification delivery via WebSocket or Server-Sent Events (SSE)\r\n\r\nimport { base44 } from '@/api/base44Client';\r\n\r\n/**\r\n * Real-Time Notification Service\r\n * Replaces 30-second polling with instant WebSocket delivery\r\n * \r\n * Features:\r\n * - <1 second latency\r\n * - Automatic reconnection\r\n * - Heartbeat monitoring\r\n * - Fallback to polling if WebSocket unavailable\r\n * \r\n * Architecture Options:\r\n * 1. Base44 Real-time (if available)\r\n * 2. WebSocket (custom)\r\n * 3. Server-Sent Events (SSE)\r\n * 4. Fallback to polling (current)\r\n */\r\n\r\nexport type NotificationCallback = (notification: any) => void;\r\nexport type ConnectionStatusCallback = (status: 'connected' | 'disconnected' | 'connecting' | 'error') => void;\r\n\r\ninterface RealTimeConfig {\r\n  autoReconnect?: boolean;\r\n  reconnectInterval?: number;\r\n  heartbeatInterval?: number;\r\n  maxReconnectAttempts?: number;\r\n}\r\n\r\nexport class RealTimeNotificationService {\r\n  private ws: WebSocket | null = null;\r\n  private eventSource: EventSource | null = null;\r\n  private pollingInterval: NodeJS.Timeout | null = null;\r\n  \r\n  private mode: 'websocket' | 'sse' | 'polling' = 'polling';\r\n  private connected: boolean = false;\r\n  private reconnectAttempts: number = 0;\r\n  private reconnectTimeout: NodeJS.Timeout | null = null;\r\n  private heartbeatTimeout: NodeJS.Timeout | null = null;\r\n  \r\n  private notificationCallbacks: NotificationCallback[] = [];\r\n  private statusCallbacks: ConnectionStatusCallback[] = [];\r\n  \r\n  private config: Required<RealTimeConfig> = {\r\n    autoReconnect: true,\r\n    reconnectInterval: 3000,\r\n    heartbeatInterval: 30000,\r\n    maxReconnectAttempts: 10\r\n  };\r\n\r\n  private userEmail: string | null = null;\r\n\r\n  constructor(config?: RealTimeConfig) {\r\n    if (config) {\r\n      this.config = { ...this.config, ...config };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Connect to real-time notification service\r\n   */\r\n  async connect(userEmail: string): Promise<boolean> {\r\n    this.userEmail = userEmail;\r\n    this.updateStatus('connecting');\r\n\r\n    console.log('[RealTimeNotificationService] Connecting for user:', userEmail);\r\n\r\n    // Try WebSocket first\r\n    if (await this.tryWebSocket()) {\r\n      return true;\r\n    }\r\n\r\n    // Fall back to Server-Sent Events\r\n    if (await this.trySSE()) {\r\n      return true;\r\n    }\r\n\r\n    // Fall back to polling\r\n    console.log('[RealTimeNotificationService] Falling back to polling mode');\r\n    this.startPolling();\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Disconnect from real-time service\r\n   */\r\n  disconnect() {\r\n    console.log('[RealTimeNotificationService] Disconnecting...');\r\n\r\n    this.connected = false;\r\n    this.updateStatus('disconnected');\r\n\r\n    // Clear reconnect timeout\r\n    if (this.reconnectTimeout) {\r\n      clearTimeout(this.reconnectTimeout);\r\n      this.reconnectTimeout = null;\r\n    }\r\n\r\n    // Clear heartbeat\r\n    if (this.heartbeatTimeout) {\r\n      clearTimeout(this.heartbeatTimeout);\r\n      this.heartbeatTimeout = null;\r\n    }\r\n\r\n    // Close WebSocket\r\n    if (this.ws) {\r\n      this.ws.close();\r\n      this.ws = null;\r\n    }\r\n\r\n    // Close SSE\r\n    if (this.eventSource) {\r\n      this.eventSource.close();\r\n      this.eventSource = null;\r\n    }\r\n\r\n    // Stop polling\r\n    if (this.pollingInterval) {\r\n      clearInterval(this.pollingInterval);\r\n      this.pollingInterval = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Subscribe to notifications\r\n   */\r\n  subscribe(callback: NotificationCallback): () => void {\r\n    this.notificationCallbacks.push(callback);\r\n    \r\n    return () => {\r\n      this.notificationCallbacks = this.notificationCallbacks.filter(cb => cb !== callback);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Subscribe to connection status changes\r\n   */\r\n  onStatusChange(callback: ConnectionStatusCallback): () => void {\r\n    this.statusCallbacks.push(callback);\r\n    \r\n    return () => {\r\n      this.statusCallbacks = this.statusCallbacks.filter(cb => cb !== callback);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if connected\r\n   */\r\n  isConnected(): boolean {\r\n    return this.connected;\r\n  }\r\n\r\n  /**\r\n   * Get current connection mode\r\n   */\r\n  getMode(): 'websocket' | 'sse' | 'polling' {\r\n    return this.mode;\r\n  }\r\n\r\n  // ============================================================================\r\n  // WEBSOCKET IMPLEMENTATION\r\n  // ============================================================================\r\n\r\n  private async tryWebSocket(): Promise<boolean> {\r\n    // Check if WebSocket is supported\r\n    if (typeof WebSocket === 'undefined') {\r\n      console.log('[RealTimeNotificationService] WebSocket not supported');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      // Determine WebSocket URL\r\n      const wsUrl = this.getWebSocketURL();\r\n      \r\n      if (!wsUrl) {\r\n        console.log('[RealTimeNotificationService] WebSocket URL not configured');\r\n        return false;\r\n      }\r\n\r\n      console.log('[RealTimeNotificationService] Connecting to WebSocket:', wsUrl);\r\n\r\n      this.ws = new WebSocket(wsUrl);\r\n\r\n      // Set up event handlers\r\n      return new Promise((resolve) => {\r\n        if (!this.ws) {\r\n          resolve(false);\r\n          return;\r\n        }\r\n\r\n        // Connection opened\r\n        this.ws.onopen = () => {\r\n          console.log('[RealTimeNotificationService] WebSocket connected');\r\n          this.mode = 'websocket';\r\n          this.connected = true;\r\n          this.reconnectAttempts = 0;\r\n          this.updateStatus('connected');\r\n          this.startHeartbeat();\r\n          \r\n          // Send authentication\r\n          this.ws?.send(JSON.stringify({\r\n            type: 'auth',\r\n            userEmail: this.userEmail\r\n          }));\r\n          \r\n          resolve(true);\r\n        };\r\n\r\n        // Message received\r\n        this.ws.onmessage = (event) => {\r\n          try {\r\n            const data = JSON.parse(event.data);\r\n            \r\n            if (data.type === 'notification') {\r\n              this.handleNotification(data.payload);\r\n            } else if (data.type === 'pong') {\r\n              // Heartbeat response\r\n              console.log('[RealTimeNotificationService] Heartbeat OK');\r\n            }\r\n          } catch (error) {\r\n            console.error('[RealTimeNotificationService] Message parse error:', error);\r\n          }\r\n        };\r\n\r\n        // Connection closed\r\n        this.ws.onclose = () => {\r\n          console.log('[RealTimeNotificationService] WebSocket disconnected');\r\n          this.connected = false;\r\n          this.updateStatus('disconnected');\r\n          \r\n          if (this.config.autoReconnect && this.reconnectAttempts < this.config.maxReconnectAttempts) {\r\n            this.scheduleReconnect();\r\n          }\r\n        };\r\n\r\n        // Connection error\r\n        this.ws.onerror = (error) => {\r\n          console.error('[RealTimeNotificationService] WebSocket error:', error);\r\n          this.updateStatus('error');\r\n          resolve(false);\r\n        };\r\n\r\n        // Timeout if connection doesn't open in 5 seconds\r\n        setTimeout(() => {\r\n          if (!this.connected) {\r\n            console.log('[RealTimeNotificationService] WebSocket connection timeout');\r\n            this.ws?.close();\r\n            resolve(false);\r\n          }\r\n        }, 5000);\r\n      });\r\n    } catch (error) {\r\n      console.error('[RealTimeNotificationService] WebSocket connection error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get WebSocket URL\r\n   * This would typically come from environment variables or Base44 config\r\n   */\r\n  private getWebSocketURL(): string | null {\r\n    // Check if Base44 provides WebSocket URL\r\n    const base44WsUrl = (base44 as any).realtime?.websocketUrl;\r\n    if (base44WsUrl) {\r\n      return base44WsUrl;\r\n    }\r\n\r\n    // Check environment variable\r\n    const envWsUrl = import.meta.env.VITE_WEBSOCKET_URL;\r\n    if (envWsUrl) {\r\n      return envWsUrl;\r\n    }\r\n\r\n    // Default: construct from current URL\r\n    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\r\n    const host = window.location.host;\r\n    \r\n    // This assumes you have a WebSocket server at /ws\r\n    // You may need to adjust this based on your backend setup\r\n    return `${protocol}//${host}/ws`;\r\n  }\r\n\r\n  /**\r\n   * Start heartbeat to keep connection alive\r\n   */\r\n  private startHeartbeat() {\r\n    if (this.heartbeatTimeout) {\r\n      clearTimeout(this.heartbeatTimeout);\r\n    }\r\n\r\n    this.heartbeatTimeout = setTimeout(() => {\r\n      if (this.ws && this.ws.readyState === WebSocket.OPEN) {\r\n        this.ws.send(JSON.stringify({ type: 'ping' }));\r\n        this.startHeartbeat(); // Schedule next heartbeat\r\n      }\r\n    }, this.config.heartbeatInterval);\r\n  }\r\n\r\n  // ============================================================================\r\n  // SERVER-SENT EVENTS (SSE) IMPLEMENTATION\r\n  // ============================================================================\r\n\r\n  private async trySSE(): Promise<boolean> {\r\n    // Check if EventSource is supported\r\n    if (typeof EventSource === 'undefined') {\r\n      console.log('[RealTimeNotificationService] SSE not supported');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      // Determine SSE URL\r\n      const sseUrl = this.getSSEURL();\r\n      \r\n      if (!sseUrl) {\r\n        console.log('[RealTimeNotificationService] SSE URL not configured');\r\n        return false;\r\n      }\r\n\r\n      console.log('[RealTimeNotificationService] Connecting to SSE:', sseUrl);\r\n\r\n      this.eventSource = new EventSource(sseUrl);\r\n\r\n      // Set up event handlers\r\n      return new Promise((resolve) => {\r\n        if (!this.eventSource) {\r\n          resolve(false);\r\n          return;\r\n        }\r\n\r\n        // Connection opened\r\n        this.eventSource.onopen = () => {\r\n          console.log('[RealTimeNotificationService] SSE connected');\r\n          this.mode = 'sse';\r\n          this.connected = true;\r\n          this.reconnectAttempts = 0;\r\n          this.updateStatus('connected');\r\n          resolve(true);\r\n        };\r\n\r\n        // Message received\r\n        this.eventSource.onmessage = (event) => {\r\n          try {\r\n            const data = JSON.parse(event.data);\r\n            this.handleNotification(data);\r\n          } catch (error) {\r\n            console.error('[RealTimeNotificationService] SSE message parse error:', error);\r\n          }\r\n        };\r\n\r\n        // Connection error\r\n        this.eventSource.onerror = (error) => {\r\n          console.error('[RealTimeNotificationService] SSE error:', error);\r\n          this.connected = false;\r\n          this.updateStatus('error');\r\n          \r\n          if (this.config.autoReconnect && this.reconnectAttempts < this.config.maxReconnectAttempts) {\r\n            this.scheduleReconnect();\r\n          }\r\n          \r\n          resolve(false);\r\n        };\r\n\r\n        // Timeout if connection doesn't open in 5 seconds\r\n        setTimeout(() => {\r\n          if (!this.connected) {\r\n            console.log('[RealTimeNotificationService] SSE connection timeout');\r\n            this.eventSource?.close();\r\n            resolve(false);\r\n          }\r\n        }, 5000);\r\n      });\r\n    } catch (error) {\r\n      console.error('[RealTimeNotificationService] SSE connection error:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get SSE URL\r\n   */\r\n  private getSSEURL(): string | null {\r\n    // Check if Base44 provides SSE URL\r\n    const base44SseUrl = (base44 as any).realtime?.sseUrl;\r\n    if (base44SseUrl) {\r\n      return `${base44SseUrl}?user=${encodeURIComponent(this.userEmail || '')}`;\r\n    }\r\n\r\n    // Check environment variable\r\n    const envSseUrl = import.meta.env.VITE_SSE_URL;\r\n    if (envSseUrl) {\r\n      return `${envSseUrl}?user=${encodeURIComponent(this.userEmail || '')}`;\r\n    }\r\n\r\n    // Default: construct from current URL\r\n    return `/api/notifications/stream?user=${encodeURIComponent(this.userEmail || '')}`;\r\n  }\r\n\r\n  // ============================================================================\r\n  // POLLING FALLBACK\r\n  // ============================================================================\r\n\r\n  private startPolling() {\r\n    console.log('[RealTimeNotificationService] Starting polling mode (30s interval)');\r\n    \r\n    this.mode = 'polling';\r\n    this.connected = true;\r\n    this.updateStatus('connected');\r\n\r\n    // Initial fetch\r\n    this.pollNotifications();\r\n\r\n    // Set up polling interval (30 seconds)\r\n    this.pollingInterval = setInterval(() => {\r\n      this.pollNotifications();\r\n    }, 30000);\r\n  }\r\n\r\n  private async pollNotifications() {\r\n    if (!this.userEmail) return;\r\n\r\n    try {\r\n      // Fetch latest notifications\r\n      const notifications = await base44.entities.Notification?.filter(\r\n        { recipient_email: this.userEmail, is_read: false },\r\n        '-created_date',\r\n        10\r\n      ).catch(() => []);\r\n\r\n      if (notifications && notifications.length > 0) {\r\n        console.log(`[RealTimeNotificationService] Polled ${notifications.length} new notifications`);\r\n        \r\n        notifications.forEach(notification => {\r\n          this.handleNotification(notification);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('[RealTimeNotificationService] Polling error:', error);\r\n    }\r\n  }\r\n\r\n  // ============================================================================\r\n  // RECONNECTION LOGIC\r\n  // ============================================================================\r\n\r\n  private scheduleReconnect() {\r\n    if (this.reconnectTimeout) {\r\n      clearTimeout(this.reconnectTimeout);\r\n    }\r\n\r\n    this.reconnectAttempts++;\r\n    const delay = Math.min(this.config.reconnectInterval * this.reconnectAttempts, 30000);\r\n\r\n    console.log(`[RealTimeNotificationService] Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`);\r\n\r\n    this.reconnectTimeout = setTimeout(() => {\r\n      if (this.userEmail) {\r\n        this.connect(this.userEmail);\r\n      }\r\n    }, delay);\r\n  }\r\n\r\n  // ============================================================================\r\n  // NOTIFICATION HANDLING\r\n  // ============================================================================\r\n\r\n  private handleNotification(notification: any) {\r\n    console.log('[RealTimeNotificationService] Notification received:', notification);\r\n    \r\n    // Call all subscribed callbacks\r\n    this.notificationCallbacks.forEach(callback => {\r\n      try {\r\n        callback(notification);\r\n      } catch (error) {\r\n        console.error('[RealTimeNotificationService] Callback error:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  private updateStatus(status: 'connected' | 'disconnected' | 'connecting' | 'error') {\r\n    console.log(`[RealTimeNotificationService] Status: ${status}`);\r\n    \r\n    // Call all status callbacks\r\n    this.statusCallbacks.forEach(callback => {\r\n      try {\r\n        callback(status);\r\n      } catch (error) {\r\n        console.error('[RealTimeNotificationService] Status callback error:', error);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const realTimeNotificationService = new RealTimeNotificationService();\r\n\r\n// Export default\r\nexport default realTimeNotificationService;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\routeOptimizationService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":5,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Route Optimization Service\r\n// Calculates optimal routes and provides travel insights\r\n\r\n// Using inline type definition to avoid import issues\r\ninterface JobRecord {\r\n  id: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  address?: string;\r\n  start_time?: string;\r\n  estimated_hours?: number;\r\n  duration_hours?: number;\r\n}\r\n\r\nexport interface RouteOptimization {\r\n  totalDistance: number; // miles\r\n  totalDuration: number; // minutes\r\n  estimatedFuelCost: number;\r\n  optimizedOrder: JobRecord[];\r\n  savings: {\r\n    distance: number;\r\n    time: number;\r\n    cost: number;\r\n  };\r\n}\r\n\r\nexport interface JobLocation {\r\n  jobId: string;\r\n  address: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  scheduledTime: string;\r\n  duration: number;\r\n}\r\n\r\nexport class RouteOptimizationService {\r\n  \r\n  // Calculate distance between two points (Haversine formula)\r\n  calculateDistance(\r\n    lat1: number,\r\n    lng1: number,\r\n    lat2: number,\r\n    lng2: number\r\n  ): number {\r\n    const R = 3959; // Earth radius in miles\r\n    const dLat = this.toRad(lat2 - lat1);\r\n    const dLng = this.toRad(lng2 - lng1);\r\n    \r\n    const a =\r\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n      Math.cos(this.toRad(lat1)) *\r\n      Math.cos(this.toRad(lat2)) *\r\n      Math.sin(dLng / 2) *\r\n      Math.sin(dLng / 2);\r\n    \r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return R * c;\r\n  }\r\n  \r\n  private toRad(value: number): number {\r\n    return (value * Math.PI) / 180;\r\n  }\r\n  \r\n  // Estimate travel time based on distance\r\n  estimateTravelTime(distanceMiles: number): number {\r\n    // Assume average speed of 25 mph in city\r\n    const avgSpeedMph = 25;\r\n    const timeHours = distanceMiles / avgSpeedMph;\r\n    return Math.ceil(timeHours * 60); // Convert to minutes\r\n  }\r\n  \r\n  // Calculate fuel cost\r\n  calculateFuelCost(distanceMiles: number): number {\r\n    const avgMpg = 25; // Average fuel economy\r\n    const gasPrice = 3.50; // Average gas price per gallon\r\n    const gallonsUsed = distanceMiles / avgMpg;\r\n    return gallonsUsed * gasPrice;\r\n  }\r\n  \r\n  // Optimize route for multiple jobs using nearest neighbor algorithm\r\n  optimizeRoute(\r\n    jobs: JobRecord[],\r\n    startLocation?: { lat: number; lng: number }\r\n  ): RouteOptimization {\r\n    if (jobs.length === 0) {\r\n      return {\r\n        totalDistance: 0,\r\n        totalDuration: 0,\r\n        estimatedFuelCost: 0,\r\n        optimizedOrder: [],\r\n        savings: { distance: 0, time: 0, cost: 0 }\r\n      };\r\n    }\r\n    \r\n    // Start from cleaner's current location or first job\r\n    let currentLat = startLocation?.lat || jobs[0].latitude;\r\n    let currentLng = startLocation?.lng || jobs[0].longitude;\r\n    \r\n    const unvisited = [...jobs];\r\n    const optimizedOrder: JobRecord[] = [];\r\n    let totalDistance = 0;\r\n    let totalDuration = 0;\r\n    \r\n    // Nearest neighbor algorithm\r\n    while (unvisited.length > 0) {\r\n      let nearestIndex = 0;\r\n      let nearestDistance = Infinity;\r\n      \r\n      // Find nearest unvisited job\r\n      unvisited.forEach((job, index) => {\r\n        const distance = this.calculateDistance(\r\n          currentLat,\r\n          currentLng,\r\n          job.latitude,\r\n          job.longitude\r\n        );\r\n        \r\n        if (distance < nearestDistance) {\r\n          nearestDistance = distance;\r\n          nearestIndex = index;\r\n        }\r\n      });\r\n      \r\n      // Visit nearest job\r\n      const nextJob = unvisited.splice(nearestIndex, 1)[0];\r\n      optimizedOrder.push(nextJob);\r\n      \r\n      totalDistance += nearestDistance;\r\n      totalDuration += this.estimateTravelTime(nearestDistance);\r\n      totalDuration += (nextJob.duration_hours || nextJob.estimated_hours || 0) * 60; // Add job duration\r\n      \r\n      currentLat = nextJob.latitude;\r\n      currentLng = nextJob.longitude;\r\n    }\r\n    \r\n    const estimatedFuelCost = this.calculateFuelCost(totalDistance);\r\n    \r\n    // Calculate savings vs simple sequential order\r\n    const sequentialDistance = this.calculateSequentialDistance(jobs, startLocation);\r\n    const savings = {\r\n      distance: sequentialDistance - totalDistance,\r\n      time: this.estimateTravelTime(sequentialDistance - totalDistance),\r\n      cost: this.calculateFuelCost(sequentialDistance - totalDistance)\r\n    };\r\n    \r\n    return {\r\n      totalDistance,\r\n      totalDuration,\r\n      estimatedFuelCost,\r\n      optimizedOrder,\r\n      savings\r\n    };\r\n  }\r\n  \r\n  // Calculate distance for sequential (non-optimized) order\r\n  private calculateSequentialDistance(\r\n    jobs: JobRecord[],\r\n    startLocation?: { lat: number; lng: number }\r\n  ): number {\r\n    if (jobs.length === 0) return 0;\r\n    \r\n    let total = 0;\r\n    let currentLat = startLocation?.lat || jobs[0].latitude;\r\n    let currentLng = startLocation?.lng || jobs[0].longitude;\r\n    \r\n    jobs.forEach(job => {\r\n      total += this.calculateDistance(currentLat, currentLng, job.latitude, job.longitude);\r\n      currentLat = job.latitude;\r\n      currentLng = job.longitude;\r\n    });\r\n    \r\n    return total;\r\n  }\r\n  \r\n  // Get jobs grouped by area (clustering)\r\n  groupJobsByArea(jobs: JobRecord[], radiusMiles: number = 5): JobRecord[][] {\r\n    const clusters: JobRecord[][] = [];\r\n    const processed = new Set<string>();\r\n    \r\n    jobs.forEach(job => {\r\n      if (processed.has(job.id)) return;\r\n      \r\n      // Start new cluster\r\n      const cluster: JobRecord[] = [job];\r\n      processed.add(job.id);\r\n      \r\n      // Find nearby jobs\r\n      jobs.forEach(otherJob => {\r\n        if (processed.has(otherJob.id)) return;\r\n        \r\n        const distance = this.calculateDistance(\r\n          job.latitude,\r\n          job.longitude,\r\n          otherJob.latitude,\r\n          otherJob.longitude\r\n        );\r\n        \r\n        if (distance <= radiusMiles) {\r\n          cluster.push(otherJob);\r\n          processed.add(otherJob.id);\r\n        }\r\n      });\r\n      \r\n      clusters.push(cluster);\r\n    });\r\n    \r\n    return clusters;\r\n  }\r\n  \r\n  // Find jobs within radius\r\n  findJobsNearby(\r\n    centerLat: number,\r\n    centerLng: number,\r\n    jobs: JobRecord[],\r\n    radiusMiles: number\r\n  ): JobRecord[] {\r\n    return jobs.filter(job => {\r\n      const distance = this.calculateDistance(\r\n        centerLat,\r\n        centerLng,\r\n        job.latitude,\r\n        job.longitude\r\n      );\r\n      return distance <= radiusMiles;\r\n    });\r\n  }\r\n  \r\n  // Get recommended route with directions\r\n  getRouteDirections(jobs: JobRecord[]): Array<{\r\n    from: string;\r\n    to: string;\r\n    distance: number;\r\n    duration: number;\r\n    instruction: string;\r\n  }> {\r\n    if (jobs.length < 2) return [];\r\n    \r\n      const directions: Array<{\r\n        from: string;\r\n        to: string;\r\n        distance: number;\r\n        duration: number;\r\n        instruction: string;\r\n      }> = [];\r\n    \r\n    for (let i = 0; i < jobs.length - 1; i++) {\r\n      const current = jobs[i];\r\n      const next = jobs[i + 1];\r\n      \r\n      const distance = this.calculateDistance(\r\n        current.latitude,\r\n        current.longitude,\r\n        next.latitude,\r\n        next.longitude\r\n      );\r\n      \r\n      const duration = this.estimateTravelTime(distance);\r\n      \r\n      directions.push({\r\n        from: current.address || 'Unknown',\r\n        to: next.address || 'Unknown',\r\n        distance: parseFloat(distance.toFixed(1)),\r\n        duration,\r\n        instruction: `Drive ${distance.toFixed(1)} miles (${duration} min) from ${current.address || 'location'} to ${next.address || 'next location'}`\r\n      });\r\n    }\r\n    \r\n    return directions;\r\n  }\r\n  \r\n  // Calculate daily efficiency score\r\n  calculateEfficiencyScore(\r\n    jobs: JobRecord[],\r\n    actualRoute?: JobRecord[]\r\n  ): {\r\n    score: number; // 0-100\r\n    rating: 'excellent' | 'good' | 'fair' | 'poor';\r\n    factors: {\r\n      routeOptimization: number;\r\n      timeUtilization: number;\r\n      areaConcentration: number;\r\n    };\r\n  } {\r\n    const optimized = this.optimizeRoute(jobs);\r\n    const actualDistance = actualRoute \r\n      ? this.calculateSequentialDistance(actualRoute)\r\n      : optimized.totalDistance;\r\n    \r\n    // Route optimization (how close to optimal)\r\n    const routeScore = Math.max(0, 100 - ((actualDistance - optimized.totalDistance) / optimized.totalDistance) * 100);\r\n    \r\n    // Time utilization (job time vs travel time)\r\n    const jobTime = jobs.reduce((sum, j) => sum + ((j.duration_hours || j.estimated_hours || 0) * 60), 0);\r\n    const timeScore = (jobTime / (jobTime + optimized.totalDuration)) * 100;\r\n    \r\n    // Area concentration (jobs within same area)\r\n    const clusters = this.groupJobsByArea(jobs, 3);\r\n    const areaScore = (1 - (clusters.length / jobs.length)) * 100;\r\n    \r\n    const overallScore = (routeScore + timeScore + areaScore) / 3;\r\n    \r\n    let rating: 'excellent' | 'good' | 'fair' | 'poor';\r\n    if (overallScore >= 85) rating = 'excellent';\r\n    else if (overallScore >= 70) rating = 'good';\r\n    else if (overallScore >= 50) rating = 'fair';\r\n    else rating = 'poor';\r\n    \r\n    return {\r\n      score: Math.round(overallScore),\r\n      rating,\r\n      factors: {\r\n        routeOptimization: Math.round(routeScore),\r\n        timeUtilization: Math.round(timeScore),\r\n        areaConcentration: Math.round(areaScore)\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const routeOptimizationService = new RouteOptimizationService();\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\services\\smsService.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":22,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// SMS Service with Twilio Integration\r\n// Sends time-sensitive notifications via SMS\r\n\r\nimport { base44 } from '@/api/base44Client';\r\n\r\n/**\r\n * SMS Service\r\n * Handles SMS notifications via Twilio for time-sensitive alerts\r\n * \r\n * Setup Instructions:\r\n * 1. Sign up at https://www.twilio.com\r\n * 2. Get your Account SID and Auth Token\r\n * 3. Purchase a phone number\r\n * 4. Add to .env.local:\r\n *    VITE_TWILIO_ACCOUNT_SID=your_account_sid\r\n *    VITE_TWILIO_AUTH_TOKEN=your_auth_token\r\n *    VITE_TWILIO_PHONE_NUMBER=+1234567890\r\n * \r\n * For production, use Twilio Functions (serverless) to keep credentials secure\r\n */\r\n\r\ninterface SMSMessage {\r\n  to: string;\r\n  message: string;\r\n  priority?: 'high' | 'normal' | 'low';\r\n}\r\n\r\ninterface SMSResult {\r\n  success: boolean;\r\n  messageId?: string;\r\n  error?: string;\r\n  timestamp: string;\r\n}\r\n\r\nexport class SMSService {\r\n  private enabled: boolean = false;\r\n  private twilioAccountSid: string | undefined;\r\n  private twilioAuthToken: string | undefined;\r\n  private twilioPhoneNumber: string | undefined;\r\n\r\n  constructor() {\r\n    // Check if Twilio credentials are configured\r\n    this.twilioAccountSid = import.meta.env.VITE_TWILIO_ACCOUNT_SID;\r\n    this.twilioAuthToken = import.meta.env.VITE_TWILIO_AUTH_TOKEN;\r\n    this.twilioPhoneNumber = import.meta.env.VITE_TWILIO_PHONE_NUMBER;\r\n\r\n    this.enabled = !!(this.twilioAccountSid && this.twilioAuthToken && this.twilioPhoneNumber);\r\n\r\n    if (!this.enabled) {\r\n      console.warn('[SMSService] Twilio credentials not configured. SMS notifications will be logged only.');\r\n    } else {\r\n      console.log('[SMSService] Twilio configured. SMS notifications enabled.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send SMS via Twilio\r\n   * \r\n   * Note: For production, this should be a serverless function to keep credentials secure\r\n   * Never expose Twilio credentials in frontend code\r\n   */\r\n  async sendSMS({ to, message, priority = 'normal' }: SMSMessage): Promise<SMSResult> {\r\n    const timestamp = new Date().toISOString();\r\n\r\n    // Validate phone number format\r\n    if (!this.isValidPhoneNumber(to)) {\r\n      console.error(`[SMSService] Invalid phone number: ${to}`);\r\n      return {\r\n        success: false,\r\n        error: 'Invalid phone number format',\r\n        timestamp\r\n      };\r\n    }\r\n\r\n    // If Twilio not configured, log only (dev mode)\r\n    if (!this.enabled) {\r\n      console.log(`[SMSService] [${priority.toUpperCase()}] Would send SMS to ${to}: ${message}`);\r\n      \r\n      // Store in database for tracking (even in dev mode)\r\n      await this.logSMS({ to, message, priority, status: 'dev_mode', timestamp });\r\n      \r\n      return {\r\n        success: true,\r\n        messageId: `dev_${Date.now()}`,\r\n        timestamp\r\n      };\r\n    }\r\n\r\n    try {\r\n      // PRODUCTION: Use Base44 serverless function to send SMS securely\r\n      // This keeps Twilio credentials on the backend\r\n      const result = await base44.integrations.Core.InvokeServerlessFunction({\r\n        functionName: 'sendTwilioSMS',\r\n        payload: {\r\n          to: to,\r\n          from: this.twilioPhoneNumber,\r\n          body: message,\r\n          accountSid: this.twilioAccountSid,\r\n          authToken: this.twilioAuthToken\r\n        }\r\n      });\r\n\r\n      console.log(`[SMSService] SMS sent successfully to ${to}. SID: ${result.sid}`);\r\n\r\n      // Log to database for tracking\r\n      await this.logSMS({ to, message, priority, status: 'sent', timestamp, sid: result.sid });\r\n\r\n      return {\r\n        success: true,\r\n        messageId: result.sid,\r\n        timestamp\r\n      };\r\n\r\n    } catch (error: any) {\r\n      console.error('[SMSService] Failed to send SMS:', error);\r\n\r\n      // Log failed attempt\r\n      await this.logSMS({ to, message, priority, status: 'failed', timestamp, error: error.message });\r\n\r\n      return {\r\n        success: false,\r\n        error: error.message || 'Failed to send SMS',\r\n        timestamp\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Send batch SMS messages\r\n   */\r\n  async sendBatchSMS(messages: SMSMessage[]): Promise<SMSResult[]> {\r\n    console.log(`[SMSService] Sending batch of ${messages.length} SMS messages`);\r\n    \r\n    // Send in parallel with rate limiting (Twilio allows ~1 per second)\r\n    const results: SMSResult[] = [];\r\n    \r\n    for (const msg of messages) {\r\n      const result = await this.sendSMS(msg);\r\n      results.push(result);\r\n      \r\n      // Small delay to avoid rate limiting\r\n      if (this.enabled) {\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n      }\r\n    }\r\n    \r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Validate phone number format (E.164 format)\r\n   * Examples: +14155552671, +442071838750\r\n   */\r\n  private isValidPhoneNumber(phone: string): boolean {\r\n    // Must start with + and have 10-15 digits\r\n    const e164Regex = /^\\+[1-9]\\d{9,14}$/;\r\n    return e164Regex.test(phone);\r\n  }\r\n\r\n  /**\r\n   * Format phone number to E.164 format\r\n   * Examples: (415) 555-2671 -> +14155552671\r\n   */\r\n  formatPhoneNumber(phone: string, countryCode: string = '+1'): string {\r\n    // Remove all non-numeric characters\r\n    const cleaned = phone.replace(/\\D/g, '');\r\n    \r\n    // If already has country code, return as-is\r\n    if (phone.startsWith('+')) {\r\n      return phone;\r\n    }\r\n    \r\n    // Add country code\r\n    return `${countryCode}${cleaned}`;\r\n  }\r\n\r\n  /**\r\n   * Log SMS to database for tracking and analytics\r\n   */\r\n  private async logSMS(data: {\r\n    to: string;\r\n    message: string;\r\n    priority: string;\r\n    status: string;\r\n    timestamp: string;\r\n    sid?: string;\r\n    error?: string;\r\n  }) {\r\n    try {\r\n      // Check if SMSLog entity exists, if not, just console log\r\n      await base44.asServiceRole.entities.SMSLog?.create({\r\n        recipient_phone: data.to,\r\n        message_body: data.message,\r\n        priority: data.priority,\r\n        status: data.status,\r\n        twilio_sid: data.sid || null,\r\n        error_message: data.error || null,\r\n        sent_at: data.timestamp\r\n      }).catch(() => {\r\n        // Entity doesn't exist yet, just log\r\n        console.log('[SMSService] SMSLog entity not found, skipping database log');\r\n      });\r\n    } catch (error) {\r\n      // Fail silently - don't let logging errors block SMS sending\r\n      console.error('[SMSService] Failed to log SMS:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if SMS is enabled\r\n   */\r\n  isEnabled(): boolean {\r\n    return this.enabled;\r\n  }\r\n\r\n  /**\r\n   * Get SMS delivery status from Twilio\r\n   */\r\n  async getDeliveryStatus(messageSid: string): Promise<any> {\r\n    if (!this.enabled) {\r\n      return { status: 'dev_mode' };\r\n    }\r\n\r\n    try {\r\n      const result = await base44.integrations.Core.InvokeServerlessFunction({\r\n        functionName: 'getTwilioMessageStatus',\r\n        payload: {\r\n          messageSid: messageSid,\r\n          accountSid: this.twilioAccountSid,\r\n          authToken: this.twilioAuthToken\r\n        }\r\n      });\r\n\r\n      return result;\r\n    } catch (error) {\r\n      console.error('[SMSService] Failed to get delivery status:', error);\r\n      return { status: 'unknown', error: error.message };\r\n    }\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nexport const smsService = new SMSService();\r\n\r\n// ============================================================================\r\n// TEMPLATE FUNCTIONS (ready-to-use SMS messages)\r\n// ============================================================================\r\n\r\n/**\r\n * Client SMS Templates\r\n */\r\nexport const ClientSMSTemplates = {\r\n  bookingConfirmed: (cleanerName: string, date: string, time: string) =>\r\n    `‚úÖ Your cleaning is booked for ${date} at ${time}. Cleaner: ${cleanerName}. -PureTask`,\r\n\r\n  cleanerEnRoute: (cleanerName: string, eta: string) =>\r\n    `üöó ${cleanerName} is on the way! ETA: ${eta}. -PureTask`,\r\n\r\n  cleanerArrived: (cleanerName: string) =>\r\n    `üìç ${cleanerName} has arrived and will start shortly. -PureTask`,\r\n\r\n  jobStarted: (cleanerName: string, time: string) =>\r\n    `üßπ Cleaning started at ${time} by ${cleanerName}. -PureTask`,\r\n\r\n  extraTimeRequested: (cleanerName: string, minutes: number, cost: string) =>\r\n    `‚è∞ ${cleanerName} requests ${minutes} extra minutes (+$${cost}). Approve in app: https://puretask.com/approve -PureTask`,\r\n\r\n  jobCompleted: (cleanerName: string, duration: string) =>\r\n    `‚úÖ Cleaning complete (${duration})! Please review: https://puretask.com/review -PureTask`,\r\n\r\n  paymentProcessed: (amount: string) =>\r\n    `üí≥ Payment of $${amount} processed. Receipt sent to email. -PureTask`,\r\n};\r\n\r\n/**\r\n * Cleaner SMS Templates\r\n */\r\nexport const CleanerSMSTemplates = {\r\n  jobOffer: (clientName: string, date: string, time: string, pay: string) =>\r\n    `üÜï New job offer from ${clientName} on ${date} at ${time}. Pay: $${pay}. Respond in app. -PureTask`,\r\n\r\n  jobAccepted: (clientName: string, date: string, time: string, address: string) =>\r\n    `‚úÖ Job confirmed with ${clientName} on ${date} at ${time}. Address: ${address}. -PureTask`,\r\n\r\n  jobReminder15: (clientName: string, address: string) =>\r\n    `‚è∞ Reminder: Job with ${clientName} in 15 min. Address: ${address}. -PureTask`,\r\n\r\n  jobReminder30: (clientName: string, time: string) =>\r\n    `‚è∞ Reminder: Job with ${clientName} at ${time} (30 min). -PureTask`,\r\n\r\n  extraTimeApproved: (minutes: number) =>\r\n    `‚úÖ Client approved ${minutes} extra minutes. Continue working! -PureTask`,\r\n\r\n  extraTimeDenied: () =>\r\n    `‚ùå Client denied extra time. Please wrap up soon. -PureTask`,\r\n\r\n  payoutProcessed: (amount: string) =>\r\n    `üí∞ Payout of $${amount} processed to your account. -PureTask`,\r\n\r\n  lateArrivalWarning: (minutes: number) =>\r\n    `‚ö†Ô∏è You're ${minutes} min late. Please notify client. -PureTask`,\r\n\r\n  photoReminder: () =>\r\n    `üì∏ Reminder: Upload before/after photos before completing job. -PureTask`,\r\n};\r\n\r\n// Export default instance\r\nexport default smsService;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\test\\setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\test\\utils.js","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token <","line":22,"column":7}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render } from '@testing-library/react';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\n\r\n/**\r\n * Custom render function that includes all providers\r\n */\r\nexport function renderWithProviders(ui, options = {}) {\r\n  const { queryClient, ...renderOptions } = options;\r\n\r\n  const testQueryClient = queryClient || new QueryClient({\r\n    defaultOptions: {\r\n      queries: {\r\n        retry: false,\r\n        cacheTime: 0\r\n      }\r\n    }\r\n  });\r\n\r\n  function Wrapper({ children }) {\r\n    return (\r\n      <QueryClientProvider client={testQueryClient}>\r\n        <BrowserRouter>\r\n          {children}\r\n        </BrowserRouter>\r\n      </QueryClientProvider>\r\n    );\r\n  }\r\n\r\n  return {\r\n    ...render(ui, { wrapper: Wrapper, ...renderOptions }),\r\n    queryClient: testQueryClient\r\n  };\r\n}\r\n\r\n/**\r\n * Create a mock user object\r\n */\r\nexport function createMockUser(overrides = {}) {\r\n  return {\r\n    id: 'test-user-id',\r\n    email: 'test@example.com',\r\n    name: 'Test User',\r\n    user_type: 'client',\r\n    role: 'user',\r\n    created_at: new Date().toISOString(),\r\n    updated_at: new Date().toISOString(),\r\n    ...overrides\r\n  };\r\n}\r\n\r\n/**\r\n * Create a mock booking object\r\n */\r\nexport function createMockBooking(overrides = {}) {\r\n  return {\r\n    id: 'test-booking-id',\r\n    client_email: 'client@example.com',\r\n    cleaner_email: 'cleaner@example.com',\r\n    status: 'scheduled',\r\n    address: '123 Test St',\r\n    latitude: 40.7128,\r\n    longitude: -74.0060,\r\n    date: '2026-02-01',\r\n    time: '10:00',\r\n    hours: 3,\r\n    service_type: 'basic',\r\n    bedrooms: 2,\r\n    bathrooms: 2,\r\n    base_price: 90,\r\n    total_price: 105,\r\n    created_at: new Date().toISOString(),\r\n    updated_at: new Date().toISOString(),\r\n    ...overrides\r\n  };\r\n}\r\n\r\n/**\r\n * Create a mock cleaner profile\r\n */\r\nexport function createMockCleanerProfile(overrides = {}) {\r\n  return {\r\n    id: 'test-cleaner-profile-id',\r\n    user_email: 'cleaner@example.com',\r\n    full_name: 'Test Cleaner',\r\n    phone: '555-0123',\r\n    hourly_rate: 30,\r\n    tier: 'silver',\r\n    reliability_score: 85,\r\n    total_jobs: 50,\r\n    rating: 4.5,\r\n    is_verified: true,\r\n    is_active: true,\r\n    payout_percentage: 0.8,\r\n    created_at: new Date().toISOString(),\r\n    updated_at: new Date().toISOString(),\r\n    ...overrides\r\n  };\r\n}\r\n\r\n/**\r\n * Create a mock client profile\r\n */\r\nexport function createMockClientProfile(overrides = {}) {\r\n  return {\r\n    id: 'test-client-profile-id',\r\n    user_email: 'client@example.com',\r\n    full_name: 'Test Client',\r\n    phone: '555-0124',\r\n    address: '123 Test St',\r\n    latitude: 40.7128,\r\n    longitude: -74.0060,\r\n    credit_balance: 50,\r\n    total_bookings: 10,\r\n    created_at: new Date().toISOString(),\r\n    updated_at: new Date().toISOString(),\r\n    ...overrides\r\n  };\r\n}\r\n\r\n/**\r\n * Wait for a specific condition\r\n */\r\nexport function waitFor(condition, timeout = 5000) {\r\n  return new Promise((resolve, reject) => {\r\n    const startTime = Date.now();\r\n    \r\n    const checkCondition = () => {\r\n      if (condition()) {\r\n        resolve();\r\n      } else if (Date.now() - startTime > timeout) {\r\n        reject(new Error('Timeout waiting for condition'));\r\n      } else {\r\n        setTimeout(checkCondition, 100);\r\n      }\r\n    };\r\n    \r\n    checkCondition();\r\n  });\r\n}\r\n\r\n// Re-export everything from @testing-library/react\r\nexport * from '@testing-library/react';\r\nexport { default as userEvent } from '@testing-library/user-event';\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\types\\cleanerJobTypes.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token type","line":4,"column":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Job State Machine - Extended for Cleaner AI Assistant\r\n// Defines all possible job states and transitions\r\n\r\nexport type JobState =\r\n  | 'REQUESTED'           // Client booked, escrow reserved, not yet offered\r\n  | 'OFFERED'             // Offers sent to matched cleaners\r\n  | 'ASSIGNED'            // Cleaner accepted\r\n  | 'EN_ROUTE'            // Cleaner on the way\r\n  | 'ARRIVED'             // At property (optional state)\r\n  | 'IN_PROGRESS'         // Job started, timer running\r\n  | 'AWAITING_CLIENT_REVIEW' // Finished, waiting for client approval\r\n  | 'COMPLETED_APPROVED'  // Client approved, billing done\r\n  | 'UNDER_REVIEW'        // Disputed, under investigation\r\n  | 'CANCELLED'           // Job cancelled\r\n  | 'RESCHEDULED';        // Moved to new time/date\r\n\r\nexport type JobSubState =\r\n  | 'NONE'\r\n  | 'PHOTOS_PENDING'      // Waiting for before/after photos\r\n  | 'EXTRA_TIME_REQUESTED' // Cleaner asked for more time\r\n  | 'EXTRA_TIME_APPROVED' // Client approved extra time\r\n  | 'GPS_ISSUE'           // GPS validation problem\r\n  | 'DISPUTE_CLIENT'      // Client opened dispute\r\n  | 'DISPUTE_CLEANER';    // Cleaner opened dispute\r\n\r\n// Job record type matching database schema\r\nexport interface JobRecord {\r\n  id: string;\r\n  \r\n  // Participants\r\n  client_id: string;\r\n  client_email: string;\r\n  assigned_cleaner_id: string | null;\r\n  assigned_cleaner_email: string | null;\r\n  \r\n  // State\r\n  state: JobState;\r\n  sub_state: JobSubState;\r\n  \r\n  // Core timestamps\r\n  created_at: string;\r\n  assigned_at: string | null;\r\n  en_route_at: string | null;\r\n  check_in_at: string | null;\r\n  start_at: string | null;\r\n  end_at: string | null;\r\n  approved_at: string | null;\r\n  disputed_at: string | null;\r\n  dispute_resolved_at: string | null;\r\n  cancelled_at: string | null;\r\n  \r\n  // GPS locations\r\n  en_route_location_lat: number | null;\r\n  en_route_location_lng: number | null;\r\n  check_in_location_lat: number | null;\r\n  check_in_location_lng: number | null;\r\n  start_location_lat: number | null;\r\n  start_location_lng: number | null;\r\n  end_location_lat: number | null;\r\n  end_location_lng: number | null;\r\n  \r\n  // Billing & escrow\r\n  max_billable_minutes: number | null;\r\n  max_billable_credits: number | null;\r\n  actual_minutes_worked: number | null;\r\n  final_credits_charged: number | null;\r\n  escrow_ledger_entry_id: string | null;\r\n  \r\n  // Flags\r\n  has_pending_extra_time_request: boolean;\r\n  has_pending_reschedule_request: boolean;\r\n  requires_before_photos: boolean;\r\n  requires_after_photos: boolean;\r\n  before_photos_count: number;\r\n  after_photos_count: number;\r\n  \r\n  // Job details (existing fields)\r\n  date: string;\r\n  time: string;\r\n  duration_hours: number;\r\n  address: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  cleaning_type: 'basic' | 'deep' | 'moveout';\r\n  bedrooms: number;\r\n  bathrooms: number;\r\n  square_feet: number | null;\r\n  \r\n  // Pricing (snapshot at booking time)\r\n  pricing_snapshot: any; // JSON\r\n  \r\n  // Notes\r\n  client_notes: string | null;\r\n  cleaner_notes: string | null;\r\n  admin_notes: string | null;\r\n}\r\n\r\n// State transition result\r\nexport interface StateTransitionResult {\r\n  nextState: JobState;\r\n  nextSubState: JobSubState;\r\n  patch: Partial<JobRecord>; // Fields to update in DB\r\n  sideEffects: Array<() => Promise<void>>; // Actions to perform after commit\r\n}\r\n\r\n// Transition guards (checks before allowing transition)\r\nexport interface TransitionGuard {\r\n  check: (job: JobRecord) => boolean | Promise<boolean>;\r\n  errorMessage: string;\r\n}\r\n\r\n// State machine configuration\r\nexport const STATE_TRANSITIONS: Record<JobState, Partial<Record<JobState, TransitionGuard[]>>> = {\r\n  REQUESTED: {\r\n    OFFERED: [],\r\n    CANCELLED: []\r\n  },\r\n  OFFERED: {\r\n    ASSIGNED: [\r\n      {\r\n        check: (job) => !!job.assigned_cleaner_id,\r\n        errorMessage: 'Must have assigned cleaner'\r\n      }\r\n    ],\r\n    CANCELLED: []\r\n  },\r\n  ASSIGNED: {\r\n    EN_ROUTE: [],\r\n    CANCELLED: []\r\n  },\r\n  EN_ROUTE: {\r\n    ARRIVED: [],\r\n    IN_PROGRESS: [], // Can go directly to in_progress\r\n    CANCELLED: []\r\n  },\r\n  ARRIVED: {\r\n    IN_PROGRESS: [],\r\n    CANCELLED: []\r\n  },\r\n  IN_PROGRESS: {\r\n    AWAITING_CLIENT_REVIEW: [\r\n      {\r\n        check: (job) => (job.before_photos_count || 0) >= 3,\r\n        errorMessage: 'Must have at least 3 before photos'\r\n      },\r\n      {\r\n        check: (job) => (job.after_photos_count || 0) >= 3,\r\n        errorMessage: 'Must have at least 3 after photos'\r\n      },\r\n      {\r\n        check: (job) => !!job.end_at && !!job.start_at,\r\n        errorMessage: 'Must have valid start and end times'\r\n      }\r\n    ],\r\n    CANCELLED: []\r\n  },\r\n  AWAITING_CLIENT_REVIEW: {\r\n    COMPLETED_APPROVED: [],\r\n    UNDER_REVIEW: []\r\n  },\r\n  COMPLETED_APPROVED: {},\r\n  UNDER_REVIEW: {\r\n    COMPLETED_APPROVED: [], // Dispute resolved in cleaner's favor\r\n    CANCELLED: [] // Dispute resolved in client's favor\r\n  },\r\n  CANCELLED: {},\r\n  RESCHEDULED: {}\r\n};\r\n\r\n// Helper to check if transition is allowed\r\nexport function canTransition(\r\n  fromState: JobState,\r\n  toState: JobState,\r\n  job: JobRecord\r\n): { allowed: boolean; reasons: string[] } {\r\n  const transitions = STATE_TRANSITIONS[fromState];\r\n  \r\n  if (!transitions || !(toState in transitions)) {\r\n    return {\r\n      allowed: false,\r\n      reasons: [`Cannot transition from ${fromState} to ${toState}`]\r\n    };\r\n  }\r\n  \r\n  const guards = transitions[toState] || [];\r\n  const failedGuards: string[] = [];\r\n  \r\n  for (const guard of guards) {\r\n    if (!guard.check(job)) {\r\n      failedGuards.push(guard.errorMessage);\r\n    }\r\n  }\r\n  \r\n  return {\r\n    allowed: failedGuards.length === 0,\r\n    reasons: failedGuards\r\n  };\r\n}\r\n\r\n// Calculate worked minutes\r\nexport function calculateWorkedMinutes(job: JobRecord): number | null {\r\n  if (!job.start_at || !job.end_at) return null;\r\n  \r\n  const start = new Date(job.start_at);\r\n  const end = new Date(job.end_at);\r\n  const diffMs = end.getTime() - start.getTime();\r\n  const diffMinutes = Math.floor(diffMs / (1000 * 60));\r\n  \r\n  return diffMinutes > 0 ? diffMinutes : null;\r\n}\r\n\r\n// Calculate billable minutes (capped at max)\r\nexport function calculateBillableMinutes(job: JobRecord): number | null {\r\n  const worked = calculateWorkedMinutes(job);\r\n  if (worked === null) return null;\r\n  \r\n  const max = job.max_billable_minutes || worked;\r\n  return Math.min(worked, max);\r\n}\r\n\r\n// Check if GPS location is near job address\r\nexport function isLocationNearJob(\r\n  locationLat: number,\r\n  locationLng: number,\r\n  job: JobRecord,\r\n  radiusMeters: number = 250\r\n): boolean {\r\n  const R = 6371e3; // Earth radius in meters\r\n  const œÜ1 = (locationLat * Math.PI) / 180;\r\n  const œÜ2 = (job.latitude * Math.PI) / 180;\r\n  const ŒîœÜ = ((job.latitude - locationLat) * Math.PI) / 180;\r\n  const ŒîŒª = ((job.longitude - locationLng) * Math.PI) / 180;\r\n\r\n  const a =\r\n    Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +\r\n    Math.cos(œÜ1) * Math.cos(œÜ2) * Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\r\n  const distance = R * c; // Distance in meters\r\n  return distance <= radiusMeters;\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\types\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\utils\\index.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Unexpected token :","line":4,"column":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\n\n\nexport function createPageUrl(pageName: string) {\n    return '/' + pageName.toLowerCase().replace(/ /g, '-');\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\onlyw\\Documents\\GitHub\\base44_puretask_newyear\\src\\vite-env.d.ts","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: The keyword 'interface' is reserved","line":3,"column":1}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/// <reference types=\"vite/client\" />\r\n\r\ninterface ImportMetaEnv {\r\n  readonly VITE_TWILIO_ACCOUNT_SID: string\r\n  readonly VITE_TWILIO_AUTH_TOKEN: string\r\n  readonly VITE_TWILIO_PHONE_NUMBER: string\r\n  readonly VITE_VAPID_PUBLIC_KEY: string\r\n  readonly VITE_WS_URL: string\r\n  readonly BASE44_LEGACY_SDK_IMPORTS: string\r\n}\r\n\r\ninterface ImportMeta {\r\n  readonly env: ImportMetaEnv\r\n}\r\n\r\n","usedDeprecatedRules":[]}]